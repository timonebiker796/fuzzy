/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudSecurityPosture_bundle_jsonpfunction=window.cloudSecurityPosture_bundle_jsonpfunction||[]).push([[2],Array(54).concat([function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(8);const i=()=>Object(s.useKibana)()},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return n})),a.d(t,"d",(function(){return l})),a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return o})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"j",(function(){return b}));const s=100,i=1e4,n=[10,25,50,s,250,500],l={auto:-1,single:0,default:3},r="1.6em",o=370,u=212,c="kibana-json",d={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},b={showColumnSelector:{allowHide:!1,allowReorder:!0}}},,,function(e,t,a){"use strict";var s,i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),n=[];function l(e){for(var t=-1,a=0;a<n.length;a++)if(n[a].identifier===e){t=a;break}return t}function r(e,t){for(var a={},s=[],i=0;i<e.length;i++){var r=e[i],o=t.base?r[0]+t.base:r[0],u=a[o]||0,c="".concat(o," ").concat(u);a[o]=u+1;var d=l(c),b={css:r[1],media:r[2],sourceMap:r[3]};-1!==d?(n[d].references++,n[d].updater(b)):n.push({identifier:c,updater:m(b,t),references:1}),s.push(c)}return s}function o(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var n=a.nc;n&&(s.nonce=n)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var l=i(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,a,s){var i=a?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var n=document.createTextNode(i),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(n,l[t]):e.appendChild(n)}}function b(e,t,a){var s=a.css,i=a.media,n=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var p=null,g=0;function m(e,t){var a,s,i;if(t.singleton){var n=g++;a=p||(p=o(t)),s=d.bind(null,a,n,!1),i=d.bind(null,a,n,!0)}else a=o(t),s=b.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var a=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<a.length;s++){var i=l(a[s]);n[i].references--}for(var o=r(e,t),u=0;u<a.length;u++){var c=l(a[u]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}a=o}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,s,i,n=e[1]||"",l=e[3];if(!l)return n;if(t&&"function"==typeof btoa){var r=(a=l,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(i," */")),o=l.sources.map((function(e){return"/*# sourceURL=".concat(l.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([r]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,s){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(s)for(var n=0;n<this.length;n++){var l=this[n][0];null!=l&&(i[l]=!0)}for(var r=0;r<e.length;r++){var o=[].concat(e[r]);s&&i[o[0]]||(a&&(o[2]?o[2]="".concat(a," and ").concat(o[2]):o[2]=a),t.push(o))}},t}},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),i=a(73),n=function(){};t.default=function(e,t,a){if(!i.isClient)return[t,n,n];if(!e)throw new Error("useLocalStorage key may not be falsy");var l=a?a.raw?function(e){return e}:a.deserializer:JSON.parse,r=s.useState((function(){try{var s=a?a.raw?String:a.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?l(i):(t&&localStorage.setItem(e,s(t)),t)}catch(e){return t}})),o=r[0],u=r[1],c=s.useCallback((function(t){try{var s="function"==typeof t?t(o):t;if(void 0===s)return;var i;i=a?a.raw?"string"==typeof s?s:JSON.stringify(s):a.serializer?a.serializer(s):JSON.stringify(s):JSON.stringify(s),localStorage.setItem(e,i),u(l(i))}catch(e){}}),[e,u]),d=s.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[o,c,d]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(1);const i={},n=a.n(s).a.createContext(i)},,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return n}));var s=a(10),i=a.n(s);let n=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),l=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){i()(this,"name",void 0),i()(this,"sortable",void 0),i()(this,"filterable",void 0),i()(this,"esTypes",void 0),this.name=e.name||l.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}new kbn_field_type_KbnFieldType({name:l.UNKNOWN});new kbn_field_type_KbnFieldType({name:l.STRING,sortable:!0,filterable:!0,esTypes:[n.STRING,n.TEXT,n.MATCH_ONLY_TEXT,n.KEYWORD,n.VERSION,n._TYPE,n._ID]}),new kbn_field_type_KbnFieldType({name:l.NUMBER,sortable:!0,filterable:!0,esTypes:[n.FLOAT,n.HALF_FLOAT,n.SCALED_FLOAT,n.DOUBLE,n.INTEGER,n.LONG,n.UNSIGNED_LONG,n.SHORT,n.BYTE,n.TOKEN_COUNT,n.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:l.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[n.FLOAT_RANGE,n.DOUBLE_RANGE,n.INTEGER_RANGE,n.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:l.DATE,sortable:!0,filterable:!0,esTypes:[n.DATE,n.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:l.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[n.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:l.IP,sortable:!0,filterable:!0,esTypes:[n.IP]}),new kbn_field_type_KbnFieldType({name:l.IP_RANGE,sortable:!0,filterable:!0,esTypes:[n.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:l.BOOLEAN,sortable:!0,filterable:!0,esTypes:[n.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:l.OBJECT,esTypes:[n.OBJECT]}),new kbn_field_type_KbnFieldType({name:l.NESTED,esTypes:[n.NESTED]}),new kbn_field_type_KbnFieldType({name:l.GEO_POINT,esTypes:[n.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:l.GEO_SHAPE,esTypes:[n.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:l.ATTACHMENT,esTypes:[n.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:l.MURMUR3,esTypes:[n.MURMUR3]}),new kbn_field_type_KbnFieldType({name:l._SOURCE,esTypes:[n._SOURCE]}),new kbn_field_type_KbnFieldType({name:l.HISTOGRAM,filterable:!0,esTypes:[n.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:l.CONFLICT})},,,function(e,t,a){e.exports=a.p+"3c3c7102c3ff5856912e8c531cf93763.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=a(15).__importDefault(a(141));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));const s=["_source"];function i(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:s}function n(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return C}));var s=a(1),i=a(3),n=a(6),l=a(160),r=a(64);const o=new WeakMap;var u=a(28),c=a.n(u),d=a(74),b=a(0);function p({useTopLevelObjectColumns:e,row:t,columnId:a,dataView:r,shouldShowFieldHandler:u,maxEntries:p,isPlainRecord:g,fieldFormats:m,dataTestSubj:j="discoverCellDescriptionList",className:x}){const f=e?function(e,t,a,s){var i;const n=Object(d.b)(e.fields,t),l=null!==(i=e.highlight)&&void 0!==i?i:{},r=[],o=[];return Object.entries(n).forEach((([t,i])=>{var n;const u=a.getFieldByName(t),c=a.fields.getByName?null===(n=a.fields.getByName(t))||void 0===n?void 0:n.displayName:void 0,d=u?a.getFormatterForField(u):{convert:(e,...t)=>String(e)},b=i.map((t=>d.convert(t,"html",{field:u,hit:e}))).join(", "),p=l[t]?r:o;c?s(c)&&p.push([c,b,t]):p.push([t,b,t])})),[...r,...o]}(t.raw,a,r,u).slice(0,p):function(e,t,a,s,n){var r;const u=o.get(e.raw);if(u&&u.maxEntries===s)return u.formattedHit;const c=null!==(r=e.raw.highlight)&&void 0!==r?r:{},d=e.flattened,b=[],p=[];Object.entries(d).forEach((([s,i])=>{const r=t.fields.getByName(s),o=null==r?void 0:r.displayName,u=c[s]?b:p,d=Object(l.a)(i,e.raw,n,t,r);o?a(s)&&u.push([o,d,s]):u.push([s,d,s])}));const g=[...b,...p],m=g.length<=s?g:[...g.slice(0,s),[i.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:g.length-s}}),"",null]];return o.set(e.raw,{formattedHit:m,maxEntries:s}),m}(t,r,u,p,m);return Object(b.jsx)(n.EuiDescriptionList,{type:"inline",compressed:!0,className:c()("unifiedDataTable__descriptionList","unifiedDataTable__cellValue",x),"data-test-subj":j},f.map((([e,a,i])=>{var l;return g&&i&&null===(null!==(l=t.flattened[i])&&void 0!==l?l:null)?null:Object(b.jsx)(s.Fragment,{key:e},Object(b.jsx)(n.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(b.jsx)(n.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:a}}))})))}a(95);var g=a(33),m=a(34);const j=i.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),x=i.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),f=({jsonValue:e,width:t,height:a,hasLineNumbers:s,onEditorDidMount:i,hideCopyButton:l})=>{if(""===e)return null;const r=Object(b.jsx)(m.CodeEditor,{languageId:g.XJsonLang.ID,width:t,height:a,value:e||"",editorDidMount:i,"aria-label":j,options:{automaticLayout:!0,fontSize:12,lineNumbers:s?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return l?r:Object(b.jsx)(n.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(b.jsx)(n.EuiFlexItem,null,Object(b.jsx)(n.EuiSpacer,{size:"s"}),Object(b.jsx)("div",{className:"eui-textRight"},Object(b.jsx)(n.EuiCopy,{textToCopy:e},(e=>Object(b.jsx)(n.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},x))))),Object(b.jsx)(n.EuiFlexItem,null,r))};function h({json:e,width:t,height:a,hasLineNumbers:s}){const i=JSON.stringify(e,null,2);return Object(b.jsx)(f,{jsonValue:i,width:t,height:a,hasLineNumbers:s,onEditorDidMount:()=>{},hideCopyButton:!0})}var O=a(57);function v(e,t,a){return a?Object(d.b)(t.raw.fields,e):t.raw}var y=({closeButton:e,columnId:t,row:a,useTopLevelObjectColumns:s,dataTestSubj:i="dataTableExpandCellActionJsonPopover"})=>Object(b.jsx)(n.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover","data-test-subj":i},Object(b.jsx)(n.EuiFlexItem,{grow:!1},Object(b.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(b.jsx)(n.EuiFlexItem,{grow:!1},e))),Object(b.jsx)(n.EuiFlexItem,null,Object(b.jsx)(h,{json:v(t,a,s),width:O.f,height:200})));const T=({children:e})=>Object(b.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord"},e),k="unifiedDataTable__cellValue",C=({dataView:e,rows:t,useNewFieldsApi:a,shouldShowFieldHandler:o,closePopover:u,fieldFormats:c,maxEntries:d,externalCustomRenderers:g,isPlainRecord:m})=>function({rowIndex:j,columnId:x,isDetails:f,setCellProps:h,colIndex:O,isExpandable:v,isExpanded:C}){const E=t?t[j]:void 0,S=e.fields.getByName(x),F=Object(s.useContext)(r.a);if(Object(s.useEffect)((()=>{null!=E&&E.isAnchor?h({className:"unifiedDataTable__cell--highlight"}):F.expanded&&E&&F.expanded.id===E.id?h({className:"unifiedDataTable__cell--expanded"}):h({style:void 0})}),[F,E,h]),void 0===E)return Object(b.jsx)("span",{className:k},"-");if(g&&g[x])return Object(b.jsx)("span",{className:k},g[x]({rowIndex:j,columnId:x,isDetails:f,setCellProps:h,isExpandable:v,isExpanded:C,colIndex:O,row:E,dataView:e,fieldFormats:c,closePopover:u}));const w=Boolean(a&&!S&&(null==E?void 0:E.raw.fields)&&!E.raw.fields[x]);return f?function({row:e,field:t,columnId:a,dataView:s,useTopLevelObjectColumns:r,fieldFormats:o,closePopover:u}){const c=Object(b.jsx)(n.EuiButtonIcon,{"aria-label":i.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:u});return r||"_source"===(null==t?void 0:t.type)?Object(b.jsx)(y,{row:e,columnId:a,useTopLevelObjectColumns:r,closeButton:c}):Object(b.jsx)(n.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1,"data-test-subj":"dataTableExpandCellActionPopover"},Object(b.jsx)(n.EuiFlexItem,null,Object(b.jsx)(T,null,Object(b.jsx)("span",{dangerouslySetInnerHTML:{__html:Object(l.a)(e.flattened[a],e.raw,o,s,t)}}))),Object(b.jsx)(n.EuiFlexItem,{grow:!1},c))}({row:E,field:S,columnId:x,dataView:e,useTopLevelObjectColumns:w,fieldFormats:c,closePopover:u}):"_source"===(null==S?void 0:S.type)||w?Object(b.jsx)(p,{useTopLevelObjectColumns:w,row:E,dataView:e,columnId:x,fieldFormats:c,shouldShowFieldHandler:o,maxEntries:d,isPlainRecord:m}):Object(b.jsx)("span",{className:k,dangerouslySetInnerHTML:{__html:Object(l.a)(E.flattened[x],E.raw,c,e,S)}})}},,,,,,,,,,,function(e,t,a){e.exports=a.p+"2d015490d219c87a014c81f9555e556a.svg"},function(e,t,a){e.exports=a.p+"432a17d27c37a1b4467753dcc2332f12.svg"},function(e,t,a){e.exports=a.p+"8d3deaa318988ae73e799b48ff864cb3.svg"},function(e,t,a){e.exports=a.p+"c82e317671d73dcc4b62ca8bfdf1979c.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15),i=a(1),n=s.__importDefault(a(143));t.default=function(e,t,a){void 0===t&&(t=[]),void 0===a&&(a={loading:!1});var l=i.useRef(0),r=n.default(),o=i.useState(a),u=o[0],c=o[1],d=i.useCallback((function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var i=++l.current;return c((function(e){return s.__assign(s.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return r()&&i===l.current&&c({value:e,loading:!1}),e}),(function(e){return r()&&i===l.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},function(e,t,a){"use strict";e.exports=a(144)},function(e,t,a){"use strict";e.exports=a(146)},function(e,t,a){"use strict";e.exports=a(153)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),i=a(73);t.default=function(e,t,a){if(!i.isClient)return[t,function(){}];var n=s.useState((function(){try{var s=sessionStorage.getItem(e);return"string"!=typeof s?(sessionStorage.setItem(e,a?String(t):JSON.stringify(t)),t):a?s:JSON.parse(s||"null")}catch(e){return t}})),l=n[0],r=n[1];return s.useEffect((function(){try{var t=a?String(l):JSON.stringify(l);sessionStorage.setItem(e,t)}catch(e){}})),[l,r]}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(161);case"v8light":return a(163)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return n}));let s=function(e){return e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.SEMANTIC_TEXT="semantic_text",e.STRING="string",e.TEXT="text",e.VERSION="version",e}({});const i=Object.values(s),n=e=>!!e&&i.includes(e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(100);function i(e){return{type:Object(s.a)(e),scripted:e.scripted}}},function(e,t,a){e.exports=a.p+"4c19e824d4ddbcb450a8dd5b72ceb88f.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15),i=a(1),n=s.__importDefault(a(168));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var s=n.default(e,t),l=s[0],r=s[1],o=s[2];return i.useEffect(o,a),[l,r]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(96);function i(e,t){var a;const i=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),n=(null===(a=e.esTypes)||void 0===a?void 0:a[0])||null;return n&&["_id","_index","_ignored"].includes(n)&&"string"===i?"keyword":"unknown"===i&&n&&Object(s.b)(n)||"string"===i&&n?n:i}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"9fbaf98ccebbedc599a6a5985bd24430.svg"},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,i,n;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(i=s;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(n=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,n[i]))return!1;for(i=s;0!=i--;){var l=n[i];if(!("_owner"===l&&t.$$typeof||e(t[l],a[l])))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15),i=a(1),n=s.__importDefault(a(90));t.default=function(e,t){void 0===t&&(t=[]);var a=n.default(e,t,{loading:!0}),s=a[0],l=a[1];return i.useEffect((function(){l()}),[l]),s}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(){var e=s.useRef(!1),t=s.useCallback((function(){return e.current}),[]);return s.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(145);a(32),a(92),a(93);var i=s.default({key:"css"}),n=i.flush,l=i.hydrate,r=i.cx,o=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,b=i.css,p=i.sheet,g=i.cache;t.cache=g,t.css=b,t.cx=r,t.flush=n,t.getRegisteredStyles=u,t.hydrate=l,t.injectGlobal=c,t.keyframes=d,t.merge=o,t.sheet=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(32),i=a(92),n=a(93);function l(e){return e&&e.__esModule?e:{default:e}}var r=l(s);function o(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,a){var s=[],i=n.getRegisteredStyles(e,s,a);return s.length<2?a:i+t(s)}var c=function e(t){for(var a="",s=0;s<t.length;s++){var i=t[s];if(null!=i){var n=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))n=e(i);else for(var l in n="",i)i[l]&&l&&(n&&(n+=" "),n+=l);break;default:n=i}n&&(a&&(a+=" "),a+=n)}}return a};t.default=function(e){var t=r.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var l=i.serializeStyles(a,t.registered,void 0);return n.insertStyles(t,l,!1),t.key+"-"+l.name};return{css:a,cx:function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return u(t.registered,a,c(s))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var n=i.serializeStyles(a,t.registered);o(t,n)},keyframes:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var n=i.serializeStyles(a,t.registered),l="animation-"+n.name;return o(t,{name:n.name,styles:"@keyframes "+l+"{"+n.styles+"}"}),l},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:n.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,a)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(147),i=a(149),n=a(151);function l(e){return e&&e.__esModule?e:{default:e}}var r=l(s),o=l(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},b=function(e){return null!=e&&"boolean"!=typeof e},p=l(n).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),g=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,a){return j={name:t,styles:a,next:j},t}))}return 1===o.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function m(e,t,a){if(null==a)return"";if(void 0!==a.__emotion_styles)return a;switch(typeof a){case"boolean":return"";case"object":if(1===a.anim)return j={name:a.name,styles:a.styles,next:j},a.name;if(void 0!==a.styles){var s=a.next;if(void 0!==s)for(;void 0!==s;)j={name:s.name,styles:s.styles,next:j},s=s.next;return a.styles+";"}return function(e,t,a){var s="";if(Array.isArray(a))for(var i=0;i<a.length;i++)s+=m(e,t,a[i])+";";else for(var n in a){var l=a[n];if("object"!=typeof l)null!=t&&void 0!==t[l]?s+=n+"{"+t[l]+"}":b(l)&&(s+=p(n)+":"+g(n,l)+";");else if(!Array.isArray(l)||"string"!=typeof l[0]||null!=t&&void 0!==t[l[0]]){var r=m(e,t,l);switch(n){case"animation":case"animationName":s+=p(n)+":"+r+";";break;default:s+=n+"{"+r+"}"}}else for(var o=0;o<l.length;o++)b(l[o])&&(s+=p(n)+":"+g(n,l[o])+";")}return s}(e,t,a);case"function":if(void 0!==e){var i=j,n=a(e);return j=i,m(e,t,n)}}if(null==t)return a;var l=t[a];return void 0!==l?l:a}var j,x=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,a){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var s=!0,i="";j=void 0;var n=e[0];null==n||void 0===n.raw?(s=!1,i+=m(a,t,n)):i+=n[0];for(var l=1;l<e.length;l++)i+=m(a,t,e[l]),s&&(i+=n[l]);x.lastIndex=0;for(var o,u="";null!==(o=x.exec(i));)u+="-"+o[1];return{name:r.default(i)+u,styles:i,next:j}}},function(e,t,a){"use strict";e.exports=a(148)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,a=0,s=0,i=e.length;i>=4;++s,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+(59797*(t>>>16)<<16),a=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&a)+(59797*(a>>>16)<<16);switch(i){case 3:a^=(255&e.charCodeAt(s+2))<<16;case 2:a^=(255&e.charCodeAt(s+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(s)))+(59797*(a>>>16)<<16)}return(((a=1540483477*(65535&(a^=a>>>13))+(59797*(a>>>16)<<16))^a>>>15)>>>0).toString(36)}},function(e,t,a){"use strict";e.exports=a(150)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,a){"use strict";e.exports=a(152)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(a){return void 0===t[a]&&(t[a]=e(a)),t[a]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="undefined"!=typeof document,i=function(e,t,a){var i=e.key+"-"+t.name;(!1===a||!1===s&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,a){var s="";return a.split(" ").forEach((function(a){void 0!==e[a]?t.push(e[a]+";"):s+=a+" "})),s},t.insertStyles=function(e,t,a){i(e,t,a);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var l="",r=t;do{var o=e.insert(t===r?"."+n:"",r,e.sheet,!0);s||void 0===o||(l+=o),r=r.next}while(void 0!==r);if(!s&&0!==l.length)return l}},t.registerStyles=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var s=void 0;t.setEuiDevProviderWarning=function(e){return s=e},t.getEuiDevProviderWarning=function(){return s},t.emitEuiProviderWarning=function(e){if("function"==typeof s)return s(e);switch(s){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(156);case"v8light":return a(158)}},function(e,t,a){var s=a(60),i=a(157);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(61)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#2e2d25}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,a){var s=a(60),i=a(159);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(61)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#fff9e8}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(69);function i(e,t,a,i,n,l,r){const o=null!=l?l:"html",u={hit:t,field:n,...r};return i&&n?i.getFormatterForField(n).convert(e,o,u):a.getDefaultInstance(s.b.STRING).convert(e,o,u)}},function(e,t,a){var s=a(60),i=a(162);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(61)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,a){var s=a(60),i=a(164);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(61)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15),i=a(73),n=s.__importDefault(a(166));t.default=function(e,t){n.default(e,t,i.isDeepEqual)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(e,t,a){var i=s.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),s.useEffect(e,i.current)}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCA0MiA0MiI+CiAgPHBhdGggZmlsbD0idXJsKCNyZWRoYXQpIiBkPSJNMzguNzE0IDhIM3YyNi4xOWgzNS43MTRWOFoiLz4KICA8ZGVmcz4KICAgIDxwYXR0ZXJuIGlkPSJyZWRoYXQiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHBhdHRlcm5Db250ZW50VW5pdHM9Im9iamVjdEJvdW5kaW5nQm94Ij4KICAgICAgPHVzZSB4bGluazpocmVmPSIjYiIgdHJhbnNmb3JtPSJzY2FsZSguMDEwMyAuMDE0MDYpIi8+CiAgICA8L3BhdHRlcm4+CiAgICA8aW1hZ2UgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHRUFBQUJIQ0FZQUFBQVg4eW1JQUFBQUNYQklXWE1BQUFzVEFBQUxFd0VBbXB3WUFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQXcvU1VSQlZIZ0I3WjE3akZUVkhjZC9NN003c3kvWUI2OVZnUVZxOGNIRExScTFTb3VOMW1xeE5xR21MVlJ0VUdOanJMYmFKcFZxL3hEN0VBczFiYTFwYTB4SnFrMGYwbFlsWUswbENvZ1ZlYXpZRWtXUWgrRENnckFMQzhQdXpwM3I1M2ZQREE2N003dXpNL2ZPSy90TlR1NkR1M1B2UGQvemU1OXpFUmxDM3VHVFBNQVdDUndXcVk3U0FpTGxITnNoa2U2d3lJbVJOQjdLR3VEdlF4MGluK0dpTzdqMlNrNVpuSHVYL1kzODN0b2VrYzNsSW0zRFJUbzUxeTBGanB5VFFHY0ZqNG8wUWNCMTdIK05VNStrV1J4djlZdTh5QU90cE8ycU5SM1lrK1R2cS9qNzZ5SGdoeHhPUzNHYlE3UjFYUHNzYlIzRTdLOHp2eGVSQWtST1NWQUpvQU12WXJ1UVRyODZ4VFg3ZWFoVmROeHlPdnIvbkdvdk05TGhaMGlQWkR1ZmEyNWsyeWpwQWFHVHRkenZYL3hOUzVYSTN2ZTR4NVFDa3BDY2t2Q2h5RGhHKzROMDR2dzBMdS9rdXExc1czaklQZnhkRGNkWDBhWnlya0l5dzNiYUtuNXZCU1MvUFV5a1ZZeUVSQ1dQeUJrSmRGNE5RL0kyYnZnUWh6V1NYM1RSVmtIc0d2VFRHMEdJaHBERCtTSWpaeVMwaTh6Z0RYL0M3alZTUUtBRDFxUDJua2N5dG5DNEJkdXhOOWUySXlja3FERkdGYzFqNUMzaHNFRUtFOXZwak9VTWxKVjRWcHR5S1JrNUlRRmpmQTZqYlFGa2ZGTUtIR3FINkpUVjdEN1BhRmtoT1VDWjVBREk5dGxzWmtvUkFBTE9GOU9hc1dIajYwV1djdTZrZUFqUFNVQUtSdUlMZmdwVjFDVEZoVXRwazQvdzNCL2dUSnlKbXl3ZXdTOGVBNlU2SHFOM29lUkk2bHlHMnEvYks0bk14VU40U2dMNnRReGJjRGJiR1ZLOGFPRDU3MWJWSkI3QlV4S1EzOUZzTHFPTmxlS0dFakJQUElLbkpHQ1F4L3VOS3ZKYzdlVUFYeENQNEZubnFDcWlUYUZkSWlVQVBLVExpSFdHaXdmd2pJVGplRVZpcEtCY1NnQWFjSllaMWVvNlBDT0JISFFqbnRIbnBJUVFNVzZyNi9DRUJFWk5CZTFjTWExa2dFcTZRanlBSnlSUTlTSzJLUzBwaUdHV25Ya2FQU1c4SU1IZktUS0c3ZWVsQk1FQSs2eTREQzlJR0xhVU5BWEpsak9rQkdGN1lKeTlJT0dzdjRwY3U1NFNvcFFtWm9uTGNKc0VyWmhOcFNZNTgzYzRFeFJ5T3FYRWdDUmMzT1p5WlRDanBKb1c3SStKMU9PeVVUZVg0WGdOWmRwK2dRcWlkRGFiODNXdlk4Q2VvekR5RllpdU50ZVZDcXBDcHM3OVgzRUpBNUpBaC9zT2NHTXVITWYrR0xZTkhTYXBOWTZPSDhiMlRQVVlTTlQ1enpVQm1wUG9JdUVWZklJMmdzb205Y3hnb0RpenFFbGhHVmZWZXhKaTg0TXVRS1djQi9QVE9UNkgwMDFzRzJtamVsK1BJVDZKRWVpd2pHZWs4S09XYWhaVFVxQ2VjT2hLOW9mbnY4RHZGdFF1UEN3dW9ROEptdk5oRkU4bVQzSzkzMVRETk9ENnhFQS9SSnFpZTdPWjR6TW00YmNxdEhyK1U0ZzRpSDM0dWpqSmw2SW5ndmRxMW5kenErTFdoNFIyTTdYd0J0cEZNZ2hkamgyd2p5YVpwYUFQdXdPcG9zTGZ0Uk5KbVUrR2U3SkpjUmN0ZE9JWjc5b3NMcW1rMDd3akNMaVZUdnUrbUlCa1VNYVVNTkpQWUJCTWRSOGtvZkpwalBuOWtQR0NTR3Qza2ltT3hRUWUvbUp4Q1lINERnVGNnRDVmRE10blNRWW9OMVcwcW1WbW1raFNXMFBIbCsyQnI0M3NzMjFIeDUyb0wxTDFwQk9ORjRuOFdWeUFRNEw2dmZ6b0gzeG1Wa1JHUUtUOGtORDFxc2krUXlJalVsMm5OZ2ZDeTFCTklkeFlDMklPVGpHenN3TlNSSGdOTS9nbmtkK0xDM0RVRWQ3UGRXSjgzNnhBRFRONHUwaXRER3l3MVBoWHZvR0wrMHNJdXdmaU5oZFpoSDNFU0h1enVBQ0hCRWJ3emVLQ0gwOVFGcHBObXlPeU41M3J1VzhJdFZUOU4xVGdYTlRVdDBUZStaL0lCMUlFV09uTTVuRm5TcWN6QTQ5UkdSWVhVN1RvL0RaWTdXZzFhdy9TUlJTcmJtRWpqdU1WSExnTEtabHFVdUlGQ1ZUb0pweU4zYmlEY3lSTHhFbXd4V1ZBeEluWkpsQkxkeDFCYjV6RVFPMzZMZ2J3aXlJVDZqeXE3MmFDRlNKdjNrZ2d5MjRIZmJjVGRmSmpubStaWklnNENkaEtSNWU3QmxSTjVDOUV5dmVLNHhWbFNvU0RZYWczQXIxOWQ0cE1HcDhrV3M4bDN1TTVMbUhRV3JGcFBHOWl5OGFaZE0wV3lGZ0FHUy9LSU9HUVFIVDhVbXp0bDZ0QVZIdndJdG9XSUJYdmlFeTBzcmM3WWFLODk2OG0rdjRHS1JSZXZwWmdKb0o3N0VlWGxnVThxaFRxZ0NKZkZubUYrT1pXNC9tZGtzcmZpTFRNL2RoQW4wQ2xQTWRMUHRvbHNuVjBtbGxraHdSY3lzZjlIazcxZTR0YjNBZlhtMGgvZEJsWDFJM1o0R0ZFZHg5djN3NHAxWmVUVUtSM0tpR2xSNmQzbEJsaWdwbitPTzVkTndGWmxGNE1iRU5aL0FEeXQ1a3N3bW00UldUOTR0TUR0Nml1TEtJdG9rK2ZHVzdXei9VTHB6TXc4ek1adGY4V0QrcW5jV0Nrai94UjVCaUtzdzZSTG1kMFZZckw0QWYzWThrUGttbTBDUVFyTG9VWVZGa2xMdmhKaUxGNFdadHRsSmVNOWhZWk90eEh4L3ZaQnRoV0lNRzdjYUU3R1AwTlhmMU1nYndXQS8xMDhtbWVLZ1gvNUo1TFVGRnY5YmNpOWRTSVBHenlJSjVPMU1JRkM3L0VyWjdrWmRHbE5SMG1OZUo1a0laVXRGV2FUb2xDU2hjWnhwN2VJdEptbHZWVzBPRWgybGc3VGRYMmJaSFhGNmJ1TjQyWFZ0UEo5MEhFbGxSRW5DSUJ1L0JWRHVnZjc5TUlCQkh0LzBBcUlHVFlCcDRoN0xKVGtFczhobTJlWnp5bFZOQ09mNDIrdlI4aTFpVmJpblZxRk9JSzdpdzNVZk1VOFJqb3lRcVVhL1g1R0RKVkZReFJDL2NzR2kyeTJYcEkwMkhTOUZVRHBPZjlQak1SYmdKaXNYR1JJM1NuNHpRRFNVMWdCcUs0WEhJNFU0SUg2MXFMSUQ3RFBybWswRDUwZUtSSXlxSEVMeTFQcForNk9FcG5MMlhVUDlUYldQZnhVc2lKa01weDFwZmwxQi9YU1FFVWdJNUNSUGxxRENpZVZDQ21wZ3F5TElvazcva3R3akJwY0RIUWZnek5yM2lwSlltZmUraGpGQjhRMlJFMUlxVHpMblBXQWVwT05tRWpMdVNlMDVDT0NSQkJDaU9NZExiVC9ORXMzRTIzb1FUOFRCeTlQZGkwZnhYdlVYY0NqK29SM092NHlUNlNvSVY5WG5vME5OM04vcjArRDkzVy9vQTFzL0JXanVQT2RoUG9CZFpneU5keC9nRFJhVFJQNm9wUnNKOHNzWkN5OEdkYUhhUlBqNnRhWW9COXoyY1d0U2NQbW5SS0MrN2plRjcydG53U0VRZStlemZENWhpRStOaUdXdkRmVVZ1ZHU1Q2NzSm41RVJJUEFlUHZmeHFwdkFuVlE5SGRic2pPbTlNODNXYjY5Slo2Sit2UlQrU3FST0MyTnFLdjVrREd3NzRDTVphVzhhVENOSXVCRWlRSTdDRlplSkNvL1BpNzJCT0tFdldRTnNMTzB0UGlaZmNRaFIrWkJjbHM2NGt0ckVhWFhHbWVyWlYrZlJTWDllZDY3QnZnNGdCbWZIUnMxc1VqWER4QkNneW96VzRpL2k3MHJIWE1HUE55emdVWllxMDRHZUVkTkZTWXBjNDV4MzRHVmtWUFFpQkdyNTZrZ3lOcUhJbTBnK2lZY25JUVRXeTdTWU5FNktoZ2pmc0RVT3ZySzVHb0wrdkJnRGtjdFJHTXVEcWtZU1lYUDJDN1dPRDJFc1FlWVRyZUNwc1NxcTA2UU44Y2x6Z1FUWGh2OUt3VmlxWHlpYWI5bWdTc3kwM2QrK1dHMlBLQnRCTnB0cGt4TWFuTWlldmtUaGxDdG1paEwrY1NNN3lkZHVwWFA3YUJpRzVuVkMxay96dTJxY1lOSVF0WU1ZZG4wUGwzakZNYjR2cFl3TXhOZWtHR2tDazY2OHhIc0RJcmdxaFU4QU1iMkZMUGtEdHN4MzBmd2lBUjhjV0tQbGxWb3ZCejIybFBSSTFVUEM1bUxtcEJmdXl2a0VEblkxNWxRL3c0NjNLZzVzaEpNbTJEakh1UWlDL1IvaU1tV1pYWDc4b1ZNdWlqUXhqbHRmRmoxMnF5UHVOWHI3UE1aT0tiN05pbk5YMUY4RjNTWENMV0h6dm9uelVKNTd5QkxpUkJGRzZtWGVNM2F4dDBNVW5CSk9IeUNCMllEK3JIck9JblBDTWhEaXhQWTdmNWxPWlYrckVSMjh4M3pXc3VLby9RcVVYTDZmUzc2czIrQTg5SmlDT0JqQ3Q4UmpLVWpLem1JeFVUVkEzeDd1dlovZ2dDWHU3MWI3a0YrUnU4VzJtT0dqSzBRRTVXMlBrMFcxSE55aDRNWW5aZ0t5UTgyZUNVcGZ2OGUzNmc5Z0c3TWRZeVg0SzUzRzgreTZNMTdsS1REdjJZT29WQ1dkeGdwc0QwY1ZUeVJrSWk5R09GRWJNMnJwa0h1aURoNHlRanBiaWhIYjZlOS9sMUtnSVVCVUZDSEpvNnB4N1FVRWxCeVRLTEZhZjV6TVFxL1RxOFRqNG9sbVc0R2lQdFE3cWZZcnVzMXN3NVNyazhyS0JJU0VRaUliYXA1VTduemFicjFtZHNTQ0Y2V05yNXJiYjVRdjNmR1VpYlJwbVBvdmVMZ2lXaE44aUgxUEt3OVQ0eklWZGpFSldVNWxoVDFaWFBDV1E2eWwvbDJWNWgreXcxaTcxbm1OUkVXaWdhRWhLaFV0THUxR0FjVDZ2T052dE5pUDk1a0RPUjQ0aytZK1M5TE01bzFLdi9yY0FHTmJ6Y2R6ZVI2TUZha3o4YkZJcVNoR1RReFkvVmtNR1FySXc2Szdla05tcEtzK3B0cVpTb1dxdU1MWTVNSkVkamxqNnFUZXNsWExzdHRxL3I2ZlEvMTNDYW1NN1gvM2VoblhzY1lpUWM4dzN3WDlEMGg1SWhJUmxzODJtSE1xcFhBVjIvZ0ZVUDZEYzIvQWtHdmllRmJiSE44aTNIbTZHakk3cEdnV3NqbzB3SzJ0TnZadzhoRC9nSWlNMVB3aGxVWVo4QUFBQUFTVVZPUks1Q1lJST0iIGlkPSJiIiB3aWR0aD0iOTciIGhlaWdodD0iNzEiIGRhdGEtbmFtZT0icmVkaGF0LnBuZyIvPgogIDwvZGVmcz4KPC9zdmc+"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(e,t){void 0===t&&(t=0);var a=s.useRef(!1),i=s.useRef(),n=s.useRef(e),l=s.useCallback((function(){return a.current}),[]),r=s.useCallback((function(){a.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){a.current=!0,n.current()}),t)}),[t]),o=s.useCallback((function(){a.current=null,i.current&&clearTimeout(i.current)}),[]);return s.useEffect((function(){n.current=e}),[e]),s.useEffect((function(){return r(),o}),[t]),[l,o,r]}},function(e,t,a){var s,i;void 0===(i="function"==typeof(s=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,a,s=e.replace(/^v/,"").replace(/\+.*$/,""),i=(a="-",-1===(t=s).indexOf(a)?t.length:t.indexOf(a)),n=s.substring(0,i).split(".");return n.push(s.substring(i+1)),n}function a(e){return isNaN(Number(e))?e:Number(e)}function s(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function i(e,i){[e,i].forEach(s);for(var n=t(e),l=t(i),r=0;r<Math.max(n.length-1,l.length-1);r++){var o=parseInt(n[r]||0,10),u=parseInt(l[r]||0,10);if(o>u)return 1;if(u>o)return-1}var c=n[n.length-1],d=l[l.length-1];if(c&&d){var b=c.split(".").map(a),p=d.split(".").map(a);for(r=0;r<Math.max(b.length,p.length);r++){if(void 0===b[r]||"string"==typeof p[r]&&"number"==typeof b[r])return-1;if(void 0===p[r]||"string"==typeof b[r]&&"number"==typeof p[r])return 1;if(b[r]>p[r])return 1;if(p[r]>b[r])return-1}}else if(c||d)return c?-1:1;return 0}var n=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return i.compare=function(e,t,a){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===n.indexOf(e))throw new TypeError("Invalid operator, expected one of "+n.join("|"))}(a);var s=i(e,t);return l[a].indexOf(s)>-1},i})?s.apply(t,[]):s)||(e.exports=i)},,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"CspRouter",(function(){return Bu})),a.d(t,"default",(function(){return Bu}));var s=a(5),i=a.n(s),n=a(1),l=a.n(n),r=a(21),o=a(22),u=a(24),c=a.n(u),d=a(51);const b={services:{}},p=Object(n.createContext)(b);var g=a(165),m=a.n(g),j=a(0);const x=({children:e,component:t,render:a,...s})=>{const r=Object(n.useMemo)((()=>{if(t)return e=>Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(f,null),Object(j.jsx)(t,e))}),[t]);if(r)return Object(j.jsx)(o.Route,i()({},s,{component:r}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(j.jsx)(o.Route,i()({},s,{render:e=>Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(f,null),t(e))}))}return Object(j.jsx)(o.Route,s,Object(j.jsx)(f,null),e)},f=()=>{const{executionContext:e}=Object(n.useContext)(p).services,t=Object(o.useRouteMatch)();return function(e,t){m()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null},h=({legacySwitch:e=!0,children:t})=>{const a=Object(o.useRouteMatch)();return e?Object(j.jsx)(o.Switch,null,t):Object(j.jsx)(d.Routes,null,n.Children.map(t,(e=>{if(l.a.isValidElement(e)&&e.type===x){var s;const i=Object(u.replace)(null==e?void 0:e.props.path,a.url+"/",""),n="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(j.jsx)(d.Route,{path:i,element:Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(f,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(j.jsx)(e.props.component,null)||n&&n()||t)})}return e})))};var O=a(4);const v=l.a.createContext(void 0),y=()=>Object(n.useContext)(v);var T=a(63),k=a.n(T),C=a(6),E=a(20),S=a(38),F=a(2),w=a(54);const M=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(["csp_status_key"],(()=>t.get(F.W,{version:F.V})),e)};var _=a(3),R=a(9),I=a(25),N=a(31);const D=()=>{const{http:e}=Object(w.a)().services;return Object(r.useQuery)(["integrations"],(()=>e.get(N.epmRouteService.getInfoPath(F.t),{version:N.API_VERSIONS.public.v1})))},P=["csp_benchmark_integrations_v2"],V=()=>{const{http:e}=Object(w.a)().services;return Object(r.useQuery)(P,(()=>e.get(F.c,{version:"2"})),{keepPreviousData:!0})},G=({postureType:e})=>{var t;const{http:a}=Object(w.a)().services,s=D(),i=(({name:e,perPage:t,page:a,sortField:s,sortOrder:i})=>{const{http:n}=Object(w.a)().services,l={package_policy_name:e,per_page:t,page:a,sort_field:s,sort_order:i};return Object(r.useQuery)(["csp_benchmark_integrations_v1",l],(()=>n.get(F.c,{query:l,version:"1"})),{keepPreviousData:!0})})({name:"",page:1,perPage:100,sortField:"package_policy.name",sortOrder:"asc"});if(!s.isSuccess)return;const n=null===(t=i.data)||void 0===t?void 0:t.items,l=null==n?void 0:n.find((t=>{var a,s,i;return(null==t||null===(a=t.package_policy)||void 0===a||null===(s=a.inputs)||void 0===s||null===(i=s.find((e=>null==e?void 0:e.enabled)))||void 0===i?void 0:i.policy_template)===e})),o=(null==l?void 0:l.agent_policy.id)||"",u=(null==l?void 0:l.package_policy.id)||"",c=I.pagePathGetters.integration_details_policies({addAgentToPolicyId:o,integration:u,pkgkey:Object(I.pkgKeyFromPackageInfo)({name:s.data.item.name,version:s.data.item.version})}).join("");return a.basePath.prepend(c)};var A=a(55),L=a(8);const z=()=>{const e=(()=>{const{share:e}=Object(w.a)().services,t=e.url.locators.get("LICENSE_MANAGEMENT_LOCATOR");if(t)return()=>t.navigate({page:"dashboard"})})();return Object(j.jsx)(C.EuiPageSection,{color:"danger",alignment:"center"},Object(j.jsx)(C.EuiEmptyPrompt,{iconType:"warning",title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptTitle",defaultMessage:"Upgrade for subscription features"})),body:e?Object(j.jsx)("p",{"data-test-subj":"has_locator"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptDescription",defaultMessage:"To use these cloud security features, you must {link}.",values:{link:Object(j.jsx)(C.EuiLink,{onClick:e},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptLinkText",defaultMessage:"start a trial or upgrade your subscription"}))}})):Object(j.jsx)("p",{"data-test-subj":"no_locator"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptDescriptionNoLocator",defaultMessage:"Contact your administrator to change your license."}))}))};var B=a(13);const U="Cloud Security";var H=a(12);const W=e=>{var t,a,s;return!!(null!=e&&e.body&&null!=e&&null!==(t=e.body)&&void 0!==t&&t.error&&null!=e&&null!==(a=e.body)&&void 0!==a&&a.message&&null!=e&&null!==(s=e.body)&&void 0!==s&&s.statusCode)};var Q={name:"14cfceb",styles:">:nth-child(3){display:block;margin:auto;width:450px;}"};const Z=({pageTitle:e,docsLink:t,actionHref:a,actionTitle:s,actionDescription:i,testId:n})=>Object(j.jsx)(L.NoDataPage,{"data-test-subj":n,css:Q,pageTitle:e,solution:_.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:t,logo:"logoSecurity",actions:{elasticAgent:{href:a,isDisabled:!a,title:s,description:i}}}),J=()=>Object(j.jsx)(H.a,{"data-test-subj":"cloud_posture_page_loading"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.loadingDescription",defaultMessage:"Loading..."})),q=e=>Object(j.jsx)(R.a,null,Object(j.jsx)(C.EuiEmptyPrompt,{color:"danger",iconType:"warning","data-test-subj":"cloud_posture_page_error",title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorTitle",defaultMessage:"We couldn't fetch your cloud security posture data"})),body:W(e)?Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorDescription",defaultMessage:"{error} {statusCode}: {body}",values:{error:e.body.error,statusCode:e.body.statusCode,body:e.body.message}})):void 0})),K=()=>Object(j.jsx)(R.a,null,Object(j.jsx)(L.NoDataPage,{"data-test-subj":"cloud_posture_page_no_data",pageTitle:_.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.pageTitle",{defaultMessage:"No data found"}),solution:_.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:"https://www.elastic.co/guide/index.html",logo:"logoSecurity",actions:{}})),$=({children:e,query:t,loadingRender:a=J,errorRender:s=q,noDataRenderer:i=K})=>{const o=(()=>{const{licensing:e}=Object(w.a)().services,{isCloudEnabled:t}=Object(n.useContext)(B.a);return Object(r.useQuery)(["csp_subscription_query_key"],(async()=>{const a=await e.refresh();return((e,t)=>!!e||!!t&&"valid"===t.check(U,"enterprise").state)(t,a)}))})();return Object(j.jsx)(l.a.Fragment,null,o.isError?q(o.error):o.isLoading?J():o.data?t?t.isError?s(t.error):t.isLoading?a():t.data?e:i():e:Object(j.jsx)(R.a,{"data-test-subj":"cloud_posture_page_subscription_not_allowed"},Object(j.jsx)(z,null)))};var Y=a(72),X=a.n(Y);const ee=e=>{const{http:t}=Object(w.a)().services,a=D();if(!a.isSuccess)return;const s=I.pagePathGetters.add_integration_to_policy({integration:e,pkgkey:Object(I.pkgKeyFromPackageInfo)({name:a.data.item.name,version:a.data.item.version})}).join("");return t.basePath.prepend(s)};var te=a(53);const ae=({postureType:e})=>{const t=G({postureType:e});return Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.u.NO_AGENTS_DEPLOYED,color:"plain",iconType:"fleetApp",title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedTitle",defaultMessage:"No Agents Installed"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedDescription",defaultMessage:"In order to begin detecting security misconfigurations, you'll need to deploy elastic-agent into the cloud account or Kubernetes cluster you want to monitor."})),actions:[Object(j.jsx)(C.EuiButton,{fill:!0,href:t,isDisabled:!t},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedButtonTitle",defaultMessage:"Install Agent"}))]})},se=()=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.u.INDEXING,color:"plain",icon:Object(j.jsx)(C.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingButtonTitle",defaultMessage:"Posture evaluation underway"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingDescription",defaultMessage:"Waiting for data to be collected and indexed. Check back later to see your findings"}))}),ie=()=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.u.INDEX_TIMEOUT,color:"plain",icon:Object(j.jsx)(C.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutTitle",defaultMessage:"Waiting for Findings data"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutDescription",defaultMessage:"Collecting findings is taking longer than expected. {docs}.",values:{docs:Object(j.jsx)(C.EuiLink,{href:"https://ela.st/findings",target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutDocLink",defaultMessage:"Learn more"}))}}))});var ne={name:"1b7vz4z",styles:"text-align:initial"};const le=({unprivilegedIndices:e})=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.u.UNPRIVILEGED,color:"plain",icon:Object(j.jsx)(C.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedTitle",defaultMessage:"Privileges required"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedDescription",defaultMessage:"To view cloud posture data, you must update privileges. For more information, contact your Kibana administrator."})),footer:Object(j.jsx)(C.EuiMarkdownFormat,{css:ne,children:_.i18n.translate("xpack.csp.noFindingsStates.unprivileged.unprivilegedFooterMarkdown",{defaultMessage:"Required Elasticsearch index privilege `read` for the following indices:"})+e.map((e=>`\n- \`${e}\``))})}),re=()=>{const e=ee(F.J),t=ee(F.v);return Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":"cloud_posture_page_package_not_installed",icon:Object(j.jsx)(C.EuiImage,{size:"fullWidth",src:X.a,alt:"",role:"presentation"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.promptTitle",defaultMessage:"Detect security misconfigurations in your cloud infrastructure!"})),layout:"horizontal",color:"plain",body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.promptDescription",defaultMessage:"Detect and remediate potential configuration risks in your cloud infrastructure, like publicly accessible S3 buckets, with our Cloud and Kubernetes Security Posture Management solutions. {learnMore}",values:{learnMore:Object(j.jsx)(C.EuiLink,{href:O.d.cspm.overviewPath,target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.learnMoreTitle",defaultMessage:"Learn more about Cloud Security Posture"}))}})),actions:Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButton,{color:"primary",fill:!0,href:t,isDisabled:!t,"data-test-subj":A.j},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.addCspmIntegrationButtonTitle",defaultMessage:"Add CSPM Integration"}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButton,{color:"primary",fill:!0,href:e,isDisabled:!e,"data-test-subj":A.t},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.addKspmIntegrationButtonTitle",defaultMessage:"Add KSPM Integration"}))))})},oe=({postureType:e,status:t,indicesStatus:a,isNotInstalled:s})=>{const i=a&&a.filter((e=>"unprivileged"===e.status)).map((e=>e.index)).sort(((e,t)=>e.localeCompare(t)));return"unprivileged"===t?Object(j.jsx)(le,{unprivilegedIndices:i||[]}):"indexing"===t||"waiting_for_results"===t?Object(j.jsx)(se,null):"index-timeout"===t?Object(j.jsx)(ie,null):s?Object(j.jsx)(re,null):"not-deployed"===t?Object(j.jsx)(ae,{postureType:e}):null},ue=({postureType:e})=>{var t,a,s,i,n;const l=M({refetchInterval:te.r}),r=null===(t=l.data)||void 0===t||null===(a=t.kspm)||void 0===a?void 0:a.status,o=null===(s=l.data)||void 0===s||null===(i=s.cspm)||void 0===i?void 0:i.status,u=null===(n=l.data)||void 0===n?void 0:n.indicesDetails,c="cspm"===e?o:r,d="not-installed"===r&&"not-installed"===o;return Object(j.jsx)($,{query:l},Object(j.jsx)(R.a,null,Object(j.jsx)(oe,{postureType:e,status:c,indicesStatus:u,isNotInstalled:d})))},ce=e=>{const{data:{dataViews:t}}=Object(L.useKibana)().services;return Object(r.useQuery)(["useDataView",e],(async()=>{const[a]=await t.find(e);if(!a)throw new Error(`Data view not found [${e}]`);return a}))};var de=a(140),be=a.n(de),pe={name:"p3n7py",styles:"width:290px"};const ge=({onResetFilters:e,docsUrl:t=te.f})=>{const{euiTheme:a}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiEmptyPrompt,{css:Object(j.css)("max-width:734px;&&>.euiEmptyPrompt__main{gap:",a.size.xl,";}&&{margin-top:",a.size.xxxl,";}",""),"data-test-subj":A.r,icon:Object(j.jsx)(C.EuiImage,{url:be.a,alt:_.i18n.translate("xpack.csp.emptyState.illustrationAlt",{defaultMessage:"No results"}),css:pe}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.emptyState.title",defaultMessage:"No results match your search criteria"})),layout:"horizontal",color:"plain",body:Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.emptyState.description",defaultMessage:"Try modifying your search or filter set"}))),actions:[Object(j.jsx)(C.EuiButton,{color:"primary",fill:!0,onClick:e},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.emptyState.resetFiltersButton",defaultMessage:"Reset filters"})),Object(j.jsx)(C.EuiLink,{href:t,target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.emptyState.readDocsLink",defaultMessage:"Read the docs"}))]})};let me=function(e){return e.updateActiveGroups="UPDATE_ACTIVE_GROUPS",e.updateGroupOptions="UPDATE_GROUP_OPTIONS",e}({});const je={},xe={activeGroups:["none"],options:[]},fe=e=>_.i18n.translate("grouping.total.unit",{values:{totalCount:e,groupCount:e.toLocaleString()},defaultMessage:"{groupCount} {totalCount, plural, =1 {group} other {groups}}"}),he=_.i18n.translate("grouping.additionalActions.takeAction",{defaultMessage:"Take actions"}),Oe=_.i18n.translate("grouping.alerts.label",{defaultMessage:"Group alerts by"}),ve=_.i18n.translate("grouping.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),ye=_.i18n.translate("grouping.groupBySingleField",{defaultMessage:"Select grouping"}),Te=_.i18n.translate("grouping.noneGroupByOptionName",{defaultMessage:"None"}),ke=_.i18n.translate("grouping.customGroupByOptionName",{defaultMessage:"Custom field"}),Ce=e=>{return t=e,_.i18n.translate("grouping.eventsTab.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"});var t},Ee="groups",Se=e=>{const t=e.getItem(Ee);return t?JSON.parse(t):je},Fe=window.localStorage,we={groupById:je},Me=(e,t)=>{let a={};Fe&&(a=Se(Fe));const s=((e,t,a)=>{switch(t.type){case me.updateActiveGroups:{const{id:s,activeGroups:i}=t.payload;return{...e,groupById:{...a,[s]:{...xe,...a[s],activeGroups:i}}}}case me.updateGroupOptions:{const{id:s,newOptionList:i}=t.payload;return{...e,groupById:{...a,[s]:{...xe,...a[s],options:i}}}}}throw Error("Unknown grouping action")})(e,t,{...e.groupById,...a});if(Fe){const e=t.payload.id;((e,t,a)=>{const s=Se(e);e.setItem(Ee,JSON.stringify({...s,[t]:a}))})(Fe,e,s.groupById[e])}return s},_e=e=>!!e.find((e=>"none"===e)),Re=(e,t)=>(e=>e.groups.groupById)(e)[t],Ie=({activeGroups:e,id:t})=>({payload:{activeGroups:e,id:t},type:me.updateActiveGroups});var Ne=a(39),De=a(10),Pe=a.n(De);const Ve={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends l.a.PureComponent{constructor(...e){super(...e),Pe()(this,"state",Ve),Pe()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),Pe()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,a=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),s=!this.state.selectedOptions.length;return Object(j.jsx)("div",{"data-test-subj":"custom-field-panel",style:{padding:16}},Object(j.jsx)(C.EuiForm,null,Object(j.jsx)(C.EuiFormRow,{label:_.i18n.translate("grouping.groupSelector.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:_.i18n.translate("grouping.groupSelector.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},Object(j.jsx)(C.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:_.i18n.translate("grouping.groupSelector.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:a,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),Object(j.jsx)(C.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:s,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},_.i18n.translate("grouping.selector.grouping.label.add",{defaultMessage:"Add"}))))}}Pe()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");var Ge=a(45),Ae=a(23);const Le=Object(j.css)("font-size:",Ae.euiThemeVars.euiFontSizeXS,";font-weight:",Ae.euiThemeVars.euiFontWeightSemiBold,";border-right:",Ae.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;",""),ze=Object(j.css)("font-size:",Ae.euiThemeVars.euiFontSizeXS,";font-weight:",Ae.euiThemeVars.euiFontWeightSemiBold,";border-right:",Ae.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;.smallDot{width:3px!important;display:inline-block;}.euiBadge__text{text-align:center;width:100%;}",""),Be=Object(j.css)(".groupingAccordionForm .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:",Ae.euiThemeVars.euiBorderThin,";border-right:",Ae.euiThemeVars.euiBorderThin,";border-bottom:",Ae.euiThemeVars.euiBorderThin,";border-radius:0 0 6px 6px;}.groupingAccordionForm .euiAccordion__triggerWrapper{border-bottom:",Ae.euiThemeVars.euiBorderThin,";border-left:",Ae.euiThemeVars.euiBorderThin,";border-right:",Ae.euiThemeVars.euiBorderThin,";border-radius:6px;min-height:78px;padding-left:16px;padding-right:16px;}.groupingAccordionForm{border-top:",Ae.euiThemeVars.euiBorderThin,";border-bottom:none;border-radius:6px;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),Ue=Object(j.css)(".groupingAccordionFormLevel .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:none;border-right:none;border-bottom:",Ae.euiThemeVars.euiBorderThin,";border-radius:0;}.groupingAccordionFormLevel .euiAccordion__triggerWrapper{border-bottom:",Ae.euiThemeVars.euiBorderThin,";border-left:none;border-right:none;min-height:78px;padding-left:16px;padding-right:16px;border-radius:0;}.groupingAccordionFormLevel{border-top:none;border-bottom:none;border-radius:0;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),He=Object(Ge.euiStyled)(C.EuiContextMenu)`
  width: 250px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .euiContextMenuItem {
    border-bottom: ${Ae.euiThemeVars.euiBorderThin};
  }
  .euiContextMenuItem:last-child {
    border: none;
  }
`,We=Object(Ge.euiStyled)(C.EuiButtonEmpty)`
  font-weight: 'normal';

  .euiButtonEmpty__text {
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,Qe=({"data-test-subj":e,fields:t,groupsSelected:a=["none"],onGroupChange:s,options:i,title:l=Oe,maxGroupingLevels:r=1})=>{const[o,u]=Object(n.useState)(!1),c=Object(n.useCallback)((e=>!!a.find((t=>t===e))),[a]),d=Object(n.useMemo)((()=>{const e=e=>1!==r&&!(a.length!==r||e&&c(e));return[{id:"firstPanel",title:1===r?ye:(n=r,_.i18n.translate("grouping.groupByPanelTitle",{values:{groupingLevelsCount:n},defaultMessage:"Select up to {groupingLevelsCount} groupings"})),items:[{"data-test-subj":"panel-none",name:Te,icon:c("none")?"check":"empty",onClick:()=>s("none")},...i.map((t=>({"data-test-subj":`panel-${t.key}`,disabled:e(t.key),name:t.label,onClick:()=>s(t.key),icon:c(t.key)?"check":"empty"}))),{"data-test-subj":"panel-custom",name:ke,icon:"empty",disabled:e(),panel:"customPanel",hasPanel:!0}]},{id:"customPanel",title:ve,width:685,content:Object(j.jsx)(custom_field_panel_CustomFieldPanel,{currentOptions:i.map((e=>({text:e.label,field:e.key}))),onSubmit:e=>{s(e),u(!1)},fields:t})}];var n}),[t,a.length,c,r,s,i]),b=Object(n.useMemo)((()=>i.filter((e=>c(e.key)))),[c,i]),p=Object(n.useCallback)((()=>u((e=>!e))),[]),g=Object(n.useCallback)((()=>u(!1)),[]),m=Object(n.useMemo)((()=>{const e=c("none")?Te:a.reduce(((e,t)=>{const a=b.find((e=>e.key===t));return null==a?e:e?[e,a.label].join(", "):a.label}),"");return Object(j.jsx)(We,{"data-test-subj":"group-selector-dropdown",flush:"both",iconSide:"right",iconSize:"s",iconType:"arrowDown",onClick:p,title:e,size:"xs"},`${l}: ${e}`)}),[a,c,p,b,l]);return Object(j.jsx)(C.EuiPopover,{"data-test-subj":null!=e?e:"groupByPopover",button:m,closePopover:g,isOpen:o,panelPaddingSize:"none"},Object(j.jsx)(He,{"data-test-subj":"groupByContextMenu",initialPanelId:"firstPanel",panels:d}))},Ze=l.a.memo(Qe);var Je=function(e){return e.GROUP_TOGGLED="alerts_table_toggled_",e.GROUPED_ALERTS="alerts_table_group_by_",e}(Je||{});var qe=a(26);const Ke=(e,t)=>null!=t&&t.length>0?t.reduce(((t,a)=>[...t,{meta:{alias:null,disabled:!1,key:e,negate:!1,params:{query:a},type:"phrase"},query:{match_phrase:{[e]:{query:a}}}}]),[{meta:{alias:null,disabled:!1,type:qe.FILTERS.CUSTOM,negate:!1,key:e},query:{script:{script:{source:"doc[params['field']].size()==params['size']",params:{field:e,size:t.length}}}}}]):[],$e=e=>[{meta:{disabled:!1,negate:!0,alias:null,key:e,value:"exists",type:"exists"},query:{exists:{field:e}}}],Ye=({isNullGroup:e,title:t,nullGroupMessage:a})=>Object(j.jsx)("div",null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(j.jsx)(C.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},Object(j.jsx)(C.EuiTitle,{size:"xs"},Object(j.jsx)("h4",{className:"eui-textTruncate",title:t},t))),e&&a&&Object(j.jsx)(C.EuiFlexItem,{grow:!1,"data-test-subj":"null-group-icon"},Object(j.jsx)(C.EuiIconTip,{content:a,position:"right"})))),Xe=({customAccordionButtonClassName:e,customAccordionClassName:t="groupingAccordionForm",extraAction:a,forceState:s,groupBucket:i,groupPanelRenderer:l,groupingLevel:r=0,isLoading:o,isNullGroup:u=!1,onGroupClose:c,onToggleGroup:d,renderChildComponent:b,selectedGroup:p,nullGroupMessage:g})=>{const m=Object(n.useRef)(s);Object(n.useEffect)((()=>{"open"===m.current&&"closed"===s?(c(),m.current="closed"):"closed"===m.current&&"open"===s&&(m.current="open")}),[c,s,p]);const x=Object(n.useMemo)((()=>i.selectedGroup===p?{asString:i.key_as_string,asArray:i.key}:{asString:null,asArray:null}),[i.key,i.key_as_string,i.selectedGroup,p]),f=Object(n.useMemo)((()=>u?$e(p):Ke(p,x.asArray)),[x.asArray,u,p]),h=Object(n.useCallback)((e=>{d&&d(e,i)}),[i,d]);return x.asString?Object(j.jsx)(C.EuiAccordion,{buttonClassName:e,buttonContent:Object(j.jsx)("div",{"data-test-subj":"group-panel-toggle",className:"groupingPanelRenderer"},null!=l?l:Object(j.jsx)(Ye,{title:x.asString,isNullGroup:u,nullGroupMessage:g})),buttonElement:"div",className:r>0?"groupingAccordionFormLevel":t,"data-test-subj":"grouping-accordion",extraAction:a,forceState:s,isLoading:o,id:`group${r}-${x.asString}`,onToggle:h,paddingSize:"m"},Object(j.jsx)("span",{"data-test-subj":"grouping-accordion-content"},b(f))):null},et=l.a.memo(Xe),tt=({bucketKey:e,groupFilter:t,groupNumber:a,onTakeActionsOpen:s,statRenderers:i,takeActionItems:l})=>{const[r,o]=Object(n.useState)(!1),[u,c]=Object(n.useState)([]),d=Object(n.useCallback)((()=>(r||0!==u.length||c(l(t,a)),!r&&s?s():o(!r))),[l,t,a,r,s,u.length]),b=Object(n.useMemo)((()=>null==i?void 0:i.map((e=>{var t,a;const{dataTestSubj:s,component:i}=null!=e.badge?{dataTestSubj:`metric-${e.title}`,component:Object(j.jsx)(C.EuiToolTip,{position:"top",content:e.badge.value},Object(j.jsx)(C.EuiBadge,{style:{marginLeft:10,width:null!==(t=e.badge.width)&&void 0!==t?t:35},color:null!==(a=e.badge.color)&&void 0!==a?a:"hollow"},e.badge.value>99?"99+":e.badge.value.toString()))}:{dataTestSubj:`customMetric-${e.title}`,component:e.renderer};return Object(j.jsx)(C.EuiFlexItem,{grow:!1,key:e.title},Object(j.jsx)("span",{css:ze,"data-test-subj":s},e.title,i))}))),[i]),p=Object(n.useMemo)((()=>Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPopover,{anchorPosition:"downLeft",button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"take-action-button",onClick:d,iconType:"arrowDown",iconSide:"right"},he),closePopover:()=>o(!1),isOpen:r,panelPaddingSize:"none"},Object(j.jsx)(C.EuiContextMenuPanel,{items:u})))),[r,d,u]);return Object(j.jsx)(C.EuiFlexGroup,{"data-test-subj":"group-stats",key:`stats-${e}`,gutterSize:"none",alignItems:"center"},b,p)},at=l.a.memo(tt);a(86);var st=a(87),it=a.n(st);a(88),a(89);const nt={maxWidth:500},lt={tall:490,short:250},rt=({height:e="tall"})=>Object(j.jsx)(C.EuiPanel,{color:"subdued","data-test-subj":"empty-results-panel"},Object(j.jsx)(C.EuiFlexGroup,{style:{height:lt[e]},alignItems:"center",justifyContent:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPanel,{hasBorder:!0,style:nt},Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)(C.EuiTitle,null,Object(j.jsx)("h3",null,Object(j.jsx)(E.FormattedMessage,{id:"grouping.empty.title",defaultMessage:"No grouping results match your selected Group alerts field"}))),Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"grouping.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your Group alerts field"})))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiImage,{size:"200px",alt:"",src:it.a}))))))),ot=({activePage:e,data:t,groupPanelRenderer:a,groupSelector:s,groupStatsRenderer:i,groupingId:r,groupingLevel:o=0,inspectButton:u,isLoading:c,itemsPerPage:d,onChangeGroupsItemsPerPage:b,onChangeGroupsPage:p,onGroupClose:g,onGroupToggle:m,renderChildComponent:x,selectedGroup:f,takeActionItems:h,tracker:O,unit:v=Ce,groupsUnit:y=fe})=>{var T,k,E,S;const[F,w]=Object(n.useState)({}),M=Object(n.useMemo)((()=>{var e,a;return null!==(e=null==t||null===(a=t.unitsCount)||void 0===a?void 0:a.value)&&void 0!==e?e:0}),[null==t||null===(T=t.unitsCount)||void 0===T?void 0:T.value]),R=Object(n.useMemo)((()=>`${M.toLocaleString()} ${v&&v(M)}`),[M,v]),I=Object(n.useMemo)((()=>{var e,a;return null!==(e=null==t||null===(a=t.groupsCount)||void 0===a?void 0:a.value)&&void 0!==e?e:0}),[null==t||null===(k=t.groupsCount)||void 0===k?void 0:k.value]),N=Object(n.useMemo)((()=>{var e,a;const s=(null==t||null===(e=t.groupByFields)||void 0===e||null===(a=e.buckets)||void 0===a?void 0:a.some((e=>e.isNullGroup)))||!1;return`${y(I,f,s)}`}),[null==t||null===(E=t.groupByFields)||void 0===E?void 0:E.buckets,I,y,f]),D=Object(n.useMemo)((()=>{var e,s;return null==t||null===(e=t.groupByFields)||void 0===e||null===(s=e.buckets)||void 0===s?void 0:s.map(((e,t)=>{var s,n;const l=function(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}(e.key),u=`group-${t}-${l}`,d=null!==(s=e.isNullGroup)&&void 0!==s&&s,b=d?((e,t)=>_.i18n.translate("grouping.nullGroup.title",{values:{selectedGroup:e,unit:t},defaultMessage:"The selected group by field, {selectedGroup}, is missing a value for this group of {unit}."}))(f,v(e.doc_count)):void 0;return Object(j.jsx)("span",{key:u,"data-test-subj":`level-${o}-group-${t}`},Object(j.jsx)(et,{isNullGroup:d,nullGroupMessage:b,onGroupClose:g,extraAction:Object(j.jsx)(at,{bucketKey:u,groupFilter:d?$e(f):Ke(f,Array.isArray(e.key)?e.key:[e.key]),groupNumber:t,statRenderers:i&&i(f,e),takeActionItems:h}),forceState:null!==(n=F[u]&&F[u].state)&&void 0!==n?n:"closed",groupBucket:e,groupPanelRenderer:a&&a(f,e,b,c),isLoading:c,onToggleGroup:e=>{null==O||O(Ne.METRIC_TYPE.CLICK,(({isOpen:e,groupingId:t,groupNumber:a})=>`${Je.GROUP_TOGGLED}${e?"on":"off"}_${t}_group-${a}`)({isOpen:e,groupingId:r,groupNumber:t})),w({[u]:{state:e?"open":"closed"}}),null==m||m({isOpen:e,groupName:l,groupNumber:t,groupingId:r})},renderChildComponent:F[u]&&"open"===F[u].state?x:()=>Object(j.jsx)("span",null),selectedGroup:f,groupingLevel:o}),o>0?null:Object(j.jsx)(C.EuiSpacer,{size:"s"}))}))}),[null==t||null===(S=t.groupByFields)||void 0===S?void 0:S.buckets,a,i,r,o,c,g,m,x,f,h,O,F,v]),P=Object(n.useMemo)((()=>I?Math.ceil(I/d):1),[I,d]);return Object(j.jsx)(l.a.Fragment,null,o>0?null:Object(j.jsx)(C.EuiFlexGroup,{"data-test-subj":"grouping-table",justifyContent:"spaceBetween",alignItems:"center",style:{paddingBottom:20,paddingTop:20}},Object(j.jsx)(C.EuiFlexItem,{grow:!1},I>0&&M>0?Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{css:Le,"data-test-subj":"unit-count"},R)),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("span",{css:Le,"data-test-subj":"group-count",style:{borderRight:"none"}},N))):null),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"xs"},u&&Object(j.jsx)(C.EuiFlexItem,null,u),Object(j.jsx)(C.EuiFlexItem,null,s)))),Object(j.jsx)("div",{css:o>0?Ue:Be,className:"eui-xScroll"},c&&Object(j.jsx)(C.EuiProgress,{"data-test-subj":"is-loading-grouping-table",size:"xs",color:"accent"}),I>0?Object(j.jsx)("span",{"data-test-subj":`grouping-level-${o}`},D,I>0&&Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)(C.EuiTablePagination,{activePage:e,"data-test-subj":`grouping-level-${o}-pagination`,itemsPerPage:d,itemsPerPageOptions:[10,25,50,100],onChangeItemsPerPage:e=>{b&&b(e)},onChangePage:e=>{p&&p(e)},pageCount:P,showPerPageOptions:!0}))):Object(j.jsx)(rt,null)))},ut=l.a.memo(ot),ct=({componentProps:e,defaultGroupingOptions:t,fields:a,groupingId:s,maxGroupingLevels:l,onGroupChange:r,onOptionsChange:o,tracker:u,title:c})=>{const[d,b]=Object(n.useReducer)(Me,we),{activeGroups:p}=Object(n.useMemo)((()=>{var e;return null!==(e=Re({groups:d},s))&&void 0!==e?e:xe}),[s,d]),g=Object(n.useCallback)((e=>{b(Ie({id:s,activeGroups:e}))}),[s]),m=(({defaultGroupingOptions:e,dispatch:t,fields:a,groupingId:s,groupingState:i,maxGroupingLevels:l=1,onGroupChange:r,onOptionsChange:o,tracker:u,title:c})=>{var d;const{activeGroups:b,options:p}=null!==(d=Re({groups:i},s))&&void 0!==d?d:xe,g=Object(n.useCallback)((e=>{t(Ie({id:s,activeGroups:e}))}),[t,s]),m=Object(n.useCallback)((e=>{t((({newOptionList:e,id:t})=>({payload:{newOptionList:e,id:t},type:me.updateGroupOptions}))({id:s,newOptionList:e})),null==o||o(e)}),[t,s,o]),x=Object(n.useCallback)((e=>{let t=[],a=!0;if(1===l)t=[e];else if(b.find((t=>t===e))){a=!1;const s=b.filter((t=>t!==e));t=0===s.length?["none"]:s}else t=_e([e])?[e]:[...b.filter((e=>"none"!==e)),e];g(t),a&&(null==u||u(Ne.METRIC_TYPE.CLICK,(({groupingId:e,selected:t})=>`${Je.GROUPED_ALERTS}${e}_${t}`)({groupingId:s,selected:e}))),null==r||r({tableId:s,groupByField:e,groupByFields:t})}),[s,l,r,b,g,u]);return Object(n.useEffect)((()=>{if(0===p.length&&e.length>0)return m(e.find((e=>b.find((t=>t===e.key))))?e:[...e,..._e(b)?[]:b.map((e=>({key:e,label:e})))]);if(_e(b))return;const t=p.map((e=>e.key)),a=[...p];b.forEach((e=>{t.includes(e)||a.push({label:e,key:e})})),a.length!==p.length&&m(a)}),[e,p,b,m]),Object(n.useMemo)((()=>Object(j.jsx)(Ze,{groupingId:s,groupsSelected:b,"data-test-subj":"alerts-table-group-selector",onGroupChange:x,fields:a,maxGroupingLevels:l,options:p,title:c})),[s,a,l,x,b,p,c])})({defaultGroupingOptions:t,dispatch:b,fields:a,groupingId:s,groupingState:d,maxGroupingLevels:l,onGroupChange:r,onOptionsChange:o,tracker:u,title:c}),x=Object(n.useCallback)((t=>_e([t.selectedGroup])?t.renderChildComponent([]):Object(j.jsx)(ut,i()({},e,t,{groupSelector:m,groupingId:s,tracker:u}))),[e,m,s,u]);return Object(n.useMemo)((()=>({getGrouping:x,groupSelector:m,selectedGroups:p,setSelectedGroups:g})),[x,m,p,g])};var dt=a(43),bt=a(44);const pt="cspq",gt=e=>{const t=(e=>{try{return Object(bt.encode)(e)}catch(e){console.error(e)}})(e);if(t)return`${pt}=${t}`},mt=e=>{const t=new URLSearchParams(e).get(pt);if(t)return(e=>{try{return Object(bt.decode)(e)}catch(e){console.error(e)}})(t)},jt=e=>{const{push:t,replace:a}=Object(o.useHistory)(),{search:s,key:i}=Object(o.useLocation)(),l=Object(n.useMemo)((()=>({...e(),...mt(s)})),[e,s]),r=Object(n.useCallback)((a=>t({search:gt({...e(),...l,...a})})),[e,l,t]);return Object(n.useEffect)((()=>{s||a({search:gt(e())})}),[e,s,a]),{key:i,urlQuery:l,setUrlQuery:r}},xt=e=>{const[t,a]=k()(e,te.c);let s=te.c;return t&&(s=t),{pageSize:s,setPageSize:a}},ft=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"@timestamp",direction:"desc"},pageIndex:0}),ht=Object(n.createContext)(void 0),Ot=()=>{const e=Object(n.useContext)(ht);if(!e)throw new Error("useDataViewContext can only be used within DataViewContext provider");return e},vt=({filters:e=[],query:t,nonPersistedFilters:a})=>{const{notifications:{toasts:s},data:{query:{filterManager:i,queryString:l}},uiSettings:r}=Object(w.a)().services,{dataView:o}=Ot(),u=r.get("query:allowLeadingWildcards"),c=Object(n.useMemo)((()=>({allowLeadingWildcards:u})),[u]),d=Object(n.useMemo)((()=>(({dataView:e,query:t,filters:a,config:s})=>{try{return{query:Object(qe.buildEsQuery)(e,t,a,s)}}catch(e){return{query:void 0,error:e instanceof Error?e:new Error("Unknown Error")}}})({dataView:o,filters:e.concat(null!=a?a:[]).flat(),query:t,config:c})),[o,e,a,t,c]);return Object(n.useEffect)((()=>{i.setAppFilters(e),l.setQuery(t)}),[e,i,l,t]),Object(n.useEffect)((()=>{const e=d instanceof Error?d:void 0;e&&s.addError(e,{title:_.i18n.translate("xpack.csp.findings.search.queryErrorToastMessage",{defaultMessage:"Query Error"}),toastLifeTimeMs:5e3})}),[d,s]),d},yt=e=>{const{data:{query:{filterManager:t,queryString:a}}}=Object(w.a)().services;return Object(n.useCallback)((()=>e({filters:t.getAppFilters(),query:a.getQuery()})),[e,t,a])},Tt=({defaultQuery:e=ft,paginationLocalStorageKey:t,columnsLocalStorageKey:a,nonPersistedFilters:s})=>{const i=yt(e),{urlQuery:l,setUrlQuery:r}=jt(i),{pageSize:o,setPageSize:u}=xt(t),c=Object(n.useCallback)((e=>{u(e),r({pageIndex:0,pageSize:e})}),[u,r]),d=Object(n.useCallback)((()=>{r({pageIndex:0,filters:[],query:{query:"",language:"kuery"}})}),[r]),b=Object(n.useCallback)((e=>{r({pageIndex:e})}),[r]),p=Object(n.useCallback)((e=>{r({sort:e})}),[r]),g=Object(n.useCallback)((({page:e,sort:t})=>{u(e.size),r({sort:t,pageIndex:e.index})}),[r,u]),m=vt({filters:l.filters,query:l.query,...s?{nonPersistedFilters:s}:{}}),j=Object(n.useCallback)((e=>{r({...e,pageIndex:0})}),[r]),x=m instanceof Error?m:void 0;return{setUrlQuery:r,sort:l.sort,filters:l.filters||[],query:m.query?m.query:{bool:{must:[],filter:[],should:[],must_not:[]}},queryError:x,pageIndex:l.pageIndex,urlQuery:l,setTableOptions:g,handleUpdateQuery:j,pageSize:o,setPageSize:u,onChangeItemsPerPage:c,onChangePage:b,onSort:p,onResetFilters:d,columnsLocalStorageKey:a||te.i,getRowsFromPages:e=>(null==e?void 0:e.map((({page:e})=>e)).flat())||[]}},kt=({dataView:e,groupingTitle:t,defaultGroupingOptions:a,getDefaultQuery:s,unit:i,groupPanelRenderer:l,groupStatsRenderer:r,groupingLevel:o,groupingLocalStorageKey:u,maxGroupingLevels:c=3,groupsUnit:d})=>{const b=yt(s),{urlQuery:p,setUrlQuery:g}=jt(b),[m,j]=Object(n.useState)(0),[x,f]=Object(n.useState)(10),{query:h,error:O}=vt({filters:p.filters,query:p.query}),v=ct({componentProps:{unit:i,groupPanelRenderer:l,groupStatsRenderer:r,groupsUnit:d},defaultGroupingOptions:a,fields:e.fields,groupingId:u,maxGroupingLevels:c,title:t,onGroupChange:({groupByFields:e})=>{j(0),g({groupBy:e})}}),y=o?v.selectedGroups[o]:v.selectedGroups[0];Object(n.useEffect)((()=>{j(0)}),[p.filters,p.query]),Object(n.useEffect)((()=>{p.groupBy&&v.setSelectedGroups(p.groupBy)}),[]);const T=Object(n.useMemo)((()=>`${y}-${dt.v4()}`),[y]),k=_e(v.selectedGroups),C=Object(n.useCallback)((()=>{g({filters:[],query:{query:"",language:"kuery"}})}),[g]);return{activePageIndex:m,setActivePageIndex:j,grouping:v,pageSize:x,query:h,error:O,selectedGroup:y,urlQuery:p,setUrlQuery:g,uniqueValue:T,isNoneSelected:k,onChangeGroupsItemsPerPage:e=>{j(0),f(e)},onChangeGroupsPage:e=>j(e),onResetFilters:C,filters:p.filters}},Ct=({grouping:e,pageSize:t})=>Object(j.jsx)("div",{"data-test-subj":A.q},e.getGrouping({activePage:0,data:{groupsCount:{value:1},unitsCount:{value:1}},groupingLevel:0,inspectButton:void 0,isLoading:!0,itemsPerPage:t,renderChildComponent:()=>Object(j.jsx)(l.a.Fragment,null),onGroupClose:()=>{},selectedGroup:"",takeActionItems:()=>[]}));var Et={name:"8cqz2n",styles:"&& [data-test-subj='alerts-table-group-selector']{display:none;}"},St={name:"1ntmxkn",styles:"position:absolute;right:0;top:16px"},Ft={name:"1m4j2s5",styles:"position:relative;&& [data-test-subj='group-stats']>.euiFlexItem:last-child{display:none;}&& [data-test-subj='group-stats']>.euiFlexItem:not(:first-child)>span{border-right:none;margin-right:0;}"};const wt=({data:e,renderChildComponent:t,grouping:a,activePageIndex:s,isFetching:i,pageSize:n,onChangeGroupsItemsPerPage:l,onChangeGroupsPage:r,selectedGroup:o,groupingLevel:u=0,groupSelectorComponent:c})=>!e||i?Object(j.jsx)(Ct,{grouping:a,pageSize:n}):Object(j.jsx)("div",{"data-test-subj":A.p,css:Ft},c&&Object(j.jsx)("div",{css:St},c),Object(j.jsx)("div",{css:c?Et:void 0},a.getGrouping({activePage:s,data:e,groupingLevel:u,selectedGroup:o,inspectButton:void 0,isLoading:i,itemsPerPage:n,onChangeGroupsItemsPerPage:l,onChangeGroupsPage:r,renderChildComponent:t,onGroupClose:()=>{},takeActionItems:()=>[]})));function Mt(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}var _t={name:"1lv1yo7",styles:"display:inline-flex"};const Rt=({title:e,field:t,unit:a})=>Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(j.jsx)("strong",null,e),Object(j.jsx)(C.EuiIconTip,{anchorProps:{css:_t},content:Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.grouping.nullGroupTooltip",defaultMessage:"The selected {groupingTitle} field, {field} is missing a value for this group of {unit}.",values:{groupingTitle:Object(j.jsx)("strong",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.grouping.nullGroupTooltip.groupingTitle",defaultMessage:"group by"})),field:Object(j.jsx)("code",null,t),unit:a}})),position:"right"})),It=()=>Object(j.jsx)(C.EuiSkeletonTitle,{size:"s",isLoading:!0},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.grouping.loadingGroupPanelTitle",defaultMessage:"Loading"})),Nt=({loading:e,query:t,setQuery:a,placeholder:s=_.i18n.translate("xpack.csp.findings.searchBar.searchPlaceholder",{defaultMessage:'Search findings (eg. rule.section : "API Server" )'})})=>{var i,r;const{euiTheme:o}=Object(C.useEuiTheme)(),{unifiedSearch:{ui:{SearchBar:u}}}=Object(L.useKibana)().services,c=Object(n.useContext)(v),{dataView:d}=Ot();let b=Object(j.jsx)("div",{css:Dt(o)},Object(j.jsx)(u,{appName:U,showFilterBar:!0,showQueryInput:!0,showDatePicker:!1,saveQueryMenuVisibility:"hidden",isLoading:e,indexPatterns:[d],onQuerySubmit:a,onFiltersUpdated:e=>a({filters:e}),placeholder:s,query:{query:(null==t||null===(i=t.query)||void 0===i?void 0:i.query)||"",language:(null==t||null===(r=t.query)||void 0===r?void 0:r.language)||"kuery"},filters:(null==t?void 0:t.filters)||[]}));if(c){const e=c.getFiltersGlobalComponent();b=Object(j.jsx)(e,null,b)}return Object(j.jsx)(l.a.Fragment,null,b)},Dt=e=>Object(j.css)("border-bottom:",e.border.thin,";background-color:",e.colors.body,";padding:",e.size.base,";",""),Pt=({additionalFilters:e=[],from:t,groupByField:a,pageNumber:s,rootAggregations:i,runtimeMappings:n,size:l=10,sort:r,statsAggregations:o,to:u,uniqueValue:c})=>({size:0,runtime_mappings:{...n,groupByField:{type:"keyword",script:{source:"if (doc[params['selectedGroup']].size()==0) { emit(params['uniqueValue']) } else { emit(doc[params['selectedGroup']].join(params['uniqueValue']))}",params:{selectedGroup:a,uniqueValue:c}}}},aggs:{groupByFields:{terms:{field:"groupByField",size:1e4},aggs:{bucket_truncate:{bucket_sort:{sort:r,from:s,size:l}},...o?o.reduce(((e,t)=>Object.assign(e,t)),{}):{}}},unitsCount:{value_count:{field:"groupByField"}},groupsCount:{cardinality:{field:"groupByField"}},...i?i.reduce(((e,t)=>Object.assign(e,t)),{}):{}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:u}}}]}},_source:!1}),Vt=(e,t,a)=>{var s,i,n,l;if(!a)return{};const r=null==a||null===(s=a.groupByFields)||void 0===s||null===(i=s.buckets)||void 0===i?void 0:i.map((a=>{if(a.key===t)return{...a,key:[""],selectedGroup:e,key_as_string:"",isNullGroup:!0};const s=(Array.isArray(a.key)?a.key[0]:a.key).split(t);return{...a,key:s,selectedGroup:e,key_as_string:s.join(", ")}}));return{...a,groupByFields:{buckets:r},groupsCount:{value:null!==(n=null===(l=a.groupsCount)||void 0===l?void 0:l.value)&&void 0!==n?n:0}}};var Gt=a(27),At=a(56);const Lt=_.i18n.translate("xpack.csp.findings.findingsErrorToast.searchFailedTitle",{defaultMessage:"Search failed"}),zt=(e,t)=>{t instanceof Error?e.addError(t,{title:Lt}):e.addDanger(Object(At.d)(t,Lt))},Bt=e=>({...e,index:F.A,size:0}),Ut=e=>_.i18n.translate("xpack.csp.findings.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {finding} other {findings}}"}),Ht=(e,t,a)=>{const s=a?e-1:e;switch(t){case te.g.RESOURCE_NAME:return _.i18n.translate("xpack.csp.findings.groupUnit.resource",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {resource} other {resources}}"});case te.g.RULE_NAME:return _.i18n.translate("xpack.csp.findings.groupUnit.rule",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {rule} other {rules}}"});case te.g.CLOUD_ACCOUNT_NAME:return _.i18n.translate("xpack.csp.findings.groupUnit.cloudAccount",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {cloud account} other {cloud accounts}}"});case te.g.ORCHESTRATOR_CLUSTER_NAME:return _.i18n.translate("xpack.csp.findings.groupUnit.kubernetes",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {kubernetes cluster} other {kubernetes clusters}}"});default:return _.i18n.translate("xpack.csp.findings.groupUnit",{values:{groupCount:e},defaultMessage:"{groupCount} {groupCount, plural, =1 {group} other {groups}}"})}},Wt=_.i18n.translate("xpack.csp.findings.grouping.nullGroupUnit",{defaultMessage:"findings"}),Qt={RESOURCE_NAME:_.i18n.translate("xpack.csp.findings.grouping.resource.nullGroupTitle",{defaultMessage:"No resource"}),RULE_NAME:_.i18n.translate("xpack.csp.findings.grouping.rule.nullGroupTitle",{defaultMessage:"No rule"}),CLOUD_ACCOUNT_NAME:_.i18n.translate("xpack.csp.findings.grouping.cloudAccount.nullGroupTitle",{defaultMessage:"No cloud account"}),ORCHESTRATOR_CLUSTER_NAME:_.i18n.translate("xpack.csp.findings.grouping.kubernetes.nullGroupTitle",{defaultMessage:"No Kubernetes cluster"}),DEFAULT:_.i18n.translate("xpack.csp.findings.grouping.default.nullGroupTitle",{defaultMessage:"No grouping"})},Zt=[{label:_.i18n.translate("xpack.csp.findings.latestFindings.groupByResource",{defaultMessage:"Resource"}),key:te.g.RESOURCE_NAME},{label:_.i18n.translate("xpack.csp.findings.latestFindings.groupByRuleName",{defaultMessage:"Rule name"}),key:te.g.RULE_NAME},{label:_.i18n.translate("xpack.csp.findings.latestFindings.groupByCloudAccount",{defaultMessage:"Cloud account"}),key:te.g.CLOUD_ACCOUNT_NAME},{label:_.i18n.translate("xpack.csp.findings.latestFindings.groupByKubernetesCluster",{defaultMessage:"Kubernetes cluster"}),key:te.g.ORCHESTRATOR_CLUSTER_NAME}],Jt=_.i18n.translate("xpack.csp.findings.latestFindings.groupBy",{defaultMessage:"Group findings by"}),qt=({query:e,filters:t})=>({query:e,filters:t,sort:[["@timestamp","desc"]]}),Kt=[{id:"result.evaluation",width:80},{id:"resource.id"},{id:"resource.name"},{id:"resource.sub_type"},{id:"rule.benchmark.rule_number"},{id:"rule.name"},{id:"rule.section"},{id:"@timestamp"}],$t={negate:!1},Yt=({filters:e,dataView:t,field:a,value:s,negate:i})=>{const n=t.getFieldByName(a);if(!n)return e;const l=Object(qe.buildFilter)(t,n,qe.FILTERS.PHRASE,i,!1,s,null,qe.FilterStateStore.APP_STATE);return[...e.filter((e=>!Object(qe.compareFilters)(e,l,$t))),l]},Xt=["get_rules_state_key"],ea=()=>{const{http:e}=Object(w.a)().services;return Object(r.useQuery)(Xt,(()=>e.get(F.z,{version:F.y})))},ta=e=>{const t=Object.fromEntries(Object.entries(e).filter((([e,t])=>!0===t.muted)));return Object.keys(t).map((e=>{const a=t[e];return{bool:{must:[{term:{"rule.benchmark.id":a.benchmark_id}},{term:{"rule.benchmark.version":a.benchmark_version}},{term:{"rule.benchmark.rule_number":a.rule_number}}]}}}))},aa=(e,t)=>({[e]:{terms:{field:t,size:1}}}),sa=e=>{if(_e([e]))return[];const t=[{groupByField:{cardinality:{field:e}},failedFindings:{filter:{term:{"result.evaluation":{value:"failed"}}}},passedFindings:{filter:{term:{"result.evaluation":{value:"passed"}}}},complianceScore:{bucket_script:{buckets_path:{passed:"passedFindings>_count",failed:"failedFindings>_count"},script:"params.passed / (params.passed + params.failed)"}}}];switch(e){case te.g.RESOURCE_NAME:return[...t,aa("resourceName","resource.id"),aa("resourceSubType","resource.sub_type"),aa("resourceType","resource.type")];case te.g.RULE_NAME:return[...t,aa("benchmarkName","rule.benchmark.name"),aa("benchmarkVersion","rule.benchmark.version")];case te.g.CLOUD_ACCOUNT_NAME:case te.g.ORCHESTRATOR_CLUSTER_NAME:return[...t,aa("benchmarkName","rule.benchmark.name"),aa("benchmarkId","rule.benchmark.id")]}return t},ia=e=>{var t,a;return void 0!==(null==e||null===(t=e.passedFindings)||void 0===t?void 0:t.doc_count)&&void 0!==(null==e||null===(a=e.failedFindings)||void 0===a?void 0:a.doc_count)},na=({groupPanelRenderer:e,groupStatsRenderer:t,groupingLevel:a=0,groupFilters:s=[],selectedGroup:i})=>{var l,o,u;const{dataView:c}=Ot(),{activePageIndex:d,grouping:b,pageSize:p,query:g,onChangeGroupsItemsPerPage:m,onChangeGroupsPage:j,urlQuery:x,setUrlQuery:f,uniqueValue:h,isNoneSelected:O,onResetFilters:v,error:y,filters:T,setActivePageIndex:k}=kt({dataView:c,groupingTitle:Jt,defaultGroupingOptions:Zt,getDefaultQuery:qt,unit:Ut,groupPanelRenderer:e,groupStatsRenderer:t,groupingLocalStorageKey:te.k,groupingLevel:a,groupsUnit:Ht}),C=Object(qe.buildEsQuery)(c,[],s),E=i||b.selectedGroups[0],{data:S}=ea(),M=S?ta(S):[],_=Pt({additionalFilters:g?[g,C]:[C],groupByField:E,uniqueValue:h,from:`now-${F.M}`,to:"now",pageNumber:d*p,size:p,sort:[{groupByField:{order:"desc"}},{complianceScore:{order:"asc"}}],statsAggregations:sa(E),rootAggregations:[{failedFindings:{filter:{term:{"result.evaluation":{value:"failed"}}}},passedFindings:{filter:{term:{"result.evaluation":{value:"passed"}}}}}]}),R={..._,query:{..._.query,bool:{..._.query.bool,must_not:M}}},{data:I,isFetching:N}=(({query:e,enabled:t=!0})=>{const{data:a,notifications:{toasts:s}}=Object(w.a)().services;return Object(r.useQuery)(["csp_grouped_findings",{query:e}],(async()=>{const{rawResponse:{aggregations:t}}=await Object(Gt.lastValueFrom)(a.search.search({params:Bt(e)}));if(!t)throw new Error("Failed to aggregate by, missing resource id");return t}),{onError:e=>zt(s,e),enabled:t,keepPreviousData:!0})})({query:R,enabled:!O}),D=Object(n.useMemo)((()=>Vt(E,h,I)),[I,E,h]),P=ia(D)&&(null==D||null===(l=D.passedFindings)||void 0===l?void 0:l.doc_count)||0,V=ia(D)&&(null==D||null===(o=D.failedFindings)||void 0===o?void 0:o.doc_count)||0,G=!N&&ia(D)&&!(null!==(u=D.unitsCount)&&void 0!==u&&u.value);return{groupData:D,grouping:b,isFetching:N,activePageIndex:d,setActivePageIndex:k,pageSize:p,selectedGroup:i,onChangeGroupsItemsPerPage:m,onChangeGroupsPage:j,urlQuery:x,setUrlQuery:f,isGroupSelected:!O,isGroupLoading:!I,onResetFilters:v,filters:T,error:y,onDistributionBarClick:e=>{f({filters:Yt({filters:T,dataView:c,field:"result.evaluation",value:e,negate:!1})})},totalPassedFindings:P,totalFailedFindings:V,isEmptyResults:G}};var la=a(46),ra=a.n(la);const oa=e=>isNaN(e)?0:e<1e3?e:ra()(e).format("0.0a"),ua=_.i18n.translate("xpack.csp.findings.distributionBar.totalPassedLabel",{defaultMessage:"Passed Findings"}),ca=_.i18n.translate("xpack.csp.findings.distributionBar.totalFailedLabel",{defaultMessage:"Failed Findings"}),da=e=>Object(j.jsx)("div",null,Object(j.jsx)(ba,e),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(pa,e)),ba=({passed:e,failed:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"flexEnd",css:Object(j.css)("gap:",a.size.m,";","")},Object(j.jsx)(C.EuiHealth,{color:te.w.passed},ua),Object(j.jsx)(C.EuiBadge,null,oa(e)),Object(j.jsx)(C.EuiHealth,{color:te.w.failed},ca),Object(j.jsx)(C.EuiBadge,null,oa(t)))},pa=({passed:e,failed:t,distributionOnClick:a})=>{const{euiTheme:s}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none",css:Object(j.css)("height:8px;background:",s.colors.lightestShade,";","")},Object(j.jsx)(ga,{value:e,color:te.w.passed,distributionOnClick:()=>{a(F.R)},"data-test-subj":"distribution_bar_passed","aria-label":`${ua}: ${e}`}),Object(j.jsx)(ga,{value:t,color:te.w.failed,distributionOnClick:()=>{a(F.Q)},"data-test-subj":"distribution_bar_failed","aria-label":`${ca}: ${t}`}))},ga=({value:e,color:t,distributionOnClick:a,...s})=>Object(j.jsx)("button",{"data-test-subj":s["data-test-subj"],"aria-label":s["aria-label"],onClick:a,css:Object(j.css)({background:t,height:"100%"},"",""),style:{flex:e}}),ma=({error:e})=>{const{data:{search:t}}=Object(w.a)().services;return Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPanel,{paddingSize:"l",grow:!0},Object(j.jsx)(C.EuiCallOut,{title:_.i18n.translate("xpack.csp.findings.errorCallout.pageSearchErrorTitle",{defaultMessage:"We encountered an error retrieving search results"}),color:"danger",iconType:"warning"},Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(C.EuiButton,{size:"s",color:"danger",onClick:()=>t.showError(e)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.errorCallout.showErrorButtonLabel",defaultMessage:"Show error message"}))))))};async function ja(e,t,a,s){var i;if(!e.id||null==s||null===(i=s.indexPatterns)||void 0===i||!i.save)return;const n=e.fields.getByName(t);if(n&&(n.count++,e.isPersisted()))try{await a.updateSavedObject(e,0,!0)}catch{}}function xa(e,t=!1){return e.length>1&&-1!==e.indexOf("_source")?e.filter((e=>"_source"!==e)):0!==e.length?e:t?[]:["_source"]}function fa(e,t){return e?t?e.filter((e=>"_source"!==e)):e:[]}var ha=a(28),Oa=a.n(ha),va=a(11),ya=a.n(va),Ta=(a(155),a(29));const ka=Object(n.createContext)(null),Ca=({children:e,getTriggerCompatibleActions:t})=>{const a=Object(n.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(Ta.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(j.jsx)(ka.Provider,{value:a},e)};_.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),_.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),_.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),Ae.euiThemeVars.euiColorPrimaryText;var Ea=a(142),Sa=a.n(Ea);a(90);Ae.euiThemeVars.euiSizeS;const Fa=[],wa=({fields:e,getCellValue:t,triggerId:a,metadata:s,dataGridRef:i,disabledActionTypes:l=[]})=>{const[r,o]=Object(n.useState)(Fa),u=Object(n.useMemo)((()=>{if(a&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:a},metadata:s})))}),[e,a,s]),{loading:c,value:d}=((e,t={})=>{const{getActions:a}=(()=>{const e=Object(n.useContext)(ka);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e})(),{error:s,...i}=Sa()((()=>{var s;return Promise.all(null!==(s=null==e?void 0:e.map((e=>a(e).then((e=>{var a;return null!==(a=((e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0)(e,t.disabledActionTypes))&&void 0!==a?a:[]})))))&&void 0!==s?s:[])}),[e]);return(e=>{if(e)throw e})(s),i})(u,{disabledActionTypes:l});return Object(n.useEffect)((()=>{!c&&a&&null!=d&&d.length&&null!=e&&e.length&&d.length===e.length&&o(d.map(((n,l)=>n.map((n=>Ma({action:n,field:e[l],getCellValue:t,metadata:s,triggerId:a,dataGridRef:i}))))))}),[d,e,t,c,s,a,i]),r},Ma=({action:e,field:t,getCellValue:a,metadata:s,triggerId:i,dataGridRef:l})=>function({Component:r,rowIndex:o,isExpanded:u}){var c;const d=Object(n.useRef)(null),b=Object(n.useRef)(null),p=Object(n.useMemo)((()=>{const{name:e}=t,n=a(e,o);return{data:[{field:t,value:n}],trigger:{id:i},nodeRef:d,metadata:s}}),[o]),g=Object(n.useCallback)((async()=>{p.nodeRef.current=await _a({dataGrid:l.current,isExpanded:u,buttonRef:b}),e.execute(p)}),[p,u]);return Object(j.jsx)(r,{buttonRef:b,"aria-label":e.getDisplayName(p),title:e.getDisplayName(p),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:null!==(c=e.getIconType(p))&&void 0!==c?c:"",onClick:g},e.getDisplayName(p))},_a=({dataGrid:e,isExpanded:t,buttonRef:a})=>new Promise((s=>{const i=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):Ra(a.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;s(null!==(e=null==i?void 0:i.firstElementChild)&&void 0!==e?e:null)}))})),Ra=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:Ra(e.parentElement);var Ia=a(74),Na=a(49),Da=a(160);const Pa=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),Va=Object(Na.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),Ga=e=>Va(e);var Aa=a(57),La=a(75),za=a(50),Ba=a(64);const Ua=({children:e})=>Object(j.jsx)("span",{className:"unifiedDataTable__rowControl"},e),Ha=_.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),Wa=_.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),Qa=({rowIndex:e,columnId:t,toastNotifications:a,valueToStringConverter:s})=>{const i=s(e,t),n=i.formattedString;if(!Object(C.copyToClipboard)(n))return a.addWarning({title:Wa}),null;const l=_.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return i.withFormula?a.addWarning({title:l,text:Ha}):a.addInfo({title:l}),n},Za=async({columnId:e,columnDisplayName:t,toastNotifications:a,valueToStringConverter:s,rowsCount:i})=>{const n={formattedString:Ga(l=t),withFormula:Object(Na.cellHasFormulas)(l)};var l;let r=n.withFormula;const o=[...Array(i)].map(((t,a)=>{const i=s(a,e,{compatibleWithCSV:!0});return r=r||i.withFormula,i.formattedString})),u=`${n.formattedString}\n${o.join("\n")}`;let c;try{var d,b;await(null===(d=window.navigator)||void 0===d||null===(b=d.clipboard)||void 0===b?void 0:b.writeText(u)),c=!0}catch(e){c=Object(C.copyToClipboard)(u)}if(!c)return a.addWarning({title:Wa}),null;const p=_.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return r?a.addWarning({title:p,text:Ha}):a.addInfo({title:p}),u},Ja=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(C.copyToClipboard)(e))return t.addWarning({title:Wa}),null;const a=_.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:a}),e};function qa(e,t,a,s,i){const n=e.rows[t].flattened[a];i&&e.onFilter&&e.onFilter(i,n,s)}const Ka=({Component:e,rowIndex:t,columnId:a},s)=>{const i=Object(n.useContext)(Ba.a),l=_.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:a}});return Object(j.jsx)(e,{onClick:()=>{qa(i,t,a,"+",s)},iconType:"plusInCircle","aria-label":l,title:l,"data-test-subj":"filterForButton"},_.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},$a=({Component:e,rowIndex:t,columnId:a},s)=>{const i=Object(n.useContext)(Ba.a),l=_.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:a}});return Object(j.jsx)(e,{onClick:()=>{qa(i,t,a,"-",s)},iconType:"minusInCircle","aria-label":l,title:l,"data-test-subj":"filterOutButton"},_.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};var Ya=a(69);function Xa(e){switch(e){case Ya.b.IP:case Ya.b.GEO_SHAPE:case Ya.b.NUMBER:return"numeric";case Ya.b.BOOLEAN:return"boolean";case Ya.b.STRING:return"string";case Ya.b.DATE:return"datetime";default:return Aa.i}}function es({isPlainRecord:e,isFilterActive:t,rows:a,selectedDocs:s,setIsFilterActive:i,setSelectedDocs:l}){const[r,o]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>[t?Object(j.jsx)(C.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{o(!1),i(!1)}},e?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.showAllResults",defaultMessage:"Show all results"}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(j.jsx)(C.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{o(!1),i(!0)}},e?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.showSelectedResultsOnly",defaultMessage:"Show selected results only"}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(j.jsx)(C.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:a?JSON.stringify(a.filter((e=>s.includes(e.id))).map((e=>e.raw))):""},(t=>Object(j.jsx)(C.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:t},e?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.copyResultsToClipboardJSON",defaultMessage:"Copy results to clipboard (JSON)"}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(j.jsx)(C.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{o(!1),l([]),i(!1)}},Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[t,e,a,s,i,l]),c=Object(n.useCallback)((()=>o((e=>!e))),[]);return Object(j.jsx)(C.EuiPopover,{closePopover:()=>o(!1),isOpen:r,panelPaddingSize:"none",button:Object(j.jsx)(C.EuiDataGridToolbarControl,{iconType:"documents",onClick:c,"data-selected-documents":s.length,"data-test-subj":"unifiedDataTableSelectionBtn",isSelected:t,badgeContent:s.length},e?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.selectedResultsButtonLabel",defaultMessage:"Selected",description:"Selected results"}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"}))},r&&Object(j.jsx)(C.EuiContextMenuPanel,{items:u(),"data-test-subj":"unifiedDataTableSelectionMenu"}))}const ts=({selectedDocs:e,setIsCompareActive:t})=>Object(j.jsx)(C.EuiDataGridToolbarControl,{iconType:"diff",badgeContent:e.length,"data-test-subj":"unifiedDataTableCompareSelectedDocuments",onClick:()=>{t(!0)}},Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.compareSelectedRowsButtonLabel",defaultMessage:"Compare"}));function as({label:e,onCopy:t,dataTestSubj:a}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":a}}function ss({columnDisplayName:e,toastNotifications:t}){return as({label:Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>Ja({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function is({columnId:e,columnDisplayName:t,toastNotifications:a,rowsCount:s,valueToStringConverter:i}){return as({label:Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>Za({columnId:e,columnDisplayName:t,toastNotifications:a,rowsCount:s,valueToStringConverter:i}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}var ns=a(100);const ls=()=>Object(j.jsx)(n.Fragment,null),rs=l.a.lazy((()=>a.e(5).then(a.bind(null,184)))),os=function(e){return Object(j.jsx)(l.a.Suspense,{fallback:Object(j.jsx)(ls,null)},Object(j.jsx)(rs,e))};var us=a(97),cs=({headerRowHeight:e,children:t})=>{const a=Object(j.css)("overflow-wrap:anywhere;white-space:normal;word-break:break-all;line-height:",Ae.euiThemeVars.euiSize,";text-align:left;.euiDataGridHeaderCell--numeric &{float:right;}","");return e?Object(j.jsx)(C.EuiTextBlockTruncate,{lines:e,css:a},t):Object(j.jsx)("div",{css:a},t)};const ds=({columnDisplayName:e,showColumnTokens:t,columnName:a,columnsMeta:s,dataView:i,headerRowHeight:n})=>Object(j.jsx)(cs,{headerRowHeight:n},t&&Object(j.jsx)(bs,{columnName:a,columnsMeta:s,dataView:i}),Object(j.jsx)(ps,{columnDisplayName:e})),bs=e=>{const{columnName:t,columnsMeta:a,dataView:s}=e,l=Object(n.useMemo)((()=>function({dataView:e,columnName:t,columnsMeta:a}){if(!t||"_source"===t)return null;if(a){const e=(s=a[t])&&s.type?Object(ns.a)({name:"",type:s.type,esTypes:s.esType?[s.esType]:[]}):null;return e&&"unknown"!==e?Object(j.jsx)(os,{type:e,css:gs}):null}var s;const n=e.getFieldByName(t);return n?Object(j.jsx)(os,i()({},Object(us.a)(n),{css:gs})):function(e,t){const a=new RegExp(Object(Ta.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const s=Object(qe.getDataViewFieldSubtypeNested)(e);return!!s&&a.test(null!==(t=null==s?void 0:s.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(j.jsx)(os,{type:"nested",css:gs}):null}({columnName:t,columnsMeta:a,dataView:s})),[t,a,s]);return l?Object(j.jsx)("span",{css:Object(j.css)({paddingRight:Ae.euiThemeVars.euiSizeXS},"","")},l):null},ps=({columnDisplayName:e})=>Object(j.jsx)("span",{"data-test-subj":"unifiedDataTableColumnTitle"},e),gs={verticalAlign:"bottom"};var ms={name:"1flj9lk",styles:"text-align:left"};const js=({dataView:e,dataViewField:t,headerRowHeight:a=1,columnLabel:s})=>{var i;const n=s||(null!==(i=null==t?void 0:t.customLabel)&&void 0!==i?i:e.timeFieldName),l=_.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:n}}),r=_.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});return Object(j.jsx)("div",{"aria-label":l,css:ms},Object(j.jsx)(cs,{headerRowHeight:a},n," ",Object(j.jsx)(C.EuiIconTip,{type:"clock",content:r})))},xs=l.a.memo(ds),fs=l.a.memo(js),hs="openDetails",Os="select",vs={id:hs,width:26,headerCellRender:()=>Object(j.jsx)(C.EuiScreenReaderOnly,null,Object(j.jsx)("span",null,_.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const a=Object(n.useRef)(null),[s,i]=Object(n.useState)(!1),{expanded:l,setExpanded:r,rows:o,isDarkMode:u,componentsTourSteps:c}=Object(n.useContext)(Ba.a),d=o[e],b=c?c.expandButton:void 0;Object(n.useEffect)((()=>{d.isAnchor?t({className:"unifiedDataTable__cell--highlight"}):l&&d&&l.id===d.id?t({className:"unifiedDataTable__cell--expanded"}):t({style:void 0})}),[l,d,t,u]);const p=d===l,g=_.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),m=d.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(n.useEffect)((()=>{!p&&s&&(i(!1),setTimeout((()=>{var e;null===(e=a.current)||void 0===e||e.hideToolTip()}),100))}),[p,i,s]),r?Object(j.jsx)(Ua,null,Object(j.jsx)(C.EuiToolTip,{content:g,delay:"long",ref:a},Object(j.jsx)(C.EuiButtonIcon,{id:0===e?b:void 0,size:"xs",iconSize:"s","aria-label":g,"data-test-subj":m,onClick:()=>{var e;const t=p?void 0:d;null===(e=a.current)||void 0===e||e.hideToolTip(),i(Boolean(t)),null==r||r(t)},color:p?"primary":"text",iconType:p?"minimize":"expand",isSelected:p}))):null}},ys={id:Os,width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),{selectedDocs:s,expanded:i,rows:l,isDarkMode:r,setSelectedDocs:o}=Object(n.useContext)(Ba.a),u=Object(n.useMemo)((()=>l[e]),[l,e]),c=Object(n.useMemo)((()=>s.includes(u.id)),[s,u.id]),d=_.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document ''{rowNumber}''",values:{rowNumber:e+1}});return Object(n.useEffect)((()=>{i&&u&&i.id===u.id?t({className:"unifiedDataTable__cell--selected"}):t({style:void 0})}),[i,u,t,r]),Object(j.jsx)(C.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(j.css)("padding-block:",a.size.xs,";padding-left:",a.size.xs,";","")},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiCheckbox,{id:u.id,"aria-label":d,checked:c,"data-test-subj":`dscGridSelectDoc-${u.id}`,onChange:()=>{if(c){const e=s.filter((e=>e!==u.id));o(e)}else o([...s,u.id])}})))},headerCellRender:()=>Object(j.jsx)(C.EuiScreenReaderOnly,null,Object(j.jsx)("span",null,_.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function Ts({columns:e,columnsCellActions:t,rowsCount:a,settings:s,dataView:i,defaultColumns:n,isSortEnabled:l,isPlainRecord:r,services:o,hasEditDataViewPermission:u,valueToStringConverter:c,onFilter:d,editField:b,visibleCellActions:p,columnsMeta:g,showColumnTokens:m,headerRowHeightLines:x,customGridColumnsConfiguration:f}){const h=e=>{var t,a,i;return null!==(t=null==s||null===(a=s.columns)||void 0===a||null===(i=a[e])||void 0===i?void 0:i.width)&&void 0!==t?t:0},O=(e=>{if(e!==Aa.d.auto)return e===Aa.d.single?1:e})(x),v=e.length;return e.map(((e,x)=>{var y,T;return function({numberOfColumns:e,columnName:t,columnWidth:a=0,dataView:s,defaultColumns:i,isSortEnabled:n,isPlainRecord:l,toastNotifications:r,hasEditDataViewPermission:o,valueToStringConverter:u,rowsCount:c,onFilter:d,editField:b,columnCellActions:p,visibleCellActions:g,columnsMeta:m,showColumnTokens:x,headerRowHeight:f,customGridColumnsConfiguration:h,columnDisplay:O}){var v,y,T,k,C;const S=l?new za.DataViewField({name:t,type:null!==(v=null==m||null===(y=m[t])||void 0===y?void 0:y.type)&&void 0!==v?v:"unknown",esTypes:null!=m&&null!==(T=m[t])&&void 0!==T&&T.esType?[m[t].esType]:void 0,searchable:!0,aggregatable:!1}):s.getFieldByName(t),F=b&&S&&(({hasEditDataViewPermission:e,dataView:t,field:a,editField:s})=>{if("_source"===a.name)return null;const{canEdit:i}=((e,t)=>{var a;const s=Boolean(null===(a=e.getFieldByName(t.name))||void 0===a?void 0:a.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||s,canDelete:s}})(t,a),n=e()||!t.isPersisted();return i&&n?{size:"xs",label:Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{s(a.name)},"data-test-subj":"gridEditFieldButton"}:null})({hasEditDataViewPermission:o,dataView:s,field:S,editField:b}),w=((e,t,a)=>a||("_source"===e?_.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):t||e))(t,null==S?void 0:S.displayName,O);let M;M=null!=p&&p.length?p:S?function(e,t,a,s){return[...s&&e.filterable?[({Component:t,rowIndex:a,columnId:s})=>Ka({Component:t,rowIndex:a,columnId:s},e),({Component:t,rowIndex:a,columnId:s})=>$a({Component:t,rowIndex:a,columnId:s},e)]:[],({Component:e,rowIndex:s,columnId:i})=>function({Component:e,rowIndex:t,columnId:a},s,i){const n=_.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:a}});return Object(j.jsx)(e,{onClick:()=>{Qa({rowIndex:t,columnId:a,valueToStringConverter:i,toastNotifications:s})},iconType:"copyClipboard","aria-label":n,title:n,"data-test-subj":"copyClipboardButton"},_.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:s,columnId:i},t,a)]}(S,r,u,d):[];const R={id:t,schema:Xa(null!==(k=null==m||null===(C=m[t])||void 0===C?void 0:C.type)&&void 0!==k?k:null==S?void 0:S.type),isSortable:n&&(l&&"_source"!==t||!0===(null==S?void 0:S.sortable)),display:x||1!==f?Object(j.jsx)(xs,{dataView:s,columnName:t,columnDisplayName:w,columnsMeta:m,showColumnTokens:x,headerRowHeight:f}):void 0,displayAsText:w,actions:{showHide:!i&&t!==s.timeFieldName&&{label:_.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!i,showMoveRight:!i,additional:[..."__source"===t?[]:[ss({columnDisplayName:w,toastNotifications:r})],is({columnId:t,columnDisplayName:w,toastNotifications:r,rowsCount:c,valueToStringConverter:u}),...F?[F]:[]]},cellActions:M,visibleCellActions:g};return R.id===s.timeFieldName&&(R.display=Object(j.jsx)(fs,{dataView:s,dataViewField:S,headerRowHeight:f,columnLabel:O}),e>1&&(R.initialWidth=Aa.h)),a>0&&(R.initialWidth=Number(a)),h&&h[R.id]?h[R.id]({column:R,headerRowHeight:f}):R}({numberOfColumns:v,columnName:e,columnCellActions:null==t?void 0:t[x],columnWidth:h(e),dataView:i,defaultColumns:n,isSortEnabled:l,isPlainRecord:r,toastNotifications:o.toastNotifications,hasEditDataViewPermission:u,valueToStringConverter:c,rowsCount:a,onFilter:d,editField:b,visibleCellActions:p,columnsMeta:g,showColumnTokens:m,headerRowHeight:O,customGridColumnsConfiguration:f,columnDisplay:null==s||null===(y=s.columns)||void 0===y||null===(T=y[e])||void 0===T?void 0:T.display})}))}const ks=e=>{const{isLoadingMore:t,rowCount:a,sampleSize:s,pageIndex:l,pageCount:r,totalHits:o=0,onFetchMoreRecords:u,data:c}=e,d=c.query.timefilter.timefilter,[b,p]=Object(n.useState)(d.getRefreshInterval());Object(n.useEffect)((()=>{const e=d.getRefreshIntervalUpdate$().subscribe((()=>{p(d.getRefreshInterval())}));return()=>e.unsubscribe()}),[d,p]);const g=Boolean(b&&!1===b.pause&&b.value>0),{euiTheme:m}=Object(C.useEuiTheme)();return l===r-1&&a<o?u&&"boolean"==typeof t?a<=Aa.c-s?Object(j.jsx)(Cs,i()({hasButton:!0},e),Object(j.jsx)(C.EuiToolTip,{content:g?_.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(j.jsx)(C.EuiButtonEmpty,{disabled:g,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:u,css:Object(j.css)("margin-left:",m.size.xs,";","")},Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(j.jsx)(Cs,i()({hasButton:!1},e)):a<o?Object(j.jsx)(Cs,i()({hasButton:!1},e)):null:null},Cs=({hasButton:e,rowCount:t,children:a,fieldFormats:s})=>{const{euiTheme:i}=Object(C.useEuiTheme)(),n=s.getDefaultInstance(Ya.b.NUMBER,[Ya.a.INTEGER]).convert(t);return Object(j.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(j.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",i.colors.lightestShade,";padding:",e?`0 ${i.size.base}`:`${i.size.s} ${i.size.base}`,";margin-top:",i.size.xs,";text-align:center;","")},Object(j.jsx)("span",null,e?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:n}}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:n}})),a)};let Es=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}({});const Ss=Object(C.htmlIdGenerator)()();function Fs({label:e,rowHeight:t,rowHeightLines:a,compressed:s,onChangeRowHeight:i,onChangeRowHeightLines:n,maxRowHeight:r,"data-test-subj":o}){const u=[{id:`${Ss}${Es.single}`,label:_.i18n.translate("unifiedDataTable.rowHeight.single",{defaultMessage:"Single"}),"data-test-subj":`${o}_rowHeight_${Es.single}`},{id:`${Ss}${Es.auto}`,label:_.i18n.translate("unifiedDataTable.rowHeight.auto",{defaultMessage:"Auto fit"}),"data-test-subj":`${o}_rowHeight_${Es.auto}`},{id:`${Ss}${Es.custom}`,label:_.i18n.translate("unifiedDataTable.rowHeight.custom",{defaultMessage:"Custom"}),"data-test-subj":`${o}_rowHeight_${Es.custom}`}];return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiFormRow,{label:e,display:"columnCompressed","data-test-subj":o},Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiButtonGroup,{isFullWidth:!0,legend:e,buttonSize:"compressed",options:u,idSelected:`${Ss}${null!=t?t:Es.single}`,onChange:e=>{const t=e.replace(Ss,"");i(t)},"data-test-subj":`${o}_rowHeightButtonGroup`}),t===Es.custom?Object(j.jsx)(C.EuiRange,{compressed:!0,fullWidth:!0,showInput:!0,min:1,max:null!=r?r:20,step:1,value:null!=a?a:2,onChange:e=>{const t=Number(e.currentTarget.value);n(t)},"data-test-subj":`${o}_lineCountNumber`,css:Object(j.css)({marginTop:s?Ae.euiThemeVars.euiSizeXS:Ae.euiThemeVars.euiSizeM},"","")}):null)))}const ws=()=>{},Ms=({rowHeight:e,rowHeightLines:t,onChangeRowHeight:a,onChangeRowHeightLines:s,headerRowHeight:i,headerRowHeightLines:r,onChangeHeaderRowHeight:o,onChangeHeaderRowHeightLines:c,maxAllowedSampleSize:d=1e3,sampleSize:b,onChangeSampleSize:p})=>{const[g,m]=Object(n.useState)(b),x=Math.max(Math.min(10,b),1),f=Object(n.useMemo)((()=>Object(u.debounce)(null!=p?p:ws,300,{leading:!1,trailing:!0})),[p]),h=Object(n.useCallback)((e=>{var t;if(!e.target.value)return void m("");const a=null!==(t=parseInt(e.target.value,10))&&void 0!==t?t:10;a>=1&&(m(a),a<=d&&f(a))}),[d,m,f]),O=_.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});Object(n.useEffect)((()=>{m(b)}),[b,m]);const v=[];return o&&c&&v.push(Object(j.jsx)(Fs,{rowHeight:i,rowHeightLines:r,label:_.i18n.translate("unifiedDataTable.headerRowHeightLabel",{defaultMessage:"Header row height"}),onChangeRowHeight:o,onChangeRowHeightLines:c,"data-test-subj":"unifiedDataTableHeaderRowHeightSettings",maxRowHeight:5})),a&&s&&v.push(Object(j.jsx)(Fs,{rowHeight:e,rowHeightLines:t,label:_.i18n.translate("unifiedDataTable.rowHeightLabel",{defaultMessage:"Cell row height"}),onChangeRowHeight:a,onChangeRowHeightLines:s,"data-test-subj":"unifiedDataTableRowHeightSettings"})),p&&v.push(Object(j.jsx)(C.EuiFormRow,{label:O,display:"columnCompressed"},Object(j.jsx)(C.EuiRange,{compressed:!0,fullWidth:!0,min:x,max:d,step:10===x?10:1,showInput:!0,value:g,onChange:h,"data-test-subj":"unifiedDataTableSampleSizeInput"}))),Object(j.jsx)(l.a.Fragment,null,v.map(((e,t)=>Object(j.jsx)(l.a.Fragment,{key:`setting-${t}`},t>0&&Object(j.jsx)(C.EuiHorizontalRule,{margin:"s"}),e))))},_s=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,Rs=(e,t)=>`${e}:${t}`,Is=(e,t,a,s,i)=>{a.set(Rs(s,i),{previousRowHeight:e,previousConfigRowHeight:t})},Ns=({storage:e,consumer:t,key:a,configRowHeight:s,rowHeightState:i,onUpdateRowHeight:l})=>{const r=Object(n.useMemo)((()=>{const n=((e,t,a)=>{const s=e.get(Rs(t,a));return"object"==typeof s&&null!==s&&_s(s.previousRowHeight)&&_s(s.previousConfigRowHeight)?s:null})(e,t,a);let l;var r;return l=_s(i)?i:null!==(r=n)&&s===r.previousConfigRowHeight?n.previousRowHeight:s,l}),[s,t,a,i,e]),o=Object(n.useMemo)((()=>{switch(r){case Aa.d.auto:return Es.auto;case Aa.d.single:return Es.single;default:return Es.custom}}),[r]),u=Object(n.useCallback)((i=>{let n;switch(i){case Es.auto:n=Aa.d.auto;break;case Es.single:n=Aa.d.single;break;default:n=s}Is(n,s,e,t,a),null==l||l(n)}),[s,t,a,l,e]),c=Object(n.useCallback)((i=>{Is(i,s,e,t,a),null==l||l(i)}),[s,t,a,l,e]);return{rowHeight:o,rowHeightLines:r,onChangeRowHeight:l?u:void 0,onChangeRowHeightLines:l?c:void 0}};var Ds=a(41),Ps={name:"1azakc",styles:"text-align:center"};const Vs=()=>{const e=Ps;return Object(j.jsx)("div",{css:e},Object(j.jsx)(C.EuiLoadingSpinner,null))},Gs=((e,t=Object(j.jsx)(Vs,null))=>l.a.forwardRef(((a,s)=>Object(j.jsx)(Ds.KibanaErrorBoundaryProvider,{analytics:a.analytics},Object(j.jsx)(Ds.KibanaErrorBoundary,null,Object(j.jsx)(n.Suspense,{fallback:t},Object(j.jsx)(e,i()({},a,{ref:s}))))))))(Object(n.lazy)((()=>a.e(4).then(a.bind(null,183))))),As="unifiedDataTable__fullScreen";let Ls=function(e){return e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded",e}({});const zs={darkMode:!1},Bs=l.a.memo(C.EuiDataGrid),Us=["openDetails","select"],Hs=({ariaLabelledBy:e,columns:t,columnsMeta:a,showColumnTokens:s,configHeaderRowHeight:i,headerRowHeightState:r,onUpdateHeaderRowHeight:o,controlColumnIds:c=Us,dataView:d,loadingState:b,onFilter:p,onResize:g,onSetColumns:m,onSort:x,rows:f,searchDescription:h,searchTitle:O,settings:v,showTimeCol:y,showFullScreenButton:T=!0,sort:k,useNewFieldsApi:S,isSortEnabled:F=!0,isPaginationEnabled:w=!0,cellActionsTriggerId:M,className:_,rowHeightState:R,onUpdateRowHeight:I,maxAllowedSampleSize:N,sampleSizeState:D,onUpdateSampleSize:P,isPlainRecord:V=!1,rowsPerPageState:G,onUpdateRowsPerPage:A,onFieldEdited:L,services:z,renderCustomGridBody:B,renderCustomToolbar:U,trailingControlColumns:H,totalHits:W,onFetchMoreRecords:Q,renderDocumentView:Z,setExpandedDoc:J,expandedDoc:q,configRowHeight:K,showMultiFields:$=!0,maxDocFieldsDisplayed:Y=50,externalControlColumns:X,externalAdditionalControls:ee,rowsPerPageOptions:te,visibleCellActions:ae,externalCustomRenderers:se,additionalFieldGroups:ie,consumer:ne="discover",componentsTourSteps:le,gridStyleOverride:re,rowLineHeightOverride:oe,cellActionsMetadata:ue,customGridColumnsConfiguration:ce,customControlColumnsConfiguration:de,enableComparisonMode:be,cellContext:pe,renderCellPopover:ge})=>{var me,je,xe,fe;const{fieldFormats:he,toastNotifications:Oe,dataViewFieldEditor:ve,uiSettings:ye,storage:Te,data:ke}=z,{darkMode:Ce}=ya()(null!==(me=null===(je=z.theme)||void 0===je?void 0:je.theme$)&&void 0!==me?me:Object(Gt.of)(zs),zs),Ee=Object(n.useRef)(null),[Se,Fe]=Object(n.useState)([]),[we,Me]=Object(n.useState)(!1),[_e,Re]=Object(n.useState)(!1),Ie=Object(Ia.a)(t,d),Ne=Ie.includes("_source"),De=Object(n.useMemo)((()=>{var e;return new Map(null!==(e=null==f?void 0:f.map((e=>[e.id,e])))&&void 0!==e?e:[])}),[f]),Pe=Object(n.useCallback)((e=>De.get(e)),[De]),Ve=Object(n.useMemo)((()=>{if(!Se.length||null==f||!f.length)return[];const e=Se.filter((e=>!!Pe(e)));return 0===e.length&&we&&Me(!1),e}),[Se,null==f?void 0:f.length,we,Pe]),Ge=Object(n.useMemo)((()=>{if(!f)return[];if(!we||0===Ve.length)return f;const e=f.filter((e=>Ve.includes(e.id)));return e.length?e:f}),[f,Ve,we]),Ae=Object(n.useCallback)(((e,t,a)=>(({rowIndex:e,rows:t,columnId:a,dataView:s,fieldFormats:i,options:n})=>{var l,r;if(!t[e])return{formattedString:"",withFormula:!1};const o=t[e].flattened,u=null==o?void 0:o[a],c=s.fields.getByName(a),d=Array.isArray(u)?u:[u],b=null!==(l=null==n?void 0:n.compatibleWithCSV)&&void 0!==l&&l,p=null!==(r=null==n?void 0:n.compatibleWithCSV)&&void 0!==r&&r;if("_source"===(null==c?void 0:c.type))return{formattedString:Pa(o,b),withFormula:!1};let g=!1;return{formattedString:d.map((a=>{const n=Object(Da.a)(a,t[e].raw,i,s,c,"text",{skipFormattingInStringifiedJSON:b});return"string"==typeof n?(g=g||Object(Na.cellHasFormulas)(n),p?Ga(n):n):Pa(n,b)||""})).join(", "),withFormula:g}})({rowIndex:e,rows:Ge,dataView:d,columnId:t,fieldFormats:he,options:a})),[Ge,d,he]),Le=Object(n.useMemo)((()=>({expanded:q,setExpanded:J,rows:Ge,onFilter:p,dataView:d,isDarkMode:Ce,selectedDocs:Ve,setSelectedDocs:e=>{Fe(e),we&&0===e.length&&Me(!1)},valueToStringConverter:Ae,componentsTourSteps:le,isPlainRecord:V})),[le,Ce,d,V,Ge,q,we,p,J,Ve,Ae]),ze="number"==typeof G&&G>0?G:Aa.a,[Be,Ue]=Object(n.useState)({pageIndex:0,pageSize:ze}),He=Object(n.useMemo)((()=>Ge?Ge.length:0),[Ge]),We=Object(n.useMemo)((()=>Math.ceil(He/Be.pageSize)),[He,Be]),Qe=Object(n.useMemo)((()=>{return w?{onChangeItemsPerPage:e=>{null==A||A(e)},onChangePage:e=>Ue((t=>({...t,pageIndex:e}))),pageIndex:Be.pageIndex>We-1?0:Be.pageIndex,pageSize:Be.pageSize,pageSizeOptions:null!=te?te:(e=Be.pageSize,Object(u.sortBy)(Object(u.uniq)("number"==typeof e&&e>0?[...Aa.e,e]:Aa.e)))}:void 0;var e}),[w,Be.pageIndex,Be.pageSize,We,te,A]);Object(n.useEffect)((()=>{Ue((e=>e.pageSize===ze?e:{...e,pageSize:ze}))}),[ze,Ue]);const Ze=Object(n.useMemo)((()=>((e,t,a)=>{if(a)return()=>!0;const s=new Map;return e.forEach((e=>{s.set(e,((e,t)=>{var a;const s=t.fields.getByName(e);if(!s)return{show:!0};const i=Object(qe.getDataViewFieldSubtypeMulti)(s.spec);return{show:!Boolean(null==i?void 0:i.multi),parentName:null==i||null===(a=i.multi)||void 0===a?void 0:a.parent}})(e,t))})),e=>{const t=s.get(e);return!t||t.show||!!t.parentName&&!s.has(t.parentName)}})(d.fields.getAll().map((e=>e.name)),d,$)),[d,$]),Je=Object(n.useMemo)((()=>Object(La.b)({dataView:d,rows:Ge,useNewFieldsApi:S,shouldShowFieldHandler:Ze,closePopover:()=>{var e;return null===(e=Ee.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:he,maxEntries:Y,externalCustomRenderers:se,isPlainRecord:V})),[d,Ge,S,Ze,Y,he,se,V]),Ke=Object(n.useMemo)((()=>null!=ge?ge:(()=>{const e=Object(n.memo)((function(e){const{setCellPopoverProps:t,DefaultCellPopover:a}=e;return Object(n.useEffect)((()=>{t({panelClassName:"unifiedDataTable__cellPopover"})}),[t]),Object(j.jsx)(a,e)}));return t=>Object(j.jsx)(e,t)})()),[ge]),$e=Object(n.useMemo)((()=>Object(C.htmlIdGenerator)()()),[]),Ye=Object(n.useRef)();Object(n.useEffect)((()=>()=>{null!=Ye&&Ye.current&&(null==Ye||Ye.current())}),[]);const Xe=Object(n.useMemo)((()=>L?async e=>{var t;Ye.current=L&&await(null==z||null===(t=z.dataViewFieldEditor)||void 0===t?void 0:t.openEditor({ctx:{dataView:d},fieldName:e,onSave:async()=>{await L()}}))}:void 0),[d,L,null==z?void 0:z.dataViewFieldEditor]),et=d.timeFieldName,tt=Object(n.useCallback)((e=>function(e,t,a,s,i){return!(!s||!t)&&(!i||!!a&&t in a&&e.includes("_source"))}(e,et,a,y,V)),[et,V,y,a]),at=Object(n.useMemo)((()=>function(e,t,a){const s=t.timeFieldName;return a&&s&&!e.find((e=>e===s))?[s,...e]:e}(Ie,d,tt(Ie))),[d,Ie,tt]),st=Object(n.useCallback)(((e,t)=>Ge[t%Ge.length].flattened[e]),[Ge]),it=Object(n.useMemo)((()=>M&&!V?at.map((e=>{var t,a;return null!==(t=null===(a=d.getFieldByName(e))||void 0===a?void 0:a.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[M,V,at,d]),nt=Object(n.useMemo)((()=>({dataViewId:d.id,...null!=ue?ue:{}})),[d,ue]),lt=wa({fields:it,getCellValue:st,triggerId:M,dataGridRef:Ee,metadata:nt}),{rowHeight:rt,rowHeightLines:ot,onChangeRowHeight:ut,onChangeRowHeightLines:ct}=Ns({storage:Te,consumer:ne,key:"dataGridHeaderRowHeight",configRowHeight:null!=i?i:1,rowHeightState:r,onUpdateRowHeight:o}),{rowHeight:dt,rowHeightLines:bt,onChangeRowHeight:pt,onChangeRowHeightLines:gt}=Ns({storage:Te,consumer:ne,key:"dataGridRowHeight",configRowHeight:null!=K?K:Aa.d.default,rowHeightState:R,onUpdateRowHeight:I}),mt=Object(n.useMemo)((()=>Ts({columns:at,columnsCellActions:lt,rowsCount:Ge.length,settings:v,dataView:d,defaultColumns:Ne,isSortEnabled:F,isPlainRecord:V,services:{uiSettings:ye,toastNotifications:Oe},hasEditDataViewPermission:()=>{var e;return Boolean(null==ve||null===(e=ve.userPermissions)||void 0===e?void 0:e.editIndexPattern())},valueToStringConverter:Ae,onFilter:p,editField:Xe,visibleCellActions:ae,columnsMeta:a,showColumnTokens:s,headerRowHeightLines:ot,customGridColumnsConfiguration:ce})),[a,lt,ce,d,ve,Ne,Ge.length,Xe,ot,V,F,p,v,s,Oe,ye,Ae,ae,at]),jt=Object(n.useMemo)((()=>[{type:Aa.i,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),xt=Object(n.useMemo)((()=>({visibleColumns:at,setVisibleColumns:e=>{const t=!tt(e);m(e,t)}})),[at,m,tt]),ft=Object(n.useMemo)((()=>k.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>at.includes(e)))),[k,at]),ht=Object(n.useCallback)((e=>{F&&x&&x(e.map((({id:e,direction:t})=>[e,t])))}),[x,F]),Ot=Object(n.useMemo)((()=>{if(F){if(V&&!t.length)return;return{columns:ft,onSort:ht}}return{columns:ft,onSort:()=>{}}}),[F,ft,V,t.length,ht]),vt=Boolean(J&&!!Z),yt=Object(n.useMemo)((()=>{const e=function(e){return e?[vs,ys]:[ys]}(vt).filter((({id:e})=>c.includes(e)));return X?[...e,...X]:e}),[vt,c,X]),Tt=null==de?void 0:de({controlColumns:{[Os]:ys,[hs]:vs}}),kt=null!==(xe=null==Tt?void 0:Tt.leadingControlColumns)&&void 0!==xe?xe:yt,Ct=null!==(fe=null==Tt?void 0:Tt.trailingControlColumns)&&void 0!==fe?fe:H,Et=Object(n.useMemo)((()=>ee||Ve.length?Object(j.jsx)(l.a.Fragment,null,Boolean(Ve.length)&&Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",responsive:!1},be&&Ve.length>1&&Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(ts,{selectedDocs:Ve,setIsCompareActive:Re})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(es,{isPlainRecord:V,isFilterActive:we,rows:f,selectedDocs:Ve,setSelectedDocs:Fe,setIsFilterActive:Me}))),ee):null),[ee,Ve,V,we,be,f]),St=Object(n.useMemo)((()=>U?e=>U({toolbarProps:e,gridProps:{additionalControls:Et}}):void 0),[U,Et]),Ft=Object(n.useMemo)((()=>{const e={};return I&&(e.allowDensity=!1),(I||o||P)&&(e.allowRowHeight=!1,e.allowResetButton=!1,e.additionalDisplaySettings=Object(j.jsx)(Ms,{rowHeight:dt,rowHeightLines:bt,onChangeRowHeight:pt,onChangeRowHeightLines:gt,headerRowHeight:rt,headerRowHeightLines:ot,onChangeHeaderRowHeight:ut,onChangeHeaderRowHeightLines:ct,maxAllowedSampleSize:N,sampleSize:D,onChangeSampleSize:P})),Object.keys(e).length?e:void 0}),[rt,ot,N,ut,ct,pt,gt,o,I,P,dt,bt,D]),wt=Object(n.useMemo)((()=>V&&t.length?{level:"sorting"}:void 0),[t.length,V]),Mt=Object(n.useMemo)((()=>Ne?{...Aa.j,showColumnSelector:!1,showSortSelector:F,additionalControls:Et,showDisplaySelector:Ft,showFullScreenSelector:T}:{...Aa.j,showSortSelector:F,additionalControls:Et,showDisplaySelector:Ft,showFullScreenSelector:T}),[Ne,F,Et,Ft,T]),_t=(({rowHeightLines:e,rowLineHeight:t=Aa.g})=>Object(n.useMemo)((()=>{var a;return{defaultHeight:(a=e)===Aa.d.auto?"auto":a!==Aa.d.single?{lineCount:a}:void 0,lineHeight:t}}),[e,t]))({rowHeightLines:bt,rowLineHeight:oe}),{dataGridId:Rt,dataGridWrapper:It,setDataGridWrapper:Nt}=(()=>{const e=Object(C.useGeneratedHtmlId)({prefix:"unifiedDataTable"}),[t,a]=Object(n.useState)(null),[s,i]=Object(n.useState)(null),l=Object(n.useCallback)(((t,a)=>{const s=document.getElementById(e);s&&(i(s),a.disconnect())}),[e]),r=Object(n.useCallback)((()=>{s&&(e=>{e.classList.contains("euiDataGrid--fullScreen")?document.body.classList.add(As):document.body.classList.remove(As)})(s)}),[s]);return Object(C.useMutationObserver)(t,l,{childList:!0,subtree:!0}),Object(C.useMutationObserver)(s,r,{attributes:!0,attributeFilter:["class"]}),{dataGridId:e,dataGridWrapper:t,setDataGridWrapper:a}})(),Dt=b!==Ls.loading;return He||b!==Ls.loading?He?Object(j.jsx)(Ba.a.Provider,{value:Le},Object(j.jsx)("span",{className:"unifiedDataTable__inner"},Object(j.jsx)("div",{ref:Nt,key:_e?"comparisonTable":"docTable","data-test-subj":"discoverDocTable","data-render-complete":Dt,"data-shared-item":"","data-title":O,"data-description":h,"data-document-number":Ge.length,className:Oa()(_,"unifiedDataTable__table")},_e?Object(j.jsx)(Gs,{id:Rt,wrapper:It,consumer:ne,ariaDescribedBy:$e,ariaLabelledBy:e,dataView:d,isPlainRecord:V,selectedFieldNames:at,additionalFieldGroups:ie,selectedDocs:Se,schemaDetectors:jt,forceShowAllFields:Ne,showFullScreenButton:T,fieldFormats:he,getDocById:Pe,setSelectedDocs:Fe,setIsCompareActive:Re}):Object(j.jsx)(Bs,{id:Rt,"aria-describedby":$e,"aria-labelledby":e,columns:mt,columnVisibility:xt,"data-test-subj":"docTable",leadingControlColumns:kt,onColumnResize:g,pagination:Qe,renderCellValue:Je,ref:Ee,rowCount:He,schemaDetectors:jt,sorting:Ot,toolbarVisibility:Mt,rowHeightsOptions:_t,inMemory:wt,gridStyle:null!=re?re:Aa.b,renderCustomGridBody:B,renderCustomToolbar:St,trailingControlColumns:Ct,cellContext:pe,renderCellPopover:Ke})),b!==Ls.loading&&!Ve.length&&w&&!_e&&Object(j.jsx)(ks,{isLoadingMore:b===Ls.loadingMore,rowCount:He,sampleSize:D,pageCount:We,pageIndex:null==Qe?void 0:Qe.pageIndex,totalHits:W,onFetchMoreRecords:Q,data:ke,fieldFormats:he}),O&&Object(j.jsx)(C.EuiScreenReaderOnly,null,Object(j.jsx)("p",{id:String($e)},h?Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:O,searchDescription:h}}):Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:O}}))),vt&&q&&Z(q,Ge,Ie,a))):Object(j.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":Dt,"data-shared-item":"","data-title":O,"data-description":h,"data-document-number":0},Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(C.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(j.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(C.EuiLoadingSpinner,null),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(E.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))};var Ws=a(47),Qs=a(91);const Zs=()=>{const{euiTheme:e}=Object(C.useEuiTheme)(),t=Object(Qs.css)({name:"v92fmm",styles:"min-height:400px"});return{gridStyle:Object(Qs.css)("& .euiDataGridHeaderCell__icon{display:none;}& .euiDataGrid__controls{border-bottom:none;margin-bottom:",e.size.s,";border-top:none;}& .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:",e.border.width.thick," solid ",e.colors.fullShade,";}& .euiButtonIcon[data-test-subj='docTableExpandToggleColumn']{color:",e.colors.primary,";}& .euiDataGridRowCell{font-size:",e.size.m,";.euiDataGridRowCell__content{display:flex;align-items:center;}}& .euiDataGridRowCell.euiDataGridRowCell--numeric{text-align:left;}& .euiDataGridHeaderCell--numeric .euiDataGridHeaderCell__content{flex-grow:0;text-align:left;}& .euiDataGrid__controls{gap:",e.size.s,";}& .euiDataGrid__leftControls{display:flex;align-items:center;width:100%;}& .cspDataTableTotal{font-size:",e.size.m,";font-weight:",e.font.weight.bold,";border-right:",e.border.thin,";margin-inline:",e.size.s,";padding-right:",e.size.m,";}& .euiDataGrid__rightControls{display:none;}& [data-test-subj='docTableExpandToggleColumn'] svg{inline-size:16px;block-size:16px;}& .unifiedDataTable__cellValue{font-family:",e.font.family,";}& .unifiedDataTable__inner .euiDataGrid__controls{border-top:none;}",""),groupBySelector:Object(Qs.css)({name:"1o3nkn",styles:"margin-left:auto"}),gridContainer:t}};var Js=a(94),qs=a.n(Js);const Ks={sort:{field:"name",direction:"asc"}},$s=_.i18n.translate("xpack.csp.dataTable.fieldsModal.viewLabel",{defaultMessage:"View"}),Ys=_.i18n.translate("xpack.csp.dataTable.fieldsModal.viewSelected",{defaultMessage:"selected"}),Xs=_.i18n.translate("xpack.csp.dataTable.fieldsModal.viewAll",{defaultMessage:"all"}),ei=({title:e,dataView:t,columns:a,onAddColumn:s,onRemoveColumn:i})=>{const[l,r]=Object(n.useState)(!1),[o,u]=Object(n.useState)(),[c,d]=qs()(te.s,!1),b=Object(n.useMemo)((()=>((e,t=[],a,s=!1)=>{const i=e.filter((e=>"_index"!==e.name&&e.visualizable)).map((e=>({id:e.name,name:e.name,displayName:e.customLabel||""}))),n=s?i.filter((e=>t.includes(e.id))):i;return a?n.filter((e=>{const t=`${e.name} ${e.displayName}`.toLowerCase(),s=a.toLowerCase()||"";return-1!==t.indexOf(s)})):n})(t.fields.getAll(),a,o,c)),[t,a,o,c]),p=Object(n.useCallback)((()=>{r((e=>!e))}),[]),g=Object(n.useCallback)((()=>{r(!1)}),[]),m=Object(n.useCallback)((e=>{d(e)}),[d]);let x;const f=[{field:"action",name:"",width:"24px",sortable:!1,render:(e,{id:t})=>Object(j.jsx)(C.EuiCheckbox,{checked:a.includes(t),id:`cloud-security-fields-selector-item-${t}`,"data-test-subj":`cloud-security-fields-selector-item-${t}`,onChange:e=>e.target.checked?s(t):i(t)})},{field:"name",name:_.i18n.translate("xpack.csp.dataTable.fieldsModalName",{defaultMessage:"Name"}),sortable:!0}],h=Object(n.useMemo)((()=>t&&0!==t.fields.length?"":_.i18n.translate("xpack.csp.dataTable.fieldsModalError",{defaultMessage:"No fields found in the data view"})),[t]),O={onChange:({query:e})=>{clearTimeout(x),x=setTimeout((()=>{u(null==e?void 0:e.text)}),300)},box:{incremental:!0,placeholder:_.i18n.translate("xpack.csp.dataTable.fieldsModalSearch",{defaultMessage:"Search field name"})}},v=Object(n.useMemo)((()=>{const e=b.length;return Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{"data-test-subj":"csp:dataTable:fieldsModal:fieldsShowing",size:"xs"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalFieldsShowing",defaultMessage:"Showing"})," ",Object(j.jsx)("strong",{"data-test-subj":"csp:dataTable:fieldsModal:fieldsCount"},e)," ",Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalFieldsCount",defaultMessage:"{totalFields, plural, one {field} other {fields}}",values:{totalFields:e}}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPopover,{panelPaddingSize:"none",anchorPosition:"downRight",isOpen:l,closePopover:g,button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"viewSelectorButton",size:"xs",iconType:"arrowDown",iconSide:"right",onClick:p},`${$s}: ${c?Ys:Xs}`)},Object(j.jsx)(C.EuiContextMenuPanel,{"data-test-subj":"viewSelectorMenu",size:"s",items:[Object(j.jsx)(C.EuiContextMenuItem,{"data-test-subj":"viewSelectorOption-all",key:"viewAll",icon:c?"empty":"check",onClick:()=>{m(!1),g()}},`${$s} ${Xs}`),Object(j.jsx)(C.EuiHorizontalRule,{key:"separator",margin:"none"}),Object(j.jsx)(C.EuiContextMenuItem,{"data-test-subj":"viewSelectorOption-selected",key:"viewSelected",icon:c?"check":"empty",onClick:()=>{m(!0),g()}},`${$s} ${Ys}`)]}))))}),[g,b.length,c,l,m,p]);return Object(j.jsx)(C.EuiInMemoryTable,{tableCaption:e,items:b,columns:f,search:O,pagination:!0,sorting:Ks,error:h,childrenBetween:v})},ti=_.i18n.translate("xpack.csp.dataTable.fieldsModalTitle",{defaultMessage:"Fields"}),ai=({closeModal:e,dataView:t,columns:a,onAddColumn:s,onRemoveColumn:i,onResetColumns:n})=>Object(j.jsx)(C.EuiModal,{onClose:e,"data-test-subj":A.l},Object(j.jsx)(C.EuiModalHeader,null,Object(j.jsx)(C.EuiModalHeaderTitle,null,ti)),Object(j.jsx)(C.EuiModalBody,null,Object(j.jsx)(ei,{title:ti,dataView:t,columns:a,onAddColumn:s,onRemoveColumn:i})),Object(j.jsx)(C.EuiModalFooter,null,Object(j.jsx)(C.EuiButtonEmpty,{onClick:n,"data-test-subj":A.n},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalReset",defaultMessage:"Reset Fields"})),Object(j.jsx)(C.EuiButton,{onClick:e,fill:!0,"data-test-subj":A.k},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalClose",defaultMessage:"Close"})))),si=({children:e})=>{const t=Zs();return Object(j.jsx)(C.EuiFlexItem,{grow:!1,className:t.groupBySelector},e)},ii=({total:e,title:t,dataView:a,columns:s,onAddColumn:i,onRemoveColumn:r,groupSelectorComponent:o,onResetColumns:u})=>{const{isFieldSelectorModalVisible:c,closeFieldsSelectorModal:d,openFieldsSelectorModal:b}=(()=>{const[e,t]=Object(n.useState)(!1);return{isFieldSelectorModalVisible:e,closeFieldsSelectorModal:()=>t(!1),openFieldsSelectorModal:()=>t(!0)}})();return Object(j.jsx)(l.a.Fragment,null,c&&Object(j.jsx)(ai,{columns:s,dataView:a,closeModal:d,onAddColumn:i,onRemoveColumn:r,onResetColumns:u}),Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)("span",{className:"cspDataTableTotal"},`${oa(e)} ${t}`)),Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)(C.EuiButtonEmpty,{className:"cspDataTableFields",iconType:"tableOfContents",onClick:b,size:"xs",color:"text","data-test-subj":A.m},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dataTable.fieldsButton",defaultMessage:"Fields"}))),o&&Object(j.jsx)(si,null,o))};var ni=a(40),li=a.n(ni),ri=a(48),oi=a(154),ui=a(32),ci=a.n(ui);const di="eui-global",bi="eui-utilities",pi={darkMode:!1},gi=[C.euiStylisPrefixer],mi=ci()({key:"css",stylisPlugins:gi,container:document.querySelector('meta[name="emotion"]')}),ji=ci()({key:di,stylisPlugins:gi,container:document.querySelector(`meta[name="${di}"]`)}),xi=ci()({key:bi,stylisPlugins:gi,container:document.querySelector(`meta[name="${bi}"]`)});mi.compat=!0,ji.compat=!0,xi.compat=!0;const fi={default:mi,global:ji,utility:xi},hi=({theme:{theme$:e},globalStyles:t,colorMode:a,modify:s,children:i})=>{const l=ya()(e,pi),r=Object(n.useMemo)((()=>(e=>e.darkMode?C.COLOR_MODES_STANDARD.dark:C.COLOR_MODES_STANDARD.light)(l)),[l]),o=a||r,u=!1!==t&&void 0;return Object(j.jsx)(C.EuiProvider,{cache:fi,modify:s,colorMode:o,globalStyles:u,utilityClasses:u},i)},Oi=({children:e,i18n:t,...a})=>Object(ri.useIsNestedEuiProvider)()?(Object(oi.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(j.jsx)(t.Context,null,e)):Object(j.jsx)(hi,a,Object(j.jsx)(t.Context,null,e)),vi=({children:e,...t})=>Object(j.jsx)(Oi,i()({globalStyles:!1},t),Object(j.jsx)(Ds.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(j.jsx)(Ds.KibanaErrorBoundary,null,e))),yi=(e,t)=>a=>(li.a.render(Object(j.jsx)(vi,t,e),a),()=>li.a.unmountComponentAtNode(a));n.Component;const Ti=(e,t,a)=>{const{notifications:s,analytics:i,i18n:n,theme:l}=e,r={analytics:i,i18n:n,theme:l};return s.toasts.addSuccess({toastLifeTimeMs:1e4,color:"success",iconType:"","data-test-subj":"csp:toast-success",title:yi(Object(j.jsx)("div",null,Object(j.jsx)(C.EuiText,{size:"m"},Object(j.jsx)("strong",{"data-test-subj":"csp:toast-success-title"},a.name)," ",Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToastTitle",defaultMessage:"detection rule was created."})),Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToast",defaultMessage:"Add rule actions to get notified when alerts are generated."}))),r),text:yi(Object(j.jsx)("div",null,Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButton,{"data-test-subj":"csp:toast-success-link",size:"s",href:t.basePath.prepend("/app/security/rules/id/"+a.id)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToastViewRuleButton",defaultMessage:"View rule"}))))),r)})},ki=(e,t,a)=>{const{notifications:s,analytics:i,i18n:n,theme:r}=e,o={analytics:i,i18n:n,theme:r};return s.toasts.addSuccess({toastLifeTimeMs:1e4,color:"success",iconType:"","data-test-subj":"csp:toast-success-rule-state-change",title:yi(Object(j.jsx)(C.EuiText,{size:"m"},Object(j.jsx)("strong",{"data-test-subj":"csp:toast-success-rule-title"},t?Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleEnabledToastTitle",defaultMessage:"Rule Enabled"}):Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleDisabledToastTitle",defaultMessage:"Rule Disabled"}))),o),text:yi(Object(j.jsx)("div",null,t?Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleEnabledToastRulesCount",defaultMessage:"Successfully enabled {ruleCount, plural, one {# rule} other {# rules}} ",values:{ruleCount:a.numberOfRules}}):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleDisabledToastRulesCount",defaultMessage:"Successfully disabled {ruleCount, plural, one {# rule} other {# rules}} ",values:{ruleCount:a.numberOfRules}}),!t&&a.numberOfDetectionRules>0&&Object(j.jsx)("strong",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.ruleDisabledToastDetectionRulesCount",defaultMessage:" and {detectionRuleCount, plural, one {# detection rule} other {# detection rules}}",values:{detectionRuleCount:a.numberOfDetectionRules}})))),o)})},Ci=({createRuleFn:e,enableBenchmarkRuleFn:t,disableBenchmarkRuleFn:a,isCreateDetectionRuleDisabled:s=!1,isDataGridControlColumn:i=!1})=>{const l=Object(r.useQueryClient)(),[o,u]=Object(n.useState)(!1),[c,d]=Object(n.useState)(!1),b=()=>{u(!1)},p=Object(C.useGeneratedHtmlId)({prefix:"smallContextMenuPopover"}),g=i?Object(j.jsx)(C.EuiButtonIcon,{"aria-label":_.i18n.translate("xpack.csp.flyout.moreActionsButton",{defaultMessage:"More actions"}),iconType:"boxesHorizontal",color:"primary",isLoading:c,onClick:()=>u(!o)}):Object(j.jsx)(C.EuiButton,{isLoading:c,fill:!0,iconType:"arrowDown",iconSide:"right",onClick:()=>u(!o)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.flyout.takeActionButton",defaultMessage:"Take action"})),m=[];return e&&m.push(Object(j.jsx)(Ei,{key:"createRule",createRuleFn:e,setIsLoading:d,closePopover:b,queryClient:l,isCreateDetectionRuleDisabled:s})),t&&m.push(Object(j.jsx)(Si,{key:"enableBenchmarkRule",enableBenchmarkRuleFn:t,setIsLoading:d,closePopover:b})),a&&m.push(Object(j.jsx)(Fi,{key:"disableBenchmarkRule",disableBenchmarkRuleFn:a,setIsLoading:d,closePopover:b})),Object(j.jsx)(C.EuiPopover,{id:p,button:g,isOpen:o,closePopover:b,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":A.y},Object(j.jsx)(C.EuiContextMenuPanel,{size:"s",items:m}))},Ei=({createRuleFn:e,setIsLoading:t,closePopover:a,queryClient:s,isCreateDetectionRuleDisabled:i=!1})=>{const{http:n,...l}=Object(w.a)().services;return Object(j.jsx)(C.EuiContextMenuItem,{key:"createRule",disabled:i,onClick:async()=>{a(),t(!0);const i=await e(n);t(!1),Ti(l,n,i),s.invalidateQueries([te.e]),s.invalidateQueries([te.d])},"data-test-subj":A.i},Object(j.jsx)(E.FormattedMessage,{defaultMessage:"Create a detection rule",id:"xpack.csp.createDetectionRuleButton"}))},Si=({enableBenchmarkRuleFn:e,setIsLoading:t,closePopover:a})=>Object(j.jsx)(C.EuiContextMenuItem,{key:"enableBenchmarkRule",onClick:async()=>{a(),t(!0),await e(),t(!1)},"data-test-subj":"enable-benchmark-rule-take-action-button"},Object(j.jsx)(E.FormattedMessage,{defaultMessage:"Enable Rule",id:"xpack.csp.enableBenchmarkRuleButton"})),Fi=({disableBenchmarkRuleFn:e,setIsLoading:t,closePopover:a})=>Object(j.jsx)(C.EuiContextMenuItem,{key:"disableBenchmarkRule",onClick:async()=>{a(),t(!0),await e(),t(!1)},"data-test-subj":"disable-benchmark-rule-take-action-button"},Object(j.jsx)(E.FormattedMessage,{defaultMessage:"Disable Rule",id:"xpack.csp.disableBenchmarkRuleButton"})),wi={border:"horizontal",cellPadding:"l",stripes:!1,header:"underline"},Mi=["openDetails"],_i=({isLoading:e,defaultColumns:t,rows:a,total:s,flyoutComponent:i,cloudPostureDataTable:l,loadMore:r,title:o,customCellRenderer:d,groupSelectorComponent:b,height:p,createRuleFn:g,columnHeaders:m,hasDistributionBar:x=!0,...f})=>{const{columnsLocalStorageKey:h,pageSize:O,onChangeItemsPerPage:v,setUrlQuery:y,onSort:T,onResetFilters:E,filters:S,sort:F}=l,[M,_]=k()(h,t.map((e=>e.id))),[R,I]=k()(`${h}:settings`,{columns:t.reduce(((e,t)=>{const a=t.width?{width:t.width}:{};return{...e,[t.id]:a}}),{})}),N=Object(n.useMemo)((()=>({columns:Object.keys(null==R?void 0:R.columns).reduce(((e,t)=>{var a;const s={...c.a.pick(null==R||null===(a=R.columns)||void 0===a?void 0:a[t],["width"]),display:null==m?void 0:m[t]};return{...e,[t]:s}}),{})})),[R,m]),{dataView:D,dataViewIsRefetching:P}=Ot(),[V,G]=Object(n.useState)(void 0),{uiSettings:A,uiActions:L,dataViews:z,data:B,application:U,theme:H,fieldFormats:W,toastNotifications:Q,storage:Z}=Object(w.a)().services,J=Zs(),{capabilities:q}=U,{filterManager:K}=B.query,$={theme:H,fieldFormats:W,uiSettings:A,toastNotifications:Q,storage:Z,data:B},{columns:Y,onSetColumns:X,onAddColumn:ee,onRemoveColumn:ae}=(({capabilities:e,dataView:t,dataViews:a,setAppState:s,useNewFieldsApi:i,columns:l,sort:r,defaultOrder:o="desc"})=>{const[c,d]=Object(n.useState)(fa(l,i));Object(n.useEffect)((()=>{const e=fa(l,i);Object(u.isEqual)(c,e)||d(e)}),[l,i,c]);const{onAddColumn:b,onRemoveColumn:p,onSetColumns:g,onMoveColumn:m}=Object(n.useMemo)((()=>function({capabilities:e,dataView:t,dataViews:a,useNewFieldsApi:s,setAppState:i,columns:n,sort:l,defaultOrder:r}){return{onAddColumn:function(o){ja(t,o,a,e);const u=function(e,t,a){return e.includes(t)?e:xa([...e,t],a)}(n||[],o,s),c="_score"!==o||null!=l&&l.length?l:[["_score",r]];i({columns:u,sort:c})},onRemoveColumn:function(r){ja(t,r,a,e);const o=function(e,t,a){return e.includes(t)?xa(e.filter((e=>e!==t)),a):e}(n||[],r,s),u=l&&l.length?l.filter((e=>e[0]!==r)):[];i({columns:o,sort:u})},onMoveColumn:function(e,t){const a=function(e,t,a){if(a<0||a>=e.length||!e.includes(t))return e;const s=[...e];return s.splice(s.indexOf(t),1),s.splice(a,0,t),s}(n||[],e,t);i({columns:a})},onSetColumns:function(e,a){const s=!a&&t.timeFieldName&&t.timeFieldName===e[0]?(e||[]).slice(1):e;i({columns:s})}}}({capabilities:e,dataView:t,dataViews:a,setAppState:s,useNewFieldsApi:i,columns:c,sort:r,defaultOrder:o})),[e,t,a,o,s,r,i,c]);return{columns:c,onAddColumn:b,onRemoveColumn:p,onMoveColumn:m,onSetColumns:g}})({capabilities:q,defaultOrder:A.get("discover:sort:defaultOrder"),dataView:D,dataViews:z,setAppState:e=>_(e.columns),useNewFieldsApi:!0,columns:M,sort:F}),se=Object(n.useMemo)((()=>{const e=O>=100;return{wrapperHeight:p||(e?`calc(100vh - 362px - ${(null==S?void 0:S.length)>0?40:0}px - ${x?52:0}px)`:"auto"),mode:e?"virtualized":"standard"}}),[O,p,null==S?void 0:S.length,x]),ie=Object(n.useMemo)((()=>K&&D?(e,t,a)=>{const s=Object(Ws.generateFilters)(K,e,t,a,D);K.addFilters(s),y({filters:K.getFilters()})}:void 0),[D,K,y]),ne=Object(n.useMemo)((()=>{if(d)return d(a)}),[d,a]);if(!e&&!a.length)return Object(j.jsx)(ge,{onResetFilters:E});const le=Object(j.jsx)(ii,{total:s,dataView:D,title:o,columns:Y,onAddColumn:ee,onRemoveColumn:ae,groupSelectorComponent:b,onResetColumns:()=>{_(t.map((e=>e.id)))}}),re=g?[{id:"select",width:20,headerCellRender:()=>null,rowCellRender:({rowIndex:e})=>g&&Object(j.jsx)(Ci,{isDataGridControlColumn:!0,createRuleFn:g(e)})}]:void 0,oe={opacity:e?1:0},ue=e||P?Ls.loading:Ls.loaded;return Object(j.jsx)(Ca,{getTriggerCompatibleActions:L.getTriggerCompatibleActions},Object(j.jsx)("div",{"data-test-subj":f["data-test-subj"],className:J.gridContainer,style:{height:se.wrapperHeight}},Object(j.jsx)(C.EuiProgress,{size:"xs",color:"accent",style:oe}),Object(j.jsx)(Hs,{key:se.mode,className:J.gridStyle,ariaLabelledBy:o,columns:Y,expandedDoc:V,dataView:D,loadingState:ue,onFilter:ie,onResize:e=>{const t=R||{},a={...t.columns||{}};a[e.columnId]={width:Math.round(e.width)};const s={...t,columns:a};I(s)},onSetColumns:X,onSort:T,rows:a,sampleSizeState:te.p,setExpandedDoc:G,renderDocumentView:e=>i(e,(()=>G(void 0))),sort:F,rowsPerPageState:O,totalHits:s,services:$,useNewFieldsApi:!0,onUpdateRowsPerPage:v,rowHeightState:0,showMultiFields:A.get("discover:showMultiFields"),showTimeCol:!1,settings:N,onFetchMoreRecords:r,externalControlColumns:re,externalCustomRenderers:ne,externalAdditionalControls:le,gridStyleOverride:wi,rowLineHeightOverride:"24px",controlColumnIds:Mi})))};var Ri=a(42);const Ii=["_type","_source"];function Ni(e,t,a,s,i){for(const n in t){if(!t.hasOwnProperty(n))continue;const l=t[n],r=a+n,o=null==s?void 0:s.fields.getByName(r);if(!1===(null==i?void 0:i.shallow)){const t="nested"===(null==o?void 0:o.type);if(Array.isArray(l)&&!t){for(let t=0;t<l.length;t++){const a=l[t];Object(u.isPlainObject)(a)&&Ni(e,a,r+".",s,i)}continue}}else if(void 0!==e[r])continue;const c=o&&"conflict"!==o.type,d=!Object(u.isPlainObject)(l);c||d?e[r]?Array.isArray(e[r])?e[r].push(l):e[r]=[e[r],l]:e[r]=l:Ni(e,l,r+".",s,i)}}function Di(e,t,a){const s={};if(Ni(s,e.fields||{},"",t,a),!1!==(null==a?void 0:a.source)&&e._source)Ni(s,e._source,"",t,a);else if(null!=a&&a.includeIgnoredValues&&e.ignored_field_values)for(const t in e.ignored_field_values){if(!e.ignored_field_values.hasOwnProperty(t))continue;const a=e.ignored_field_values[t];s[t]?Array.isArray(s[t])?s[t]=[...s[t],...a]:s[t]=[s[t],...a]:s[t]=a}if(null!=t&&t.metaFields)for(let a=0;a<(null==t?void 0:t.metaFields.length);a++){const i=null==t?void 0:t.metaFields[a];Ii.includes(i)||"_"!==i.charAt(0)||(s[i]=e[i])}return function(e,t){function a(e,a){var s,i;const n=null==t||null===(s=t.metaFields)||void 0===s?void 0:s.includes(String(e)),l=null==t||null===(i=t.metaFields)||void 0===i?void 0:i.includes(String(a));return n&&l?String(e).localeCompare(String(a)):n?1:l?-1:String(e).localeCompare(String(a))}return new Proxy(e,{ownKeys:e=>Reflect.ownKeys(e).sort(a)})}(s,t)}const Pi=e=>{const t=e._routing?e._routing:"";return[e._index,e._id,t].join("::")};function Vi(e,t,a){return{id:Pi(e),raw:e,flattened:Di(e,t,{includeIgnoredValues:!0}),isAnchor:a}}const Gi=e=>{const t=e.find((e=>"passed"===(null==e?void 0:e.key))),a=e.find((e=>"failed"===(null==e?void 0:e.key)));return{passed:(null==t?void 0:t.doc_count)||0,failed:(null==a?void 0:a.doc_count)||0}},Ai=({query:e,sort:t},a,s)=>{var i,n,l,r;const o=ta(a);return{index:F.A,sort:Li(t),size:te.p,aggs:{count:{terms:{field:"result.evaluation"}}},ignore_unavailable:!1,query:{...e,bool:{...null==e?void 0:e.bool,filter:[...null!==(i=null==e||null===(n=e.bool)||void 0===n?void 0:n.filter)&&void 0!==i?i:[],{range:{"@timestamp":{gte:`now-${F.M}`,lte:"now"}}}],must_not:[...null!==(l=null==e||null===(r=e.bool)||void 0===r?void 0:r.must_not)&&void 0!==l?l:[],...o]}},...s?{from:s}:{}}},Li=e=>e.map((([e,t])=>({...Bi({field:e,direction:t})}))),zi=["rule.section","resource.name","resource.sub_type"],Bi=({field:e,direction:t})=>zi.includes(e)?{_script:{type:"string",order:t,script:{source:`doc["${e}"].value.toLowerCase()`,lang:"painless"}}}:{[e]:t};var Ui=a(30),Hi=a.n(Ui);const Wi={name:"7403zr",styles:"&[data-position='top']{margin-block-start:-8px;}"},Qi=({timestamp:e})=>Object(j.jsx)(C.EuiToolTip,{position:"bottom",css:Wi,content:Hi()(e).format(te.a)},Object(j.jsx)("span",null,Hi()(e).fromNow())),Zi=e=>"passed"===e?te.w.passed:"failed"===e?te.w.failed:"default",Ji=({type:e})=>Object(j.jsx)(C.EuiBadge,{color:Zi(e),css:Object(j.css)("width:","46px",";display:flex;justify-content:center;",""),"data-test-subj":`${e}_finding`},"failed"===e?Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.failLabel",defaultMessage:"Fail"}):Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.passLabel",defaultMessage:"Pass"}));var qi=a(35),Ki=a(98),$i=a.n(Ki);const Yi={box:{incremental:!0}},Xi={sort:{field:"key",direction:"asc"}},en={initialPageSize:100,showPerPageOptions:!1},tn=[{field:"key",name:_.i18n.translate("xpack.csp.flyout.tableTab.fieldLabel",{defaultMessage:"Field"}),width:"25%"},{field:"value",name:_.i18n.translate("xpack.csp.flyout.tableTab.fieldValueLabel",{defaultMessage:"Value"}),render:(e,t)=>Object(j.jsx)("div",{style:{width:"100%"}},(e=>void 0===e?"undefined":"boolean"==typeof e||null===e?Object(j.jsx)(C.EuiCode,null,JSON.stringify(e)):"object"==typeof e?Object(j.jsx)(C.EuiCodeBlock,{isCopyable:!0,overflowHeight:300},JSON.stringify(e,null,2)):Object(j.jsx)(C.EuiText,{size:"s"},e))(e))}],an=({data:e})=>{return Object(j.jsx)(C.EuiInMemoryTable,{items:(t=e,Object.entries(Object(qi.getFlattenedObject)(t)).map((([e,t])=>({key:e,value:t})))),columns:tn,sorting:Xi,search:Yi,pagination:en});var t};var sn=a(34),nn=a(33);const ln=({data:e})=>Object(j.jsx)("div",{style:{position:"absolute",inset:0,top:120,bottom:72}},Object(j.jsx)(sn.CodeEditor,{isCopyable:!0,allowFullScreen:!0,languageId:nn.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"on",folding:!0}})),rn=["Cloud Security","Use Case: Configuration Audit"],on=e=>`alert.attributes.tags:(${e.map((e=>`"${e}"`)).join(" AND ")})`,un=e=>`alert.attributes.tags:(${e.map((e=>`"${e}"`)).join(" OR ")})`,cn=e=>{if(!e.benchmark||!e.benchmark.id)return[];const t=e.benchmark.id.split("_").map((e=>e.toUpperCase())),a=e.benchmark.rule_number?`${e.benchmark.id.replace("_"," ").toUpperCase()} ${e.benchmark.rule_number}`:e.benchmark.id.replace("_"," ").toUpperCase();return t.concat([a])},dn=(e,t={match:"all"})=>{const{http:a}=Object(L.useKibana)().services;return Object(r.useQuery)({queryKey:[te.e,e,t],queryFn:()=>bn(e,t,a),enabled:e.length>0})},bn=(e,t={match:"all"},a)=>{const s={page:1,per_page:1,filter:"all"===t.match?on(e):un(e)};return a.fetch("/api/detection_engine/rules/_find",{method:"GET",version:F.C,query:s})},pn=({tags:e,createRuleFn:t})=>{const{data:a,isLoading:s}=dn(e),{data:i,isLoading:u}=(e=>{const{http:t}=Object(L.useKibana)().services;if(!t)throw new Error("Kibana http service is not available");return Object(r.useQuery)([te.d,e],(()=>t.get(F.H,{version:F.B,query:{tags:e}})))})(e),[c,d]=Object(n.useState)(!1),b=Object(r.useQueryClient)(),{http:p,notifications:g,analytics:m,i18n:x,theme:f}=Object(w.a)().services,h=Object(o.useHistory)(),[,O]=qs()("securitySolution.rulesTable"),v=Object(n.useCallback)((async()=>{O({tags:e}),h.push({pathname:"/rules/management"})}),[h,O,e]),y=Object(n.useCallback)((()=>{h.push({pathname:"/alerts"})}),[h]),T=Object(n.useCallback)((async()=>{const e={analytics:m,notifications:g,i18n:x,theme:f};d(!0);const a=await t(p);d(!1),Ti(e,p,a),b.invalidateQueries([te.e]),b.invalidateQueries([te.d])}),[t,p,m,g,x,f,b]);return Object(j.jsx)(C.EuiSkeletonText,{"data-test-subj":"csp:detection-rule-counter-loading",lines:1,size:"m",isLoading:s||u},0===(null==a?void 0:a.total)?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiText,{size:"s"},c?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.creatingRule",defaultMessage:"Creating detection rule"})," ",Object(j.jsx)(C.EuiLoadingSpinner,{size:"s","data-test-subj":"csp:findings-flyout-detection-rule-counter-loading"})):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiLink,{onClick:T,"data-test-subj":"csp:findings-flyout-create-detection-rule-link"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.createRuleAction",defaultMessage:"Create a detection rule"}))," ",Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.createRuleDescription",defaultMessage:"to generate alerts."})))):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiLink,{onClick:y,"data-test-subj":"csp:findings-flyout-alert-count"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.alertCount",defaultMessage:"{alertCount, plural, one {# alert} other {# alerts}}",values:{alertCount:(null==i?void 0:i.total)||0}}))," ",Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.detectedBy",defaultMessage:"detected by"})," ",Object(j.jsx)(C.EuiLink,{onClick:v,"data-test-subj":"csp:findings-flyout-detection-rule-count"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.detectionRuleCount",defaultMessage:"{ruleCount, plural, one {# detection rule} other {# detection rules}}",values:{ruleCount:(null==a?void 0:a.total)||0}}))))},gn=async({http:e,rule:t})=>await e.post("/api/detection_engine/rules",{version:F.C,body:JSON.stringify(t)}),mn={field_names:["resource.name","resource.id","resource.type","resource.sub_type"]};var jn=function(e){return e.DoNotSuppress="doNotSuppress",e.Suppress="suppress",e}(jn||{});const xn=e=>{if(!e)return[];const t=e.match(/(https?:\/\/\S+)/g);return t?t.map((e=>e.replace(/^\d+\. /,"").replace(/\n/g,""))):[]},fn=e=>{const t=(new Date).toISOString();return`rule.benchmark.rule_number: "${e.benchmark.rule_number}"\n    AND rule.benchmark.id: "${e.benchmark.id}"\n    AND result.evaluation: "failed"\n    AND event.ingested >= "${t}"`},hn=async(e,t)=>{return await gn({http:e,rule:{type:"query",language:"kuery",license:"Elastic License v2",author:["Elastic"],filters:[],false_positives:[],risk_score:0,risk_score_mapping:[],severity:"low",severity_mapping:[],threat:[],interval:"1h",from:`now-${F.M}`,to:"now",max_signals:100,timestamp_override:"event.ingested",timestamp_override_fallback_disabled:!1,actions:[],enabled:!0,alert_suppression:{group_by:["resource.id"],missing_fields_strategy:jn.Suppress},index:[F.E],query:fn(t),references:xn(t.references),name:t.name,description:t.rationale,tags:(a=t,[rn].concat(cn(a)).concat(a.benchmark.posture_type?[a.benchmark.posture_type.toUpperCase(),`Data Source: ${a.benchmark.posture_type.toUpperCase()}`]:[]).concat("cspm"===a.benchmark.posture_type?["Domain: Cloud"]:["Domain: Container"]).flat()),investigation_fields:mn,note:t.remediation}});var a},On=({finding:e})=>Object(j.jsx)(pn,{tags:cn(e.rule),createRuleFn:async t=>await hn(t,e.rule)}),vn=(e,t,a)=>[{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleNameTitle",{defaultMessage:"Rule Name"}),description:Object(j.jsx)(C.EuiToolTip,{position:"top",content:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleNameTooltip",{defaultMessage:"Manage Rule"})},Object(j.jsx)(C.EuiLink,{href:t},e.rule.name))},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.alertsTitle",{defaultMessage:"Alerts"}),description:Object(j.jsx)(On,{finding:e})},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleTagsTitle",{defaultMessage:"Rule Tags"}),description:Object(j.jsx)(l.a.Fragment,null,e.rule.tags.map((e=>Object(j.jsx)(C.EuiBadge,{key:e},e))))},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evaluatedAtTitle",{defaultMessage:"Evaluated at"}),description:Hi()(e["@timestamp"]).format(te.a)},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(j.jsx)(Bn,{benchmarkId:e.rule.benchmark.id,benchmarkName:e.rule.benchmark.name})},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.rule.section},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.indexTitle",{defaultMessage:"Index"}),description:a?Object(j.jsx)(C.EuiLink,{href:a},F.K):F.K}],yn=e=>[{title:"",description:Object(j.jsx)(zn,null,e.remediation)},...e.impact?[{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.impactTitle",{defaultMessage:"Impact"}),description:Object(j.jsx)(zn,null,e.impact)}]:[],...e.default_value?[{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.defaultValueTitle",{defaultMessage:"Default Value"}),description:Object(j.jsx)(zn,null,e.default_value)}]:[],{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.rationaleTitle",{defaultMessage:"Rationale"}),description:Object(j.jsx)(zn,null,e.rationale)}],Tn=({result:e})=>[{title:"",description:Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiText,{color:"subdued"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.findingsFlyout.overviewTab.evidenceDescription",defaultMessage:"The specific resource metadata that was evaluated to generate this posture finding"})),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(Ln,{language:"json"},JSON.stringify(e.evidence,null,2)))}].filter(At.i),kn=({data:e,ruleFlyoutLink:t})=>{var a;const{discover:s}=Object(w.a)().services,i=ce(F.L),r=Object(n.useMemo)((()=>{var e,t;return null===(e=s.locator)||void 0===e?void 0:e.getRedirectUrl({indexPatternId:null===(t=i.data)||void 0===t?void 0:t.id})}),[s.locator,null===(a=i.data)||void 0===a?void 0:a.id]),o=!Object(u.isEmpty)(e.result.evidence),c=Object(n.useMemo)((()=>[{initialIsOpen:!0,title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.detailsTitle",{defaultMessage:"Details"}),id:"detailsAccordion",listItems:vn(e,t,r)},{initialIsOpen:!0,title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.remediationTitle",{defaultMessage:"Remediation"}),id:"remediationAccordion",listItems:yn(e.rule)},F.I.showFindingFlyoutEvidence&&o&&{initialIsOpen:!0,title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evidenceSourcesTitle",{defaultMessage:"Evidence"}),id:"evidenceAccordion",listItems:Tn(e)}].filter(At.i)),[e,r,o,t]);return Object(j.jsx)(l.a.Fragment,null,c.map((e=>Object(j.jsx)(l.a.Fragment,{key:e.id},Object(j.jsx)(C.EuiPanel,{hasShadow:!1,hasBorder:!0},Object(j.jsx)(C.EuiAccordion,{id:e.id,buttonContent:Object(j.jsx)(C.EuiText,null,Object(j.jsx)("strong",null,e.title)),arrowDisplay:"left",initialIsOpen:e.initialIsOpen},Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)(C.EuiDescriptionList,{listItems:e.listItems}))),Object(j.jsx)(C.EuiSpacer,{size:"m"})))))},Cn=({benchmarkRule:e})=>Object(j.jsx)(pn,{tags:cn(e),createRuleFn:async t=>await hn(t,e)}),En=(e,t="unmuted",a)=>[{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.nameTitle",{defaultMessage:"Name"}),description:a?Object(j.jsx)(C.EuiToolTip,{position:"top",content:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.nameTooltip",{defaultMessage:"Manage Rule"})},Object(j.jsx)(C.EuiLink,{href:a},e.name)):e.name},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.descriptionTitle",{defaultMessage:"Description"}),description:Object(j.jsx)(zn,null,e.description)},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.AlertsTitle",{defaultMessage:"Alerts"}),description:"unmuted"===t?Object(j.jsx)(Cn,{benchmarkRule:e}):Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.findingsFlyout.ruleTab.disabledRuleText",defaultMessage:"Disabled"})},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.tagsTitle",{defaultMessage:"Tags"}),description:Object(j.jsx)(l.a.Fragment,null,e.tags.map((e=>Object(j.jsx)(C.EuiBadge,{key:e},e))))},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(j.jsx)(Bn,{benchmarkId:e.benchmark.id,benchmarkName:e.benchmark.name})},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.section},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.profileApplicabilityTitle",{defaultMessage:"Profile Applicability"}),description:Object(j.jsx)(zn,null,e.profile_applicability)},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.benchmarkTitle",{defaultMessage:"Benchmark"}),description:e.benchmark.name},{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.auditTitle",{defaultMessage:"Audit"}),description:Object(j.jsx)(zn,null,e.audit)},...e.references?[{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.referencesTitle",{defaultMessage:"References"}),description:Object(j.jsx)(zn,null,e.references)}]:[]],Sn=({data:e,ruleFlyoutLink:t})=>Object(j.jsx)(C.EuiDescriptionList,{listItems:En(e.rule,t)});var Fn=a(85),wn=a.n(Fn),Mn=a(71),_n=a.n(Mn);const Rn=e=>{switch(e.type){case"cis_eks":return wn.a;case"cis_azure":return"logoAzure";case"cis_aws":return"logoAWS";case"cis_gcp":return _n.a;default:return"logoKubernetes"}},In=e=>Object(j.jsx)(C.EuiToolTip,{content:e.name},Object(j.jsx)(C.EuiIcon,{type:Rn(e),size:e.size||"xl",css:e.style}));var Nn={name:"10jr14j",styles:":hover{cursor:pointer;}"};const Dn=({copyText:e})=>Object(j.jsx)(C.EuiCopy,{textToCopy:e},(e=>Object(j.jsx)(C.EuiIcon,{css:Nn,onClick:e,type:"copy"}))),Pn="1rem",Vn=({testId:e,listItems:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s=(e=>null==e?void 0:e.filter((e=>!(null==e||!e.title||null==e||!e.description))).map((e=>({...e,title:`${e.title}:`,description:"string"==typeof e.description?Object(j.jsx)("span",null,e.description," ",Object(j.jsx)(Dn,{copyText:e.description})):e.description}))))(t);return Object(j.jsx)(C.EuiDescriptionList,{"data-test-subj":e,type:"inline",titleProps:{style:{background:"initial",color:a.colors.subduedText,fontSize:Pn,paddingRight:0,paddingInline:0}},descriptionProps:{style:{color:a.colors.subduedText,marginRight:a.size.xs,fontSize:Pn}},listItems:s})},Gn=[{id:"overview",title:_.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTabTitle",{defaultMessage:"Overview"})},{id:"rule",title:_.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTabTitle",{defaultMessage:"Rule"})},{id:"table",title:_.i18n.translate("xpack.csp.findings.findingsFlyout.tableTabTitle",{defaultMessage:"Table"})},{id:"json",title:_.i18n.translate("xpack.csp.findings.findingsFlyout.jsonTabTitle",{defaultMessage:"JSON"})}],An=_.i18n.translate("xpack.csp.findings.findingsFlyout.paginationLabel",{defaultMessage:"Finding navigation"}),Ln=e=>Object(j.jsx)(C.EuiCodeBlock,i()({isCopyable:!0,paddingSize:"s",overflowHeight:300},e)),zn=e=>Object(j.jsx)(C.EuiMarkdownFormat,i()({textSize:"s"},e)),Bn=({benchmarkId:e,benchmarkName:t})=>Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiToolTip,{content:"Center for Internet Security"},Object(j.jsx)(C.EuiIcon,{type:$i.a,size:"xl"}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(In,{type:e,name:t}))),Un=({tab:e,findings:t})=>{const{application:a}=Object(w.a)().services,s=a.getUrlForApp("security",{path:Object(o.generatePath)(O.b.rules.path,{benchmarkVersion:t.rule.benchmark.version.split("v")[1],benchmarkId:t.rule.benchmark.id,ruleId:t.rule.id})});switch(e.id){case"overview":return Object(j.jsx)(kn,{data:t,ruleFlyoutLink:s});case"rule":return Object(j.jsx)(Sn,{data:t,ruleFlyoutLink:s});case"table":return Object(j.jsx)(an,{data:t});case"json":return Object(j.jsx)(ln,{data:t});default:Object(qi.assertNever)(e)}},Hn=({onClose:e,findings:t,flyoutIndex:a,findingsCount:s,onPaginate:i})=>{const[l,r]=Object(n.useState)(Gn[0]);return Object(j.jsx)(C.EuiFlyout,{onClose:e,"data-test-subj":"findings_flyout"},Object(j.jsx)(C.EuiFlyoutHeader,null,Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(Ji,{type:t.result.evaluation})),Object(j.jsx)(C.EuiFlexItem,{grow:!0,style:{minWidth:0}},Object(j.jsx)(C.EuiTitle,{size:"m",className:"eui-textTruncate"},Object(j.jsx)(C.EuiTextColor,{color:"primary",title:t.rule.name},t.rule.name)))),Object(j.jsx)("div",{css:Object(j.css)("line-height:20px;margin-top:",Ae.euiThemeVars.euiSizeM,";","")},Object(j.jsx)(Vn,{testId:"misconfigs-findings-flyout-description-list",listItems:(o=t,[(null===(u=o.resource)||void 0===u?void 0:u.id)&&{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.flyoutDescriptionList.resourceId",{defaultMessage:"Resource ID"}),description:o.resource.id},(null===(c=o.resource)||void 0===c?void 0:c.name)&&{title:_.i18n.translate("xpack.csp.findings.findingsFlyout.flyoutDescriptionList.resourceName",{defaultMessage:"Resource Name"}),description:o.resource.name}].filter(At.i))})),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(C.EuiTabs,null,Gn.map((e=>Object(j.jsx)(C.EuiTab,{key:e.id,isSelected:l.id===e.id,onClick:()=>r(e),"data-test-subj":`findings_flyout_tab_${e.id}`},e.title))))),Object(j.jsx)(C.EuiFlyoutBody,{key:l.id},Object(j.jsx)(Un,{tab:l,findings:t})),Object(j.jsx)(C.EuiFlyoutFooter,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:i?"spaceBetween":"flexEnd"},i&&Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPagination,{"aria-label":An,pageCount:s,activePage:a,onPageClick:i,compressed:!0})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(Ci,{createRuleFn:async e=>await hn(e,t.rule)})))));var o,u,c},Wn={"result.evaluation":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resultColumnLabel",{defaultMessage:"Result"}),"resource.id":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnLabel",{defaultMessage:"Resource ID"}),"resource.name":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceNameColumnLabel",{defaultMessage:"Resource Name"}),"resource.sub_type":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceTypeColumnLabel",{defaultMessage:"Resource Type"}),"rule.benchmark.rule_number":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNumberColumnLabel",{defaultMessage:"Rule Number"}),"rule.name":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNameColumnLabel",{defaultMessage:"Rule Name"}),"rule.section":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleSectionColumnLabel",{defaultMessage:"CIS Section"}),"@timestamp":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.lastCheckedColumnLabel",{defaultMessage:"Last Checked"})},Qn=e=>(e=>{var t;return void 0!==(null==e||null===(t=e.result)||void 0===t?void 0:t.evaluation)})(e)&&e,Zn=({row:e,children:t})=>{const a=Qn(e.raw._source);return a?t({finding:a}):Object(j.jsx)(l.a.Fragment,null)},Jn=(e,t)=>Object(j.jsx)(Zn,{row:e},(({finding:e})=>Object(j.jsx)(Hn,{findings:e,onClose:t}))),qn=_.i18n.translate("xpack.csp.findings.latestFindings.tableRowTypeLabel",{defaultMessage:"Findings"}),Kn=e=>({"result.evaluation":({rowIndex:t})=>Object(j.jsx)(Zn,{row:e[t]},(({finding:e})=>Object(j.jsx)(Ji,{type:e.result.evaluation}))),"@timestamp":({rowIndex:t})=>Object(j.jsx)(Zn,{row:e[t]},(({finding:e})=>Object(j.jsx)(Qi,{timestamp:e["@timestamp"]})))}),$n=({groupSelectorComponent:e,height:t,showDistributionBar:a=!0,nonPersistedFilters:s})=>{const{cloudPostureDataTable:i,rows:o,error:u,isFetching:c,isLoading:d,fetchNextPage:b,passed:p,failed:g,total:m,canShowDistributionBar:x,onDistributionBarClick:f}=(({getDefaultQuery:e,nonPersistedFilters:t,showDistributionBar:a})=>{const{dataView:s}=Ot(),i=Tt({paginationLocalStorageKey:te.j,columnsLocalStorageKey:"cloudPosture:latestFindings:columns",defaultQuery:e,nonPersistedFilters:t}),{query:l,sort:o,queryError:u,setUrlQuery:c,filters:d,getRowsFromPages:b,pageSize:p}=i,{data:g,error:m,isFetching:j,fetchNextPage:x,isLoading:f}=(e=>{const{data:t,notifications:{toasts:a}}=Object(w.a)().services,{data:s}=ea();return Object(r.useInfiniteQuery)(["csp_findings",{params:e},s],(async({pageParam:a})=>{const{rawResponse:{hits:i,aggregations:n}}=await Object(Gt.lastValueFrom)(t.search.search({params:Ai(e,s,a)}));if(!n)throw new Error("expected aggregations to be an defined");if(!Array.isArray(n.count.buckets))throw new Error("expected buckets to be an array");return{page:i.hits.map((e=>Vi(e))),total:Ri.number.is(i.total)?i.total:0,count:Gi(n.count.buckets)}}),{enabled:e.enabled&&!!s,keepPreviousData:!0,onError:e=>zt(a,e),getNextPageParam:(t,a)=>{if(!(t.page.length<e.pageSize))return a.length*e.pageSize}})})({query:l,sort:o,enabled:!u,pageSize:p}),h=Object(n.useMemo)((()=>b(null==g?void 0:g.pages)),[null==g?void 0:g.pages,b]),O=m||u,v=(null==g?void 0:g.pages[0].count.passed)||0,y=(null==g?void 0:g.pages[0].count.failed)||0,T=(null==g?void 0:g.pages[0].total)||0;return{cloudPostureDataTable:i,rows:h,error:O,isFetching:j,isLoading:f,fetchNextPage:x,passed:v,failed:y,total:T,canShowDistributionBar:a&&T>0,onDistributionBarClick:e=>{c({filters:Yt({filters:d,dataView:s,field:"result.evaluation",value:e,negate:!1})})}}})({getDefaultQuery:qt,nonPersistedFilters:s,showDistributionBar:a});return Object(j.jsx)(C.EuiFlexItem,{"data-test-subj":"latest_findings_container"},u?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)(ma,{error:u})):Object(j.jsx)(l.a.Fragment,null,x&&Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)(da,{distributionOnClick:f,passed:p,failed:g}),Object(j.jsx)(C.EuiSpacer,{size:"m"})),Object(j.jsx)(_i,{"data-test-subj":"latest_findings_table",isLoading:c||d,defaultColumns:Kt,rows:o,total:m,flyoutComponent:Jn,cloudPostureDataTable:i,loadMore:b,title:qn,customCellRenderer:Kn,groupSelectorComponent:e,height:t,createRuleFn:e=>{const t=Qn(o[e].raw._source);if(t)return async e=>hn(e,t.rule)},columnHeaders:Wn})))};var Yn={name:"1d3w5wq",styles:"width:100%"};const Xn=({totalPassed:e,totalFailed:t,size:a="m",overrideCss:s})=>{const{euiTheme:i}=Object(C.useEuiTheme)(),n=Object(At.c)(e,t),l=Yn;return Object(j.jsx)(C.EuiToolTip,{anchorProps:{css:s||l},content:_.i18n.translate("xpack.csp.complianceScoreBar.tooltipTitle",{defaultMessage:"{failed} failed and {passed} passed findings",values:{passed:e,failed:t}})},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexEnd"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none",css:Object(j.css)("height:","m"===a?i.size.xs:"6px",";border-radius:",i.border.radius.medium,";overflow:hidden;gap:1px;","")},!!e&&Object(j.jsx)(C.EuiFlexItem,{css:Object(j.css)("flex:",e,";background:",te.w.passed,";","")}),!!t&&Object(j.jsx)(C.EuiFlexItem,{css:Object(j.css)("flex:",t,";background:",te.w.failed,";","")}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1,css:Object(j.css)("width:",i.size.xxl,";text-align:right;","")},Object(j.jsx)(C.EuiText,{size:"xs","data-test-subj":A.o,css:Object(j.css)("font-weight:",i.font.weight.bold,";","")},`${n.toFixed(0)}%`))))};var el={name:"1m5hyg0",styles:"word-break:break-all"},tl={name:"1u4hpl4",styles:"display:inline"};const al=(e,t,a,s)=>{var i,n,l,r,o,u,c,d,b,p,g,m,x,f,h,O,v,y,T,k,E,S,F,w,M;if(s)return Object(j.jsx)(It,null);const _=Mt(null===(i=t.benchmarkId)||void 0===i||null===(n=i.buckets)||void 0===n||null===(l=n[0])||void 0===l?void 0:l.key),R=t=>Object(j.jsx)(Rt,{title:t,field:e,unit:Wt});switch(e){case te.g.RESOURCE_NAME:return a?R(Qt.RESOURCE_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{css:tl},Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)(C.EuiTextBlockTruncate,{lines:2,css:el,title:null===(r=t.resourceName)||void 0===r||null===(o=r.buckets)||void 0===o?void 0:o[0].key},Object(j.jsx)("strong",null,t.key_as_string)," ",null===(u=t.resourceName)||void 0===u||null===(c=u.buckets)||void 0===c?void 0:c[0].key))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},null===(d=t.resourceSubType)||void 0===d||null===(b=d.buckets)||void 0===b?void 0:b[0].key)))));case te.g.RULE_NAME:return a?R(Qt.RULE_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},Mt(null===(p=t.benchmarkName)||void 0===p||null===(g=p.buckets)||void 0===g?void 0:g[0].key)," ",Mt(null===(m=t.benchmarkVersion)||void 0===m||null===(x=m.buckets)||void 0===x?void 0:x[0].key))))));case te.g.CLOUD_ACCOUNT_NAME:return a?R(Qt.CLOUD_ACCOUNT_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},_&&Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)(In,{type:_,name:Mt(null===(f=t.benchmarkName)||void 0===f||null===(h=f.buckets)||void 0===h||null===(O=h[0])||void 0===O?void 0:O.key)})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},null===(v=t.benchmarkName)||void 0===v||null===(y=v.buckets)||void 0===y||null===(T=y[0])||void 0===T?void 0:T.key)))));case te.g.ORCHESTRATOR_CLUSTER_NAME:return a?R(Qt.ORCHESTRATOR_CLUSTER_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},_&&Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)(In,{type:_,name:Mt(null===(k=t.benchmarkName)||void 0===k||null===(E=k.buckets)||void 0===E||null===(S=E[0])||void 0===S?void 0:S.key)})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},null===(F=t.benchmarkName)||void 0===F||null===(w=F.buckets)||void 0===w||null===(M=w[0])||void 0===M?void 0:M.key)))));default:return a?R(Qt.DEFAULT):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))))))}},sl=({bucket:e})=>{const{euiTheme:t}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiToolTip,{content:e.doc_count},Object(j.jsx)(C.EuiBadge,{css:Object(j.css)("margin-left:",t.size.s,";",""),color:"hollow","data-test-subj":"findings_grouping_counter"},oa(e.doc_count)))},il=l.a.memo(sl),nl=({bucket:e})=>{var t;const{euiTheme:a}=Object(C.useEuiTheme)(),s=(null===(t=e.failedFindings)||void 0===t?void 0:t.doc_count)||0,i=e.doc_count-s;return Object(j.jsx)(Xn,{size:"l",overrideCss:Object(j.css)("width:104px;margin-left:",a.size.s,";",""),totalFailed:s,totalPassed:i})},ll=l.a.memo(nl),rl=(e,t)=>[{title:_.i18n.translate("xpack.csp.findings.grouping.stats.badges.findings",{defaultMessage:"Findings"}),renderer:Object(j.jsx)(il,{bucket:t})},{title:_.i18n.translate("xpack.csp.findings.grouping.stats.badges.compliance",{defaultMessage:"Compliance"}),renderer:Object(j.jsx)(ll,{bucket:t})}],ol=({renderChildComponent:e,groupingLevel:t,parentGroupFilters:a,selectedGroup:s,groupSelectorComponent:i})=>{const{groupData:l,grouping:r,isFetching:o,activePageIndex:u,pageSize:c,onChangeGroupsItemsPerPage:d,onChangeGroupsPage:b,isGroupLoading:p,setActivePageIndex:g}=na({groupPanelRenderer:al,groupStatsRenderer:rl,groupingLevel:t,selectedGroup:s,groupFilters:a?JSON.parse(a):[]});return Object(n.useEffect)((()=>{g(0)}),[s]),Object(j.jsx)(wt,{data:l,grouping:r,renderChildComponent:e,onChangeGroupsItemsPerPage:d,onChangeGroupsPage:b,activePageIndex:u,isFetching:o,pageSize:c,selectedGroup:s,isGroupLoading:p,groupingLevel:t,groupSelectorComponent:i})},ul=()=>{const{grouping:e,isFetching:t,urlQuery:a,setUrlQuery:s,onResetFilters:i,error:n,isEmptyResults:r}=na({groupPanelRenderer:al,groupStatsRenderer:rl}),o=({level:e,currentSelectedGroup:t,selectedGroupOptions:a,parentGroupFilters:s,groupSelectorComponent:i})=>{let n;return"none"===t?Object(j.jsx)($n,{groupSelectorComponent:i,nonPersistedFilters:[...s?JSON.parse(s):[]],showDistributionBar:a.includes("none")}):(n=e<a.length-1&&!a.includes("none")?t=>{const n=e+1;return o({level:n,currentSelectedGroup:a[n],selectedGroupOptions:a,parentGroupFilters:JSON.stringify([...t,...s?JSON.parse(s):[]]),groupSelectorComponent:i})}:e=>Object(j.jsx)($n,{nonPersistedFilters:[...e,...s?JSON.parse(s):[]],height:te.b,showDistributionBar:a.includes("none")}),Object(j.jsx)(ol,{renderChildComponent:n,selectedGroup:a[e],groupingLevel:e,parentGroupFilters:s,groupSelectorComponent:i}))};return n||r?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Nt,{query:a,setQuery:s,loading:t}),Object(j.jsx)(C.EuiSpacer,{size:"m"}),n&&Object(j.jsx)(ma,{error:n}),r&&Object(j.jsx)(ge,{onResetFilters:i})):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Nt,{query:a,setQuery:s,loading:t}),Object(j.jsx)("div",null,o({level:0,currentSelectedGroup:e.selectedGroups[0],selectedGroupOptions:e.selectedGroups,groupSelectorComponent:e.groupSelector})))},cl=()=>{const e=Object(o.useLocation)(),t=ce(F.L),{data:a,isLoading:s}=M(),i="indexed"===(null==a?void 0:a.kspm.status)||"indexed"===(null==a?void 0:a.cspm.status),n="not-installed"!==(null==a?void 0:a.cspm.status)?"cspm":"kspm";if(s)return J();if(!i)return Object(j.jsx)(ue,{postureType:n});const l={dataView:t.data,dataViewRefetch:t.refetch,dataViewIsRefetching:t.isRefetching};return Object(j.jsx)($,{query:t},Object(j.jsx)(h,null,Object(j.jsx)(x,{exact:!0,path:O.c.findings.path,render:()=>Object(j.jsx)(o.Redirect,{to:{pathname:O.e.findings_default.path,search:e.search}})}),Object(j.jsx)(x,{path:O.e.findings_default.path,render:()=>Object(j.jsx)(S.TrackApplicationView,{viewId:O.e.findings_default.id},Object(j.jsx)(ht.Provider,{value:l},Object(j.jsx)(ul,null)))}),Object(j.jsx)(x,{path:"*",render:()=>Object(j.jsx)(o.Redirect,{to:O.e.findings_default.path})})))},dl=()=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.v.SCANNING_VULNERABILITIES,color:"plain",icon:Object(j.jsx)(C.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.scanningVulnerabilitiesEmptyPrompt.indexingButtonTitle",defaultMessage:"Scanning your environment"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.scanningVulnerabilitiesEmptyPrompt.indexingDescription",defaultMessage:"Results will appear here as soon as they are available."}))}),bl=({vulnMgmtIntegrationLink:e})=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.v.NOT_INSTALLED,icon:Object(j.jsx)(C.EuiImage,{size:"fullWidth",src:X.a,alt:"",role:"presentation"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.promptTitle",defaultMessage:"Detect vulnerabilities in your {lineBreak} cloud assets",ignoreTag:!0,values:{lineBreak:Object(j.jsx)("br",null)}})),layout:"horizontal",color:"plain",body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.promptDescription",defaultMessage:"Add the Cloud Native Vulnerability Management integration to begin"})),actions:Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButton,{color:"primary",fill:!0,href:e,"data-test-subj":A.h},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.addVulMngtIntegrationButtonTitle",defaultMessage:"Install Cloud Native Vulnerability Management"}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButtonEmpty,{color:"primary",href:"https://ela.st/cnvm",target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.learnMoreButtonTitle",defaultMessage:"Learn more"}))))}),pl=()=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.v.INDEX_TIMEOUT,color:"plain",icon:Object(j.jsx)(C.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutTitle",defaultMessage:"Findings Delayed"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutDescription",defaultMessage:"Scanning workloads is taking longer than expected. Please check {docs}",values:{docs:Object(j.jsx)(C.EuiLink,{href:"https://ela.st/cnvm-faq",target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutDocLink",defaultMessage:"CNVM FAQ"}))}}))});var gl={name:"1b7vz4z",styles:"text-align:initial"};const ml=({unprivilegedIndices:e})=>Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.v.UNPRIVILEGED,color:"plain",icon:Object(j.jsx)(C.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedTitle",defaultMessage:"Privileges required"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedDescription",defaultMessage:"To view cloud posture data, you must update privileges. For more information, contact your Kibana administrator."})),footer:Object(j.jsx)(C.EuiMarkdownFormat,{css:gl,children:_.i18n.translate("xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedFooterMarkdown",{defaultMessage:"Required Elasticsearch index privilege `read` for the following indices:"})+e.map((e=>`\n- \`${e}\``))})}),jl=({postureType:e})=>{const t=G({postureType:e});return Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.v.NOT_DEPLOYED,color:"plain",iconType:"fleetApp",title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedTitle",defaultMessage:"No Agents Installed"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedDescription",defaultMessage:"In order to begin detecting vulnerabilities, you'll need to deploy elastic-agent into the cloud account or Kubernetes cluster you want to monitor."})),actions:[Object(j.jsx)(C.EuiButton,{fill:!0,href:t,isDisabled:!t},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedButtonTitle",defaultMessage:"Install Agent"}))]})},xl=()=>{var e,t,a;const s=M({refetchInterval:2e4}),i=ee(F.eb),n=null===(e=s.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status,l=null===(a=s.data)||void 0===a?void 0:a.indicesDetails,r=l&&l.filter((e=>"unprivileged"===e.status)).map((e=>e.index)).sort(((e,t)=>e.localeCompare(t)));return Object(j.jsx)($,{query:s},Object(j.jsx)(R.a,null,"indexing"===n||"waiting_for_results"===n?Object(j.jsx)(dl,null):"index-timeout"===n?Object(j.jsx)(pl,null):"not-installed"===n?Object(j.jsx)(bl,{vulnMgmtIntegrationLink:i}):"not-deployed"===n?Object(j.jsx)(jl,{postureType:F.eb}):"unprivileged"===n?Object(j.jsx)(ml,{unprivilegedIndices:r||[]}):void 0))},fl=e=>({...e,index:F.N,size:0}),hl=(_.i18n.translate("xpack.csp.vulnerabilities.table.filterIn",{defaultMessage:"Filter in"}),_.i18n.translate("xpack.csp.vulnerabilities.table.filterOut",{defaultMessage:"Filter out"}),_.i18n.translate("xpack.csp.vulnerabilities.searchBar.placeholder",{defaultMessage:'Search vulnerabilities (eg. vulnerability.severity : "CRITICAL" )'}),_.i18n.translate("xpack.csp.vulnerabilities",{defaultMessage:"Vulnerabilities"})),Ol=e=>_.i18n.translate("xpack.csp.vulnerabilities.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {vulnerability} other {vulnerabilities}}"}),vl=(e,t,a)=>{const s=a?e-1:e;switch(t){case te.u.RESOURCE_NAME:return _.i18n.translate("xpack.csp.vulnerabilities.groupUnit.resource",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {resource} other {resources}}"});case te.u.CLOUD_ACCOUNT_NAME:return _.i18n.translate("xpack.csp.vulnerabilities.groupUnit.cloudAccount",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {cloud account} other {cloud accounts}}"});case te.u.CVE:return _.i18n.translate("xpack.csp.vulnerabilities.groupUnit.cve",{values:{groupCount:s},defaultMessage:"{groupCount} {groupCount, plural, =1 {CVE} other {CVEs}}"});default:return _.i18n.translate("xpack.csp.vulnerabilities.groupUnit",{values:{groupCount:e},defaultMessage:"{groupCount} {groupCount, plural, =1 {group} other {groups}}"})}},yl=_.i18n.translate("xpack.csp.vulnerabilities.grouping.nullGroupUnit",{defaultMessage:"vulnerabilities"}),Tl={RESOURCE_NAME:_.i18n.translate("xpack.csp.vulnerabilities.grouping.resource.nullGroupTitle",{defaultMessage:"No resource"}),CLOUD_ACCOUNT_NAME:_.i18n.translate("xpack.csp.vulnerabilities.grouping.cloudAccount.nullGroupTitle",{defaultMessage:"No cloud account"}),DEFAULT:_.i18n.translate("xpack.csp.vulnerabilities.grouping.default.nullGroupTitle",{defaultMessage:"No grouping"})},kl={RESOURCE_NAME:_.i18n.translate("xpack.csp.vulnerabilities.groupBy.resource",{defaultMessage:"Resource"}),CLOUD_ACCOUNT_NAME:_.i18n.translate("xpack.csp.vulnerabilities.groupBy.cloudAccount",{defaultMessage:"Cloud account"})},Cl=_.i18n.translate("xpack.csp.vulnerabilities.groupBy",{defaultMessage:"Group vulnerabilities by"}),El=[{label:kl.RESOURCE_NAME,key:te.u.RESOURCE_NAME},{label:kl.CLOUD_ACCOUNT_NAME,key:te.u.CLOUD_ACCOUNT_NAME},{label:"CVE",key:te.u.CVE}],Sl=({query:e,filters:t})=>({query:e,filters:t,sort:[[te.t.SEVERITY,"asc"],[te.t.SCORE_BASE,"desc"]]}),Fl=[{id:te.t.VULNERABILITY_ID,width:130},{id:te.t.SCORE_BASE,width:80},{id:te.t.RESOURCE_NAME},{id:te.t.RESOURCE_ID},{id:te.t.SEVERITY,width:100},{id:te.t.PACKAGE_NAME},{id:te.t.PACKAGE_VERSION},{id:te.t.PACKAGE_FIXED_VERSION}],wl=(e,t)=>({[e]:{terms:{field:t,size:1}}}),Ml=e=>{if(_e([e]))return[];const t=[{groupByField:{cardinality:{field:e}},critical:{filter:{term:{"vulnerability.severity":{value:F.db.CRITICAL}}}},high:{filter:{term:{"vulnerability.severity":{value:F.db.HIGH}}}},medium:{filter:{term:{"vulnerability.severity":{value:F.db.MEDIUM}}}},low:{filter:{term:{"vulnerability.severity":{value:F.db.LOW}}}}}];switch(e){case te.u.RESOURCE_NAME:return[...t,wl("resourceId",te.t.RESOURCE_ID)];case te.u.CLOUD_ACCOUNT_NAME:return[...t,wl("cloudProvider",te.t.CLOUD_PROVIDER)];case te.u.CVE:return[...t,wl("description",te.t.DESCRIPTION)]}return t},_l=({groupPanelRenderer:e,groupStatsRenderer:t,groupingLevel:a=0,groupFilters:s=[],selectedGroup:i})=>{var l;const{dataView:o}=Ot(),{activePageIndex:u,grouping:c,pageSize:d,query:b,onChangeGroupsItemsPerPage:p,onChangeGroupsPage:g,urlQuery:m,setUrlQuery:j,uniqueValue:x,isNoneSelected:f,onResetFilters:h,error:O,filters:v,setActivePageIndex:y}=kt({dataView:o,groupingTitle:Cl,defaultGroupingOptions:El,getDefaultQuery:Sl,unit:Ol,groupPanelRenderer:e,groupStatsRenderer:t,groupingLocalStorageKey:te.o,groupingLevel:a,groupsUnit:vl}),T=Object(qe.buildEsQuery)(o,[],s),k=i||c.selectedGroups[0],C=Pt({additionalFilters:b?[b,T]:[T],groupByField:k,uniqueValue:x,from:`now-${F.O}`,to:"now",pageNumber:u*d,size:d,sort:[{groupByField:{order:"desc"}}],statsAggregations:Ml(k)}),{data:E,isFetching:S}=(({query:e,enabled:t=!0})=>{const{data:a,notifications:{toasts:s}}=Object(w.a)().services;return Object(r.useQuery)(["csp_grouped_vulnerabilities",{query:e}],(async()=>{const{rawResponse:{aggregations:t}}=await Object(Gt.lastValueFrom)(a.search.search({params:fl(e)}));if(!t)throw new Error("Failed to aggregate by, missing resource id");return t}),{onError:e=>zt(s,e),enabled:t,keepPreviousData:!0})})({query:C,enabled:!f}),M=Object(n.useMemo)((()=>Vt(k,x,E)),[E,k,x]),_=!S&&(e=>{var t;return void 0!==(null==e||null===(t=e.unitsCount)||void 0===t?void 0:t.value)})(M)&&0===(null===(l=M.unitsCount)||void 0===l?void 0:l.value);return{groupData:M,grouping:c,isFetching:S,activePageIndex:u,setActivePageIndex:y,pageSize:d,selectedGroup:i,onChangeGroupsItemsPerPage:p,onChangeGroupsPage:g,urlQuery:m,setUrlQuery:j,isGroupSelected:!f,isGroupLoading:!E,onResetFilters:h,filters:v,error:O,isEmptyResults:_}},Rl=(_.i18n.translate("xpack.csp.vulnerabilityTable.column.sortAscending",{defaultMessage:"Low -> Critical"}),_.i18n.translate("xpack.csp.vulnerabilityTable.column.sortDescending",{defaultMessage:"Critical -> Low"}),e=>e.map((([e,t])=>e===te.t.PACKAGE_NAME?((e,t)=>({_script:{type:"string",order:t,script:{source:`doc["${e}"].value.toLowerCase()`,lang:"painless"}}}))(e,t):{[e]:t}))),Il=({query:e,sort:t},a)=>{var s,i;return{index:F.N,sort:Rl(t),size:te.p,query:{...e,bool:{...null==e?void 0:e.bool,filter:[...null!==(s=null==e||null===(i=e.bool)||void 0===i?void 0:i.filter)&&void 0!==s?s:[],{range:{"@timestamp":{gte:`now-${F.O}`,lte:"now"}}}]}},...a?{from:a}:{}}},Nl=e=>{switch(e){case F.db.LOW:return Ae.euiThemeVars.euiColorVis0;case F.db.MEDIUM:return Ae.euiThemeVars.euiColorVis5_behindText;case F.db.HIGH:return Ae.euiThemeVars.euiColorVis9_behindText;case F.db.CRITICAL:return Ae.euiThemeVars.euiColorDanger;default:return"#aaa"}};var Dl={name:"1tv0ws",styles:"width:1px;border:0 none;background-color:rgba(255, 255, 255, 0.2);margin:0px 6px"},Pl={name:"1xszn7y",styles:"border:none;.euiBadge__text{display:flex;}width:62px"};const Vl=({score:e,version:t})=>{if(!e)return null;const a=(e=>e<=4?Ae.euiThemeVars.euiColorVis0:e>=4&&e<=7?Ae.euiThemeVars.euiColorVis7:e>=7&&e<=9?Ae.euiThemeVars.euiColorVis9:e>=9?Ae.euiThemeVars.euiColorDanger:void 0)(e),s=t?`v${t.split(".")[0]}`:null;return Object(j.jsx)(C.EuiBadge,{color:a,css:Pl,"data-test-subj":A.z},s&&Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiTextColor,{color:"ghost"},e<10?e.toFixed(1):e),Object(j.jsx)("hr",{css:Dl}),Object(j.jsx)(C.EuiTextColor,{color:"ghost"},s)))};var Gl={name:"fhxb3m",styles:"display:flex;flex-direction:row;align-items:center"};const Al=({severity:e})=>{if(!e)return null;const t=Nl(e);return Object(j.jsx)("div",{css:Gl},Object(j.jsx)(C.EuiIcon,{type:"dot",color:t,css:Object(j.css)("opacity:",e?1:0,";","")}),e)};var Ll=a(167),zl=a.n(Ll);const Bl="vulnerability.severity",Ul={field_names:["resource.name","resource.id"]};var Hl=function(e){return e.Low="low",e.Medium="medium",e.High="high",e.Critical="critical",e}(Hl||{}),Wl=function(e){return e.DoNotSuppress="doNotSuppress",e.Suppress="suppress",e}(Wl||{});const Ql=["Cloud Security","CNVM","Data Source: Cloud Native Vulnerability Management","Use Case: Vulnerability","OS: Linux"],Zl=e=>[...Ql,e.id],Jl=e=>_.i18n.translate("xpack.csp.vulnerabilities.detectionRuleNamePrefix",{defaultMessage:"Vulnerability: {vulnerabilityId}",values:{vulnerabilityId:e.id}}),ql=e=>{const t=(new Date).toISOString();return`vulnerability.id: "${e.id}" AND event.ingested >= "${t}"`},Kl=async(e,t)=>await gn({http:e,rule:{type:"query",language:"kuery",license:"Elastic License v2",author:["Elastic"],filters:[],false_positives:[],risk_score:0,risk_score_mapping:[],severity:"low",severity_mapping:[{field:Bl,value:F.db.LOW,operator:"equals",severity:Hl.Low},{field:Bl,value:F.db.MEDIUM,operator:"equals",severity:Hl.Medium},{field:Bl,value:F.db.HIGH,operator:"equals",severity:Hl.High},{field:Bl,value:F.db.CRITICAL,operator:"equals",severity:Hl.Critical},{field:Bl,value:F.db.UNKNOWN,operator:"equals",severity:Hl.Low}],threat:[],interval:"1h",from:`now-${F.O}`,to:"now",max_signals:100,timestamp_override:"event.ingested",timestamp_override_fallback_disabled:!1,actions:[],enabled:!0,alert_suppression:{group_by:["resource.id"],missing_fields_strategy:Wl.Suppress},index:[F.cb],query:ql(t),references:t.reference?[t.reference]:[],name:Jl(t),description:t.description,tags:Zl(t),investigation_fields:Ul}}),$l=({vulnerability:e})=>Object(j.jsx)(pn,{tags:["CNVM",e.id],createRuleFn:async t=>await Kl(t,e)}),Yl={nvd:"NVD",redhat:"Red Hat",ghsa:"GHSA"},Xl={redhat:zl.a,ghsa:"logoGithub"};var er={name:"1qx4gu9",styles:"margin-right:30px"},tr={name:"10vbjov",styles:"width:116px;font-weight:600;display:flex;flex-direction:row;align-items:center"};const ar=({vectorBaseScore:e,vendor:t})=>{const a=Yl[t],s=(e=>{const t=[],a=null==e?void 0:e.V2Vector,s=null==e?void 0:e.V2Score,i=null==e?void 0:e.V3Vector,n=null==e?void 0:e.V3Score;return a&&t.push({version:"2.0",vector:a,score:s}),i&&t.push({version:"3.0",vector:i,score:n}),t})(e);return Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",css:Object(j.css)("border:1px solid #d3dae6;border-radius:6px;padding:",Ae.euiThemeVars.euiSizeM,";","")},Object(j.jsx)(C.EuiFlexItem,{grow:!1,css:tr},Object(j.jsx)("span",{css:er},"nvd"===t?Object(j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"42px",height:"10px",viewBox:"0 0 41 11",version:"1.1"},Object(j.jsx)("path",{fill:Ae.euiThemeVars.euiColorFullShade,d:"M 2.558594 8.402344 C 2.5625 6.628906 2.5625 4.855469 2.5625 3.078125 C 2.5625 3.074219 2.5625 3.074219 2.5625 3.070312 C 2.558594 2.910156 2.558594 2.746094 2.722656 2.671875 C 2.863281 2.609375 2.945312 2.710938 3.019531 2.804688 C 3.035156 2.828125 3.050781 2.847656 3.070312 2.867188 C 5.023438 4.996094 7.027344 7.105469 8.835938 9.367188 C 9.546875 10.257812 10.371094 10.777344 11.554688 10.742188 C 12.894531 10.703125 14.144531 9.625 14.171875 8.09375 C 14.207031 6.375 14.199219 4.652344 14.195312 2.929688 C 14.191406 2.058594 14.1875 1.1875 14.191406 0.316406 C 14.191406 0.0820312 14.109375 0.0078125 13.890625 0.0117188 C 13.265625 0.0195312 12.644531 0.03125 12.023438 0.0078125 C 11.710938 -0.00390625 11.628906 0.0976562 11.628906 0.414062 C 11.636719 2.199219 11.636719 3.984375 11.636719 5.765625 C 11.636719 6.402344 11.683594 7.054688 11.632812 7.691406 C 11.617188 7.867188 11.546875 8.027344 11.375 8.082031 C 11.25 8.117188 11.183594 8.023438 11.117188 7.9375 C 10.800781 7.507812 10.40625 7.125 10.054688 6.722656 C 8.910156 5.425781 7.757812 4.140625 6.597656 2.855469 C 6 2.195312 5.402344 1.53125 4.832031 0.847656 C 4.050781 -0.0898438 2.3125 -0.242188 1.367188 0.347656 C 0.621094 0.8125 0.046875 1.460938 0.0273438 2.359375 C -0.0078125 4.183594 0 6.011719 0.00390625 7.835938 C 0.00390625 8.695312 0.0078125 9.558594 0.0078125 10.421875 C 0.00390625 10.652344 0.0859375 10.730469 0.308594 10.726562 C 0.949219 10.71875 1.59375 10.714844 2.234375 10.730469 C 2.492188 10.734375 2.570312 10.644531 2.566406 10.386719 C 2.554688 9.730469 2.558594 9.074219 2.558594 8.402344 Z M 2.558594 8.402344 "}),Object(j.jsx)("path",{fill:Ae.euiThemeVars.euiColorFullShade,d:"M 22.050781 10.714844 C 22.941406 10.605469 23.636719 10.164062 24.042969 9.285156 C 25.1875 7.234375 26.230469 5.117188 27.308594 3.027344 C 27.472656 2.707031 27.691406 2.558594 28.058594 2.5625 C 30.578125 2.574219 33.097656 2.558594 35.617188 2.574219 C 36.417969 2.578125 37.136719 2.894531 37.6875 3.488281 C 38.433594 4.296875 38.667969 5.28125 38.277344 6.324219 C 37.851562 7.460938 36.976562 8.109375 35.800781 8.152344 C 34.171875 8.214844 32.539062 8.171875 30.90625 8.167969 C 30.464844 8.167969 30.34375 8.03125 30.339844 7.585938 C 30.339844 6.332031 30.335938 5.074219 30.347656 3.820312 C 30.347656 3.554688 30.28125 3.449219 30.003906 3.457031 C 29.382812 3.476562 28.757812 3.480469 28.136719 3.457031 C 27.84375 3.449219 27.785156 3.566406 27.785156 3.839844 C 27.792969 6.003906 27.796875 8.167969 27.78125 10.332031 C 27.777344 10.660156 27.886719 10.730469 28.183594 10.730469 C 30.210938 10.722656 32.238281 10.722656 34.265625 10.722656 C 34.972656 10.722656 35.738281 10.824219 36.445312 10.71875 C 37.734375 10.519531 38.828125 9.960938 39.699219 8.945312 C 40.890625 7.5625 41.203125 5.957031 40.878906 4.195312 C 40.667969 3.046875 40.101562 2.089844 39.242188 1.3125 C 38.371094 0.527344 37.359375 0.0390625 36.207031 0.0273438 C 33.074219 -0.0117188 29.945312 0.015625 26.8125 0.0117188 C 26.296875 0.0117188 25.921875 0.261719 25.671875 0.714844 C 24.382812 3.046875 23.355469 5.570312 21.941406 7.828125 C 21.765625 8.105469 21.605469 8.109375 21.433594 7.84375 C 19.898438 5.476562 18.742188 2.777344 17.414062 0.289062 C 17.3125 0.101562 17.183594 0.00390625 16.953125 0.0078125 C 16.480469 0.0195312 16.007812 0.0195312 15.535156 0.015625 C 15.265625 0.015625 14.988281 0.0351562 14.714844 0.0117188 C 14.640625 0.0078125 14.5625 0 14.5 0.0664062 C 14.484375 0.148438 14.519531 0.210938 14.554688 0.273438 C 14.839844 0.785156 15.097656 1.3125 15.371094 1.832031 C 16.171875 3.367188 16.96875 4.90625 17.757812 6.445312 C 18.234375 7.367188 18.707031 8.285156 19.179688 9.203125 C 19.359375 9.542969 19.582031 9.847656 19.882812 10.101562 C 20.519531 10.644531 21.257812 10.8125 22.050781 10.714844 Z M 22.050781 10.714844 "})):Object(j.jsx)(C.EuiIcon,{type:Xl[t],size:"xl"})),Object(j.jsx)("span",null,a)),Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.length>0&&s.map(((e,t)=>Object(j.jsx)(sr,{key:`${e}-${t}`,vectorScore:e})))))},sr=({vectorScore:e})=>{const{score:t,vector:a,version:s}=e;return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",css:Object(j.css)("background:",Ae.euiThemeVars.euiColorLightestShade,";padding:",Ae.euiThemeVars.euiSizeXS," ",Ae.euiThemeVars.euiSizeS,";border-radius:6px;","")},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{css:Object(j.css)("font-size:",Ae.euiThemeVars.euiFontSizeM,";color:",Ae.euiThemeVars.euiColorFullShade,";","")},a," ")),Object(j.jsx)(C.EuiFlexItem,{grow:!1},t&&Object(j.jsx)(Vl,{score:t,version:s}))))};var ir={name:"tnote4",styles:"line-height:20px;margin-bottom:6px"};const nr=({vulnerabilityRecord:e})=>{var t,a,s,i;const{vulnerability:n}=e,l=Object(j.css)("padding:",Ae.euiThemeVars.euiFontSizeM,";background:",Ae.euiThemeVars.euiColorLightestShade,";border-radius:6px;height:74px;",""),r=ir,o=Hi()(null==n?void 0:n.published_date).format("LL").toString();return Object(j.jsx)(C.EuiFlexGroup,{"data-test-subj":"vulnerability_overview_tab_flyout"},(null==n||null===(t=n.score)||void 0===t?void 0:t.version)&&(null==n||null===(a=n.score)||void 0===a?void 0:a.base)&&Object(j.jsx)(C.EuiFlexItem,{css:l},Object(j.jsx)(C.EuiText,{css:r},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.cvsScore",defaultMessage:"CVSS"})),Object(j.jsx)("div",null,Object(j.jsx)(Vl,{version:n.score.version,score:n.score.base}))),Object(j.jsx)(C.EuiFlexItem,{css:l},Object(j.jsx)(C.EuiText,{css:r},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.dataSource",defaultMessage:"Data Source"})),Object(j.jsx)(C.EuiLink,{href:null==n||null===(s=n.data_source)||void 0===s?void 0:s.URL,target:"_blank"},null==n||null===(i=n.data_source)||void 0===i?void 0:i.ID)),Object(j.jsx)(C.EuiFlexItem,{css:l},Object(j.jsx)(C.EuiText,{css:r},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.publishedDate",defaultMessage:"Published Date"})),Object(j.jsx)("strong",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.publishedDateText",defaultMessage:"{date}",values:{date:o}}))))};var lr={name:"xctmr2",styles:"margin-block:12px"};const rr=({vulnerabilityRecord:e})=>{var t,a,s;const{vulnerability:i}=e,n=_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilityOverviewTab.emptyFixesMessage",{defaultMessage:"No available fixes yet."}),l=null!=e&&null!==(t=e.package)&&void 0!==t&&t.fixed_version?`${null==e||null===(a=e.package)||void 0===a?void 0:a.name} ${null==e||null===(s=e.package)||void 0===s?void 0:s.fixed_version}`:n,r=null!=i&&i.cvss?Object.entries(i.cvss).map((([e,t])=>{if(Yl[e])return Object(j.jsx)(C.EuiFlexItem,{key:`${e}`},Object(j.jsx)(ar,{vectorBaseScore:t,vendor:e}))})):[],o=lr,u=Object(j.css)("font-size:",Ae.euiThemeVars.euiFontSizeM,";line-height:24px;margin-bottom:",Ae.euiThemeVars.euiSizeS,";font-weight:600;","");return Object(j.jsx)(C.EuiFlexGroup,{direction:"column"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(nr,{vulnerabilityRecord:e})),Object(j.jsx)(C.EuiHorizontalRule,{css:o}),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("h4",{css:u},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.alertsTitle",defaultMessage:"Alerts"})),Object(j.jsx)($l,{vulnerability:i})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("h4",{css:u},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.descriptionTitle",defaultMessage:"Description"})),Object(j.jsx)(zn,null,(null==i?void 0:i.description)||"")),Object(j.jsx)(C.EuiHorizontalRule,{css:o}),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("h4",{css:u},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.fixes",defaultMessage:"Fixes"})),Object(j.jsx)(C.EuiText,null,l)),Object(j.jsx)(C.EuiHorizontalRule,{css:o}),(null==r?void 0:r.length)>0&&Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("h4",{css:u},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.vulnerabilityScores",defaultMessage:"Vulnerability Scores"})),Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"l",css:Object(j.css)("margin-top:",Ae.euiThemeVars.euiSizeS,";","")},r)))},or=({vulnerabilityRecord:e})=>Object(j.jsx)("div",{style:{position:"absolute",inset:0,top:188,bottom:60},"data-test-subj":"vulnerability_json_tab_flyout"},Object(j.jsx)(sn.CodeEditor,{isCopyable:!0,allowFullScreen:!0,languageId:nn.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"on",folding:!0}})),ur={box:{incremental:!0}},cr={sort:{field:"key",direction:"asc"}},dr={initialPageSize:100,showPerPageOptions:!1},br=[{field:"key",name:_.i18n.translate("xpack.csp.vulnerabilities.flyoutTabs.fieldLabel",{defaultMessage:"Field"}),width:"25%"},{field:"value",name:_.i18n.translate("xpack.csp.vulnerabilities.flyoutTabs.fieldValueLabel",{defaultMessage:"Value"}),render:e=>Object(j.jsx)("div",{style:{width:"100%"}},(e=>void 0===e?"undefined":"boolean"==typeof e||null===e?Object(j.jsx)(C.EuiCode,null,JSON.stringify(e)):"object"==typeof e?Object(j.jsx)(C.EuiCodeBlock,{isCopyable:!0,overflowHeight:300},JSON.stringify(e,null,2)):Object(j.jsx)(C.EuiText,{size:"s"},e))(e))}],pr=e=>Object.entries(Object(qi.getFlattenedObject)(e)).map((([e,t])=>({key:e,value:t}))),gr=({vulnerabilityRecord:e})=>Object(j.jsx)(C.EuiInMemoryTable,{items:pr(e),columns:br,sorting:cr,search:ur,pagination:dr}),mr="vuln-flyout-overview-tab",jr=e=>{var t,a;return[(null===(t=e.resource)||void 0===t?void 0:t.id)&&{title:_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.resourceId",{defaultMessage:"Resource ID"}),description:e.resource.id},(null===(a=e.resource)||void 0===a?void 0:a.name)&&{title:_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.resourceName",{defaultMessage:"Resource Name"}),description:e.resource.name},{title:_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.packageTitle",{defaultMessage:"Package"}),description:e.package.name},{title:_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.versionTitle",{defaultMessage:"Version"}),description:e.package.version}].filter(At.i)},xr=({closeFlyout:e,vulnerabilityRecord:t,onPaginate:a,totalVulnerabilitiesCount:s,flyoutIndex:i,isLoading:l=!1})=>{const[r,o]=Object(n.useState)(mr),u=null==t?void 0:t.vulnerability,c=Object(n.useMemo)((()=>[{id:mr,name:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.overviewTabLabel",defaultMessage:"Overview"}),content:Object(j.jsx)(rr,{vulnerabilityRecord:t})},{id:"vuln-flyout-table-tab",name:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.tableTabLabel",defaultMessage:"Table"}),content:Object(j.jsx)(gr,{vulnerabilityRecord:t})},{id:"vuln-flyout-json-tab",name:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.jsonTabLabel",defaultMessage:"JSON"}),content:Object(j.jsx)(or,{vulnerabilityRecord:t})}]),[t]),d=Object(n.useMemo)((()=>{var e;return null===(e=c.find((e=>e.id===r)))||void 0===e?void 0:e.content}),[r,c]),b=_.i18n.translate("xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.loadingAriaLabel",{defaultMessage:"Loading"}),p=null==u?void 0:u.reference;return Object(j.jsx)(C.EuiFlyout,{onClose:e},Object(j.jsx)(C.EuiFlyoutHeader,null,Object(j.jsx)(C.EuiSkeletonText,{lines:10,size:"m",isLoading:l,contentAriaLabel:b},Object(j.jsx)(C.EuiFlexGroup,{direction:"column",css:Object(j.css)("gap:",Ae.euiThemeVars.euiSizeS,";","")},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(Al,{severity:null==u?void 0:u.severity})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",css:Object(j.css)("gap:",Ae.euiThemeVars.euiSizeS,";","")},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiTitle,{size:"m",css:Object(j.css)("color:",Ae.euiThemeVars.euiColorPrimaryText,";line-height:32px;","")},p?Object(j.jsx)(C.EuiLink,{target:"_blank",href:p},null==u?void 0:u.id):Object(j.jsx)(C.EuiText,null,null==u?void 0:u.id))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("div",{css:Object(j.css)("line-height:20px;margin-bottom:",Ae.euiThemeVars.euiSizeM,";","")},Object(j.jsx)(Vn,{testId:"vulnerability-flyout-description-list",listItems:jr(t)}))))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiTabs,null,c.map(((e,t)=>{return Object(j.jsx)(C.EuiTab,{"data-test-subj":(a=e.id,`vulnerability-finding-flyout-tab-${a}`),onClick:()=>{return t=e.id,o(t);var t},isSelected:e.id===r,key:t},e.name);var a}))))))),Object(j.jsx)(C.EuiFlyoutBody,null,Object(j.jsx)(C.EuiSkeletonText,{lines:10,size:"m",isLoading:l,contentAriaLabel:b},d)),Object(j.jsx)(C.EuiFlyoutFooter,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:a?"spaceBetween":"flexEnd"},a&&s&&i&&Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPagination,{pageCount:s,activePage:i,onPageClick:a,compressed:!0})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(Ci,{createRuleFn:async e=>await Kl(e,t.vulnerability)})))))},fr={"resource.id":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnLabel",{defaultMessage:"Resource ID"}),"resource.name":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceNameColumnLabel",{defaultMessage:"Resource Name"}),"vulnerability.id":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.vulnerabilityIdColumnLabel",{defaultMessage:"Vulnerability"}),"vulnerability.score.base":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.vulnerabilityScoreColumnLabel",{defaultMessage:"CVSS"}),"vulnerability.severity":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.vulnerabilitySeverityColumnLabel",{defaultMessage:"Severity"}),"package.name":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.packageNameColumnLabel",{defaultMessage:"Package"}),"package.version":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.packageVersionColumnLabel",{defaultMessage:"Version"}),"package.fixed_version":_.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.packageFixedVersionColumnLabel",{defaultMessage:"Fix Version"})},hr=e=>(e=>{var t;return void 0!==(null==e||null===(t=e.vulnerability)||void 0===t?void 0:t.id)})(e)&&e,Or=({row:e,children:t})=>{const a=hr(e.raw._source);return a?t({finding:a}):Object(j.jsx)(l.a.Fragment,null)},vr=(e,t)=>Object(j.jsx)(Or,{row:e},(({finding:e})=>Object(j.jsx)(xr,{vulnerabilityRecord:e,closeFlyout:t}))),yr=_.i18n.translate("xpack.csp.findings.latestVulnerabilities.tableRowTypeLabel",{defaultMessage:"Vulnerabilities"}),Tr=e=>({"vulnerability.score.base":({rowIndex:t})=>Object(j.jsx)(Or,{row:e[t]},(({finding:e})=>{var t,a,s,i;return Object(j.jsx)(Vl,{score:null===(t=e.vulnerability)||void 0===t||null===(a=t.score)||void 0===a?void 0:a.base,version:null===(s=e.vulnerability)||void 0===s||null===(i=s.score)||void 0===i?void 0:i.version})})),"vulnerability.severity":({rowIndex:t})=>Object(j.jsx)(Or,{row:e[t]},(({finding:e})=>Object(j.jsx)(Al,{severity:e.vulnerability.severity})))}),kr=({groupSelectorComponent:e,height:t,nonPersistedFilters:a})=>{const{cloudPostureDataTable:s,rows:i,total:o,error:u,isFetching:c,fetchNextPage:d}=(({getDefaultQuery:e,nonPersistedFilters:t})=>{const a=Tt({paginationLocalStorageKey:te.j,columnsLocalStorageKey:"cloudPosture:latestVulnerabilities:columns",defaultQuery:e,nonPersistedFilters:t}),{query:s,sort:i,queryError:l,getRowsFromPages:o,pageSize:u}=a,{data:c,error:d,isFetching:b,fetchNextPage:p}=(e=>{const{data:t,notifications:{toasts:a}}=Object(w.a)().services;return Object(r.useInfiniteQuery)([F.N,e],(async({pageParam:a})=>{const{rawResponse:{hits:s}}=await Object(Gt.lastValueFrom)(t.search.search({params:Il(e,a)}));return{page:s.hits.map((e=>Vi(e))),total:Ri.number.is(s.total)?s.total:0}}),{staleTime:5e3,keepPreviousData:!0,enabled:e.enabled,onError:e=>zt(a,e),getNextPageParam:(t,a)=>{if(!(t.page.length<e.pageSize))return a.length*e.pageSize}})})({query:s,sort:i,enabled:!l,pageSize:u});return{cloudPostureDataTable:a,rows:Object(n.useMemo)((()=>o(null==c?void 0:c.pages)),[null==c?void 0:c.pages,o]),error:d||l,isFetching:b,fetchNextPage:p,total:(null==c?void 0:c.pages[0].total)||0}})({getDefaultQuery:Sl,nonPersistedFilters:a});return Object(j.jsx)(l.a.Fragment,null,u?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)(ma,{error:u})):Object(j.jsx)(_i,{"data-test-subj":"latest_vulnerabilities_table",isLoading:c,defaultColumns:Fl,rows:i,total:o,flyoutComponent:vr,createRuleFn:e=>{const t=hr(i[e].raw._source);if(t)return async e=>Kl(e,t.vulnerability)},cloudPostureDataTable:s,loadMore:d,title:yr,customCellRenderer:Tr,groupSelectorComponent:e,height:t,hasDistributionBar:!1,columnHeaders:fr}))},Cr=({severityMap:e,total:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s=[],i=[];if(t>0){const a=Math.max(.08*t,1);let n=0;["low","medium","high","critical"].forEach((l=>{e[l]>0&&(n+=Math.max(e[l],a),s.push({stop:n,color:Nl(l.toUpperCase())})),i.push({severity:l,count:e[l],percentage:e[l]/t*100})}))}return Object(j.jsx)(C.EuiToolTip,{className:Object(Qs.css)({name:"qhpvho",styles:"width:256px"}),anchorClassName:Object(Qs.css)("margin-left:",a.size.xs,";",""),position:"left",title:_.i18n.translate("xpack.csp.vulnerabilitiesByResource.severityMap.tooltipTitle",{defaultMessage:"Severity map"}),content:Object(j.jsx)(Er,{severityMapTooltip:i})},Object(j.jsx)(C.EuiColorPaletteDisplay,{type:"fixed",palette:s,className:Object(Qs.css)({name:"1g34jxj",styles:"width:80px;height:6px"})}))},Er=({severityMapTooltip:e})=>{const{euiTheme:t}=Object(C.useEuiTheme)();return Object(j.jsx)(l.a.Fragment,null,e.map((e=>{return Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"spaceBetween",key:e.severity,alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)(Al,{severity:e.severity.toUpperCase()}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiText,{size:"s"},e.count)),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiText,{textAlign:"right",size:"s",className:Object(Qs.css)("width:",t.size.xxxl,";color:",t.colors.mediumShade,";","")},0===(a=e.percentage)?"0%":100===a?"100%":`${a.toFixed(1)}%`)))));var a})))},Sr=({cloudProvider:e,size:t,style:a})=>{const s=(e=>{switch(e){case"azure":return"logoAzure";case"aws":return"logoAWS";case"gcp":return _n.a;default:return}})(e);if(!s)return null;const i=Object(At.g)(e);return Object(j.jsx)(C.EuiToolTip,{content:i},Object(j.jsx)(C.EuiIcon,{type:s,size:t||"xl",css:a}))};var Fr={name:"1m5hyg0",styles:"word-break:break-all"},wr={name:"1m5hyg0",styles:"word-break:break-all"},Mr={name:"1u4hpl4",styles:"display:inline"};const _r=(e,t,a,s)=>{var i,n,l,r,o,u,c,d,b,p;if(s)return Object(j.jsx)(It,null);const g=t=>Object(j.jsx)(Rt,{title:t,field:e,unit:yl}),m=Mt(null===(i=t.cloudProvider)||void 0===i||null===(n=i.buckets)||void 0===n||null===(l=n[0])||void 0===l?void 0:l.key),x=Mt(null===(r=t.description)||void 0===r||null===(o=r.buckets)||void 0===o||null===(u=o[0])||void 0===u?void 0:u.key),f=m?Object(At.g)(m):"";switch(e){case te.u.RESOURCE_NAME:return a?g(Tl.RESOURCE_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{css:Mr},Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)(C.EuiTextBlockTruncate,{lines:2,css:wr,title:null===(c=t.resourceId)||void 0===c||null===(d=c.buckets)||void 0===d?void 0:d[0].key},Object(j.jsx)("strong",null,t.key_as_string)," ",null===(b=t.resourceId)||void 0===b||null===(p=b.buckets)||void 0===p?void 0:p[0].key))))));case te.u.CLOUD_ACCOUNT_NAME:return a?g(Tl.CLOUD_ACCOUNT_NAME):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},m&&Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)(Sr,{cloudProvider:m})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},f)))));default:return a?g(Tl.DEFAULT):Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"s"},Object(j.jsx)("strong",null,t.key_as_string))),x&&Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(C.EuiTextBlockTruncate,{lines:1,css:Fr},x))))))}},Rr=({bucket:e})=>{const{euiTheme:t}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiToolTip,{content:e.doc_count},Object(j.jsx)(C.EuiBadge,{css:Object(j.css)("margin-left:",t.size.s,";",""),color:"hollow","data-test-subj":"vulnerabilities_grouping_counter"},oa(e.doc_count)))},Ir=l.a.memo(Rr),Nr=({bucket:e})=>{var t,a,s,i,n,l,r,o;const u={critical:null!==(t=null===(a=e.critical)||void 0===a?void 0:a.doc_count)&&void 0!==t?t:0,high:null!==(s=null===(i=e.high)||void 0===i?void 0:i.doc_count)&&void 0!==s?s:0,medium:null!==(n=null===(l=e.medium)||void 0===l?void 0:l.doc_count)&&void 0!==n?n:0,low:null!==(r=null===(o=e.low)||void 0===o?void 0:o.doc_count)&&void 0!==r?r:0};return Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilities.grouping.severity",defaultMessage:"Severity"})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(Cr,{total:e.doc_count,severityMap:u})))},Dr=l.a.memo(Nr),Pr=(e,t)=>[{title:hl,renderer:Object(j.jsx)(Ir,{bucket:t})},{title:"",renderer:Object(j.jsx)(Dr,{bucket:t})}],Vr=()=>{const e=({renderChildComponent:e,groupingLevel:t,parentGroupFilters:a,selectedGroup:s,groupSelectorComponent:i})=>{const{groupData:l,grouping:r,isFetching:o,activePageIndex:u,pageSize:c,onChangeGroupsItemsPerPage:d,onChangeGroupsPage:b,isGroupLoading:p,setActivePageIndex:g}=_l({groupPanelRenderer:_r,groupStatsRenderer:Pr,groupingLevel:t,selectedGroup:s,groupFilters:a?JSON.parse(a):[]});return Object(n.useEffect)((()=>{g(0)}),[s]),Object(j.jsx)(wt,{data:l,grouping:r,renderChildComponent:e,onChangeGroupsItemsPerPage:d,onChangeGroupsPage:b,activePageIndex:u,isFetching:o,pageSize:c,selectedGroup:s,isGroupLoading:p,groupingLevel:t,groupSelectorComponent:i})},t=({level:a,currentSelectedGroup:s,selectedGroupOptions:i,parentGroupFilters:n,groupSelectorComponent:l})=>{let r;return"none"===s?Object(j.jsx)(kr,{groupSelectorComponent:l,nonPersistedFilters:[...n?JSON.parse(n):[]]}):(r=a<i.length-1&&!i.includes("none")?e=>{const s=a+1;return t({level:s,currentSelectedGroup:i[s],selectedGroupOptions:i,parentGroupFilters:JSON.stringify([...e,...n?JSON.parse(n):[]]),groupSelectorComponent:l})}:e=>Object(j.jsx)(kr,{nonPersistedFilters:[...e,...n?JSON.parse(n):[]],height:te.b}),Object(j.jsx)(e,{renderChildComponent:r,selectedGroup:i[a],groupingLevel:a,parentGroupFilters:n,groupSelectorComponent:l}))},{grouping:a,isFetching:s,urlQuery:i,setUrlQuery:r,onResetFilters:o,error:u,isEmptyResults:c}=_l({groupPanelRenderer:_r,groupStatsRenderer:Pr});return u||c?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Nt,{query:i,setQuery:r,loading:s}),Object(j.jsx)(C.EuiSpacer,{size:"m"}),u&&Object(j.jsx)(ma,{error:u}),c&&Object(j.jsx)(ge,{onResetFilters:o})):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Nt,{query:i,setQuery:r,loading:s}),Object(j.jsx)(C.EuiSpacer,{size:"m"}),Object(j.jsx)("div",null,t({level:0,currentSelectedGroup:a.selectedGroups[0],selectedGroupOptions:a.selectedGroups,groupSelectorComponent:a.groupSelector})))},Gr=()=>{var e,t;const a=ce(F.N),s=M();if("indexed"!==(null==s||null===(e=s.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status))return Object(j.jsx)(xl,null);const i={dataView:a.data,dataViewRefetch:a.refetch,dataViewIsRefetching:a.isRefetching};return Object(j.jsx)($,{query:a},Object(j.jsx)(h,null,Object(j.jsx)(x,{path:O.e.vulnerabilities.path,render:()=>Object(j.jsx)(ht.Provider,{value:i},Object(j.jsx)(Vr,null))})))},Ar=({lastTabSelected:e})=>{const t=Object(o.useLocation)(),a=M();return a.data?(Object(At.h)(F.bb,a.data),Object(At.h)(F.D,a.data),Object(j.jsx)(o.Redirect,{to:{search:t.search,pathname:O.e.findings_default.path}})):null},Lr=()=>{var e,t;const a=Object(o.useHistory)(),s=Object(o.useLocation)(),[i,n]=k()(te.l),r=null===(e=Object(o.matchPath)(s.pathname,{path:O.e.resource_vulnerabilities.path}))||void 0===e?void 0:e.isExact,u=null===(t=Object(o.matchPath)(s.pathname,{path:O.e.resource_findings.path}))||void 0===t?void 0:t.isExact,c=!r&&!u,d=e=>e===O.e.vulnerabilities.path||e===O.e.vulnerabilities_by_resource.path;return Object(j.jsx)(l.a.Fragment,null,c&&Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiTitle,{size:"l"},Object(j.jsx)("h1",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.title",defaultMessage:"Findings"}))),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(C.EuiTabs,{size:"l"},Object(j.jsx)(C.EuiTab,{key:"configurations",onClick:()=>{n("configurations"),a.push({pathname:O.e.findings_default.path})},isSelected:!d(s.pathname)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.tabs.misconfigurations",defaultMessage:"Misconfigurations"})),Object(j.jsx)(C.EuiTab,{key:"vuln_mgmt",onClick:()=>{n("vuln_mgmt"),a.push({pathname:O.e.vulnerabilities.path})},isSelected:d(s.pathname)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.findings.tabs.vulnerabilities",defaultMessage:"Vulnerabilities"})))),Object(j.jsx)(h,null,Object(j.jsx)(x,{exact:!0,path:O.c.findings.path,render:()=>Object(j.jsx)(Ar,{lastTabSelected:i})}),Object(j.jsx)(x,{path:O.e.findings_default.path,component:cl}),Object(j.jsx)(x,{path:O.e.findings_by_resource.path,component:cl}),Object(j.jsx)(x,{path:O.e.vulnerabilities.path,component:Gr}),Object(j.jsx)(x,{path:O.e.vulnerabilities_by_resource.path,component:Gr}),Object(j.jsx)(x,{path:"*",render:()=>Object(j.jsx)(o.Redirect,{to:O.e.findings_default.path})})))},zr=({title:e,isBeta:t})=>Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiTitle,null,Object(j.jsx)("h1",null,e))),t&&Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiBetaBadge,{label:"Beta",tooltipContent:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.betaLabel",defaultMessage:"This functionality is in beta and is subject to change. The design and code is less mature than official generally available features and is being provided as-is with no warranties. Beta features are not subject to the support service level agreement of official generally available features."}),tooltipPosition:"bottom"}))),Br=["csp_cspm_dashboard_stats"],Ur=["csp_kspm_dashboard_stats"],Hr=e=>F.U.replace("{policy_template}",e),Wr=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(Br,(()=>t.get(Hr(F.v),{version:"2"})),e)},Qr=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(Ur,(()=>t.get(Hr(F.J),{version:"2"})),e)},Zr=({id:e,button:t,title:a,titleColor:s,description:i})=>{const{euiTheme:n}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiPanel,{hasBorder:!0,paddingSize:"m","data-test-subj":e},Object(j.jsx)(C.EuiStat,{css:Object(j.css)({height:"60%",display:"flex",flexDirection:"column",justifyContent:"space-around",".euiText h6":{textTransform:"capitalize",fontSize:n.size.m}},"",""),titleSize:"s",title:a,titleColor:s,descriptionElement:"h6",description:i}),Object(j.jsx)(C.EuiHorizontalRule,{margin:"xs"}),t)},Jr=({number:e,abbreviateAbove:t=999999})=>e||0===e?e<=t?Object(j.jsx)("span",null,e.toLocaleString()):Object(j.jsx)(C.EuiToolTip,{content:e.toLocaleString()},Object(j.jsx)("span",null,e.toLocaleString(void 0,{notation:"compact",maximumFractionDigits:1}))):Object(j.jsx)("span",null,_.i18n.translate("xpack.csp.compactFormattedNumber.naTitle",{defaultMessage:"N/A"})),qr=()=>Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":A.d.LOADING},Object(j.jsx)(C.EuiLoadingChart,{size:"m"})),Kr=()=>Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":A.d.ERROR},Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},"Error")),$r=({title:e,hasBorder:t=!0,isLoading:a,isError:s,children:i,rightSideItems:n,styles:l})=>{const{euiTheme:r}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiPanel,{hasBorder:t,hasShadow:!1,style:l,"data-test-subj":"chart-panel"},Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{height:"100%"}},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:{justifyContent:"center"}},e&&Object(j.jsx)(C.EuiTitle,{size:"s"},Object(j.jsx)("h3",{style:{lineHeight:"initial",paddingLeft:r.size.s}},e))),Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:{flexDirection:"row",gap:r.size.s}},n))),Object(j.jsx)(C.EuiFlexItem,{style:{height:"100%"}},a?Object(j.jsx)(qr,null):s?Object(j.jsx)(Kr,null):i)))};var Yr=a(36),Xr={name:"3xdkux",styles:"display:flex;&:hover{text-decoration:none;}"};const eo=({text:e,count:t,color:a,onClick:s})=>{const{euiTheme:i}=Object(C.useEuiTheme)();return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiText,{size:"s",style:{fontWeight:i.font.weight.bold,marginBottom:i.size.xs}},e),Object(j.jsx)(C.EuiLink,{color:"text",onClick:s,css:Xr},Object(j.jsx)(C.EuiText,{color:a,css:Object(j.css)("&:hover{border-bottom:2px solid ",a,";padding-bottom:4px;}",""),style:{fontWeight:i.font.weight.medium,fontSize:"18px"},size:"s"},Object(j.jsx)(Jr,{number:t,abbreviateAbove:999}),"")))},to=({onEvalCounterClick:e,stats:t})=>Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(oo,{text:"passed",count:t.totalPassed,color:te.w.passed,onClick:()=>e(F.R),tooltipContent:_.i18n.translate("xpack.csp.complianceScoreChart.counterLink.passedFindingsTooltip",{defaultMessage:"Passed findings"})}),Object(j.jsx)(C.EuiText,{size:"s"},"-"),Object(j.jsx)(oo,{text:"failed",count:t.totalFailed,color:te.w.failed,onClick:()=>e(F.Q),tooltipContent:_.i18n.translate("xpack.csp.complianceScoreChart.counterButtonLink.failedFindingsTooltip",{defaultMessage:"Failed findings"})})),ao=({onEvalCounterClick:e,stats:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s={borderLeft:a.border.thin,paddingLeft:a.size.m};return Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceBetween"},Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:s},Object(j.jsx)(eo,{text:"Passed Findings",count:t.totalPassed,color:te.w.passed,onClick:()=>e(F.R)})),Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:s},Object(j.jsx)(eo,{text:"Failed Findings",count:t.totalFailed,color:te.w.failed,onClick:()=>e(F.Q)})))},so=e=>`${Math.round(e)}%`,io=({compact:e,postureScore:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s=so(t);return Object(j.jsx)(C.EuiTitle,{css:Object(j.css)({fontSize:e?a.size.l:a.size.xxl,paddingLeft:e?a.size.s:a.size.xs,marginBottom:e?a.size.s:"none"},"",""),"data-test-subj":"dashboard-summary-section-compliance-score"},Object(j.jsx)("h3",null,s))},no=e=>({...e,timestamp:Hi()(e.timestamp).valueOf()}),lo=({trend:e})=>{const t=e.map(no),{services:{charts:a}}=Object(w.a)();return Object(j.jsx)(Yr.Chart,null,Object(j.jsx)(Yr.Tooltip,{headerFormatter:({value:e})=>Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(E.FormattedDate,{value:e,month:"short",day:"numeric"}),", ",Object(j.jsx)(E.FormattedTime,{value:e}))}),Object(j.jsx)(Yr.Settings,{baseTheme:a.theme.useChartsBaseTheme(),showLegend:!1,legendPosition:"right",locale:_.i18n.getLocale()}),Object(j.jsx)(Yr.AreaSeries,{id:"Posture Score",data:t,xScaleType:"time",xAccessor:"timestamp",yAccessors:["postureScore"]}),Object(j.jsx)(Yr.Axis,{id:"bottom-axis",position:"bottom",tickFormat:Object(Yr.timeFormatter)(Object(Yr.niceTimeFormatByDay)(2)),ticks:4}),Object(j.jsx)(Yr.Axis,{ticks:3,id:"left-axis",position:"left",gridLine:{visible:!0},domain:{min:0,max:100}}))};var ro={name:"zjik7",styles:"display:flex"};const oo=({text:e,count:t,color:a,onClick:s,tooltipContent:i})=>{const{euiTheme:n}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiToolTip,{content:i},Object(j.jsx)(C.EuiLink,{color:"text",onClick:s,css:ro},Object(j.jsx)(C.EuiText,{color:a,style:{fontWeight:n.font.weight.medium},size:"s"},Object(j.jsx)(Jr,{number:t,abbreviateAbove:999}),""),Object(j.jsx)(C.EuiText,{size:"s"},e)))},uo=({data:e,trend:t,onEvalCounterClick:a,compact:s})=>{const{euiTheme:n}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",style:{height:"100%"},gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{grow:2},Object(j.jsx)(C.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(io,i()({},e,{compact:s}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",alignItems:"flexStart",style:{paddingRight:n.size.xl}},s?Object(j.jsx)(to,{stats:{totalPassed:e.totalPassed,totalFailed:e.totalFailed},onEvalCounterClick:a}):Object(j.jsx)(ao,{stats:{totalPassed:e.totalPassed,totalFailed:e.totalFailed},onEvalCounterClick:a}))))),Object(j.jsx)(C.EuiFlexItem,{grow:6},Object(j.jsx)(lo,{trend:t})))};var co={name:"20jspu",styles:"thead{.euiTableCellContent{padding:0;}}.euiTable .euiTableRow .euiTableRowCell{border-top:none;}"};const bo=({data:e,maxItems:t,onCellClick:a,onViewAllClick:s,viewAllButtonTitle:i,compact:l})=>{const r=Object(n.useMemo)((()=>[{field:"name",truncateText:!0,name:l?"":_.i18n.translate("xpack.csp.dashboard.risksTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>a(e),className:"eui-textTruncate",color:"text"},e)},{field:"postureScore",width:"115px",name:l?"":_.i18n.translate("xpack.csp.dashboard.risksTable.complianceColumnLabel",{defaultMessage:"Compliance"}),render:(e,t)=>Object(j.jsx)(Xn,{totalPassed:t.totalPassed,totalFailed:t.totalFailed})}]),[l,a]),o=((e,t)=>e.slice().sort(((e,t)=>e.postureScore-t.postureScore)).slice(0,t))(e,t);return Object(j.jsx)(C.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiInMemoryTable,{className:"risk-table",css:l?co:void 0,items:o,columns:r})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)("div",null,Object(j.jsx)(C.EuiButtonEmpty,{onClick:s,iconType:"search"},i))))},po=(e,t=F.S)=>{const a=Object(o.useHistory)(),{services:s}=Object(w.a)();return Object(n.useCallback)(((i={},n)=>{const l=Object.entries(i).map((([e,a])=>((e,t,a)=>{let s=!1,i=t;return"object"==typeof t&&(s=t.negate,i=t.value),"*"===i?{query:{exists:{field:e}},meta:{type:"exists",index:a}}:{meta:{alias:null,negate:s,disabled:!1,type:"phrase",key:e,index:a},query:{match_phrase:{[e]:i}}}})(e,a,t)));a.push({pathname:e,search:gt({query:s.data.query.queryString.getDefaultQuery(),filters:l,...n&&{groupBy:n}})})}),[a,e,s.data.query.queryString,t])},go=()=>{const{data:e}=ce(F.L);return po(O.e.findings_default.path,null==e?void 0:e.id)},mo=()=>po(O.e.vulnerabilities.path),jo=[{type:F.d,name:Object(At.e)(F.d),provider:At.a.AWS},{type:F.g,name:Object(At.e)(F.g),provider:At.a.GCP},{type:F.e,name:Object(At.e)(F.e),provider:At.a.AZURE},{type:F.h,name:Object(At.e)(F.h),benchmarkId:F.h},{type:F.f,name:Object(At.e)(F.f),benchmarkId:F.f}],xo=({benchmarkAssets:e,benchmarkAbbreviateAbove:t=999})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s=go(),i=jo.map((i=>{var n,l;const r=(null===(o=i.type,n=null==e?void 0:e.find((e=>(null==e?void 0:e.meta.benchmarkId)===o)))||void 0===n||null===(l=n.meta)||void 0===l?void 0:l.assetCount)||0;var o;return r>0&&Object(j.jsx)(C.EuiFlexItem,{key:i.type,onClick:()=>{return i.provider?(e=i.provider,void s({"cloud.provider":e},[te.g.CLOUD_ACCOUNT_NAME])):i.benchmarkId?(t=i.benchmarkId,void s({"rule.benchmark.id":t},[te.g.ORCHESTRATOR_CLUSTER_NAME])):void 0;var e,t},css:Object(j.css)("transition:",a.animation.normal," ease-in;border-bottom:",a.border.thick,";border-color:transparent;text-wrap:nowrap;:hover{cursor:pointer;border-color:",a.colors.darkestShade,";}","")},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(In,{type:i.type,name:i.name,size:"l"})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(Jr,{number:r,abbreviateAbove:t}))))}));return Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"m"},i)},fo=e=>e===F.v?{"rule.benchmark.posture_type":F.v}:{"rule.benchmark.posture_type":{value:F.v,negate:!0}};var ho={name:"1gfe5of",styles:"height:350px"};const Oo=({dashboardType:e,complianceData:t})=>{const a=go(),s=ee(F.v),i=ee(F.J),{euiTheme:l}=Object(C.useEuiTheme)(),r=(t,s=F.Q)=>{a({...fo(e),"rule.section":t,"result.evaluation":s},[te.g.NONE])},o=Object(n.useMemo)((()=>[{id:"dashboard-counter-card-clusters-evaluated",description:e===F.J?_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.clustersEvaluatedDescription",{defaultMessage:"Clusters Evaluated"}):_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.accountsEvaluatedDescription",{defaultMessage:"Accounts Evaluated"}),title:Object(j.jsx)(xo,{benchmarkAssets:t.benchmarks}),button:Object(j.jsx)(C.EuiButtonEmpty,{iconType:"listAdd",target:"_blank",href:e===F.J?i:s},e===F.J?_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.clustersEvaluatedButtonTitle",{defaultMessage:"Enroll more clusters"}):_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.accountsEvaluatedButtonTitle",{defaultMessage:"Enroll more accounts"}))},{id:"dashboard-counter-card-resources-evaluated",description:_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.resourcesEvaluatedDescription",{defaultMessage:"Resources Evaluated"}),title:Object(j.jsx)(Jr,{number:t.stats.resourcesEvaluated||0}),button:Object(j.jsx)(C.EuiButtonEmpty,{iconType:"search",onClick:()=>{a(fo(e),[te.g.RESOURCE_NAME])}},_.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.resourcesEvaluatedButtonTitle",{defaultMessage:"View all resources"}))}]),[t.benchmarks,t.stats.resourcesEvaluated,s,e,i,a]),u=_.i18n.translate("xpack.csp.dashboard.summarySection.complianceScorePanelTitle",{defaultMessage:"Compliance Score"});return Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"l",css:ho,"data-test-subj":"dashboard-summary-section"},Object(j.jsx)(C.EuiFlexItem,{grow:3},Object(j.jsx)(C.EuiFlexGroup,{direction:"column"},o.map((e=>Object(j.jsx)(C.EuiFlexItem,{key:e.id},Object(j.jsx)(Zr,e)))))),Object(j.jsx)(C.EuiFlexItem,{grow:8},Object(j.jsx)($r,{title:u},Object(j.jsx)(uo,{id:"cloud_posture_score_chart",data:t.stats,trend:t.trend,onEvalCounterClick:t=>{a({"result.evaluation":t,...fo(e)},[te.g.NONE])}}))),Object(j.jsx)(C.EuiFlexItem,{grow:8},Object(j.jsx)($r,{styles:{padding:`${l.size.m} ${l.size.m} ${l.size.s} ${l.size.m}`},title:_.i18n.translate("xpack.csp.dashboard.summarySection.complianceByCisSectionPanelTitle",{defaultMessage:"Compliance By CIS Section"})},Object(j.jsx)(bo,{data:t.groupedFindingsEvaluation,maxItems:5,onCellClick:e=>{const a=t.groupedFindingsEvaluation.find((t=>t.name===e));null!=a&&a.postureScore&&100===Math.trunc(null==a?void 0:a.postureScore)?r(e,F.R):r(e)},onViewAllClick:()=>{a({"result.evaluation":F.Q,...fo(e)},[te.g.RULE_SECTION])},viewAllButtonTitle:_.i18n.translate("xpack.csp.dashboard.risksTable.viewAllButtonTitle",{defaultMessage:"View all failed findings"})}))))};var vo={name:"14is9qy",styles:"font-size:20px"};const yo=({benchmark:e})=>{const t=go(),a=()=>t(To(e),[te.g.CLOUD_ACCOUNT_NAME]),s=()=>t(To(e),[te.g.ORCHESTRATOR_CLUSTER_NAME]),i=_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisBenchmarkTooltip",{defaultMessage:"Center of Internet Security"}),n=((e,t)=>({cis_gcp:{name:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisGcpBenchmarkName",{defaultMessage:"CIS GCP"}),assetType:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisGcpBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Project} other {# Projects}}",values:{count:t}}),handleClick:a},cis_aws:{name:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAwsBenchmarkName",{defaultMessage:"CIS AWS"}),assetType:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAwsBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Account} other {# Accounts}}",values:{count:t}}),handleClick:a},cis_azure:{name:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAzureBenchmarkName",{defaultMessage:"CIS Azure"}),assetType:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAzureBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Subscription} other {# Subscriptions}}",values:{count:t}}),handleClick:a},cis_k8s:{name:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisK8sBenchmarkName",{defaultMessage:"CIS Kubernetes"}),assetType:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisK8sBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Cluster} other {# Clusters}}",values:{count:t}}),handleClick:s},cis_eks:{name:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisEksBenchmarkName",{defaultMessage:"CIS EKS"}),assetType:_.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisEksBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Cluster} other {# Clusters}}",values:{count:t}}),handleClick:s}}[e]))(e.meta.benchmarkId,e.meta.assetCount),l=e.meta.benchmarkId,r=e.meta.benchmarkVersion,o=e.meta.benchmarkName;return Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"spaceBetween"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiToolTip,{position:"top",content:Object(j.jsx)(C.EuiText,null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.benchmarkTitleTooltip.benchmarkPrefixTitle",defaultMessage:"Show all findings for "}),Object(j.jsx)("strong",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.benchmarkTitleTooltip.benchmarkTitle",defaultMessage:"{benchmark}",values:{benchmark:o}})))},Object(j.jsx)(C.EuiLink,{onClick:n.handleClick,color:"text"},Object(j.jsx)(C.EuiTitle,{css:vo},Object(j.jsx)("h5",null,n.name)))),Object(j.jsx)(C.EuiLink,{onClick:n.handleClick,color:"text"},Object(j.jsx)(C.EuiText,{size:"xs"},n.assetType))),Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:{justifyContent:"flex-end"}},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(j.jsx)(In,{type:l,name:`${o}`}),Object(j.jsx)(C.EuiToolTip,{content:i},Object(j.jsx)(C.EuiIcon,{type:$i.a,size:"xxl"})),Object(j.jsx)(C.EuiText,{size:"xs",color:"subdued"},r))))},To=e=>({"rule.benchmark.id":e.meta.benchmarkId,"rule.benchmark.version":e.meta.benchmarkVersion}),ko=({complianceData:e,dashboardType:t})=>{const{euiTheme:a}=Object(C.useEuiTheme)(),s=go(),[i,l]=k()(te.h,"asc"),r="asc"===i,o=r?"sortUp":"sortDown",u=(e,a,i=[te.g.NONE])=>{s({...fo(t),...To(e),"result.evaluation":a},i)},c=(e,a,i=F.Q)=>{s({...fo(t),...To(e),"rule.section":a,"result.evaluation":i},[te.g.NONE])},d=Object(n.useMemo)((()=>[...e.benchmarks].sort(((e,t)=>r?e.stats.postureScore-t.stats.postureScore:t.stats.postureScore-e.stats.postureScore))),[e.benchmarks,r]);return Object(j.jsx)(C.EuiPanel,{hasBorder:!0},Object(j.jsx)(C.EuiFlexGroup,{css:Object(j.css)("border-bottom:",a.border.thin,";border-bottom-color:",a.colors.lightShade,";padding-bottom:",a.size.s,";.euiTitle{font-weight:",a.font.weight.semiBold,";}button{text-align:left;}","")},Object(j.jsx)(C.EuiFlexItem,{grow:3},Object(j.jsx)(C.EuiTitle,{size:"xxs"},Object(j.jsx)("div",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.benchmarks",defaultMessage:"Benchmarks"})))),Object(j.jsx)(C.EuiFlexItem,{grow:8},Object(j.jsx)("button",{"data-test-subj":"csp:dashboard-sections-table-header-score",onClick:()=>{l(r?"desc":"asc")}},Object(j.jsx)(C.EuiTitle,{size:"xxs"},Object(j.jsx)("div",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.complianceScoreTitle",defaultMessage:"Compliance Score"}),Object(j.jsx)(C.EuiIcon,{type:o}))))),Object(j.jsx)(C.EuiFlexItem,{grow:8},Object(j.jsx)(C.EuiTitle,{size:"xxs"},Object(j.jsx)("div",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.complianceByCisSectionTitle",defaultMessage:"Compliance by CIS Section"}))))),d.map((e=>Object(j.jsx)(C.EuiFlexGroup,{key:`${e.meta.benchmarkId}_${e.meta.benchmarkVersion}`,css:Object(j.css)("height:200px;padding:",a.size.base," 0 ",a.size.l,";&:not(:last-of-type){border-bottom:",a.border.thin,";}","")},Object(j.jsx)(C.EuiFlexItem,{grow:3},Object(j.jsx)(yo,{benchmark:e})),Object(j.jsx)(C.EuiFlexItem,{grow:8,css:Object(j.css)("margin-left:-",a.size.s,";",""),"data-test-subj":"csp:dashboard-sections-table-column-score"},Object(j.jsx)(uo,{compact:!0,id:`${e.meta.benchmarkId}_score_chart`,data:e.stats,trend:e.trend,onEvalCounterClick:t=>u(e,t)})),Object(j.jsx)(C.EuiFlexItem,{grow:8},Object(j.jsx)("div",{style:{paddingRight:a.size.base}},Object(j.jsx)(bo,{compact:!0,data:e.groupedFindingsEvaluation,maxItems:3,onCellClick:t=>{const a=e.groupedFindingsEvaluation.find((e=>e.name===t));null!=a&&a.postureScore&&100===Math.trunc(null==a?void 0:a.postureScore)?c(e,t,F.R):c(e,t)},viewAllButtonTitle:_.i18n.translate("xpack.csp.dashboard.risksTable.benchmarkCardViewAllButtonTitle",{defaultMessage:"View all failed findings for this benchmark"}),onViewAllClick:()=>(e=>{u(e,F.Q,[te.g.RULE_SECTION])})(e)})))))))},Co=F.v,Eo=F.J,So={kspm:{testId:"cloud_posture_page_kspm_not_installed",docsLink:O.d.kspm.overviewPath,actionTitle:_.i18n.translate("xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.buttonLabel",{defaultMessage:"Add a KSPM integration"}),actionDescription:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.description",defaultMessage:"Use our {integrationFullName} (KSPM) integration to detect security misconfigurations in your Kubernetes clusters.",values:{integrationFullName:Object(j.jsx)(C.EuiLink,{href:O.d.kspm.overviewPath,target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.integrationNameLabel",defaultMessage:"Kubernetes Security Posture Management"}))}})},cspm:{testId:"cloud_posture_page_cspm_not_installed",docsLink:O.d.cspm.overviewPath,actionTitle:_.i18n.translate("xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.buttonLabel",{defaultMessage:"Add a CSPM integration"}),actionDescription:Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.description",defaultMessage:"Use our {integrationFullName} (CSPM) integration to detect security misconfigurations in your cloud infrastructure.",values:{integrationFullName:Object(j.jsx)(C.EuiLink,{href:O.d.cspm.overviewPath,target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.integrationNameLabel",defaultMessage:"Cloud Security Posture Management"}))}})}},Fo=(e,t)=>{const a=So[e];return{pageTitle:_.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.pageTitle",{defaultMessage:"Install Integration to get started"}),docsLink:a.docsLink,actionHref:t,actionTitle:a.actionTitle,actionDescription:a.actionDescription,testId:a.testId}},wo=({complianceData:e,notInstalledConfig:t,isIntegrationInstalled:a,dashboardType:s})=>{const i=!e||0===e.stats.totalFindings;return i&&!a?Object(j.jsx)(Z,t):i&&a?Object(j.jsx)("div",{style:{height:"calc(100vh - 265px)",display:"flex",justifyContent:"center"}},Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":A.u.NO_FINDINGS,color:"plain",icon:Object(j.jsx)(C.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.integrationDashboard.noFindings.promptTitle",defaultMessage:"Findings Evaluation Status"})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.integrationDashboard.noFindingsPrompt.promptDescription",defaultMessage:"Waiting for data to be collected and indexed. If this process is taking longer than expected then please reach out our support"}))})):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Oo,{complianceData:e,dashboardType:s}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(ko,{complianceData:e,dashboardType:s}),Object(j.jsx)(C.EuiSpacer,null))},Mo=e=>0===(null==e?void 0:e.stats.totalFindings)&&te.r,_o=({selectedPostureTypeTab:e})=>{var t;const{data:a}=M({refetchInterval:t=>{var a;return"indexed"!==(null==t||null===(a=t[e])||void 0===a?void 0:a.status)&&te.r}}),s=!(null==a||!a.installedPackageVersion),i=Wr({enabled:s&&e===Co,refetchInterval:Mo}),n=Qr({enabled:s&&e===Eo,refetchInterval:Mo}),l=null==a||null===(t=a[e])||void 0===t?void 0:t.status,r=!s||!("indexed"===l||"not-installed"===l),o=ee(F.v),u=ee(F.J);let c,d,b,p;switch(e){case Co:c=o,d="cloud-dashboard-container",b=F.v,p=i;break;case Eo:c=u,d="kubernetes-dashboard-container",b=F.J,p=n}return r?Object(j.jsx)(ue,{postureType:e}):Object(j.jsx)($,{query:p},Object(j.jsx)("div",{"data-test-subj":d},Object(j.jsx)(h,null,Object(j.jsx)(x,{path:O.c.cspm_dashboard.path},Object(j.jsx)(wo,{dashboardType:b,complianceData:p.data,notInstalledConfig:Fo(b,c),isIntegrationInstalled:"not-installed"!==l})),Object(j.jsx)(x,{path:O.c.kspm_dashboard.path},Object(j.jsx)(wo,{dashboardType:b,complianceData:p.data,notInstalledConfig:Fo(b,c),isIntegrationInstalled:"not-installed"!==l})))))};var Ro={name:"xegb6z",styles:"margin-left:auto;margin-right:auto;height:100%"};const Io=()=>{var e;const{data:t}=M(),a=!(null==t||!t.installedPackageVersion),s=Wr({enabled:a}),i=Qr({enabled:a}),l=Object(o.useLocation)(),r=Object(o.useHistory)(),{services:u}=Object(w.a)(),c=Object(n.useMemo)((()=>{let e;return l.pathname===O.c.kspm_dashboard.path&&(e=Eo),l.pathname===O.c.cspm_dashboard.path&&(e=Co),e}),[l.pathname]),d=Object(n.useMemo)((()=>((e,t,a)=>{var s,i;const n=null==t?void 0:t.stats.totalFindings,l=null==a?void 0:a.stats.totalFindings,r=null==e||null===(s=e.cspm)||void 0===s?void 0:s.status,o=null==e||null===(i=e.kspm)||void 0===i?void 0:i.status;let u=Co;if(t&&e)return n?u=Co:l?u=Eo:"unprivileged"!==r&&"not-installed"!==r?u=Co:"unprivileged"!==o&&"not-installed"!==o&&(u=Eo),u})(t,s.data,i.data)),[s.data,i.data,t]),b=Object(n.useMemo)((()=>{const e=e=>{r.push({pathname:e,search:gt({query:u.data.query.queryString.getDefaultQuery(),filters:u.data.query.filterManager.getFilters()})})},t=null!=c?c:d;return a?[{label:_.i18n.translate("xpack.csp.dashboardTabs.cloudTab.tabTitle",{defaultMessage:"Cloud"}),"data-test-subj":"cloud-dashboard-tab",isSelected:t===Co,onClick:()=>{e(O.c.cspm_dashboard.path)},content:Object(j.jsx)(_o,{selectedPostureTypeTab:t||Co})},{label:_.i18n.translate("xpack.csp.dashboardTabs.kubernetesTab.tabTitle",{defaultMessage:"Kubernetes"}),"data-test-subj":"kubernetes-dashboard-tab",isSelected:t===Eo,onClick:()=>{e(O.c.kspm_dashboard.path)},content:Object(j.jsx)(_o,{selectedPostureTypeTab:t||Eo})}]:[]}),[a,d,c,r,u]);return Object(j.jsx)($,null,Object(j.jsx)(C.EuiPageHeader,{"data-test-subj":"cloud-posture-dashboard-page-header",bottomBorder:!0,pageTitle:Object(j.jsx)(zr,{title:_.i18n.translate("xpack.csp.dashboard.cspPageTemplate.pageTitle",{defaultMessage:"Cloud Security Posture"})}),tabs:b.map((({content:e,...t})=>t))}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)("div",{"data-test-subj":"dashboard-container",css:Ro},!c&&d&&Object(j.jsx)(o.Redirect,{to:d===Co?O.c.cspm_dashboard.path:O.c.kspm_dashboard.path}),null===(e=b.find((e=>e.isSelected)))||void 0===e?void 0:e.content,!a&&Object(j.jsx)(ue,{postureType:Co})))};var No=a(99),Do=a.n(No);const Po=()=>{const e=ee(F.v)||"",t=ee(F.J)||"";return{getBenchmarkDynamicValues:(a,s)=>{switch(a){case"cis_aws":return{integrationType:"CSPM",integrationName:"AWS",resourceName:"Accounts",resourceCountLabel:_.i18n.translate("xpack.csp.benchmarkDynamicValues.AwsAccountPlural",{defaultMessage:"{resourceCount, plural, one {account} other {accounts}}",values:{resourceCount:s||0}}),integrationLink:e,learnMoreLink:"https://ela.st/cspm-get-started"};case"cis_gcp":return{integrationType:"CSPM",integrationName:"GCP",resourceName:"Projects",resourceCountLabel:_.i18n.translate("xpack.csp.benchmarkDynamicValues.GcpAccountPlural",{defaultMessage:"{resourceCount, plural, one {project} other {projects}}",values:{resourceCount:s||0}}),integrationLink:e,learnMoreLink:"https://ela.st/cspm-get-started"};case"cis_azure":return{integrationType:"CSPM",integrationName:"Azure",resourceName:"Subscriptions",resourceCountLabel:_.i18n.translate("xpack.csp.benchmarkDynamicValues.AzureAccountPlural",{defaultMessage:"{resourceCount, plural, one {subscription} other {subscriptions}}",values:{resourceCount:s||0}}),integrationLink:e,learnMoreLink:"https://ela.st/cspm-get-started"};case"cis_k8s":return{integrationType:"KSPM",integrationName:"Kubernetes",resourceName:"Clusters",resourceCountLabel:_.i18n.translate("xpack.csp.benchmarkDynamicValues.K8sAccountPlural",{defaultMessage:"{resourceCount, plural, one {cluster} other {clusters}}",values:{resourceCount:s||0}}),integrationLink:t,learnMoreLink:"https://ela.st/kspm-get-started"};case"cis_eks":return{integrationType:"KSPM",integrationName:"EKS",resourceName:"Clusters",resourceCountLabel:_.i18n.translate("xpack.csp.benchmarkDynamicValues.EksAccountPlural",{defaultMessage:"{resourceCount, plural, one {cluster} other {clusters}}",values:{resourceCount:s||0}}),integrationLink:t,learnMoreLink:"https://ela.st/kspm-get-started"};default:return{}}}}},Vo=({benchmarkId:e,benchmarkVersion:t})=>{const{application:a}=Object(w.a)().services;return Object(j.jsx)(C.EuiLink,{href:null==a?void 0:a.getUrlForApp("security",{path:Object(o.generatePath)(O.b.rules.path,{benchmarkVersion:t,benchmarkId:e})})},Object(At.f)(e))},Go=e=>Object(j.jsx)(R.a,null,Object(j.jsx)(C.EuiEmptyPrompt,{color:"danger",iconType:"warning","data-test-subj":"benchmark_page_error",title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksTable.errorRenderer.errorTitle",defaultMessage:"We couldn't fetch your cloud security posture benchmark data"})),body:W(e)?Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksTable.errorRenderer.errorDescription",defaultMessage:"{error} {statusCode}: {body}",values:{error:e.body.error,statusCode:e.body.statusCode,body:e.body.message}})):void 0})),Ao=(e,t)=>[{field:"id",name:_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationBenchmarkCisName",{defaultMessage:"Benchmark"}),truncateText:!0,width:"17.5%",sortable:!0,render:(e,t)=>Object(j.jsx)(Vo,{benchmarkId:e||"",benchmarkVersion:t.version||""}),"data-test-subj":"benchmark-table-column-cis-name"},{field:"version",name:_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationBenchmarkVersion",{defaultMessage:"Version"}),truncateText:!0,sortable:!0,width:"17.5%","data-test-subj":"benchmark-table-column-version"},{field:"id",name:_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.applicableTo",{defaultMessage:"Applicable To"}),truncateText:!0,width:"30%","data-test-subj":"benchmark-table-column-applicable-to",render:e=>Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(In,{type:e,size:"l"})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(At.e)(e))))},{field:"evaluation",name:_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.evaluated",{defaultMessage:"Evaluated"}),dataType:"string",truncateText:!0,width:"17.5%","data-test-subj":"benchmark-table-column-evaluated",render:(a,s)=>{const{resourceCountLabel:i,integrationLink:n}=e(s.id,a);if(0===a)return Object(j.jsx)(C.EuiButtonEmpty,{href:n,iconType:"plusInCircle",flush:"left"},_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.addIntegrationTitle",{defaultMessage:"Add {resourceCountLabel}",values:{resourceCountLabel:i}}));const l=["cis_k8s","cis_eks"].includes(s.id)?te.g.ORCHESTRATOR_CLUSTER_NAME:te.g.CLOUD_ACCOUNT_NAME;return Object(j.jsx)(C.EuiButtonEmpty,{flush:"left",onClick:()=>{t({"rule.benchmark.id":s.id},[l])}},_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.accountsCountTitle",{defaultMessage:"{benchmarkEvaluation} {resourceCountLabel}",values:{benchmarkEvaluation:a,resourceCountLabel:i}}))}},{field:"score",name:_.i18n.translate("xpack.csp.benchmarks.benchmarksTable.score",{defaultMessage:"Compliance"}),dataType:"string",truncateText:!0,width:"7.5%","data-test-subj":"benchmark-table-column-compliance",render:e=>e.totalFindings>0?Object(j.jsx)(Xn,{totalPassed:null==e?void 0:e.totalPassed,totalFailed:null==e?void 0:e.totalFailed}):Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksTable.noFindingsScore",defaultMessage:"No Findings"})}],Lo=({benchmarks:e,pageIndex:t,pageSize:a,totalItemCount:s,loading:i,error:l,setQuery:r,noItemsMessage:o,sorting:u,...c})=>{const{getBenchmarkDynamicValues:d}=Po(),b=go(),p={pageIndex:Math.max(t-1,0),pageSize:a,totalItemCount:s},g=Object(n.useMemo)((()=>[...e].sort(((e,t)=>e.id.localeCompare(t.id)))),[e]);return l?Object(j.jsx)(Go,{error:l}):Object(j.jsx)(C.EuiBasicTable,{"data-test-subj":c["data-test-subj"],items:g,columns:Ao(d,b),itemId:e=>[e.id,e.version].join("/"),pagination:p,onChange:({page:e})=>{r({page:{...e,index:e.index+1}})},tableLayout:"fixed",loading:i,noItemsMessage:o,error:l})},zo=()=>{const{http:e}=Object(w.a)().services,t=I.pagePathGetters.integrations_all({searchTerm:F.t}).join("");return Object(j.jsx)(C.EuiButton,{"data-test-subj":"csp_add_integration",fill:!0,iconType:"plusInCircle",href:e.basePath.prepend(t)},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksPageHeader.addIntegrationButtonLabel",defaultMessage:"Add Integration"}))},Bo=({name:e})=>Object(j.jsx)("div",null,Object(j.jsx)(C.EuiSpacer,{size:"l"}),Object(j.jsx)(C.EuiText,null,Object(j.jsx)("strong",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.rulesNotFoundTitle",defaultMessage:"No benchmark rules found"}),e&&Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.integrationsNotFoundForNameTitle",defaultMessage:' for "{name}"',values:{name:e}}))),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(C.EuiText,null,Object(j.jsx)(C.EuiTextColor,{color:"subdued"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.rulesNotFoundWithFiltersTitle",defaultMessage:"We weren't able to find any benchmark rules with the above filters."}))),Object(j.jsx)(C.EuiSpacer,{size:"l"})),Uo=({pageCount:e,totalCount:t})=>Object(j.jsx)(C.EuiText,{size:"xs",style:{marginLeft:8}},Object(j.jsx)(C.EuiTextColor,{color:"subdued"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.benchmarks.totalIntegrationsCountMessage",defaultMessage:"Showing {pageCount} of {totalCount, plural, one {# benchmark} other {# benchmarks}}",values:{pageCount:e,totalCount:t}}))),Ho=({onSearch:e,isLoading:t})=>{const[a,s]=Object(n.useState)("");return Do()((()=>e(a)),300,[a]),Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end"}},Object(j.jsx)(C.EuiFieldSearch,{fullWidth:!0,onSearch:s,isLoading:t,placeholder:_.i18n.translate("xpack.csp.benchmarks.benchmarkSearchField.searchPlaceholder",{defaultMessage:"Search by Benchmark Name"}),incremental:!0})))},Wo=()=>{var e,t,a,s,i,r,o;const{pageSize:u,setPageSize:c}=xt(te.m),[d,b]=Object(n.useState)({name:"",page:1,perPage:u,sortField:"package_policy.name",sortOrder:"asc"}),p=V(),g=d.name.toLowerCase(),m=(null===(e=p.data)||void 0===e?void 0:e.items.filter((e=>{var t;return null===(t=Object(At.f)(e.id))||void 0===t?void 0:t.toLowerCase().includes(g)})))||[],x=(null===(t=p.data)||void 0===t?void 0:t.items.length)||0,f=M({refetchInterval:te.r}),h="not-installed"===(null===(a=f.data)||void 0===a||null===(s=a.kspm)||void 0===s?void 0:s.status)&&"not-installed"===(null===(i=f.data)||void 0===i||null===(r=i.cspm)||void 0===r?void 0:r.status);return Object(j.jsx)($,null,Object(j.jsx)(C.EuiPageHeader,{"data-test-subj":"benchmarks-page-header",pageTitle:Object(j.jsx)(zr,{title:_.i18n.translate("xpack.csp.benchmarks.benchmarksPageHeader.benchmarksTitle",{defaultMessage:"Benchmarks"})}),rightSideItems:[Object(j.jsx)(zo,null)],bottomBorder:!0}),Object(j.jsx)(C.EuiSpacer,null),h?Object(j.jsx)(ue,{postureType:"all"}):Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(Ho,{isLoading:p.isFetching,onSearch:e=>b((t=>({...t,name:e})))}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Uo,{pageCount:((null===(o=p.data)||void 0===o?void 0:o.items)||[]).length,totalCount:x}),Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(Lo,{benchmarks:m,"data-test-subj":"csp_benchmarks_table",error:p.error?Object(At.d)(p.error):void 0,loading:p.isFetching,pageIndex:d.page,pageSize:u||d.perPage,sorting:{sort:{field:d.sortField,direction:d.sortOrder},allowNeutralSort:!1},totalItemCount:x,setQuery:({page:e,sort:t})=>{c(e.size),b((a=>({...a,page:e.index,perPage:e.size,sortField:(null==t?void 0:t.field)||a.sortField,sortOrder:(null==t?void 0:t.direction)||a.sortOrder})))},noItemsMessage:p.isSuccess?Object(j.jsx)(Bo,{name:d.name}):void 0})))};var Qo=a(169),Zo=a.n(Qo);const Jo=({tooltipContent:e,columnName:t})=>Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)("span",null,t)),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiToolTip,{content:e},Object(j.jsx)(C.EuiIcon,{size:"m",color:"subdued",type:"iInCircle"})))),qo="csp_rules_table_row_item_name",Ko=["csp_rules_states_v1"],$o=()=>{const{http:e}=Object(L.useKibana)().services,t=Object(r.useQueryClient)();return Object(r.useMutation)({mutationFn:async t=>{await(null==e?void 0:e.post(F.w,{version:"1",body:JSON.stringify({action:t.newState,rules:t.ruleIds})}))},onMutate:async e=>{await t.cancelQueries(Ko);const a=t.getQueryData(Ko);return t.setQueryData(Ko,(t=>t?function(e,t){const a={};return e.ruleIds.forEach((s=>{const i=Object.keys(t).find((e=>t[e].rule_id===s.rule_id));if(i){const s={...t[i],muted:"mute"===e.newState};a[i]=s}})),{...t,...a}}(e,t):t)),{previousCspRules:a}},onSettled:()=>{t.invalidateQueries(P),t.invalidateQueries(Br),t.invalidateQueries(Ur),t.invalidateQueries(Ko)},onError:(e,a,s)=>{null!=s&&s.previousCspRules&&t.setQueryData(Ko,s.previousCspRules)}})},Yo=({setPagination:e,perPage:t,rules_page:a,page:s,total:i,loading:r,error:o,selectedRuleId:u,selectedRules:c,setSelectedRules:d,onRuleClick:b,onSortChange:p})=>{const{euiTheme:g}=Object(C.useEuiTheme)(),m={pageIndex:s,pageSize:t,totalItemCount:i,pageSizeOptions:[10,25,100]},[x,f]=Object(n.useState)("asc"),h={sort:{field:"metadata.benchmark.rule_number",direction:x}},[O,v]=Object(n.useState)(!1),{mutate:y}=$o(),{http:T,notifications:k,analytics:E,i18n:S,theme:F}=Object(w.a)().services;Object(n.useEffect)((()=>{c.length>=a.length&&a.length>0&&c.length>0?v(!0):v(!1)}),[a.length,c.length]);const M=Xo({mutateRulesStates:y,selectedRules:c,setSelectedRules:d,items:a,setIsAllRulesSelectedThisPage:v,isAllRulesSelectedThisPage:O,isCurrentPageRulesASubset:(e,t)=>{let a=0;const s=e.map((e=>e.metadata)),i=t.map((e=>e.metadata));for(;a<s.length;){if(!i.includes(s[a]))return!1;a++}return!0},onRuleClick:b,http:T,startServices:{notifications:k,analytics:E,i18n:S,theme:F}});return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiBasicTable,{"data-test-subj":"csp_rules_table",loading:r,error:o,items:a,columns:M,pagination:m,onChange:({page:t,sort:a})=>{t&&(t&&e({page:t.index,perPage:t.size}),a&&(f(a.direction),p(a.direction)))},itemId:e=>e.metadata.id,rowProps:e=>{var t,a,s;return{"data-test-subj":(s=null===(t=e.metadata)||void 0===t?void 0:t.id,`${qo}_${s}`),style:{background:(null===(a=e.metadata)||void 0===a?void 0:a.id)===u?g.colors.highlight:void 0}}},sorting:h}))},Xo=({mutateRulesStates:e,selectedRules:t,setSelectedRules:a,items:s,isAllRulesSelectedThisPage:i,isCurrentPageRulesASubset:n,onRuleClick:l,http:r,startServices:o})=>[{field:"action",name:Object(j.jsx)(C.EuiCheckbox,{id:"cloud-security-fields-selector-item-all",checked:n(s,t)&&i,onChange:()=>{const e=Object(u.uniqBy)([...t,...s],"metadata.id");return n(s,t)&&i?void a(t.filter((e=>!s.find((t=>{var a,s;return(null===(a=t.metadata)||void 0===a?void 0:a.id)===(null===(s=e.metadata)||void 0===s?void 0:s.id)}))))):void a(e)}}),width:"40px",sortable:!1,render:(e,s)=>{var i,n;return Object(j.jsx)(C.EuiCheckbox,{checked:t.some((e=>{var t,a;return(null===(t=e.metadata)||void 0===t?void 0:t.id)===(null===(a=s.metadata)||void 0===a?void 0:a.id)})),id:`cloud-security-fields-selector-item-${null===(i=s.metadata)||void 0===i?void 0:i.id}`,"data-test-subj":`cloud-security-fields-selector-item-${null===(n=s.metadata)||void 0===n?void 0:n.id}`,onChange:e=>{const i=e.target.checked;return a(i?[...t,s]:t.filter((e=>{var t,a;return(null===(t=e.metadata)||void 0===t?void 0:t.id)!==(null===(a=s.metadata)||void 0===a?void 0:a.id)})))}})}},{field:"metadata.benchmark.rule_number",name:_.i18n.translate("xpack.csp.rules.rulesTable.ruleNumberColumnLabel",{defaultMessage:"Rule Number"}),width:"120px",sortable:!0},{field:"metadata.name",name:_.i18n.translate("xpack.csp.rules.rulesTable.nameColumnLabel",{defaultMessage:"Name"}),width:"60%",truncateText:!0,render:(e,t)=>Object(j.jsx)(C.EuiButtonEmpty,{className:"eui-textTruncate",title:e,onClick:e=>{e.stopPropagation(),l(t.metadata.id)},"data-test-subj":qo},e)},{field:"metadata.section",name:_.i18n.translate("xpack.csp.rules.rulesTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),width:"24%"},{field:"metadata.name",name:Object(j.jsx)(Jo,{columnName:_.i18n.translate("xpack.csp.rules.rulesTable.enabledColumnLabel",{defaultMessage:"Enabled"}),tooltipContent:_.i18n.translate("xpack.csp.rules.rulesTable.enabledColumnTooltip",{defaultMessage:"Disabling a rule will also disable its associated detection rules and alerts. Enabling it again does not automatically re-enable them"})}),align:"right",width:"100px",truncateText:!0,render:(t,a)=>{const s={benchmark_id:null==a?void 0:a.metadata.benchmark.id,benchmark_version:null==a?void 0:a.metadata.benchmark.version,rule_number:null==a?void 0:a.metadata.benchmark.rule_number,rule_id:null==a?void 0:a.metadata.id},i="muted"===(null==a?void 0:a.state),n=i?"unmute":"mute";return Object(j.jsx)(C.EuiFlexGroup,{justifyContent:"flexEnd"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiSwitch,{className:"eui-textTruncate",checked:!i,onChange:async()=>{if(null!=a&&a.metadata.benchmark.rule_number){const t=(await bn(cn(a.metadata),{match:"all"},r)).total;e({newState:n,ruleIds:[s]}),ki(o,i,{numberOfRules:1,numberOfDetectionRules:t||0})}},"data-test-subj":"rules-row-enable-switch-button",label:"",compressed:!0})))}}],eu=e=>e.map((e=>e.key));var tu={name:"3s4yqf",styles:"width:400px"},au={name:"15fcrsh",styles:"border-radius:0px!important"},su={name:"asmvhr",styles:"max-width:186px"};const iu=({buttonLabel:e,buttonIconType:t,hideActiveOptionsNumber:a,id:s,limit:i,limitReachedMessage:r,onChange:o,options:u,selectedOptionKeys:c=[],renderOption:d,transparentBackground:b})=>{const[p,g]=Object(n.useState)(!1),m=!a,x=Boolean(i&&r&&c.length>=i),f=((e,t)=>e.map((({key:e,label:a})=>{const s={label:a,key:e};return t.includes(e)&&(s.checked="on"),s["data-test-subj"]=`options-filter-popover-item-${e.split(" ").join("-")}`,s})))(u,c);return Object(n.useEffect)((()=>{const e=c.filter((e=>u.some((({key:t})=>t===e))));Object(Ta.isEqual)(e,c)||o({filterId:s,selectedOptionKeys:e})}),[c,u,s,o]),Object(j.jsx)(C.EuiFilterGroup,{css:Object(j.css)(b&&"background-color: transparent;",";","")},Object(j.jsx)(C.EuiPopover,{ownFocus:!0,button:Object(j.jsx)(C.EuiFilterButton,{css:su,"data-test-subj":`options-filter-popover-button-${s}`,iconType:t||"arrowDown",onClick:()=>g((e=>!e)),isSelected:p,numFilters:m?f.length:void 0,hasActiveFilters:m?c.length>0:void 0,numActiveFilters:m?c.length:void 0,"aria-label":e},Object(j.jsx)(C.EuiText,{size:"s",className:"eui-textTruncate"},e)),isOpen:p,closePopover:()=>g(!1),panelPaddingSize:"none",repositionOnScroll:!0},x&&Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiHorizontalRule,{margin:"none"}),Object(j.jsx)(C.EuiCallOut,{title:r,color:"warning",size:"s","data-test-subj":"maximum-length-warning"}),Object(j.jsx)(C.EuiHorizontalRule,{margin:"none"})),Object(j.jsx)(C.EuiSelectable,{options:f,searchable:!0,searchProps:{placeholder:_.i18n.translate("xpack.csp.common.component.multiSelectFilter.searchWord",{defaultMessage:"Search "})+e,compressed:!1,"data-test-subj":`${s}-search-input`,css:au},emptyMessage:"empty",onChange:e=>{const t=(e=>e.filter((e=>"on"===e.checked)))(e);x&&i&&t.length>=i||o({filterId:s,selectedOptionKeys:eu(t)})},singleSelection:!1,renderOption:d},((e,t)=>Object(j.jsx)("div",{css:tu},Object(j.jsx)(C.EuiPopoverTitle,{paddingSize:"none"},t),e)))))};iu.displayName="MultiSelectFilter";var nu={name:"hrowf8",styles:"min-width:220px"},lu={name:"1adi3ip",styles:"min-width:160px"},ru={name:"1adi3ip",styles:"min-width:160px"};const ou=({search:e,searchValue:t,isSearching:a,totalRulesCount:s,pageSize:i,onSectionChange:l,onRuleNumberChange:r,sectionSelectOptions:o,ruleNumberSelectOptions:u,selectedRules:c,setEnabledDisabledItemsFilter:d,enabledDisabledItemsFilterState:b,setSelectAllRules:p,setSelectedRules:g})=>{const[m,x]=Object(n.useState)([]),[f,h]=Object(n.useState)([]),O=o.map((e=>({key:e,label:e}))),v=u.map((e=>({key:e,label:e})));return Object(j.jsx)(C.EuiFlexGroup,{direction:"column"},Object(j.jsx)(C.EuiFlexGroup,null,Object(j.jsx)(C.EuiFlexItem,{grow:1},Object(j.jsx)(uu,{isSearching:a,searchValue:t,search:e})),Object(j.jsx)(C.EuiFlexItem,{grow:0},Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s",direction:"row"},Object(j.jsx)(C.EuiFlexItem,{css:ru},Object(j.jsx)(iu,{buttonLabel:_.i18n.translate("xpack.csp.rules.rulesTableHeader.sectionSelectPlaceholder",{defaultMessage:"CIS Section"}),id:"cis-section-multi-select-filter",onChange:e=>{x([...null==e?void 0:e.selectedOptionKeys]),l(null!=e&&e.selectedOptionKeys?null==e?void 0:e.selectedOptionKeys:void 0)},options:O,selectedOptionKeys:m})),Object(j.jsx)(C.EuiFlexItem,{css:lu},Object(j.jsx)(iu,{buttonLabel:_.i18n.translate("xpack.csp.rules.rulesTableHeader.ruleNumberSelectPlaceholder",{defaultMessage:"Rule Number"}),id:"rule-number-multi-select-filter",onChange:e=>{h([...null==e?void 0:e.selectedOptionKeys]),r(null!=e&&e.selectedOptionKeys?null==e?void 0:e.selectedOptionKeys:void 0)},options:v,selectedOptionKeys:f})),Object(j.jsx)(C.EuiFlexItem,{css:nu},Object(j.jsx)(C.EuiFilterGroup,null,Object(j.jsx)(C.EuiFilterButton,{withNext:!0,hasActiveFilters:"enabled"===b,onClick:()=>{d("enabled"===b?"no-filter":"enabled")},"data-test-subj":"rules-enabled-filter"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.enabledRuleFilterButton",defaultMessage:"Enabled rules"})),Object(j.jsx)(C.EuiFilterButton,{hasActiveFilters:"disabled"===b,onClick:()=>{d("disabled"===b?"no-filter":"disabled")},"data-test-subj":"rules-disabled-filter"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.disabledRuleFilterButton",defaultMessage:"Disabled rules"}))))))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(du,{pageSize:i,total:s,selectedRules:c,setSelectAllRules:p,setSelectedRules:g})))},uu=({search:e,isSearching:t,searchValue:a})=>{const[s,i]=Object(n.useState)(a);return Do()((()=>e(s)),300,[s]),Object(j.jsx)("div",null,Object(j.jsx)(C.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end"}},Object(j.jsx)(C.EuiFieldSearch,{isLoading:t,placeholder:_.i18n.translate("xpack.csp.rules.rulesTable.searchPlaceholder",{defaultMessage:"Search by Rule Name"}),value:s,onChange:e=>i(e.target.value),style:{minWidth:150},fullWidth:!0})))};var cu={name:"1tvvdon",styles:"mid-width:540px"};const du=({pageSize:e,total:t,selectedRules:a,setSelectAllRules:s,setSelectedRules:i})=>{const[l,r]=Object(n.useState)(!1),{mutate:o}=$o(),{data:u}=dn((e=>{if(!e||!e.some((e=>e.benchmark))||!e.some((e=>e.benchmark.id)))return[];const t=e.map((e=>e.benchmark.id));if(0===t.length)return[];const a=t[0],s=e.map((e=>e.benchmark.rule_number));return 0===s.length?[]:s.map((e=>a.replace("_"," ").toUpperCase()+" "+e))})(a.map((e=>e.metadata))),{match:"any"}),{notifications:c,analytics:d,i18n:b,theme:p}=Object(w.a)().services,g={notifications:c,analytics:d,i18n:b,theme:p},m=async e=>{const t=a.map((e=>({benchmark_id:null==e?void 0:e.metadata.benchmark.id,benchmark_version:null==e?void 0:e.metadata.benchmark.version,rule_number:null==e?void 0:e.metadata.benchmark.rule_number,rule_id:null==e?void 0:e.metadata.id})));t.some((e=>void 0===e.rule_number))||(o({newState:e,ruleIds:t}),r(!1),ki(g,"mute"!==e,{numberOfRules:t.length,numberOfDetectionRules:(null==u?void 0:u.total)||0}))},x=a.every((e=>"muted"===(null==e?void 0:e.state))),f=a.every((e=>"unmuted"===(null==e?void 0:e.state))),h=Object(j.jsx)(C.EuiButtonEmpty,{onClick:()=>{r((e=>!e))},size:"xs",iconType:"arrowDown",iconSide:"right",css:Object(j.css)("padding-bottom:",Ae.euiThemeVars.euiSizeS,";",""),"data-test-subj":"bulk-action-button"},"Bulk actions"),O=[Object(j.jsx)(C.EuiContextMenuItem,{disabled:0===a.length||f,onClick:async()=>{await m("unmute"),i([])},"data-test-subj":"bulk-action-option-enable"},Object(j.jsx)(C.EuiText,{key:"disabled"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.optionEnable",defaultMessage:"Enable"}))),Object(j.jsx)(C.EuiContextMenuItem,{disabled:0===a.length||x,onClick:async()=>{await m("mute"),i([])},"data-test-subj":"bulk-action-option-disable"},Object(j.jsx)(C.EuiText,null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.optionDisable",defaultMessage:"Disable"})))];return Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiSpacer,{size:"s"}),Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiText,{size:"xs",textAlign:"left",color:"subdued",style:{marginLeft:"8px"}},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.showingPageOfTotalLabel",defaultMessage:"Showing {pageSize} of {total, plural, one {# rule} other {# rules}} {pipe} Selected {selectedRulesAmount, plural, one {# rule} other {# rules}}",values:{pageSize:e,total:t,selectedRulesAmount:a.length||0,pipe:"|"}}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},a.length!==t?Object(j.jsx)(C.EuiButtonEmpty,{onClick:s,size:"xs",iconType:"pagesSelect",css:Object(j.css)("padding-bottom:",Ae.euiThemeVars.euiSizeS,";",""),"data-test-subj":"select-all-rules-button"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.selectAllRulesOption",defaultMessage:"Select All {total, plural, one {# rule} other {# rules}}",values:{total:t}})):Object(j.jsx)(C.EuiButtonEmpty,{onClick:()=>i([]),size:"xs",iconType:"cross",css:Object(j.css)("padding-bottom:",Ae.euiThemeVars.euiSizeS,";",""),"data-test-subj":"clear-rules-selection-button"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.clearSelectionOption",defaultMessage:"Clear selection"}))),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiPopover,{button:h,isOpen:l,closePopover:()=>r(!1),anchorPosition:"downLeft",panelPaddingSize:"s"},Object(j.jsx)(C.EuiPopoverTitle,{style:{minWidth:240}},Object(j.jsx)(C.EuiText,{size:"s",textAlign:"left",color:"subdued",style:{marginLeft:"8px"}},Object(j.jsx)("b",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesTable.bulkActionsOptionTitle",defaultMessage:"Options"})))),Object(j.jsx)(C.EuiContextMenuPanel,{size:"s",items:O,css:cu})))))},bu=({search:e,page:t,perPage:a,section:s,ruleNumber:i,sortField:n,sortOrder:l},o,u)=>{const{http:c}=Object(w.a)().services;return Object(r.useQuery)([F.x,{section:s,search:e,page:t,perPage:a,benchmarkId:o,benchmarkVersion:u,ruleNumber:i,sortField:n,sortOrder:l}],(()=>c.get(F.F,{query:{benchmarkId:o,page:t,perPage:a,search:e,section:s,benchmarkVersion:u,ruleNumber:i,sortField:n,sortOrder:l},version:"3"})))},pu=[{label:_.i18n.translate("xpack.csp.rules.ruleFlyout.overviewTabLabel",{defaultMessage:"Overview"}),id:"overview",disabled:!1},{label:_.i18n.translate("xpack.csp.rules.ruleFlyout.remediationTabLabel",{defaultMessage:"Remediation"}),id:"remediation",disabled:!1}],gu=({onClose:e,rule:t})=>{const[a,s]=Object(n.useState)("overview"),{mutate:i}=$o(),{data:l}=dn(cn(t.metadata)),{notifications:r,analytics:o,i18n:u,theme:c}=Object(w.a)().services,d={notifications:r,analytics:o,i18n:u,theme:c},b="muted"===(null==t?void 0:t.state),p=async()=>{if(t.metadata.benchmark.rule_number){const e={benchmark_id:t.metadata.benchmark.id,benchmark_version:t.metadata.benchmark.version,rule_number:t.metadata.benchmark.rule_number,rule_id:t.metadata.id},a=b?"unmute":"mute";await i({newState:a,ruleIds:[e]}),ki(d,b,{numberOfRules:1,numberOfDetectionRules:(null==l?void 0:l.total)||0})}},g=async e=>await hn(e,t.metadata);return Object(j.jsx)(C.EuiFlyout,{onClose:e,"data-test-subj":"csp_rules_flyout_container",outsideClickCloses:!0},Object(j.jsx)(C.EuiFlyoutHeader,null,Object(j.jsx)(C.EuiTitle,{size:"l"},Object(j.jsx)("h2",null,t.metadata.name)),Object(j.jsx)(C.EuiTabs,null,pu.map((e=>Object(j.jsx)(C.EuiTab,{key:e.id,isSelected:a===e.id,onClick:()=>s(e.id),disabled:e.disabled},e.label))))),Object(j.jsx)(C.EuiFlyoutBody,null,"overview"===a&&Object(j.jsx)(mu,{rule:t.metadata,ruleData:t,switchRuleStates:p}),"remediation"===a&&Object(j.jsx)(C.EuiDescriptionList,{compressed:!1,listItems:yn(t.metadata)})),Object(j.jsx)(C.EuiFlyoutFooter,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"none",direction:"rowReverse"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},b?Object(j.jsx)(Ci,{enableBenchmarkRuleFn:p,createRuleFn:g,isCreateDetectionRuleDisabled:!0}):Object(j.jsx)(Ci,{disableBenchmarkRuleFn:p,createRuleFn:g,isCreateDetectionRuleDisabled:!1})))))},mu=({rule:e,ruleData:t,switchRuleStates:a})=>Object(j.jsx)(C.EuiFlexGroup,{direction:"column"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiDescriptionList,{listItems:[...xu(t,a),...En(e,t.state)]})));var ju={name:"1iink7o",styles:".euiToolTipAnchor{display:flex;}"};const xu=(e,t)=>[{title:Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesFlyout.ruleStateSwitchTitle",defaultMessage:"Enabled"})),Object(j.jsx)(C.EuiFlexItem,{grow:!1,css:ju},Object(j.jsx)(C.EuiToolTip,{content:_.i18n.translate("xpack.csp.rules.rulesFlyout.ruleStateSwitchTooltip",{defaultMessage:"Disabling a rule will also disable its associated detection rules and alerts. Enabling it again does not automatically re-enable them"})},Object(j.jsx)(C.EuiIcon,{size:"m",color:"subdued",type:"iInCircle"})))),description:Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiSwitch,{className:"eui-textTruncate",checked:"muted"!==(null==e?void 0:e.state),onChange:t,"data-test-subj":"rule-flyout-switch-button",label:" "}))}],fu=({failed:e,passed:t})=>{const{services:{charts:a}}=Object(w.a)();return Object(j.jsx)(Yr.Chart,{size:{height:30,width:30}},Object(j.jsx)(Yr.Settings,{theme:[{partition:{outerSizeRatio:.75,emptySizeRatio:.7}}],baseTheme:a.theme.useChartsBaseTheme()}),Object(j.jsx)(Yr.Partition,{id:"evaluation-pie-chart",data:[{label:_.i18n.translate("xpack.csp.rulesPage.evaluationPieChart.failedTitle",{defaultMessage:"Failed"}),value:e},{label:_.i18n.translate("xpack.csp.rulesPage.evaluationPieChart.passedTitle",{defaultMessage:"Passed"}),value:t}],valueGetter:"percent",valueAccessor:e=>e.value,layout:Yr.PartitionLayout.sunburst,layers:[{groupByRollup:e=>e.label,shape:{fillColor:e=>e.toLowerCase()===F.R.toLowerCase()?te.w.passed:te.w.failed}}]}))},hu=({mutedRulesCount:e,setEnabledDisabledItemsFilter:t})=>{var a;const{http:s}=Object(w.a)().services,{getBenchmarkDynamicValues:i}=Po(),n=Object(o.useParams)(),r=V(),u=go(),c=null===(a=r.data)||void 0===a?void 0:a.items.find((e=>e.id===n.benchmarkId&&e.version===n.benchmarkVersion));if(!c)return Object(j.jsx)(l.a.Fragment,null);const d=i(c.id);if(0===c.score.totalFindings)return Object(j.jsx)(C.EuiEmptyPrompt,{"data-test-subj":"rules-counters-empty-state",color:"plain",icon:Object(j.jsx)(C.EuiImage,{size:"fullWidth",src:X.a,alt:_.i18n.translate("xpack.csp.rulesPage.rulesCounterEmptyState.noDataIllustrationAlt",{defaultMessage:"No data illustration"})}),title:Object(j.jsx)("h2",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rulesPage.rulesCounterEmptyState.emptyStateTitle",defaultMessage:"Add {integrationResourceName} to get started",values:{integrationResourceName:`${d.integrationName}\n                  ${d.resourceName}`}})),body:Object(j.jsx)("p",null,Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rulesPage.rulesCounterEmptyState.emptyStateDescription",defaultMessage:"Add your {resourceName} in {integrationType} to begin detecing misconfigurations",values:{resourceName:d.resourceName.toLowerCase(),integrationType:d.integrationType}})),actions:[Object(j.jsx)(C.EuiButton,{color:"primary",fill:!0,href:d.integrationLink},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rulesPage.rulesCounterEmptyState.emptyPrimapryButtonTitle",defaultMessage:"Add {integrationType} integration",values:{integrationType:d.integrationType}})),Object(j.jsx)(C.EuiButtonEmpty,{color:"primary",href:d.learnMoreLink,target:"_blank"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rulesPage.rulesCounterEmptyState.emptyLearnMoreButtonTitle",defaultMessage:"Learn more"}))],layout:"horizontal",paddingSize:"m"});const b=[{id:"rules-counters-posture-score-counter",description:_.i18n.translate("xpack.csp.rulesCounters.postureScoreTitle",{defaultMessage:"Posture Score"}),title:Object(j.jsx)(C.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(fu,{failed:c.score.totalFailed,passed:c.score.totalPassed})),Object(j.jsx)(C.EuiFlexItem,null,so(c.score.postureScore))),button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"rules-counters-posture-score-button",iconType:"pivot",href:s.basePath.prepend(`/app/security${O.c.dashboard.path}`)},_.i18n.translate("xpack.csp.rulesCounters.postureScoreButton",{defaultMessage:"Dashboard"}))},{id:"rules-counters-integrations-evaluated-counter",description:_.i18n.translate("xpack.csp.rulesCounters.accountsEvaluatedTitle",{defaultMessage:"{resourceName} Evaluated",values:{resourceName:d.resourceName}}),title:c.evaluation||0,button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"rules-counters-integrations-evaluated-button",iconType:"listAdd",href:d.integrationLink},_.i18n.translate("xpack.csp.rulesCounters.accountsEvaluatedButton",{defaultMessage:"Add more {resourceName}",values:{resourceName:d.resourceName.toLowerCase()}}))},{id:"rules-counters-failed-findings-counter",description:_.i18n.translate("xpack.csp.rulesCounters.failedFindingsTitle",{defaultMessage:"Failed Findings"}),title:c.score.totalFailed,titleColor:c.score.totalFailed>0?te.w.failed:void 0,button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"rules-counters-failed-findings-button",iconType:"pivot",onClick:()=>u({"result.evaluation":F.Q,"rule.benchmark.id":c.id||"","rule.benchmark.version":`v${c.version}`})},_.i18n.translate("xpack.csp.rulesCounters.failedFindingsButton",{defaultMessage:"View all failed findings"}))},{id:"rules-counters-disabled-rules-counter",description:_.i18n.translate("xpack.csp.rulesCounters.disabledRulesCounterTitle",{defaultMessage:"Disabled Rules"}),title:e,button:Object(j.jsx)(C.EuiButtonEmpty,{"data-test-subj":"rules-counters-disabled-rules-button",iconType:"search",onClick:()=>t("disabled")},_.i18n.translate("xpack.csp.rulesCounters.disabledRulesCounterButton",{defaultMessage:"View all disabled rules"}))}];return Object(j.jsx)(C.EuiFlexGroup,null,b.map((e=>Object(j.jsx)(C.EuiFlexItem,{key:e.id},Object(j.jsx)(Zr,e)))))},Ou=()=>{var e,t,a,s;const i=Object(o.useParams)(),l=Object(o.useHistory)(),[u,c]=Object(n.useState)("no-filter"),{pageSize:d,setPageSize:b}=xt(te.n),p=bu({page:1,perPage:1e4,sortField:"metadata.benchmark.rule_number",sortOrder:"asc"},i.benchmarkId,i.benchmarkVersion),[g,m]=Object(n.useState)({section:void 0,ruleNumber:void 0,search:"",page:0,perPage:d||10,sortField:"metadata.benchmark.rule_number",sortOrder:"asc"});Object(n.useEffect)((()=>{m({...g,page:(()=>{var e;if(i.ruleId&&null!==(e=p.data)&&void 0!==e&&e.items){const e=p.data.items.findIndex((e=>e.metadata.id===i.ruleId));if(-1!==e)return Math.floor(e/d)}return 0})()})}),[null===(e=p.data)||void 0===e?void 0:e.items]);const{data:x,status:f,error:h}=bu({section:g.section,ruleNumber:g.ruleNumber,search:g.search,page:1,perPage:1e4,sortField:"metadata.benchmark.rule_number",sortOrder:g.sortOrder},i.benchmarkId,i.benchmarkVersion),v=(()=>{const{http:e}=Object(w.a)().services;return Object(r.useQuery)(Ko,(()=>e.get(F.z,{version:"1"})),{keepPreviousData:!0})})(),y=Object.values(v.data||{}),T=Object(n.useMemo)((()=>x?x.items.filter((e=>void 0!==e.metadata.benchmark.rule_number)).map((e=>{var t;const a=`${e.metadata.benchmark.id};${e.metadata.benchmark.version};${e.metadata.benchmark.rule_number}`;const s=null==v||null===(t=v.data)||void 0===t?void 0:t[a],i=null!=s&&s.muted?"muted":"unmuted";return{...e,state:i||"unmuted"}})):[]),[x,null==v?void 0:v.data]),k=T.filter((e=>"muted"===e.state)).length,E=Object(n.useMemo)((()=>"disabled"===u?null==T?void 0:T.filter((e=>"muted"===(null==e?void 0:e.state))):"enabled"===u?null==T?void 0:T.filter((e=>"unmuted"===(null==e?void 0:e.state))):T),[T,u]),S=Object(n.useMemo)((()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.items.map((e=>e.metadata.section))}),[p.data]),M=Object(n.useMemo)((()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.items.map((e=>e.metadata.benchmark.rule_number||""))}),[p.data]),_=[...new Set(S)].sort(((e,t)=>e.localeCompare(t,"en",{sensitivity:"base"}))),R=[...new Set(M)].sort(Zo.a),I=Object(n.useMemo)((()=>((e,t,a,s)=>{const i=((e,{page:t,perPage:a})=>e.slice(t*a,(t+1)*a))(e,s);return{loading:"loading"===t,error:a?Object(At.d)(a):void 0,all_rules:e,rules_map:new Map(e.map((e=>[e.metadata.id,e]))),rules_page:i,total:(null==e?void 0:e.length)||0}})(E,f,h,g)),[E,f,h,g]),[N,D]=Object(n.useState)([]),P={state:!0===(null===(t=y.find((e=>e.rule_id===i.ruleId)))||void 0===t?void 0:t.muted)?"muted":"unmuted",metadata:null===(a=p.data)||void 0===a||null===(s=a.items.find((e=>e.metadata.id===i.ruleId)))||void 0===s?void 0:s.metadata};return Object(j.jsx)("div",{"data-test-subj":"csp_rules_container"},Object(j.jsx)(hu,{mutedRulesCount:k,setEnabledDisabledItemsFilter:c}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(ou,{onSectionChange:e=>m((t=>({...t,section:e}))),onRuleNumberChange:e=>m((t=>({...t,ruleNumber:e}))),sectionSelectOptions:_,ruleNumberSelectOptions:R,search:e=>m((t=>({...t,search:e}))),searchValue:g.search||"",totalRulesCount:I.all_rules.length,pageSize:I.rules_page.length,isSearching:"loading"===f,selectedRules:N,setEnabledDisabledItemsFilter:c,enabledDisabledItemsFilterState:u,setSelectAllRules:()=>{D(I.all_rules)},setSelectedRules:D}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Yo,{onSortChange:e=>m((t=>({...t,sortOrder:e}))),rules_page:I.rules_page,total:I.total,error:I.error,loading:I.loading,perPage:d||g.perPage,page:g.page,setPagination:e=>{b(e.perPage),m((t=>({...t,...e})))},selectedRuleId:i.ruleId,onRuleClick:e=>{l.push(Object(o.generatePath)(O.b.rules.path,{benchmarkVersion:i.benchmarkVersion,benchmarkId:i.benchmarkId,ruleId:e}))},selectedRules:N,setSelectedRules:D}),i.ruleId&&P.metadata&&Object(j.jsx)(gu,{rule:P,onClose:()=>{l.push(Object(o.generatePath)(O.b.rules.path,{benchmarkVersion:i.benchmarkVersion,benchmarkId:i.benchmarkId}))}}))},vu=({match:{params:e}})=>{var t;const a=V(),s=null===(t=y())||void 0===t?void 0:t.getSpyRouteComponent();return Object(j.jsx)($,{query:a},Object(j.jsx)(C.EuiPageHeader,{alignItems:"bottom",bottomBorder:!0,pageTitle:Object(j.jsx)(C.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(j.jsx)(C.EuiFlexItem,{style:{width:"fit-content"}},Object(j.jsx)(o.Link,{to:Object(o.generatePath)(O.c.benchmarks.path)},Object(j.jsx)(C.EuiButtonEmpty,{iconType:"arrowLeft",contentProps:{style:{padding:0}}},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.rules.rulesPageHeader.benchmarkRulesButtonLabel",defaultMessage:"Benchmarks"})))),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiFlexGroup,{gutterSize:"s"},Object(j.jsx)(C.EuiFlexItem,{grow:!1,style:{marginBottom:6}},Object(j.jsx)(In,{type:e.benchmarkId,size:"l"})),Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(zr,{title:_.i18n.translate("xpack.csp.rules.rulePageHeader.pageHeaderTitle",{defaultMessage:"{benchmarkName} {benchmarkVersion} - Rules",values:{benchmarkName:Object(At.f)(e.benchmarkId),benchmarkVersion:e.benchmarkVersion}})})))))}),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Ou,null),s&&Object(j.jsx)(s,{pageName:O.c.benchmarks.id,state:{ruleName:Object(At.f)(e.benchmarkId)}}))},yu=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(["use-vulnerability-dashboard-api-key"],(()=>t.get(F.ab)),e)},Tu=[F.db.CRITICAL,F.db.HIGH,F.db.MEDIUM,F.db.LOW],ku="all",Cu={width:"100%",height:300},Eu={scales:{barsPadding:.05},legend:{spacingBuffer:45}},Su=()=>{const e=mo();return Object(j.jsx)(C.EuiButton,{onClick:()=>e(),size:"s"},Object(j.jsx)(E.FormattedMessage,{id:"xpack.csp.vulnerabilityDashboard.viewAllButton.buttonTitle",defaultMessage:"View All"}))},Fu=({selectedAccount:e,setSelectedAccount:t,options:a=[]})=>Object(j.jsx)(C.EuiComboBox,{style:{width:320},compressed:!0,prepend:_.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.accountsDropDown.prepend.accountsTitle",{defaultMessage:"Accounts"}),options:a,singleSelection:{asPlainText:!0},isClearable:!1,selectedOptions:a.filter((t=>t.value===e)),onChange:e=>{t(e[0].value||ku)}}),wu=e=>{const t=[];return e.forEach((e=>{Object.values(e.vulnerabilities_stats_by_cloud_account||{}).forEach((e=>{t.find((t=>t.value===e.cloudAccountId))||t.push({label:e.cloudAccountName,value:e.cloudAccountId})}))})),t.unshift({label:_.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.accountsDropDown.option.allTitle",{defaultMessage:"All"}),value:ku}),t},Mu=()=>{var e;const{services:{charts:t}}=Object(w.a)(),a=(null===(e=yu().data)||void 0===e?void 0:e.vulnTrends)||[],[s,i]=Object(n.useState)(ku),l=((e,t)=>t===ku?e.map((e=>{const{vulnerabilities_stats_by_cloud_account:t,policy_template:a,...s}=e;return s})):e.map((e=>{var a;const s=null===(a=e.vulnerabilities_stats_by_cloud_account)||void 0===a?void 0:a[t];if(s)return{"@timestamp":e["@timestamp"],...s}})).filter(At.i))(a,s),r=Object(n.useMemo)((()=>[{id:F.db.LOW,yAccessors:["low"],color:Nl(F.db.LOW)},{id:F.db.MEDIUM,yAccessors:["medium"],color:Nl(F.db.MEDIUM)},{id:F.db.HIGH,yAccessors:["high"],color:Nl(F.db.HIGH)},{id:F.db.CRITICAL,yAccessors:["critical"],color:Nl(F.db.CRITICAL)}]),[]);return Object(j.jsx)($r,{title:_.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.trendBySeverityTitle",{defaultMessage:"Trend by severity"}),rightSideItems:[Object(j.jsx)(Fu,{key:"vulnerability-trend-graph-account-drop-down",options:wu(a),selectedAccount:s,setSelectedAccount:i}),Object(j.jsx)(Su,{key:"vulnerability-trend-graph-view-all-button"})]},Object(j.jsx)("div",{style:Cu},Object(j.jsx)(Yr.Chart,null,Object(j.jsx)(Yr.Settings,{baseTheme:t.theme.useChartsBaseTheme(),legendPosition:"right",showLegend:!0,theme:Eu,locale:_.i18n.getLocale()}),Object(j.jsx)(Yr.Axis,{id:"bottom",position:"bottom",tickFormat:Object(Yr.timeFormatter)(Object(Yr.niceTimeFormatByDay)(2))}),Object(j.jsx)(Yr.Axis,{id:"left",position:"left",tickFormat:e=>e.toLocaleString()}),r.map((e=>Object(j.jsx)(Yr.BarSeries,{key:e.id,id:e.id,xAccessor:"@timestamp",yAccessors:e.yAccessors,stackAccessors:Tu,data:l,color:e.color,minBarHeight:5,barSeriesStyle:{rect:{widthPixel:l.length<25?50:void 0}}}))))))},_u=({id:e,title:t,titleColor:a,description:s,onClick:i})=>{const{euiTheme:n}=Object(C.useEuiTheme)();return Object(j.jsx)(C.EuiPanel,{hasBorder:!0,onClick:i,paddingSize:"m",css:Object(j.css)("position:relative;display:flex;align-items:center;:hover .euiIcon{color:",n.colors.primary,";transition:",n.animation.normal,";}",""),"data-test-subj":e},Object(j.jsx)(C.EuiStat,{css:Object(j.css)({height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-around",".euiText h6":{textTransform:"capitalize",fontSize:n.size.m}},"",""),titleSize:"s",title:t,titleColor:a,descriptionElement:"h6",description:s}),i&&Object(j.jsx)(C.EuiIcon,{type:"pivot",css:Object(j.css)("color:",n.colors.lightShade,";position:absolute;top:",n.size.s,";right:",n.size.s,";","")}))},Ru=()=>{const e=mo(),t=yu(),a=Object(n.useMemo)((()=>{var a,s,i,n,l;return[{id:"critical-count-stat",title:Object(j.jsx)(Jr,{number:null===(a=t.data)||void 0===a?void 0:a.cnvmStatistics.criticalCount}),description:Object(j.jsx)(C.EuiHealth,{color:Nl(F.db.CRITICAL),textSize:"xs"},_.i18n.translate("xpack.csp.cnvmDashboard.statistics.criticalTitle",{defaultMessage:"Critical"})),onClick:()=>{e({"vulnerability.severity":F.db.CRITICAL})}},{id:"high-count-stat",title:Object(j.jsx)(Jr,{number:null===(s=t.data)||void 0===s?void 0:s.cnvmStatistics.highCount}),description:Object(j.jsx)(C.EuiHealth,{color:Nl(F.db.HIGH),textSize:"xs"},_.i18n.translate("xpack.csp.cnvmDashboard.statistics.highTitle",{defaultMessage:"High"})),onClick:()=>{e({"vulnerability.severity":F.db.HIGH})}},{id:"medium-count-stat",title:Object(j.jsx)(Jr,{number:null===(i=t.data)||void 0===i?void 0:i.cnvmStatistics.mediumCount}),description:Object(j.jsx)(C.EuiHealth,{color:Nl(F.db.MEDIUM),textSize:"xs"},_.i18n.translate("xpack.csp.cnvmDashboard.statistics.mediumTitle",{defaultMessage:"Medium"})),onClick:()=>{e({"vulnerability.severity":F.db.MEDIUM})}},{id:"cloud-regions-stat",title:Object(j.jsx)(Jr,{number:null===(n=t.data)||void 0===n?void 0:n.cnvmStatistics.cloudAccounts}),description:_.i18n.translate("xpack.csp.cnvmDashboard.statistics.cloudRegionTitle",{defaultMessage:"Cloud Accounts"})},{id:"assets-scanned-stat",title:Object(j.jsx)(Jr,{number:null===(l=t.data)||void 0===l?void 0:l.cnvmStatistics.resourcesScanned}),description:_.i18n.translate("xpack.csp.cnvmDashboard.statistics.resourcesScannedTitle",{defaultMessage:"Resources Scanned"})}]}),[t.data,e]);return Object(j.jsx)(C.EuiFlexGroup,null,a.map((e=>Object(j.jsx)(C.EuiFlexItem,{key:e.id},Object(j.jsx)(_u,e)))))};let Iu=function(e){return e.TOP_VULNERABLE_RESOURCES="topVulnerableResources",e.TOP_PATCH_VULNERABILITIES="topPatchVulnerabilities",e.TOP_VULNERABILITIES="topVulnerabilities",e}({});const Nu={[Iu.TOP_VULNERABLE_RESOURCES]:{title:_.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topVulnerableResources.title",{defaultMessage:"Top 10 vulnerable resources"}),viewAllLinkText:_.i18n.translate("xpack.csp.vulnerabilityTable.panel.allVulnerableResourcesLinkText",{defaultMessage:"View all vulnerable resources"})},[Iu.TOP_PATCH_VULNERABILITIES]:{title:_.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topPatchVulnerabilities.title",{defaultMessage:"Top 10 patchable vulnerabilities"}),viewAllLinkText:_.i18n.translate("xpack.csp.vulnerabilityTable.panel.allPatchableVulnerabilitiesLinkText",{defaultMessage:"View all patchable vulnerabilities"})},[Iu.TOP_VULNERABILITIES]:{title:_.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topVulnerabilities.title",{defaultMessage:"Top 10 vulnerabilities"}),viewAllLinkText:_.i18n.translate("xpack.csp.vulnerabilityTable.panel.buttonText",{defaultMessage:"View all vulnerabilities"})}};var Du={name:"1tjylrs",styles:"width:fit-content"};const Pu=({items:e,columns:t,tableType:a,onViewVulnerabilitiesClick:s})=>{const{euiTheme:i}=Object(C.useEuiTheme)(),{title:n,viewAllLinkText:l}=Nu[a];return Object(j.jsx)($r,{title:n},Object(j.jsx)(C.EuiFlexGroup,{direction:"column","justify-content":"space-between"},Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(C.EuiBasicTable,{className:"vulnerabilityTable",css:Object(j.css)("& .euiTableHeaderCell{border-bottom:",i.border.width.thick," solid ",i.colors.darkestShade,";}",""),items:e,columns:t}),Object(j.jsx)(C.EuiSpacer,{size:"s"})),Object(j.jsx)(C.EuiFlexItem,{grow:!1},Object(j.jsx)(C.EuiButtonEmpty,{css:Du,iconType:"search",onClick:s,size:"s"},l))))},Vu=()=>{var e,t,a,s,i,r,o,u,c;const d=yu(),{euiTheme:b}=Object(C.useEuiTheme)(),p=mo(),g=Object(n.useCallback)((e=>{p(e,[te.u.NONE])}),[p]),m=Object(n.useCallback)((()=>{p({},[te.u.RESOURCE_ID])}),[p]),x=Object(n.useCallback)((()=>{p({[te.t.PACKAGE_FIXED_VERSION]:"*"},[te.u.NONE])}),[p]),f=Object(n.useCallback)((()=>{p({},[te.u.NONE])}),[p]),h=Object(n.useMemo)((()=>[{field:"resource.id",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.resourceId",{defaultMessage:"Resource ID"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"resource.id":e}),className:"eui-textTruncate"},e)},{field:"resource.name",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.resourceName",{defaultMessage:"Resource Name"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"resource.name":e}),className:"eui-textTruncate",color:"text"},e)},{field:"cloudRegion",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.region",{defaultMessage:"Region"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"cloud.region":e}),className:"eui-textTruncate",color:"text"},e),width:"140"},{field:"vulnerabilityCount",name:Object(j.jsx)("span",null,Object(j.jsx)(C.EuiIcon,{type:"sortDown",style:{marginRight:b.size.xs}}),_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.vulnerabilities",{defaultMessage:"Vulnerabilities"})),width:"120",align:"right"}]),[g,b.size.xs]),O=Object(n.useMemo)((()=>[{field:"cve",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.cve",{defaultMessage:"CVE"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"vulnerability.id":e,"package.fixed_version":"*"}),className:"eui-textTruncate"},e)},{field:"cvss",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.version",{defaultMessage:"CVSS"}),render:e=>{if(!e.score||!e.version)return null;const t={"vulnerability.score.base":e.score};return Object(j.jsx)(C.EuiLink,{onClick:()=>g(t)},Object(j.jsx)(Vl,{version:e.version,score:e.score}))}},{field:"packageFixVersion",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topPatchableVulnerabilities.column.fixedVersion",{defaultMessage:"Fix Version"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"package.fixed_version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"vulnerabilityCount",name:Object(j.jsx)("span",null,Object(j.jsx)(C.EuiIcon,{type:"sortDown",style:{marginRight:b.size.xs}}),_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.vulnerabilityCount",{defaultMessage:"Vulnerabilities"})),align:"right"}]),[g,b.size.xs]),v=Object(n.useMemo)((()=>[{field:"cve",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.cve",{defaultMessage:"CVE"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"vulnerability.id":e}),className:"eui-textTruncate"},e)},{field:"cvss",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.version",{defaultMessage:"CVSS"}),render:e=>{if(!e.score||!e.version)return null;const t={"vulnerability.score.base":e.score};return Object(j.jsx)(C.EuiLink,{onClick:()=>g(t)},Object(j.jsx)(Vl,{version:e.version,score:e.score}))}},{field:"severity",name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.severity",{defaultMessage:"Severity"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"vulnerability.severity":e}),color:"text"},Object(j.jsx)(Al,{severity:e}))},{field:"packageName",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.packageName",{defaultMessage:"Package Name"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"package.name":e}),className:"eui-textTruncate",color:"text"},e)},{field:"packageVersion",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.packageVersion",{defaultMessage:"Package Version"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"package.version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"packageFixVersion",truncateText:!0,name:_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.fixedVersion",{defaultMessage:"Fix Version"}),render:e=>Object(j.jsx)(C.EuiLink,{onClick:()=>g({"package.fixed_version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"vulnerabilityCount",name:Object(j.jsx)("span",null,Object(j.jsx)(C.EuiIcon,{type:"sortDown",style:{marginRight:b.size.xs}}),_.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.vulnerabilities",{defaultMessage:"Vulnerabilities"})),align:"right"}]),[g,b.size.xs]);return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(C.EuiFlexGroup,{direction:"row"},!(null===(e=d.data)||void 0===e||null===(t=e.topVulnerableResources)||void 0===t||!t.length)&&Object(j.jsx)(C.EuiFlexItem,null,Object(j.jsx)(Pu,{items:null===(a=d.data)||void 0===a?void 0:a.topVulnerableResources,columns:h,tableType:Iu.TOP_VULNERABLE_RESOURCES,onViewVulnerabilitiesClick:m})),Object(j.jsx)(C.EuiFlexItem,null,!(null===(s=d.data)||void 0===s||null===(i=s.topPatchableVulnerabilities)||void 0===i||!i.length)&&Object(j.jsx)(Pu,{items:null===(r=d.data)||void 0===r?void 0:r.topPatchableVulnerabilities,columns:O,tableType:Iu.TOP_PATCH_VULNERABILITIES,onViewVulnerabilitiesClick:x}))),Object(j.jsx)(C.EuiSpacer,null),!(null===(o=d.data)||void 0===o||null===(u=o.topVulnerabilities)||void 0===u||!u.length)&&Object(j.jsx)(Pu,{items:null===(c=d.data)||void 0===c?void 0:c.topVulnerabilities,columns:v,tableType:Iu.TOP_VULNERABILITIES,onViewVulnerabilitiesClick:f}))},Gu=()=>{var e,t;const a=M(),s=yu();return Object(j.jsx)($,{query:a},Object(j.jsx)(C.EuiPageHeader,{"data-test-subj":"vulnerability-dashboard-page-header",bottomBorder:!0,pageTitle:Object(j.jsx)(zr,{title:_.i18n.translate("xpack.csp.vulnerability_dashboard.cspPageTemplate.pageTitle",{defaultMessage:"Cloud Native Vulnerability Management"})})}),"indexed"!==(null==a||null===(e=a.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status)?Object(j.jsx)(xl,null):Object(j.jsx)($,{query:s},Object(j.jsx)("div",{"data-test-subj":"vulnerability-dashboard-container"},Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Ru,null),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Mu,null),Object(j.jsx)(C.EuiSpacer,null),Object(j.jsx)(Vu,null))))},Au=Object.fromEntries(Object.values(O.c).map((({id:e})=>[e,!0]))),Lu=({id:e,children:t,component:a,disabled:s=!1,...i})=>{var n;const l=null===(n=y())||void 0===n?void 0:n.getSpyRouteComponent();if(s)return null;const r={...i,...a&&{render:t=>Object(j.jsx)(S.TrackApplicationView,{viewId:e},Au[e]&&l&&Object(j.jsx)(l,{pageName:e}),Object(j.jsx)(a,t))}};return Object(j.jsx)(x,r,t)},zu=new r.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),Bu=({securitySolutionContext:e})=>{const t=Object(j.jsx)(r.QueryClientProvider,{client:zu},Object(j.jsx)(h,null,Object(j.jsx)(Lu,i()({},O.c.findings,{component:Lr})),Object(j.jsx)(Lu,i()({},O.c.dashboard,{component:Io})),Object(j.jsx)(Lu,i()({},O.c.vulnerability_dashboard,{component:Gu})),Object(j.jsx)(Lu,O.c.benchmarks,Object(j.jsx)(h,null,Object(j.jsx)(Lu,i()({},O.b.rules,{component:vu})),Object(j.jsx)(Lu,i()({},O.c.benchmarks,{component:Wo})))),Object(j.jsx)(x,null,Object(j.jsx)(o.Redirect,{to:O.c.dashboard.path}))));return e?Object(j.jsx)(v.Provider,{value:e},t):Object(j.jsx)(l.a.Fragment,null,t)}}])]);