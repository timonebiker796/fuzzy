(window.visTypeTable_bundle_jsonpfunction=window.visTypeTable_bundle_jsonpfunction||[]).push([[0],{45:function(e,t,n){"use strict";n.r(t),n.d(t,"convertToLens",(function(){return m}));var o=n(7),a=n(32),l=n(33),s=n(4),i=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}(i||{});const u=(e,t,n,o)=>{const{showTotal:a,totalFunc:l}=e;return n.map((({columnId:e})=>{const n=o?Object.keys(o).find((t=>o[t].includes(e))):void 0;return{columnId:e,alignment:"left",...a&&t.includes(e)?{summaryRow:l}:{},...n?{collapseFn:n}:{}}}))},r=({perPage:e})=>({enabled:""!==e,size:""!==e?e:0}),c=e=>{const{autoFitRowToContent:t}=e;return{rowHeight:t?i.auto:i.single,headerRowHeight:t?i.auto:i.single}},d=(e,t,{metrics:n,buckets:o,columnsWithoutReferenced:a,bucketCollapseFn:l})=>({layerId:e,layerType:"data",columns:u(t,n,a,l),paging:r(t),...c(t)}),m=async(e,t)=>{var n;if(!t)return null;const i=Object(s.a)(),u=await Object(o.getDataViewByIndexPatternId)(null===(n=e.data.indexPattern)||void 0===n?void 0:n.id,i);if(!u)return null;const{getColumnsFromVis:r,getPercentageColumnFormulaColumn:c}=await o.convertToLensModule,m=r(e,t,u,{buckets:["bucket"],splits:["split_row","split_column"]},{dropEmptyRowsInDateHistogram:!0,isPercentageMode:!1});if(null===m)return null;const[g]=m;if(e.params.percentageCol){const n=Object(o.getVisSchemas)(e,{timefilter:t,timeRange:t.getAbsoluteTime()}),a=n.metric.find((t=>t.label===e.params.percentageCol));if(!a)return null;const l=c({visType:e.type.name,agg:a,dataView:u,aggs:n.metric});if(!l)return null;g.columns.splice(g.columnsWithoutReferenced.findIndex((e=>e.meta.aggId===a.aggId))+1,0,l),g.columnsWithoutReferenced.push(l)}const p=Object(l.v4)(),f=u.id;return{type:"lnsDatatable",layers:[{indexPatternId:f,layerId:p,columns:g.columns.map(a.excludeMetaFromColumn),columnOrder:[],ignoreGlobalFilters:!1}],configuration:d(p,e.params,g),indexPatternIds:[f]}}}}]);