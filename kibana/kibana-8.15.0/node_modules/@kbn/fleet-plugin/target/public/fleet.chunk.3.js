/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.fleet_bundle_jsonpfunction=window.fleet_bundle_jsonpfunction||[]).push([[3,7],{201:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var l=a(54).__importDefault(a(257));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=l.default},256:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(54),n=a(201),i=l.__importDefault(a(258));t.default=function(e,t){i.default(e,t,n.isDeepEqual)}},257:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var l,n,i;if(Array.isArray(t)){if((l=t.length)!=a.length)return!1;for(n=l;0!=n--;)if(!e(t[n],a[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((l=(i=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(n=l;0!=n--;)if(!Object.prototype.hasOwnProperty.call(a,i[n]))return!1;for(n=l;0!=n--;){var o=i[n];if(!("_owner"===o&&t.$$typeof||e(t[o],a[o])))return!1}return!0}return t!=t&&a!=a}},258:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(1);t.default=function(e,t,a){var n=l.useRef(void 0);n.current&&a(t,n.current)||(n.current=t),l.useEffect(e,n.current)}},259:function(e,t,a){"use strict";e.exports=a(657)},261:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return c}));var l=a(1),n=a.n(l);const i=Object(l.createContext)({isReadOnly:!1,setIsReadOnly:()=>{}}),o=({children:e})=>{const[t,a]=Object(l.useState)(!1);return n.a.createElement(i.Provider,{value:{isReadOnly:t,setIsReadOnly:a}},e)};function r(){return Object(l.useContext)(i).isReadOnly}function c(e){const t=Object(l.useContext)(i);Object(l.useEffect)((()=>(t.setIsReadOnly(e),()=>t.setIsReadOnly(!1))),[t,e])}},266:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return p}));var l=a(20),n=a.n(l),i=a(1),o=a.n(i),r=a(22);const c={services:{}},s=Object(i.createContext)(c);var u=a(256),d=a.n(u),g=a(8);const m=({children:e,component:t,render:a,...l})=>{const c=Object(i.useMemo)((()=>{if(t)return e=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(p,null),Object(g.jsx)(t,e))}),[t]);if(c)return Object(g.jsx)(r.Route,n()({},l,{component:c}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(g.jsx)(r.Route,n()({},l,{render:e=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(p,null),t(e))}))}return Object(g.jsx)(r.Route,l,Object(g.jsx)(p,null),e)},p=()=>{const{executionContext:e}=Object(i.useContext)(s).services,t=Object(r.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null}},268:function(e,t,a){"use strict";a.d(t,"b",(function(){return _})),a.d(t,"a",(function(){return N}));var l=a(20),n=a.n(l),i=a(1),o=a.n(i),r=a(13),c=a(22),s=a(4),u=a(12),d=a(6),g=a(261),m=a(17),p=a(116),f=a(117),y=a(144),E=a(381),k=a(149),b=a(0),v=a(59),P=a(5),h=a(374),j=a(378),M=a(58),O=a.n(M),C=a(16);const x=O()(d.EuiFlyoutBody).withConfig({displayName:"FlyoutBody",componentId:"sc-20y62p-0"})([".euiFlyoutBody__overflowContent{padding:0;}"]),I=({newSecrets:e})=>{const{docLinks:t}=Object(m.sc)();return o.a.createElement(d.EuiCallOut,{title:s.i18n.translate("xpack.fleet.upgradePackagePolicy.statusCallOut.hasNewSecretsTitle",{defaultMessage:"New secrets added"}),color:"primary",iconType:"iInCircle"},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.statusCallout.hasNewSecrets",defaultMessage:"Some of this integration's form fields have been converted to secrets in this version. Your existing values are autofilled in each secret input during this upgrade, but you won't be able to view them again after saving. {learnMoreLink}",values:{learnMoreLink:o.a.createElement(d.EuiLink,{href:t.links.fleet.policySecrets,target:"_blank"},"Learn more.")}}),o.a.createElement(d.EuiSpacer,{size:"s"}),o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.statusCallout.hasNewSecretsList",defaultMessage:"New secrets: {secrets}",values:{secrets:o.a.createElement("ul",null,e.map((e=>o.a.createElement("li",{key:e.title},e.title))))}}))},S=({currentPackagePolicy:e,proposedUpgradePackagePolicy:t,onPreviousConfigurationClick:a})=>{var l,n;return o.a.createElement(d.EuiCallOut,{title:s.i18n.translate("xpack.fleet.upgradePackagePolicy.statusCallOut.errorTitle",{defaultMessage:"Review field conflicts"}),color:"warning",iconType:"warning"},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.statusCallout.errorContent",defaultMessage:"This integration has conflicting fields from version {currentVersion} to {upgradeVersion} Review the configuration and save to perform the upgrade. You may reference your {previousConfigurationLink} for comparison.",values:{currentVersion:null==e||null===(l=e.package)||void 0===l?void 0:l.version,upgradeVersion:null==t||null===(n=t.package)||void 0===n?void 0:n.version,previousConfigurationLink:o.a.createElement(d.EuiLink,{onClick:a},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.statusCallout.previousConfigurationLink",defaultMessage:"previous configuration"}))}}))},A=({currentPackagePolicy:e,proposedUpgradePackagePolicy:t})=>{var a,l;return o.a.createElement(d.EuiCallOut,{title:s.i18n.translate("xpack.fleet.upgradePackagePolicy.statusCallOut.successTitle",{defaultMessage:"Ready to upgrade"}),color:"success",iconType:"checkInCircleFilled"},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.statusCallout.successContent",defaultMessage:"This integration is ready to be upgraded from version {currentVersion} to {upgradeVersion}. Review the changes below and save to upgrade.",values:{currentVersion:null==e||null===(a=e.package)||void 0===a?void 0:a.version,upgradeVersion:null==t||null===(l=t.package)||void 0===l?void 0:l.version}}))},F=({dryRunData:e,newSecrets:t})=>{var a;const[l,n]=Object(i.useState)(!1);if(!e)return null;const r=t.length>0,[c,s]=e[0].diff||[],g=c&&!e[0].hasErrors;return o.a.createElement(o.a.Fragment,null,l&&c&&o.a.createElement(d.EuiPortal,null,o.a.createElement(d.EuiFlyout,{onClose:()=>n(!1),maxWidth:C.q},o.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(d.EuiTitle,{size:"m"},o.a.createElement("h2",{id:"FleetPackagePolicyPreviousVersionFlyoutTitle"},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.previousVersionFlyout.title",defaultMessage:"''{name}'' integration policy",values:{name:null==c?void 0:c.name}})))),o.a.createElement(x,null,o.a.createElement(d.EuiCodeBlock,{isCopyable:!0,fontSize:"m",whiteSpace:"pre"},JSON.stringify((null===(a=e[0].agent_diff)||void 0===a?void 0:a[0])||[],null,2))))),g?o.a.createElement(A,{currentPackagePolicy:c,proposedUpgradePackagePolicy:s}):o.a.createElement(S,{currentPackagePolicy:c,proposedUpgradePackagePolicy:s,onPreviousConfigurationClick:()=>n(!0)}),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(d.EuiSpacer,{size:"m"}),o.a.createElement(I,{newSecrets:t})))};var T=a(265),w=a(379);const _=Object(i.memo)((()=>{var e,t,a,l;const{params:{packagePolicyId:n,policyId:i}}=Object(c.useRouteMatch)(),r=Object(p.x)(n),s=Object(m.uc)(null!==(e=null===(t=r.data)||void 0===t||null===(a=t.item)||void 0===a||null===(l=a.package)||void 0===l?void 0:l.name)&&void 0!==e?e:"","package-policy-edit");return o.a.createElement(N,{packagePolicyId:n,policyId:i,forceUpgrade:null==s?void 0:s.useLatestPackageVersion})})),N=Object(i.memo)((({packagePolicyId:e,policyId:t,forceUpgrade:a=!1,from:l="edit"})=>{var c,p,M,O,C,x;const{application:I,notifications:S}=Object(m.sc)(),{agents:{enabled:A}}=Object(m.Cb)(),{getHref:_}=Object(m.jc)(),{canUseMultipleAgentPolicies:N}=Object(m.kc)(),{agentPolicies:D,isLoadingData:R,loadingError:B,packagePolicy:z,originalPackagePolicy:V,packageInfo:G,upgradeDryRunData:U,formState:q,setFormState:H,isUpgrade:W,isEdited:$,setIsEdited:K,savePackagePolicy:Z,hasErrors:Y,updatePackagePolicy:Q,validationResults:J}=Object(T.c)(e,{forceUpgrade:a}),X=z.policy_ids.includes(b.a),ee=Object(m.yb)().integrations.writeIntegrationPolicies;Object(g.c)(!ee);const te=Object(i.useMemo)((()=>G?Object(w.b)({packageInfo:G,packagePolicy:z}):[]),[G,z]),[ae,le]=Object(i.useState)([]),[ne,ie]=Object(i.useState)(!0),[oe,re]=Object(i.useState)(),[ce,se]=Object(i.useState)(!1),[ue,de]=Object(i.useState)(0);Object(i.useEffect)((()=>{A&&z.policy_ids.length>0&&(async()=>{let e=0;for(const t of z.policy_ids){const{data:a}=await Object(m.x)({policyId:t});null!=a&&a.results.total&&(e+=a.results.total)}de(e)})()}),[z.policy_ids,A]);const ge=Object(i.useCallback)((({isValid:e,updatedPolicy:t})=>{Q(t),H((t=>"VALID"!==t||e?t:"INVALID"))}),[Q,H]),me=Object(i.useMemo)((()=>"package-edit"===l&&G?_("integration_details_policies",{pkgkey:Object(v.p)(G)}):t?_("policy_details",{policyId:t}):_("agent_list")),[l,_,G,t]),pe=Object(i.useMemo)((()=>"package-edit"!==l&&"upgrade-from-integrations-policy-list"!==l||!G?t?_("policy_details",{policyId:t}):_("agent_list"):_("integration_details_policies",{pkgkey:Object(v.p)(G)})),[l,_,G,t]);Object(T.a)($),Object(i.useEffect)((()=>{D.length>0&&ne&&(ie(!1),le(D))}),[D,ne]);const fe=Object(i.useMemo)((()=>[...ae.filter((e=>!D.find((t=>t.id===e.id)))).map((e=>e.name)),...oe?[oe]:[]]),[ae,D,oe]),ye=Object(i.useMemo)((()=>D.filter((e=>!ae.find((t=>t.id===e.id)))).map((e=>e.name))),[ae,D]),Ee=async()=>{if("VALID"===q&&Y)return void H("INVALID");if((0!==ue||fe.length>0||ye.length>0)&&!X&&"CONFIRM"!==q)return void H("CONFIRM");let e;try{H("LOADING"),e=await we()}catch(e){return H("VALID"),void S.toasts.addError(e,{title:s.i18n.translate("xpack.fleet.createAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to create agent policy"})})}const{error:t}=await Z({policy_ids:e?[...z.policy_ids,e]:z.policy_ids});t?(409===t.statusCode?S.toasts.addError(t,{title:s.i18n.translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating ''{packagePolicyName}''",values:{packagePolicyName:z.name}}),toastMessage:s.i18n.translate("xpack.fleet.editPackagePolicy.failedConflictNotificationMessage",{defaultMessage:"Data is out of date. Refresh the page to get the latest policy."})}):S.toasts.addError(t,{title:s.i18n.translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating ''{packagePolicyName}''",values:{packagePolicyName:z.name}})}),H("VALID")):(K(!1),I.navigateToUrl(pe),S.toasts.addSuccess({title:s.i18n.translate("xpack.fleet.editPackagePolicy.updatedNotificationTitle",{defaultMessage:"Successfully updated ''{packagePolicyName}''",values:{packagePolicyName:z.name}}),"data-test-subj":"policyUpdateSuccessToast",text:ue&&ae.length>0?s.i18n.translate("xpack.fleet.editPackagePolicy.updatedNotificationMessage",{defaultMessage:"Fleet will deploy updates to all agents that use the ''{agentPolicyNames}'' policy",values:{agentPolicyNames:ae.map((e=>e.name)).join(", ")}}):void 0}))},ke=Object(m.uc)(null!==(c=null===(p=z.package)||void 0===p?void 0:p.name)&&void 0!==c?c:"","package-policy-edit"),be=Object(m.uc)(null!==(M=null===(O=z.package)||void 0===O?void 0:O.name)&&void 0!==M?M:"","package-policy-replace-define-step"),ve=Object(m.uc)(null!==(C=null===(x=z.package)||void 0===x?void 0:x.name)&&void 0!==C?C:"","package-policy-edit-tabs");if(be&&ke)throw new Error("'package-policy-create' and 'package-policy-replace-define-step' cannot both be registered as UI extensions");const Pe=null==ve?void 0:ve.tabs,[he,je]=Object(i.useState)(0),Me={from:null!=ke&&ke.useLatestPackageVersion&&W?"upgrade-from-extension":l,cancelUrl:me,agentPolicies:ae,packageInfo:G,tabs:null!=Pe&&Pe.length?[{title:s.i18n.translate("xpack.fleet.editPackagePolicy.settingsTabName",{defaultMessage:"Settings"}),isSelected:0===he,onClick:()=>{je(0)}},...Pe.map((({title:e},t)=>({title:e,isSelected:he===t+1,onClick:()=>{je(t+1)}})))]:[]},Oe=Object(i.useMemo)((()=>{var e;return ae&&G?o.a.createElement(o.a.Fragment,null,0===he&&o.a.createElement(k.d,{namespacePlaceholder:Object(P.D)(ae),packageInfo:G,packagePolicy:z,updatePackagePolicy:Q,validationResults:J,submitAttempted:"INVALID"===q,isEditPage:!0}),!ke&&0===he&&o.a.createElement(k.c,{packageInfo:G,packagePolicy:z,updatePackagePolicy:Q,validationResults:J,submitAttempted:"INVALID"===q,isEditPage:!0}),ke&&z.policy_ids[0]&&(null===(e=z.package)||void 0===e?void 0:e.name)&&V&&o.a.createElement(f.k,null,he>0&&Pe?o.a.createElement(Pe[he-1].Component,{policy:V,newPolicy:z,onChange:ge}):o.a.createElement(ke.Component,{policy:V,newPolicy:z,onChange:ge}))):null}),[ae,G,z,Q,J,q,V,ke,ge,he,Pe]),Ce=be&&V&&G&&o.a.createElement(f.k,null,o.a.createElement(be.Component,{agentPolicies:ae,packageInfo:G,policy:V,newPolicy:z,onChange:ge,validationResults:J,isEditPage:!0})),xe=G?Object(P.O)(G):[],Ie=Object(i.useMemo)((()=>{var e;return D.length>0?null!==(e=D.find((e=>e.id===t)))&&void 0!==e?e:D[0]:{name:"",id:""}}),[D,t]),{steps:Se,devToolsProps:{devtoolRequest:Ae,devtoolRequestDescription:Fe,showDevtoolsRequest:Te},createAgentPolicyIfNeeded:we}=Object(T.b)({configureStep:Ce||Oe,packageInfo:G,existingAgentPolicies:D,setHasAgentPolicyError:se,updatePackagePolicy:Q,agentPolicies:ae,setAgentPolicies:le,isLoadingData:R,packagePolicy:z,packagePolicyId:e,setNewAgentPolicyName:re});return o.a.createElement(E.a,n()({},Me,{"data-test-subj":"editPackagePolicy"}),o.a.createElement(d.EuiErrorBoundary,null,R?o.a.createElement(f.p,null):B||Object(r.isEmpty)(D)||!G?o.a.createElement(f.i,{title:o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.errorLoadingDataTitle",defaultMessage:"Error loading data"}),error:B||s.i18n.translate("xpack.fleet.editPackagePolicy.errorLoadingDataMessage",{defaultMessage:"There was an error loading this integration information"})}):o.a.createElement(o.a.Fragment,null,o.a.createElement(L,{agentPolicyName:Ie.name,from:l,packagePolicyName:z.name,pkgkey:Object(v.p)(G),pkgTitle:G.title,policyId:Ie.id}),"CONFIRM"===q&&o.a.createElement(y.f,{agentCount:ue,agentPolicies:ae,onConfirm:Ee,onCancel:()=>H("VALID"),agentPoliciesToAdd:fe,agentPoliciesToRemove:ye}),G&&Object(P.Z)(G)?o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{dataStreams:xe}),o.a.createElement(d.EuiSpacer,{size:"m"})):null,W&&U&&o.a.createElement(o.a.Fragment,null,o.a.createElement(F,{dryRunData:U,newSecrets:te}),o.a.createElement(d.EuiSpacer,{size:"xxl"})),N&&!X?o.a.createElement(j.b,{steps:Se}):Ce||Oe,o.a.createElement(d.EuiSpacer,{size:"xxl"}),o.a.createElement(d.EuiSpacer,{size:"xxl"}),o.a.createElement(d.EuiBottomBar,null,o.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},o.a.createElement(d.EuiFlexItem,{grow:!1},ae&&G&&("INVALID"===q||ce)?o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),o.a.createElement(d.EuiFlexItem,{grow:!1},o.a.createElement(d.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},o.a.createElement(d.EuiFlexItem,{grow:!1},o.a.createElement(d.EuiButtonEmpty,{color:"text",href:me},o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),Te?o.a.createElement(d.EuiFlexItem,{grow:!1},o.a.createElement(f.h,{isDisabled:"VALID"!==q,btnProps:{color:"text"},request:Ae,description:Fe})):null,o.a.createElement(d.EuiFlexItem,{grow:!1},o.a.createElement(f.j,{onClick:Ee,isLoading:"LOADING"===q,isDisabled:!ee||"VALID"!==q||ce||!J||!$&&!W,tooltip:ee?void 0:{content:o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.agentPolicy.saveIntegrationTooltip",defaultMessage:"To save the integration policy, you must have security enabled and have the All privilege for Integrations. Contact your administrator."})},iconType:"save",color:"primary",fill:!0,"data-test-subj":"saveIntegration"},W?o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.upgradeButton",defaultMessage:"Upgrade integration"}):o.a.createElement(u.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.saveButton",defaultMessage:"Save integration"}))))))))))})),L=Object(i.memo)((({agentPolicyName:e,from:t,packagePolicyName:a,pkgkey:l,pkgTitle:n,policyId:i})=>{let r=o.a.createElement(R,{policyName:e,policyId:i});return"package"===t||"package-edit"===t?r=o.a.createElement(D,{pkgkey:l,pkgTitle:n,policyName:a}):"upgrade-from-integrations-policy-list"===t?r=o.a.createElement(B,{pkgkey:l,pkgTitle:n,policyName:a}):"upgrade-from-fleet-policy-list"===t&&(r=o.a.createElement(z,{policyName:e,policyId:i})),r})),D=Object(i.memo)((({pkgTitle:e,policyName:t,pkgkey:a})=>(Object(p.l)("integration_policy_edit",{policyName:t,pkgTitle:e,pkgkey:a}),null))),R=({policyName:e,policyId:t})=>(Object(m.zb)("edit_integration",{policyName:e,policyId:t}),null),B=Object(i.memo)((({pkgTitle:e,policyName:t,pkgkey:a})=>(Object(p.l)("integration_policy_upgrade",{policyName:t,pkgTitle:e,pkgkey:a}),null))),z=({policyName:e,policyId:t})=>(Object(m.zb)("upgrade_package_policy",{policyName:e,policyId:t}),null)},368:function(e,t,a){"use strict";e.exports=a(659)},369:function(e,t,a){"use strict";e.exports=a(666)},371:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s}));var l=a(6),n=a(12),i=a(1),o=a.n(i),r=a(13);const c=e=>{var t,a,l,n;return e&&Array.isArray(null===(t=e.elasticsearch)||void 0===t?void 0:t.transform)&&(null===(a=e.elasticsearch)||void 0===a||null===(l=a.transform)||void 0===l?void 0:l.length)>0?Object(r.uniqBy)(null===(n=e.elasticsearch)||void 0===n?void 0:n.transform,"file").length:0},s=({count:e})=>o.a.createElement(l.EuiCallOut,{color:"primary",iconType:"iInCircle"},o.a.createElement(n.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.transformInstallWithCurrentUserPermissionCallout",defaultMessage:"This package has {count, plural, one {one transform asset} other {# transform assets}} which will be created and started with the same roles as the user installing the package.",values:{count:e}}))},374:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var l=a(6),n=a(12),i=a(1),o=a.n(i),r=a(17);const c=({dataStreams:e})=>{const{docLinks:t}=Object(r.sc)();return o.a.createElement(l.EuiCallOut,{size:"m",color:"warning",title:o.a.createElement(n.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.requireRootCalloutTitle",defaultMessage:"Requires root privileges"}),"data-test-subj":"rootPrivilegesCallout"},0===e.length?o.a.createElement(n.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.requireRootCalloutDescription",defaultMessage:"Elastic Agent needs to be run with root/administrator privileges for this integration."}):o.a.createElement(o.a.Fragment,null,o.a.createElement(n.FormattedMessage,{id:"xpack.fleet.addIntegration.confirmModal.unprivilegedAgentsDataStreamsMessage",defaultMessage:"This integration has the following data streams that require Elastic Agents to have root privileges. To ensure that all data required by the integration can be collected, enroll agents using an account with root privileges.  For more information, see the {guideLink}",values:{guideLink:o.a.createElement(l.EuiLink,{href:t.links.fleet.unprivilegedMode,target:"_blank",external:!0},o.a.createElement(n.FormattedMessage,{id:"xpack.fleet.addIntegration.confirmModal.unprivilegedAgentsDataStreamsMessage.guideLink",defaultMessage:"Fleet and Elastic Agent Guide"}))}}),o.a.createElement("ul",null,e.map((e=>o.a.createElement("li",{key:e.name},e.title))))))}},378:function(e,t,a){"use strict";a.d(t,"b",(function(){return D})),a.d(t,"a",(function(){return B}));var l=a(20),n=a.n(l),i=a(1),o=a.n(i),r=a(22),c=a(58),s=a.n(c),u=a(4),d=a(12),g=a(6),m=a(0),p=a(371),f=a(384),y=a(5),E=a(247),k=a(17),b=a(117),v=a(144),P=a(59),h=a(149),j=a(30),M=a(380),O=a(381),C=a(383),x=a(7),I=a(172),S=a(202),A=a(156),F=a(186);const T=({onConfirm:e,onCancel:t,agentPolicy:a,packagePolicy:l})=>{var n,i;const{data:r,isLoading:c}=Object(x.useQuery)(["cloudFormationApiKeys"],(()=>Object(k.D)({page:1,perPage:1,kuery:`policy_id:${a.id}`}))),{agentPolicyWithPackagePolicies:s}=Object(I.a)(a.id),{fleetServerHost:u}=Object(k.Ib)(s),m=Object(A.d)(l),{cloudFormationUrl:p,error:f,isError:y}=Object(F.b)({enrollmentAPIKey:null==r||null===(n=r.data)||void 0===n||null===(i=n.items[0])||void 0===i?void 0:i.api_key,cloudFormationProps:m,fleetServerHost:u});return o.a.createElement(g.EuiModal,{"data-test-subj":"postInstallCloudFormationModal",onClose:t},o.a.createElement(g.EuiModalHeader,null,o.a.createElement(g.EuiModalHeaderTitle,{"data-test-subj":"confirmCloudFormationModalTitleText"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallCloudFormationModalTitle",defaultMessage:"CloudFormation deployment"}))),o.a.createElement(g.EuiModalBody,null,o.a.createElement(S.b,{awsAccountType:m.awsAccountType}),f&&y&&o.a.createElement(o.a.Fragment,null,o.a.createElement(g.EuiSpacer,{size:"m"}),o.a.createElement(g.EuiCallOut,{title:f,color:"danger",iconType:"error"}))),o.a.createElement(g.EuiModalFooter,null,o.a.createElement(g.EuiButtonEmpty,{"data-test-subj":"confirmCloudFormationModalCancelButton",onClick:t},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallCloudFormationModal.cancelButton",defaultMessage:"Launch CloudFormation later"})),o.a.createElement(g.EuiButton,{"data-test-subj":"confirmCloudFormationModalConfirmButton",onClick:()=>{window.open(p),e()},fill:!0,color:"primary",isLoading:c,isDisabled:y},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallCloudFormationModalConfirmButtonLabel",defaultMessage:"Launch CloudFormation"}))))};var w=a(205);const _=({onConfirm:e,onCancel:t,agentPolicy:a,packagePolicy:l})=>{var n,i,r,c;const{data:s}=Object(x.useQuery)(["googleCloudShellApiKeys"],(()=>Object(k.D)({page:1,perPage:1,kuery:`policy_id:${a.id}`}))),{fleetServerHost:u,fleetProxy:m,downloadSource:p}=Object(k.Ib)(a),f=Object(k.xb)(),{gcpProjectId:y,gcpOrganizationId:E,gcpAccountType:b}=Object(A.h)(l),{cloudShellUrl:v,error:P,isError:h,isLoading:j}=Object(F.c)({enrollmentAPIKey:null==s||null===(n=s.data)||void 0===n||null===(i=n.items[0])||void 0===i?void 0:i.api_key,packagePolicy:l});if(!f)return o.a.createElement(g.EuiLoadingSpinner,null);const M=Object(w.a)({apiKey:(null==s||null===(r=s.data)||void 0===r||null===(c=r.items[0])||void 0===c?void 0:c.api_key)||"no_key",fleetServerHost:u,fleetProxy:m,downloadSource:p,agentVersion:f,gcpProjectId:y,gcpOrganizationId:E,gcpAccountType:b});return o.a.createElement(g.EuiModal,{"data-test-subj":"postInstallGoogleCloudShellModal",onClose:t},o.a.createElement(g.EuiModalHeader,null,o.a.createElement(g.EuiModalHeaderTitle,{"data-test-subj":"confirmGoogleCloudShellTitleText"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallGoogleCloudShellModalTitle",defaultMessage:"Google Cloud Shell deployment"}))),o.a.createElement(g.EuiModalBody,null,o.a.createElement(S.c,{commandText:M.googleCloudShell,hasProjectId:!!y}),P&&h&&o.a.createElement(o.a.Fragment,null,o.a.createElement(g.EuiSpacer,{size:"m"}),o.a.createElement(g.EuiCallOut,{title:P,color:"danger",iconType:"error"}))),o.a.createElement(g.EuiModalFooter,null,o.a.createElement(g.EuiButtonEmpty,{"data-test-subj":"confirmGoogleCloudShellModalCancelButton",onClick:t},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallGoogleCloudShellModal.cancelButton",defaultMessage:"Launch Google Cloud Shell later"})),o.a.createElement(g.EuiButton,{"data-test-subj":"confirmGoogleCloudShellModalConfirmButton",onClick:()=>{window.open(v),e()},fill:!0,color:"primary",isLoading:j,isDisabled:h},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallGoogleCloudShellModalConfirmButtonLabel",defaultMessage:"Launch Google Cloud Shell"}))))},N=({onConfirm:e,onCancel:t,agentPolicy:a,packagePolicy:l})=>{var n,i;const{data:r}=Object(x.useQuery)(["azureArmTemplateApiKeys",{agentPolicyId:a.id}],(()=>Object(k.D)({page:1,perPage:1,kuery:`policy_id:${a.id}`}))),c=Object(A.c)(l),s=null==r||null===(n=r.data)||void 0===n||null===(i=n.items[0])||void 0===i?void 0:i.api_key,{azureArmTemplateUrl:u,error:m,isError:p,isLoading:f}=Object(F.a)({enrollmentAPIKey:s,azureArmTemplateProps:c});return o.a.createElement(g.EuiModal,{"data-test-subj":"postInstallAzureArmTemplateModal",onClose:t},o.a.createElement(g.EuiModalHeader,null,o.a.createElement(g.EuiModalHeaderTitle,{"data-test-subj":"confirmAzureArmTemplateModalTitleText"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAzureArmTemplateModalModalTitle",defaultMessage:"ARM Template deployment"}))),o.a.createElement(g.EuiModalBody,null,o.a.createElement(S.a,{azureAccountType:c.azureAccountType,agentPolicy:a,enrollmentToken:s}),m&&p&&o.a.createElement(o.a.Fragment,null,o.a.createElement(g.EuiSpacer,{size:"m"}),o.a.createElement(g.EuiCallOut,{title:m,color:"danger",iconType:"error"}))),o.a.createElement(g.EuiModalFooter,null,o.a.createElement(g.EuiButtonEmpty,{"data-test-subj":"confirmAzureArmTemplateModalCancelButton",onClick:t},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAzureArmTemplateModal.cancelButton",defaultMessage:"Add ARM Template later"})),o.a.createElement(g.EuiButton,{"data-test-subj":"confirmAzureArmTemplateModalConfirmButton",onClick:()=>{window.open(u),e()},fill:!0,color:"primary",isLoading:f,isDisabled:p},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAzureArmTemplateModalConfirmButtonLabel",defaultMessage:"Launch ARM Template"}))))};var L=a(374);const D=s()(g.EuiSteps).withConfig({displayName:"StepsWithLessPadding",componentId:"sc-12f9cyq-0"})([".euiStep__content{padding-bottom:",";}@media (max-width:","){margin-bottom:100px;}"],(e=>e.theme.eui.euiSizeM),(e=>e.theme.eui.euiBreakpoints.m)),R=s()(g.EuiBottomBar).withConfig({displayName:"CustomEuiBottomBar",componentId:"sc-12f9cyq-1"})(["z-index:50;"]),B=({from:e,queryParamsPolicyId:t,prerelease:a})=>{var l,c,s,x,I;const{agents:{enabled:S}}=Object(k.Cb)(),A=Object(k.yb)().fleet.addAgents,{params:F}=Object(r.useRouteMatch)(),w=Object(k.Kb)(),{docLinks:B}=Object(k.sc)(),[z,V]=Object(i.useState)(Object(j.b)({name:"Agent policy 1"})),[G,U]=Object(i.useState)(!0),q=Object(v.h)(z),[H,W]=Object(i.useState)(t?h.b.EXISTING:h.b.NEW),{pkgName:$,pkgVersion:K}=Object(y.mb)(F.pkgkey),{data:Z,error:Y,isLoading:Q}=Object(k.Zb)($,K,{full:!0,prerelease:a}),J=Object(i.useMemo)((()=>{if(Z&&Z.item)return Z.item}),[Z]),[X,ee]=Object(i.useState)(0),te=Object(i.useMemo)((()=>{var e;return F.integration?null==J||null===(e=J.policy_templates)||void 0===e?void 0:e.find((e=>e.name===F.integration)):void 0}),[null==J?void 0:J.policy_templates,F]),ae=!w.isSecretsStorageEnabled&&J&&Object(M.b)({packageInfo:J}),{onSubmit:le,updatePackagePolicy:ne,packagePolicy:ie,agentPolicies:oe,updateAgentPolicies:re,savedPackagePolicy:ce,formState:se,setFormState:ue,navigateAddAgent:de,navigateAddAgentHelp:ge,setHasAgentPolicyError:me,validationResults:pe,hasAgentPolicyError:fe,isInitialized:ye}=Object(C.b)({agentCount:X,packageInfo:J,newAgentPolicy:z,selectedPolicyTab:H,withSysMonitoring:G,queryParamsPolicyId:t,integrationToEnable:null==te?void 0:te.name,hasFleetAddAgentsPrivileges:A}),Ee=Object(i.useCallback)(((e,t)=>{e===h.b.NEW&&(t.name&&""!==t.name.trim()&&t.namespace&&""!==t.namespace.trim()?me(!1):me(!0))}),[me]),ke=Object(i.useCallback)((e=>{const t={...z,...e};V(t),Ee(H,t)}),[V,Ee,z,H]),be=Object(i.useCallback)((e=>{W(e),Ee(e,z)}),[W,Ee,z]),ve=oe.map((e=>e.id)),{cancelClickHandler:Pe,cancelUrl:he}=Object(f.a)({from:e,pkgkey:F.pkgkey,agentPolicyId:ve[0]});Object(i.useEffect)((()=>{H!==h.b.NEW?S&&ve.length>0&&(async()=>{let e=0;for(const t of ve){const{data:a}=await Object(k.x)({policyId:t});null!=a&&a.results.total&&(e+=a.results.total)}ee(e)})():ee(0)}),[ve,H,S]);const je=Object(i.useCallback)((({isValid:e,updatedPolicy:t})=>{ne(t),ue((t=>"VALID"!==t||e?t:"INVALID"))}),[ne,ue]),{devtoolRequest:Me,devtoolRequestDescription:Oe,showDevtoolsRequest:Ce}=Object(C.a)({newAgentPolicy:z,packagePolicy:ie,selectedPolicyTab:H,withSysMonitoring:G,packageInfo:J}),xe=Object(i.useMemo)((()=>({from:e,cancelUrl:he,onCancel:Pe,agentPolicies:oe,packageInfo:J,integrationInfo:te})),[oe,Pe,he,e,te,J]),Ie=Object(i.useMemo)((()=>o.a.createElement(h.e,{agentPolicies:oe,updateAgentPolicies:re,newAgentPolicy:z,updateNewAgentPolicy:ke,withSysMonitoring:G,updateSysMonitoring:e=>U(e),validation:q,packageInfo:J,setHasAgentPolicyError:me,updateSelectedTab:be,selectedAgentPolicyIds:t?[t]:[]})),[J,oe,re,z,ke,q,G,be,t,me]),Se=Object(i.useMemo)((()=>Object(p.b)(null==J?void 0:J.assets)),[null==J?void 0:J.assets]),Ae=Object(k.uc)(null!==(l=null===(c=ie.package)||void 0===c?void 0:c.name)&&void 0!==l?l:"","package-policy-create"),Fe=Object(k.uc)(null!==(s=null===(x=ie.package)||void 0===x?void 0:x.name)&&void 0!==s?s:"","package-policy-replace-define-step"),Te=Object(k.uc)(null!==(I=null==J?void 0:J.name)&&void 0!==I?I:"","pli-auth-block"),we=Object(i.useMemo)((()=>null!=Te&&Te.Component&&!Q?Te.Component:({children:e})=>o.a.createElement(o.a.Fragment,null,e)),[Q,null==Te?void 0:Te.Component]);if(Fe&&Ae)throw new Error("'package-policy-create' and 'package-policy-replace-define-step' cannot both be registered as UI extensions");const{agentlessPolicy:_e,handleSetupTechnologyChange:Ne,selectedSetupTechnology:Le}=Object(C.c)({newAgentPolicy:z,updateNewAgentPolicy:ke,updateAgentPolicies:re,setSelectedPolicyTab:W,packageInfo:J}),De=Fe&&null!=J&&J.name?ye?o.a.createElement(b.k,null,o.a.createElement(Fe.Component,{agentPolicies:oe,packageInfo:J,newPolicy:ie,onChange:je,validationResults:pe,isEditPage:!1,handleSetupTechnologyChange:Ne,agentlessPolicy:_e})):o.a.createElement(b.p,null):void 0,Re=Object(i.useMemo)((()=>{var e;return Q||!ye?o.a.createElement(b.p,null):J?o.a.createElement(o.a.Fragment,null,o.a.createElement(h.d,{namespacePlaceholder:Object(y.D)(oe),packageInfo:J,packagePolicy:ie,updatePackagePolicy:ne,validationResults:pe,submitAttempted:"INVALID"===se}),!Ae&&o.a.createElement(h.c,{packageInfo:J,showOnlyIntegration:null==te?void 0:te.name,packagePolicy:ie,updatePackagePolicy:ne,validationResults:pe,submitAttempted:"INVALID"===se}),Ae&&(null===(e=ie.package)||void 0===e?void 0:e.name)&&o.a.createElement(b.k,null,o.a.createElement(Ae.Component,{newPolicy:ie,onChange:je}))):o.a.createElement("div",null)}),[ye,Q,oe,J,ie,ne,pe,se,null==te?void 0:te.name,Ae,je]),Be=[{title:u.i18n.translate("xpack.fleet.createPackagePolicy.stepConfigurePackagePolicyTitle",{defaultMessage:"Configure integration"}),"data-test-subj":"dataCollectionSetupStep",children:De||Re,headingElement:"h2"}];if(Le!==E.a.AGENTLESS&&Be.push({title:u.i18n.translate("xpack.fleet.createPackagePolicy.stepSelectAgentPolicyTitle",{defaultMessage:"Where to add this integration?"}),children:Ie,headingElement:"h2"}),Y)return o.a.createElement(b.i,{title:o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingPackageTitle",defaultMessage:"Error loading package information"}),error:Y});const ze=J?Object(y.O)(J):[];return o.a.createElement(O.a,n()({},xe,{"data-test-subj":"createPackagePolicy"}),o.a.createElement(i.Suspense,{fallback:o.a.createElement(b.p,null)},o.a.createElement(we,null,o.a.createElement(g.EuiErrorBoundary,null,"CONFIRM"===se&&oe.length>0&&o.a.createElement(v.f,{agentCount:X,agentPolicies:oe,onConfirm:le,onCancel:()=>ue("VALID")}),"SUBMITTED_NO_AGENTS"===se&&oe.length>0&&J&&ce&&o.a.createElement(O.b,{packageInfo:J,onConfirm:()=>de(ce),onCancel:()=>ge(ce)}),"SUBMITTED_AZURE_ARM_TEMPLATE"===se&&oe.length>0&&ce&&o.a.createElement(N,{agentPolicy:oe[0],packagePolicy:ce,onConfirm:()=>de(ce),onCancel:()=>ge(ce)}),"SUBMITTED_CLOUD_FORMATION"===se&&oe.length>0&&ce&&o.a.createElement(T,{agentPolicy:oe[0],packagePolicy:ce,onConfirm:()=>de(ce),onCancel:()=>ge(ce)}),"SUBMITTED_GOOGLE_CLOUD_SHELL"===se&&oe.length>0&&ce&&o.a.createElement(_,{agentPolicy:oe[0],packagePolicy:ce,onConfirm:()=>de(ce),onCancel:()=>ge(ce)}),J&&o.a.createElement(h.a,{pkgTitle:(null==te?void 0:te.title)||J.title,pkgkey:Object(P.p)(J),integration:null==te?void 0:te.name}),J&&Object(y.Z)(J)?o.a.createElement(o.a.Fragment,null,o.a.createElement(L.a,{dataStreams:ze}),o.a.createElement(g.EuiSpacer,{size:"m"})):null,Se>0?o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,{count:Se}),o.a.createElement(g.EuiSpacer,{size:"xl"})):null,ae&&o.a.createElement(o.a.Fragment,null,o.a.createElement(g.EuiCallOut,{size:"m",color:"warning",title:o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.secretsDisabledCalloutTitle",defaultMessage:"Policy secrets are disabled"})},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.secretsDisabledCalloutDescription",defaultMessage:"This integration contains {policySecretsLink}, but you have a Fleet Server running on a version earlier than {minimumSecretsVersion}. Please upgrade your Fleet Server to enable policy secrets for all integrations.",values:{policySecretsLink:o.a.createElement(g.EuiLink,{href:B.links.fleet.policySecrets,target:"_blank"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.secretsDisabledCalloutDocsLink",defaultMessage:"policy secrets"})),minimumSecretsVersion:o.a.createElement(g.EuiCode,null,m.Cb)}})),o.a.createElement(g.EuiSpacer,{size:"m"})),o.a.createElement(D,{steps:Be}),o.a.createElement(g.EuiSpacer,{size:"xl"}),o.a.createElement(g.EuiSpacer,{size:"xl"}),o.a.createElement(R,{"data-test-subj":"integrationsBottomBar"},o.a.createElement(g.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},o.a.createElement(g.EuiFlexItem,{grow:!1},J&&("INVALID"===se||fe)?o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),o.a.createElement(g.EuiFlexItem,{grow:!1},o.a.createElement(g.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},o.a.createElement(g.EuiFlexItem,{grow:!1},o.a.createElement(g.EuiButtonEmpty,{color:"text",href:he,onClick:Pe,"data-test-subj":"createPackagePolicyCancelButton"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),Ce?o.a.createElement(g.EuiFlexItem,{grow:!1},o.a.createElement(b.h,{request:Me,description:Oe,btnProps:{color:"text"}})):null,o.a.createElement(g.EuiFlexItem,{grow:!1},o.a.createElement(g.EuiButton,{onClick:()=>le(),isLoading:"LOADING"===se,disabled:"VALID"!==se||fe||!pe,iconType:"save",color:"primary",fill:!0,"data-test-subj":"createPackagePolicySaveButton"},o.a.createElement(d.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.saveButton",defaultMessage:"Save and continue"})))))))))))}},381:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return y}));var l=a(1),n=a.n(l),i=a(12),o=a(58),r=a.n(o),c=a(6),s=a(180),u=a(132),d=a(117);const g=r()(c.EuiDescriptionListDescription).withConfig({displayName:"AgentPolicyName",componentId:"sc-4bb6xn-0"})(["margin-left:auto;max-width:250px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"]),m=Object(l.memo)((({from:e,cancelUrl:t,onCancel:a,agentPolicy:o,packageInfo:r,integrationInfo:m,children:p,"data-test-subj":f,tabs:y=[]})=>{const E=Object(l.useMemo)((()=>["package","policy"].includes(e)),[e]),k=Object(l.useMemo)((()=>["edit","package-edit"].includes(e)),[e]),b=Object(l.useMemo)((()=>["upgrade-from-fleet-policy-list","upgrade-from-integrations-policy-list","upgrade-from-extension"].includes(e)),[e]),v=Object(l.useMemo)((()=>{if((E||k||b)&&r){let e=n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageTitleWithPackageName",defaultMessage:"Add {packageName} integration",values:{packageName:(null==m?void 0:m.title)||r.title}});return k?e=n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.editPageTitleWithPackageName",defaultMessage:"Edit {packageName} integration",values:{packageName:r.title}}):b&&(e=n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.upgradePageTitleWithPackageName",defaultMessage:"Upgrade {packageName} integration",values:{packageName:r.title}})),n.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},n.a.createElement(c.EuiFlexItem,{grow:!1},n.a.createElement(d.r,{packageName:(null==r?void 0:r.name)||"",integrationName:null==m?void 0:m.name,version:(null==r?void 0:r.version)||"",icons:(null==m?void 0:m.icons)||(null==r?void 0:r.icons),size:"xl"})),n.a.createElement(c.EuiFlexItem,null,n.a.createElement(c.EuiText,null,n.a.createElement("h1",{"data-test-subj":`${f}_pageTitle`},e))))}return k?n.a.createElement(c.EuiText,null,n.a.createElement("h1",{"data-test-subj":`${f}_pageTitle`},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.pageTitle",defaultMessage:"Edit integration"}))):b?n.a.createElement(c.EuiText,null,n.a.createElement("h1",{"data-test-subj":`${f}_pageTitle`},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.pageTitle",defaultMessage:"Upgrade integration"}))):n.a.createElement(c.EuiText,null,n.a.createElement("h1",null,n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageTitle",defaultMessage:"Add integration"})))}),[f,null==m?void 0:m.icons,null==m?void 0:m.name,null==m?void 0:m.title,r,E,k,b]),P=Object(l.useMemo)((()=>k?n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.pageDescription",defaultMessage:"Modify integration settings and deploy changes to the selected agent policy."}):E?n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPolicy",defaultMessage:"Configure an integration for the selected agent policy."}):b?n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.upgradePackagePolicy.pageDescriptionFromUpgrade",defaultMessage:"Upgrade this integration and deploy changes to the selected agent policy"}):n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPackage",defaultMessage:"Follow these instructions to add this integration to an agent policy."})),[E,k,b]),h=n.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"s",alignItems:"flexStart"},n.a.createElement(c.EuiFlexItem,null,n.a.createElement(c.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",flush:"left",href:t,onClick:a,"data-test-subj":`${f}_cancelBackLink`},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.cancelLinkText",defaultMessage:"Cancel"}))),n.a.createElement(c.EuiFlexItem,null,v),n.a.createElement(c.EuiFlexItem,null,n.a.createElement(c.EuiSpacer,{size:"s"}),n.a.createElement(c.EuiText,{color:"subdued",size:"s"},P))),{isAgentlessAgentPolicy:j}=Object(s.a)(),M=!j(o),O=o&&(E||k)&&M?n.a.createElement(c.EuiDescriptionList,{className:"eui-textRight",textStyle:"reverse"},n.a.createElement(c.EuiDescriptionListTitle,null,n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.agentPolicyNameLabel",defaultMessage:"Agent policy"})),n.a.createElement(g,{className:"eui-textBreakWord",title:(null==o?void 0:o.name)||"-"},(null==o?void 0:o.name)||"-")):void 0;return n.a.createElement(u.d,{restrictHeaderWidth:800,restrictWidth:800,leftColumn:h,rightColumn:O,rightColumnGrow:!1,"data-test-subj":f,tabs:y.map((({title:e,...t})=>({name:e,...t})))},p)}));var p=a(140),f=a(15);const y=({onConfirm:e,onCancel:t,packageInfo:a})=>{const l=Object(f.Fc)(a.name);return n.a.createElement(c.EuiModal,{"data-test-subj":"postInstallAddAgentModal",onClose:t},n.a.createElement(c.EuiModalHeader,null,n.a.createElement(c.EuiModalHeaderTitle,{"data-test-subj":"confirmModalTitleText"},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAddAgentModal",defaultMessage:"{packageName} integration added",values:{packageName:(o=a.title,o.charAt(0).toUpperCase()+o.substr(1))}}))),n.a.createElement(c.EuiModalBody,null,n.a.createElement(c.EuiText,{"data-test-subj":"confirmModalBodyText"},n.a.createElement("p",null,n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAddAgentModalDescription",defaultMessage:"To complete this integration, add {elasticAgent} to your hosts to collect data and send it to Elastic Stack.",values:{elasticAgent:n.a.createElement("strong",null,"Elastic Agent")}})))),n.a.createElement(c.EuiModalFooter,null,n.a.createElement(c.EuiButtonEmpty,{"data-test-subj":"confirmModalCancelButton",onClick:t},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAddAgentModalCancelButtonLabel",defaultMessage:"Add Elastic Agent later"})),n.a.createElement(p.y,{packageKey:a.name,tourType:"agentModalButton",isTourVisible:l,tourPosition:"downCenter",tourOffset:-20},n.a.createElement(c.EuiButton,{"data-test-subj":"confirmModalConfirmButton",onClick:e,fill:!0,color:"primary"},n.a.createElement(i.FormattedMessage,{id:"xpack.fleet.agentPolicy.postInstallAddAgentModalConfirmButtonLabel",defaultMessage:"Add Elastic Agent to your hosts"})))));var o}},385:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var l=a(116),n=a(142);const i=()=>{var e;const t=Object(l.k)(),{data:a,isLoading:i,isFetched:o}=Object(l.r)({full:!0},{enabled:t.fleet.readAgentPolicies}),r=((null==a?void 0:a.items)||[]).filter((e=>Object(n.h)(e))).map((e=>`policy_id:${e.id}`)).join(" or "),c='not (_exists_:"unenrolled_at")'+(r.length?` and not (${r})`:""),{data:s,isLoading:u}=Object(l.s)({page:1,perPage:1,showInactive:!0,kuery:c},{enabled:o});return{isLoading:t.fleet.readAgentPolicies&&(i||u),isFirstTimeAgentUser:t.fleet.readAgentPolicies&&0===(null==s||null===(e=s.data)||void 0===e?void 0:e.total)}}},655:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var l=a(13),n=a(1),i=a.n(n),o=a(22),r=a(101),c=a(266),s=a(8);const u=({legacySwitch:e=!0,children:t})=>{const a=Object(o.useRouteMatch)();return e?Object(s.jsx)(o.Switch,null,t):Object(s.jsx)(r.Routes,null,n.Children.map(t,(e=>{if(i.a.isValidElement(e)&&e.type===c.b){var n;const o=Object(l.replace)(null==e?void 0:e.props.path,a.url+"/",""),u="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(s.jsx)(r.Route,{path:o,element:Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(c.a,null),(null==e||null===(n=e.props)||void 0===n?void 0:n.component)&&Object(s.jsx)(e.props.component,null)||u&&u()||t)})}return e})))}},657:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(658);a(48),a(368),a(369);var n=l.default({key:"css"}),i=n.flush,o=n.hydrate,r=n.cx,c=n.merge,s=n.getRegisteredStyles,u=n.injectGlobal,d=n.keyframes,g=n.css,m=n.sheet,p=n.cache;t.cache=p,t.css=g,t.cx=r,t.flush=i,t.getRegisteredStyles=s,t.hydrate=o,t.injectGlobal=u,t.keyframes=d,t.merge=c,t.sheet=m},658:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(48),n=a(368),i=a(369);function o(e){return e&&e.__esModule?e:{default:e}}var r=o(l);function c(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function s(e,t,a){var l=[],n=i.getRegisteredStyles(e,l,a);return l.length<2?a:n+t(l)}var u=function e(t){for(var a="",l=0;l<t.length;l++){var n=t[l];if(null!=n){var i=void 0;switch(typeof n){case"boolean":break;case"object":if(Array.isArray(n))i=e(n);else for(var o in i="",n)n[o]&&o&&(i&&(i+=" "),i+=o);break;default:i=n}i&&(a&&(a+=" "),a+=i)}}return a};t.default=function(e){var t=r.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];var o=n.serializeStyles(a,t.registered,void 0);return i.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:a,cx:function(){for(var e=arguments.length,l=new Array(e),n=0;n<e;n++)l[n]=arguments[n];return s(t.registered,a,u(l))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];var i=n.serializeStyles(a,t.registered);c(t,i)},keyframes:function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];var i=n.serializeStyles(a,t.registered),o="animation-"+i.name;return c(t,{name:i.name,styles:"@keyframes "+o+"{"+i.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:i.getRegisteredStyles.bind(null,t.registered),merge:s.bind(null,t.registered,a)}}},659:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(660),n=a(662),i=a(664);function o(e){return e&&e.__esModule?e:{default:e}}var r=o(l),c=o(n),s=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},g=function(e){return null!=e&&"boolean"!=typeof e},m=o(i).default((function(e){return d(e)?e:e.replace(s,"-$&").toLowerCase()})),p=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,a){return y={name:t,styles:a,next:y},t}))}return 1===c.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function f(e,t,a){if(null==a)return"";if(void 0!==a.__emotion_styles)return a;switch(typeof a){case"boolean":return"";case"object":if(1===a.anim)return y={name:a.name,styles:a.styles,next:y},a.name;if(void 0!==a.styles){var l=a.next;if(void 0!==l)for(;void 0!==l;)y={name:l.name,styles:l.styles,next:y},l=l.next;return a.styles+";"}return function(e,t,a){var l="";if(Array.isArray(a))for(var n=0;n<a.length;n++)l+=f(e,t,a[n])+";";else for(var i in a){var o=a[i];if("object"!=typeof o)null!=t&&void 0!==t[o]?l+=i+"{"+t[o]+"}":g(o)&&(l+=m(i)+":"+p(i,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var r=f(e,t,o);switch(i){case"animation":case"animationName":l+=m(i)+":"+r+";";break;default:l+=i+"{"+r+"}"}}else for(var c=0;c<o.length;c++)g(o[c])&&(l+=m(i)+":"+p(i,o[c])+";")}return l}(e,t,a);case"function":if(void 0!==e){var n=y,i=a(e);return y=n,f(e,t,i)}}if(null==t)return a;var o=t[a];return void 0!==o?o:a}var y,E=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,a){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var l=!0,n="";y=void 0;var i=e[0];null==i||void 0===i.raw?(l=!1,n+=f(a,t,i)):n+=i[0];for(var o=1;o<e.length;o++)n+=f(a,t,e[o]),l&&(n+=i[o]);E.lastIndex=0;for(var c,s="";null!==(c=E.exec(n));)s+="-"+c[1];return{name:r.default(n)+s,styles:n,next:y}}},660:function(e,t,a){"use strict";e.exports=a(661)},661:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,a=0,l=0,n=e.length;n>=4;++l,n-=4)t=1540483477*(65535&(t=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24))+(59797*(t>>>16)<<16),a=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&a)+(59797*(a>>>16)<<16);switch(n){case 3:a^=(255&e.charCodeAt(l+2))<<16;case 2:a^=(255&e.charCodeAt(l+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(l)))+(59797*(a>>>16)<<16)}return(((a=1540483477*(65535&(a^=a>>>13))+(59797*(a>>>16)<<16))^a>>>15)>>>0).toString(36)}},662:function(e,t,a){"use strict";e.exports=a(663)},663:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},664:function(e,t,a){"use strict";e.exports=a(665)},665:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(a){return void 0===t[a]&&(t[a]=e(a)),t[a]}}},666:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="undefined"!=typeof document,n=function(e,t,a){var n=e.key+"-"+t.name;(!1===a||!1===l&&void 0!==e.compat)&&void 0===e.registered[n]&&(e.registered[n]=t.styles)};t.getRegisteredStyles=function(e,t,a){var l="";return a.split(" ").forEach((function(a){void 0!==e[a]?t.push(e[a]+";"):l+=a+" "})),l},t.insertStyles=function(e,t,a){n(e,t,a);var i=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",r=t;do{var c=e.insert(t===r?"."+i:"",r,e.sheet,!0);l||void 0===c||(o+=c),r=r.next}while(void 0!==r);if(!l&&0!==o.length)return o}},t.registerStyles=n},709:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a(1);var l=a(22),n=a(101),i=a(8);const o=({children:e,...t})=>Object(i.jsx)(l.Router,t,Object(i.jsx)(n.CompatRouter,null,e))}}]);