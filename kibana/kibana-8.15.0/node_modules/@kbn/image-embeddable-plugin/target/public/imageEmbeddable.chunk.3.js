(window.imageEmbeddable_bundle_jsonpfunction=window.imageEmbeddable_bundle_jsonpfunction||[]).push([[3,4],{26:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),i=n(10),a=r.__importDefault(n(35));t.default=function(e,t){var n=i.useState(t),r=n[0],o=n[1];return a.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),r}},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(10);const i=Object(r.createContext)(null),a=()=>{const e=Object(r.useContext)(i);if(!e)throw new Error("ImageViewerContext is not found!");return e}},28:function(e,t,n){e.exports=n(14)(4)},29:function(e,t,n){e.exports=n(14)(2)},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=n(19).DefaultFileKind.kind},31:function(e,t,n){"use strict";var r,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function o(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],i=0;i<e.length;i++){var c=e[i],s=t.base?c[0]+t.base:c[0],l=n[s]||0,u="".concat(s," ").concat(l);n[s]=l+1;var d=o(u),f={css:c[1],media:c[2],sourceMap:c[3]};-1!==d?(a[d].references++,a[d].updater(f)):a.push({identifier:u,updater:b(f,t),references:1}),r.push(u)}return r}function s(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var a=n.nc;a&&(r.nonce=a)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function f(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,g=0;function b(e,t){var n,r,i;if(t.singleton){var a=g++;n=m||(m=s(t)),r=d.bind(null,n,a,!1),i=d.bind(null,n,a,!0)}else n=s(t),r=f.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=o(n[r]);a[i].references--}for(var s=c(e,t),l=0;l<n.length;l++){var u=o(n[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=s}}}},32:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,r,i,a=e[1]||"",o=e[3];if(!o)return a;if(t&&"function"==typeof btoa){var c=(n=o,r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(i," */")),s=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[a].concat(s).concat([c]).join("\n")}return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var c=0;c<e.length;c++){var s=[].concat(e[c]);r&&i[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},33:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2);const i=/^(?:(?:https?):|[^&:/?#]*(?:[/?#]|$))/gi,a=r.i18n.translate("imageEmbeddable.imageEditor.urlFormatGeneralErrorMessage",{defaultMessage:"Invalid format. Example: {exampleUrl}",values:{exampleUrl:"https://elastic.co/my-image.png"}}),o=r.i18n.translate("imageEmbeddable.imageEditor.urlFormatExternalErrorMessage",{defaultMessage:'This URL is not allowed by your administrator. Refer to "externalUrl.policy" configuration.'});function c(e){return t=>{if(!t)return{isValid:!1,error:a};try{if(new URL(t),!t.match(i))throw new Error;return e.validateUrl(t)?{isValid:!0}:{isValid:!1,error:o}}catch(e){return{isValid:!1,error:a}}}}},35:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=i},36:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var r=void 0;t.setEuiDevProviderWarning=function(e){return r=e},t.getEuiDevProviderWarning=function(){return r},t.emitEuiProviderWarning=function(e){if("function"==typeof r)return r(e);switch(r){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},40:function(e,t,n){"use strict";n.r(t),n.d(t,"openImageEditor",(function(){return R}));var r=n(10),i=n(41),a=n(13),o=n.n(a),c=n(28),s=n.n(c),l=n(15),u=n(36),d=n(26),f=n.n(d),m=n(16),g=n.n(m),b=n(12);const v="eui-global",p="eui-utilities",h={darkMode:!1};var y=n(11);const j=[b.euiStylisPrefixer],E=g()({key:"css",stylisPlugins:j,container:document.querySelector('meta[name="emotion"]')}),O=g()({key:v,stylisPlugins:j,container:document.querySelector(`meta[name="${v}"]`)}),x=g()({key:p,stylisPlugins:j,container:document.querySelector(`meta[name="${p}"]`)});E.compat=!0,O.compat=!0,x.compat=!0;const w={default:E,global:O,utility:x},C=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:i,children:a})=>{const o=f()(e,h),c=Object(r.useMemo)((()=>(e=>e.darkMode?b.COLOR_MODES_STANDARD.dark:b.COLOR_MODES_STANDARD.light)(o)),[o]),s=n||c,l=!1!==t&&void 0;return Object(y.jsx)(b.EuiProvider,{cache:w,modify:i,colorMode:s,globalStyles:l,utilityClasses:l},a)},S=({children:e,i18n:t,...n})=>Object(l.useIsNestedEuiProvider)()?(Object(u.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(y.jsx)(t.Context,null,e)):Object(y.jsx)(C,n,Object(y.jsx)(t.Context,null,e));var D=n(18);const M=({children:e,...t})=>Object(y.jsx)(S,s()({globalStyles:!1},t),Object(y.jsx)(D.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(y.jsx)(D.KibanaErrorBoundary,null,e)));n(29),n(2),r.Component;var P=n(45),A=n(30),_=n(0),k=n(33),I=n(27);const R=async({parentApi:e,initialImageConfig:t})=>{const{ImageEditorFlyout:r}=await Promise.all([n.e(1),n.e(7)]).then(n.bind(null,71)),{overlays:a,theme:c,i18n:s,http:l,security:u}=_.a,d=await u.authc.getCurrentUser(),f=_.b.filesClientFactory.asUnscoped(),m=Object(i.tracksOverlays)(e)?e:void 0;return new Promise(((e,n)=>{const i=()=>{n(),u.close(),null==m||m.clearOverlays()},u=a.openFlyout((g=Object(y.jsx)(P.a,{client:f},Object(y.jsx)(I.a.Provider,{value:{getImageDownloadHref:e=>f.getDownloadHref({id:e,fileKind:A.a.id}),validateUrl:Object(k.a)(l.externalUrl)}},Object(y.jsx)(r,{user:d,onCancel:i,onSave:t=>{e(t),u.close(),null==m||m.clearOverlays()},initialImageConfig:t}))),b={theme:c,i18n:s},e=>(o.a.render(Object(y.jsx)(M,b,g),e),()=>o.a.unmountComponentAtNode(e))),{onClose:()=>{i()},ownFocus:!0,"data-test-subj":"createImageEmbeddableFlyout"});var g,b;null==m||m.openOverlay(u)}))}},43:function(e,t,n){"use strict";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty,o="undefined"!=typeof Element;function c(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,s,l,u=r(e),d=r(t);if(u&&d){if((s=e.length)!=t.length)return!1;for(n=s;0!=n--;)if(!c(e[n],t[n]))return!1;return!0}if(u!=d)return!1;var f=e instanceof Date,m=t instanceof Date;if(f!=m)return!1;if(f&&m)return e.getTime()==t.getTime();var g=e instanceof RegExp,b=t instanceof RegExp;if(g!=b)return!1;if(g&&b)return e.toString()==t.toString();var v=i(e);if((s=v.length)!==i(t).length)return!1;for(n=s;0!=n--;)if(!a.call(t,v[n]))return!1;if(o&&e instanceof Element&&t instanceof Element)return e===t;for(n=s;0!=n--;)if(!("_owner"===(l=v[n])&&e.$$typeof||c(e[l],t[l])))return!1;return!0}return e!=e&&t!=t}e.exports=function(e,t){try{return c(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},45:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(10),i=n(11);const a=Object(r.createContext)(null),o=()=>{const e=Object(r.useContext)(a);if(!e)throw new Error("FilesContext is not found!");return e},c=({client:e,children:t})=>Object(i.jsx)(a.Provider,{value:{client:e}},t)},46:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(47);case"v8light":return n(49)}},47:function(e,t,n){var r=n(31),i=n(48);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);r(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},48:function(e,t,n){(t=n(32)(!1)).push([e.i,".react-grid-item img.imageEmbeddableImage{pointer-events:auto;-webkit-user-select:initial;user-select:auto}",""]),e.exports=t},49:function(e,t,n){var r=n(31),i=n(50);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);r(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},50:function(e,t,n){(t=n(32)(!1)).push([e.i,".react-grid-item img.imageEmbeddableImage{pointer-events:auto;-webkit-user-select:initial;user-select:auto}",""]),e.exports=t},70:function(e,t,n){"use strict";n.r(t),n.d(t,"getImageEmbeddableFactory",(function(){return E}));var r=n(10),i=n.n(r),a=n(43),o=n.n(a),c=n(5),s=n(2),l=n(37),u=n(3),d=n(40),f=n(30),m=n(0),g=n(33),b=n(11),v=n(27);const p=i.a.lazy((()=>n.e(1).then(n.bind(null,51)).then((e=>({default:e.ImageViewer}))))),h=e=>Object(b.jsx)(i.a.Suspense,{fallback:Object(b.jsx)(i.a.Fragment,null)},Object(b.jsx)(p,e));n(46);const y=({api:e,filesClient:t})=>{var n;const[i,a]=Object(l.e)(e.imageConfig$,null!==(n=e.dynamicActionsState$)&&void 0!==n?n:new c.BehaviorSubject(void 0)),[o,s]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{e.setDataLoading(!0)}),[e,i]),Object(r.useEffect)((()=>{var e;s((null!==(e=null==a?void 0:a.dynamicActions.events)&&void 0!==e?e:[]).length>0)}),[a]),Object(b.jsx)(v.a.Provider,{value:{getImageDownloadHref:e=>t.getDownloadHref({id:e,fileKind:f.a.id}),validateUrl:Object(g.a)(m.a.http.externalUrl)}},Object(b.jsx)(h,{"data-shared-item":"","data-rendering-count":1,className:"imageEmbeddableImage",imageConfig:i,isScreenshotMode:null===m.c||void 0===m.c?void 0:m.c.isScreenshotMode(),onLoad:()=>{e.setDataLoading(!1)},onError:()=>{e.setDataLoading(!1)},onClick:o?()=>{m.e.executeTriggerActions(u.b.id,{embeddable:e})}:void 0}))};var j=n(1);const E=({embeddableEnhanced:e})=>({type:j.b,deserializeState:e=>e.rawState,buildEmbeddable:async(t,n,i)=>{var a,f;const{titlesApi:g,titleComparators:v,serializeTitles:p}=Object(l.d)(t),h=null==e?void 0:e.initializeReactEmbeddableDynamicActions(i,(()=>g.panelTitle.getValue()),t),j=null==h?void 0:h.startDynamicActions(),E=m.b.filesClientFactory.asUnscoped(),O=new c.BehaviorSubject(t.imageConfig),x=new c.BehaviorSubject(!0),w=n({...g,...null!==(a=null==h?void 0:h.dynamicActionsApi)&&void 0!==a?a:{},dataLoading:x,supportedTriggers:()=>[u.a],onEdit:async()=>{try{const e=await Object(d.openImageEditor)({parentApi:w.parentApi,initialImageConfig:O.getValue()});O.next(e)}catch{}},isEditingEnabled:()=>!0,getTypeDisplayName:()=>s.i18n.translate("imageEmbeddable.imageEmbeddableFactory.displayName.edit",{defaultMessage:"image"}),serializeState:()=>{var e;return{rawState:{...p(),...null!==(e=null==h?void 0:h.serializeDynamicActions())&&void 0!==e?e:{},imageConfig:O.getValue()}}}},{...v,...null!==(f=null==h?void 0:h.dynamicActionsComparator)&&void 0!==f?f:{enhancements:Object(l.c)()},imageConfig:[O,e=>O.next(e),(e,t)=>o()(e,t)]});return{api:w,Component:()=>{const e=Object(r.useMemo)((()=>({...w,imageConfig$:O,setDataLoading:e=>x.next(e)})),[]);return Object(r.useEffect)((()=>()=>{null==j||j.stopDynamicActions()}),[]),Object(b.jsx)(y,{api:e,filesClient:E})}}}})}}]);