(window.imageEmbeddable_bundle_jsonpfunction=window.imageEmbeddable_bundle_jsonpfunction||[]).push([[5],{31:function(e,t,i){"use strict";var s,l=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),n=[];function a(e){for(var t=-1,i=0;i<n.length;i++)if(n[i].identifier===e){t=i;break}return t}function r(e,t){for(var i={},s=[],l=0;l<e.length;l++){var r=e[l],c=t.base?r[0]+t.base:r[0],o=i[c]||0,d="".concat(c," ").concat(o);i[c]=o+1;var u=a(d),h={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(n[u].references++,n[u].updater(h)):n.push({identifier:d,updater:f(h,t),references:1}),s.push(d)}return s}function c(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var n=i.nc;n&&(s.nonce=n)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var a=l(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var o,d=(o=[],function(e,t){return o[e]=t,o.filter(Boolean).join("\n")});function u(e,t,i,s){var l=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=d(t,l);else{var n=document.createTextNode(l),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(n,a[t]):e.appendChild(n)}}function h(e,t,i){var s=i.css,l=i.media,n=i.sourceMap;if(l?e.setAttribute("media",l):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var p=null,b=0;function f(e,t){var i,s,l;if(t.singleton){var n=b++;i=p||(p=c(t)),s=u.bind(null,i,n,!1),l=u.bind(null,i,n,!0)}else i=c(t),s=h.bind(null,i,t),l=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else l()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var i=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<i.length;s++){var l=a(i[s]);n[l].references--}for(var c=r(e,t),o=0;o<i.length;o++){var d=a(i[o]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}i=c}}}},32:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,s,l,n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(i=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),c=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[n].concat(c).concat([r]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,s){"string"==typeof e&&(e=[[null,e,""]]);var l={};if(s)for(var n=0;n<this.length;n++){var a=this[n][0];null!=a&&(l[a]=!0)}for(var r=0;r<e.length;r++){var c=[].concat(e[r]);s&&l[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),t.push(c))}},t}},55:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i(26),l=i.n(s);function n(e){return l()(e,e.getValue())}},56:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(57);case"v8light":return i(59)}},57:function(e,t,i){var s=i(31),l=i(58);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);s(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},58:function(e,t,i){(t=i(32)(!1)).push([e.i,".filesFilePicker .euiCard__content,.filesFilePicker .euiCard__description{margin:0}",""]),e.exports=t},59:function(e,t,i){var s=i(31),l=i(60);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);s(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},60:function(e,t,i){(t=i(32)(!1)).push([e.i,".filesFilePicker .euiCard__content,.filesFilePicker .euiCard__description{margin:0}",""]),e.exports=t},61:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(10);t.default=function(){var e=s.useRef(!1),t=s.useCallback((function(){return e.current}),[]);return s.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},69:function(e,t,i){"use strict";i.r(t),i.d(t,"FilePicker",(function(){return V}));var s=i(28),l=i.n(s),n=i(10),a=i.n(n),r=i(26),c=i.n(r),o=i(12),d=i(11),u=i(55),h=i(45),p=i(29),b=i.n(p),f=i(5);function j(e){return e.includes("*")?e:`*${e}*`}class file_picker_state_FilePickerState{constructor(e,t,i,s){b()(this,"selectedFiles$",new f.BehaviorSubject([])),b()(this,"selectedFileIds$",this.selectedFiles$.pipe(f.map((e=>e.map((e=>e.id)))))),b()(this,"isLoading$",new f.BehaviorSubject(!0)),b()(this,"loadingError$",new f.BehaviorSubject(void 0)),b()(this,"hasFiles$",new f.BehaviorSubject(!1)),b()(this,"hasQuery$",new f.BehaviorSubject(!1)),b()(this,"query$",new f.BehaviorSubject(void 0)),b()(this,"queryDebounced$",this.query$.pipe(f.debounceTime(100))),b()(this,"currentPage$",new f.BehaviorSubject(0)),b()(this,"totalPages$",new f.BehaviorSubject(void 0)),b()(this,"isUploading$",new f.BehaviorSubject(!1)),b()(this,"deletePrompt$",new f.BehaviorSubject(null)),b()(this,"selectedFiles",new Map),b()(this,"retry$",new f.BehaviorSubject(void 0)),b()(this,"subscriptions",[]),b()(this,"internalIsLoading$",new f.BehaviorSubject(!0)),b()(this,"requests$",f.combineLatest([this.currentPage$.pipe(f.distinctUntilChanged()),this.query$.pipe(f.distinctUntilChanged()),this.retry$]).pipe(f.tap((()=>this.setIsLoading(!0))),f.debounceTime(100))),b()(this,"files$",this.requests$.pipe(f.switchMap((([e,t])=>this.sendRequest(e,t))),f.tap((({total:e})=>this.updateTotalPages({total:e}))),f.tap((({total:e})=>this.hasFiles$.next(Boolean(e)))),f.map((({files:e})=>e)),f.shareReplay())),b()(this,"updateTotalPages",(({total:e})=>{this.totalPages$.next(Math.ceil(e/this.pageSize))})),b()(this,"selectFile",(e=>{const t=Array.isArray(e)?e:[e];if(this.selectMultiple)for(const e of t)this.selectedFiles.set(e.id,e);else this.selectedFiles.clear(),this.selectedFiles.set(t[0].id,t[0]);this.sendNextSelectedFiles()})),b()(this,"abort",void 0),b()(this,"sendRequest",((e,t)=>{if(this.isUploading$.getValue())return f.EMPTY;this.abort&&this.abort(),this.setIsLoading(!0),this.loadingError$.next(void 0);const i=new AbortController;this.abort=()=>{try{i.abort()}catch(e){}};const s=f.from(this.client.list({kind:this.kind,name:t?[j(t)]:void 0,page:e+1,status:["READY"],perPage:this.pageSize,abortSignal:i.signal})).pipe(f.catchError((e=>("AbortError"!==e.name&&(this.setIsLoading(!1),this.loadingError$.next(e)),f.EMPTY))),f.tap((()=>{this.setIsLoading(!1),this.abort=void 0})),f.shareReplay());return s.subscribe(),s})),b()(this,"retry",(()=>{this.retry$.next()})),b()(this,"resetFilters",(()=>{this.setQuery(void 0),this.setPage(0),this.retry()})),b()(this,"hasFilesSelected",(()=>this.selectedFiles.size>0)),b()(this,"unselectFile",(e=>{this.selectedFiles.delete(e)&&this.sendNextSelectedFiles()})),b()(this,"isFileIdSelected",(e=>this.selectedFiles.has(e))),b()(this,"getSelectedFileIds",(()=>Array.from(this.selectedFiles.keys()))),b()(this,"setQuery",(e=>{e?this.query$.next(e):this.query$.next(void 0),this.currentPage$.next(0)})),b()(this,"setPage",(e=>{this.currentPage$.next(e)})),b()(this,"setIsUploading",(e=>{this.isUploading$.next(e)})),b()(this,"dispose",(()=>{for(const e of this.subscriptions)e.unsubscribe()})),b()(this,"showDeletePrompt",(e=>{this.deletePrompt$.next(e)})),b()(this,"hideDeletePrompt",(()=>{this.deletePrompt$.next(null)})),b()(this,"delete",(async e=>{await this.client.delete({id:e.id,kind:e.fileKind})})),b()(this,"watchFileSelected$",(e=>this.selectedFiles$.pipe(f.map((()=>this.selectedFiles.has(e))),f.distinctUntilChanged()))),this.client=e,this.kind=t,this.pageSize=i,this.selectMultiple=s,this.subscriptions=[this.query$.pipe(f.map((e=>Boolean(e))),f.distinctUntilChanged()).subscribe(this.hasQuery$),this.internalIsLoading$.pipe(f.distinctUntilChanged()).subscribe(this.isLoading$)]}sendNextSelectedFiles(){this.selectedFiles$.next(Array.from(this.selectedFiles.values()))}setIsLoading(e){this.internalIsLoading$.next(e)}}const g=Object(n.createContext)(null),m=({kind:e,shouldAllowDelete:t,pageSize:i,multiple:s,children:l,uploadMeta:a})=>{const r=Object(h.b)(),{client:c}=r,o=Object(n.useMemo)((()=>(({pageSize:e,client:t,kind:i,selectMultiple:s})=>new file_picker_state_FilePickerState(t,i,e,s))({pageSize:i,client:c,kind:e,selectMultiple:s})),[i,c,e,s]);return Object(n.useEffect)((()=>o.dispose),[o]),Object(d.jsx)(g.Provider,{value:{state:o,kind:e,shouldAllowDelete:t,uploadMeta:a,...r}},l)},x=()=>{const e=Object(n.useContext)(g);if(!e)throw new Error("FilePickerContext not found!");return e};var y=i(2);const O={title:y.i18n.translate("sharedUXPackages.filePicker.title",{defaultMessage:"Select a file"}),titleMultiple:y.i18n.translate("sharedUXPackages.filePicker.titleMultiple",{defaultMessage:"Select files"}),loadingFilesErrorTitle:y.i18n.translate("sharedUXPackages.filePicker.error.loadingTitle",{defaultMessage:"Could not load files"}),retryButtonLabel:y.i18n.translate("sharedUXPackages.filePicker.error.retryButtonLabel",{defaultMessage:"Retry"}),emptyStatePrompt:y.i18n.translate("sharedUXPackages.filePicker.emptyStatePromptTitle",{defaultMessage:"Upload your first file"}),selectFileLabel:y.i18n.translate("sharedUXPackages.filePicker.selectFileButtonLable",{defaultMessage:"Select file"}),selectFilesLabel:e=>y.i18n.translate("sharedUXPackages.filePicker.selectFilesButtonLable",{defaultMessage:"Select {nrOfFiles} files",values:{nrOfFiles:e}}),searchFieldPlaceholder:y.i18n.translate("sharedUXPackages.filePicker.searchFieldPlaceholder",{defaultMessage:"my-file-*"}),emptyFileGridPrompt:y.i18n.translate("sharedUXPackages.filePicker.emptyGridPrompt",{defaultMessage:"No files match your filter"}),loadMoreButtonLabel:y.i18n.translate("sharedUXPackages.filePicker.loadMoreButtonLabel",{defaultMessage:"Load more"}),clearFilterButton:y.i18n.translate("sharedUXPackages.filePicker.clearFilterButtonLabel",{defaultMessage:"Clear filter"}),uploadFilePlaceholderText:y.i18n.translate("sharedUXPackages.filePicker.uploadFilePlaceholderText",{defaultMessage:"Drag and drop to upload new files"}),delete:y.i18n.translate("sharedUXPackages.filePicker.delete",{defaultMessage:"Delete"}),deleteFile:y.i18n.translate("sharedUXPackages.filePicker.deleteFile",{defaultMessage:"Delete file"}),cancel:y.i18n.translate("sharedUXPackages.filePicker.cancel",{defaultMessage:"Cancel"}),deleteFileQuestion:e=>y.i18n.translate("sharedUXPackages.filePicker.deleteFileQuestion",{defaultMessage:'Are you sure you want to delete "{fileName}"?',values:{fileName:e}})},v=({multiple:e})=>Object(d.jsx)(o.EuiTitle,null,Object(d.jsx)("h2",null,e?O.titleMultiple:O.title)),P=({error:e})=>{const{state:t}=x(),i=Object(u.a)(t.isLoading$);return Object(d.jsx)(o.EuiEmptyPrompt,{"data-test-subj":"errorPrompt",iconType:"warning",iconColor:"danger",titleSize:"xs",title:Object(d.jsx)("h3",null,O.loadingFilesErrorTitle),body:e.message,actions:Object(d.jsx)(o.EuiButton,{disabled:i,onClick:t.retry},O.retryButtonLabel)})};var k=i(68);const F=({kind:e,multiple:t})=>{const{state:i,uploadMeta:s}=x(),{euiTheme:l}=Object(o.useEuiTheme)();return Object(d.jsx)(o.EuiEmptyPrompt,{"data-test-subj":"emptyPrompt",title:Object(d.jsx)("h3",null,O.emptyStatePrompt),titleSize:"s",actions:[Object(d.jsx)(k.a,{css:Object(d.css)("min-width:calc(",l.size.xxxl," * 6);",""),meta:s,kind:e,immediate:!0,multiple:t,onDone:e=>{i.selectFile(e.map((({fileJSON:e})=>e))),i.retry()}})]})};var $=i(24),S=i.n($),w=i(67),M=i(66);i(56);var E={name:"t21r8a",styles:"place-self:stretch;>*{width:100%;}"},C={name:"50zrmy",styles:"text-transform:uppercase"},U={name:"ucb1au",styles:"overflow:hidden;white-space:nowrap;text-overflow:ellipsis"},B={name:"bqn2sj",styles:"position:relative;&:hover > button{display:block;}"};const T=({file:e})=>{var t;const{kind:i,state:s,client:l,shouldAllowDelete:r}=x(),{euiTheme:u}=Object(o.useEuiTheme)(),h=Object(w.c)({type:e.mimeType}),p=Object(n.useMemo)((()=>s.watchFileSelected$(e.id)),[e.id,s]),b=c()(p,!1),f=`calc(${u.size.xxxl} * 2)`,j=Object(d.jsx)("div",{css:Object(d.css)("display:grid;place-items:center;height:",f,";margin:",u.size.m,";","")},h?Object(d.jsx)(M.a,{alt:null!==(t=e.alt)&&void 0!==t?t:"",css:Object(d.css)("max-height:",f,";",""),meta:e.meta,src:l.getDownloadHref({id:e.id,fileKind:i}),loading:"lazy"}):Object(d.jsx)("div",{css:Object(d.css)("display:grid;place-items:center;height:",f,";","")},Object(d.jsx)(o.EuiIcon,{type:"filebeatApp",size:"xl"}))),g=Object(d.jsx)(a.a.Fragment,null,Object(d.jsx)(o.EuiText,{size:"s",css:U},Object(d.jsx)("strong",null,e.name)),Object(d.jsx)(o.EuiText,{color:"subdued",size:"xs"},S()(e.size).format("0[.]0 b"),e.extension&&Object(d.jsx)(a.a.Fragment,null,"  ·  ",Object(d.jsx)("span",{css:C},e.extension)))),m=r&&r(e)&&Object(d.jsx)(o.EuiButtonIcon,{iconType:"trash","aria-label":O.delete,color:"danger",css:Object(d.css)({position:"absolute",right:`${u.size.s}`,top:`${u.size.s}`,display:"none"},"",""),onClick:()=>s.showDeletePrompt(e)});return Object(d.jsx)("div",{css:B},Object(d.jsx)(o.EuiCard,{title:"",css:E,paddingSize:"s",selectable:{isSelected:b,onClick:()=>b?s.unselectFile(e.id):s.selectFile(e)},image:j,description:g,hasBorder:!0}),m)},L=()=>{const{state:e}=x(),{euiTheme:t}=Object(o.useEuiTheme)(),i=c()(e.files$,[]);return i.length?Object(d.jsx)("div",{"data-test-subj":"fileGrid",css:Object(d.css)("display:grid;grid-template-columns:repeat(auto-fill, minmax(calc(",t.size.xxxxl," * 3), 1fr));gap:",t.size.m,";","")},i.map(((e,t)=>Object(d.jsx)(T,{key:t,file:e})))):Object(d.jsx)(o.EuiEmptyPrompt,{title:Object(d.jsx)("h3",null,O.emptyFileGridPrompt),titleSize:"s"})},z=()=>{const{state:e}=x(),t=Object(u.a)(e.query$),i=Object(u.a)(e.isLoading$),s=Object(u.a)(e.hasFiles$),l=Object(u.a)(e.isUploading$);return Object(d.jsx)(o.EuiFieldSearch,{"data-test-subj":"searchField",disabled:l||!t&&!s,isLoading:i,value:null!=t?t:"",placeholder:O.searchFieldPlaceholder,onChange:t=>e.setQuery(t.target.value)})},_=()=>{const{state:e}=x(),t=Object(u.a)(e.currentPage$),i=c()(e.files$,[]),s=Object(u.a)(e.totalPages$),l=Object(u.a)(e.isUploading$);return 0===i.length?null:Object(d.jsx)(o.EuiPagination,{"data-test-subj":"paginationControls",onPageClick:l?()=>{}:e.setPage,pageCount:s,activePage:t})},D=({onClick:e})=>{const{state:t}=x(),i=Object(u.a)(t.isUploading$),s=Object(u.a)(t.selectedFiles$);return Object(d.jsx)(o.EuiButton,{"data-test-subj":"selectButton",disabled:i||!t.hasFilesSelected(),onClick:()=>e(s)},s.length>1?O.selectFilesLabel(s.length):O.selectFileLabel)};var I={name:"1w4dlxi",styles:"place-self:end"},A={name:"1fystu3",styles:"place-self:center"},N={name:"mdm104",styles:"place-self:stretch"},X={name:"jhc76r",styles:"display:grid;grid-template-columns:1fr 1fr 1fr;align-items:center;width:100%"};const q=({kind:e,onDone:t,onUpload:i,multiple:s})=>{const{state:l,uploadMeta:a}=x(),r=Object(n.useCallback)((()=>l.setIsUploading(!0)),[l]),c=Object(n.useCallback)((()=>l.setIsUploading(!1)),[l]);return Object(d.jsx)(o.EuiModalFooter,null,Object(d.jsx)("div",{css:X},Object(d.jsx)("div",{css:N},Object(d.jsx)(k.a,{onDone:e=>{l.selectFile(e.map((({fileJSON:e})=>e))),l.resetFilters(),null==i||i(e)},meta:a,onUploadStart:r,onUploadEnd:c,kind:e,initialPromptText:O.uploadFilePlaceholderText,multiple:s,compressed:!0})),Object(d.jsx)("div",{css:A},Object(d.jsx)(_,null)),Object(d.jsx)("div",{css:I},Object(d.jsx)(D,{onClick:t}))))};var R={name:"1dfmss9",styles:"display:grid;place-items:center"};const Q=({onClick:e})=>{const{state:t}=x(),i=Object(u.a)(t.isUploading$);return c()(t.queryDebounced$)?Object(d.jsx)("div",{css:R},Object(d.jsx)(o.EuiLink,{disabled:i,onClick:e},O.clearFilterButton)):null};var G=i(61),H=i.n(G);const J=()=>{const[e,t]=n.useState(!1),i=H()(),{state:s}=x(),l=Object(u.a)(s.deletePrompt$);return l?Object(d.jsx)(o.EuiConfirmModal,{buttonColor:"danger",defaultFocusedButton:"confirm",isLoading:e,title:O.deleteFile,confirmButtonText:O.delete,cancelButtonText:O.cancel,onCancel:s.hideDeletePrompt,onConfirm:()=>{t(!0),s.delete(l).finally((()=>{s.hideDeletePrompt(),s.retry(),i()&&t(!1)}))}},Object(d.jsx)("p",null,O.deleteFileQuestion(l.name))):null};var Y={name:"13udsys",styles:"height:100%"};const K=({onClose:e,onDone:t,onUpload:i,multiple:s})=>{const{state:l,kind:n}=x(),{euiTheme:r}=Object(o.useEuiTheme)(),h=Object(u.a)(l.hasFiles$),p=Object(u.a)(l.hasQuery$),b=Object(u.a)(l.isLoading$),f=Object(u.a)(l.loadingError$);c()(l.files$);const j=()=>Object(d.jsx)(q,{kind:n,onDone:t,onUpload:i,multiple:s}),g=Object(d.jsx)(o.EuiModal,{"data-test-subj":"filePickerModal",className:"filesFilePicker filesFilePicker--fixed",maxWidth:"75vw",onClose:e,css:Object(d.css)("@media screen and (min-width: ",r.breakpoint.l,"px){width:75vw;height:75vh;}","")},Object(d.jsx)(o.EuiModalHeader,null,Object(d.jsx)(v,{multiple:s}),Object(d.jsx)(z,null)),b?Object(d.jsx)(a.a.Fragment,null,Object(d.jsx)(o.EuiModalBody,null,Object(d.jsx)(o.EuiFlexGroup,{css:Y,justifyContent:"center",alignItems:"center",gutterSize:"none"},Object(d.jsx)(o.EuiLoadingSpinner,{"data-test-subj":"loadingSpinner",size:"xl"}))),j()):Boolean(f)?Object(d.jsx)(o.EuiModalBody,null,Object(d.jsx)(P,{error:f})):h||p?Object(d.jsx)(a.a.Fragment,null,Object(d.jsx)(o.EuiModalBody,null,Object(d.jsx)(L,null),Object(d.jsx)(o.EuiSpacer,null),Object(d.jsx)(Q,{onClick:()=>l.setQuery(void 0)})),j()):Object(d.jsx)(o.EuiModalBody,null,Object(d.jsx)(F,{multiple:s,kind:n})));return Object(d.jsx)(a.a.Fragment,null,g,Object(d.jsx)(J,null))},V=({pageSize:e=20,kind:t,shouldAllowDelete:i,multiple:s=!1,uploadMeta:n,onUpload:a=(()=>{}),...r})=>Object(d.jsx)(m,{pageSize:e,kind:t,uploadMeta:n,multiple:s,shouldAllowDelete:i},Object(d.jsx)(K,l()({},r,{pageSize:e,kind:t,multiple:s,onUpload:a})));t.default=V}}]);