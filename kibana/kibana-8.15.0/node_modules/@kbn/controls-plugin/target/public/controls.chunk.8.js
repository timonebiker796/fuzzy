(window.controls_bundle_jsonpfunction=window.controls_bundle_jsonpfunction||[]).push([[8],{109:function(e,t,o){"use strict";o.r(t),o.d(t,"EditControlAction",(function(){return edit_control_action_EditControlAction}));var n=o(1),i=o.n(n),a=(o(4),o(6)),r=o(24),d=o(71),c=o(50),l=o(17),s=o(19),b=o(20),u=o(68),h=o(27),p=o(2),m=o(75),g=o(3);const w=({embeddable:e,closeFlyout:t,removeControl:o})=>{const{overlays:{openConfirm:n},controls:{getControlFactory:i}}=s.a.getServices(),a=Object(u.useControlGroupContainer)(),d=a.select((e=>e.explicitInput.panels))[e.id];return Object(g.jsx)(m.a,{isCreate:!1,width:d.width,grow:d.grow,embeddable:e,onCancel:e=>{Object(p.isEqual)(d.explicitInput,{...d.explicitInput,...e.input})&&e.grow===d.grow&&e.width===d.width?t():n(b.a.management.discardChanges.getSubtitle(),{confirmButtonText:b.a.management.discardChanges.getConfirm(),cancelButtonText:b.a.management.discardChanges.getCancel(),title:b.a.management.discardChanges.getTitle(),buttonColor:"danger"}).then((e=>{e&&t()}))},setLastUsedDataViewId:e=>a.setLastUsedDataViewId(e),onSave:async(o,n)=>{if(!n)return void t();const c=i(n);if(!c)throw new r.EmbeddableFactoryNotFoundError(n);let l=o.input;c.presaveTransformFunction&&(l=c.presaveTransformFunction(l,e)),o.width&&o.width!==d.width&&a.dispatch.setControlWidth({width:o.width,embeddableId:e.id}),void 0!==o.grow&&o.grow!==d.grow&&a.dispatch.setControlGrow({grow:o.grow,embeddableId:e.id}),t(),d.type===n?a.updateInputForChild(e.id,l):await a.replaceEmbeddable(e.id,l,n)},removeControl:()=>{t(),o()}})};class edit_control_action_EditControlAction{constructor(e){i()(this,"type",l.b),i()(this,"id",l.b),i()(this,"order",2),i()(this,"getEmbeddableFactory",void 0),i()(this,"openFlyout",void 0),i()(this,"theme",void 0),i()(this,"i18n",void 0),i()(this,"MenuItem",(({context:e})=>{const{embeddable:t}=e;return Object(g.jsx)(a.EuiToolTip,{content:this.getDisplayName(e)},Object(g.jsx)(a.EuiButtonIcon,{"data-test-subj":`control-action-${t.id}-edit`,"aria-label":this.getDisplayName(e),iconType:this.getIconType(e),onClick:()=>this.execute(e),color:"text"}))})),this.deleteControlAction=e,({embeddable:{getEmbeddableFactory:this.getEmbeddableFactory},overlays:{openFlyout:this.openFlyout},core:{theme:this.theme,i18n:this.i18n}}=s.a.getServices())}getDisplayName({embeddable:e}){if(!e.parent||!Object(h.c)(e.parent))throw new c.IncompatibleActionError;return b.a.floatingActions.getEditButtonTitle()}getIconType({embeddable:e}){if(!e.parent||!Object(h.c)(e.parent))throw new c.IncompatibleActionError;return"pencil"}async isCompatible({embeddable:e}){if(Object(r.isErrorEmbeddable)(e))return!1;const t=e.parent,o=this.getEmbeddableFactory(e.type);return Boolean(t&&Object(h.c)(t)&&t.getInput().viewMode===r.ViewMode.EDIT&&o&&await o.isEditable())}async execute({embeddable:e}){if(!e.parent||!Object(h.c)(e.parent))throw new c.IncompatibleActionError;const t=e.parent,o=this.openFlyout(Object(d.a)(Object(g.jsx)(u.ControlGroupContainerContext.Provider,{value:t},Object(g.jsx)(w,{embeddable:e,removeControl:()=>this.deleteControlAction.execute({embeddable:e}),closeFlyout:()=>{Object(u.setFlyoutRef)(void 0),o.close()}})),{theme:this.theme,i18n:this.i18n}),{"aria-label":b.a.manageControl.getFlyoutEditTitle(),outsideClickCloses:!1,onClose:e=>{Object(u.setFlyoutRef)(void 0),e.close()},ownFocus:!0});Object(u.setFlyoutRef)(o)}}}}]);