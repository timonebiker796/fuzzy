/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.painlessLab_bundle_jsonpfunction=window.painlessLab_bundle_jsonpfunction||[]).push([[1],{27:function(e,t,n){e.exports=n(20)(4)},28:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(23),a=n(13),i=s.__importDefault(n(29));t.default=function(e,t){var n=a.useState(t),s=n[0],o=n[1];return i.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),s}},29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(13),a="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=a},30:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var s=void 0;t.setEuiDevProviderWarning=function(e){return s=e},t.getEuiDevProviderWarning=function(){return s},t.emitEuiProviderWarning=function(e){if("function"==typeof s)return s(e);switch(s){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},31:function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return se}));var s=n(13),a=n.n(s),i=n(19),o=n(17),r=n(27),l=n.n(r),c=n(21),u=n(30),d=n(28),p=n.n(d),b=n(22),j=n.n(b),x=n(15);const g="eui-global",f="eui-utilities",O={darkMode:!1};var h=n(14);const m=[x.euiStylisPrefixer],y=j()({key:"css",stylisPlugins:m,container:document.querySelector('meta[name="emotion"]')}),E=j()({key:g,stylisPlugins:m,container:document.querySelector(`meta[name="${g}"]`)}),L=j()({key:f,stylisPlugins:m,container:document.querySelector(`meta[name="${f}"]`)});y.compat=!0,E.compat=!0,L.compat=!0;const k={default:y,global:E,utility:L},v=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:a,children:i})=>{const o=p()(e,O),r=Object(s.useMemo)((()=>(e=>e.darkMode?x.COLOR_MODES_STANDARD.dark:x.COLOR_MODES_STANDARD.light)(o)),[o]),l=n||r,c=!1!==t&&void 0;return Object(h.jsx)(x.EuiProvider,{cache:k,modify:a,colorMode:l,globalStyles:c,utilityClasses:c},i)},C=({children:e,i18n:t,...n})=>Object(c.useIsNestedEuiProvider)()?(Object(u.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(h.jsx)(t.Context,null,e)):Object(h.jsx)(v,n,Object(h.jsx)(t.Context,null,e));var S=n(24);const P=({children:e,...t})=>Object(h.jsx)(C,l()({globalStyles:!1},t),Object(h.jsx)(S.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(h.jsx)(S.KibanaErrorBoundary,null,e)));var M=n(0);const w=M.i18n.translate("xpack.painlessLab.contextDefaultLabel",{defaultMessage:"Basic"}),F=M.i18n.translate("xpack.painlessLab.contextFilterLabel",{defaultMessage:"Filter"}),I=M.i18n.translate("xpack.painlessLab.contextScoreLabel",{defaultMessage:"Score"}),T=[{value:"painless_test",inputDisplay:w,"data-test-subj":"basicButtonDropdown",dropdownDisplay:Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)("strong",null,w),Object(h.jsx)(x.EuiText,{size:"s",color:"subdued"},Object(h.jsx)("p",null,M.i18n.translate("xpack.painlessLab.context.defaultLabel",{defaultMessage:"The script result will be converted to a string"}))))},{value:"filter",inputDisplay:F,"data-test-subj":"filterButtonDropdown",dropdownDisplay:Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)("strong",null,F),Object(h.jsx)(x.EuiText,{size:"s",color:"subdued"},Object(h.jsx)("p",null,M.i18n.translate("xpack.painlessLab.context.filterLabel",{defaultMessage:"Use the context of a filter's script query"}))))},{value:"score",inputDisplay:I,"data-test-subj":"scoreButtonDropdown",dropdownDisplay:Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)("strong",null,I),Object(h.jsx)(x.EuiText,{size:"s",color:"subdued"},Object(h.jsx)("p",null,M.i18n.translate("xpack.painlessLab.context.scoreLabel",{defaultMessage:"Use the context of a script_score function in function_score query"}))))}],_='boolean isInCircle(def posX, def posY, def circleX, def circleY, def radius) {\n  double distanceFromCircleCenter = Math.sqrt(Math.pow(circleX - posX, 2) + Math.pow(circleY - posY, 2));\n  return distanceFromCircleCenter <= radius;\n}\n\nboolean isOnCircle(def posX, def posY, def circleX, def circleY, def radius, def thickness, def squashY) {\n  double distanceFromCircleCenter = Math.sqrt(Math.pow(circleX - posX, 2) + Math.pow((circleY - posY) / squashY, 2));\n  return (\n    distanceFromCircleCenter >= radius - thickness\n    && distanceFromCircleCenter <= radius + thickness\n  );\n}\n\ndef result = \'\';\nint charCount = 0;\n\n// Canvas dimensions\nint width = 31;\nint height = 31;\ndouble halfWidth = Math.floor(width * 0.5);\ndouble halfHeight = Math.floor(height * 0.5);\n\n// Style constants\ndouble strokeWidth = 0.6;\n\n// Smiley face configuration\nint headSize = 13;\ndouble headSquashY = 0.78;\nint eyePositionX = 10;\nint eyePositionY = 12;\nint eyeSize = 1;\nint mouthSize = 15;\nint mouthPositionX = width / 2;\nint mouthPositionY = 5;\nint mouthOffsetY = 11;\n\nfor (int y = 0; y < height; y++) {\n  for (int x = 0; x < width; x++) {\n    boolean isHead = isOnCircle(x, y, halfWidth, halfHeight, headSize, strokeWidth, headSquashY);\n    boolean isLeftEye = isInCircle(x, y, eyePositionX, eyePositionY, eyeSize);\n    boolean isRightEye = isInCircle(x, y, width - eyePositionX - 1, eyePositionY, eyeSize);\n    boolean isMouth = isOnCircle(x, y, mouthPositionX, mouthPositionY, mouthSize, strokeWidth, 1) && y > mouthPositionY + mouthOffsetY;\n\n    if (isLeftEye || isRightEye || isMouth || isHead) {\n      result += "*";\n    } else {\n      result += ".";\n    }\n\n    result += " ";\n\n    // Make sure the smiley face doesn\'t deform as the container changes width.\n    charCount++;\n    if (charCount % width === 0) {\n      result += "\\\\n";\n    }\n  }\n}\n\nreturn result;',q={context:T[0].value,code:_,parameters:'{\n  "string_parameter": "string value",\n  "number_parameter": 1.5,\n  "boolean_parameter": true\n}',index:"my-index",document:'{\n  "my_field": "field_value"\n}',query:""},z=Object(s.createContext)(void 0),R=e=>{const{index:t}=e,n=Boolean(t||t.trim());return{isValid:n,fields:{index:n}}},D=({children:e,value:{http:t,links:n,chrome:a}})=>{const i="painlessLabState",[o,r]=Object(s.useState)((()=>{const e={...q,...JSON.parse(localStorage.getItem(i)||"{}")};return{payload:e,validation:R(e)}}));return Object(h.jsx)(z.Provider,{value:{updatePayload:e=>{const t={...o.payload,...e};localStorage.setItem(i,JSON.stringify(t)),r({payload:t,validation:R(t)})},store:o,services:{http:t,chrome:a},links:n}},e)},B=()=>{const e=Object(s.useContext)(z);if(!e)throw new Error("AppContext can only be used inside of AppContextProvider!");return e};let Y=function(e){return e.UGLY="ugly",e.PRETTY="pretty",e}({});function W(e="",t=0){const n=new Array(t+1).join(" ");return e.replace(/\n/g,`\n${n}`)}function A({code:e,context:t,parameters:n,index:s,document:a,query:i},o=Y.UGLY){const r="filter"===t||"score"===t;let l,c,u,d,p,b;return o===Y.UGLY?(l=JSON.stringify(e),c=n,u=t,d=s,p=a,b=i):(l=`"""${W(e,4)}"""`,c=W(n,4),u=W(t,6),d=W(s),p=W(a,4),b=W(i,4)),`{\n  "script": {\n    "source": ${l}${n?`,\n    "params": ${c}`:""}\n  }${r?`,\n  "context": "${u}",\n  "context_setup": {\n    "index": "${d}",\n    "document": ${p}${i&&"score"===t?`,\n    "query": ${b}`:""}\n  }`:""}\n}`}function N(e){try{return JSON.stringify(e,null,2)}catch(t){return`Invalid JSON ${String(e)}`}}var $=n(25),X=n(1);function G({response:e}){return Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)(x.EuiSpacer,{size:"m"}),Object(h.jsx)(x.EuiCodeBlock,{language:"json",paddingSize:"s",isCopyable:!0},function(e){return e?"string"==typeof e.result?e.result.replace(/\\n/g,"\n"):e.error?(t=e.error)instanceof Error?t.message:t.script_stack&&t.caused_by&&t.position?`Unhandled Exception ${t.caused_by.type}\n\n${t.caused_by.reason}\n\nStack:\n${N(t.script_stack)}\n`:N(t):N(e):"";var t}(e)))}var H=n(18),J=n(16);const U=()=>{const{store:{payload:e},updatePayload:t,links:n}=B();return Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)(x.EuiSpacer,{size:"m"}),Object(h.jsx)(x.EuiFormRow,{label:Object(h.jsx)(x.EuiToolTip,{content:M.i18n.translate("xpack.painlessLab.parametersFieldTooltipText",{defaultMessage:'These variables are assigned to the "params" object in your script'})},Object(h.jsx)("span",null,Object(h.jsx)(H.FormattedMessage,{id:"xpack.painlessLab.parametersFieldLabel",defaultMessage:"Parameters (JSON)"})," ",Object(h.jsx)(x.EuiIcon,{type:"questionInCircle",color:"subdued"}))),fullWidth:!0,labelAppend:Object(h.jsx)(x.EuiText,{size:"xs"},Object(h.jsx)(x.EuiLink,{href:n.modulesScriptingPreferParams,target:"_blank"},M.i18n.translate("xpack.painlessLab.parametersFieldDocLinkText",{defaultMessage:"Parameters docs"})))},Object(h.jsx)(J.CodeEditor,{languageId:"json",height:600,value:e.parameters,onChange:e=>t({parameters:e}),options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0},editorDidMount:e=>{const t=e.getModel();t&&t.updateOptions({tabSize:2})}})))},K=()=>{const{store:{payload:e,validation:t},updatePayload:n,links:s}=B(),{context:i,document:o,index:r,query:l}=e;return Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)(x.EuiSpacer,{size:"m"}),Object(h.jsx)(x.EuiFormRow,{label:Object(h.jsx)(x.EuiToolTip,{content:M.i18n.translate("xpack.painlessLab.contextFieldTooltipText",{defaultMessage:"Different contexts provide different functions on the ctx object"})},Object(h.jsx)("span",null,Object(h.jsx)(H.FormattedMessage,{id:"xpack.painlessLab.contextFieldLabel",defaultMessage:"Execution context"})," ",Object(h.jsx)(x.EuiIcon,{type:"questionInCircle",color:"subdued"}))),labelAppend:Object(h.jsx)(x.EuiText,{size:"xs"},Object(h.jsx)(x.EuiLink,{href:s.painlessExecuteAPIContexts,target:"_blank"},M.i18n.translate("xpack.painlessLab.contextFieldDocLinkText",{defaultMessage:"Context docs"}))),fullWidth:!0},Object(h.jsx)(x.EuiSuperSelect,{options:T,valueOfSelected:i,onChange:e=>n({context:e}),itemLayoutAlign:"top",hasDividers:!0,fullWidth:!0,"data-test-subj":"painlessContextDropDown"})),-1!==["filter","score"].indexOf(i)&&Object(h.jsx)(x.EuiFormRow,{label:Object(h.jsx)(x.EuiToolTip,{content:M.i18n.translate("xpack.painlessLab.indexFieldTooltipText",{defaultMessage:"Index mappings must be compatible with the sample document's fields"})},Object(h.jsx)("span",null,Object(h.jsx)(H.FormattedMessage,{id:"xpack.painlessLab.indexFieldLabel",defaultMessage:"Index name"})," ",Object(h.jsx)(x.EuiIcon,{type:"questionInCircle",color:"subdued"}))),fullWidth:!0,isInvalid:!t.fields.index,error:t.fields.index?[]:[M.i18n.translate("xpack.painlessLab.indexFieldMissingErrorMessage",{defaultMessage:"Enter an index name"})]},Object(h.jsx)(x.EuiFieldText,{fullWidth:!0,value:r||"",onChange:e=>{const t=e.target.value;n({index:t})},isInvalid:!t.fields.index})),-1!=="score".indexOf(i)&&Object(h.jsx)(x.EuiFormRow,{label:Object(h.jsx)(x.EuiToolTip,{content:M.i18n.translate("xpack.painlessLab.queryFieldTooltipText",{defaultMessage:"Use query to specify that that _score will be used to calculate score."})},Object(h.jsx)("span",null,Object(h.jsx)(H.FormattedMessage,{id:"xpack.painlessLab.queryFieldLabel",defaultMessage:"Query"})," ",Object(h.jsx)(x.EuiIcon,{type:"questionInCircle",color:"subdued"}))),labelAppend:Object(h.jsx)(x.EuiText,{size:"xs"},Object(h.jsx)(x.EuiLink,{href:s.esQueryDSL,target:"_blank"},M.i18n.translate("xpack.painlessLab.queryFieldDocLinkText",{defaultMessage:"Query DSL docs"}))),fullWidth:!0},Object(h.jsx)(J.CodeEditor,{languageId:"json",height:150,value:l,onChange:e=>n({query:e}),options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}})),-1!==["filter","score"].indexOf(i)&&Object(h.jsx)(x.EuiFormRow,{label:Object(h.jsx)(x.EuiToolTip,{content:M.i18n.translate("xpack.painlessLab.documentFieldTooltipText",{defaultMessage:"Your script can access this document's fields"})},Object(h.jsx)("span",null,Object(h.jsx)(H.FormattedMessage,{id:"xpack.painlessLab.documentFieldLabel",defaultMessage:"Sample document (JSON)"})," ",Object(h.jsx)(x.EuiIcon,{type:"questionInCircle",color:"subdued"}))),fullWidth:!0},Object(h.jsx)(J.CodeEditor,{languageId:"json",height:400,value:o,onChange:e=>n({document:e}),options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}})))},Q=({isLoading:e,response:t})=>{const n=Object(h.jsx)(x.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(h.jsx)(x.EuiFlexItem,{grow:!1},e?Object(h.jsx)(x.EuiLoadingSpinner,{size:"m"}):t&&t.error?Object(h.jsx)(x.EuiIcon,{type:"warning",color:"danger"}):Object(h.jsx)(x.EuiIcon,{type:"check",color:"success"})),Object(h.jsx)(x.EuiFlexItem,{grow:!1},M.i18n.translate("xpack.painlessLab.outputTabLabel",{defaultMessage:"Output"})));return Object(h.jsx)("div",{className:"painlessLabRightPane"},Object(h.jsx)(x.EuiTabbedContent,{className:"painlessLabRightPane__tabs","data-test-subj":"painlessTabs",size:"s",tabs:[{id:"output",name:n,content:Object(h.jsx)(G,{response:t})},{id:"parameters",name:M.i18n.translate("xpack.painlessLab.parametersTabLabel",{defaultMessage:"Parameters"}),content:Object(h.jsx)(U,null)},{id:"context",name:M.i18n.translate("xpack.painlessLab.contextTabLabel",{defaultMessage:"Context"}),content:Object(h.jsx)(K,null)}]}))};function V({toggleRequestFlyout:e,isRequestFlyoutOpen:t,reset:n,links:a}){const[i,o]=Object(s.useState)(!1),r=[Object(h.jsx)(x.EuiContextMenuItem,{key:"walkthrough",icon:"popout",href:a.painlessWalkthrough,target:"_blank",onClick:()=>o(!1)},M.i18n.translate("xpack.painlessLab.walkthroughButtonLabel",{defaultMessage:"Walkthrough"})),Object(h.jsx)(x.EuiContextMenuItem,{key:"api",icon:"popout",href:a.painlessAPIReference,target:"_blank",onClick:()=>o(!1)},M.i18n.translate("xpack.painlessLab.apiReferenceButtonLabel",{defaultMessage:"API reference"})),Object(h.jsx)(x.EuiContextMenuItem,{key:"languageSpec",icon:"popout",href:a.painlessLangSpec,target:"_blank",onClick:()=>o(!1)},M.i18n.translate("xpack.painlessLab.languageSpecButtonLabel",{defaultMessage:"Language spec"})),Object(h.jsx)(x.EuiContextMenuItem,{key:"reset",icon:"bolt",onClick:()=>{n(),o(!1)}},M.i18n.translate("xpack.painlessLab.resetButtonLabel",{defaultMessage:"Reset script"}))];return Object(h.jsx)(x.EuiBottomBar,{paddingSize:"s"},Object(h.jsx)(x.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},Object(h.jsx)(x.EuiFlexItem,{grow:!1},Object(h.jsx)(x.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart"},Object(h.jsx)(x.EuiFlexItem,{grow:!1},Object(h.jsx)(x.EuiPopover,{id:"painlessLabHelpContextMenu",button:Object(h.jsx)(x.EuiButtonEmpty,{size:"s",iconType:"help",iconSide:"left",color:"text",onClick:()=>o(!i)},M.i18n.translate("xpack.painlessLab.helpButtonLabel",{defaultMessage:"Help"})),isOpen:i,closePopover:()=>o(!1),panelPaddingSize:"none",anchorPosition:"upLeft"},Object(h.jsx)(x.EuiContextMenuPanel,{items:r}))))),Object(h.jsx)(x.EuiFlexItem,{grow:!1},Object(h.jsx)(x.EuiButtonEmpty,{size:"s",color:"text",onClick:e,"data-test-subj":"btnViewRequest"},t?M.i18n.translate("xpack.painlessLab.hideRequestButtonLabel",{defaultMessage:"Hide API request"}):M.i18n.translate("xpack.painlessLab.showRequestButtonLabel",{defaultMessage:"Show API request"})))))}var Z=n(26);function ee({code:e,onChange:t,context:n}){const s=Z.PainlessLang.getSuggestionProvider(n);return Object(h.jsx)(J.CodeEditor,{languageId:Z.PainlessLang.ID,width:"99%",height:"100%",value:e,onChange:t,suggestionProvider:s,options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,suggest:{snippetsPreventQuickSuggestions:!1}}})}const te=({onClose:e,requestBody:t,response:n,links:s})=>Object(h.jsx)(x.EuiFlyout,{onClose:e,maxWidth:640},Object(h.jsx)(x.EuiFlyoutHeader,null,Object(h.jsx)(x.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd"},Object(h.jsx)(x.EuiFlexItem,null,Object(h.jsx)("div",null,Object(h.jsx)(x.EuiTitle,{size:"m"},Object(h.jsx)("h2",null,M.i18n.translate("xpack.painlessLab.flyoutTitle",{defaultMessage:"API request"}))))),Object(h.jsx)(x.EuiFlexItem,{grow:!1},Object(h.jsx)(x.EuiButtonEmpty,{size:"s",flush:"right",href:s.painlessExecuteAPI,target:"_blank",iconType:"help"},M.i18n.translate("xpack.painlessLab.flyoutDocLink",{defaultMessage:"API documentation"}))))),Object(h.jsx)(x.EuiFlyoutBody,null,Object(h.jsx)(x.EuiTabbedContent,{size:"s",tabs:[{id:"request",name:"Request",content:Object(h.jsx)(x.EuiCodeBlock,{language:"json",paddingSize:"s",isCopyable:!0},"POST _scripts/painless/_execute\n",t)},{id:"response",name:"Response",content:Object(h.jsx)(x.EuiCodeBlock,{language:"json",paddingSize:"s",isCopyable:!0},n)}]}),Object(h.jsx)("div",{className:"painlessLabBottomBarPlaceholder"}))),ne=()=>{const{store:{payload:e,validation:t},updatePayload:n,services:{http:a},links:i}=B(),[o,r]=Object(s.useState)(!1),{inProgress:l,response:c,submit:u}=(e=>{const t=Object(s.useRef)(0),[n,a]=Object(s.useState)(void 0),[i,o]=Object(s.useState)(!1);return{response:n,inProgress:i,submit:Object(s.useCallback)(Object($.debounce)((async n=>{o(!0);const s=++t.current;try{const i=await e.post(`${X.a}/execute`,{body:JSON.stringify(A(n,Y.UGLY))});t.current===s&&(a(i),o(!1))}catch(e){t.current===s&&(a({error:e}),o(!1))}}),800,{trailing:!0}),[e])}})(a);return Object(s.useEffect)((()=>{t.isValid&&u(e)}),[e,u,t.isValid]),Object(h.jsx)("div",{className:"painlessLabMainContainer"},Object(h.jsx)(x.EuiFlexGroup,{className:"painlessLabPanelsContainer",responsive:!1,gutterSize:"none"},Object(h.jsx)(x.EuiFlexItem,{className:"painlessLabLeftPane"},Object(h.jsx)(x.EuiTitle,{className:"euiScreenReaderOnly"},Object(h.jsx)("h1",null,M.i18n.translate("xpack.painlessLab.title",{defaultMessage:"Painless Lab"}))),Object(h.jsx)(ee,{context:e.context,code:e.code,onChange:e=>n({code:e})})),Object(h.jsx)(x.EuiFlexItem,null,Object(h.jsx)(Q,{isLoading:l,response:c}))),Object(h.jsx)(V,{links:i,isLoading:l,toggleRequestFlyout:()=>{r(!o)},isRequestFlyoutOpen:o,reset:()=>n({code:_})}),o&&Object(h.jsx)(te,{links:i,onClose:()=>r(!1),requestBody:A(e,Y.PRETTY),response:c?N(c.result||c.error):""}))};function se(e,{http:t,uiSettings:n,links:s,chrome:a,settings:r,startServices:l}){if(!e)return()=>{};const{Provider:c}=Object(o.createKibanaReactContext)({uiSettings:n,settings:r});return Object(i.render)(Object(h.jsx)(P,l,Object(h.jsx)(c,null,Object(h.jsx)(D,{value:{http:t,links:s,chrome:a}},Object(h.jsx)(ne,null)))),e),()=>Object(i.unmountComponentAtNode)(e)}}}]);