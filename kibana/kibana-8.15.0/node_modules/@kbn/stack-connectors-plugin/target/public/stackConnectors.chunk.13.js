/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[13,52],{49:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a=({connector_id:e,service_message:n,...t})=>({...t,actionId:e,...n&&{serviceMessage:n}})},50:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var a=t(1),o=t(3),r=t(23),s=t(4),c=t(49),i=t(0);const d=e=>i.i18n.translate("xpack.stackConnectors.components.genAi.error.dashboardApiError",{values:{apiProvider:e},defaultMessage:"Error finding {apiProvider} Token Usage Dashboard."}),u=({connectorId:e,selectedProvider:n})=>{const{dashboard:t,http:i,notifications:{toasts:u},spaces:g}=Object(o.useKibana)().services,[f,p]=Object(a.useState)(null);Object(a.useEffect)((()=>{let e=!1;return g&&g.getActiveSpace().then((n=>{e||p(n.id)})),()=>{e=!0}}),[g]);const[m,b]=Object(a.useState)(!1),[k,C]=Object(a.useState)(null),[O,v]=Object(a.useState)(!1),A=Object(a.useRef)(new AbortController),I=Object(a.useCallback)((n=>{var a;const o=null==t||null===(a=t.locator)||void 0===a?void 0:a.getRedirectUrl({query:{language:"kuery",query:`kibana.saved_objects: { id  : ${e} }`},dashboardId:n});C(null!=o?o:null)}),[e,null==t?void 0:t.locator]);return Object(a.useEffect)((()=>{let t=!1;return null!=f&&e.length>0&&!O&&(A.current.abort(),(async a=>{A.current=new AbortController,t||b(!0);try{const g=await async function({http:e,signal:n,dashboardId:t,connectorId:a}){const o=await e.post(`${r.BASE_ACTION_API_PATH}/connector/${encodeURIComponent(a)}/_execute`,{body:JSON.stringify({params:{subAction:s.e.DASHBOARD,subActionParams:{dashboardId:t}}}),signal:n});return Object(c.a)(o)}({http:i,signal:A.current.signal,connectorId:e,dashboardId:a});var o,l;t||(v(!0),b(!1),null!==(o=g.data)&&void 0!==o&&o.available&&I(a),g.status&&"error"===g.status&&u.addDanger({title:d(n),text:`${null!==(l=g.serviceMessage)&&void 0!==l?l:g.message}`}))}catch(e){t||(v(!0),b(!1),u.addDanger({title:d(n),text:e.message}))}})(l(n,f))),()=>{t=!0,b(!1),A.current.abort()}}),[e,O,k,i,n,I,f,u]),{isLoading:m,dashboardUrl:k}},l=(e,n)=>{let t="openai";return e.toLowerCase().includes("bedrock")?t="bedrock":e.toLowerCase().includes("gemini")&&(t="gemini"),`generative-ai-token-usage-${t}-${n}`}},53:function(e,n,t){"use strict";t.r(n),t.d(n,"API_URL_LABEL",(function(){return o})),t.d(n,"GCP_REGION",(function(){return r})),t.d(n,"GCP_PROJECT_ID",(function(){return s})),t.d(n,"DEFAULT_MODEL_LABEL",(function(){return c})),t.d(n,"SECRET",(function(){return i})),t.d(n,"CREDENTIALS_JSON",(function(){return d})),t.d(n,"gemini",(function(){return u})),t.d(n,"DOCUMENTATION",(function(){return l})),t.d(n,"URL_LABEL",(function(){return g})),t.d(n,"BODY_REQUIRED",(function(){return f})),t.d(n,"BODY_INVALID",(function(){return p})),t.d(n,"ACTION_REQUIRED",(function(){return m})),t.d(n,"INVALID_ACTION",(function(){return b})),t.d(n,"BODY",(function(){return k})),t.d(n,"BODY_DESCRIPTION",(function(){return C})),t.d(n,"MODEL",(function(){return O})),t.d(n,"USAGE_DASHBOARD_LINK",(function(){return v}));var a=t(0);const o=a.i18n.translate("xpack.stackConnectors.components.gemini.apiUrlTextFieldLabel",{defaultMessage:"URL"}),r=a.i18n.translate("xpack.stackConnectors.components.gemini.gcpRegion",{defaultMessage:"GCP Region"}),s=a.i18n.translate("xpack.stackConnectors.components.gemini.gcpProjectID",{defaultMessage:"GCP Project ID"}),c=a.i18n.translate("xpack.stackConnectors.components.gemini.defaultModelTextFieldLabel",{defaultMessage:"Default model"}),i=a.i18n.translate("xpack.stackConnectors.components.gemini.secret",{defaultMessage:"Secret"}),d=a.i18n.translate("xpack.stackConnectors.components.gemini.credentialsJSON",{defaultMessage:"Credentials JSON"}),u=a.i18n.translate("xpack.stackConnectors.components.gemini.title",{defaultMessage:"Google Gemini"}),l=a.i18n.translate("xpack.stackConnectors.components.gemini.documentation",{defaultMessage:"documentation"}),g=a.i18n.translate("xpack.stackConnectors.components.gemini.urlTextFieldLabel",{defaultMessage:"URL"}),f=a.i18n.translate("xpack.stackConnectors.components.gemini.error.requiredgeminiBodyText",{defaultMessage:"Body is required."}),p=a.i18n.translate("xpack.stackConnectors.security.gemini.params.error.invalidBodyText",{defaultMessage:"Body does not have a valid JSON format."}),m=a.i18n.translate("xpack.stackConnectors.security.gemini.params.error.requiredActionText",{defaultMessage:"Action is required."}),b=a.i18n.translate("xpack.stackConnectors.security.gemini.params.error.invalidActionText",{defaultMessage:"Invalid action name."}),k=a.i18n.translate("xpack.stackConnectors.components.gemini.bodyFieldLabel",{defaultMessage:"Body"}),C=a.i18n.translate("xpack.stackConnectors.components.gemini.bodyCodeEditorAriaLabel",{defaultMessage:"Code editor"}),O=a.i18n.translate("xpack.stackConnectors.components.gemini.model",{defaultMessage:"Model"}),v=(e,n)=>a.i18n.translate("xpack.stackConnectors.components.gemini.dashboardLink",{values:{apiProvider:e,connectorName:n},defaultMessage:'View {apiProvider} Usage Dashboard for "{ connectorName }" Connector'})},80:function(e,n,t){"use strict";t.r(n),t.d(n,"DashboardLink",(function(){return d})),t.d(n,"default",(function(){return d}));var a=t(1),o=t(34),r=t(3),s=t(53),c=t(50),i=t(2);const d=({connectorId:e,connectorName:n,selectedProvider:t="Gemini"})=>{const{dashboardUrl:d}=Object(c.a)({connectorId:e,selectedProvider:t}),{services:{application:{navigateToUrl:u}}}=Object(r.useKibana)(),l=Object(a.useCallback)((e=>{e.preventDefault(),d&&u(d)}),[d,u]);return null!=d?Object(i.jsx)(o.EuiLink,{"data-test-subj":"link-gen-ai-token-dashboard",onClick:l,href:d},s.USAGE_DASHBOARD_LINK(t,n)):null}}}]);