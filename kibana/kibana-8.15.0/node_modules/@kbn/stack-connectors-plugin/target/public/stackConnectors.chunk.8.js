/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[8,12,39],{49:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(1),a=n(3),r=n(23),s=n(4),c=n(49),d=n(0);const i=e=>d.i18n.translate("xpack.stackConnectors.components.genAi.error.dashboardApiError",{values:{apiProvider:e},defaultMessage:"Error finding {apiProvider} Token Usage Dashboard."}),l=({connectorId:e,selectedProvider:t})=>{const{dashboard:n,http:d,notifications:{toasts:l},spaces:b}=Object(a.useKibana)().services,[k,f]=Object(o.useState)(null);Object(o.useEffect)((()=>{let e=!1;return b&&b.getActiveSpace().then((t=>{e||f(t.id)})),()=>{e=!0}}),[b]);const[p,m]=Object(o.useState)(!1),[g,A]=Object(o.useState)(null),[O,C]=Object(o.useState)(!1),h=Object(o.useRef)(new AbortController),D=Object(o.useCallback)((t=>{var o;const a=null==n||null===(o=n.locator)||void 0===o?void 0:o.getRedirectUrl({query:{language:"kuery",query:`kibana.saved_objects: { id  : ${e} }`},dashboardId:t});A(null!=a?a:null)}),[e,null==n?void 0:n.locator]);return Object(o.useEffect)((()=>{let n=!1;return null!=k&&e.length>0&&!O&&(h.current.abort(),(async o=>{h.current=new AbortController,n||m(!0);try{const b=await async function({http:e,signal:t,dashboardId:n,connectorId:o}){const a=await e.post(`${r.BASE_ACTION_API_PATH}/connector/${encodeURIComponent(o)}/_execute`,{body:JSON.stringify({params:{subAction:s.e.DASHBOARD,subActionParams:{dashboardId:n}}}),signal:t});return Object(c.a)(a)}({http:d,signal:h.current.signal,connectorId:e,dashboardId:o});var a,u;n||(C(!0),m(!1),null!==(a=b.data)&&void 0!==a&&a.available&&D(o),b.status&&"error"===b.status&&l.addDanger({title:i(t),text:`${null!==(u=b.serviceMessage)&&void 0!==u?u:b.message}`}))}catch(e){n||(C(!0),m(!1),l.addDanger({title:i(t),text:e.message}))}})(u(t,k))),()=>{n=!0,m(!1),h.current.abort()}}),[e,O,g,d,t,D,k,l]),{isLoading:p,dashboardUrl:g}},u=(e,t)=>{let n="openai";return e.toLowerCase().includes("bedrock")?n="bedrock":e.toLowerCase().includes("gemini")&&(n="gemini"),`generative-ai-token-usage-${n}-${t}`}},52:function(e,t,n){"use strict";n.r(t),n.d(t,"API_URL_LABEL",(function(){return a})),n.d(t,"ACCESS_KEY_LABEL",(function(){return r})),n.d(t,"DEFAULT_MODEL_LABEL",(function(){return s})),n.d(t,"SECRET",(function(){return c})),n.d(t,"BEDROCK",(function(){return d})),n.d(t,"DOCUMENTATION",(function(){return i})),n.d(t,"URL_LABEL",(function(){return l})),n.d(t,"BODY_REQUIRED",(function(){return u})),n.d(t,"BODY_INVALID",(function(){return b})),n.d(t,"ACTION_REQUIRED",(function(){return k})),n.d(t,"INVALID_ACTION",(function(){return f})),n.d(t,"BODY",(function(){return p})),n.d(t,"BODY_DESCRIPTION",(function(){return m})),n.d(t,"MODEL",(function(){return g})),n.d(t,"USAGE_DASHBOARD_LINK",(function(){return A}));var o=n(0);const a=o.i18n.translate("xpack.stackConnectors.components.bedrock.apiUrlTextFieldLabel",{defaultMessage:"URL"}),r=o.i18n.translate("xpack.stackConnectors.components.bedrock.accessKeySecret",{defaultMessage:"Access Key"}),s=o.i18n.translate("xpack.stackConnectors.components.bedrock.defaultModelTextFieldLabel",{defaultMessage:"Default model"}),c=o.i18n.translate("xpack.stackConnectors.components.bedrock.secret",{defaultMessage:"Secret"}),d=o.i18n.translate("xpack.stackConnectors.components.bedrock.title",{defaultMessage:"Amazon Bedrock"}),i=o.i18n.translate("xpack.stackConnectors.components.bedrock.documentation",{defaultMessage:"documentation"}),l=o.i18n.translate("xpack.stackConnectors.components.bedrock.urlTextFieldLabel",{defaultMessage:"URL"}),u=o.i18n.translate("xpack.stackConnectors.components.bedrock.error.requiredBedrockBodyText",{defaultMessage:"Body is required."}),b=o.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.invalidBodyText",{defaultMessage:"Body does not have a valid JSON format."}),k=o.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.requiredActionText",{defaultMessage:"Action is required."}),f=o.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.invalidActionText",{defaultMessage:"Invalid action name."}),p=o.i18n.translate("xpack.stackConnectors.components.bedrock.bodyFieldLabel",{defaultMessage:"Body"}),m=o.i18n.translate("xpack.stackConnectors.components.bedrock.bodyCodeEditorAriaLabel",{defaultMessage:"Code editor"}),g=o.i18n.translate("xpack.stackConnectors.components.bedrock.model",{defaultMessage:"Model"}),A=(e,t)=>o.i18n.translate("xpack.stackConnectors.components.genAi.dashboardLink",{values:{apiProvider:e,connectorName:t},defaultMessage:'View {apiProvider} Usage Dashboard for "{ connectorName }" Connector'})},69:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l})),n(1);var o=n(36),a=n(34),r=n(5),s=n(52),c=n(2);const d=JSON.stringify({anthropic_version:"bedrock-2023-05-31",messages:[{content:"Hello world",role:"user"}],max_tokens:r.e,stop_sequences:["\n\nHuman:"]}),i=[{id:"apiUrl",label:s.API_URL_LABEL,isUrlField:!0,defaultValue:r.d,helpText:Object(c.jsx)(o.FormattedMessage,{defaultMessage:"The Amazon Bedrock API endpoint URL. For more information on the URL, refer to the {bedrockAPIUrlDocs}.",id:"xpack.stackConnectors.components.bedrock.bedrockDocumentation",values:{bedrockAPIUrlDocs:Object(c.jsx)(a.EuiLink,{"data-test-subj":"bedrock-api-doc",href:"https://docs.aws.amazon.com/general/latest/gr/bedrock.html",target:"_blank"},`${s.BEDROCK} ${s.DOCUMENTATION}`)}})},{id:"defaultModel",label:s.DEFAULT_MODEL_LABEL,helpText:Object(c.jsx)(o.FormattedMessage,{defaultMessage:'Current support is for the Anthropic Claude models. The model can be set on a per request basis by including a "model" parameter alongside the request body. If no model is provided, the fallback will be the default model -  Claude 3 Sonnet. For more information, refer to the {bedrockAPIModelDocs}.',id:"xpack.stackConnectors.components.bedrock.bedrockDocumentationModel",values:{bedrockAPIModelDocs:Object(c.jsx)(a.EuiLink,{"data-test-subj":"bedrock-api-model-doc",href:"https://aws.amazon.com/bedrock/claude/",target:"_blank"},`${s.BEDROCK} ${s.DOCUMENTATION}`)}}),defaultValue:r.c}],l=[{id:"accessKey",label:s.ACCESS_KEY_LABEL,isPasswordField:!0,helpText:Object(c.jsx)(o.FormattedMessage,{defaultMessage:"The AWS access key for HTTP Basic authentication. For more details about generating AWS security credentials, refer to the {bedrockAPIKeyDocs}.",id:"xpack.stackConnectors.components.bedrock.bedrockApiKeyDocumentation",values:{bedrockAPIKeyDocs:Object(c.jsx)(a.EuiLink,{"data-test-subj":"aws-api-keys-doc",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/security-creds.html",target:"_blank"},`${s.BEDROCK} ${s.DOCUMENTATION}`)}})},{id:"secret",label:s.SECRET,isPasswordField:!0,helpText:Object(c.jsx)(o.FormattedMessage,{defaultMessage:"The AWS secret for HTTP Basic authentication. For more details about generating AWS security credentials, refer to the {bedrockAPIKeyDocs}.",id:"xpack.stackConnectors.components.bedrock.bedrockSecretDocumentation",values:{bedrockAPIKeyDocs:Object(c.jsx)(a.EuiLink,{"data-test-subj":"aws-api-keys-doc",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/security-creds.html",target:"_blank"},`${s.BEDROCK} ${s.DOCUMENTATION}`)}})}]},79:function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardLink",(function(){return i})),n.d(t,"default",(function(){return i}));var o=n(1),a=n(34),r=n(3),s=n(52),c=n(50),d=n(2);const i=({connectorId:e,connectorName:t,selectedProvider:n="Bedrock"})=>{const{dashboardUrl:i}=Object(c.a)({connectorId:e,selectedProvider:n}),{services:{application:{navigateToUrl:l}}}=Object(r.useKibana)(),u=Object(o.useCallback)((e=>{e.preventDefault(),i&&l(i)}),[i,l]);return null!=i?Object(d.jsx)(a.EuiLink,{"data-test-subj":"link-gen-ai-token-dashboard",onClick:u,href:i},s.USAGE_DASHBOARD_LINK(n,t)):null}},98:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var o=n(1),a=n.n(o),r=n(3),s=n(35),c=n(79),d=n(52),i=n(69),l=n(2);const u=({readOnly:e,isEdit:t})=>{const[{id:n,name:o}]=Object(s.useFormData)();return Object(l.jsx)(a.a.Fragment,null,Object(l.jsx)(r.SimpleConnectorForm,{isEdit:t,readOnly:e,configFormSchema:i.b,secretsFormSchema:i.c}),t&&Object(l.jsx)(c.default,{connectorId:n,connectorName:o,selectedProvider:d.BEDROCK}))}}}]);