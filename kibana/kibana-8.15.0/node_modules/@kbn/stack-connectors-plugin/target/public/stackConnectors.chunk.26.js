/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[26,48],{39:function(e,t,n){"use strict";n.r(t),n.d(t,"USERNAME_LABEL",(function(){return s})),n.d(t,"PASSWORD_LABEL",(function(){return r})),n.d(t,"FROM_LABEL",(function(){return o})),n.d(t,"SERVICE_LABEL",(function(){return i})),n.d(t,"TENANT_ID_LABEL",(function(){return l})),n.d(t,"CLIENT_ID_LABEL",(function(){return c})),n.d(t,"CLIENT_SECRET_LABEL",(function(){return u})),n.d(t,"HOST_LABEL",(function(){return d})),n.d(t,"PORT_LABEL",(function(){return p})),n.d(t,"SECURE_LABEL",(function(){return E})),n.d(t,"HAS_AUTH_LABEL",(function(){return m})),n.d(t,"SENDER_REQUIRED",(function(){return f})),n.d(t,"CLIENT_ID_REQUIRED",(function(){return x})),n.d(t,"TENANT_ID_REQUIRED",(function(){return b})),n.d(t,"PORT_REQUIRED",(function(){return j})),n.d(t,"PORT_INVALID",(function(){return g})),n.d(t,"SERVICE_REQUIRED",(function(){return O})),n.d(t,"HOST_REQUIRED",(function(){return C})),n.d(t,"USERNAME_REQUIRED",(function(){return R})),n.d(t,"TO_CC_REQUIRED",(function(){return k})),n.d(t,"MESSAGE_REQUIRED",(function(){return L})),n.d(t,"SUBJECT_REQUIRED",(function(){return A})),n.d(t,"PASSWORD_REQUIRED",(function(){return F})),n.d(t,"CLIENT_SECRET_REQUIRED",(function(){return I})),n.d(t,"getInvalidEmailAddress",(function(){return S})),n.d(t,"getNotAllowedEmailAddress",(function(){return T}));var a=n(0);const s=a.i18n.translate("xpack.stackConnectors.components.email.userTextFieldLabel",{defaultMessage:"Username"}),r=a.i18n.translate("xpack.stackConnectors.components.email.passwordFieldLabel",{defaultMessage:"Password"}),o=a.i18n.translate("xpack.stackConnectors.components.email.fromTextFieldLabel",{defaultMessage:"Sender"}),i=a.i18n.translate("xpack.stackConnectors.components.email.serviceTextFieldLabel",{defaultMessage:"Service"}),l=a.i18n.translate("xpack.stackConnectors.components.email.tenantIdFieldLabel",{defaultMessage:"Tenant ID"}),c=a.i18n.translate("xpack.stackConnectors.components.email.clientIdFieldLabel",{defaultMessage:"Client ID"}),u=a.i18n.translate("xpack.stackConnectors.components.email.clientSecretTextFieldLabel",{defaultMessage:"Client Secret"}),d=a.i18n.translate("xpack.stackConnectors.components.email.hostTextFieldLabel",{defaultMessage:"Host"}),p=a.i18n.translate("xpack.stackConnectors.components.email.portTextFieldLabel",{defaultMessage:"Port"}),E=a.i18n.translate("xpack.stackConnectors.components.email.secureSwitchLabel",{defaultMessage:"Secure"}),m=a.i18n.translate("xpack.stackConnectors.components.email.hasAuthSwitchLabel",{defaultMessage:"Require authentication for this server"}),f=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredFromText",{defaultMessage:"Sender is required."}),x=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredClientIdText",{defaultMessage:"Client ID is required."}),b=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredTenantIdText",{defaultMessage:"Tenant ID is required."}),j=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredPortText",{defaultMessage:"Port is required."}),g=a.i18n.translate("xpack.stackConnectors.components.email.error.invalidPortText",{defaultMessage:"Port is invalid."}),O=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredServiceText",{defaultMessage:"Service is required."}),C=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredHostText",{defaultMessage:"Host is required."}),R=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredAuthUserNameText",{defaultMessage:"Username is required."}),k=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredEntryText",{defaultMessage:"No To, Cc, or Bcc entry.  At least one entry is required."}),L=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredMessageText",{defaultMessage:"Message is required."}),A=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredSubjectText",{defaultMessage:"Subject is required."}),F=a.i18n.translate("xpack.stackConnectors.components.email.error.requiredPasswordText",{defaultMessage:"Password is required."}),I=a.i18n.translate("xpack.stackConnectors.components.email.requiredClientSecretText",{defaultMessage:"Client Secret is required."});function S(e){return a.i18n.translate("xpack.stackConnectors.components.email.error.invalidEmail",{defaultMessage:"Email address {email} is not valid.",values:{email:e}})}function T(e){return a.i18n.translate("xpack.stackConnectors.components.email.error.notAllowed",{defaultMessage:"Email address {email} is not allowed.",values:{email:e}})}},47:function(e,t,n){"use strict";n.r(t),n.d(t,"EmailActionConnectorFields",(function(){return C})),n.d(t,"nullableString",(function(){return R})),n.d(t,"default",(function(){return C}));var a=n(1),s=n.n(a),r=n(7),o=n(34),i=n(36),l=n(23),c=n(38),u=n(35),d=n(37),p=n(3),E=n(13),m=n(24),f=n(0);var x=n(39),b=n(2);const{emptyField:j}=c.fieldValidators,g=Object(a.lazy)((()=>n.e(47).then(n.bind(null,140)))),O={label:x.PORT_LABEL,validations:[{validator:j(x.PORT_REQUIRED)},{validator:({value:e})=>{const t=Number.parseFloat(e);if(!Number.isInteger(t))return{message:x.PORT_INVALID}}}]},C=({readOnly:e})=>{const{docLinks:t,http:n,isCloud:c,notifications:{toasts:C}}=Object(p.useKibana)().services,{services:{validateEmailAddresses:R}}=Object(p.useConnectorContext)(),k=Object(u.useFormContext)(),{updateFieldValues:L}=k,[{config:A}]=Object(u.useFormData)({watch:["config.service","config.hasAuth"]}),F=Object(a.useMemo)((()=>{return e=t.links.alerting.emailActionConfig,n=R,{label:x.FROM_LABEL,helpText:Object(b.jsx)(o.EuiLink,{href:e,target:"_blank"},Object(b.jsx)(i.FormattedMessage,{id:"xpack.stackConnectors.components.email.configureAccountsHelpLabel",defaultMessage:"Configure email accounts"})),validations:[{validator:j(x.SENDER_REQUIRED)},{validator:({value:e})=>{const t=n([e])[0];if(!t.valid)return{message:t.reason===l.InvalidEmailReason.notAllowed?x.getNotAllowedEmailAddress(e):x.getInvalidEmailAddress(e)}}}]};var e,n}),[t.links.alerting.emailActionConfig,R]),{service:I=null,hasAuth:S=!1}=null!=A?A:{},T=(e=>Object(r.isEmpty)(e)||e!==E.a.EXCHANGE&&e!==E.a.OTHER)(I),{isLoading:v,getEmailServiceConfig:_}=function({http:e,toasts:t}){const[n,s]=Object(a.useState)(!1),o=Object(a.useRef)(new AbortController),i=Object(a.useRef)(!1),l=Object(a.useCallback)((async n=>{if(null!=n&&!Object(r.isEmpty)(n)){s(!0),i.current=!0,o.current.abort(),o.current=new AbortController;try{const t=await async function({http:e,service:t}){return await e.get(`${E.b}/_email_config/${t}`)}({http:e,service:n});return i.current&&s(!1),((e,t)=>{if(e){if(e===E.a.EXCHANGE)return;return{host:null!=t&&t.host?t.host:"",port:null!=t&&t.port?t.port:0,secure:null!=(null==t?void 0:t.secure)&&t.secure}}})(n,t)}catch(e){var a,l;i.current&&(s(!1),"AbortError"!==e.name&&t.addDanger(null!==(a=null===(l=e.body)||void 0===l?void 0:l.message)&&void 0!==a?a:f.i18n.translate("xpack.stackConnectors.components.email.updateErrorNotificationText",{defaultMessage:"Cannot get service configuration"})))}}}),[e,t]);return Object(a.useEffect)((()=>(i.current=!0,()=>{i.current=!1,o.current.abort()})),[]),{isLoading:n,getEmailServiceConfig:l}}({http:n,toasts:C});return Object(a.useEffect)((()=>{!async function(){if(null===I||I===E.a.OTHER||I===E.a.EXCHANGE)return;const e=await _(I);L({config:{host:null==e?void 0:e.host,port:null==e?void 0:e.port,secure:null==e?void 0:e.secure}})}()}),[L,_,I]),Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"config.from",component:d.TextField,config:F,componentProps:{euiFieldProps:{"data-test-subj":"emailFromInput",readOnly:e}}}))),Object(b.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"config.service",component:d.SelectField,config:{label:x.SERVICE_LABEL,validations:[{validator:j(x.SERVICE_REQUIRED)}]},componentProps:{euiFieldProps:{"data-test-subj":"emailServiceSelectInput",options:Object(m.b)(c),fullWidth:!0,hasNoInitialSelection:!0,disabled:e||v,isLoading:v,readOnly:e}}}))),I===E.a.EXCHANGE?Object(b.jsx)(g,{readOnly:e}):Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"config.host",component:d.TextField,config:{label:x.HOST_LABEL,validations:[{validator:j(x.HOST_REQUIRED)}]},componentProps:{euiFieldProps:{"data-test-subj":"emailHostInput",readOnly:e,isLoading:v,disabled:T}}})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"config.port",component:d.NumericField,config:O,componentProps:{euiFieldProps:{"data-test-subj":"emailPortInput",readOnly:e,isLoading:v,disabled:T}}})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"config.secure",component:d.ToggleField,config:{defaultValue:!1},componentProps:{hasEmptyLabelSpace:!0,euiFieldProps:{label:x.SECURE_LABEL,disabled:e||T,"data-test-subj":"emailSecureSwitch",readOnly:e}}}))))),Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiSpacer,{size:"m"}),Object(b.jsx)(o.EuiTitle,{size:"xxs"},Object(b.jsx)("h4",null,Object(b.jsx)(i.FormattedMessage,{id:"xpack.stackConnectors.components.email.authenticationLabel",defaultMessage:"Authentication"}))),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(u.UseField,{path:"config.hasAuth",component:d.ToggleField,config:{defaultValue:!0},componentProps:{euiFieldProps:{label:x.HAS_AUTH_LABEL,disabled:e,readOnly:e}}}))),S?Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"secrets.user",component:d.TextField,config:{label:x.USERNAME_LABEL,validations:[{validator:j(x.USERNAME_REQUIRED)}]},componentProps:{euiFieldProps:{"data-test-subj":"emailUserInput",readOnly:e}}})),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(u.UseField,{path:"secrets.password",config:{label:x.PASSWORD_LABEL,validations:[{validator:j(x.PASSWORD_REQUIRED)}]},component:d.PasswordField,componentProps:{euiFieldProps:{readOnly:e,"data-test-subj":"emailPasswordInput"}}})))):null))};function R(e){return null==e||""===e.trim()?null:e}}}]);