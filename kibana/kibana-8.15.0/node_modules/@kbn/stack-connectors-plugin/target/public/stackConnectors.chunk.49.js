/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[49],{93:function(e,t,n){"use strict";n.r(t),n.d(t,"IndexParamsFields",(function(){return u})),n.d(t,"default",(function(){return u}));var s=n(1),a=n.n(s),o=n(7),i=n(34),r=n(0),d=n(36),c=n(3),l=n(2);const u=({actionParams:e,index:t,editAction:n,messageVariables:u,errors:x,actionConnector:j})=>{const{docLinks:m}=Object(c.useKibana)().services,{documents:b,indexOverride:p}=e,O=c.AlertHistoryDefaultIndexName.replace(c.ALERT_HISTORY_PREFIX,""),[f,g]=Object(s.useState)(!1),I=e=>e&&e.length>0?"string"==typeof e[0]?e[0]:Object(o.isEmpty)(e[0])?null:JSON.stringify(e[0],null,2):void 0,[k,E]=Object(s.useState)(I(b)),[T,v]=Object(s.useState)(p?p.replace(c.ALERT_HISTORY_PREFIX,""):O),[y,R]=Object(s.useState)(!1);Object(s.useEffect)((()=>{E(I(b))}),[b]),Object(s.useEffect)((()=>{(null==j?void 0:j.id)===c.AlertHistoryEsIndexConnectorId?(R(!0),n("documents",[JSON.stringify(c.AlertHistoryDocumentTemplate)],t),E(JSON.stringify(c.AlertHistoryDocumentTemplate))):f&&(R(!1),n("documents",void 0,t),E(void 0)),g(!0)}),[null==j?void 0:j.id]);const S=e=>{try{if(null!=e){const s=JSON.parse(e);n("documents",[s],t)}else n("documents",e,t);E(e)}catch(e){n("documents",[{}],t),E(void 0)}},h=r.i18n.translate("xpack.stackConnectors.components.index.documentsFieldLabel",{defaultMessage:"Document to index"}),A=p&&p!==c.AlertHistoryDefaultIndexName?Object(l.jsx)(i.EuiText,{size:"xs"},Object(l.jsx)(i.EuiLink,{"data-test-subj":"resetDefaultIndex",onClick:()=>{n("indexOverride",c.AlertHistoryDefaultIndexName,t),v(O)}},Object(l.jsx)(i.EuiIcon,{type:"refresh"}),Object(l.jsx)(d.FormattedMessage,{id:"xpack.stackConnectors.components.index.resetDefaultIndexLabel",defaultMessage:"Reset default index"}))):Object(l.jsx)(a.a.Fragment,null),C=Object(l.jsx)(a.a.Fragment,null,Object(l.jsx)(i.EuiFormRow,{fullWidth:!0,error:x.indexOverride,isInvalid:void 0!==x.indexOverride&&x.indexOverride&&x.indexOverride.length>0,label:r.i18n.translate("xpack.stackConnectors.components.index.preconfiguredIndex",{defaultMessage:"Elasticsearch index"}),labelAppend:A,helpText:Object(l.jsx)(a.a.Fragment,null,Object(l.jsx)(d.FormattedMessage,{id:"xpack.stackConnectors.components.index.preconfiguredIndexHelpText",defaultMessage:"Documents are indexed into the {alertHistoryIndex} index. ",values:{alertHistoryIndex:`${c.ALERT_HISTORY_PREFIX}${T}`}}),Object(l.jsx)(i.EuiLink,{href:m.links.alerting.preconfiguredAlertHistoryConnector,target:"_blank"},Object(l.jsx)(d.FormattedMessage,{id:"xpack.stackConnectors.components.index.preconfiguredIndexDocLink",defaultMessage:"View docs."})))},Object(l.jsx)(i.EuiFieldText,{fullWidth:!0,"data-test-subj":"preconfiguredIndexToUse",prepend:c.ALERT_HISTORY_PREFIX,value:T,onChange:e=>{n("indexOverride",`${c.ALERT_HISTORY_PREFIX}${e.target.value}`,t),v(e.target.value)}})),Object(l.jsx)(i.EuiSpacer,{size:"m"}),Object(l.jsx)(i.EuiFormRow,{fullWidth:!0,label:h},Object(l.jsx)(i.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s","data-test-subj":"preconfiguredDocumentToIndex"},JSON.stringify(c.AlertHistoryDocumentTemplate,null,2)))),F=Object(l.jsx)(c.JsonEditorWithMessageVariables,{messageVariables:u,paramsProperty:"documents",dataTestSubj:"documentToIndex",inputTargetValue:k,label:h,ariaLabel:r.i18n.translate("xpack.stackConnectors.components.index.jsonDocAriaLabel",{defaultMessage:"Code editor"}),errors:x.documents,onDocumentsChange:S,helpText:Object(l.jsx)(i.EuiLink,{href:m.links.alerting.indexAction,target:"_blank"},Object(l.jsx)(d.FormattedMessage,{id:"xpack.stackConnectors.components.index.indexDocumentHelpLabel",defaultMessage:"Index document example."})),onBlur:()=>{k||S(null)}});return y?C:F}}}]);