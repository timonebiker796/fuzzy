/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[12,39],{49:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(1),r=n(3),o=n(23),c=n(4),s=n(49),d=n(0);const i=e=>d.i18n.translate("xpack.stackConnectors.components.genAi.error.dashboardApiError",{values:{apiProvider:e},defaultMessage:"Error finding {apiProvider} Token Usage Dashboard."}),u=({connectorId:e,selectedProvider:t})=>{const{dashboard:n,http:d,notifications:{toasts:u},spaces:b}=Object(r.useKibana)().services,[k,f]=Object(a.useState)(null);Object(a.useEffect)((()=>{let e=!1;return b&&b.getActiveSpace().then((t=>{e||f(t.id)})),()=>{e=!0}}),[b]);const[p,g]=Object(a.useState)(!1),[A,C]=Object(a.useState)(null),[v,m]=Object(a.useState)(!1),O=Object(a.useRef)(new AbortController),L=Object(a.useCallback)((t=>{var a;const r=null==n||null===(a=n.locator)||void 0===a?void 0:a.getRedirectUrl({query:{language:"kuery",query:`kibana.saved_objects: { id  : ${e} }`},dashboardId:t});C(null!=r?r:null)}),[e,null==n?void 0:n.locator]);return Object(a.useEffect)((()=>{let n=!1;return null!=k&&e.length>0&&!v&&(O.current.abort(),(async a=>{O.current=new AbortController,n||g(!0);try{const b=await async function({http:e,signal:t,dashboardId:n,connectorId:a}){const r=await e.post(`${o.BASE_ACTION_API_PATH}/connector/${encodeURIComponent(a)}/_execute`,{body:JSON.stringify({params:{subAction:c.e.DASHBOARD,subActionParams:{dashboardId:n}}}),signal:t});return Object(s.a)(r)}({http:d,signal:O.current.signal,connectorId:e,dashboardId:a});var r,l;n||(m(!0),g(!1),null!==(r=b.data)&&void 0!==r&&r.available&&L(a),b.status&&"error"===b.status&&u.addDanger({title:i(t),text:`${null!==(l=b.serviceMessage)&&void 0!==l?l:b.message}`}))}catch(e){n||(m(!0),g(!1),u.addDanger({title:i(t),text:e.message}))}})(l(t,k))),()=>{n=!0,g(!1),O.current.abort()}}),[e,v,A,d,t,L,k,u]),{isLoading:p,dashboardUrl:A}},l=(e,t)=>{let n="openai";return e.toLowerCase().includes("bedrock")?n="bedrock":e.toLowerCase().includes("gemini")&&(n="gemini"),`generative-ai-token-usage-${n}-${t}`}},52:function(e,t,n){"use strict";n.r(t),n.d(t,"API_URL_LABEL",(function(){return r})),n.d(t,"ACCESS_KEY_LABEL",(function(){return o})),n.d(t,"DEFAULT_MODEL_LABEL",(function(){return c})),n.d(t,"SECRET",(function(){return s})),n.d(t,"BEDROCK",(function(){return d})),n.d(t,"DOCUMENTATION",(function(){return i})),n.d(t,"URL_LABEL",(function(){return u})),n.d(t,"BODY_REQUIRED",(function(){return l})),n.d(t,"BODY_INVALID",(function(){return b})),n.d(t,"ACTION_REQUIRED",(function(){return k})),n.d(t,"INVALID_ACTION",(function(){return f})),n.d(t,"BODY",(function(){return p})),n.d(t,"BODY_DESCRIPTION",(function(){return g})),n.d(t,"MODEL",(function(){return A})),n.d(t,"USAGE_DASHBOARD_LINK",(function(){return C}));var a=n(0);const r=a.i18n.translate("xpack.stackConnectors.components.bedrock.apiUrlTextFieldLabel",{defaultMessage:"URL"}),o=a.i18n.translate("xpack.stackConnectors.components.bedrock.accessKeySecret",{defaultMessage:"Access Key"}),c=a.i18n.translate("xpack.stackConnectors.components.bedrock.defaultModelTextFieldLabel",{defaultMessage:"Default model"}),s=a.i18n.translate("xpack.stackConnectors.components.bedrock.secret",{defaultMessage:"Secret"}),d=a.i18n.translate("xpack.stackConnectors.components.bedrock.title",{defaultMessage:"Amazon Bedrock"}),i=a.i18n.translate("xpack.stackConnectors.components.bedrock.documentation",{defaultMessage:"documentation"}),u=a.i18n.translate("xpack.stackConnectors.components.bedrock.urlTextFieldLabel",{defaultMessage:"URL"}),l=a.i18n.translate("xpack.stackConnectors.components.bedrock.error.requiredBedrockBodyText",{defaultMessage:"Body is required."}),b=a.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.invalidBodyText",{defaultMessage:"Body does not have a valid JSON format."}),k=a.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.requiredActionText",{defaultMessage:"Action is required."}),f=a.i18n.translate("xpack.stackConnectors.security.bedrock.params.error.invalidActionText",{defaultMessage:"Invalid action name."}),p=a.i18n.translate("xpack.stackConnectors.components.bedrock.bodyFieldLabel",{defaultMessage:"Body"}),g=a.i18n.translate("xpack.stackConnectors.components.bedrock.bodyCodeEditorAriaLabel",{defaultMessage:"Code editor"}),A=a.i18n.translate("xpack.stackConnectors.components.bedrock.model",{defaultMessage:"Model"}),C=(e,t)=>a.i18n.translate("xpack.stackConnectors.components.genAi.dashboardLink",{values:{apiProvider:e,connectorName:t},defaultMessage:'View {apiProvider} Usage Dashboard for "{ connectorName }" Connector'})},79:function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardLink",(function(){return i})),n.d(t,"default",(function(){return i}));var a=n(1),r=n(34),o=n(3),c=n(52),s=n(50),d=n(2);const i=({connectorId:e,connectorName:t,selectedProvider:n="Bedrock"})=>{const{dashboardUrl:i}=Object(s.a)({connectorId:e,selectedProvider:n}),{services:{application:{navigateToUrl:u}}}=Object(o.useKibana)(),l=Object(a.useCallback)((e=>{e.preventDefault(),i&&u(i)}),[i,u]);return null!=i?Object(d.jsx)(r.EuiLink,{"data-test-subj":"link-gen-ai-token-dashboard",onClick:l,href:i},c.USAGE_DASHBOARD_LINK(n,t)):null}}}]);