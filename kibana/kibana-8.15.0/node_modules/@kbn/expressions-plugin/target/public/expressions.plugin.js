!function(e){function t(t){for(var n,s,i=t[0],o=t[1],a=0,c=[];a<i.length;a++)s=i[a],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&c.push(r[s][0]),r[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={0:0};function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,s){n=r[e]=[t,s]}));t.push(n[2]=i);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+"expressions.chunk."+e+".js"}(e);var u=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",u.name="ChunkLoadError",u.type=s,u.request=i,n[1](u)}r[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var i=window.expressions_bundle_jsonpfunction=window.expressions_bundle_jsonpfunction||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var a=0;a<i.length;a++)t(i[a]);var u=o;s(s.s=34)}([function(e,t,n){e.exports=n(25)(2)},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){"use strict";n.d(t,"g",(function(){return r.a})),n.d(t,"q",(function(){return i})),n.d(t,"a",(function(){return o.a})),n.d(t,"u",(function(){return a.r})),n.d(t,"c",(function(){return a.b})),n.d(t,"i",(function(){return a.g})),n.d(t,"d",(function(){return a.c})),n.d(t,"j",(function(){return a.h})),n.d(t,"e",(function(){return a.d})),n.d(t,"f",(function(){return a.e})),n.d(t,"h",(function(){return a.f})),n.d(t,"k",(function(){return a.i})),n.d(t,"l",(function(){return a.j})),n.d(t,"m",(function(){return a.k})),n.d(t,"b",(function(){return a.a})),n.d(t,"n",(function(){return a.l})),n.d(t,"o",(function(){return a.m})),n.d(t,"p",(function(){return a.n})),n.d(t,"r",(function(){return a.o})),n.d(t,"s",(function(){return a.p})),n.d(t,"t",(function(){return a.q})),n.d(t,"v",(function(){return a.s})),n.d(t,"w",(function(){return u}));var r=n(10);const s=e=>e,i=e=>({serialize:t=>(e[Object(r.a)(t)].serialize||s)(t),deserialize:t=>(e[Object(r.a)(t)].deserialize||s)(t)});var o=n(14),a=n(15);function u({type:e,...t}){return t}},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";n.r(t),n.d(t,"americanTypewriter",(function(){return r})),n.d(t,"arial",(function(){return s})),n.d(t,"baskerville",(function(){return i})),n.d(t,"bookAntiqua",(function(){return o})),n.d(t,"brushScript",(function(){return a})),n.d(t,"chalkboard",(function(){return u})),n.d(t,"didot",(function(){return c})),n.d(t,"futura",(function(){return l})),n.d(t,"gillSans",(function(){return d})),n.d(t,"helveticaNeue",(function(){return p})),n.d(t,"hoeflerText",(function(){return f})),n.d(t,"inter",(function(){return h})),n.d(t,"lucidaGrande",(function(){return m})),n.d(t,"myriad",(function(){return g})),n.d(t,"openSans",(function(){return v})),n.d(t,"optima",(function(){return b})),n.d(t,"palatino",(function(){return x})),n.d(t,"fonts",(function(){return y}));const r={label:"American Typewriter",value:"'American Typewriter', 'Courier New', Courier, Monaco, mono"},s={label:"Arial",value:"Arial, sans-serif"},i={label:"Baskerville",value:"Baskerville, Georgia, Garamond, 'Times New Roman', Times, serif"},o={label:"Book Antiqua",value:"'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"},a={label:"Brush Script",value:"'Brush Script MT', 'Comic Sans', sans-serif"},u={label:"Chalkboard",value:"Chalkboard, 'Comic Sans', sans-serif"},c={label:"Didot",value:"Didot, Georgia, Garamond, 'Times New Roman', Times, serif"},l={label:"Futura",value:"Futura, Impact, Helvetica, Arial, sans-serif"},d={label:"Gill Sans",value:"'Gill Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"},p={label:"Helvetica Neue",value:"'Helvetica Neue', Helvetica, Arial, sans-serif"},f={label:"Hoefler Text",value:"'Hoefler Text', Garamond, Georgia, 'Times New Roman', Times, serif"},h={label:"Inter",value:"'Inter', 'Inter UI', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'"},m={label:"Lucida Grande",value:"'Lucida Grande', 'Lucida Sans Unicode', Lucida, Verdana, Helvetica, Arial, sans-serif"},g={label:"Myriad",value:"Myriad, Helvetica, Arial, sans-serif"},v={label:"Open Sans",value:"'Open Sans', Helvetica, Arial, sans-serif"},b={label:"Optima",value:"Optima, 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"},x={label:"Palatino",value:"Palatino, 'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"},y=[r,s,i,o,a,u,c,l,d,p,f,h,m,g,v,b,x]},function(e,t,n){"use strict";n.r(t),n.d(t,"BackgroundRepeat",(function(){return r})),n.d(t,"BackgroundSize",(function(){return s})),n.d(t,"Overflow",(function(){return a})),n.d(t,"FontStyle",(function(){return i})),n.d(t,"FontWeight",(function(){return o})),n.d(t,"FontSizeUnit",(function(){return l})),n.d(t,"TextDecoration",(function(){return c})),n.d(t,"TextAlignment",(function(){return u})),n.d(t,"buildExpression",(function(){return x})),n.d(t,"buildExpressionFunction",(function(){return f})),n.d(t,"formatExpression",(function(){return y})),n.d(t,"isExpressionAstBuilder",(function(){return g})),n.d(t,"parseExpression",(function(){return w})),n.d(t,"parse",(function(){return m})),n.d(t,"isExpressionAst",(function(){return v})),n.d(t,"format",(function(){return p})),n.d(t,"americanTypewriter",(function(){return E.americanTypewriter})),n.d(t,"inter",(function(){return E.inter})),n.d(t,"arial",(function(){return E.arial})),n.d(t,"fonts",(function(){return E.fonts})),n.d(t,"bookAntiqua",(function(){return E.bookAntiqua})),n.d(t,"brushScript",(function(){return E.brushScript})),n.d(t,"didot",(function(){return E.didot})),n.d(t,"futura",(function(){return E.futura})),n.d(t,"chalkboard",(function(){return E.chalkboard})),n.d(t,"gillSans",(function(){return E.gillSans})),n.d(t,"openSans",(function(){return E.openSans})),n.d(t,"helveticaNeue",(function(){return E.helveticaNeue})),n.d(t,"hoeflerText",(function(){return E.hoeflerText})),n.d(t,"lucidaGrande",(function(){return E.lucidaGrande})),n.d(t,"myriad",(function(){return E.myriad})),n.d(t,"optima",(function(){return E.optima})),n.d(t,"palatino",(function(){return E.palatino})),n.d(t,"baskerville",(function(){return E.baskerville})),n.d(t,"num",(function(){return j.l})),n.d(t,"filter",(function(){return j.f})),n.d(t,"error",(function(){return j.e})),n.d(t,"image",(function(){return j.h})),n.d(t,"render",(function(){return j.p})),n.d(t,"number",(function(){return j.m})),n.d(t,"datatable",(function(){return j.d})),n.d(t,"nullType",(function(){return j.k})),n.d(t,"range",(function(){return j.o})),n.d(t,"pointseries",(function(){return j.n})),n.d(t,"serializeProvider",(function(){return j.q})),n.d(t,"typeSpecs",(function(){return j.u})),n.d(t,"string",(function(){return j.s})),n.d(t,"shape",(function(){return j.r})),n.d(t,"style",(function(){return j.t})),n.d(t,"uiSetting",(function(){return j.v})),n.d(t,"boolean",(function(){return j.c})),n.d(t,"isExpressionValueError",(function(){return j.j})),n.d(t,"getType",(function(){return j.g})),n.d(t,"unboxExpressionValue",(function(){return j.w})),n.d(t,"isDatatable",(function(){return j.i})),n.d(t,"ExpressionType",(function(){return j.a})),n.d(t,"PointSeriesColumnNames",(function(){return j.b})),n.d(t,"derivative",(function(){return $})),n.d(t,"movingAverage",(function(){return I})),n.d(t,"mapColumn",(function(){return U})),n.d(t,"math",(function(){return q})),n.d(t,"mathColumn",(function(){return z})),n.d(t,"clog",(function(){return T})),n.d(t,"createTable",(function(){return A})),n.d(t,"font",(function(){return M})),n.d(t,"variableSet",(function(){return R})),n.d(t,"variable",(function(){return F})),n.d(t,"theme",(function(){return N})),n.d(t,"cumulativeSum",(function(){return k})),n.d(t,"overallMetric",(function(){return L})),n.d(t,"getUiSettingFn",(function(){return H})),n.d(t,"buildResultColumns",(function(){return B.a})),n.d(t,"getBucketIdentifier",(function(){return B.b})),n.d(t,"ExpressionFunction",(function(){return expression_function_ExpressionFunction})),n.d(t,"ExpressionRenderer",(function(){return expression_renderer_ExpressionRenderer})),n.d(t,"createExecutorContainer",(function(){return J})),n.d(t,"pureSelectors",(function(){return Y})),n.d(t,"pureTransitions",(function(){return W})),n.d(t,"defaultState",(function(){return V})),n.d(t,"createExecutionContainer",(function(){return te})),n.d(t,"executionPureTransitions",(function(){return Q})),n.d(t,"ExpressionsService",(function(){return expressions_services_ExpressionsService})),n.d(t,"createDefaultInspectorAdapters",(function(){return ue})),n.d(t,"createMockContext",(function(){return oe})),n.d(t,"createError",(function(){return ne})),n.d(t,"getByAlias",(function(){return se})),n.d(t,"ExpressionsInspectorAdapter",(function(){return expressions_inspector_adapter_ExpressionsInspectorAdapter})),n.d(t,"TablesAdapter",(function(){return tables_adapter_TablesAdapter}));let r=function(e){return e.REPEAT="repeat",e.REPEAT_NO="no-repeat",e.REPEAT_X="repeat-x",e.REPEAT_Y="repeat-y",e.ROUND="round",e.SPACE="space",e}({}),s=function(e){return e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover",e}({}),i=function(e){return e.ITALIC="italic",e.NORMAL="normal",e}({}),o=function(e){return e.NORMAL="normal",e.BOLD="bold",e.BOLDER="bolder",e.LIGHTER="lighter",e.ONE="100",e.TWO="200",e.THREE="300",e.FOUR="400",e.FIVE="500",e.SIX="600",e.SEVEN="700",e.EIGHT="800",e.NINE="900",e}({}),a=function(e){return e.AUTO="auto",e.HIDDEN="hidden",e.SCROLL="scroll",e.VISIBLE="visible",e}({}),u=function(e){return e.CENTER="center",e.JUSTIFY="justify",e.LEFT="left",e.RIGHT="right",e}({}),c=function(e){return e.NONE="none",e.UNDERLINE="underline",e}({}),l=function(e){return e.PX="px",e.PT="pt",e}({});const{toExpression:d}=n(26);function p(e,t){return d(e,t)}function f(e,t){const n=Object.entries(t).reduce(((e,[t,n])=>(Array.isArray(n)?e[t]=n.map((e=>v(e)?x(e):e)):void 0!==n?e[t]=v(n)?[x(n)]:[n]:delete e[t],e)),{...t});return{type:"expression_function_builder",name:e,arguments:n,addArgument(e,t){return void 0!==t&&(n.hasOwnProperty(e)||(n[e]=[]),n[e].push(t)),this},getArgument(e){if(n.hasOwnProperty(e))return n[e]},replaceArgument(e,t){if(!n.hasOwnProperty(e))throw new Error("Argument to replace does not exist on this function");return n[e]=t,this},removeArgument(e){return delete n[e],this},toAst:()=>({type:"function",function:e,arguments:Object.entries(n).reduce(((e,[t,n])=>(e[t]=n.map((e=>g(e)?e.toAst():e)),e)),{})}),toString(){return p({type:"expression",chain:[this.toAst()]},"expression")}}}const{parse:h}=n(26);function m(e,t){try{return h(String(e),{startRule:t})}catch(e){throw new Error(`Unable to parse expression: ${e.message}`)}}function g(e){return"expression_builder"===(null==e?void 0:e.type)}function v(e){return"expression"===(null==e?void 0:e.type)}const b=e=>({type:"expression",chain:e.map((e=>e.toAst()))});function x(e){const t=e=>e.map((e=>f(e.function,e.arguments))),n=e?"string"==typeof(r=e)?t(m(r,"expression").chain):Array.isArray(r)?r:t(r.chain):[];var r;return{type:"expression_builder",functions:n,findFunction:e=>n.reduce(((t,n)=>(Object.values(n.arguments).forEach((n=>{n.forEach((n=>{g(n)&&(t=t.concat(n.findFunction(e)))}))})),n.name===e&&t.push(n),t)),[]),toAst(){if(n.length<1)throw new Error("Functions have not been added to the expression builder");return b(n)},toString(){if(n.length<1)throw new Error("Functions have not been added to the expression builder");return p(b(n),"expression")}}}function y(e){return p(e,"expression")}function w(e){return m(e,"expression")}var E=n(6),j=n(4),O=n(0),C=n.n(O);class expression_function_parameter_ExpressionFunctionParameter{constructor(e,t){C()(this,"name",void 0),C()(this,"required",void 0),C()(this,"help",void 0),C()(this,"types",void 0),C()(this,"default",void 0),C()(this,"aliases",void 0),C()(this,"deprecated",void 0),C()(this,"multi",void 0),C()(this,"resolve",void 0),C()(this,"strict",void 0),C()(this,"options",void 0);const{required:n,help:r,types:s,aliases:i,deprecated:o,multi:a,options:u,resolve:c,strict:l}=t;if("_"===e)throw Error("Arg names must not be _. Use it in aliases instead.");this.name=e,this.required=!!n,this.help=r||"",this.types=s||[],this.default=t.default,this.aliases=i||[],this.deprecated=!!o,this.multi=!!a,this.options=u||[],this.resolve=null==c||c,this.strict=l}accepts(e){var t;return!(null!==(t=this.types)&&void 0!==t&&t.length)||this.types.includes(e)}}var _=n(3);class expression_function_ExpressionFunction{constructor(e){C()(this,"name",void 0),C()(this,"namespace",void 0),C()(this,"aliases",void 0),C()(this,"type",void 0),C()(this,"allowCache",void 0),C()(this,"fn",void 0),C()(this,"help",void 0),C()(this,"args",{}),C()(this,"inputTypes",void 0),C()(this,"disabled",void 0),C()(this,"deprecated",void 0),C()(this,"telemetry",void 0),C()(this,"extract",void 0),C()(this,"inject",void 0),C()(this,"migrations",void 0),C()(this,"accepts",(e=>{var t,n;return null===(t=null===(n=this.inputTypes)||void 0===n?void 0:n.includes(e))||void 0===t||t}));const{name:t,type:n,aliases:r,fn:s,help:i,args:o,inputTypes:a,context:u,disabled:c,deprecated:l,telemetry:d,inject:p,extract:f,migrations:h,namespace:m,allowCache:g}=e;this.name=t,this.namespace=m,this.type=n,this.aliases=r||[],this.fn=s,this.help=i||"",this.inputTypes=a||(null==u?void 0:u.types),this.allowCache=!!g,this.disabled=c||!1,this.deprecated=!!l,this.telemetry=d||((e,t)=>t),this.inject=p||_.identity,this.extract=f||(e=>({state:e,references:[]})),this.migrations=h||{};for(const[e,t]of Object.entries(o||{}))this.args[e]=new expression_function_parameter_ExpressionFunctionParameter(e,t)}}const T={name:"clog",args:{},help:"Outputs the _input_ in the console. This function is for debug purposes",fn:e=>(console.log(e),e)};var S=n(2);const A={name:"createTable",type:"datatable",inputTypes:["null"],help:S.i18n.translate("expressions.functions.createTableHelpText",{defaultMessage:"Creates a datatable with a list of columns, and 1 or more empty rows. To populate the rows, use {mapColumnFn} or {mathColumnFn}.",values:{mathColumnFn:"`mathColumn`",mapColumnFn:"`mapColumn`"}}),args:{ids:{types:["string"],help:S.i18n.translate("expressions.functions.createTable.args.idsHelpText",{defaultMessage:"Column ids to generate in positional order. ID represents the key in the row."}),required:!1,multi:!0},names:{types:["string"],help:S.i18n.translate("expressions.functions.createTable.args.nameHelpText",{defaultMessage:"Column names to generate in positional order. Names are not required to be unique, and default to the ID if not provided."}),required:!1,multi:!0},rowCount:{types:["number"],help:S.i18n.translate("expressions.functions.createTable.args.rowCountText",{defaultMessage:"The number of empty rows to add to the table, to be assigned a value later"}),default:1,required:!1}},fn(e,t){var n;const r=[];return(null!==(n=t.ids)&&void 0!==n?n:[]).map(((e,n)=>{var s,i;r.push({id:e,name:null!==(s=null===(i=t.names)||void 0===i?void 0:i[n])&&void 0!==s?s:e,meta:{type:"null"}})})),{columns:r,rows:[...Array(t.rowCount)].map((()=>({}))),type:"datatable"}}},M={name:"font",aliases:[],type:"style",help:S.i18n.translate("expressions.functions.fontHelpText",{defaultMessage:"Create a font style."}),inputTypes:["null"],args:{align:{default:'{ theme "font.align" default="left" }',help:S.i18n.translate("expressions.functions.font.args.alignHelpText",{defaultMessage:"The horizontal text alignment."}),options:Object.values(u),types:["string"]},color:{default:'{ theme "font.color" }',help:S.i18n.translate("expressions.functions.font.args.colorHelpText",{defaultMessage:"The text color."}),types:["string"]},family:{default:`{ theme "font.family" default="${E.openSans.value}" }`,help:S.i18n.translate("expressions.functions.font.args.familyHelpText",{defaultMessage:"An acceptable {css} web font string",values:{css:"CSS"}}),types:["string"]},italic:{default:'{ theme "font.italic" default=false }',help:S.i18n.translate("expressions.functions.font.args.italicHelpText",{defaultMessage:"Italicize the text?"}),options:[!0,!1],types:["boolean"]},lHeight:{default:'{ theme "font.lHeight" }',aliases:["lineHeight"],help:S.i18n.translate("expressions.functions.font.args.lHeightHelpText",{defaultMessage:"The line height in pixels"}),types:["number","null"]},size:{default:'{ theme "font.size" default=14 }',help:S.i18n.translate("expressions.functions.font.args.sizeHelpText",{defaultMessage:"The font size"}),types:["number"]},sizeUnit:{default:"px",help:S.i18n.translate("expressions.functions.font.args.sizeUnitHelpText",{defaultMessage:"The font size unit"}),types:["string"],options:["px","pt"]},underline:{default:'{ theme "font.underline" default=false }',help:S.i18n.translate("expressions.functions.font.args.underlineHelpText",{defaultMessage:"Underline the text?"}),options:[!0,!1],types:["boolean"]},weight:{default:'{ theme "font.weight" default="normal" }',help:S.i18n.translate("expressions.functions.font.args.weightHelpText",{defaultMessage:"The font weight. For example, {list}, or {end}.",values:{list:Object.values(o).slice(0,-1).map((e=>`\`"${e}"\``)).join(", "),end:`\`"${Object.values(o).slice(-1)[0]}"\``}}),options:Object.values(o),types:["string"]}},fn:(e,t)=>{if(!Object.values(o).includes(t.weight))throw new Error(S.i18n.translate("expressions.functions.font.invalidFontWeightErrorMessage",{defaultMessage:"Invalid font weight: ''{weight}''",values:{weight:t.weight}}));if(!Object.values(u).includes(t.align))throw new Error(S.i18n.translate("expressions.functions.font.invalidTextAlignmentErrorMessage",{defaultMessage:"Invalid text alignment: ''{align}''",values:{align:t.align}}));const n=null!=t.lHeight?`${t.lHeight}px`:"1",r=[l.PX,l.PT];if(t.sizeUnit&&!r.includes(t.sizeUnit))throw new Error(S.i18n.translate("expressions.functions.font.invalidSizeUnitErrorMessage",{defaultMessage:"Invalid size unit: ''{sizeUnit}''",values:{sizeUnit:t.sizeUnit}}));const s={fontFamily:t.family,fontWeight:t.weight,fontStyle:t.italic?i.ITALIC:i.NORMAL,textDecoration:t.underline?c.UNDERLINE:c.NONE,textAlign:t.align,fontSize:`${t.size}${t.sizeUnit}`,lineHeight:n};return t.color&&(s.color=t.color),{type:"style",spec:s,css:(a=s,a?Object.keys(a).map((e=>e.trim().replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\W/g,(e=>/[À-ž]/.test(e)?e:"-")).replace(/^-+|-+$/g,"").toLowerCase().concat(":").concat(String(a[e])))).join(";"):"")};var a}},R={name:"var_set",help:S.i18n.translate("expressions.functions.varset.help",{defaultMessage:"Updates the Kibana global context."}),args:{name:{types:["string"],aliases:["_"],required:!0,multi:!0,help:S.i18n.translate("expressions.functions.varset.name.help",{defaultMessage:"Specify the name of the variable."})},value:{aliases:["val"],multi:!0,help:S.i18n.translate("expressions.functions.varset.val.help",{defaultMessage:"Specify the value for the variable. When unspecified, the input context is used."})}},fn(e,t,n){const{variables:r}=n;return t.name.forEach(((n,s)=>{var i;r[n]=void 0===(null===(i=t.value)||void 0===i?void 0:i[s])?e:t.value[s]})),e}},F={name:"var",help:S.i18n.translate("expressions.functions.var.help",{defaultMessage:"Updates the Kibana global context."}),args:{name:{types:["string"],aliases:["_"],required:!0,help:S.i18n.translate("expressions.functions.var.name.help",{defaultMessage:"Specify the name of the variable."})}},fn(e,t,n){const{variables:r}=n;return r[t.name]}},N={name:"theme",aliases:[],help:S.i18n.translate("expressions.functions.themeHelpText",{defaultMessage:"Reads a theme setting."}),inputTypes:["null"],args:{variable:{aliases:["_"],help:S.i18n.translate("expressions.functions.theme.args.variableHelpText",{defaultMessage:"Name of the theme variable to read."}),required:!0,types:["string"]},default:{help:S.i18n.translate("expressions.functions.theme.args.defaultHelpText",{defaultMessage:"default value in case theming info is not available."})}},fn:(e,t,n)=>{const r=n.variables.theme||{};return Object(_.get)(r,t.variable,t.default)}},k={name:"cumulative_sum",type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.cumulativeSum.help",{defaultMessage:"Calculates the cumulative sum of a column in a data table"}),args:{by:{help:S.i18n.translate("expressions.functions.cumulativeSum.args.byHelpText",{defaultMessage:"Column to split the cumulative sum calculation by"}),multi:!0,types:["string"],required:!1},inputColumnId:{help:S.i18n.translate("expressions.functions.cumulativeSum.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the cumulative sum of"}),types:["string"],required:!0},outputColumnId:{help:S.i18n.translate("expressions.functions.cumulativeSum.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting cumulative sum in"}),types:["string"],required:!0},outputColumnName:{help:S.i18n.translate("expressions.functions.cumulativeSum.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting cumulative sum in"}),types:["string"],required:!1}},async fn(e,t){const{cumulativeSumFn:r}=await n.e(2).then(n.bind(null,94));return r(e,t)}},L={name:"overall_metric",type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.overallMetric.help",{defaultMessage:"Calculates the overall sum, min, max or average of a column in a data table"}),args:{by:{help:S.i18n.translate("expressions.functions.overallMetric.args.byHelpText",{defaultMessage:"Column to split the overall calculation by"}),multi:!0,types:["string"],required:!1},metric:{help:S.i18n.translate("expressions.functions.overallMetric.metricHelpText",{defaultMessage:"Metric to calculate"}),types:["string"],options:["sum","min","max","average"]},inputColumnId:{help:S.i18n.translate("expressions.functions.overallMetric.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the overall metric of"}),types:["string"],required:!0},outputColumnId:{help:S.i18n.translate("expressions.functions.overallMetric.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting overall metric in"}),types:["string"],required:!0},outputColumnName:{help:S.i18n.translate("expressions.functions.overallMetric.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting overall metric in"}),types:["string"],required:!1}},async fn(e,t){const{overallMetricFn:r}=await n.e(5).then(n.bind(null,95));return r(e,t)}},$={name:"derivative",type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.derivative.help",{defaultMessage:"Calculates the derivative of a column in a data table"}),args:{by:{help:S.i18n.translate("expressions.functions.derivative.args.byHelpText",{defaultMessage:"Column to split the derivative calculation by"}),multi:!0,types:["string"],required:!1},inputColumnId:{help:S.i18n.translate("expressions.functions.derivative.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the derivative of"}),types:["string"],required:!0},outputColumnId:{help:S.i18n.translate("expressions.functions.derivative.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting derivative in"}),types:["string"],required:!0},outputColumnName:{help:S.i18n.translate("expressions.functions.derivative.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting derivative in"}),types:["string"],required:!1}},async fn(e,t){const{derivativeFn:r}=await n.e(3).then(n.bind(null,96));return r(e,t)}},I={name:"moving_average",type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.movingAverage.help",{defaultMessage:"Calculates the moving average of a column in a data table"}),args:{by:{help:S.i18n.translate("expressions.functions.movingAverage.args.byHelpText",{defaultMessage:"Column to split the moving average calculation by"}),multi:!0,types:["string"],required:!1},inputColumnId:{help:S.i18n.translate("expressions.functions.movingAverage.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the moving average of"}),types:["string"],required:!0},outputColumnId:{help:S.i18n.translate("expressions.functions.movingAverage.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting moving average in"}),types:["string"],required:!0},outputColumnName:{help:S.i18n.translate("expressions.functions.movingAverage.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting moving average in"}),types:["string"],required:!1},window:{help:S.i18n.translate("expressions.functions.movingAverage.args.windowHelpText",{defaultMessage:'The size of window to "slide" across the histogram.'}),types:["number"],default:5}},async fn(e,t){const{movingAverageFn:r}=await n.e(4).then(n.bind(null,97));return r(e,t)}};function H({getStartDependencies:e}){return{name:"uiSetting",help:S.i18n.translate("expressions.functions.uiSetting.help",{defaultMessage:"Returns a UI settings parameter value."}),args:{default:{help:S.i18n.translate("expressions.functions.uiSetting.args.default",{defaultMessage:"A default value in case of the parameter is not set."})},parameter:{aliases:["_"],help:S.i18n.translate("expressions.functions.uiSetting.args.parameter",{defaultMessage:"The parameter name."}),required:!0,types:["string"]}},async fn(t,{default:n,parameter:r},{getKibanaRequest:s}){const{uiSettings:i}=await e((()=>{const e=null==s?void 0:s();if(!e)throw new Error(S.i18n.translate("expressions.functions.uiSetting.error.kibanaRequest",{defaultMessage:"A KibanaRequest is required to get UI settings on the server. Please provide a request object to the expression execution params."}));return e}));try{return{type:"ui_setting",key:r,value:await i.get(r,n)}}catch{throw new Error(S.i18n.translate("expressions.functions.uiSetting.error.parameter",{defaultMessage:'Invalid parameter "{parameter}".',values:{parameter:r}}))}}}}const P="`TinyMath`",q={name:"math",type:void 0,inputTypes:["number","datatable"],help:S.i18n.translate("expressions.functions.mathHelpText",{defaultMessage:"Interprets a {TINYMATH} math expression using a {TYPE_NUMBER} or {DATATABLE} as {CONTEXT}. The {DATATABLE} columns are available by their column name. If the {CONTEXT} is a number it is available as {value}.",values:{TINYMATH:P,CONTEXT:"_context_",DATATABLE:"`datatable`",value:"`value`",TYPE_NUMBER:"`number`"}}),args:{expression:{aliases:["_"],types:["string"],help:S.i18n.translate("expressions.functions.math.args.expressionHelpText",{defaultMessage:"An evaluated {TINYMATH} expression. See {TINYMATH_URL}.",values:{TINYMATH:P,TINYMATH_URL:"https://www.elastic.co/guide/en/kibana/current/canvas-tinymath-functions.html"}})},onError:{types:["string"],options:["throw","false","zero","null"],help:S.i18n.translate("expressions.functions.math.args.onErrorHelpText",{defaultMessage:"In case the {TINYMATH} evaluation fails or returns NaN, the return value is specified by onError. When `'throw'`, it will throw an exception, terminating expression execution (default).",values:{TINYMATH:P}})}},fn:async(e,t)=>{const{mathFn:r}=await n.e(1).then(n.bind(null,98));return r(e,t)}},z={name:"mathColumn",type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.mathColumnHelpText",{defaultMessage:"Adds a column by evaluating {tinymath} on each row. This function is optimized for math and performs better than using a math expression in {mapColumnFn}.",values:{mapColumnFn:"`mapColumn`",tinymath:"`TinyMath`"}}),args:{...q.args,id:{types:["string"],help:S.i18n.translate("expressions.functions.mathColumn.args.idHelpText",{defaultMessage:"id of the resulting column. Must be unique."}),required:!0},name:{types:["string"],aliases:["_","column"],help:S.i18n.translate("expressions.functions.mathColumn.args.nameHelpText",{defaultMessage:"The name of the resulting column. Names are not required to be unique."}),required:!0},castColumns:{types:["string"],multi:!0,help:S.i18n.translate("expressions.functions.mathColumn.args.castColumnsHelpText",{defaultMessage:"The ids of columns to cast to numbers before applying the formula"}),required:!1},copyMetaFrom:{types:["string","null"],help:S.i18n.translate("expressions.functions.mathColumn.args.copyMetaFromHelpText",{defaultMessage:"If set, the meta object from the specified column id is copied over to the specified target column. If the column doesn't exist it silently fails."}),required:!1,default:null}},fn:async(e,t,n)=>{var r;const s=[...e.columns];if(s.findIndex((({id:e})=>e===t.id))>-1)throw new Error(S.i18n.translate("expressions.functions.mathColumn.uniqueIdError",{defaultMessage:"ID must be unique"}));const i=await Promise.all(e.rows.map((async r=>{let s=r;t.castColumns&&(s={...r},t.castColumns.forEach((e=>{switch(typeof r[e]){case"string":const t=Number(new Date(s[e]));return isNaN(t)?void(s[e]=Number(s[e])):void(s[e]=t);case"boolean":return void(s[e]=Number(s[e]))}})));const i=await q.fn({...e,columns:e.columns,rows:[s]},{expression:t.expression,onError:t.onError},n);if(Array.isArray(i)){if(1===i.length)return{...r,[t.id]:i[0]};throw new Error(S.i18n.translate("expressions.functions.mathColumn.arrayValueError",{defaultMessage:"Cannot perform math on array values at {name}",values:{name:t.name}}))}return{...r,[t.id]:i}})));let o="null";if(i.length)for(const e of i){const n=Object(j.g)(e[t.id]);if("null"!==n){o=n;break}}const a={id:t.id,name:null!==(r=t.name)&&void 0!==r?r:t.id,meta:{type:o,params:{id:o}}};if(t.copyMetaFrom){const e=s.find((({id:e})=>e===t.copyMetaFrom));a.meta={...a.meta,...(null==e?void 0:e.meta)||{}}}return s.push(a),{...e,columns:s,rows:i}}};var D=n(1);const U={name:"mapColumn",aliases:["mc"],type:"datatable",inputTypes:["datatable"],help:S.i18n.translate("expressions.functions.mapColumnHelpText",{defaultMessage:"Adds a column calculated as the result of other columns. Changes are made only when you provide arguments.See also {alterColumnFn} and {staticColumnFn}.",values:{alterColumnFn:"`alterColumn`",staticColumnFn:"`staticColumn`"}}),args:{id:{types:["string","null"],help:S.i18n.translate("expressions.functions.mapColumn.args.idHelpText",{defaultMessage:"An optional id of the resulting column. When no id is provided, the id will be looked up from the existing column by the provided name argument. If no column with this name exists yet, a new column with this name and an identical id will be added to the table."}),required:!1,default:null},name:{types:["string"],aliases:["_","column"],help:S.i18n.translate("expressions.functions.mapColumn.args.nameHelpText",{defaultMessage:"The name of the resulting column. Names are not required to be unique."}),required:!0},expression:{types:["boolean","number","string","null"],resolve:!1,aliases:["exp","fn","function"],help:S.i18n.translate("expressions.functions.mapColumn.args.expressionHelpText",{defaultMessage:"An expression that is executed on every row, provided with a single-row {DATATABLE} context and returning the cell value.",values:{DATATABLE:"`datatable`"}}),required:!0},copyMetaFrom:{types:["string","null"],help:S.i18n.translate("expressions.functions.mapColumn.args.copyMetaFromHelpText",{defaultMessage:"If set, the meta object from the specified column id is copied over to the specified target column. If the column doesn't exist it silently fails."}),required:!1,default:null}},fn(e,t){var n,r,s;const i=t.copyMetaFrom?e.columns.find((({id:e})=>e===t.copyMetaFrom)):void 0,o=e.columns.findIndex((({id:e,name:n})=>t.id?e===t.id:n===t.name)),a=-1===o?e.columns.length:o,u=null!==(n=null!==(r=null===(s=e.columns[a])||void 0===s?void 0:s.id)&&void 0!==r?r:t.id)&&void 0!==n?n:t.name;return Object(D.defer)((()=>Object(D.combineLatest)(e.rows.map((n=>t.expression({...e,columns:[...e.columns],rows:[n]}).pipe(Object(D.map)((e=>({...n,[u]:e}))),Object(D.defaultIfEmpty)(n))))))).pipe(Object(D.defaultIfEmpty)([]),Object(D.map)((n=>{var r;let s="null";for(const e of n){const t=Object(j.g)(e[u]);if("null"!==t){s=t;break}}const o=[...e.columns];return o[a]={id:u,name:t.name,meta:{type:s,params:{id:s},...null!==(r=null==i?void 0:i.meta)&&void 0!==r?r:{}}},{...e,columns:o,rows:n}})))}};var B=n(22);class expression_renderer_ExpressionRenderer{constructor(e){C()(this,"name",void 0),C()(this,"namespace",void 0),C()(this,"displayName",void 0),C()(this,"help",void 0),C()(this,"validate",void 0),C()(this,"reuseDomNode",void 0),C()(this,"render",void 0);const{name:t,displayName:n,help:r,validate:s,reuseDomNode:i,render:o,namespace:a}=e;this.name=t,this.namespace=a,this.displayName=n||t,this.help=r||"",this.validate=s||(()=>{}),this.reuseDomNode=Boolean(i),this.render=o}}class expression_renderer_registry_ExpressionRendererRegistry{constructor(){C()(this,"renderers",new Map)}register(e){"function"==typeof e&&(e=e());const t=new expression_renderer_ExpressionRenderer(e);this.renderers.set(t.name,t)}get(e){return this.renderers.get(e)||null}toJS(){return this.toArray().reduce(((e,t)=>(e[t.name]=t,e)),{})}toArray(){return[...this.renderers.values()]}}var G=n(16);const V={functions:{},types:{},context:{}},W={addFunction:e=>t=>({...e,functions:{...e.functions,[t.name]:t}}),addType:e=>t=>({...e,types:{...e.types,[t.name]:t}})},Y={getFunction:e=>t=>e.functions[t]||null,getType:e=>t=>e.types[t]||null,getContext:({context:e})=>()=>e},J=(e=V)=>Object(G.createStateContainer)(e,W,Y);var K=n(12),X=n(21);const Z={...V,state:"not-started",ast:{type:"expression",chain:[]}},Q={start:e=>()=>({...e,state:"pending"}),setResult:e=>t=>({...e,state:"result",result:t}),setError:e=>t=>({...e,state:"error",error:t})},ee=e=>e,te=(e=Z)=>Object(G.createStateContainer)(e,Q,{},{freeze:ee}),ne=e=>({type:"error",error:{stack:void 0,message:"string"==typeof e?e:String(e.message),name:"object"==typeof e&&e.name||"Error",original:e instanceof Error?e:"object"==typeof e&&"original"in e&&e.original instanceof Error?e.original:void 0}}),re="*";function se(e,t,n){const r=t.toLowerCase();return Object.values(e).find((({name:e,aliases:t,namespace:s})=>!!e&&(!(e.toLowerCase()!==r||s&&n!==re&&s!==n)||(t||[]).some((e=>e.toLowerCase()===r&&(!s||n===re||s===n))))))}var ie=n(17);class tables_adapter_TablesAdapter extends ie.EventEmitter{constructor(...e){super(...e),C()(this,"_tables",{})}logDatatable(e,t){this._tables[e]=t,this.emit("change",this.tables)}reset(){this._tables={},this.emit("change",this.tables)}get tables(){return this._tables}}class expressions_inspector_adapter_ExpressionsInspectorAdapter extends ie.EventEmitter{constructor(...e){super(...e),C()(this,"_ast",{})}logAST(e){this._ast=e,this.emit("change",this._ast)}get ast(){return this._ast}}const oe=()=>({getSearchContext:()=>({}),getSearchSessionId:()=>{},types:{},variables:{},abortSignal:{},inspectorAdapters:{}});var ae=n(28);const ue=()=>({requests:new ae.RequestAdapter,tables:new tables_adapter_TablesAdapter,expression:new expressions_inspector_adapter_ExpressionsInspectorAdapter});var ce=n(11);class execution_contract_ExecutionContract{get isPending(){const{state:e,result:t}=this.execution.state.get();return!("error"===e||"result"===e&&(null==t||!t.partial))}constructor(e){C()(this,"execution",void 0),C()(this,"cancel",(()=>{this.execution.cancel()})),C()(this,"getData",(()=>this.execution.result.pipe(Object(D.catchError)((({name:e,message:t,stack:n})=>Object(D.of)({partial:!1,result:{type:"error",error:{name:e,message:t,stack:n}}})))))),C()(this,"getExpression",(()=>this.execution.expression)),C()(this,"getAst",(()=>this.execution.state.get().ast)),C()(this,"inspect",(()=>this.execution.inspectorAdapters)),this.execution=e}}class execution_Execution{get inspectorAdapters(){return this.context.inspectorAdapters}constructor(e,t,n=new Map){C()(this,"state",void 0),C()(this,"input",null),C()(this,"input$",new D.ReplaySubject(1)),C()(this,"context",void 0),C()(this,"abortController",new AbortController),C()(this,"hasStarted",!1),C()(this,"result",void 0),C()(this,"childExecutions",[]),C()(this,"cacheTimeout",3e4),C()(this,"contract",void 0),C()(this,"expression",void 0),this.execution=e,this.logger=t,this.functionCache=n;const{executor:r}=e;if(this.contract=new execution_contract_ExecutionContract(this),!e.ast&&!e.expression)throw new TypeError("Execution params should contain at least .ast or .expression key.");if(e.ast&&e.expression)throw new TypeError("Execution params cannot contain both .ast and .expression key.");this.expression=e.expression||y(e.ast);const s=e.ast||w(this.expression);this.state=te({...r.state,state:"not-started",ast:s});const i=e.params.inspectorAdapters||ue();this.context={getSearchContext:()=>this.execution.params.searchContext||{},getSearchSessionId:()=>e.params.searchSessionId,getKibanaRequest:e.params.kibanaRequest?()=>e.params.kibanaRequest:void 0,variables:e.params.variables||{},allowCache:this.execution.params.allowCache,types:r.getTypes(),abortSignal:this.abortController.signal,inspectorAdapters:i,logDatatable:(e,t)=>{i.tables[e]=t},isSyncColorsEnabled:()=>e.params.syncColors,isSyncCursorEnabled:()=>e.params.syncCursor,isSyncTooltipsEnabled:()=>e.params.syncTooltips,...e.executor.context,getExecutionContext:()=>e.params.executionContext},this.result=this.input$.pipe(Object(D.switchMap)((e=>{return this.invokeChain(this.state.get().ast.chain,e).pipe((n=this.abortController.signal,e=>new D.Observable((t=>{const r=()=>{t.error(new K.AbortError)};t.add(e.subscribe(t)),t.add((()=>n.removeEventListener("abort",r))),n.addEventListener("abort",r),n.aborted&&r()}))),(e=>new D.Observable((t=>{let n;t.add(e.subscribe({next:e=>{n={result:e,partial:!0},t.next(n)},error:e=>t.error(e),complete:()=>{n&&(n.partial=!1),t.complete()}})),t.add((()=>{n=void 0}))}))),this.execution.params.partial&&this.execution.params.throttle?(t=this.execution.params.throttle,e=>new D.Observable((n=>{let r,s=!1;const i=()=>{s&&(n.next(r),s=!1,r=void 0)};let o;const a=Object(D.timer)(0,t).pipe(Object(D.takeWhile)((()=>s)),Object(D.finalize)((()=>{n.remove(o),o=void 0})));n.add(e.subscribe({next:e=>{r=e,s=!0,o||(o=a.subscribe(i),n.add(o))},error:e=>n.error(e),complete:()=>{i(),n.complete()}})),n.add((()=>{s=!1,r=void 0}))}))):D.identity);var t,n})),Object(D.catchError)((e=>this.abortController.signal.aborted?(this.childExecutions.forEach((e=>e.cancel())),Object(D.of)({result:ne({message:"The expression was aborted.",name:"AbortError"}),partial:!1})):Object(D.throwError)(e))),Object(D.tap)({next:e=>{var t;null===(t=this.context.inspectorAdapters.expression)||void 0===t||t.logAST(this.state.get().ast),this.state.transitions.setResult(e)},error:e=>this.state.transitions.setError(e)}),Object(D.shareReplay)(1))}cancel(){this.abortController.abort()}start(e=null,t){if(this.hasStarted)throw new Error("Execution already started.");var n;return this.hasStarted=!0,this.input=e,this.state.transitions.start(),t||null===(n=this.context.inspectorAdapters.requests)||void 0===n||n.reset(),Object(D.isObservable)(e)?e.subscribe(this.input$):Object(X.isPromise)(e)?Object(D.from)(e).subscribe(this.input$):Object(D.of)(e).subscribe(this.input$),this.result}invokeChain([e,...t],n){return e?Object(D.defer)((()=>{const{function:r,arguments:s}=e,i=se(this.state.get().functions,r,this.execution.params.namespace);if(!i)throw ne({name:"fn not found",message:S.i18n.translate("expressions.execution.functionNotFound",{defaultMessage:"Function {fnName} could not be found.",values:{fnName:r}})});if(i.disabled)throw ne({name:"fn is disabled",message:S.i18n.translate("expressions.execution.functionDisabled",{defaultMessage:"Function {fnName} is disabled.",values:{fnName:r}})});var o;i.deprecated&&(null===(o=this.logger)||void 0===o||o.warn(`Function '${r}' is deprecated`)),this.execution.params.debug&&(e.debug={input:n,args:{},duration:0,fn:i.name,success:!0});const a=this.execution.params.debug?Object(K.now)():0;return this.resolveArgs(i,n,s).pipe(Object(D.switchMap)((s=>(Object(ce.b)(s)?Object(D.throwError)(s.error):Object(D.of)(s)).pipe(Object(D.tap)((t=>{var n;return this.execution.params.debug&&Object.assign(null!==(n=e.debug)&&void 0!==n?n:{},{args:t})})),Object(D.switchMap)((e=>this.invokeFunction(i,n,e))),this.execution.params.partial?D.identity:Object(D.last)(),Object(D.switchMap)((e=>"error"===Object(j.g)(e)?Object(D.throwError)(e):Object(D.of)(e))),Object(D.tap)((t=>{var n;return this.execution.params.debug&&Object.assign(null!==(n=e.debug)&&void 0!==n?n:{},{output:t})})),Object(D.switchMap)((e=>this.invokeChain(t,e))),Object(D.catchError)((t=>{const n=ne(t);var s;return n.error.message=`[${r}] > ${n.error.message}`,this.execution.params.debug&&Object.assign(null!==(s=e.debug)&&void 0!==s?s:{},{error:n,rawError:t,success:!1}),Object(D.of)(n)}))))),Object(D.finalize)((()=>{var t;this.execution.params.debug&&Object.assign(null!==(t=e.debug)&&void 0!==t?t:{},{duration:Object(K.now)()-a})})))})).pipe(Object(D.catchError)((e=>Object(D.of)(e)))):Object(D.of)(n)}invokeFunction(e,t,n){let r,s,i=!1;return Object(D.of)(t).pipe(Object(D.map)((t=>this.cast(t,e.inputTypes))),Object(D.switchMap)((t=>{if(e.allowCache&&this.context.allowCache&&(r=Object(K.calculateObjectHash)([e.name,t,n,this.context.getSearchContext()])),r&&this.functionCache.has(r)){const e=this.functionCache.get(r);if(e&&Date.now()-e.time<this.cacheTimeout)return Object(D.of)(e.value)}return Object(D.of)(e.fn(t,n,this.context))})),Object(D.switchMap)((e=>Object(D.isObservable)(e)?e:Object(D.from)(Object(X.isPromise)(e)?e:[e]))),Object(D.map)((t=>{const n=Object(j.g)(t),r=e.type;if(r&&n!==r)throw new Error(`Function '${e.name}' should return '${r}', actually returned '${n}'`);const i=this.context.types[e.type];if(i&&i.validate)try{i.validate(t)}catch(t){throw new Error(`Output of '${e.name}' is not a valid type '${e.type}': ${t}`)}return s=t,t})),Object(D.finalize)((()=>{if(i&&r){for(;this.functionCache.size>=1e3;)this.functionCache.delete(this.functionCache.keys().next().value);this.functionCache.set(r,{value:s,time:Date.now()})}}))).pipe(Object(D.tap)({complete:()=>i=!0}))}cast(e,t){if(null==t||!t.length)return e;const n=Object(j.g)(e);if(t.includes(n))return e;const{types:r}=this.state.get(),s=r[n];for(const i of t){if(null!=s&&s.castsTo(i))return s.to(e,i,r);const t=r[i];if(null!=t&&t.castsFrom(n))return t.from(e,r)}throw ne({name:"invalid value",message:`Can not cast '${n}' to any of '${t.join(", ")}'`})}validate(e,t){var n;if(null!==(n=t.options)&&void 0!==n&&n.length&&!t.options.includes(e)){var r;const n=`Value '${e}' is not among the allowed options for argument '${t.name}': '${t.options.join("', '")}'`;if(t.strict)throw ne({message:n,name:"invalid argument"});null===(r=this.logger)||void 0===r||r.warn(n)}}resolveArgs(e,t,n){return Object(D.defer)((()=>{const{args:r}=e,s=Object(_.reduce)(n,((t,n,s)=>{const i=se(r,s);if(!i)throw ne({name:"unknown argument",message:`Unknown argument '${s}' passed to function '${e.name}'`});var o;return i.deprecated&&!t[i.name]&&(null===(o=this.logger)||void 0===o||o.warn(`Argument '${s}' is deprecated in function '${e.name}'`)),t[i.name]=(t[i.name]||[]).concat(n),t}),{});for(const{default:t,name:n,required:i}of Object.values(r))if(n in s||void 0===t||(s[n]=[m(t,"argument")]),i&&!(n in s))throw ne({name:"missing argument",message:`${e.name} requires the "${n}" argument`});const i=Object(_.mapValues)(s,((e,n)=>e.map((e=>(s=t)=>this.interpret(e,s).pipe(Object(D.pluck)("result"),Object(D.switchMap)((e=>Object(ce.b)(e)?Object(D.of)(e):Object(D.of)(e).pipe(Object(D.map)((e=>this.cast(e,r[n].types))),Object(D.tap)((e=>this.validate(e,r[n]))),Object(D.catchError)((e=>Object(D.of)(e))))))))))),o=Object(_.keys)(i);return o.length?Object(D.combineLatest)(o.map((e=>{const t=i[e];return t.length?r[e].resolve?Object(D.combineLatest)(t.map((e=>e()))).pipe(Object(D.map)((e=>{var t;return null!==(t=e.find(ce.b))&&void 0!==t?t:e}))):Object(D.of)(t):Object(D.of)([])}))).pipe(Object(D.map)((e=>{var t;return null!==(t=e.find(ce.b))&&void 0!==t?t:Object(_.mapValues)(Object(_.zipObject)(o,e),((e,t)=>r[t].multi?e:Object(_.last)(e)))}))):Object(D.from)([{}])})).pipe(Object(D.catchError)((e=>Object(D.of)(e))))}interpret(e,t){switch(Object(j.g)(e)){case"expression":const n=this.execution.executor.createExecution(e,{...this.execution.params,variables:this.context.variables});return this.childExecutions.push(n),n.start(t,!0);case"string":case"number":case"null":case"boolean":return Object(D.of)({result:e,partial:!1});default:return Object(D.throwError)(new Error(`Unknown AST object: ${JSON.stringify(e)}`))}}}var le=n(14),de=n(15);class TypesRegistry{constructor(e){this.executor=e}register(e){this.executor.registerType(e)}get(e){var t;return null!==(t=this.executor.getType(e))&&void 0!==t?t:null}toJS(){return this.executor.getTypes()}toArray(){return Object.values(this.toJS())}}class FunctionsRegistry{constructor(e){this.executor=e}register(e){this.executor.registerFunction(e)}get(e){var t;return null!==(t=this.executor.getFunction(e))&&void 0!==t?t:null}toJS(){return this.executor.getFunctions()}toArray(){return Object.values(this.toJS())}}class executor_Executor{static createWithDefaults(e,t){const n=new executor_Executor(e,t);for(const e of de.r)n.registerType(e);return n}constructor(e,t,n=new Map){C()(this,"container",void 0),C()(this,"functions",void 0),C()(this,"types",void 0),C()(this,"functionCache",void 0),this.logger=e,this.functions=new FunctionsRegistry(this),this.types=new TypesRegistry(this),this.container=J(t),this.functionCache=n}get state(){return this.container.get()}registerFunction(e){const t=new expression_function_ExpressionFunction("object"==typeof e?e:e());this.container.transitions.addFunction(t)}getFunction(e,t){const n=this.container.get().functions[e];if(null==n||!n.namespace||n.namespace===t)return n}getFunctions(e){const t=Object.entries(this.container.get().functions).filter((([t,n])=>!n.namespace||n.namespace===e));return Object.fromEntries(t)}registerType(e){const t=new le.a("object"==typeof e?e:e());this.container.transitions.addType(t)}getType(e){return this.container.get().types[e]}getTypes(){return this.container.get().types}get context(){return this.container.selectors.getContext()}run(e,t,n={}){return this.createExecution(e,n).start(t)}createExecution(e,t={}){const n={params:t,executor:this,functionCache:this.functionCache};return"string"==typeof e?n.expression=e:n.ast=e,new execution_Execution(n,this.logger,this.functionCache)}walkAst(e,t){const n=this.container.get().functions;for(const r of e.chain){const{function:e,arguments:s}=r,i=se(n,e,re);i&&(r.arguments=Object(_.mapValues)(s,(e=>e.map((e=>null!=e&&"object"==typeof e?this.walkAst(e,t):e)))),t(i,r))}return e}walkAstAndTransform(e,t){var n;let r=0;const s=this.container.get().functions;return null!==(n=e.chain.reduce(((e,n,i)=>{const o=i+r,{function:a,arguments:u}=n,c=se(s,a,re);if(!c)return e;n.arguments=Object(_.mapValues)(u,(e=>e.map((e=>null!=e&&"object"==typeof e?this.walkAstAndTransform(e,t):e))));const l=t(c,n);if("function"===l.type){const t=o>0?e.chain.slice(0,o):[],n=e.chain.slice(o+1);return{...e,chain:[...t,l,...n]}}if("expression"===l.type){const{chain:t}=l,n=o>0?e.chain.slice(0,o):[],s=e.chain.slice(o+1);return r+=t.length-1,{...e,chain:[...n,...t,...s]}}return e}),e))&&void 0!==n?n:e}inject(e,t){let n=0;return this.walkAst(Object(_.cloneDeep)(e),((e,r)=>{r.arguments=e.inject(r.arguments,t.filter((e=>e.name.includes(`l${n}_`))).map((e=>({...e,name:e.name.replace(`l${n}_`,"")})))),n++}))}extract(e){let t=0;const n=[];return{state:this.walkAst(Object(_.cloneDeep)(e),((e,r)=>{const{state:s,references:i}=e.extract(r.arguments);r.arguments=s,n.push(...i.map((e=>({...e,name:`l${t}_${e.name}`})))),t+=1})),references:n}}telemetry(e,t){return this.walkAst(Object(_.cloneDeep)(e),((e,n)=>{t=e.telemetry(n.arguments,t)})),t}getAllMigrations(){const e=new Set(Object.values(this.container.get().functions).map((e=>{const t="function"==typeof e.migrations?e.migrations():e.migrations||{};return Object.keys(t)})).flat(1)),t={};return e.forEach((e=>{t[e]=t=>({...this.migrate(t,e)})})),t}migrateToLatest(e){return Object(K.migrateToLatest)(this.getAllMigrations(),e)}migrate(e,t){return this.walkAstAndTransform(Object(_.cloneDeep)(e),((e,n)=>{const r="function"==typeof e.migrations?e.migrations():e.migrations||{};return r[t]?r[t](n):n}))}}class ExpressionsServiceFork{constructor(e,t){this.namespace=e,this.expressionsService=t,this.registerFunction=this.registerFunction.bind(this),this.registerRenderer=this.registerRenderer.bind(this),this.registerType=this.registerType.bind(this),this.run=this.run.bind(this),this.execute=this.execute.bind(this),this.getFunction=this.getFunction.bind(this),this.getFunctions=this.getFunctions.bind(this)}registerFunction(e){return"function"==typeof e&&(e=e()),this.expressionsService.registerFunction({...e,namespace:this.namespace})}registerRenderer(e){return"function"==typeof e&&(e=e()),this.expressionsService.registerRenderer({...e,namespace:this.namespace})}registerType(e){return"function"==typeof e&&(e=e()),this.expressionsService.registerType({...e,namespace:this.namespace})}run(e,t,n){return this.expressionsService.run(e,t,{...n,namespace:this.namespace})}execute(e,t,n){return this.expressionsService.execute(e,t,{...n,namespace:this.namespace})}getFunction(e){return this.expressionsService.getFunction(e,this.namespace)}getFunctions(){return this.expressionsService.getFunctions(this.namespace)}setup(){return{...this.expressionsService,registerFunction:this.registerFunction,registerRenderer:this.registerRenderer,registerType:this.registerType}}start(){return{...this.expressionsService,run:this.run,execute:this.execute,getFunction:this.getFunction,getFunctions:this.getFunctions}}}class expressions_services_ExpressionsService{constructor({logger:e,executor:t=executor_Executor.createWithDefaults(e),renderers:n=new expression_renderer_registry_ExpressionRendererRegistry}={}){C()(this,"executor",void 0),C()(this,"renderers",void 0),C()(this,"getFunction",((e,t)=>this.executor.getFunction(e,t))),C()(this,"getFunctions",(e=>this.executor.getFunctions(e))),C()(this,"getRenderer",(e=>(this.assertStart(),this.renderers.get(e)))),C()(this,"getRenderers",(()=>(this.assertStart(),this.renderers.toJS()))),C()(this,"getType",(e=>(this.assertStart(),this.executor.getType(e)))),C()(this,"getTypes",(()=>this.executor.getTypes())),C()(this,"registerFunction",(e=>this.executor.registerFunction(e))),C()(this,"registerType",(e=>this.executor.registerType(e))),C()(this,"registerRenderer",(e=>this.renderers.register(e))),C()(this,"fork",(e=>(this.assertSetup(),new ExpressionsServiceFork(e,this)))),C()(this,"execute",((e,t,n)=>{this.assertStart();const r=this.executor.createExecution(e,n);return r.start(t),r.contract})),C()(this,"run",((e,t,n)=>(this.assertStart(),this.executor.run(e,t,n)))),C()(this,"telemetry",((e,t={})=>this.executor.telemetry(e,t))),C()(this,"extract",(e=>this.executor.extract(e))),C()(this,"inject",((e,t)=>this.executor.inject(e,t))),C()(this,"getAllMigrations",(()=>this.executor.getAllMigrations())),C()(this,"migrateToLatest",(e=>this.executor.migrateToLatest(e))),this.executor=t,this.renderers=n}isStarted(){return expressions_services_ExpressionsService.started.has(this)}assertSetup(){if(this.isStarted())throw new Error("The expression service is already started and can no longer be configured.")}assertStart(){if(!this.isStarted())throw new Error("The expressions service has not started yet.")}setup(...e){for(const e of[T,A,M,R,F,N,k,$,I,L,U,q,z])this.registerFunction(e);return this}start(...e){return expressions_services_ExpressionsService.started.add(this),this}stop(){expressions_services_ExpressionsService.started.delete(this)}}C()(expressions_services_ExpressionsService,"started",new WeakSet)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return expressions_services_ExpressionsService}));var r=n(20),s=n(7);class expressions_services_ExpressionsService extends s.ExpressionsService{setup({getStartServices:e}){return this.registerFunction(function({getStartServices:e}){return Object(s.getUiSettingFn)({async getStartDependencies(){const[{uiSettings:t}]=await e();return{uiSettings:t}}})}({getStartServices:e})),super.setup()}}const[i,o]=Object(r.createGetterSetter)("Notifications"),[a,u]=Object(r.createGetterSetter)("Renderers registry"),[c,l]=Object(r.createGetterSetter)("ExpressionsService")},function(e,t,n){"use strict";function r(e){if(null==e)return"null";if(Array.isArray(e))throw new Error("Unexpected array value encountered.");if("object"!=typeof e)return typeof e;const{type:t}=e;if(!t)throw new Error("Objects must have a type property");return t}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(10);const s="error",i=e=>{try{return"error"===Object(r.a)(e)}catch(e){}return!1},o={name:s,to:{render:e=>({type:"render",as:s,value:{error:e.error,info:e.info}})}}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){"use strict";n.d(t,"a",(function(){return ExpressionType}));var r=n(0),s=n.n(r),i=n(10);class ExpressionType{constructor(e){s()(this,"name",void 0),s()(this,"namespace",void 0),s()(this,"help",void 0),s()(this,"validate",void 0),s()(this,"create",void 0),s()(this,"serialize",void 0),s()(this,"deserialize",void 0),s()(this,"definition",void 0),s()(this,"getToFn",(e=>this.definition.to?this.definition.to[e]||this.definition.to["*"]:void 0)),s()(this,"getFromFn",(e=>this.definition.from?this.definition.from[e]||this.definition.from["*"]:void 0)),s()(this,"castsTo",(e=>"function"==typeof this.getToFn(e))),s()(this,"castsFrom",(e=>"function"==typeof this.getFromFn(e))),s()(this,"to",((e,t,n)=>{const r=Object(i.a)(e);if(r!==this.name)throw new Error(`Can not cast object of type '${r}' using '${this.name}'`);if(!this.castsTo(t))throw new Error(`Can not cast '${r}' to '${t}'`);return this.getToFn(t)(e,n)})),s()(this,"from",((e,t)=>{const n=Object(i.a)(e);if(!this.castsFrom(n))throw new Error(`Can not cast '${this.name}' from ${n}`);return this.getFromFn(n)(e,t)}));const{name:t,help:n,deserialize:r,serialize:o,validate:a,namespace:u}=e;this.name=t,this.namespace=u,this.help=n||"",this.validate=a||(()=>{}),this.create=e.create,this.serialize=o,this.deserialize=r,this.definition=e}}},function(e,t,n){"use strict";n.d(t,"r",(function(){return T})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c.b})),n.d(t,"d",(function(){return c.a})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return x})),n.d(t,"n",(function(){return w})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return O})),n.d(t,"s",(function(){return _}));const r="boolean",s={name:r,from:{null:()=>!1,number:e=>Boolean(e),string:e=>Boolean(e)},to:{render:e=>({type:"render",as:"text",value:{text:`${e}`}}),datatable:e=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:r}}],rows:[{value:e}]})}};var i=n(3);const o="datatable",a=e=>"datatable"===(null==e?void 0:e.type),u={name:o,validate:e=>{if(!e.columns)throw new Error("datatable must have a columns array, even if it is empty");if(!e.rows)throw new Error("datatable must have a rows array, even if it is empty")},serialize:e=>{const{columns:t,rows:n}=e;return{...e,rows:n.map((e=>t.map((t=>e[t.name]))))}},deserialize:e=>{const{columns:t,rows:n}=e;return{...e,rows:n.map((e=>Object(i.zipObject)(Object(i.map)(t,"name"),e)))}},from:{null:()=>({type:o,meta:{},rows:[],columns:[]}),pointseries:e=>({type:o,meta:{},rows:e.rows,columns:Object(i.map)(e.columns,((e,t)=>({id:t,name:e.expression,meta:{type:e.type}})))})},to:{render:e=>({type:"render",as:"table",value:{datatable:e,paginate:!0,perPage:10,showHeader:!0}}),pointseries:e=>{const t=["x","y","color","size","text"],n=e.columns.filter((e=>t.includes(e.id))),r=e.rows.map((e=>Object(i.pick)(e,t)));return{type:"pointseries",columns:n.reduce(((e,t)=>(e[t.name]={type:t.meta.type,expression:t.name,role:"dimension"},e)),{}),rows:r}}}};var c=n(11);const l={name:"filter",from:{null:()=>({type:"filter",filterType:"filter",meta:{},and:[]})}},d={name:"image",to:{render:e=>({type:"render",as:"image",value:e})}},p={name:"null",from:{"*":()=>null}};var f=n(2);const h={name:"num",from:{null:()=>({type:"num",value:0}),boolean:e=>({type:"num",value:Number(e)}),string:e=>{const t=Number(e);if(Number.isNaN(t))throw new Error(f.i18n.translate("expressions.types.number.fromStringConversionErrorMessage",{defaultMessage:'Can\'t typecast "{string}" string to number',values:{string:e}}));return{type:"num",value:t}},"*":e=>({type:"num",value:Number(e)})},to:{render:({value:e})=>({type:"render",as:"text",value:{text:`${e}`}}),datatable:({value:e})=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"number"}}],rows:[{value:e}]})}},m={name:"number",from:{null:()=>0,boolean:e=>Number(e),string:e=>{const t=Number(e);if(Number.isNaN(t))throw new Error(f.i18n.translate("expressions.types.number.fromStringConversionErrorMessage",{defaultMessage:'Can\'t typecast "{string}" string to number',values:{string:e}}));return t}},to:{render:e=>({type:"render",as:"text",value:{text:`${e}`}}),datatable:e=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"number"}}],rows:[{value:e}]})}},g="pointseries",v={X:"x",Y:"y",COLOR:"color",SIZE:"size",TEXT:"text"},b={name:g,from:{null:()=>({type:g,rows:[],columns:{}})},to:{render:(e,t)=>({type:"render",as:"table",value:{datatable:t.datatable.from(e,t),showHeader:!0}})}},x={name:"range",from:{null:()=>({type:"range",from:0,to:0})},to:{render:e=>({type:"render",as:"text",value:{text:(null==e?void 0:e.label)||`from ${e.from} to ${e.to}`}})}},y="render",w={name:y,from:{"*":e=>({type:y,as:"debug",value:e})}},E={name:"shape",to:{render:e=>({type:"render",as:"shape",value:e})}},j={name:"string",from:{null:()=>"",boolean:e=>String(e),number:e=>String(e)},to:{render:e=>({type:"render",as:"text",value:{text:e}}),datatable:e=>({type:"datatable",columns:[{id:"value",name:"value",meta:{type:"string"}}],rows:[{value:e}]})}},O={name:"style",from:{null:()=>({type:"style",spec:{},css:""})}};function C(e){return null==e?"null":Array.isArray(e)?e.length?C(e[0]):"unknown":["boolean","number","object","string"].includes(typeof e)?typeof e:"unknown"}const _={name:"ui_setting",to:{boolean:({value:e})=>Boolean(e),number:({value:e})=>Number(e),string:({value:e})=>String(null!=e?e:""),render:({value:e})=>({type:"render",as:"text",value:{text:"object"==typeof e&&null!==e?JSON.stringify(e):String(null!=e?e:"")}}),datatable:({key:e,value:t})=>({type:"datatable",columns:[{id:e,name:e,meta:{type:C(t)}}],rows:(Array.isArray(t)?t:[t]).map((t=>({[e]:t})))})}},T=[s,u,c.a,l,d,p,h,m,b,x,w,E,j,O,_]},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/common/state_containers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";var r,s="object"==typeof Reflect?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function s(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",s),n([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,s)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var s,i,o,a;if(c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]),void 0===o)o=i[t]=n,++e._eventsCount;else if("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(s=l(e))>0&&o.length>s&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,a=u,console&&console.warn&&console.warn(a)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=p.bind(r);return s.listener=n,r.wrapFn=s,s}function h(e,t,n){var r=e._events;if(void 0===r)return[];var s=r[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):g(s,s.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(i){r.once&&e.removeEventListener(t,s),n(i)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var c=u.length,l=g(u,c);for(n=0;n<c;++n)i(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,s,i,o;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){o=n[i].listener,s=i;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(s=i[r])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n(5);var r=n(13),s=n(8),i={name:"d16ppa",styles:"z-index:auto;flex:1;display:flex;flex-direction:column;height:100%;min-height:$euiSizeL+2px;position:relative;justify-content:center;align-items:center"};const o=e=>Object(s.jsx)(r.EuiPanel,{css:i,role:"figure",paddingSize:"none",hasShadow:e.showShadow,hasBorder:e.showBorder,"data-test-subj":e.dataTestSubj},Object(s.jsx)(r.EuiLoadingChart,{size:"l",mono:!0}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),s=n(41);t.default=function(e,t){var n=s.useFirstMountState();r.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var r=n(2);function s(e,t){return(t||[]).map((t=>null==e[t]?"":String(e[t]))).join("|")}function i(e,t,n,s,i={allowColumnOverwrite:!1}){if(!i.allowColumnOverwrite&&e.columns.some((e=>e.id===t)))throw new Error(r.i18n.translate("expressions.functions.seriesCalculations.columnConflictMessage",{defaultMessage:"Specified outputColumnId {columnId} already exists. Please pick another column id.",values:{columnId:t}}));const o=e.columns.find((e=>e.id===n));if(!o)return;const a={...o,id:t,name:s||t},u=[...e.columns],c=n===t?0:1,l=n===t?1:0;return u.splice(u.indexOf(o)+c,l,a),u}},function(e,t,n){"use strict";var r,s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function o(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function a(e,t){for(var n={},r=[],s=0;s<e.length;s++){var a=e[s],u=t.base?a[0]+t.base:a[0],c=n[u]||0,l="".concat(u," ").concat(c);n[u]=c+1;var d=o(l),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:l,updater:m(p,t),references:1}),r.push(l)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=s(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,l=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,r){var s=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(t,s);else{var i=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,n){var r=n.css,s=n.media,i=n.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,h=0;function m(e,t){var n,r,s;if(t.singleton){var i=h++;n=f||(f=u(t)),r=d.bind(null,n,i,!1),s=d.bind(null,n,i,!0)}else n=u(t),r=p.bind(null,n,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var s=o(n[r]);i[s].references--}for(var u=a(e,t),c=0;c<n.length;c++){var l=o(n[c]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}n=u}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,r,s,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var a=(n=o,r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(s," */")),u=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(u).concat([a]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(r)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(s[o]=!0)}for(var a=0;a<e.length;a++){var u=[].concat(e[a]);r&&s[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){"use strict";function r(e){return"object"==typeof(null==e?void 0:e.node)}function s(e){return"object"==typeof e&&"expression"===(null==e?void 0:e.type)}function i(e,t,n,r){var s=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(s,i.prototype),s.expected=t,s.found=n,s.location=r,s.name="SyntaxError",s}function o(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}n.r(t),n.d(t,"fromExpression",(function(){return u})),n.d(t,"isAst",(function(){return s})),n.d(t,"isAstWithMeta",(function(){return r})),n.d(t,"toExpression",(function(){return v})),n.d(t,"safeElementFromExpression",(function(){return c})),n.d(t,"Fn",(function(){return x})),n.d(t,"getType",(function(){return l})),n.d(t,"castProvider",(function(){return y})),n.d(t,"parse",(function(){return a})),n.d(t,"getByAlias",(function(){return w})),n.d(t,"Registry",(function(){return registry_Registry})),n.d(t,"addRegistries",(function(){return O})),n.d(t,"register",(function(){return C})),n.d(t,"registryFactory",(function(){return _})),function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(i,Error),i.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,i=this.location.source+":"+s.line+":"+s.column;if(r){var a=this.location.end,u=o("",s.line.toString().length),c=r[s.line-1],l=s.line===a.line?a.column:c.length+1;t+="\n --\x3e "+i+"\n"+u+" |\n"+s.line+" | "+c+"\n"+u+" | "+o("",s.column-1)+o("",l-s.column,"^")}else t+="\n at "+i}return t},i.buildMessage=function(e,t){var n={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function o(e){return n[e.type](e)}return"Expected "+function(e){var t,n,r=e.map(o);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."};const a=function(e,t){var n,r={},s=(t=void 0!==t?t:{}).grammarSource,o={expression:ye,argument:je},a=ye,u="|",c="=",l="$",d="{",p="}",f='"',h="'",m="//",g="/*",v="*/",b="\\",x=/^[a-zA-Z0-9_\-]/,y=/^[ \t\r\n]/,w=/^[^\n]/,E=/^["'(){}<>[\]$`|= \t\n\r]/,j=/^[^"'(){}<>[\]$`|= \t\n\r]/,O=/^[^"]/,C=/^[^']/,_=he("|",!1),T=ge("function"),S=he("=",!1),A=he("$",!1),M=he("{",!1),R=he("}",!1),F=me([["a","z"],["A","Z"],["0","9"],"_","-"],!1,!1),N=ge("literal"),k=he('"',!1),L=he("'",!1),$=me([" ","\t","\r","\n"],!1,!1),I=he("//",!1),H=me(["\n"],!0,!1),P=he("/*",!1),q=he("*/",!1),z={type:"any"},D=he("\\",!1),U=me(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],!1,!1),B=me(['"',"'","(",")","{","}","<",">","[","]","$","`","|","="," ","\t","\n","\r"],!0,!1),G=me(['"'],!0,!1),V=me(["'"],!0,!1),W=function(e,t){return t},Y=function(e,t){return Re({type:"expression",chain:e?[e].concat(t):[]},pe(),fe())},J=function(e,t){return Re({type:"function",function:e,arguments:t},pe(),fe())},K=function(e,t){return{name:e,value:t}},X=function(e){return{name:"_",value:e}},Z=function(e){return e},Q=function(e){return Re(e,pe(),fe())},ee=function(e){return e},te=function(e){return e.reduce(((e,{name:t,value:n})=>({...e,[t]:(e[t]||[]).concat(n)})),{})},ne=function(e){return e.join("")},re=function(e){return e.join("")},se=function(e){var t=e.join("");return"null"===t?null:"true"===t||"false"!==t&&(isNaN(Number(t))?t:Number(t))},ie=function(e){return e},oe=0,ae=0,ue=[{line:1,column:1}],ce=0,le=[],de=0;if("startRule"in t){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=o[t.startRule]}function pe(){return e.substring(ae,oe)}function fe(){return be(ae,oe)}function he(e,t){return{type:"literal",text:e,ignoreCase:t}}function me(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function ge(e){return{type:"other",description:e}}function ve(t){var n,r=ue[t];if(r)return r;for(n=t-1;!ue[n];)n--;for(r={line:(r=ue[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return ue[t]=r,r}function be(e,t){var n=ve(e),r=ve(t);return{source:s,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function xe(e){oe<ce||(oe>ce&&(ce=oe,le=[]),le.push(e))}function ye(){var t,n,s,i,o,a;for(t=oe,Ce(),(n=we())===r&&(n=null),s=[],i=oe,124===e.charCodeAt(oe)?(o=u,oe++):(o=r,0===de&&xe(_)),o!==r?(Ce(),(a=we())!==r?(ae=i,i=W(n,a)):(oe=i,i=r)):(oe=i,i=r);i!==r;)s.push(i),i=oe,124===e.charCodeAt(oe)?(o=u,oe++):(o=r,0===de&&xe(_)),o!==r?(Ce(),(a=we())!==r?(ae=i,i=W(n,a)):(oe=i,i=r)):(oe=i,i=r);return ae=t,Y(n,s)}function we(){var e,t,n;return de++,e=oe,(t=Oe())!==r?(n=function(){var e,t,n,s;for(e=oe,t=[],n=oe,Ce()!==r&&(s=Ee())!==r?(ae=n,n=ee(s)):(oe=n,n=r);n!==r;)t.push(n),n=oe,Ce()!==r&&(s=Ee())!==r?(ae=n,n=ee(s)):(oe=n,n=r);return(n=Ce())===r&&(n=null),ae=e,e=te(t)}(),ae=e,e=J(t,n)):(oe=e,e=r),de--,e===r&&(t=r,0===de&&xe(T)),e}function Ee(){var t,n,s,i;return t=oe,(n=Oe())!==r?(Ce(),61===e.charCodeAt(oe)?(s=c,oe++):(s=r,0===de&&xe(S)),s!==r?(Ce(),(i=je())!==r?(ae=t,t=K(n,i)):(oe=t,t=r)):(oe=t,t=r)):(oe=t,t=r),t===r&&(t=oe,(n=je())!==r&&(ae=t,n=X(n)),t=n),t}function je(){var t,n,s,i,o;return t=oe,36===e.charCodeAt(oe)?(n=l,oe++):(n=r,0===de&&xe(A)),n===r&&(n=null),123===e.charCodeAt(oe)?(s=d,oe++):(s=r,0===de&&xe(M)),s!==r&&(i=ye())!==r?(125===e.charCodeAt(oe)?(o=p,oe++):(o=r,0===de&&xe(R)),o!==r?(ae=t,t=Z(i)):(oe=t,t=r)):(oe=t,t=r),t===r&&(t=oe,n=function(){var t;return de++,t=function(){var t,n,s,i;if(t=oe,34===e.charCodeAt(oe)?(n=f,oe++):(n=r,0===de&&xe(k)),n!==r){for(s=[],i=Ae();i!==r;)s.push(i),i=Ae();34===e.charCodeAt(oe)?(i=f,oe++):(i=r,0===de&&xe(k)),i!==r?(ae=t,t=re(s)):(oe=t,t=r)}else oe=t,t=r;if(t===r)if(t=oe,39===e.charCodeAt(oe)?(n=h,oe++):(n=r,0===de&&xe(L)),n!==r){for(s=[],i=Me();i!==r;)s.push(i),i=Me();39===e.charCodeAt(oe)?(i=h,oe++):(i=r,0===de&&xe(L)),i!==r?(ae=t,t=re(s)):(oe=t,t=r)}else oe=t,t=r;return t}(),t===r&&(t=function(){var e,t,n,s;if(e=oe,t=oe,de++,n=Te(),de--,n===r?t=void 0:(oe=t,t=r),t!==r){if(n=[],(s=Se())!==r)for(;s!==r;)n.push(s),s=Se();else n=r;n!==r?(ae=e,e=se(n)):(oe=e,e=r)}else oe=e,e=r;return e}()),de--,t===r&&0===de&&xe(N),t}(),n!==r&&(ae=t,n=Q(n)),t=n),t}function Oe(){var t,n,s;if(t=oe,n=[],x.test(e.charAt(oe))?(s=e.charAt(oe),oe++):(s=r,0===de&&xe(F)),s!==r)for(;s!==r;)n.push(s),x.test(e.charAt(oe))?(s=e.charAt(oe),oe++):(s=r,0===de&&xe(F));else n=r;return n!==r&&(ae=t,n=ne(n)),n}function Ce(){var e,t;if(e=[],(t=_e())===r&&(t=Te()),t!==r)for(;t!==r;)e.push(t),(t=_e())===r&&(t=Te());else e=r;return e}function _e(){var t;return y.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=r,0===de&&xe($)),t}function Te(){var t;return(t=function(){var t,n,s,i;if(t=oe,e.substr(oe,2)===m?(n=m,oe+=2):(n=r,0===de&&xe(I)),n!==r){for(s=[],w.test(e.charAt(oe))?(i=e.charAt(oe),oe++):(i=r,0===de&&xe(H));i!==r;)s.push(i),w.test(e.charAt(oe))?(i=e.charAt(oe),oe++):(i=r,0===de&&xe(H));t=n=[n,s]}else oe=t,t=r;return t}())===r&&(t=function(){var t,n,s,i,o,a;if(t=oe,e.substr(oe,2)===g?(n=g,oe+=2):(n=r,0===de&&xe(P)),n!==r){for(s=[],i=oe,o=oe,de++,e.substr(oe,2)===v?(a=v,oe+=2):(a=r,0===de&&xe(q)),de--,a===r?o=void 0:(oe=o,o=r),o!==r?(e.length>oe?(a=e.charAt(oe),oe++):(a=r,0===de&&xe(z)),a!==r?i=o=[o,a]:(oe=i,i=r)):(oe=i,i=r);i!==r;)s.push(i),i=oe,o=oe,de++,e.substr(oe,2)===v?(a=v,oe+=2):(a=r,0===de&&xe(q)),de--,a===r?o=void 0:(oe=o,o=r),o!==r?(e.length>oe?(a=e.charAt(oe),oe++):(a=r,0===de&&xe(z)),a!==r?i=o=[o,a]:(oe=i,i=r)):(oe=i,i=r);e.substr(oe,2)===v?(i=v,oe+=2):(i=r,0===de&&xe(q)),i===r&&(i=null),t=n=[n,s,i]}else oe=t,t=r;return t}()),t}function Se(){var t,n,s;return t=oe,92===e.charCodeAt(oe)?(n=b,oe++):(n=r,0===de&&xe(D)),n!==r?(E.test(e.charAt(oe))?(s=e.charAt(oe),oe++):(s=r,0===de&&xe(U)),s===r&&(92===e.charCodeAt(oe)?(s=b,oe++):(s=r,0===de&&xe(D))),s!==r?(ae=t,t=ie(s)):(oe=t,t=r)):(oe=t,t=r),t===r&&(j.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=r,0===de&&xe(B))),t}function Ae(){var t,n,s;return t=oe,92===e.charCodeAt(oe)?(n=b,oe++):(n=r,0===de&&xe(D)),n!==r?(34===e.charCodeAt(oe)?(s=f,oe++):(s=r,0===de&&xe(k)),s===r&&(92===e.charCodeAt(oe)?(s=b,oe++):(s=r,0===de&&xe(D))),s!==r?(ae=t,t=ie(s)):(oe=t,t=r)):(oe=t,t=r),t===r&&(O.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=r,0===de&&xe(G))),t}function Me(){var t,n,s;return t=oe,92===e.charCodeAt(oe)?(n=b,oe++):(n=r,0===de&&xe(D)),n!==r?(39===e.charCodeAt(oe)?(s=h,oe++):(s=r,0===de&&xe(L)),s===r&&(92===e.charCodeAt(oe)?(s=b,oe++):(s=r,0===de&&xe(D))),s!==r?(ae=t,t=ie(s)):(oe=t,t=r)):(oe=t,t=r),t===r&&(C.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=r,0===de&&xe(V))),t}function Re(e,n,{start:{offset:r},end:{offset:s}}){return t.addMeta?{node:e,text:n,start:r,end:s}:e}if((n=a())!==r&&oe===e.length)return n;throw n!==r&&oe<e.length&&xe({type:"end"}),function(e,t,n){return new i(i.buildMessage(e,t),e,t,n)}(le,ce<e.length?e.charAt(ce):null,ce<e.length?be(ce,ce+1):be(ce,ce))};function u(e,t="expression"){try{return a(String(e),{startRule:t})}catch(e){throw new Error(`Unable to parse expression: ${e.message}`)}}function c(e){try{return u(e)}catch(e){return u("markdown\n\"## Crud.\nCanvas could not parse this element's expression. I am so sorry this error isn't more useful. I promise it will be soon.\n\nThanks for understanding,\n#### Management\n\"")}}function l(e){if(null==e)return"null";if("object"==typeof e){if(!e.type)throw new Error("Objects must have a type property");return e.type}return typeof e}var d=n(3);function p(e,t){let n="",i=0;return function(e,t){const n=[[a(e,{addMeta:!0}),t]],i=[];function o(e,t){Object(d.zip)(e.node.chain,t.chain).forEach((([e,t])=>{if(!e||!t||(null==e?void 0:e.node.function)!==(null==t?void 0:t.function))throw Error("Expression changes are not supported.");!function(e,t){if(Object(d.xor)(Object.keys(e.node.arguments),Object.keys(t.arguments)).length)throw Error("Function changes are not supported.");Object(d.forEach)(e.node.arguments,((e,n)=>{!function(e,t){if(e.length!==t.length)throw Error("Arguments changes are not supported.");Object(d.zip)(e,t).forEach((([e,t])=>function(e,t){r(e)&&s(t)?o(e,t):e.node!==t&&i.push({type:"value",source:e,target:t})}(e,t)))}(e,t.arguments[n])}))}(e,t)}))}for(;n.length;)o(...n.shift());return i}(e,t).sort((({source:e},{source:t})=>e.start-t.start)).forEach((function(t){var s;if("value"!==(null==(s=t)?void 0:s.type))throw new Error("Cannot apply patch for the change.");!function(t){if(r(t.source))throw new Error("Patching sub-expressions is not supported.");n+=`${e.substring(i,t.source.start)}${v(t.target,"argument")}`,i=t.source.end}(t)})),n+=e.substring(i),n}function f(e,t,n=0){const r=l(e);function s(e,t){return null==e||"_"===e?t:`${e}=${t}`}if("string"===r)return s(t,`"${e.replace(/[\\"]/g,"\\$&")}"`);if("boolean"===r||"null"===r||"number"===r)return s(t,`${e}`);if("expression"===r)return s(t,`{${g(e.chain,n+1)}}`);throw new Error(`Invalid argument type in AST: ${r}`)}function h({arguments:e},t=0){if(null==e||"object"!=typeof e||Array.isArray(e))throw new Error("Arguments can only be an object");return Object.keys(e).map((n=>e[n].reduce(((e,r)=>{const s=f(r,n,t),i=e.split("\n").pop().length;return 0===t&&i+s.length>80?`${e}\n  ${s}`:i>0?`${e} ${s}`:s}),"")))}function m(e,t){var n;return`${e} ${null!==(n=null==t?void 0:t.join(" "))&&void 0!==n?n:""}`.trim()}function g(e,t=0){if(!e)throw new Error("Expressions must contain a chain");const n=t>0?" | ":"\n| ";return e.map((e=>{if("function"!==l(e))return;const{function:n}=e;if(!n)throw new Error("Functions must have a function name");return m(n,h(e,t))})).join(n)}function v(e,t="expression"){const{type:n,source:r}="string"==typeof t?{type:t}:t;if(r&&s(e))return p(r,e);if("argument"===n)return f(e);const i=l(e);if("expression"===i){const{chain:t}=e;if(!Array.isArray(t))throw new Error("Expressions must contain a chain");return g(t)}if("function"===i){const{function:t}=e;return m(t,h(e))}throw new Error("Expression must be an expression or argument function")}function b(e){if("_"===e.name)throw Error("Arg names must not be _. Use it in aliases instead.");this.name=e.name,this.required=e.required||!1,this.help=e.help||"",this.types=e.types||[],this.default=e.default,this.aliases=e.aliases||[],this.multi=null!=e.multi&&e.multi,this.resolve=null==e.resolve||e.resolve,this.options=e.options||[],this.accepts=t=>!this.types.length||Object(d.includes)(e.types,t)}function x(e){this.name=e.name,this.type=e.type,this.aliases=e.aliases||[],this.fn=(...t)=>Promise.resolve(e.fn(...t)),this.help=e.help||"",this.args=Object(d.mapValues)(e.args||{},((e,t)=>new b({name:t,...e}))),this.context=e.context||{},this.accepts=e=>!this.context.types||Object(d.includes)(this.context.types,e)}function y(e){return function(t,n){if(!n||0===n.length)return t;const r=l(t);if(n.includes(r))return t;const s=e[r];for(let i=0;i<n.length;i++){if(s&&s.castsTo(n[i]))return s.to(t,n[i],e);const o=e[n[i]];if(o&&o.castsFrom(r))return o.from(t,e)}throw new Error(`Can not cast '${r}' to any of '${n.join(", ")}'`)}}function w(e,t){const n=t.toLowerCase();return Object.values(e).find((({name:e,aliases:t})=>e.toLowerCase()===n||(t||[]).some((e=>e.toLowerCase()===n))))}var E=n(0),j=n.n(E);class registry_Registry{constructor(e="name"){if(j()(this,"_prop",void 0),j()(this,"_indexed",void 0),"string"!=typeof e)throw new Error("Registry property name must be a string");this._prop=e,this._indexed=new Object}wrapper(e){return e}register(e){const t="function"==typeof e?e():e;if("object"!=typeof t||!t[this._prop])throw new Error(`Registered functions must return an object with a ${this._prop} property`);this._indexed[t[this._prop].toLowerCase()]=this.wrapper(t)}toJS(){return Object.keys(this._indexed).reduce(((e,t)=>(e[t]=this.get(t),e)),{})}toArray(){return Object.keys(this._indexed).map((e=>this.get(e)))}get(e){if(void 0===e)return null;const t=e.toLowerCase();return this._indexed[t]?Object(d.clone)(this._indexed[t]):null}getProp(){return this._prop}reset(){this._indexed=new Object}}function O(e,t){return Object.keys(t).forEach((n=>{if(e[n])throw new Error(`There is already a registry named "${n}".`);e[n]=t[n]})),e}function C(e,t){return Object.keys(t).forEach((n=>{if(!e[n])throw new Error(`There is no registry named "${n}".`);if(!e[n].register)throw new Error(`Registry "${n}" must have a register function.`);t[n].forEach((t=>e[n].register(t)))})),e}function _(e){return{registries:()=>e,register:t=>C(e,t)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"ReactExpressionRenderer",(function(){return w})),n.d(t,"useExpressionRenderer",(function(){return x}));var r=n(29),s=n.n(r),i=n(5),o=n(30),a=n.n(o),u=n(18),c=n(13),l=n(1),d=n(19),p=n.n(d),f=n(7),h=n(31),m=n(3),g=n(32),v=n.n(g);function b(e){const t=Object(i.useRef)(e);return v()(t.current,e)||(t.current=e),t.current}function x(e,{debounce:t,expression:n,hasCustomErrorRenderer:r,onData$:s,onEvent:o,onRender$:a,reload$:u,abortController:c,...d}){const[{error:g,isEmpty:v,isLoading:x},y]=Object(i.useReducer)(((e,t)=>({...e,...t})),{isEmpty:!0,isLoading:!1,error:null}),w=b({expression:n,params:b(d)}),[{expression:E,params:j},O]=function(e,t){const[n,r]=Object(i.useState)(e),[s,o]=Object(i.useState)(!1),a=Object(i.useCallback)((e=>{r(e),o(!1)}),[r,o]),u=Object(i.useMemo)((()=>t?Object(m.debounce)(a,t):a),[a,t]);return Object(i.useEffect)((()=>()=>{var e;return null===(e=u.cancel)||void 0===e?void 0:e.call(u)}),[u]),p()((()=>(o(!0),u(e),()=>{var e;return null===(e=u.cancel)||void 0===e?void 0:e.call(u)})),[e]),[n,s]}(w,t),C=Object(i.useRef)(null),_=Object(i.useRef)(!1),T=Object(i.useRef)(null);return Object(i.useEffect)((()=>{null!=c&&c.signal&&(c.signal.onabort=()=>{var e;null===(e=C.current)||void 0===e||e.cancel()})}),[c]),Object(i.useEffect)((()=>{var t;C.current=e.current&&new h.ExpressionLoader(e.current,E,{...j,onRenderError:(e,t,n)=>{var r;return T.current=n,y({error:t,isEmpty:!1,isLoading:!1}),null===(r=j.onRenderError)||void 0===r?void 0:r.call(j,e,t,n)}});const n=null===(t=C.current)||void 0===t?void 0:t.loading$.subscribe((()=>{_.current=!1,y({isLoading:!0})}));return()=>{var e;null==n||n.unsubscribe(),null===(e=C.current)||void 0===e||e.destroy(),C.current=null,T.current=null}}),[j.onRenderError,j.interactive,j.renderMode,j.syncColors,j.syncTooltips,j.syncCursor]),Object(i.useEffect)((()=>{var e;const t=o&&(null===(e=C.current)||void 0===e?void 0:e.events$.subscribe(o));return()=>null==t?void 0:t.unsubscribe()}),[C.current,o]),Object(i.useEffect)((()=>{var e;const t=null===(e=C.current)||void 0===e?void 0:e.data$.subscribe((({partial:e,result:t})=>{var n;y({isEmpty:!1,...Object(f.isExpressionValueError)(t)?{}:{error:null}}),null==s||s(t,null===(n=C.current)||void 0===n?void 0:n.inspect(),e)}));return()=>null==t?void 0:t.unsubscribe()}),[C.current,s]),Object(i.useEffect)((()=>{var e;const t=null===(e=C.current)||void 0===e?void 0:e.render$.pipe(Object(l.filter)((()=>!_.current))).subscribe((e=>{y({error:null,isEmpty:!1,isLoading:!1}),null==a||a(e)}));return()=>{null==t||t.unsubscribe()}}),[C.current,a]),Object(i.useEffect)((()=>{const e=null==u?void 0:u.subscribe((()=>{var e;null===(e=C.current)||void 0===e||e.update(E,j)}));return()=>null==e?void 0:e.unsubscribe()}),[u,E,j]),p()((()=>{var e;null===(e=C.current)||void 0===e||e.update(E,j)}),[E,j]),Object(i.useLayoutEffect)((()=>{var e;g&&r&&(_.current=!0,null===(e=T.current)||void 0===e||e.done()),T.current=null}),[g,r]),{error:g,isEmpty:v,isLoading:x||O}}var y=n(8);function w({className:e,dataAttrs:t,padding:n,renderError:r,abortController:o,...l}){const d=Object(i.useRef)(null),{euiTheme:p}=Object(c.useEuiTheme)(),{error:f,isEmpty:h,isLoading:m}=x(d,{...l,hasCustomErrorRenderer:!!r}),g=a()("expExpressionRenderer",e,{"expExpressionRenderer-isEmpty":h,"expExpressionRenderer-hasError":!!f}),v={};return n&&(v.padding=p.size[n]),Object(y.jsx)("div",s()({},t,{className:g}),h&&Object(y.jsx)(u.a,null),m&&Object(y.jsx)(c.EuiProgress,{size:"xs",color:"accent",position:"absolute",style:{zIndex:1}}),!m&&f&&(null==r?void 0:r(f.message,f)),Object(y.jsx)("div",{className:"expExpressionRenderer__expression",style:v,ref:d}))}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/inspector/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(25)(4)},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t,n){"use strict";n.r(t),n.d(t,"ExpressionLoader",(function(){return ExpressionLoader})),n.d(t,"loader",(function(){return c}));var r=n(0),s=n.n(r),i=n(1),o=n(3),a=n(33),u=n(9);class ExpressionLoader{constructor(e,t,n){s()(this,"data$",void 0),s()(this,"update$",void 0),s()(this,"render$",void 0),s()(this,"events$",void 0),s()(this,"loading$",void 0),s()(this,"execution",void 0),s()(this,"renderHandler",void 0),s()(this,"dataSubject",void 0),s()(this,"loadingSubject",void 0),s()(this,"data",void 0),s()(this,"params",{}),s()(this,"subscription",void 0),s()(this,"loadData",((e,t)=>{var n;null===(n=this.subscription)||void 0===n||n.unsubscribe(),this.execution&&this.execution.isPending&&this.execution.cancel(),this.setParams(t),this.execution=Object(u.b)().execute(e,t.context,{searchContext:t.searchContext,variables:t.variables||{},inspectorAdapters:t.inspectorAdapters,searchSessionId:t.searchSessionId,debug:t.debug,syncColors:t.syncColors,syncCursor:null==t?void 0:t.syncCursor,syncTooltips:t.syncTooltips,executionContext:t.executionContext,partial:t.partial,throttle:t.throttle,allowCache:t.allowCache}),this.subscription=this.execution.getData().pipe(Object(i.delay)(0)).subscribe((e=>this.dataSubject.next(e)))})),this.dataSubject=new i.Subject,this.data$=this.dataSubject.asObservable(),this.loadingSubject=new i.BehaviorSubject(!1),this.loading$=this.loadingSubject.asObservable().pipe(Object(i.shareReplay)(1),Object(i.filter)((e=>!0===e)),Object(i.map)((()=>{}))),this.renderHandler=new a.ExpressionRenderHandler(e,{interactive:null==n?void 0:n.interactive,onRenderError:n&&n.onRenderError,renderMode:null==n?void 0:n.renderMode,syncColors:null==n?void 0:n.syncColors,syncTooltips:null==n?void 0:n.syncTooltips,syncCursor:null==n?void 0:n.syncCursor,hasCompatibleActions:null==n?void 0:n.hasCompatibleActions,getCompatibleCellValueActions:null==n?void 0:n.getCompatibleCellValueActions,executionContext:null==n?void 0:n.executionContext}),this.render$=this.renderHandler.render$,this.update$=this.renderHandler.update$,this.events$=this.renderHandler.events$,this.update$.subscribe((e=>{if(e){const{newExpression:t,newParams:n}=e;this.update(t,n)}})),this.data$.subscribe((({result:e})=>{this.render(e)})),this.render$.subscribe((()=>{this.loadingSubject.next(!1)})),this.setParams(n),t&&(this.loadingSubject.next(!0),this.loadData(t,this.params))}destroy(){var e;this.dataSubject.complete(),this.loadingSubject.complete(),this.renderHandler.destroy(),this.cancel(),null===(e=this.subscription)||void 0===e||e.unsubscribe()}cancel(){var e;null===(e=this.execution)||void 0===e||e.cancel()}getExpression(){var e;return null===(e=this.execution)||void 0===e?void 0:e.getExpression()}getAst(){var e;return null===(e=this.execution)||void 0===e?void 0:e.getAst()}getElement(){return this.renderHandler.getElement()}inspect(){var e;return null===(e=this.execution)||void 0===e?void 0:e.inspect()}update(e,t){this.setParams(t),this.loadingSubject.next(!0),e?this.loadData(e,this.params):this.data&&this.render(this.data)}render(e){this.renderHandler.render(e,this.params.uiState)}setParams(e){var t,n;e&&Object.keys(e).length&&(e.searchContext&&(this.params.searchContext=Object(o.defaults)({},e.searchContext,this.params.searchContext||{})),e.uiState&&this.params&&(this.params.uiState=e.uiState),e.variables&&this.params&&(this.params.variables=e.variables),e.searchSessionId&&this.params&&(this.params.searchSessionId=e.searchSessionId),this.params.syncColors=e.syncColors,this.params.syncCursor=e.syncCursor,this.params.syncTooltips=e.syncTooltips,this.params.debug=Boolean(e.debug),this.params.partial=Boolean(e.partial),this.params.throttle=Number(null!==(t=e.throttle)&&void 0!==t?t:1e3),this.params.allowCache=e.allowCache,this.params.inspectorAdapters=e.inspectorAdapters||(null===(n=this.execution)||void 0===n?void 0:n.inspect()),this.params.executionContext=e.executionContext)}}const c=async(e,t,n)=>new ExpressionLoader(e,t,n)},function(e,t,n){"use strict";function r(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}t.__esModule=!0,t.default=function(e,t){if(r(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!r(e[n[i]],t[n[i]]))return!1;return!0}},function(e,t,n){"use strict";n.r(t),n.d(t,"ExpressionRenderHandler",(function(){return render_ExpressionRenderHandler})),n.d(t,"render",(function(){return l}));var r=n(0),s=n.n(r),i=n(1),o=n(3),a=n(2),u=n(9);const c=(e,t,n)=>{"AbortError"!==t.name?(Object(u.c)().toasts.addError(t,{title:a.i18n.translate("expressions.defaultErrorRenderer.errorTitle",{defaultMessage:"Error in visualisation"}),toastMessage:t.message}),n.done()):n.done()};class render_ExpressionRenderHandler{constructor(e,{onRenderError:t,renderMode:n,syncColors:r,syncTooltips:a,syncCursor:l,interactive:d,hasCompatibleActions:p=(async()=>!1),getCompatibleCellValueActions:f=(async()=>[]),executionContext:h}={}){s()(this,"render$",void 0),s()(this,"update$",void 0),s()(this,"events$",void 0),s()(this,"element",void 0),s()(this,"destroyFn",void 0),s()(this,"renderCount",0),s()(this,"renderSubject",void 0),s()(this,"eventsSubject",void 0),s()(this,"updateSubject",void 0),s()(this,"handlers",void 0),s()(this,"onRenderError",void 0),s()(this,"render",(async(e,t)=>{if(!e||"object"!=typeof e)return this.handleRenderError(new Error("invalid data provided to the expression renderer"));if("render"!==e.type||!e.as)return"error"===e.type?this.handleRenderError(e.error):this.handleRenderError(new Error("invalid data provided to the expression renderer"));if(!Object(u.d)().get(e.as))return this.handleRenderError(new Error(`invalid renderer id '${e.as}'`));try{await Object(u.d)().get(e.as).render(this.element,e.value,{...this.handlers,uiState:t})}catch(e){return this.handleRenderError(e)}})),s()(this,"destroy",(()=>{this.renderSubject.complete(),this.eventsSubject.complete(),this.updateSubject.complete(),this.destroyFn&&this.destroyFn()})),s()(this,"getElement",(()=>this.element)),s()(this,"handleRenderError",(e=>{this.onRenderError(this.element,e,this.handlers)})),this.element=e,this.eventsSubject=new i.Subject,this.events$=this.eventsSubject.asObservable(),this.onRenderError=t||c,this.renderSubject=new i.BehaviorSubject(null),this.render$=this.renderSubject.asObservable().pipe(Object(i.filter)(o.isNumber)),this.updateSubject=new i.Subject,this.update$=this.updateSubject.asObservable(),this.handlers={onDestroy:e=>{this.destroyFn=e},done:()=>{this.renderCount++,this.renderSubject.next(this.renderCount)},reload:()=>{this.updateSubject.next(null)},getExecutionContext:()=>h,update:e=>{this.updateSubject.next(e)},event:e=>{this.eventsSubject.next(e)},getRenderMode:()=>n||"view",isSyncColorsEnabled:()=>r||!1,isSyncTooltipsEnabled:()=>a||!1,isSyncCursorEnabled:()=>l||!0,isInteractive:()=>null==d||d,hasCompatibleActions:p,getCompatibleCellValueActions:f}}}const l=async(e,t,n)=>{const r=new render_ExpressionRenderHandler(e,n);return r.render(t),r}},function(e,t,n){n(35),__kbnBundles__.define("plugin/expressions/public",n,42),__kbnBundles__.define("plugin/expressions/common",n,7),__kbnBundles__.define("plugin/expressions/common/fonts",n,6)},function(e,t,n){n.p=window.__kbnPublicPath__.expressions},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(37);case"v8light":return n(39)}},function(e,t,n){var r=n(23),s=n(38);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},function(e,t,n){(t=n(24)(!1)).push([e.i,".expExpressionRenderer{align-items:center;display:flex;height:100%;justify-content:center;position:relative;width:100%}.expExpressionRenderer__expression{height:100%;width:100%}.expExpressionRenderer-hasError .expExpressionRenderer__expression,.expExpressionRenderer-isEmpty .expExpressionRenderer__expression{display:none}",""]),e.exports=t},function(e,t,n){var r=n(23),s=n(40);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);r(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},function(e,t,n){(t=n(24)(!1)).push([e.i,".expExpressionRenderer{align-items:center;display:flex;height:100%;justify-content:center;position:relative;width:100%}.expExpressionRenderer__expression{height:100%;width:100%}.expExpressionRenderer-hasError .expExpressionRenderer__expression,.expExpressionRenderer-isEmpty .expExpressionRenderer__expression{display:none}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var r=n(5);t.useFirstMountState=function(){var e=r.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";n.r(t),n.d(t,"Plugin",(function(){return plugin_ExpressionsPublicPlugin})),n.d(t,"plugin",(function(){return h})),n.d(t,"useExpressionRenderer",(function(){return p.useExpressionRenderer})),n.d(t,"buildExpression",(function(){return f.buildExpression})),n.d(t,"buildExpressionFunction",(function(){return f.buildExpressionFunction})),n.d(t,"formatExpression",(function(){return f.formatExpression})),n.d(t,"isExpressionAstBuilder",(function(){return f.isExpressionAstBuilder})),n.d(t,"parseExpression",(function(){return f.parseExpression})),n.d(t,"createDefaultInspectorAdapters",(function(){return f.createDefaultInspectorAdapters})),n(36);var r=n(0),s=n.n(r),i=n(3),o=n(9),a=n(5),u=n(18),c=n(8);const l=Object(a.lazy)((async()=>{const{ReactExpressionRenderer:e}=await Promise.resolve().then(n.bind(null,27));return{default:e}})),d=e=>Object(c.jsx)(a.Suspense,{fallback:Object(c.jsx)(u.a,null)},Object(c.jsx)(l,e));class plugin_ExpressionsPublicPlugin{constructor(e){s()(this,"expressions",new o.a({logger:plugin_ExpressionsPublicPlugin.logger}))}setup(e){const{expressions:t}=this,{renderers:n}=t;Object(o.g)(n),Object(o.e)(t);const r=t.setup(Object(i.pick)(e,"getStartServices"));return Object.freeze(r)}start(e){Object(o.f)(e.notifications);const{expressions:t}=this,r={...t.start(),loader:async(e,t,r)=>{const{ExpressionLoader:s}=await Promise.resolve().then(n.bind(null,31));return new s(e,t,r)},render:async(e,t,r)=>{const{ExpressionRenderHandler:s}=await Promise.resolve().then(n.bind(null,33)),i=new s(e,r);return i.render(t),i},ReactExpressionRenderer:d};return Object.freeze(r)}stop(){this.expressions.stop()}}s()(plugin_ExpressionsPublicPlugin,"logger",{...console,fatal:console.error,get(){return this},isLevelEnabled:()=>!0});var p=n(27),f=n(7);function h(e){return new plugin_ExpressionsPublicPlugin(e)}}]);