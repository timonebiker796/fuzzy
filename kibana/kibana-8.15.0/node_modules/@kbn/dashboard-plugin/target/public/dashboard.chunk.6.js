(window.dashboard_bundle_jsonpfunction=window.dashboard_bundle_jsonpfunction||[]).push([[6],{107:function(e,t,o){e.exports=o(37)(296)},123:function(e,t,o){e.exports=o(37)(1616)},154:function(e,t,o){e.exports=o(37)(1613)},155:function(e,t,o){e.exports=o(37)(3446)},156:function(e,t,o){var n=o(281);e.exports=function(e){return e==e&&!n(e)}},157:function(e,t,o){e.exports=o(37)(1191)},158:function(e,t){e.exports=function(e,t){return function(o){return null!=o&&o[e]===t&&(void 0!==t||e in Object(o))}}},159:function(e,t,o){e.exports=o(37)(3498)},160:function(e,t,o){e.exports=o(37)(3540)},161:function(e,t,o){e.exports=o(37)(1196)},268:function(e,t,o){switch(window.__kbnThemeTag__){case"v8dark":return o(269);case"v8light":return o(271)}},269:function(e,t,o){var n=o(26),r=o(270);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},270:function(e,t,o){(t=o(27)(!1)).push([e.i,".dshSolutionToolbar__editorContextMenu{-webkit-mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);max-height:60vh;overflow-y:scroll;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar{height:16px;width:16px}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-corner,.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-track{background-color:#0000}",""]),e.exports=t},271:function(e,t,o){var n=o(26),r=o(272);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},272:function(e,t,o){(t=o(27)(!1)).push([e.i,".dshSolutionToolbar__editorContextMenu{-webkit-mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);mask-image:linear-gradient(180deg,#ff00001a 0,red 7.5px,red calc(100% - 7.5px),#ff00001a);max-height:60vh;overflow-y:scroll;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar{height:16px;width:16px}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-corner,.dshSolutionToolbar__editorContextMenu::-webkit-scrollbar-track{background-color:#0000}",""]),e.exports=t},273:function(e,t,o){var n=o(274),r=o(107);e.exports=function(e,t,o,i){return null==e?[]:(r(t)||(t=null==t?[]:[t]),r(o=i?void 0:o)||(o=null==o?[]:[o]),n(e,t,o))}},274:function(e,t,o){var n=o(275),r=o(154),i=o(276),s=o(294),a=o(300),l=o(301),c=o(302),d=o(160),u=o(107);e.exports=function(e,t,o){t=t.length?n(t,(function(e){return u(e)?function(t){return r(t,1===e.length?e[0]:e)}:e})):[d];var b=-1;t=n(t,l(i));var p=s(e,(function(e,o,r){return{criteria:n(t,(function(t){return t(e)})),index:++b,value:e}}));return a(p,(function(e,t){return c(e,t,o)}))}},275:function(e,t,o){e.exports=o(37)(1615)},276:function(e,t,o){var n=o(277),r=o(282),i=o(160),s=o(107),a=o(291);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?r(e[0],e[1]):n(e):a(e)}},277:function(e,t,o){var n=o(278),r=o(280),i=o(158);e.exports=function(e){var t=r(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(o){return o===e||n(o,e,t)}}},278:function(e,t,o){var n=o(279),r=o(155);e.exports=function(e,t,o,i){var s=o.length,a=s,l=!i;if(null==e)return!a;for(e=Object(e);s--;){var c=o[s];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<a;){var d=(c=o[s])[0],u=e[d],b=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var p=new n;if(i)var h=i(u,b,d,e,t,p);if(!(void 0===h?r(b,u,3,i,p):h))return!1}}return!0}},279:function(e,t,o){e.exports=o(37)(1600)},280:function(e,t,o){var n=o(156),r=o(157);e.exports=function(e){for(var t=r(e),o=t.length;o--;){var i=t[o],s=e[i];t[o]=[i,s,n(s)]}return t}},281:function(e,t,o){e.exports=o(37)(361)},282:function(e,t,o){var n=o(155),r=o(283),i=o(284),s=o(159),a=o(156),l=o(158),c=o(123);e.exports=function(e,t){return s(e)&&a(t)?l(c(e),t):function(o){var s=r(o,e);return void 0===s&&s===t?i(o,e):n(t,s,3)}}},283:function(e,t,o){e.exports=o(37)(1962)},284:function(e,t,o){var n=o(285),r=o(286);e.exports=function(e,t){return null!=e&&r(e,t,n)}},285:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},286:function(e,t,o){var n=o(287),r=o(288),i=o(107),s=o(289),a=o(290),l=o(123);e.exports=function(e,t,o){for(var c=-1,d=(t=n(t,e)).length,u=!1;++c<d;){var b=l(t[c]);if(!(u=null!=e&&o(e,b)))break;e=e[b]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&a(d)&&s(b,d)&&(i(e)||r(e))}},287:function(e,t,o){e.exports=o(37)(1197)},288:function(e,t,o){e.exports=o(37)(1608)},289:function(e,t,o){e.exports=o(37)(1609)},290:function(e,t,o){e.exports=o(37)(1611)},291:function(e,t,o){var n=o(292),r=o(293),i=o(159),s=o(123);e.exports=function(e){return i(e)?n(s(e)):r(e)}},292:function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},293:function(e,t,o){var n=o(154);e.exports=function(e){return function(t){return n(t,e)}}},294:function(e,t,o){var n=o(295),r=o(161);e.exports=function(e,t){var o=-1,i=r(e)?Array(e.length):[];return n(e,(function(e,n,r){i[++o]=t(e,n,r)})),i}},295:function(e,t,o){var n=o(296),r=o(299)(n);e.exports=r},296:function(e,t,o){var n=o(297),r=o(157);e.exports=function(e,t){return e&&n(e,t,r)}},297:function(e,t,o){var n=o(298)();e.exports=n},298:function(e,t){e.exports=function(e){return function(t,o,n){for(var r=-1,i=Object(t),s=n(t),a=s.length;a--;){var l=s[e?a:++r];if(!1===o(i[l],l,i))break}return t}}},299:function(e,t,o){var n=o(161);e.exports=function(e,t){return function(o,r){if(null==o)return o;if(!n(o))return e(o,r);for(var i=o.length,s=t?i:-1,a=Object(o);(t?s--:++s<i)&&!1!==r(a[s],s,a););return o}}},300:function(e,t){e.exports=function(e,t){var o=e.length;for(e.sort(t);o--;)e[o]=e[o].value;return e}},301:function(e,t,o){e.exports=o(37)(1193)},302:function(e,t,o){var n=o(303);e.exports=function(e,t,o){for(var r=-1,i=e.criteria,s=t.criteria,a=i.length,l=o.length;++r<a;){var c=n(i[r],s[r]);if(c)return r>=l?c:c*("desc"==o[r]?-1:1)}return e.index-t.index}},303:function(e,t,o){var n=o(304);e.exports=function(e,t){if(e!==t){var o=void 0!==e,r=null===e,i=e==e,s=n(e),a=void 0!==t,l=null===t,c=t==t,d=n(t);if(!l&&!d&&!s&&e>t||s&&a&&c&&!l&&!d||r&&a&&c||!o&&c||!i)return 1;if(!r&&!s&&!d&&e<t||d&&o&&i&&!r&&!s||l&&o&&i||!a&&i||!c)return-1}return 0}},304:function(e,t,o){e.exports=o(37)(837)},305:function(e,t,o){switch(window.__kbnThemeTag__){case"v8dark":return o(306);case"v8light":return o(308)}},306:function(e,t,o){var n=o(26),r=o(307);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},307:function(e,t,o){(t=o(27)(!1)).push([e.i,".kbnBody .dashboardTopNav{background:#141519;position:sticky;top:var(--euiFixedHeadersOffset,0);width:100%;z-index:2000}",""]),e.exports=t},308:function(e,t,o){var n=o(26),r=o(309);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},309:function(e,t,o){(t=o(27)(!1)).push([e.i,".kbnBody .dashboardTopNav{background:#fafbfd;position:sticky;top:var(--euiFixedHeadersOffset,0);width:100%;z-index:2000}",""]),e.exports=t},74:function(e,t,o){"use strict";o.r(t),o.d(t,"DashboardTopNavWithContext",(function(){return ie}));var n=o(2),r=o.n(n),i=o(87),s=o(77),a=o.n(s),l=o(35),c=o.n(l),d=o(52),u=o(0),b=o(8),p=o(5),h=o(82),g=o(24),f=o(25),v=o(60),j=o(29),m=o(18),x=o(6),y=o(54),O=o.n(y),T=o(63),w=o(3);const S="showFilterBar",M=e=>!!e.dashboard&&!!e.dashboard.show;var C=o(1),E=o(102);var I=o(59);const k=e=>({bold:e.font.weight.bold,normal:e.font.weight.regular}),P=e=>"iconButton"===e.as,B=(e,{type:t,isDisabled:o,groupPosition:n})=>{const r=(({euiTheme:e})=>({default:{borderStyle:"solid",border:e.border.thin,borderColor:e.border.color},emptyButton:{backgroundColor:e.colors.emptyShade,border:`${e.border.thin}`,color:`${e.colors.text}`},buttonPositions:{left:{borderTopRightRadius:0,borderBottomRightRadius:0},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"},center:{borderRadius:0,borderLeft:"none"}}}))(e),i=n&&"none"!==n?r.buttonPositions[n]:{},s={...r.default,...i};return o?s:{...s,..."primary"===t?{}:r.emptyButton}},D=({hasArrow:e=!0,fontWeight:t="normal",type:o,label:n,iconSide:r,iconType:i,fullWidth:s,isDisabled:l,groupPosition:c,...d})=>{const u=Object(p.useEuiTheme)(),b={...B(u,{type:o,isDisabled:l,groupPosition:c}),fontWeight:k(u.euiTheme)[t]},h=l?{}:"primary"===o?{color:"primary",fill:!0}:{color:"text"},g=null!=i?i:e?"arrowDown":"";return Object(w.jsx)(p.EuiButton,a()({size:d.size,isDisabled:l,css:b,iconType:g,iconSide:i?r:"right",fullWidth:s,contentProps:s?{style:{justifyContent:"space-between"}}:{}},h,d),n)},_=({size:e,type:t,label:o,isDisabled:n,groupPosition:r,...i})=>{const s=Object(p.useEuiTheme)(),l=B(s,{type:t,isDisabled:n,groupPosition:r});return Object(w.jsx)(p.EuiButtonIcon,a()({},i,{disabled:n,"aria-label":null!=o?o:i["aria-label"],size:e,iconSize:e,css:l,display:"primary"===t?"fill":"base",color:"primary"===t?"primary":"text"}))};function F(e){const{type:t="empty",size:o="m"}=e;return P(e)?Object(w.jsx)(_,a()({},e,{size:o,type:t})):Object(w.jsx)(D,a()({},e,{size:o,type:t}))}const z=({onClick:e,size:t="m",...o})=>Object(w.jsx)(F,a()({},o,{type:"empty",onClick:e,iconType:"folderOpen",size:t,label:u.i18n.translate("sharedUXPackages.buttonToolbar.buttons.addFromLibrary.libraryButtonLabel",{defaultMessage:"Add from library"})})),N=u.i18n.translate("sharedUXPackages.buttonToolbar.toolbar.errorToolbarText",{defaultMessage:"There are over 120 extra buttons. Please consider limiting the number of buttons."}),V=({children:e})=>{const{primaryButton:t,iconButtonGroup:o,extraButtons:n=[]}=e;if(n.length>120)throw new Error(N);const r=n.map(((e,t)=>e?Object(w.jsx)(p.EuiFlexItem,{grow:!1,key:`button-${t}`},e):null));return Object(w.jsx)(p.EuiFlexGroup,{gutterSize:"s"},Object(w.jsx)(p.EuiFlexItem,{grow:!1},t),Object(w.jsx)(p.EuiFlexItem,{grow:!1},Object(w.jsx)(p.EuiFlexGroup,{wrap:!0,responsive:!1,alignItems:"center",gutterSize:"s"},o?Object(w.jsx)(p.EuiFlexItem,{grow:!1},o):null,r)))};o(268);var L=o(49),R=o(71);const G=(e,t,o)=>n=>{o(),n.currentTarget instanceof HTMLAnchorElement?n.defaultPrevented||0!==n.button||n.currentTarget.target&&"_self"!==n.currentTarget.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),e.execute(t)):e.execute(t)};var A=o(88),U=o(273),$=o.n(U),W=o(48);const q=({close:e,getPanels:t,paddingSize:o})=>{const{euiTheme:i}=Object(p.useEuiTheme)(),s=Object(n.useRef)(t(e)),[a,l]=Object(n.useState)(""),[c,d]=Object(n.useState)(s.current);return Object(n.useEffect)((()=>{if(!a)return d(s.current);const e=a.toLowerCase();d($()(s.current.map((t=>{const o=t.title.toLowerCase().includes(e),[n,r]=t.items.reduce(((t,n)=>{const r=n.name.toLowerCase().includes(e);return t[0]=t[0]||r,t[1].push({...n,isDisabled:!(o||r)}),t}),[o,[]]);return{...t,isDisabled:!n,items:r}})),["isDisabled"]))}),[a]),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(w.jsx)(p.EuiTitle,{size:"m"},Object(w.jsx)("h1",{id:"addPanelsFlyout"},Object(w.jsx)(W.FormattedMessage,{id:"dashboard.solutionToolbar.addPanelFlyout.headingText",defaultMessage:"Add panel"})))),Object(w.jsx)(p.EuiFlyoutBody,null,Object(w.jsx)(p.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"m"},Object(w.jsx)(p.EuiFlexItem,{grow:!1,css:Object(w.css)({position:"sticky",top:i.size[o],zIndex:1,boxShadow:`0 -${i.size[o]} 0 4px ${i.colors.emptyShade}`},"","")},Object(w.jsx)(p.EuiForm,{component:"form",fullWidth:!0},Object(w.jsx)(p.EuiFormRow,{css:Object(w.css)({backgroundColor:i.colors.emptyShade},"","")},Object(w.jsx)(p.EuiFieldSearch,{autoFocus:!0,value:a,onChange:e=>{l(e.target.value)},"aria-label":u.i18n.translate("dashboard.editorMenu.addPanelFlyout.searchLabelText",{defaultMessage:"search field for panels"}),className:"nsPanelSelectionFlyout__searchInput","data-test-subj":"dashboardPanelSelectionFlyout__searchInput"})))),Object(w.jsx)(p.EuiFlexItem,{grow:!1},Object(w.jsx)(p.EuiFlexGroup,{direction:"column",gutterSize:"m"},c.some((({isDisabled:e})=>!e))?c.map((({id:e,title:t,items:o,isDisabled:n,"data-test-subj":r})=>n?null:Object(w.jsx)(p.EuiFlexItem,{key:e,"data-test-subj":r},Object(w.jsx)(p.EuiTitle,{id:`${e}-group`,size:"xxs"},"string"==typeof t?Object(w.jsx)("h3",null,t):t),Object(w.jsx)(p.EuiListGroup,{"aria-labelledby":`${e}-group`,size:"s",gutterSize:"none",maxWidth:!1,flush:!0},null==o?void 0:o.map(((t,o)=>Object(w.jsx)(p.EuiListGroupItem,{key:`${e}.${o}`,label:Object(w.jsx)(p.EuiToolTip,{position:"right",content:t.description},t.isDeprecated?Object(w.jsx)(p.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"s"},Object(w.jsx)(p.EuiFlexItem,{grow:!1},Object(w.jsx)(p.EuiText,{size:"s"},t.name)),Object(w.jsx)(p.EuiFlexItem,{grow:!1},Object(w.jsx)(p.EuiBadge,{color:"warning"},Object(w.jsx)(W.FormattedMessage,{id:"dashboard.editorMenu.deprecatedTag",defaultMessage:"Deprecated"})))):Object(w.jsx)(p.EuiText,{size:"s"},t.name)),onClick:null==t?void 0:t.onClick,iconType:t.icon,"data-test-subj":t["data-test-subj"],isDisabled:t.isDisabled}))))))):Object(w.jsx)(p.EuiText,{size:"s",textAlign:"center"},Object(w.jsx)(W.FormattedMessage,{id:"dashboard.solutionToolbar.addPanelFlyout.noResultsDescription",defaultMessage:"No panel types found"})))))),Object(w.jsx)(p.EuiFlyoutFooter,null,Object(w.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(p.EuiFlexItem,{grow:!1},Object(w.jsx)(p.EuiButtonEmpty,{onClick:e},Object(w.jsx)(W.FormattedMessage,{id:"dashboard.solutionToolbar.addPanelFlyout.cancelButtonText",defaultMessage:"Close"}))))))},Q=e=>e.sort(((e,t)=>t.order-e.order)),H=({createNewVisType:e,isDisabled:t,api:o})=>{const s=Object(n.useRef)(!1),a=Object(n.useRef)(),l=Object(i.c)();Object(n.useEffect)((()=>(s.current=!0,()=>{var e;s.current=!1,null===(e=a.current)||void 0===e||e.close()})),[]);const{embeddable:c,visualizations:{getAliases:d,getByGroup:p},uiActions:h}=f.pluginServices.getServices(),[g,v]=Object(n.useState)([]),[j,m]=Object(n.useState)(void 0),x=Object(n.useMemo)((()=>Array.from(c.getEmbeddableFactories())),[c]);Object(n.useEffect)((()=>{Promise.all(x.map((async e=>({factory:e,isEditable:await e.isEditable()})))).then((e=>{v(e)}))}),[x]);const y=e=>p(e).sort(((e,t)=>{const o="titleInWizard"in e&&e.titleInWizard||e.title,n="titleInWizard"in t&&t.titleInWizard||e.title;return o<n?-1:o>n?1:0})).filter((({disableCreate:e})=>!e)),O=y(R.VisGroups.PROMOTED),T=y(R.VisGroups.TOOLS),S=y(R.VisGroups.LEGACY),M=d().sort((({promotion:e=!1},{promotion:t=!1})=>e===t?0:e?-1:1)).filter((({disableCreate:e})=>!e)),C=g.filter((({isEditable:e,factory:{type:t,canCreateNew:o,isContainerType:n}})=>e&&!n&&o()&&"visualization"!==t)),E={};Object(n.useEffect)((()=>{!async function(){var e;const t=await(null==h||null===(e=h.getTriggerCompatibleActions)||void 0===e?void 0:e.call(h,L.ADD_PANEL_TRIGGER,{embeddable:o}));s.current&&m(t)}()}),[h,o]),C.forEach((({factory:e})=>{const{grouping:t}=e;if(t)t.forEach((t=>{var o,n;E[t.id]?E[t.id].factories.push(e):E[t.id]={id:t.id,appName:t.getDisplayName?t.getDisplayName({embeddable:l}):t.id,icon:null===(o=t.getIconType)||void 0===o?void 0:o.call(t,{embeddable:l}),factories:[e],order:null!==(n=t.order)&&void 0!==n?n:0}}));else{const t=b.COMMON_EMBEDDABLE_GROUPING.other;var o,n;E[t.id]||(E[t.id]={id:t.id,appName:t.getDisplayName?t.getDisplayName({embeddable:l}):t.id,icon:(null===(o=t.getIconType)||void 0===o?void 0:o.call(t,{embeddable:l}))||"empty",factories:[],order:null!==(n=t.order)&&void 0!==n?n:0}),E[t.id].factories.push(e)}}));const I=(t,o)=>{const n=e(t);return()=>{n(),o()}},k=(e,t)=>{const{name:o,title:n,titleInWizard:r,description:i,icon:s="empty",isDeprecated:a,order:l}=t;return{id:o,name:r||n,isDeprecated:a,icon:s,onClick:I(t,e),"data-test-subj":`visType-${o}`,description:i,order:l}},P=(e,t)=>{const{name:o,title:n,description:r,icon:i="empty",order:s}=t;return{id:o,name:n,icon:i,onClick:I(t,e),"data-test-subj":`visType-${o}`,description:r,order:null!=s?s:0}},B=e=>{const t=((e,t)=>o=>{var n,r;const i=null!=o&&o.getIconType?o.getIconType():"empty";return{id:o.type,name:o.getDisplayName(),icon:i,description:null===(n=o.getDescription)||void 0===n?void 0:n.call(o),onClick:async()=>{t(),e.addNewPanel({panelType:o.type},!0)},"data-test-subj":`createNew-${o.type}`,order:null!==(r=o.order)&&void 0!==r?r:0}})(o,e),n=((e,t,o)=>{const n={},r={embeddable:e,trigger:L.addPanelMenuTrigger},i=e=>{var t,n,i;const s=e.getDisplayName(r);return{id:e.id,name:s,icon:null!==(t="function"==typeof e.getIconType?e.getIconType(r):void 0)&&void 0!==t?t:"empty",onClick:G(e,r,o),"data-test-subj":`create-action-${s}`,description:null==e||null===(n=e.getDisplayNameTooltip)||void 0===n?void 0:n.call(e,r),order:null!==(i=e.order)&&void 0!==i?i:0}};return null==t||t.forEach((t=>{if(Array.isArray(t.grouping))t.grouping.forEach((e=>{const o=e.id;var s;n[o]||(n[o]={id:o,title:e.getDisplayName?e.getDisplayName(r):"","data-test-subj":`dashboardEditorMenu-${o}Group`,order:null!==(s=e.order)&&void 0!==s?s:0,items:[]}),n[e.id].items.push(i(t))}));else{const r=b.COMMON_EMBEDDABLE_GROUPING.other;var o;n[r.id]||(n[r.id]={id:r.id,title:(null===(o=r.getDisplayName)||void 0===o?void 0:o.call(r,{embeddable:e}))||"","data-test-subj":`dashboardEditorMenu-${r.id}Group`,order:r.order||0,items:[]}),n[r.id].items.push(i(t))}})),n})(o,j,e),r=(e=>(t,o)=>{const n=[];return new Set(Object.keys(t).concat(Object.keys(o))).forEach((r=>{const i=`dashboardEditorMenu-${r}Group`,s=t[r],a=o[r];var l;s&&a?n.push({id:s.id,title:s.appName,"data-test-subj":i,order:s.order,items:[...s.factories.map(e),...null!==(l=null==a?void 0:a.items)&&void 0!==l?l:[]]}):s?n.push({id:s.id,title:s.appName,"data-test-subj":i,order:s.order,items:s.factories.map(e)}):a&&n.push(a)})),n})(t)(E,n);return Q(r).map((t=>{switch(t.id){case"visualizations":var o;return{...t,items:Q((null!==(o=t.items)&&void 0!==o?o:[]).concat(M.map(P.bind(null,e)),O.map(k.bind(null,e))))};case b.COMMON_EMBEDDABLE_GROUPING.legacy.id:var n;return{...t,items:Q((null!==(n=t.items)&&void 0!==n?n:[]).concat(S.map(k.bind(null,e))))};case b.COMMON_EMBEDDABLE_GROUPING.annotation.id:var r;return{...t,items:Q((null!==(r=t.items)&&void 0!==r?r:[]).concat(T.map(k.bind(null,e))))};default:return{...t,items:Q(t.items)}}}))};return Object(w.jsx)(F,{"data-test-subj":"dashboardEditorMenuButton",isDisabled:t,iconType:"plusInCircle",label:u.i18n.translate("dashboard.solutionToolbar.editorMenuButtonLabel",{defaultMessage:"Add panel"}),onClick:()=>{a.current=function({getPanels:e,flyoutPanelPaddingSize:t="l"}){const{overlays:o,analytics:n,settings:{i18n:i,theme:s}}=f.pluginServices.getServices();let a;const l=Object(A.a)(r.a.createElement((function(){return Object(w.jsx)(q,{close:()=>a.close(),paddingSize:t,getPanels:e})})),{analytics:n,theme:s,i18n:i});return a=o.openFlyout(l,{size:"m",maxWidth:500,paddingSize:t,"aria-labelledby":"addPanelsFlyout","data-test-subj":"dashboardPanelSelectionFlyout"}),a}({getPanels:B})},size:"s"})},K=({type:e,label:t,iconType:o,size:r="m",children:i,isDisabled:s,...l})=>{const[c,d]=Object(n.useState)(!1),u=()=>d(!1),b=Object(w.jsx)(F,{onClick:()=>d((e=>!e)),size:r,isDisabled:s,type:e,label:t,iconType:o||"arrowDown",iconSide:o?"left":"right"});return Object(w.jsx)(p.EuiPopover,a()({isOpen:c,button:b,closePopover:u},l),i({closePopover:u}))},X=({closePopover:e,controlGroup:t,...o})=>{const n=Object(i.c)(),r=()=>{n.scrollToTop()};return Object(w.jsx)(p.EuiContextMenuItem,a()({},o,{icon:"plusInCircle","data-test-subj":"controls-create-button","aria-label":Object(h.c)(),onClick:()=>{t.openAddDataControlFlyout({onSave:r}),e()}}),Object(h.c)())};var Y=o(72);const J=({closePopover:e,controlGroup:t,...o})=>{const[r,s]=Object(n.useState)(!1),l=Object(i.c)();return Object(n.useEffect)((()=>{const e=t.getInput$().subscribe((()=>{const e=t.getChildIds().some((e=>t.getChild(e).type===Y.TIME_SLIDER_CONTROL));e!==r&&s(e)}));return()=>{e.unsubscribe()}}),[t,r,s]),Object(w.jsx)(p.EuiContextMenuItem,a()({},o,{icon:"timeslider",onClick:async()=>{await t.addTimeSliderControl(),l.scrollToTop(),e()},"data-test-subj":"controls-create-timeslider-button",disabled:r,toolTipContent:r?Object(h.k)():null}),Object(h.d)())},Z=({closePopover:e,controlGroup:t,...o})=>Object(w.jsx)(p.EuiContextMenuItem,a()({},o,{icon:"gear","data-test-subj":"controls-settings-button","aria-label":Object(h.j)(),onClick:()=>{t.openEditControlGroupFlyout(),e()}}),Object(h.j)());function ee({controlGroup:e,isDisabled:t}){const{euiTheme:o}=Object(p.useEuiTheme)();return Object(w.jsx)(K,{ownFocus:!0,repositionOnScroll:!0,panelPaddingSize:"none",label:Object(h.e)(),zIndex:Number(o.levels.header)-1,size:"s",iconType:"controlsHorizontal","data-test-subj":"dashboard-controls-menu-button",isDisabled:t},(({closePopover:t})=>Object(w.jsx)(p.EuiContextMenuPanel,{items:[Object(w.jsx)(X,{key:"addControl",controlGroup:e,closePopover:t}),Object(w.jsx)(J,{key:"addTimeSliderControl",controlGroup:e,closePopover:t}),Object(w.jsx)(Z,{key:"manageControls",controlGroup:e,closePopover:t})]})))}function te({isDisabled:e}){var t;const{usageCollection:o,data:{search:r},embeddable:{getStateTransfer:s},visualizations:{getAliases:a}}=f.pluginServices.getServices(),{euiTheme:l}=Object(p.useEuiTheme)(),c=Object(i.c)(),d=s(),u=a().find((({name:e})=>"lens"===e)),b=null===(t=o.reportUiCounter)||void 0===t?void 0:t.bind(o,C.l),g=Object(n.useCallback)((e=>()=>{var t,o,n;let i="",s="";e?(b&&b(I.METRIC_TYPE.CLICK,`${e.name}:create`),"alias"in e?e.alias&&"path"in e.alias&&(s=e.alias.app,i=e.alias.path):(s="visualize",i=`#/create?type=${encodeURIComponent(e.name)}`)):(s="visualize",i="#/create?"),d.navigateToEditor(s,{path:i,state:{originatingApp:null===(t=c.getAppContext())||void 0===t?void 0:t.currentAppId,originatingPath:null===(o=c.getAppContext())||void 0===o||null===(n=o.getCurrentPath)||void 0===n?void 0:n.call(o),searchSessionId:r.session.getSessionId()}})}),[d,c,r.session,b]),v=[Object(w.jsx)(H,{createNewVisType:g,isDisabled:e,api:c}),Object(w.jsx)(z,{onClick:()=>c.addFromLibrary(),size:"s","data-test-subj":"dashboardAddFromLibraryButton",isDisabled:e})];return c.controlGroup&&v.push(Object(w.jsx)(ee,{isDisabled:e,controlGroup:c.controlGroup})),Object(w.jsx)("div",{css:Object(w.css)("padding:0 ",l.size.s," ",l.size.s," ",l.size.s,";","")},Object(w.jsx)(V,null,{primaryButton:Object(w.jsx)(F,{type:"primary",isDisabled:e,iconType:"lensApp",size:"s",onClick:g(u),label:Object(h.f)(),"data-test-subj":"dashboardAddNewPanelButton"}),extraButtons:v}))}var oe=o(95);o(305);const ne=Object(d.withSuspense)(d.LazyLabsFlyout,null);function re({customLeadingBreadCrumbs:e=[],embedSettings:t,forceHideUnifiedSearch:o,redirectTo:s,setCustomHeaderActionMenu:l,showBorderBottom:y=!0,showResetChange:I=!0}){const[k,P]=Object(n.useState)(!1),[B,D]=Object(n.useState)(!1),_=Object(n.useRef)(null),{data:{query:{filterManager:F}},chrome:{setBreadcrumbs:z,setIsVisible:N,getIsVisible$:V,recentlyAccessed:L},serverless:R,settings:{uiSettings:G},navigation:{TopNavMenu:A},embeddable:{getStateTransfer:U},initializerContext:{allowByValueEmbeddables:$},dashboardCapabilities:{saveQuery:W,showWriteControls:q}}=f.pluginServices.getServices(),Q=G.get(g.a.ENABLE_LABS_UI),{setHeaderActionMenu:H,onAppLeave:K}=Object(oe.b)(),X=Object(i.c)(),Y=Object(d.getContextProvider)(),J=X.select((e=>e.componentState.hasRunClientsideMigrations)),Z=X.select((e=>e.componentState.hasUnsavedChanges)),ee=X.select((e=>e.componentState.fullScreenMode)),re=X.select((e=>e.componentState.savedQueryId)),ie=X.select((e=>e.componentState.lastSavedId)),se=X.select((e=>e.componentState.focusedPanelId)),ae=X.select((e=>e.componentState.managed)),le=X.select((e=>e.explicitInput.viewMode)),ce=X.select((e=>e.explicitInput.query)),de=X.select((e=>e.explicitInput.title)),[ue,be]=Object(n.useState)([]);Object(n.useEffect)((()=>{be(X.getAllDataViews());const e=X.onDataViewsUpdate$.subscribe((e=>be(e)));return()=>e.unsubscribe()}),[X]);const pe=Object(n.useMemo)((()=>Object(h.i)(de,le,!ie)),[de,le,ie]);Object(n.useEffect)((()=>{var e;null===(e=_.current)||void 0===e||e.focus()}),[de,le]),Object(n.useEffect)((()=>{t||N(le!==b.ViewMode.PRINT)}),[t,N,le]),Object(n.useEffect)((()=>{const e=V().subscribe((e=>P(e)));return ie&&de&&L.add(Object(C.A)(ie,le===b.ViewMode.EDIT),de,ie),()=>e.unsubscribe()}),[$,L,V,ie,le,de]),Object(n.useEffect)((()=>{const t=[{text:le===b.ViewMode.EDIT?Object(w.jsx)(r.a.Fragment,null,pe," ",Object(w.jsx)(p.EuiIcon,{size:"s",type:"pencil"})):pe,onClick:le===b.ViewMode.EDIT?()=>{X.showSettings()}:void 0}];null!=R&&R.setBreadcrumbs?R.setBreadcrumbs(t):z(e.concat([{text:Object(h.g)(),"data-test-subj":"dashboardListingBreadcrumb",onClick:()=>{s({destination:"listing"})}},...t]))}),[z,s,pe,X,le,R,e]),Object(n.useEffect)((()=>(K((e=>le===b.ViewMode.EDIT&&Z&&!U().isTransferInProgress?e.confirm(h.n.getLeaveSubtitle(),h.n.getLeaveTitle()):e.default())),()=>{K((e=>e.default()))})),[K,U,Z,le]);const he=Object(n.useMemo)((()=>{const e=e=>(e||k)&&!ee,n=e(Boolean(null==t?void 0:t.forceShowTopNavMenu)),r=!Boolean(o)&&e(Boolean((null==t?void 0:t.forceShowQueryInput)||le===b.ViewMode.PRINT)),i=!Boolean(o)&&e(Boolean(null==t?void 0:t.forceShowDatePicker)),s=!Boolean(null==t?void 0:t.forceHideFilterBar)&&(F.getFilters().length>0||!ee);return{showTopNavMenu:n,showSearchBar:r||i||s||s,showFilterBar:s,showQueryInput:r,showDatePicker:i}}),[t,F,o,ee,k,le]),{viewModeTopNavConfig:ge,editModeTopNavConfig:fe}=(({redirectTo:e,isLabsShown:t,setIsLabsShown:o,showResetChange:r})=>{const[s,a]=Object(n.useState)(!1),{share:l,dashboardBackup:c,settings:{uiSettings:d},dashboardCapabilities:{showWriteControls:y}}=f.pluginServices.getServices(),I=d.get(g.a.ENABLE_LABS_UI),k=Object(i.c)(),P=k.select((e=>e.componentState.hasRunClientsideMigrations)),B=k.select((e=>e.componentState.hasUnsavedChanges)),D=k.select((e=>e.componentState.hasOverlays)),_=k.select((e=>e.componentState.lastSavedId)),F=k.select((e=>e.explicitInput.title)),z=k.select((e=>e.explicitInput.viewMode)),N=k.select((e=>e.componentState.managed)),V=s||D,L=Object(n.useCallback)((e=>{!function({isDirty:e,anchorElement:t,savedObjectId:o,dashboardTitle:r,getDashboardState:i}){var s,a;const{dashboardCapabilities:{createShortUrl:l},dashboardBackup:c,data:{query:{timefilter:{timefilter:{getTime:d}}}},notifications:v,share:{toggleShareContextMenu:y}}=f.pluginServices.getServices();if(!y)return;let C={};const{dashboardState:E,panels:I}=null!==(s=c.getState(o))&&void 0!==s?s:{},k=(e=>{if(0===Object.keys(null!==(e=null==E?void 0:E.panels)&&void 0!==e?e:{}).length&&0===Object.keys(null!=I?I:{}).length)return;const t=i().panels,o=I?Object.entries(I).reduce(((e,[o,n])=>(n&&null!=t&&t[o]&&(e[o]={...t[o],explicitInput:{...null==t?void 0:t[o].explicitInput,...n,id:o}}),e)),{}):{},n={...t,...o};return Object(g.b)(n)})();E&&(C={query:E.query,filters:E.filters,controlGroupInput:E.controlGroupInput,panels:k,useMargins:null==E?void 0:E.useMargins,syncColors:null==E?void 0:E.syncColors,syncCursor:null==E?void 0:E.syncCursor,syncTooltips:null==E?void 0:E.syncTooltips,hidePanelTitles:null==E?void 0:E.hidePanelTitles});const P={dashboardId:o,preserveSavedFilters:!0,refreshInterval:void 0,viewMode:b.ViewMode.VIEW,useHash:!1,timeRange:d(),...C};let B=Object(m.getStateFromKbnUrl)("_g",window.location.href);null!==(a=B)&&void 0!==a&&a.filters&&0===B.filters.length&&(B=Object(x.omit)(B,"filters"));const D=Object(m.setStateToKbnUrl)("_g",B,void 0,window.location.href);y({isDirty:e,anchorElement:t,allowEmbed:!0,allowShortUrl:l,shareableUrl:Object(m.setStateToKbnUrl)("_a",C,{useHash:!1,storeInHashQuery:!0},Object(m.unhashUrl)(D)),objectId:o,objectType:"dashboard",objectTypeMeta:{title:u.i18n.translate("dashboard.share.shareModal.title",{defaultMessage:"Share this dashboard"})},sharingData:{title:r||u.i18n.translate("dashboard.share.defaultDashboardTitle",{defaultMessage:"Dashboard [{date}]",values:{date:O()().toISOString(!0)}}),locatorParams:{id:j.a,params:P}},embedUrlParamExtensions:[{paramName:"embed",component:({setParamValue:e})=>{const[t,o]=Object(n.useState)({showFilterBar:!0}),r=[{id:T.dashboardUrlParams.showTopMenu,label:h.o.getTopMenuCheckbox()},{id:T.dashboardUrlParams.showQueryInput,label:h.o.getQueryCheckbox()},{id:T.dashboardUrlParams.showTimeFilter,label:h.o.getTimeFilterCheckbox()},{id:S,label:h.o.getFilterBarCheckbox()}];return Object(w.jsx)(p.EuiCheckboxGroup,{options:r,idToSelectedMap:t,onChange:n=>{const r={...t,[n]:!t[n]},i={[T.dashboardUrlParams.showTopMenu]:r[T.dashboardUrlParams.showTopMenu],[T.dashboardUrlParams.showQueryInput]:r[T.dashboardUrlParams.showQueryInput],[T.dashboardUrlParams.showTimeFilter]:r[T.dashboardUrlParams.showTimeFilter],[T.dashboardUrlParams.hideFilterBar]:!r[S]};o(r),e(i)},legend:{children:h.o.getCheckboxLegend()},"data-test-subj":"embedUrlParamExtension"})}}],showPublicUrlSwitch:M,snapshotShareWarning:Boolean(null==E?void 0:E.panels)?h.o.getSnapshotShareWarning():void 0,toasts:v.toasts})}({dashboardTitle:F,anchorElement:e,savedObjectId:_,isDirty:Boolean(B),getDashboardState:()=>k.getState().explicitInput})}),[F,B,_,k]),R=Object(n.useCallback)((t=>{if(!t)return;const{redirectRequired:o,id:n}=t;o&&e({id:n,editMode:!0,useReplace:!0,destination:"dashboard"})}),[e]),G=Object(n.useCallback)((()=>{a(!0),k.runQuickSave().then((()=>setTimeout((()=>a(!1)),C.a)))}),[k]),A=Object(n.useCallback)((()=>{k.runInteractiveSave(z).then((e=>R(e)))}),[R,k,z]),U=Object(n.useCallback)(((e=!1)=>{k.clearOverlays();const t=e?()=>{k.dispatch.setViewMode(b.ViewMode.VIEW),c.storeViewMode(b.ViewMode.VIEW)}:void 0;B?Object(E.b)((()=>{Object(v.batch)((()=>{k.resetToLastSavedState(),null==t||t()}))}),z):null==t||t()}),[k,c,B,z]),$=Object(n.useMemo)((()=>({fullScreen:{...h.p.fullScreen,id:"full-screen",testId:"dashboardFullScreenMode",run:()=>k.dispatch.setFullScreenMode(!0),disableButton:V},labs:{...h.p.labs,id:"labs",testId:"dashboardLabs",run:()=>o(!t)},edit:{...h.p.edit,emphasize:!0,id:"edit",iconType:"pencil",testId:"dashboardEditMode",className:"eui-hideFor--s eui-hideFor--xs",run:()=>{c.storeViewMode(b.ViewMode.EDIT),k.dispatch.setViewMode(b.ViewMode.EDIT),k.clearOverlays()},disableButton:V},quickSave:{...h.p.quickSave,id:"quick-save",iconType:"save",emphasize:!0,isLoading:s,testId:"dashboardQuickSaveMenuItem",disableButton:V||!(P||B),run:()=>G()},interactiveSave:{disableButton:V,emphasize:!Boolean(_),id:"interactive-save",testId:"dashboardInteractiveSaveMenuItem",run:A,label:z===b.ViewMode.VIEW?h.p.viewModeInteractiveSave.label:Boolean(_)?h.p.editModeInteractiveSave.label:h.p.quickSave.label,description:z===b.ViewMode.VIEW?h.p.viewModeInteractiveSave.description:h.p.editModeInteractiveSave.description},switchToViewMode:{...h.p.switchToViewMode,id:"cancel",disableButton:V||!_,testId:"dashboardViewOnlyMode",run:()=>U(!0)},share:{...h.p.share,id:"share",testId:"shareTopNavButton",disableButton:V,run:L},settings:{...h.p.settings,id:"settings",testId:"dashboardSettingsButton",disableButton:V,run:()=>k.showSettings()}})),[V,s,P,B,_,A,z,L,k,o,t,c,G,U]),W=Object(n.useMemo)((()=>({...h.p.resetChanges,id:"reset",testId:"dashboardDiscardChangesMenuItem",disableButton:!B||D||z===b.ViewMode.EDIT&&(s||!_),run:()=>U()})),[D,_,U,z,s,B]);return{viewModeTopNavConfig:Object(n.useMemo)((()=>{const e=I?[$.labs]:[],t=l?[$.share]:[],o=y?[$.interactiveSave]:[],n=y&&!N?[$.edit]:[],i=r?[W]:[];return[...e,$.fullScreen,...t,...o,...i,...n]}),[I,$,l,y,N,r,W]),editModeTopNavConfig:Object(n.useMemo)((()=>{const e=I?[$.labs]:[],t=l?[$.share]:[],o=[];return _?(o.push($.interactiveSave,$.switchToViewMode),r&&o.push(W),o.push($.quickSave)):o.push($.switchToViewMode,$.interactiveSave),[...e,$.settings,...t,...o]}),[I,$,l,_,r,W])}})({redirectTo:s,isLabsShown:B,setIsLabsShown:D,showResetChange:I});c()((()=>{X.clearOverlays()}));const ve=Object(n.useMemo)((()=>{const e=[];var t;return Z&&le===b.ViewMode.EDIT&&e.push({"data-test-subj":"dashboardUnsavedChangesBadge",badgeText:h.q.getUnsavedChangedBadgeText(),title:"",color:"warning",toolTipProps:{content:h.q.getUnsavedChangedBadgeToolTipContent(),position:"bottom"}}),J&&le===b.ViewMode.EDIT&&e.push({"data-test-subj":"dashboardSaveRecommendedBadge",badgeText:h.q.getHasRunMigrationsText(),title:"",color:"success",iconType:"save",toolTipProps:{content:h.q.getHasRunMigrationsToolTipContent(),position:"bottom"}}),q&&ae&&e.push((t=h.a.getTooltip(),{"data-test-subj":"managedContentBadge",badgeText:u.i18n.translate("managedContentBadge.text",{defaultMessage:"Managed"}),title:u.i18n.translate("managedContentBadge.text",{defaultMessage:"Managed"}),color:"primary",iconType:"glasses",toolTipProps:{content:t,position:"bottom"}})),e}),[Z,le,J,q,ae]);return Object(w.jsx)("div",{className:"dashboardTopNav"},Object(w.jsx)("h1",{id:"dashboardTitle",className:"euiScreenReaderOnly",ref:_,tabIndex:-1},`${Object(h.g)()} - ${pe}`),Object(w.jsx)(A,a()({},he,{query:ce,badges:ve,screenTitle:de,useDefaultBehaviors:!0,savedQueryId:re,indexPatterns:ue,saveQueryMenuVisibility:W?"allowed_by_app_privilege":"globally_managed",appName:C.r,visible:le!==b.ViewMode.PRINT,setMenuMountPoint:t||ee?null!=l?l:void 0:H,className:ee?"kbnTopNavMenu-isFullScreen":void 0,config:he.showTopNavMenu?le===b.ViewMode.EDIT?fe:ge:void 0,onQuerySubmit:(e,t)=>{!1===t&&X.forceRefresh()},onSavedQueryIdChange:e=>X.dispatch.setSavedQueryId(e)})),le!==b.ViewMode.PRINT&&Q&&B?Object(w.jsx)(Y,null,Object(w.jsx)(ne,{solutions:["dashboard"],onClose:()=>D(!1)})):null,le===b.ViewMode.EDIT?Object(w.jsx)(te,{isDisabled:!!se}):null,y&&Object(w.jsx)(p.EuiHorizontalRule,{margin:"none"}))}const ie=e=>Object(w.jsx)(i.a.Provider,{value:e.dashboardContainer},Object(w.jsx)(re,e));t.default=ie}}]);