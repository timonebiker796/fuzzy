!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=20)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,i){e.exports=i(10)(2)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),s=i(2),a=n.__importDefault(i(23));t.default=function(e,t){var i=s.useState(t),n=i[0],o=i[1];return a.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),n}},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,i){e.exports=i(10)(4)},function(e,t){e.exports=__kbnSharedDeps__.ElasticEuiLibComponentsUseIsNestedEuiProvider},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var n=void 0;t.setEuiDevProviderWarning=function(e){return n=e},t.getEuiDevProviderWarning=function(){return n},t.emitEuiProviderWarning=function(e){if("function"==typeof n)return n(e);switch(n){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},function(e,t,i){e.exports=i.p+"a8b605caa04feac6eab34454bb10435c.svg"},function(e,t,i){e.exports=i.p+"8cd9b6092e305a0cf45d0fdb3a3775f8.svg"},function(e,t,i){e.exports=i.p+"0bffeba020402fbadb3811d6aa1c7604.svg"},function(e,t,i){e.exports=i.p+"ddc7adc1a070b4a20d66ebd9676ff0c8.svg"},function(e,t,i){e.exports=i.p+"f7b0198ee3a27c5aa138358d190f60fb.gif"},function(e,t,i){e.exports=i.p+"4ca3a211c5c89ca7d5d9b33353d75938.gif"},function(e,t,i){i(21),__kbnBundles__.define("plugin/guidedOnboarding/public",i,24)},function(e,t,i){i.p=window.__kbnPublicPath__.guidedOnboarding},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),s="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=s},function(e,t,i){"use strict";i.r(t),i.d(t,"plugin",(function(){return xe}));var n=i(8),s=i.n(n),a=i(2),o=i.n(a),r=i(11),u=i.n(r),d=i(12),l=i(13),c=i(6),p=i.n(c),g=i(7),b=i.n(g),f=i(1);const j="eui-global",h="eui-utilities",m={darkMode:!1};var x=i(0);const O=[f.euiStylisPrefixer],v=b()({key:"css",stylisPlugins:O,container:document.querySelector('meta[name="emotion"]')}),y=b()({key:j,stylisPlugins:O,container:document.querySelector(`meta[name="${j}"]`)}),S=b()({key:h,stylisPlugins:O,container:document.querySelector(`meta[name="${h}"]`)});v.compat=!0,y.compat=!0,S.compat=!0;const E={default:v,global:y,utility:S},_=({theme:{theme$:e},globalStyles:t,colorMode:i,modify:n,children:s})=>{const o=p()(e,m),r=Object(a.useMemo)((()=>(e=>e.darkMode?f.COLOR_MODES_STANDARD.dark:f.COLOR_MODES_STANDARD.light)(o)),[o]),u=i||r,d=!1!==t&&void 0;return Object(x.jsx)(f.EuiProvider,{cache:E,modify:n,colorMode:u,globalStyles:d,utilityClasses:d},s)},C=({children:e,i18n:t,...i})=>Object(d.useIsNestedEuiProvider)()?(Object(l.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(x.jsx)(t.Context,null,e)):Object(x.jsx)(_,i,Object(x.jsx)(t.Context,null,e));var G=i(9);const w=({children:e,...t})=>Object(x.jsx)(C,u()({globalStyles:!1},t),Object(x.jsx)(G.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(x.jsx)(G.KibanaErrorBoundary,null,e))),P="/internal/guided_onboarding";var k=i(3),T=i(5),I=i.n(T),M=i(4);const L=e=>{const t=e.steps.find((e=>"in_progress"===e.status));return t?t.id:void 0},B=(e,t)=>{if(!e||"in_progress"!==e.status||!e.activeGuide)return!1;if(t){const{activeGuide:i}=e;return!(!i.isActive||i.guideId!==t)}return!0},$=(e,t,i,n)=>{if(!e||!e.isActive||e.guideId!==i)return!1;const s=e.steps.find((e=>e.id===n));return!!s&&s.status===t},z=(e,t,i)=>$(e,"in_progress",t,i),D=(e,t,i)=>$(e,"ready_to_complete",t,i);class config_service_ConfigService{constructor(){I()(this,"client",void 0),I()(this,"configs",void 0),I()(this,"isConfigInitialized",void 0)}setup(e){this.client=e,this.configs={},this.isConfigInitialized={}}async getGuideConfig(e){if(!this.client)throw new Error("ConfigService has not be initialized.");if(!this.isConfigInitialized||!this.isConfigInitialized[e])try{const{config:t}=await this.client.get(`${P}/configs/${e}`);this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0,this.configs||(this.configs={}),this.configs[e]=t}catch(t){this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0}return((e,t)=>{if(e&&t&&Object.keys(e).includes(t))return e[t]})(this.configs,e)}async getGuideStatusOnStepCompletion({isLastStepInGuide:e,isManualCompletion:t,isStepReadyToComplete:i}){return e&&!t||e&&t&&i?"ready_to_complete":"in_progress"}async isIntegrationInGuideStep(e,t){if(!e||!e.isActive)return!1;const i=((e,t)=>{const i=L(t);if(i&&e)return e.steps.find((e=>e.id===i))})(await this.getGuideConfig(e.guideId),e);return!!i&&i.integration===t}}const F=new class api_service_ApiService{constructor(){I()(this,"_isEnabled",!1),I()(this,"client",void 0),I()(this,"pluginState$",void 0),I()(this,"isLoading$",new M.BehaviorSubject(!1)),I()(this,"isGuidePanelOpen$",new M.BehaviorSubject(!1)),I()(this,"configService",new config_service_ConfigService)}setup(e,t){this._isEnabled=t,this.client=e,this.pluginState$=new M.BehaviorSubject(void 0),this.isGuidePanelOpen$=new M.BehaviorSubject(!1),this.isLoading$=new M.BehaviorSubject(!1),this.configService.setup(e)}createGetPluginStateObservable(){return new M.Observable((e=>{const t=new AbortController,i=t.signal;return this.isLoading$.next(!0),this.client.get(`${P}/state`,{signal:i}).then((({pluginState:t})=>{this.isLoading$.next(!1),e.next(t),this.pluginState$.next(t),e.complete()})).catch((t=>{this.isLoading$.next(!1),e.next({status:"error",isActivePeriod:!1}),this.pluginState$.next({status:"error",isActivePeriod:!1}),e.complete()})),()=>{this.isLoading$.next(!1),t.abort()}}))}fetchPluginState$(){if(!this._isEnabled)return Object(M.of)(void 0);if(!this.client)throw new Error("ApiService has not be initialized.");return this.pluginState$.value||this.isLoading$.value?this.pluginState$:(this.isLoading$.next(!0),Object(M.concat)(this.createGetPluginStateObservable(),this.pluginState$))}async fetchAllGuidesState(){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{return await this.client.get(`${P}/guides`)}catch(e){throw e}}}async updatePluginState(e,t){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{this.isLoading$.next(!0);const i=await this.client.put(`${P}/state`,{body:JSON.stringify(e)});return this.isLoading$.next(!1),this.pluginState$.next(i.pluginState),this.isGuidePanelOpen$.next(t),i}catch(e){throw this.isLoading$.next(!1),e}}}async activateGuide(e,t){if(t)return await this.updatePluginState({status:"in_progress",guide:{...t,isActive:!0}},!0);const i=await this.configService.getGuideConfig(e);if(i){const t={guideId:e,isActive:!0,status:"not_started",steps:i.steps.map(((e,t)=>{const i=0===t;return{id:e.id,status:i?"active":"inactive"}}))};return await this.updatePluginState({status:"in_progress",guide:t},!0)}}async deactivateGuide(e){return await this.updatePluginState({status:"quit",guide:{...e,isActive:!1}},!1)}async completeGuide(e){const t=await Object(M.firstValueFrom)(this.fetchPluginState$());if(!B(t,e))return;const{activeGuide:i}=t;if(Boolean(i.steps.find((e=>"complete"===e.status)))){const e={...i,isActive:!1,status:"complete"};return await this.updatePluginState({status:"complete",guide:e},!1)}}isGuideStepActive$(e,t){return this.fetchPluginState$().pipe(Object(M.map)((i=>!!B(i,e)&&z(i.activeGuide,e,t))))}isGuideStepReadyToComplete$(e,t){return this.fetchPluginState$().pipe(Object(M.map)((i=>!!B(i,e)&&D(i.activeGuide,e,t))))}async startGuideStep(e,t){const i=await Object(M.firstValueFrom)(this.fetchPluginState$());if(!B(i,e))return;const{activeGuide:n}=i,s={guideId:e,isActive:!0,status:"in_progress",steps:n.steps.map((e=>e.id===t?{id:e.id,status:"in_progress"}:e))};return await this.updatePluginState({guide:s},!1)}async completeGuideStep(e,t,i){const n=await Object(M.firstValueFrom)(this.fetchPluginState$());if(!B(n,e))return;const{activeGuide:s}=n,a=z(s,e,t),o=D(s,e,t),r=await this.configService.getGuideConfig(e),u=((e,t,i)=>null==e?void 0:e.steps.find((e=>e.id===i)))(r,s.guideId,t),d=!!u&&!!u.manualCompletion,l=((e,t,i)=>{const n=((e,t,i)=>e?e.steps.findIndex((e=>e.id===i)):-1)(e,0,i),s=(null==e?void 0:e.steps.length)||0;return s>0&&n===s-1})(r,0,t);if(a||o){const n=((e,t,i)=>{const n=e.steps.findIndex((e=>e.id===t)),s=e.steps[n];return e.steps.map(((e,t)=>{const a=e.id===s.id,o=t===n+1;return a?{id:e.id,status:i?"ready_to_complete":"complete"}:o?i?e:{id:e.id,status:"active"}:e}))})(s,t,d&&a),r={guideId:e,isActive:!0,status:await this.configService.getGuideStatusOnStepCompletion({isLastStepInGuide:l,isManualCompletion:d,isStepReadyToComplete:o}),steps:n,params:i};return await this.updatePluginState({guide:r},!d||o)}}isGuidedOnboardingActiveForIntegration$(e){return this.fetchPluginState$().pipe(Object(M.concatMap)((t=>Object(M.from)(this.configService.isIntegrationInGuideStep(null==t?void 0:t.activeGuide,e)))))}async completeGuidedOnboardingForIntegration(e){if(!e)return;const t=await Object(M.firstValueFrom)(this.fetchPluginState$());if(!B(t))return;const{activeGuide:i}=t,n=L(i);return n&&await this.configService.isIntegrationInGuideStep(i,e)?await this.completeGuideStep(i.guideId,n):void 0}async skipGuidedOnboarding(){return await this.updatePluginState({status:"skipped"},!1)}async getGuideConfig(e){if(!this._isEnabled)return;if(!this.client)throw new Error("ApiService has not be initialized.");this.isLoading$.next(!0);const t=await this.configService.getGuideConfig(e);return this.isLoading$.next(!1),t}get isEnabled(){return this._isEnabled}},A=({closeModal:e,currentGuide:t,telemetryGuideId:i,notifications:n})=>{const[s,o]=Object(a.useState)(!1);return Object(x.jsx)(f.EuiModal,{"aria-label":"quitGuideModal","data-test-subj":"onboarding--quitGuideModal",maxWidth:448,onClose:e},Object(x.jsx)(f.EuiModalHeader,null,Object(x.jsx)(f.EuiModalHeaderTitle,null,k.i18n.translate("guidedOnboarding.quitGuideModal.modalTitle",{defaultMessage:"Quit this guide?"}))),Object(x.jsx)(f.EuiModalBody,null,Object(x.jsx)(f.EuiText,null,Object(x.jsx)("p",null,k.i18n.translate("guidedOnboarding.quitGuideModal.modalDescription",{defaultMessage:"You can restart the setup guide any time from the Help menu."})))),Object(x.jsx)(f.EuiModalFooter,null,Object(x.jsx)(f.EuiButtonEmpty,{"data-test-subj":`onboarding--cancelQuitGuideButton--${i}`,onClick:e},k.i18n.translate("guidedOnboarding.quitGuideModal.cancelButtonLabel",{defaultMessage:"Cancel"})),Object(x.jsx)(f.EuiButton,{"data-test-subj":`onboarding--quitGuideButton--${i}`,onClick:async()=>{try{o(!0),await F.deactivateGuide(t),e()}catch(e){o(!1),n.toasts.addDanger({title:k.i18n.translate("guidedOnboarding.quitGuideModal.deactivateGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}},isLoading:s,fill:!0,color:"warning"},k.i18n.translate("guidedOnboarding.quitGuideModal.quitButtonLabel",{defaultMessage:"Quit guide"}))))};var R=i(14),W=i.n(R),N=i(15),q=i.n(N),H=i(16),K=i.n(H),Q=i(17),U=i.n(Q),V={name:"3ifei",styles:">li{list-style-type:none;}margin-inline-start:0!important"},Y={name:"fwdmq1",styles:"height:600px"},J={name:"eep2zz",styles:"display:flex;block-size:100%;justify-content:space-between;flex-direction:column"},X={name:"1aot8k0",styles:"flex-grow:0;padding:8px 0 0"},Z={name:"3vaow",styles:"flex-grow:0;padding:16px 16px 0"},ee={name:"1flj9lk",styles:"text-align:left"};const te=({button:e,isGuidePanelOpen:t,title:i,description:n})=>{const s=Object(a.useRef)(!0);Object(a.useEffect)((()=>{s.current=!1}),[]);const[o,r]=Object(a.useState)(!0);return Object(a.useEffect)((()=>{t&&!s.current&&r(!1)}),[t]),Object(x.jsx)(f.EuiPopover,{"data-test-subj":"manualCompletionPopover",button:e,isOpen:o,repositionOnScroll:!0,closePopover:()=>{}},i&&Object(x.jsx)(f.EuiTitle,{size:"xxs"},Object(x.jsx)("h3",null,i)),Object(x.jsx)(f.EuiSpacer,null),Object(x.jsx)(f.EuiText,{size:"s",style:{width:300}},n&&Object(x.jsx)("p",null,n)))},ie=({pluginState:e,guideConfig:t,toggleGuidePanel:i,isGuidePanelOpen:n,navigateToLandingPage:s,isLoading:a})=>{var o;const r=(e=>{let t;return null==e||e.steps.forEach(((e,i)=>{"in_progress"!==e.status&&"ready_to_complete"!==e.status||(t=i+1),"active"===e.status&&(t=i)})),t})(null==e?void 0:e.activeGuide),u=null==e||null===(o=e.activeGuide)||void 0===o?void 0:o.steps.find((e=>"ready_to_complete"===e.status)),d=Object(x.jsx)(f.EuiButton,{isLoading:a,onClick:i,color:"success",fill:!0,size:"s","data-test-subj":"guideButton"},Boolean(r)?k.i18n.translate("guidedOnboarding.guidedSetupStepButtonLabel",{defaultMessage:"Setup guide: step {stepNumber}",values:{stepNumber:r}}):k.i18n.translate("guidedOnboarding.guidedSetupButtonLabel",{defaultMessage:"Setup guide"}));if(!e||!e.activeGuide||!e.activeGuide.isActive||"not_started"===e.activeGuide.status)return null==e||!e.isActivePeriod||"not_started"!==(null==e?void 0:e.status)&&"skipped"!==(null==e?void 0:e.status)&&"in_progress"!==e.status?"error"===(null==e?void 0:e.status)?d:null:Object(x.jsx)(f.EuiButton,{onClick:s,color:"success",fill:!0,size:"s","data-test-subj":"guideButtonRedirect"},k.i18n.translate("guidedOnboarding.guidedSetupRedirectButtonLabel",{defaultMessage:"Setup guides"}));if(u){const e=null==t?void 0:t.steps.find((e=>e.id===u.id));if(e&&e.manualCompletion)return Object(x.jsx)(te,{button:d,isGuidePanelOpen:n,title:e.manualCompletion.title,description:e.manualCompletion.description})}return d},ne=({styles:e,titleId:t,toggleGuide:i,hasError:n,isGuideReadyToComplete:s,guideConfig:a,backButton:o})=>{const r=Object(x.jsx)(f.EuiButtonIcon,{iconType:"cross","aria-label":k.i18n.translate("guidedOnboarding.dropdownPanel.closeButton.ariaLabel",{defaultMessage:"Close modal"}),onClick:i,onKeyDown:e=>{e.key===f.keys.ESCAPE&&(e.preventDefault(),e.stopPropagation(),i())},color:"text",css:e.flyoutOverrides.flyoutCloseButtonIcon});return n?Object(x.jsx)("div",{css:e.flyoutOverrides.flyoutHeaderError},o,r):Object(x.jsx)("div",{css:e.flyoutOverrides.flyoutHeader},Object(x.jsx)(f.EuiSpacer,{size:"s"}),o,Object(x.jsx)(f.EuiSpacer,{size:"s"}),Object(x.jsx)(f.EuiTitle,{size:"m"},Object(x.jsx)("h2",{id:t,"data-test-subj":"guideTitle"},s?k.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutTitle",{defaultMessage:"Well done!"}):a?a.title:"")),r,Object(x.jsx)(f.EuiHorizontalRule,null))};var se=i(18),ae=i.n(se),oe={name:"1se9e8c",styles:"p{margin-left:32px;margin-block-end:0;}ul{padding-left:28px;}"};const re=e=>{if("string"==typeof e)return e;const{descriptionText:t,linkText:i,linkUrl:n,isLinkExternal:s}=e;return Object(x.jsx)(o.a.Fragment,null,t,Object(x.jsx)("br",null),Object(x.jsx)(f.EuiLink,{"data-test-subj":"guidePanelStepDescriptionLink",href:n,target:s?"_blank":""},i))},ue=({accordionId:e,stepStatus:t,stepNumber:i,stepConfig:n,handleButtonClick:s,telemetryGuideId:a,isLoading:r})=>{const{euiTheme:u}=Object(f.useEuiTheme)(),d=((e,t)=>({stepNumber:Object(x.css)("width:24px;height:24px;border-radius:50%;border:2px solid ","inactive"===t?e.colors.lightShade:e.colors.success,";font-weight:",e.font.weight.medium,";text-align:center;line-height:1.4;color:","inactive"===t?e.colors.subduedText:e.colors.text,";",""),stepTitle:Object(x.css)("font-weight:",e.font.weight.semiBold,";color:","inactive"===t?e.colors.subduedText:e.colors.text,";.euiAccordion-isOpen &{color:",e.colors.title,";}",""),description:oe}))(u,t),l=Object(x.jsx)(f.EuiFlexGroup,{gutterSize:"s",responsive:!1},Object(x.jsx)(f.EuiFlexItem,{grow:!1},"complete"===t?Object(x.jsx)(f.EuiIcon,{type:"checkInCircleFilled",size:"l",color:u.colors.success}):Object(x.jsx)("span",{css:d.stepNumber},i)),Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiText,{size:"m",css:d.stepTitle},n.title))),c="in_progress"===t||"active"===t||"ready_to_complete"===t;return Object(x.jsx)("div",{"data-test-subj":"guidePanelStep"},"complete"===t?Object(x.jsx)(o.a.Fragment,null,l):Object(x.jsx)(f.EuiAccordion,{id:e,buttonContent:l,arrowDisplay:"right",initialIsOpen:c},Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)(f.EuiSpacer,{size:"s"}),Object(x.jsx)(f.EuiText,{size:"s","data-test-subj":"guidePanelStepDescription",css:d.description},n.description&&Object(x.jsx)("p",null,re(n.description)),n.descriptionList&&Object(x.jsx)("ul",null,n.descriptionList.map(((e,t)=>Object(x.jsx)("li",{key:`description-${t}`},re(e)))))),Object(x.jsx)(f.EuiSpacer,null),c&&Object(x.jsx)(f.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiButton,{isLoading:r,onClick:s,fill:!0,"data-test-subj":`onboarding--stepButton--${a}--step${i}`},(()=>{switch(t){case"active":return k.i18n.translate("guidedOnboarding.dropdownPanel.startStepButtonLabel",{defaultMessage:"Start"});case"in_progress":return k.i18n.translate("guidedOnboarding.dropdownPanel.continueStepButtonLabel",{defaultMessage:"Continue"});case"ready_to_complete":return k.i18n.translate("guidedOnboarding.dropdownPanel.markDoneStepButtonLabel",{defaultMessage:"Mark done"})}return""})()))))),Object(x.jsx)(f.EuiHorizontalRule,{margin:"l"}))},de=({guideConfig:e,styles:t,pluginState:i,isLoading:n,stepsCompleted:s,isGuideReadyToComplete:a,handleStepButtonClick:r})=>{const{flyoutStepsWrapper:u}=t.flyoutOverrides;return Object(x.jsx)(o.a.Fragment,null,s>0&&Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)(f.EuiSpacer,{size:"xl"}),Object(x.jsx)(f.EuiProgress,{"data-test-subj":"guideProgress",label:a?k.i18n.translate("guidedOnboarding.dropdownPanel.completedLabel",{defaultMessage:"Completed"}):k.i18n.translate("guidedOnboarding.dropdownPanel.progressLabel",{defaultMessage:"Progress"}),value:s,valueText:k.i18n.translate("guidedOnboarding.dropdownPanel.progressValueLabel",{defaultMessage:"{stepCount} steps",values:{stepCount:`${s} / ${e.steps.length}`}}),max:e.steps.length,size:"l"}),Object(x.jsx)(f.EuiSpacer,{size:"s"})),Object(x.jsx)(f.EuiHorizontalRule,null),Object(x.jsx)("ol",{css:u},null==e?void 0:e.steps.map(((t,s)=>{var a;const o=Object(f.htmlIdGenerator)(`accordion${s}`)(),u=null==i||null===(a=i.activeGuide)||void 0===a?void 0:a.steps[s];if(u)return Object(x.jsx)("li",{key:o},Object(x.jsx)(ue,{isLoading:n,accordionId:o,stepStatus:u.status,stepConfig:t,stepNumber:s+1,handleButtonClick:()=>r(u,t),telemetryGuideId:e.telemetryId}))}))))};var le=i(19),ce=i.n(le);const pe=({styles:e,guideConfig:t,isDarkTheme:i,stepsCompleted:n,isGuideReadyToComplete:s,pluginState:a,handleStepButtonClick:r,isLoading:u,completeGuide:d})=>{const l=()=>t&&t.docs?Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)(f.EuiSpacer,{size:"m"}),Object(x.jsx)(f.EuiText,{size:"m"},Object(x.jsx)(f.EuiLink,{external:!0,target:"_blank",href:t.docs.url},t.docs.text))):null;return!t||!a||a&&"error"===a.status?Object(x.jsx)(f.EuiEmptyPrompt,{"data-test-subj":"guideErrorSection",iconType:"alert",color:"danger",title:Object(x.jsx)("h2",null,k.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionTitle",{defaultMessage:"Unable to load the guide"})),body:Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)(f.EuiText,{color:"subdued"},k.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionDescription",{defaultMessage:"Wait a moment and try again. If the problem persists, contact your administrator."})),Object(x.jsx)(f.EuiSpacer,null),Object(x.jsx)(f.EuiButton,{iconSide:"right",onClick:()=>window.location.reload(),iconType:"refresh",color:"danger"},k.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionReloadButton",{defaultMessage:"Reload"})))}):s?Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)(f.EuiImage,{size:"l",src:i?ae.a:ce.a,alt:k.i18n.translate("guidedOnboarding.dropdownPanel.wellDoneAnimatedGif",{defaultMessage:"Guide completed animated gif"})}),Object(x.jsx)(f.EuiSpacer,null),Object(x.jsx)(f.EuiText,{size:"m"},Object(x.jsx)("p",{"data-test-subj":"guideDescription"},k.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutDescription",{defaultMessage:"You've completed the Elastic {guideName} guide. Feel free to come back to the Guides for more onboarding help or a refresher.",values:{guideName:t.guideName}}))),l(),Object(x.jsx)(f.EuiSpacer,null),Object(x.jsx)(f.EuiFlexGroup,{justifyContent:"flexStart"},Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiButton,{isLoading:u,onClick:()=>d(t.completedGuideRedirectLocation),fill:!0,"data-test-subj":`onboarding--completeGuideButton--${t.telemetryId}`},k.i18n.translate("guidedOnboarding.dropdownPanel.elasticButtonLabel",{defaultMessage:"Continue using Elastic"})))),Object(x.jsx)(f.EuiSpacer,null)):Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)("div",null,Object(x.jsx)(f.EuiText,{size:"m"},Object(x.jsx)("p",{"data-test-subj":"guideDescription"},t.description)),l(),Object(x.jsx)(de,{guideConfig:t,styles:e,pluginState:a,isLoading:u,handleStepButtonClick:r,isGuideReadyToComplete:s,stepsCompleted:n})))},ge=({styles:e,euiTheme:t,openQuitGuideModal:i})=>Object(x.jsx)("div",{css:e.flyoutOverrides.flyoutFooter},Object(x.jsx)(f.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"xs",responsive:!1,wrap:!0},Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiButtonEmpty,{iconType:"questionInCircle",iconSide:"right",href:"https://cloud.elastic.co/support ",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"m"},k.i18n.translate("guidedOnboarding.dropdownPanel.footer.support",{defaultMessage:"Need help?"}))),Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiText,{size:"xs",color:t.colors.disabled},"|")),Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiButtonEmpty,{iconType:"faceHappy",iconSide:"right",href:"https://www.elastic.co/kibana/feedback",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},k.i18n.translate("guidedOnboarding.dropdownPanel.footer.feedback",{defaultMessage:"Give feedback"}))),Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiText,{size:"xs",color:t.colors.disabled},"|")),Object(x.jsx)(f.EuiFlexItem,{grow:!1},Object(x.jsx)(f.EuiButtonEmpty,{iconType:"exit",iconSide:"right",onClick:i,"data-test-subj":"quitGuideButton",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},k.i18n.translate("guidedOnboarding.dropdownPanel.footer.exitGuideButtonLabel",{defaultMessage:"Quit guide"}))))),be=({isOpen:e,isDarkTheme:t,toggleGuide:i,isGuideReadyToComplete:n,guideConfig:s,styles:a,navigateToLandingPage:o,stepsCompleted:r,pluginState:u,handleStepButtonClick:d,isLoading:l,euiTheme:c,openQuitGuideModal:p,completeGuide:g})=>{if(!e)return null;const b="onboarding-guide",j=Object(x.jsx)(f.EuiButtonEmpty,{onClick:o,iconSide:"left",iconType:"arrowLeft",flush:"left",color:"text"},k.i18n.translate("guidedOnboarding.dropdownPanel.backToGuidesLink",{defaultMessage:"Back to guides"})),h=!s||!u||u&&"error"===u.status,{flyoutContentWrapper:m,flyoutBody:O,flyoutBodyWrapper:v,flyoutContainerError:y,flyoutContainer:S}=a.flyoutOverrides;return Object(x.jsx)(f.EuiPortal,null,Object(x.jsx)(f.EuiOverlayMask,null,Object(x.jsx)(f.EuiFocusTrap,{onClickOutside:i},Object(x.jsx)(f.EuiPanel,{"data-test-subj":"guidePanel","aria-labelledby":b,role:"dialog",css:h?y:S},Object(x.jsx)("div",{css:m},Object(x.jsx)(ne,{styles:a,titleId:b,toggleGuide:i,guideConfig:s,isGuideReadyToComplete:n,backButton:j,hasError:h}),Object(x.jsx)("div",{css:v},Object(x.jsx)("div",{css:O},Object(x.jsx)(pe,{styles:a,guideConfig:s,pluginState:u,handleStepButtonClick:d,isLoading:l,isDarkTheme:t,stepsCompleted:r,isGuideReadyToComplete:n,completeGuide:g}))),!h&&Object(x.jsx)(ge,{styles:a,euiTheme:c,openQuitGuideModal:p}))))))},fe=/\{(.*?)\}/g,je=/[\{\}]/g,he=(e,t)=>{var i;if(null!==(i=t.activeGuide)&&void 0!==i&&i.params){let i=e;const s=e.match(fe);if(s){for(const e of s){var n;const s=e.replace(je,"");i=i.replace(`${e}`,null===(n=t.activeGuide)||void 0===n?void 0:n.params[s])}return i}}return e},me=({api:e,application:t,notifications:i,theme$:n})=>{var s;const r=Object(f.useEuiTheme)(),u=r.euiTheme,[d,l]=Object(a.useState)(!1),[c,g]=Object(a.useState)(!1),[b,j]=Object(a.useState)(void 0),[h,m]=Object(a.useState)(void 0),[O,v]=Object(a.useState)(!1),{darkMode:y}=p()(n,{darkMode:!1}),S=(({euiThemeContext:e,isDarkTheme:t})=>{const i=e.euiTheme,n=Object(x.css)("position:fixed;height:100%;max-height:76vh;max-inline-size:480px;max-block-size:auto;inset-inline-end:0;inset-block-start:",i.size.xxxl,";",f.euiCanAnimate,"{animation:",f.euiFlyoutSlideInRight," ",i.animation.normal," ",i.animation.resistance,";}@media (max-width: ",i.breakpoint.m,"px){max-height:85vh;})@media (min-width: ",i.breakpoint.m,"px){right:calc(",i.size.s," + 128px);}","");return{setupButton:Object(x.css)("margin-right:",i.size.m,";",""),wellDoneAnimatedPrompt:ee,flyoutOverrides:{flyoutContainer:Object(x.css)(n,";background:",i.colors.emptyShade," url(",t?q.a:W.a,") top right no-repeat;padding:0;",""),flyoutContainerError:Object(x.css)(n,";padding:24px;",""),flyoutHeader:Z,flyoutHeaderError:X,flyoutContentWrapper:J,flyoutCloseButtonIcon:Object(x.css)("position:absolute;inset-block-start:",i.size.base,";inset-inline-end:",i.size.base,";",""),flyoutBodyWrapper:Object(x.css)(Object(f.logicalCSS)("height","100%")," ",Object(f.logicalCSSWithFallback)("overflow-y","hidden")," flex-grow:1;",""),flyoutBody:Object(x.css)(Object(f.euiYScroll)(e)," padding:16px 10px 0 16px;",""),flyoutBodyError:Y,flyoutStepsWrapper:V,flyoutFooter:Object(x.css)("border-radius:0 0 6px 6px;background:url(",t?U.a:K.a,") 0 36px no-repeat;padding:24px 30px;height:125px;flex-grow:0;",""),flyoutFooterLink:Object(x.css)("color:",i.colors.darkShade,";font-weight:400;","")}}})({euiThemeContext:r,isDarkTheme:y}),E=()=>{l((e=>!e))},_=Object(a.useCallback)((async(n,s)=>{if(b){const{id:o,status:r}=n,u=b.activeGuide.guideId;try{if("ready_to_complete"===r)return await e.completeGuideStep(u,o);var a;"active"!==r&&"in_progress"!==r||(await e.startGuideStep(u,o),s.location&&(await t.navigateToApp(s.location.appID,{path:he(s.location.path,b)}),null!==(a=s.manualCompletion)&&void 0!==a&&a.readyToCompleteOnNavigation&&await e.completeGuideStep(u,o)))}catch(e){i.toasts.addDanger({title:k.i18n.translate("guidedOnboarding.dropdownPanel.stepHandlerError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),[e,t,i.toasts,b]),C=()=>{l(!1),t.navigateToApp("home",{path:"#getting_started"})};Object(a.useEffect)((()=>{const t=e.fetchPluginState$().subscribe((e=>{j(e)}));return()=>t.unsubscribe()}),[e]),Object(a.useEffect)((()=>{const t=e.isLoading$.subscribe((e=>{v(e)}));return()=>t.unsubscribe()}),[e]),Object(a.useEffect)((()=>{const t=e.isGuidePanelOpen$.subscribe((e=>{l(e)}));return()=>t.unsubscribe()}),[e]);const G=Object(a.useCallback)((async()=>{var t;if(null!=b&&null!==(t=b.activeGuide)&&void 0!==t&&t.guideId){const t=await e.getGuideConfig(b.activeGuide.guideId);t&&m(t)}}),[e,b]);Object(a.useEffect)((()=>{G()}),[G]);const w=(P=null==b?void 0:b.activeGuide)?P.steps.reduce(((e,t)=>("complete"===t.status&&(e+=1),e)),0):0;var P;const T="ready_to_complete"===(null==b||null===(s=b.activeGuide)||void 0===s?void 0:s.status);return Object(x.jsx)(o.a.Fragment,null,Object(x.jsx)("div",{css:S.setupButton},Object(x.jsx)(ie,{isLoading:O,pluginState:b,guideConfig:h,toggleGuidePanel:E,isGuidePanelOpen:d,navigateToLandingPage:C})),Object(x.jsx)(be,{isOpen:d,isLoading:O,styles:S,toggleGuide:E,isDarkTheme:y,stepsCompleted:w,isGuideReadyToComplete:T,guideConfig:h,navigateToLandingPage:C,pluginState:b,handleStepButtonClick:_,openQuitGuideModal:()=>{l(!1),g(!0)},euiTheme:u,completeGuide:async n=>{try{if(await e.completeGuide(b.activeGuide.guideId),n){const{appID:e,path:i}=n;t.navigateToApp(e,{path:i})}}catch(e){i.toasts.addDanger({title:k.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),c&&Object(x.jsx)(A,{closeModal:()=>{g(!1)},currentGuide:b.activeGuide,telemetryGuideId:h.telemetryId,notifications:i}))};class plugin_GuidedOnboardingPlugin{constructor(){}setup(e,{cloud:t}){return{cloud:t}}start(e,{cloud:t}){const{chrome:i,http:n,application:s,notifications:a}=e,o=!(null==t||!t.isCloudEnabled||!s.capabilities.guidedOnboardingFeature.enabled);return F.setup(n,o),o&&i.navControls.registerExtension({order:1e3,mount:t=>this.mount({startServices:e,targetDomElement:t,api:F,application:s,notifications:a})}),{guidedOnboardingApi:F}}stop(){}mount({startServices:e,targetDomElement:t,api:i,application:n,notifications:a}){const{theme:o}=e;return s.a.render(Object(x.jsx)(w,e,Object(x.jsx)(me,{api:i,application:n,notifications:a,theme$:o.theme$})),t),()=>s.a.unmountComponentAtNode(t)}}function xe(){return new plugin_GuidedOnboardingPlugin}}]);