/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[22],{1254:function(e,t,a){"use strict";a.r(t),a.d(t,"APM_ALERTING_FAILED_TRANSACTIONS_CHART_EMBEDDABLE",(function(){return y})),a.d(t,"getApmAlertingFailedTransactionsChartEmbeddableFactory",(function(){return g}));var n=a(1),r=a.n(n),i=a(263),o=a(12),s=a(252),c=a(7),l=a.n(c),u=a(42),m=a(248),d=a(253),p=a(254),T=a(255),E=a(10);function v({rule:e,alert:t,serviceName:a,environment:n=E.a.value,rangeFrom:i="now-15m",rangeTo:o="now",transactionType:s,transactionName:c,kuery:v="",filters:y}){const g=t.fields[u.d]?l()(t.fields[u.d]).valueOf():void 0,{transactionType:f,transactionTypes:b,setTransactionType:A,comparisonChartTheme:S,timeZone:h}=Object(d.a)({rule:e,serviceName:a,rangeFrom:i,rangeTo:o,kuery:v,defaultTransactionType:s});return i&&o?a&&f?r.a.createElement(m.a,{transactionType:f,transactionTypes:b,setTransactionType:A,transactionName:c,serviceName:a,environment:n,start:i,end:o,comparisonChartTheme:S,timeZone:h,kuery:v,filters:y,alertStart:t.start,alertEnd:g}):r.a.createElement(T.a,null):r.a.createElement(p.a,null)}const y="APM_ALERTING_FAILED_TRANSACTIONS_CHART_EMBEDDABLE",g=e=>({type:y,deserializeState:e=>e.rawState,buildEmbeddable:async(t,a,n,c)=>{const{titlesApi:l,titleComparators:u,serializeTitles:m}=Object(i.a)(t),d=new o.BehaviorSubject(t.serviceName),p=new o.BehaviorSubject(t.transactionType),T=new o.BehaviorSubject(t.transactionName),E=new o.BehaviorSubject(t.environment),y=new o.BehaviorSubject(t.rangeFrom),g=new o.BehaviorSubject(t.rangeTo),f=new o.BehaviorSubject(t.rule),b=new o.BehaviorSubject(t.alert),A=new o.BehaviorSubject(t.kuery),S=new o.BehaviorSubject(t.filters);return{api:a({...l,serializeState:()=>({rawState:{...m(),serviceName:d.getValue(),transactionType:p.getValue(),transactionName:T.getValue(),environment:E.getValue(),rangeFrom:y.getValue(),rangeTo:g.getValue(),rule:f.getValue(),alert:b.getValue(),kuery:A.getValue(),filters:S.getValue()}})},{serviceName:[d,e=>d.next(e)],transactionType:[p,e=>p.next(e)],transactionName:[T,e=>T.next(e)],environment:[E,e=>E.next(e)],rangeFrom:[y,e=>y.next(e)],rangeTo:[g,e=>g.next(e)],rule:[f,e=>f.next(e)],alert:[b,e=>b.next(e)],kuery:[A,e=>A.next(e)],filters:[S,e=>S.next(e)],...u}),Component:()=>{const[t,a,n,o,c,l,u,m,h,x]=Object(i.b)(d,p,T,E,y,g,f,b,A,S);return r.a.createElement(s.a,{deps:e,rangeFrom:c,rangeTo:l},r.a.createElement(v,{rule:u,alert:m,serviceName:t,transactionType:a,environment:o,rangeFrom:c,rangeTo:l,transactionName:n,kuery:h,filters:x}))}}}})},164:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="HH:mm:ss"},248:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(249),o=a.n(i),s=a(11),c=a(0),l=a(19),u=a(563),m=a(564),d=a(17),p=a(164),T=a(74),E=a(86),v=a(148),y=a(142),g=a(151),f=a(108),b=a(98),A=a(152),S=a(153);const h={currentPeriod:{timeseries:[],average:null},previousPeriod:{timeseries:[],average:null}};t.a=function({transactionType:e,transactionTypes:t,setTransactionType:a,transactionName:n,serviceName:i,environment:x,start:N,end:j,comparisonChartTheme:F,timeZone:w,kuery:k="",filters:I,alertStart:_,alertEnd:O}){const{euiTheme:R}=Object(s.useEuiTheme)(),{services:{uiSettings:B}}=Object(d.useKibana)(),{currentPeriodColor:C}=E.b(E.a.FAILED_TRANSACTION_RATE),D=Object(f.a)({start:N,end:j,kuery:k,numBuckets:100,type:n?b.a.TransactionMetric:b.a.ServiceTransactionMetric}),{data:V=h,status:M}=Object(T.d)((t=>{if(e&&i&&N&&j&&D)return t("GET /internal/apm/services/{serviceName}/transactions/charts/error_rate",{params:{path:{serviceName:i},query:{environment:x,kuery:k,filters:I?JSON.stringify(I):void 0,start:N,end:j,transactionType:e,transactionName:n,documentType:D.source.documentType,rollupInterval:D.source.rollupInterval,bucketSizeInSeconds:D.bucketSizeInSeconds}}})}),[x,i,N,j,e,n,D,k,I]),z=[{data:V.currentPeriod.timeseries,type:"linemark",color:C,title:c.i18n.translate("xpack.apm.errorRate.chart.errorRate",{defaultMessage:"Failed transaction rate (avg.)"})}],L=a&&t;return r.a.createElement(s.EuiFlexItem,null,r.a.createElement(s.EuiPanel,{hasBorder:!0},r.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiTitle,{size:"xs"},r.a.createElement("h2",null,c.i18n.translate("xpack.apm.errorRate",{defaultMessage:"Failed transaction rate"})))),r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiIconTip,{content:v.b,position:"right"})),L&&r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(A.a,{transactionType:e,transactionTypes:t,onChange:a})),r.a.createElement(s.EuiFlexItem,null,r.a.createElement(s.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(S.a,{serviceName:i,environment:x,from:N,to:j,kuery:k,transactionName:n,transactionType:e}))))),r.a.createElement(y.a,{id:"errorRate",height:200,showAnnotations:!0,annotations:(()=>{if(_)return[r.a.createElement(u.a,{alertStart:_,alertEnd:O,color:o()(Object(s.transparentize)("#F04E981A",.2)).hex().toUpperCase(),id:"alertActiveRect",key:"alertActiveRect"}),r.a.createElement(m.a,{key:"alertAnnotationStart",id:"alertAnnotationStart",alertStart:_,color:R.colors.danger,dateFormat:B&&B.get(l.UI_SETTINGS.DATE_FORMAT)||p.a})]})(),fetchStatus:M,timeseries:z,yLabelFormat:g.c,yDomain:{min:0,max:1},comparisonEnabled:!1,customTheme:F,timeZone:w})))}},249:function(e,t,a){e.exports=a(25)(71)},563:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a(1);var n=a(36),r=a(0),i=a(31);const o=r.i18n.translate("observabilityAlertDetails.alertActiveTimeRangeAnnotation.detailsTooltip",{defaultMessage:"Active"});function s({alertStart:e,alertEnd:t,color:a,id:r}){return Object(i.jsx)(n.RectAnnotation,{id:r,dataValues:[{coordinates:{y0:0,x0:e,x1:t},details:o}],style:{fill:a,opacity:.1}})}},564:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a(1);var n=a(7),r=a.n(n),i=a(0),o=a(36),s=a(11),c=a(31);const l=i.i18n.translate("observabilityAlertDetails.alertAnnotation.detailsTooltip",{defaultMessage:"Alert started"});function u({alertStart:e,color:t,dateFormat:a,id:n}){return Object(c.jsx)(o.LineAnnotation,{id:n,domainType:o.AnnotationDomainType.XDomain,dataValues:[{dataValue:e,header:r()(e).format(a),details:l}],style:{line:{strokeWidth:3,stroke:t,opacity:1}},marker:Object(c.jsx)(s.EuiIcon,{type:"warning",color:t}),markerPosition:o.Position.Top})}}}]);