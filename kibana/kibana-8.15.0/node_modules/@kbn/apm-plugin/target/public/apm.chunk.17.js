/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[17],{1249:function(e,t,a){"use strict";a.r(t),a.d(t,"AlertDetailsAppSection",(function(){return x}));var n=a(11),r=a(33),i=a(43),o=a(42),s=a(250),c=a(1),l=a.n(c),u=a(17),m=a(7),d=a.n(m);const p=(e,t,a)=>{const n=d.a.duration(d()(t).diff(d()(e))),r=d()().toISOString(),i=n.asMinutes()<160?d.a.duration(20,"minutes").asMilliseconds():n.asMilliseconds()/8,o=a&&d.a.duration(20*a.size,a.unit).asMilliseconds(),s=o&&o-i>0?o:i;return{from:d()(e).subtract(s,"millisecond").toISOString(),to:t&&d()(t).add(s,"millisecond").isBefore(r)?d()(t).add(s,"millisecond").toISOString():r}};var f=a(14),E=a(96),y=a(157),v=a(111),g=a(248),h=a(151),T=a(267),b=a(251),S=a(85);function x({rule:e,alert:t,timeZone:a,setAlertSummaryFields:m}){const{services:d}=Object(u.useKibana)();Object(S.createCallApmApi)(d);const x=t.fields[o.r],A=t.fields[s.b],k=t.fields[s.a],F=t.fields[f.v],I=String(t.fields[f.x]),O=t.fields[f.L],j=t.fields[f.M];Object(c.useEffect)((()=>{const e=[{label:l.a.createElement(r.FormattedMessage,{id:"xpack.apm.pages.alertDetails.alertSummary.actualValue",defaultMessage:"Actual value"}),value:Object(i.formatAlertEvaluationValue)(x,A)},{label:l.a.createElement(r.FormattedMessage,{id:"xpack.apm.pages.alertDetails.alertSummary.expectedValue",defaultMessage:"Expected value"}),value:Object(i.formatAlertEvaluationValue)(x,k)}];m(e)}),[x,A,k,F,I,O,m]);const N=e.params,M=Object(h.a)(N.aggregationType),w=p(t.fields[o.t],t.fields[o.d]),C=Object(v.a)(),{from:$,to:D}=w;return $&&D?l.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},l.a.createElement(y.c,{start:$,end:D,kuery:"",useSpanName:!1,uiSettings:d.uiSettings},l.a.createElement(E.b,null,l.a.createElement(n.EuiFlexItem,null,l.a.createElement(T.a,{alert:t,transactionType:j,transactionName:O,serviceName:I,environment:F,start:$,end:D,comparisonChartTheme:C,timeZone:a,latencyAggregationType:M,comparisonEnabled:!1,offset:""}),l.a.createElement(n.EuiSpacer,{size:"s"}),l.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"s"},l.a.createElement(b.a,{transactionType:j,transactionName:O,serviceName:I,environment:F,start:$,end:D,comparisonChartTheme:C,comparisonEnabled:!1,offset:"",timeZone:a}),l.a.createElement(g.a,{transactionType:j,transactionName:O,serviceName:I,environment:F,start:$,end:D,comparisonChartTheme:C,timeZone:a})))))):l.a.createElement(n.EuiCallOut,{title:l.a.createElement(r.FormattedMessage,{id:"xpack.apm.alertDetails.error.toastTitle",defaultMessage:"An error occurred when identifying the alert time range."}),color:"danger",iconType:"error"},l.a.createElement("p",null,l.a.createElement(r.FormattedMessage,{id:"xpack.apm.alertDetails.error.toastDescription",defaultMessage:"Unable to load the alert details page's charts. Please try to refresh the page if the alert is newly created"})))}t.default=x},151:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s}));var n=a(15),r=a(109);const i=e=>"95th"===e?r.a.p95:"99th"===e?r.a.p99:r.a.avg,o=e=>"apm.transaction_duration"===e,s=e=>Object(n.asPercent)(e||0,1)},152:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),r=a(11),i=a(1),o=a.n(i);function s({transactionType:e,transactionTypes:t,onChange:a}){const i=t.map((e=>({text:e,value:e})));return o.a.createElement(r.EuiSelect,{style:{minWidth:160},compressed:!0,"data-test-subj":"alertingFilterTransactionType",prepend:n.i18n.translate("xpack.apm.alertingVisualizations.transactionType.prepend",{defaultMessage:"Transaction Type"}),onChange:e=>a(e.target.value),options:i,value:e})}},153:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),r=a.n(n),i=a(33),o=a(11),s=a(17),c=a(21);function l({serviceName:e,environment:t,transactionName:a,transactionType:n,from:l,to:u,kuery:m}){var d,p;const{services:{share:f}}=Object(s.useKibana)(),E=null==f||null===(d=f.url)||void 0===d||null===(p=d.locators)||void 0===p?void 0:p.get(c.b);return E?r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"apmAlertDetailsPageViewInApp",onClick:()=>E.navigate({serviceName:e,serviceOverviewTab:a?"transactions":void 0,query:{environment:t,rangeFrom:l,rangeTo:u,kuery:m,transactionName:a,transactionType:n}}),iconType:"sortRight",color:"text"},r.a.createElement(i.FormattedMessage,{id:"xpack.apm.alertDetails.viewInApm",defaultMessage:"View in APM"})):null}},164:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="HH:mm:ss"},183:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return f})),a.d(t,"h",(function(){return E})),a.d(t,"i",(function(){return y})),a.d(t,"j",(function(){return v})),a.d(t,"k",(function(){return g})),a.d(t,"l",(function(){return h})),a.d(t,"m",(function(){return T})),a.d(t,"n",(function(){return b})),a.d(t,"o",(function(){return S})),a.d(t,"p",(function(){return x})),a.d(t,"q",(function(){return A})),a.d(t,"r",(function(){return k})),a.d(t,"s",(function(){return F})),a.d(t,"t",(function(){return C})),a.d(t,"u",(function(){return w})),a.d(t,"v",(function(){return j})),a.d(t,"w",(function(){return M})),a.d(t,"x",(function(){return O})),a.d(t,"y",(function(){return N})),a.d(t,"z",(function(){return $})),a.d(t,"A",(function(){return D})),a.d(t,"B",(function(){return z})),a.d(t,"C",(function(){return r})),a.d(t,"D",(function(){return i})),a.d(t,"E",(function(){return o})),a.d(t,"F",(function(){return s}));var n=a(42);const r="ecs.version",i="event.action",o="event.kind",s="tags",c=`${n.h}.risk_score`,l=`${n.n}.author`,u=`${n.n}.created_at`,m=`${n.n}.created_by`,d=`${n.n}.description`,p=`${n.n}.enabled`,f=`${n.n}.from`,E=`${n.n}.interval`,y=`${n.n}.license`,v=`${n.n}.note`,g=`${n.n}.references`,h=`${n.n}.rule_id`,T=`${n.n}.rule_name_override`,b=`${n.n}.to`,S=`${n.n}.type`,x=`${n.n}.updated_at`,A=`${n.n}.updated_by`,k=`${n.n}.version`,F=`${n.h}.severity`,I=`${n.h}.suppression`,O=`${I}.terms`,j=`${O}.field`,N=`${O}.value`,M=`${I}.start`,w=`${I}.end`,C=`${I}.docs_count`,$=`${n.h}.system_status`,D=`${n.h}.workflow_reason`,z=`${n.h}.workflow_user`;n.h},248:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(249),o=a.n(i),s=a(11),c=a(0),l=a(19),u=a(563),m=a(564),d=a(17),p=a(164),f=a(74),E=a(86),y=a(148),v=a(142),g=a(151),h=a(108),T=a(98),b=a(152),S=a(153);const x={currentPeriod:{timeseries:[],average:null},previousPeriod:{timeseries:[],average:null}};t.a=function({transactionType:e,transactionTypes:t,setTransactionType:a,transactionName:n,serviceName:i,environment:A,start:k,end:F,comparisonChartTheme:I,timeZone:O,kuery:j="",filters:N,alertStart:M,alertEnd:w}){const{euiTheme:C}=Object(s.useEuiTheme)(),{services:{uiSettings:$}}=Object(d.useKibana)(),{currentPeriodColor:D}=E.b(E.a.FAILED_TRANSACTION_RATE),z=Object(h.a)({start:k,end:F,kuery:j,numBuckets:100,type:n?T.a.TransactionMetric:T.a.ServiceTransactionMetric}),{data:_=x,status:P}=Object(f.d)((t=>{if(e&&i&&k&&F&&z)return t("GET /internal/apm/services/{serviceName}/transactions/charts/error_rate",{params:{path:{serviceName:i},query:{environment:A,kuery:j,filters:N?JSON.stringify(N):void 0,start:k,end:F,transactionType:e,transactionName:n,documentType:z.source.documentType,rollupInterval:z.source.rollupInterval,bucketSizeInSeconds:z.bucketSizeInSeconds}}})}),[A,i,k,F,e,n,z,j,N]),R=[{data:_.currentPeriod.timeseries,type:"linemark",color:D,title:c.i18n.translate("xpack.apm.errorRate.chart.errorRate",{defaultMessage:"Failed transaction rate (avg.)"})}],G=a&&t;return r.a.createElement(s.EuiFlexItem,null,r.a.createElement(s.EuiPanel,{hasBorder:!0},r.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiTitle,{size:"xs"},r.a.createElement("h2",null,c.i18n.translate("xpack.apm.errorRate",{defaultMessage:"Failed transaction rate"})))),r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiIconTip,{content:y.b,position:"right"})),G&&r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(b.a,{transactionType:e,transactionTypes:t,onChange:a})),r.a.createElement(s.EuiFlexItem,null,r.a.createElement(s.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(S.a,{serviceName:i,environment:A,from:k,to:F,kuery:j,transactionName:n,transactionType:e}))))),r.a.createElement(v.a,{id:"errorRate",height:200,showAnnotations:!0,annotations:(()=>{if(M)return[r.a.createElement(u.a,{alertStart:M,alertEnd:w,color:o()(Object(s.transparentize)("#F04E981A",.2)).hex().toUpperCase(),id:"alertActiveRect",key:"alertActiveRect"}),r.a.createElement(m.a,{key:"alertAnnotationStart",id:"alertAnnotationStart",alertStart:M,color:C.colors.danger,dateFormat:$&&$.get(l.UI_SETTINGS.DATE_FORMAT)||p.a})]})(),fetchStatus:P,timeseries:R,yLabelFormat:g.c,yDomain:{min:0,max:1},comparisonEnabled:!1,customTheme:I,timeZone:O})))}},249:function(e,t,a){e.exports=a(25)(71)},250:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(42),r=a(183);n.n,n.h;const i=`${n.h}.evaluation.threshold`,o=`${n.h}.evaluation.value`;n.h,n.h,n.h,n.n,n.n,n.A,n.h,n.n,r.C,r.E,r.D,r.F,n.C,n.a,n.c,n.d,n.e,n.g,n.f,n.k,n.p,n.i,r.a,n.b,r.b,r.c,r.d,r.e,r.f,n.l,r.g,r.h,r.i,n.m,r.j,n.o,r.k,r.l,r.m,n.q,r.n,r.o,n.r,r.p,r.q,r.r,n.t,n.v,r.s,n.u,r.z,n.w,n.x,r.A,n.y,n.z,r.B,n.s,n.j,r.x,r.v,r.y,r.w,r.u,r.t,n.B,n.D},251:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(11),o=a(0),s=a(86),c=a(74),l=a(142),u=a(108),m=a(98),d=a(9),p=a(152),f=a(153);const E={currentPeriod:[],previousPeriod:[]};t.a=function({transactionType:e,transactionTypes:t,setTransactionType:a,transactionName:n,serviceName:y,environment:v,start:g,end:h,comparisonChartTheme:T,comparisonEnabled:b,offset:S,timeZone:x,kuery:A="",filters:k}){const F=Object(u.a)({start:g,end:h,numBuckets:100,kuery:A,type:n?m.a.TransactionMetric:m.a.ServiceTransactionMetric}),{data:I=E,status:O}=Object(c.d)((t=>{if(y&&e&&g&&h&&F)return t("GET /internal/apm/services/{serviceName}/throughput",{params:{path:{serviceName:y},query:{environment:v,kuery:A,filters:k?JSON.stringify(k):void 0,start:g,end:h,transactionType:e,transactionName:n,documentType:F.source.documentType,rollupInterval:F.source.rollupInterval,bucketSizeInSeconds:F.bucketSizeInSeconds}}})}),[v,y,g,h,e,n,F,A,k]),{currentPeriodColor:j,previousPeriodColor:N}=Object(s.b)(s.a.THROUGHPUT),M=[{data:I.currentPeriod,type:"linemark",color:j,title:o.i18n.translate("xpack.apm.serviceOverview.throughtputChartTitle",{defaultMessage:"Throughput"})},...b?[{data:I.previousPeriod,type:"area",color:N,title:""}]:[]],w=a&&t;return r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h2",null,o.i18n.translate("xpack.apm.serviceOverview.throughtputChartTitle",{defaultMessage:"Throughput"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiIconTip,{content:o.i18n.translate("xpack.apm.serviceOverview.tpmHelp",{defaultMessage:"Throughput is measured in transactions per minute (tpm)."}),position:"right"})),w&&r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(p.a,{transactionType:e,transactionTypes:t,onChange:a})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(f.a,{serviceName:y,environment:v,from:g,to:h,kuery:A,transactionName:n,transactionType:e}))))),r.a.createElement(l.a,{id:"throughput",height:200,comparisonEnabled:b,offset:S,fetchStatus:O,customTheme:T,timeseries:M,yLabelFormat:d.g,timeZone:x})))}},267:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(11),o=a(0),s=a(15),c=a(250),l=a(42),u=a(36),m=a(31);const d=o.i18n.translate("observabilityAlertDetails.alertThresholdTimeRangeRect.detailsTooltip",{defaultMessage:"Threshold"});function p({color:e,id:t,threshold:a}){return Object(m.jsx)(u.RectAnnotation,{id:t,zIndex:2,dataValues:[{coordinates:{y0:a},details:d}],style:{fill:e,opacity:.1}})}const f=o.i18n.translate("observabilityAlertDetails.alertThresholdAnnotation.detailsTooltip",{defaultMessage:"Alert started"});function E({threshold:e,color:t,id:a}){return Object(m.jsx)(u.LineAnnotation,{id:a,domainType:u.AnnotationDomainType.YDomain,dataValues:[{dataValue:e,header:String(e),details:f}],style:{line:{opacity:.5,strokeWidth:1,stroke:t}}})}var y=a(563),v=a(564),g=a(17),h=a(19),T=a(7),b=a.n(T),S=a(170),x=a(244),A=a(142),k=a(123),F=a(84),I=a(74),O=a(243),j=a(109),N=a(151),M=a(98),w=a(108),C=a(164),$=a(152),D=a(153);t.a=function({alert:e,transactionType:t,transactionTypes:a,transactionName:u,serviceName:m,environment:d,start:f,end:T,latencyAggregationType:z,setLatencyAggregationType:_,setTransactionType:P,comparisonChartTheme:R,comparisonEnabled:G,offset:V,timeZone:B,customAlertEvaluationThreshold:L,kuery:Z="",filters:q}){const U=Object(w.a)({start:f,end:T,kuery:"",numBuckets:100,type:u?M.a.TransactionMetric:M.a.ServiceTransactionMetric}),{euiTheme:H}=Object(i.useEuiTheme)(),{services:{uiSettings:K}}=Object(g.useKibana)(),{data:J,status:W}=Object(I.d)((e=>{if(m&&f&&T&&t&&z&&U)return e("GET /internal/apm/services/{serviceName}/transactions/charts/latency",{params:{path:{serviceName:m},query:{environment:d,kuery:Z,filters:q?JSON.stringify(q):void 0,start:f,end:T,transactionType:t,transactionName:u,latencyAggregationType:z,documentType:U.source.documentType,rollupInterval:U.source.rollupInterval,bucketSizeInSeconds:U.bucketSizeInSeconds,useDurationSummary:U.source.hasDurationSummaryField&&z===j.a.avg}}})}),[T,d,z,m,f,t,u,U,Z,q]),X=L||e.fields[c.a],Y=e.fields[l.d]?b()(e.fields[l.d]).valueOf():void 0,Q=X?[r.a.createElement(p,{key:"alertThresholdRect",id:"alertThresholdRect",threshold:X,color:H.colors.danger}),r.a.createElement(E,{id:"alertThresholdAnnotation",key:"alertThresholdAnnotation",color:H.colors.danger,threshold:X})]:[],ee=Object(n.useMemo)((()=>Object(O.a)({latencyChart:J,latencyAggregationType:z,previousPeriodLabel:""})),[J,z]),{currentPeriod:te,previousPeriod:ae}=ee,ne=[te,G&&Object(F.e)(V)?ae:void 0].filter(S.b),re=Object(k.a)(ne),ie=Object(s.getDurationFormatter)(re),oe=a&&P;return r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h2",null,o.i18n.translate("xpack.apm.dependencyLatencyChart.chartTitle",{defaultMessage:"Latency"})))),_&&r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(x.a,{latencyAggregationType:z,onChange:_})),oe&&r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement($.a,{transactionType:t,transactionTypes:a,onChange:P})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(D.a,{serviceName:m,environment:d,from:f,to:T,kuery:Z,transactionName:u,transactionType:t}))))),r.a.createElement(A.a,{id:"latencyChart",annotations:(()=>{if(Object(N.b)(e.fields[l.r])||L)return[r.a.createElement(y.a,{alertStart:e.start,alertEnd:Y,color:H.colors.danger,id:"alertActiveRect",key:"alertActiveRect"}),r.a.createElement(v.a,{key:"alertAnnotationStart",id:"alertAnnotationStart",alertStart:e.start,color:H.colors.danger,dateFormat:K&&K.get(h.UI_SETTINGS.DATE_FORMAT)||C.a}),...Q]})(),height:200,comparisonEnabled:G,offset:V,fetchStatus:W,customTheme:R,timeseries:ne,yLabelFormat:Object(k.b)(ie),timeZone:B})))}},563:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a(1);var n=a(36),r=a(0),i=a(31);const o=r.i18n.translate("observabilityAlertDetails.alertActiveTimeRangeAnnotation.detailsTooltip",{defaultMessage:"Active"});function s({alertStart:e,alertEnd:t,color:a,id:r}){return Object(i.jsx)(n.RectAnnotation,{id:r,dataValues:[{coordinates:{y0:0,x0:e,x1:t},details:o}],style:{fill:a,opacity:.1}})}},564:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a(1);var n=a(7),r=a.n(n),i=a(0),o=a(36),s=a(11),c=a(31);const l=i.i18n.translate("observabilityAlertDetails.alertAnnotation.detailsTooltip",{defaultMessage:"Alert started"});function u({alertStart:e,color:t,dateFormat:a,id:n}){return Object(c.jsx)(o.LineAnnotation,{id:n,domainType:o.AnnotationDomainType.XDomain,dataValues:[{dataValue:e,header:r()(e).format(a),details:l}],style:{line:{strokeWidth:3,stroke:t,opacity:1}},marker:Object(c.jsx)(s.EuiIcon,{type:"warning",color:t}),markerPosition:o.Position.Top})}}}]);