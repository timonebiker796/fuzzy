/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[6],{1153:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(40),r=a(546),o=n.__importDefault(a(1154));t.default=function(e,t){o.default(e,t,r.isDeepEqual)}},1154:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1);t.default=function(e,t,a){var r=n.useRef(void 0);r.current&&a(t,r.current)||(r.current=t),n.useEffect(e,r.current)}},138:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(0),r=(a(15),a(113)),o=a(126),l=a(73),i=(a(14),a(10),a(136));const s="apm";let c=function(e){return e.Avg="avg",e.P95="95th",e.P99="99th",e}({});const u="threshold_met",p={id:u,name:n.i18n.translate("xpack.apm.a.thresholdMet",{defaultMessage:"Threshold met"})},m={[l.a.ErrorCount]:{name:n.i18n.translate("xpack.apm.errorCountAlert.name",{defaultMessage:"Error count threshold"}),actionGroups:[p],defaultActionGroupId:u,minimumLicenseRequired:"basic",producer:s,isExportable:!0},[l.a.TransactionDuration]:{name:n.i18n.translate("xpack.apm.transactionDurationAlert.name",{defaultMessage:"Latency threshold"}),actionGroups:[p],defaultActionGroupId:u,minimumLicenseRequired:"basic",producer:s,isExportable:!0},[l.a.Anomaly]:{name:n.i18n.translate("xpack.apm.anomalyAlert.name",{defaultMessage:"APM Anomaly"}),actionGroups:[p],defaultActionGroupId:u,minimumLicenseRequired:"basic",producer:s,isExportable:!0},[l.a.TransactionErrorRate]:{name:n.i18n.translate("xpack.apm.transactionErrorRateAlert.name",{defaultMessage:"Failed transaction rate threshold"}),actionGroups:[p],defaultActionGroupId:u,minimumLicenseRequired:"basic",producer:s,isExportable:!0}},d=[{type:r.a.CRITICAL,label:n.i18n.translate("xpack.apm.alerts.anomalySeverity.criticalLabel",{defaultMessage:"critical"}),threshold:o.a.CRITICAL},{type:r.a.MAJOR,label:n.i18n.translate("xpack.apm.alerts.anomalySeverity.majorLabel",{defaultMessage:"major"}),threshold:o.a.MAJOR},{type:r.a.MINOR,label:n.i18n.translate("xpack.apm.alerts.anomalySeverity.minor",{defaultMessage:"minor"}),threshold:o.a.MINOR},{type:r.a.WARNING,label:n.i18n.translate("xpack.apm.alerts.anomalySeverity.warningLabel",{defaultMessage:"warning"}),threshold:o.a.WARNING}];function b(e){switch(e){case i.a.txLatency:return n.i18n.translate("xpack.apm.alerts.anomalyDetector.latencyLabel",{defaultMessage:"latency"});case i.a.txThroughput:return n.i18n.translate("xpack.apm.alerts.anomalyDetector.throughputLabel",{defaultMessage:"throughput"});case i.a.txFailureRate:return n.i18n.translate("xpack.apm.alerts.anomalyDetector.failedTransactionRateLabel",{defaultMessage:"failed transaction rate"})}}const h=[i.a.txLatency,i.a.txThroughput,i.a.txFailureRate].map((e=>({type:e,label:b(e)})))},264:function(e,t,a){"use strict";a.d(t,"a",(function(){return Xe})),a.d(t,"b",(function(){return Ye}));var n=a(210),r=a(22),o=a(17),l=a(1),i=a.n(l),s=a(79),c=a.n(s),u=a(154),p=a.n(u),m=a(31);const d=i.a.createContext(null),b=({children:e,...t})=>{const{navigateToUrl:a,currentAppId:n}=t;return Object(m.jsx)(d.Provider,{value:{navigateToUrl:a,currentAppId:n}},e)},h=({children:e,coreStart:t})=>{const{navigateToUrl:a,currentAppId$:n}=t.application,r=p()(n,void 0);return Object(m.jsx)(d.Provider,{value:{navigateToUrl:a,currentAppId:r}},e)},g={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},E=({children:e,navigateToUrl:t,currentAppId:a,...n})=>{const r=Object(l.useRef)(null),o=Object(l.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:n})=>{if(!t||!n)return;const r=((e,t)=>{let a=e;do{var n,r;if("a"===(null===(n=a)||void 0===n?void 0:n.tagName.toLowerCase()))return a;const e=null===(r=a)||void 0===r?void 0:r.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!r)return;const o=r.href,l=""===r.target||"_self"===r.target,i=0===e.button;o&&l&&i&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(r.href))})({event:e,currentAppId:a,navigateToUrl:t,container:r.current})),[a,t]);return Object(m.jsx)("div",c()({onClick:o,ref:r,css:g,"data-test-subj":"kbnRedirectAppLink"},n),e)},f=({children:e,...t})=>Object(m.jsx)(E,c()({},function(){const e=Object(l.useContext)(d);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e),v=({children:e,...t})=>{if(void 0!==t.coreStart){const{coreStart:a,...n}=t,r=Object(m.jsx)(f,n,e);return Object(m.jsx)(h,{coreStart:a},r)}const{navigateToUrl:a,currentAppId:n,...r}=t,o=Object(m.jsx)(f,r,e);return Object(m.jsx)(b,{currentAppId:n,navigateToUrl:a},o)};var y=a(56),j=a(18),x=a(32);const k={services:{}},O=Object(l.createContext)(k);var M=a(1153),A=a.n(M);const C=({children:e,component:t,render:a,...n})=>{const r=Object(l.useMemo)((()=>{if(t)return e=>Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(T,null),Object(m.jsx)(t,e))}),[t]);if(r)return Object(m.jsx)(x.Route,c()({},n,{component:r}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(m.jsx)(x.Route,c()({},n,{render:e=>Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(T,null),t(e))}))}return Object(m.jsx)(x.Route,n,Object(m.jsx)(T,null),e)},T=()=>{const{executionContext:e}=Object(l.useContext)(O).services,t=Object(x.useRouteMatch)();return function(e,t){A()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var S=a(100),L=a(48),R=a(37),w=a(11),F=a(215);const I=({kibanaVersion:e,isCloudEnv:t,isServerlessEnv:a})=>{const n=Object(l.useMemo)((()=>({kibanaVersion:e,isCloudEnv:t,isServerlessEnv:a})),[e,t,a]);return({kibanaEnvironment:e={},children:t})=>Object(l.createElement)(F.a.Provider,{value:{...e,...n},children:t})};var P=a(272),_=a(212),D=a(76),U=a(273),N=a(583),B=a(155),H=a(584),G=a(4),z=a.n(G),J=a(0);const q=J.i18n.translate("sharedUXPackages.prompt.errors.notFound.title",{defaultMessage:"Page not found"}),K=J.i18n.translate("sharedUXPackages.prompt.errors.notFound.body",{defaultMessage:"Sorry, the page you're looking for can't be found. It might have been removed or renamed, or maybe it never existed at all."}),V=J.i18n.translate("sharedUXPackages.prompt.errors.notFound.goBacklabel",{defaultMessage:"Go back"}),$=({actions:e,title:t,body:n})=>{const{colorMode:r}=Object(w.useEuiTheme)(),[o,i]=Object(l.useState)(),s=Object(l.useCallback)((()=>history.back()),[]),c=Object(l.useMemo)((()=>[Object(m.jsx)(w.EuiButtonEmpty,{iconType:"arrowLeft",flush:"both",onClick:s},V)]),[s]);Object(l.useEffect)((()=>{(async()=>{if("DARK"===r){const{default:e}=await a.e(36).then(a.t.bind(null,1240,7));i(e)}else{const{default:e}=await a.e(37).then(a.t.bind(null,1241,7));i(e)}})()}),[r]);const u=o?Object(m.jsx)(w.EuiImage,{src:o,alt:""}):null;return Object(m.jsx)(w.EuiEmptyPrompt,{color:"subdued",titleSize:"m",icon:u,title:"string"!=typeof t&&t?t:Object(m.jsx)("h2",null,null!=t?t:q),body:null!=n?n:K,actions:null!=e?e:c})};function W({children:e}){const t=Object(x.useLocation)();return i.a.createElement(apm_error_boundary_ErrorBoundary,{pathname:t.pathname},e)}class apm_error_boundary_ErrorBoundary extends i.a.Component{constructor(...e){super(...e),z()(this,"state",{error:void 0})}componentDidUpdate(e){this.props.pathname!==e.pathname&&void 0!==this.state.error&&this.setState({error:void 0})}static getDerivedStateFromError(e){return{error:e}}render(){return this.state.error?i.a.createElement(Q,{error:this.state.error}):this.props.children}}const X={pageTitle:"APM"};function Q({error:e}){const{services:t}=Object(o.useKibana)(),{observabilityShared:a}=t,n=a.navigation.PageTemplate;return e instanceof S.a?i.a.createElement(n,{pageHeader:X},i.a.createElement($,null)):i.a.createElement(n,{pageHeader:X},i.a.createElement(w.EuiErrorBoundary,null,i.a.createElement(Y,{error:e})))}function Y({error:e}){throw e}var Z=a(580);function ee({children:e}){const t=Object(S.i)();return Object(j.useTrackPageview)({app:"apm",path:t},[t]),Object(j.useTrackPageview)({app:"apm",path:t,delay:15e3},[t]),e}var te=a(15),ae=a(245),ne=a(115),re=a(73),oe=a(138),le=a(547),ie=a(75),se=a(10),ce=a(77);function ue(e){const{addFlyoutVisible:t,setAddFlyoutVisibility:a,ruleType:n}=e,r=Object(le.a)(),{query:s,path:c}=Object(ie.b)("/*"),u="rangeFrom"in s?s.rangeFrom:void 0,p="rangeTo"in s?s.rangeTo:void 0,{start:m,end:d}=Object(ce.a)({rangeFrom:u,rangeTo:p,optional:!0}),b="environment"in s?s.environment:se.a.value,h="transactionType"in s?s.transactionType:void 0,g="transactionName"in s?s.transactionName:void 0,E="groupId"in c?c.groupId:void 0,{services:f}=Object(o.useKibana)(),v=function(e,t){const a=e?oe.e[e].name:void 0,n=a?t?`${a} | ${t}`:a:void 0,r=["apm"];return t&&r.push(`service.name:${t}`.toLowerCase()),{tags:r,...n?{name:n}:{}}}(n,r),y=Object(l.useCallback)((()=>a(!1)),[a]),j=Object(l.useMemo)((()=>n&&f.triggersActionsUi.getAddRuleFlyout({consumer:oe.c,onClose:y,ruleTypeId:n,canChangeTrigger:!1,initialValues:v,metadata:{environment:b,serviceName:r,...n===re.a.ErrorCount?{}:{transactionType:h},transactionName:g,errorGroupingKey:E,start:m,end:d},useRuleProducer:!0})),[n,b,y,f.triggersActionsUi,r,g,E,h,b,m,d]);return i.a.createElement(i.a.Fragment,null,t&&j)}const pe=J.i18n.translate("xpack.apm.home.alertsMenu.alerts",{defaultMessage:"Alerts and rules"}),me=J.i18n.translate("xpack.apm.home.alertsMenu.transactionDuration",{defaultMessage:"Latency"}),de=J.i18n.translate("xpack.apm.home.alertsMenu.transactionErrorRate",{defaultMessage:"Failed transaction rate"}),be=J.i18n.translate("xpack.apm.home.alertsMenu.errorCount",{defaultMessage:" Create error count rule"}),he=J.i18n.translate("xpack.apm.home.alertsMenu.createThresholdAlert",{defaultMessage:"Create threshold rule"}),ge=J.i18n.translate("xpack.apm.home.alertsMenu.createAnomalyAlert",{defaultMessage:"Create anomaly rule"}),Ee="create_threshold_panel";function fe({canSaveAlerts:e,canReadAlerts:t,canReadMlJobs:a}){const[n,r]=Object(l.useState)(!1),[o,s]=Object(l.useState)(null),{plugins:{observability:c}}=Object(D.a)(),u=i.a.createElement(w.EuiHeaderLink,{color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>r((e=>!e)),"data-test-subj":"apmAlertAndRulesHeaderLink"},pe),p=[{id:0,title:pe,items:[...e?[{name:he,panel:Ee,"data-test-subj":"apmAlertsMenuItemCreateThreshold"},...a?[{name:ge,onClick:()=>{s(re.a.Anomaly),r(!1)},"data-test-subj":"apmAlertsMenuItemCreateAnomaly"}]:[],{name:be,onClick:()=>{s(re.a.ErrorCount),r(!1)},"data-test-subj":"apmAlertsMenuItemErrorCount"}]:[],...t?[{name:J.i18n.translate("xpack.apm.home.alertsMenu.viewActiveAlerts",{defaultMessage:"Manage rules"}),href:c.useRulesLink().href,icon:"tableOfContents","data-test-subj":"apmAlertsMenuItemManageRules"}]:[]]},{id:Ee,title:he,items:[{name:me,onClick:()=>{s(re.a.TransactionDuration),r(!1)}},{name:de,onClick:()=>{s(re.a.TransactionErrorRate),r(!1)}}]}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiPopover,{id:"integrations-menu",button:u,isOpen:n,closePopover:()=>r(!1),panelPaddingSize:"none",anchorPosition:"downRight"},i.a.createElement(w.EuiContextMenu,{initialPanelId:0,panels:p})),i.a.createElement(ue,{ruleType:o,addFlyoutVisible:!!o,setAddFlyoutVisibility:e=>{e||s(null)}}))}var ve=a(192),ye=a(173),je=a(83);function xe(){const{query:e}=Object(ie.b)("/*"),t="environment"in e&&e.environment||se.a.value,{core:a}=Object(D.a)(),{basePath:n}=a.http,r=Object(je.a)(),{anomalyDetectionSetupState:o}=Object(ye.a)();let l,s="",c="text";o===ve.a.Failure?(c="warning",s=J.i18n.translate("xpack.apm.anomalyDetectionSetup.jobFetchFailureText",{defaultMessage:"Could not determine state of anomaly detection setup."}),l="machineLearningApp"):o===ve.a.NoJobs||o===ve.a.NoJobsForEnvironment?(c="warning",s=function(e,t){return e===ve.a.NoJobs?J.i18n.translate("xpack.apm.anomalyDetectionSetup.notEnabledText",{defaultMessage:"Anomaly detection is not yet enabled. Click to continue setup."}):J.i18n.translate("xpack.apm.anomalyDetectionSetup.notEnabledForEnvironmentText",{defaultMessage:'Anomaly detection is not yet enabled for the environment "{currentEnvironment}". Click to continue setup.',values:{currentEnvironment:Object(se.e)(t)}})}(o,t),l="machineLearningApp"):o===ve.a.UpgradeableJobs&&(c="success",s=J.i18n.translate("xpack.apm.anomalyDetectionSetup.upgradeableJobsText",{defaultMessage:"Updates available for existing anomaly detection jobs."}),l="wrench");let u=null;o===ve.a.Loading?u=i.a.createElement(w.EuiLoadingSpinner,{size:"s"}):l&&(u=i.a.createElement(w.EuiIcon,{type:l,color:c,size:"s"}));const p=i.a.createElement(w.EuiHeaderLink,{color:c,href:Object(ne.b)({basePath:n,path:"/settings/anomaly-detection"}),style:{whiteSpace:"nowrap"},"data-test-subj":"apmAnomalyDetectionHeaderLink"},u,i.a.createElement("span",{style:{marginInlineStart:r.eui.euiSizeS}},ke));return s?i.a.createElement(w.EuiToolTip,{position:"bottom",content:s},p):p}const ke=J.i18n.translate("xpack.apm.anomalyDetectionSetup.linkLabel",{defaultMessage:"Anomaly detection"});var Oe=a(43);function Me(){const{inspector:e}=Object(D.a)(),{inspectorAdapters:t}=Object(j.useInspectorContext)(),{services:{uiSettings:a}}=Object(o.useKibana)();return(null==a?void 0:a.get(Oe.enableInspectEsQueries))?i.a.createElement(w.EuiHeaderLink,{color:"primary",onClick:()=>{e.open(t)},"data-test-subj":"apmInspectHeaderLink"},J.i18n.translate("xpack.apm.inspectButtonText",{defaultMessage:"Inspect"})):null}var Ae=a(1255),Ce=a(581),Te=a(74);const Se=i.a.lazy((async()=>({default:(await Promise.resolve().then(a.bind(null,581))).FieldRow}))),Le=Object(Ae.a)(Se);function Re({onClose:e}){const t=Object(j.useUiTracker)({app:"apm"}),{docLinks:a,notifications:n}=Object(D.a)().core,{data:r,status:o}=Object(Te.d)((e=>e("GET /internal/apm/settings/labs")),[]),l=(null==r?void 0:r.labsItems)||[],{fields:s,handleFieldChange:c,unsavedChanges:u,saveAll:p,isSaving:m,cleanUnsavedChanges:d}=Object(j.useEditableSettings)(l),b=Object(Te.c)(o),h={successfulValidation:!0,valid:!0};return i.a.createElement(w.EuiFlyout,{onClose:e},i.a.createElement(w.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(w.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiIcon,{type:"beaker",size:"l"})),i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiTitle,null,i.a.createElement("h2",null,J.i18n.translate("xpack.apm.labs",{defaultMessage:"Labs"}))))),i.a.createElement(w.EuiSpacer,{size:"s"}),i.a.createElement(w.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiText,null,J.i18n.translate("xpack.apm.labs.description",{defaultMessage:"Try out the APM features that are under technical preview and in progress."}))),i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiButton,{"data-test-subj":"labsFeedbackButton",href:"https://ela.st/feedback-apm-labs",target:"_blank",color:"warning",iconType:"editorComment"},J.i18n.translate("xpack.apm.labs.feedbackButtonLabel",{defaultMessage:"Tell us what you think!"}))))),b?i.a.createElement(w.EuiSkeletonText,{lines:3}):i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiFlyoutBody,null,l.map((e=>{const t=s[e];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ce.FieldRowProvider,{links:a.links.management,showDanger:e=>n.toasts.addDanger(e),validateChange:async()=>h},i.a.createElement(Le,{field:t,isSavingEnabled:!0,onFieldChange:c,unsavedChange:u[e]})),i.a.createElement(w.EuiHorizontalRule,null))}))),i.a.createElement(w.EuiFlyoutFooter,null,i.a.createElement(w.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiButtonEmpty,{"data-test-subj":"apmLabsFlyoutCancelButton",onClick:function(){d(),e()}},J.i18n.translate("xpack.apm.labs.cancel",{defaultMessage:"Cancel"}))),i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiButton,{"data-test-subj":"apmLabsFlyoutReloadToApplyChangesButton",fill:!0,isLoading:m,onClick:async function(){try{const a=Object.keys(u).some((e=>s[e].requiresPageReload));await p(),t({metric:"labs_save"}),a?window.location.reload():e()}catch(e){const t=e;n.toasts.addDanger({title:J.i18n.translate("xpack.apm.apmSettings.save.error",{defaultMessage:"An error occurred while saving the settings"}),text:t.message})}}},J.i18n.translate("xpack.apm.labs.reload",{defaultMessage:"Reload to apply changes"})))))))}function we(){const[e,t]=Object(l.useState)(!1),a=Object(j.useUiTracker)({app:"apm"});function n(){t((e=>!e))}return Object(l.useEffect)((()=>{e&&a({metric:"labs_open"})}),[e,a]),i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiButtonEmpty,{"data-test-subj":"apmLabsLabsButton",color:"text",onClick:n},J.i18n.translate("xpack.apm.labs",{defaultMessage:"Labs"})),e&&i.a.createElement(Re,{onClose:n}))}function Fe(){var e,t;const{core:a,plugins:n,config:r}=Object(D.a)(),{search:o}=window.location,{application:l,http:s}=a,{basePath:c}=s,{capabilities:u}=l,{featureFlags:p}=r,m=!(null===(e=u.ml)||void 0===e||!e.canGetJobs),d=!(null===(t=u.ml)||void 0===t||!t.canCreateJob),{isAlertingAvailable:b,canReadAlerts:h,canSaveAlerts:g}=Object(ae.a)(n,u),E=u.apm.save&&g;function f(e){return Object(ne.b)({basePath:c,path:e,search:o})}const v=a.uiSettings.get(te.apmLabsButton,!1);return i.a.createElement(w.EuiHeaderLinks,{gutterSize:"xs"},v&&i.a.createElement(we,null),p.storageExplorerAvailable&&i.a.createElement(w.EuiHeaderLink,{color:"text",href:f("/storage-explorer"),"data-test-subj":"apmStorageExplorerHeaderLink"},i.a.createElement(w.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(w.EuiFlexItem,{grow:!1},J.i18n.translate("xpack.apm.storageExplorerLinkLabel",{defaultMessage:"Storage Explorer"})))),d&&i.a.createElement(xe,null),b&&i.a.createElement(fe,{canReadAlerts:h,canSaveAlerts:E,canReadMlJobs:m}),i.a.createElement(w.EuiHeaderLink,{color:"primary",href:c.prepend("/app/apm/tutorial"),iconType:"indexOpen","data-test-subj":"apmAddDataHeaderLink"},J.i18n.translate("xpack.apm.addDataButtonLabel",{defaultMessage:"Add data"})),i.a.createElement(w.EuiHeaderLink,{color:"text",href:f("/settings"),"data-test-subj":"apmSettingsHeaderLink"},J.i18n.translate("xpack.apm.settingsLinkLabel",{defaultMessage:"Settings"})),i.a.createElement(Me,null))}var Ie=a(118),Pe=a.n(Ie);function _e({children:e}){const t=Object(x.useLocation)(),a=Pe.a.parse(t.search);return"/dependencies"!==t.pathname.replace(/\/$/,"")||"dependencyName"in a?e:i.a.createElement(x.Redirect,{to:Pe.a.stringifyUrl({url:t.pathname+"/inventory",query:a})})}var De=a(80),Ue=a(19);function Ne({children:e}){const{isDateRangeSet:t,redirect:a}=function(){const e=Object(x.useHistory)(),t=Object(x.useLocation)(),a=Pe.a.parse(t.search),{core:n,plugins:r}=Object(D.a)(),o=n.uiSettings.get(Ue.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS),l=r.data.query.timefilter.timefilter.getTime();return{isDateRangeSet:"rangeFrom"in a&&"rangeTo"in a,redirect:()=>{var n,r;const i={rangeFrom:null!==(n=l.from)&&void 0!==n?n:o.from,rangeTo:null!==(r=l.to)&&void 0!==r?r:o.to,...a};e.replace({...t,search:Pe.a.stringify(i)})}}}(),n=function({apmRouter:e,location:t}){return e.getRoutesToMatch(t.pathname).some((e=>"/diagnostics"===e.path||"/services"===e.path||"/traces"===e.path||"/service-map"===e.path||"/dependencies"===e.path||"/dependencies/inventory"===e.path||"/services/{serviceName}"===e.path||"/mobile-services/{serviceName}"===e.path||"/service-groups"===e.path||"/storage-explorer"===e.path||"/"===t.pathname||""===t.pathname))}({apmRouter:Object(De.a)(),location:Object(x.useLocation)()});return!t&&n?(a(),null):e}var Be=a(240);function He({children:e}){const t=Object(x.useLocation)(),a=Pe.a.parse(t.search),n=Object(Be.a)();return"environment"in a?e:"/services"===t.pathname.replace(/\/$/,"")?i.a.createElement(x.Redirect,{to:Pe.a.stringifyUrl({url:t.pathname,query:{...a,environment:n}})}):e}var Ge=a(84),ze=a(147),Je=a(133),qe=a(551);function Ke({children:e}){const{core:t}=Object(D.a)(),a=Object(x.useLocation)(),n=function({apmRouter:e,location:t}){return e.getRoutesToMatch(t.pathname).some((e=>"/services"===e.path||"/service-map"===e.path||"/dependencies"===e.path||"/dependencies/inventory"===e.path||"/services/{serviceName}"===e.path||"/mobile-services/{serviceName}"===e.path||"/service-groups"===e.path||"/"===t.pathname||""===t.pathname))}({apmRouter:Object(De.a)(),location:a}),r=Pe.a.parse(a.search);if(n&&("comparisonType"in r||!("comparisonEnabled"in r))){const{comparisonType:e,comparisonEnabled:n,...o}=r,l=Object(ze.a)({core:t,urlComparisonEnabled:n?Object(Je.c)(n):void 0}).toString(),s=e,c=Ge.b[s];return i.a.createElement(qe.b,{location:{...a,search:Pe.a.stringify({...o,comparisonEnabled:l,...c?{offset:c}:{}})},pathname:a.pathname})}return e}class scroll_to_top_on_path_change_ScrollToTopOnPathChange extends l.Component{componentDidUpdate(e){this.props.location.pathname!==e.location.pathname&&window.scrollTo(0,0)}render(){return null}}var Ve=a(6);function $e({children:e}){var t;const{core:a}=Object(D.a)(),n=Object(Ve.last)(Object(S.g)());return Object(o.useExecutionContext)(a.executionContext,{type:"application",name:"apm",page:null==n||null===(t=n.match)||void 0===t?void 0:t.path}),e}const We=new y.Storage(localStorage);function Xe({apmPluginContextValue:e,pluginsStart:t,apmServices:a}){const{appMountParameters:l,kibanaEnvironment:s,core:c}=e,u=I(s),{history:p}=l,m=c.i18n;return i.a.createElement("div",{className:r.APP_WRAPPER_CLASS,"data-test-subj":"apmMainContainer",role:"main"},i.a.createElement(v,{coreStart:{application:c.application}},i.a.createElement(_.a.Provider,{value:e},i.a.createElement(o.KibanaContextProvider,{services:{...c,...t,storage:We,...a}},i.a.createElement(u,{kibanaEnvironment:s},i.a.createElement(m.Context,null,i.a.createElement(B.b,null,i.a.createElement(S.d,{history:p,router:Z.a},i.a.createElement(n.a,null,i.a.createElement(W,null,i.a.createElement(_e,null,i.a.createElement(He,null,i.a.createElement(Ne,null,i.a.createElement(Ke,null,i.a.createElement(ee,null,i.a.createElement($e,null,i.a.createElement(U.b,null,i.a.createElement(H.b,null,i.a.createElement(N.b,null,i.a.createElement(P.b,null,i.a.createElement(j.InspectorContextProvider,null,i.a.createElement(Ye,null,i.a.createElement(Qe,null),i.a.createElement(C,{component:scroll_to_top_on_path_change_ScrollToTopOnPathChange}),i.a.createElement(S.c,null)))))))))))))))))))))))}function Qe(){const{appMountParameters:{setHeaderActionMenu:e,theme$:t}}=Object(D.a)();return i.a.createElement(j.HeaderMenuPortal,{setHeaderActionMenu:e,theme$:t},i.a.createElement(w.EuiFlexGroup,{responsive:!1,gutterSize:"s"},i.a.createElement(w.EuiFlexItem,null,i.a.createElement(Fe,null))))}function Ye({children:e}){const t=Object(o.useDarkMode)(!1);return i.a.createElement(R.ThemeProvider,{theme:e=>({...e,eui:t?L.euiDarkVars:L.euiLightVars,darkMode:t})},e)}}}]);