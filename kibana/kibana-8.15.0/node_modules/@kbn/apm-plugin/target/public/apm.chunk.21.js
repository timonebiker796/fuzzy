/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[21],{1252:function(e,t,n){"use strict";n.r(t),n.d(t,"APM_ALERTING_LATENCY_CHART_EMBEDDABLE",(function(){return f})),n.d(t,"getApmAlertingLatencyChartEmbeddableFactory",(function(){return h}));var r=n(1),a=n.n(r),o=n(263),i=n(12),c=n(252),s=n(267),l=n(10),u=n(253),d=n(254),m=n(255);function y({rule:e,alert:t,serviceName:n,environment:r=l.a.value,transactionType:o,transactionName:i,rangeFrom:c="now-15m",rangeTo:y="now",latencyThresholdInMicroseconds:f,kuery:h="",filters:T}){const{transactionType:g,transactionTypes:p,setTransactionType:v,comparisonChartTheme:b,latencyAggregationType:E,setLatencyAggregationType:A,timeZone:j}=Object(u.a)({rule:e,rangeFrom:c,rangeTo:y,kuery:h,serviceName:n,defaultTransactionType:o});return c&&y?n&&g?a.a.createElement(s.a,{alert:t,transactionType:g,transactionTypes:p,transactionName:i,serviceName:n,environment:r,start:c,end:y,comparisonChartTheme:b,timeZone:j,latencyAggregationType:E,setLatencyAggregationType:A,setTransactionType:v,comparisonEnabled:!1,offset:"",customAlertEvaluationThreshold:f,kuery:h,filters:T}):a.a.createElement(m.a,null):a.a.createElement(d.a,null)}const f="APM_ALERTING_LATENCY_CHART_EMBEDDABLE",h=e=>({type:f,deserializeState:e=>e.rawState,buildEmbeddable:async(t,n,r,s)=>{const{titlesApi:l,titleComparators:u,serializeTitles:d}=Object(o.a)(t),m=new i.BehaviorSubject(t.serviceName),f=new i.BehaviorSubject(t.transactionType),h=new i.BehaviorSubject(t.transactionName),T=new i.BehaviorSubject(t.environment),g=new i.BehaviorSubject(t.latencyThresholdInMicroseconds),p=new i.BehaviorSubject(t.rangeFrom),v=new i.BehaviorSubject(t.rangeTo),b=new i.BehaviorSubject(t.rule),E=new i.BehaviorSubject(t.alert),A=new i.BehaviorSubject(t.kuery),j=new i.BehaviorSubject(t.filters);return{api:n({...l,serializeState:()=>({rawState:{...d(),serviceName:m.getValue(),transactionType:f.getValue(),transactionName:h.getValue(),environment:T.getValue(),latencyThresholdInMicroseconds:g.getValue(),rangeFrom:p.getValue(),rangeTo:v.getValue(),rule:b.getValue(),alert:E.getValue(),kuery:A.getValue(),filters:j.getValue()}})},{serviceName:[m,e=>m.next(e)],transactionType:[f,e=>f.next(e)],transactionName:[h,e=>h.next(e)],environment:[T,e=>T.next(e)],latencyThresholdInMicroseconds:[g,e=>g.next(e)],rangeFrom:[p,e=>p.next(e)],rangeTo:[v,e=>v.next(e)],rule:[b,e=>b.next(e)],alert:[E,e=>E.next(e)],kuery:[A,e=>A.next(e)],filters:[j,e=>j.next(e)],...u}),Component:()=>{const[t,n,r,i,s,l,u,d,S,x,k]=Object(o.b)(m,f,h,T,g,p,v,b,E,A,j);return a.a.createElement(c.a,{deps:e,rangeFrom:l,rangeTo:u},a.a.createElement(y,{rule:d,alert:S,latencyThresholdInMicroseconds:s,serviceName:t,transactionType:n,environment:i,rangeFrom:l,rangeTo:u,transactionName:r,kuery:x,filters:k}))}}}})},164:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="HH:mm:ss"},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return T})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return A})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return S})),n.d(t,"r",(function(){return x})),n.d(t,"s",(function(){return k})),n.d(t,"t",(function(){return O})),n.d(t,"u",(function(){return I})),n.d(t,"v",(function(){return N})),n.d(t,"w",(function(){return F})),n.d(t,"x",(function(){return $})),n.d(t,"y",(function(){return _})),n.d(t,"z",(function(){return B})),n.d(t,"A",(function(){return C})),n.d(t,"B",(function(){return D})),n.d(t,"C",(function(){return a})),n.d(t,"D",(function(){return o})),n.d(t,"E",(function(){return i})),n.d(t,"F",(function(){return c}));var r=n(42);const a="ecs.version",o="event.action",i="event.kind",c="tags",s=`${r.h}.risk_score`,l=`${r.n}.author`,u=`${r.n}.created_at`,d=`${r.n}.created_by`,m=`${r.n}.description`,y=`${r.n}.enabled`,f=`${r.n}.from`,h=`${r.n}.interval`,T=`${r.n}.license`,g=`${r.n}.note`,p=`${r.n}.references`,v=`${r.n}.rule_id`,b=`${r.n}.rule_name_override`,E=`${r.n}.to`,A=`${r.n}.type`,j=`${r.n}.updated_at`,S=`${r.n}.updated_by`,x=`${r.n}.version`,k=`${r.h}.severity`,w=`${r.h}.suppression`,$=`${w}.terms`,N=`${$}.field`,_=`${$}.value`,F=`${w}.start`,I=`${w}.end`,O=`${w}.docs_count`,B=`${r.h}.system_status`,C=`${r.h}.workflow_reason`,D=`${r.h}.workflow_user`;r.h},250:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(42),a=n(183);r.n,r.h;const o=`${r.h}.evaluation.threshold`,i=`${r.h}.evaluation.value`;r.h,r.h,r.h,r.n,r.n,r.A,r.h,r.n,a.C,a.E,a.D,a.F,r.C,r.a,r.c,r.d,r.e,r.g,r.f,r.k,r.p,r.i,a.a,r.b,a.b,a.c,a.d,a.e,a.f,r.l,a.g,a.h,a.i,r.m,a.j,r.o,a.k,a.l,a.m,r.q,a.n,a.o,r.r,a.p,a.q,a.r,r.t,r.v,a.s,r.u,a.z,r.w,r.x,a.A,r.y,r.z,a.B,r.s,r.j,a.x,a.v,a.y,a.w,a.u,a.t,r.B,r.D},267:function(e,t,n){"use strict";var r=n(1),a=n.n(r),o=n(11),i=n(0),c=n(15),s=n(250),l=n(42),u=n(36),d=n(31);const m=i.i18n.translate("observabilityAlertDetails.alertThresholdTimeRangeRect.detailsTooltip",{defaultMessage:"Threshold"});function y({color:e,id:t,threshold:n}){return Object(d.jsx)(u.RectAnnotation,{id:t,zIndex:2,dataValues:[{coordinates:{y0:n},details:m}],style:{fill:e,opacity:.1}})}const f=i.i18n.translate("observabilityAlertDetails.alertThresholdAnnotation.detailsTooltip",{defaultMessage:"Alert started"});function h({threshold:e,color:t,id:n}){return Object(d.jsx)(u.LineAnnotation,{id:n,domainType:u.AnnotationDomainType.YDomain,dataValues:[{dataValue:e,header:String(e),details:f}],style:{line:{opacity:.5,strokeWidth:1,stroke:t}}})}var T=n(563),g=n(564),p=n(17),v=n(19),b=n(7),E=n.n(b),A=n(170),j=n(244),S=n(142),x=n(123),k=n(84),w=n(74),$=n(243),N=n(109),_=n(151),F=n(98),I=n(108),O=n(164),B=n(152),C=n(153);t.a=function({alert:e,transactionType:t,transactionTypes:n,transactionName:u,serviceName:d,environment:m,start:f,end:b,latencyAggregationType:D,setLatencyAggregationType:M,setTransactionType:V,comparisonChartTheme:L,comparisonEnabled:R,offset:z,timeZone:P,customAlertEvaluationThreshold:G,kuery:q="",filters:H}){const Z=Object(I.a)({start:f,end:b,kuery:"",numBuckets:100,type:u?F.a.TransactionMetric:F.a.ServiceTransactionMetric}),{euiTheme:Y}=Object(o.useEuiTheme)(),{services:{uiSettings:W}}=Object(p.useKibana)(),{data:J,status:K}=Object(w.d)((e=>{if(d&&f&&b&&t&&D&&Z)return e("GET /internal/apm/services/{serviceName}/transactions/charts/latency",{params:{path:{serviceName:d},query:{environment:m,kuery:q,filters:H?JSON.stringify(H):void 0,start:f,end:b,transactionType:t,transactionName:u,latencyAggregationType:D,documentType:Z.source.documentType,rollupInterval:Z.source.rollupInterval,bucketSizeInSeconds:Z.bucketSizeInSeconds,useDurationSummary:Z.source.hasDurationSummaryField&&D===N.a.avg}}})}),[b,m,D,d,f,t,u,Z,q,H]),U=G||e.fields[s.a],X=e.fields[l.d]?E()(e.fields[l.d]).valueOf():void 0,Q=U?[a.a.createElement(y,{key:"alertThresholdRect",id:"alertThresholdRect",threshold:U,color:Y.colors.danger}),a.a.createElement(h,{id:"alertThresholdAnnotation",key:"alertThresholdAnnotation",color:Y.colors.danger,threshold:U})]:[],ee=Object(r.useMemo)((()=>Object($.a)({latencyChart:J,latencyAggregationType:D,previousPeriodLabel:""})),[J,D]),{currentPeriod:te,previousPeriod:ne}=ee,re=[te,R&&Object(k.e)(z)?ne:void 0].filter(A.b),ae=Object(x.a)(re),oe=Object(c.getDurationFormatter)(ae),ie=n&&V;return a.a.createElement(o.EuiFlexItem,null,a.a.createElement(o.EuiPanel,{hasBorder:!0},a.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},a.a.createElement(o.EuiFlexItem,{grow:!1},a.a.createElement(o.EuiTitle,{size:"xs"},a.a.createElement("h2",null,i.i18n.translate("xpack.apm.dependencyLatencyChart.chartTitle",{defaultMessage:"Latency"})))),M&&a.a.createElement(o.EuiFlexItem,{grow:!1},a.a.createElement(j.a,{latencyAggregationType:D,onChange:M})),ie&&a.a.createElement(o.EuiFlexItem,{grow:!1},a.a.createElement(B.a,{transactionType:t,transactionTypes:n,onChange:V})),a.a.createElement(o.EuiFlexItem,null,a.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},a.a.createElement(o.EuiFlexItem,{grow:!1},a.a.createElement(C.a,{serviceName:d,environment:m,from:f,to:b,kuery:q,transactionName:u,transactionType:t}))))),a.a.createElement(S.a,{id:"latencyChart",annotations:(()=>{if(Object(_.b)(e.fields[l.r])||G)return[a.a.createElement(T.a,{alertStart:e.start,alertEnd:X,color:Y.colors.danger,id:"alertActiveRect",key:"alertActiveRect"}),a.a.createElement(g.a,{key:"alertAnnotationStart",id:"alertAnnotationStart",alertStart:e.start,color:Y.colors.danger,dateFormat:W&&W.get(v.UI_SETTINGS.DATE_FORMAT)||O.a}),...Q]})(),height:200,comparisonEnabled:R,offset:z,fetchStatus:K,customTheme:L,timeseries:re,yLabelFormat:Object(x.b)(oe),timeZone:P})))}},563:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n(1);var r=n(36),a=n(0),o=n(31);const i=a.i18n.translate("observabilityAlertDetails.alertActiveTimeRangeAnnotation.detailsTooltip",{defaultMessage:"Active"});function c({alertStart:e,alertEnd:t,color:n,id:a}){return Object(o.jsx)(r.RectAnnotation,{id:a,dataValues:[{coordinates:{y0:0,x0:e,x1:t},details:i}],style:{fill:n,opacity:.1}})}},564:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n(1);var r=n(7),a=n.n(r),o=n(0),i=n(36),c=n(11),s=n(31);const l=o.i18n.translate("observabilityAlertDetails.alertAnnotation.detailsTooltip",{defaultMessage:"Alert started"});function u({alertStart:e,color:t,dateFormat:n,id:r}){return Object(s.jsx)(i.LineAnnotation,{id:r,domainType:i.AnnotationDomainType.XDomain,dataValues:[{dataValue:e,header:a()(e).format(n),details:l}],style:{line:{strokeWidth:3,stroke:t,opacity:1}},marker:Object(s.jsx)(c.EuiIcon,{type:"warning",color:t}),markerPosition:i.Position.Top})}}}]);