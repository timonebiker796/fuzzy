/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[24],{1246:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),l=a(7),r=a.n(l);function i(e){return e.isDefault("dateFormat:tz")?r.a.tz.guess()||r()().format("Z"):e.get("dateFormat:tz","Browser")}var o=a(4),u=a.n(o);let d=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),c=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){u()(this,"name",void 0),u()(this,"sortable",void 0),u()(this,"filterable",void 0),u()(this,"esTypes",void 0),this.name=e.name||c.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}new kbn_field_type_KbnFieldType({name:c.UNKNOWN});new kbn_field_type_KbnFieldType({name:c.STRING,sortable:!0,filterable:!0,esTypes:[d.STRING,d.TEXT,d.MATCH_ONLY_TEXT,d.KEYWORD,d.VERSION,d._TYPE,d._ID]}),new kbn_field_type_KbnFieldType({name:c.NUMBER,sortable:!0,filterable:!0,esTypes:[d.FLOAT,d.HALF_FLOAT,d.SCALED_FLOAT,d.DOUBLE,d.INTEGER,d.LONG,d.UNSIGNED_LONG,d.SHORT,d.BYTE,d.TOKEN_COUNT,d.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:c.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[d.FLOAT_RANGE,d.DOUBLE_RANGE,d.INTEGER_RANGE,d.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:c.DATE,sortable:!0,filterable:!0,esTypes:[d.DATE,d.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:c.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[d.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:c.IP,sortable:!0,filterable:!0,esTypes:[d.IP]}),new kbn_field_type_KbnFieldType({name:c.IP_RANGE,sortable:!0,filterable:!0,esTypes:[d.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:c.BOOLEAN,sortable:!0,filterable:!0,esTypes:[d.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:c.OBJECT,esTypes:[d.OBJECT]}),new kbn_field_type_KbnFieldType({name:c.NESTED,esTypes:[d.NESTED]}),new kbn_field_type_KbnFieldType({name:c.GEO_POINT,esTypes:[d.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:c.GEO_SHAPE,esTypes:[d.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:c.ATTACHMENT,esTypes:[d.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:c.MURMUR3,esTypes:[d.MURMUR3]}),new kbn_field_type_KbnFieldType({name:c._SOURCE,esTypes:[d._SOURCE]}),new kbn_field_type_KbnFieldType({name:c.HISTOGRAM,filterable:!0,esTypes:[d.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:c.CONFLICT});var m=a(20),b=a(51),f=a.n(b),p=a(11),g=a(33),y=a(36),T=a(0),O=a(207),j=a(12),_=a(64);function E(e,t){const{ast:a}=Object(_.getAstAndSyntaxErrors)(e),n=a.find((({name:e})=>["from","metrics"].includes(e)));if(!n)return e;let s=-1;const l=a.find((({name:e},t)=>(s=t,"sort"===e)));if(!l||l&&1!==s){const a=e.substring(n.location.min,n.location.max+1);return e.replace(a,`${a} \n| LIMIT ${t}`)}const r=e.substring(n.location.min,l.location.max+1);return e.replace(r,`${r} \n| LIMIT ${t}`)}function F(e,t){return`${e}\n${t}`}var S=a(208),h=a(1257);async function v(e,t=S.b){const{searchHandler:a,field:n,esqlBaseQuery:s}=e,l=N(n.name),r=N(`${n.name}_terms`),i=F(s,`| WHERE ${l} IS NOT NULL\n    | STATS ${r} = count(${l}) BY ${l}\n    | SORT ${r} DESC\n    | LIMIT ${t}`),o=await a({query:i}),u=null==o?void 0:o.values;if(null==u||!u.length)return{};const d=null==u?void 0:u.reduce(((e,t)=>e+t[0]),0);return{totalDocuments:d,sampledDocuments:d,sampledValues:d,topValues:{buckets:u.map((e=>({count:e[0],key:e[1]})))}}}function N(e){return`\`${e}\``}const x=async({services:e,dataView:t,field:a,fromDate:n,toDate:s,baseQuery:l,abortController:r})=>{const{data:i}=e;try{if(null==t||!t.id||null==a||!a.type)return{};const e=async({query:e})=>{const a=function({timeFieldName:e,fromDate:t,toDate:a}){return e?{range:{[e]:{gte:t,lte:a,format:"strict_date_optional_time"}}}:null}({timeFieldName:t.timeFieldName,fromDate:n,toDate:s}),l=await async function({esqlQuery:e,search:t,signal:a,filter:n,dropNullColumns:s}){const l=await Object(j.lastValueFrom)(t({params:{...n?{filter:n}:{},query:e,...s?{dropNullColumns:!0}:{}}},{abortSignal:a,strategy:"esql_async"}));return{response:l.rawResponse,params:l.requestParams}}({esqlQuery:e,filter:a,search:i.search.search,signal:null==r?void 0:r.signal});return l.response};if(!("esql"in l))throw new Error("query must be of type AggregateQuery");return await async function(e){const{field:t}=e;return Object(O.e)(t)?"boolean"===t.type?await v(e,3):Object(O.f)(t)?await v(e):Object(O.b)(t,!0)?await async function(e){const{searchHandler:t,field:a,esqlBaseQuery:n}=e,s=N(a.name),l=F(n,`| WHERE ${s} IS NOT NULL\n    | KEEP ${s}\n    | LIMIT ${S.e}`),r=await t({query:l}),i=((null==r?void 0:r.values)||[]).map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(null==i||!i.length)return{};const o=null==i?void 0:i.length,u=Object(h.a)({values:i,field:a,count:S.a,isTextBased:!0});return{totalDocuments:o,sampledDocuments:u.sampledDocuments,sampledValues:u.sampledValues,topValues:{buckets:u.buckets,areExamples:!0}}}(e):{}:{}}({searchHandler:e,field:a,esqlBaseQuery:E(l.esql,S.c)})}catch(e){throw new Error("Could not provide field stats",{cause:e})}};var A=a(1215),D=a(31);const L=({areExamples:e,buckets:t,dataView:a,field:l,sampledValuesCount:r,color:i=R(),"data-test-subj":o,onAddFilter:u,overrideFieldTopValueBar:d})=>{if(null==t||!t.length)return null;const c=a.getFormatterForField(l),m=G(k(t),r),b=t.some((e=>!Number.isInteger(e.count/r)));return Object(D.jsx)("div",{"data-test-subj":e?"unifiedFieldStats-exampleValueBuckets":"unifiedFieldStats-topValueBuckets"},Object(D.jsx)("div",{"data-test-subj":`${o}-topValues`},t.map(((e,t)=>{const a=e.key,s=c.convert(a);return Object(D.jsx)(n.Fragment,{key:String(a)},t>0&&Object(D.jsx)(p.EuiSpacer,{size:"s"}),Object(D.jsx)(A.default,{field:l,fieldValue:a,formattedFieldValue:s,formattedPercentage:w(e.count,r,b),progressValue:I(e.count,r),count:e.count,color:i,"data-test-subj":o,onAddFilter:u,overrideFieldTopValueBar:d}))})),m>0&&Object(D.jsx)(s.a.Fragment,null,Object(D.jsx)(p.EuiSpacer,{size:"s"}),Object(D.jsx)(A.default,{type:"other",field:l,fieldValue:void 0,formattedPercentage:w(m,r,b),progressValue:I(m,r),count:m,color:i,"data-test-subj":o,onAddFilter:u,overrideFieldTopValueBar:d}))))},R=()=>Object(p.euiPaletteColorBlind)()[1],w=(e,t,a)=>t>0?`${(Math.round(e/t*1e3)/10).toFixed(a?1:0)}%`:"",I=(e,t)=>t>0?e/t:0,k=e=>(null==e?void 0:e.reduce(((e,t)=>t.count+e),0))||0,G=(e,t)=>t&&e?t-e:0,M=({message:e})=>Object(D.jsx)(p.EuiText,{size:"s"},e),V=({dataView:e,field:t,numberSummary:a,"data-test-subj":n})=>{if(!a||!C(a))return null;const s=e.getFormatterForField(t),l=[{key:"min",label:T.i18n.translate("unifiedFieldList.fieldStats.numberSummary.minLabel",{defaultMessage:"min"}),value:s.convert(a.minValue,"text")},{key:"max",label:T.i18n.translate("unifiedFieldList.fieldStats.numberSummary.maxLabel",{defaultMessage:"max"}),value:s.convert(a.maxValue,"text")}],r=[{field:"label",name:"",align:p.LEFT_ALIGNMENT},{field:"value",name:"",render:e=>Object(D.jsx)("strong",null,e),align:p.RIGHT_ALIGNMENT}],i=T.i18n.translate("unifiedFieldList.fieldStats.numberSummary.summaryTableTitle",{defaultMessage:"Summary"});return Object(D.jsx)(p.EuiBasicTable,{compressed:!0,items:l,columns:r,tableCaption:i,"data-test-subj":`${n}-numberSummary`,responsiveBreakpoint:!1,css:Object(D.css)("& .euiTableHeaderCell{",Object(p.euiScreenReaderOnly)(),";}& .euiTableRowCell{border-top:none;}","")})};function C(e){return"number"==typeof(null==e?void 0:e.minValue)&&"number"==typeof(null==e?void 0:e.maxValue)}class error_boundary_ErrorBoundary extends s.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?null:this.props.children}}const B=({services:e,query:t,dslQuery:l,filters:r,fromDate:o,toDate:u,dataViewOrDataViewId:b,field:j,color:_=R(),"data-test-subj":E="fieldStats",overrideMissingContent:F,overrideFooter:S,onAddFilter:h,overrideFieldTopValueBar:v,onStateChange:N})=>{const{fieldFormats:A,uiSettings:w,charts:I,dataViews:B,data:U}=e,[P,K]=Object(n.useState)({isLoading:!1}),[$,H]=Object(n.useState)(null),q=Object(n.useRef)(null),z=Object(n.useRef)(!1),Q=!!t&&Object(m.isOfAggregateQueryType)(t),W=Object(n.useCallback)((e=>{z.current||K(e)}),[K,z]);Object(n.useEffect)((function(){N&&N(P)}),[N,P]);const Y=Object(n.useCallback)((e=>{z.current||H(e)}),[H,z]);Object(n.useEffect)((()=>{!async function(){var e;if(!z.current)try{var n;const s="string"==typeof b?await B.get(b):b;if(Y(s),P.isLoading)return;W((e=>({...e,isLoading:!0}))),null===(n=q.current)||void 0===n||n.abort(),q.current=new AbortController;const i=Q?await x({services:{data:U},dataView:s,field:j,fromDate:o,toDate:u,baseQuery:t,abortController:q.current}):await(async e=>{const{loadFieldStats:t}=await a.e(26).then(a.bind(null,1256));return await t(e)})({services:{data:U},dataView:s,field:j,fromDate:o,toDate:u,dslQuery:null!=l?l:Object(m.buildEsQuery)(s,null!=t?t:[],null!=r?r:[],(e=w,{allowLeadingWildcards:e.get("query:allowLeadingWildcards"),queryStringOptions:e.get("query:queryString:options"),ignoreFilterIfFieldNotInIndex:e.get("courier:ignoreFilterIfFieldNotInIndex"),dateFormatTZ:e.get("dateFormat:tz")})),abortController:q.current});q.current=null,W((e=>({...e,isLoading:!1,totalDocuments:i.totalDocuments,sampledDocuments:i.sampledDocuments,sampledValues:i.sampledValues,histogram:i.histogram,topValues:i.topValues,numberSummary:i.numberSummary})))}catch(e){W((e=>({...e,isLoading:!1})))}}()}),[b,j,l,t,r,o,u,e]),Object(n.useEffect)((()=>()=>{var e;z.current=!0,null===(e=q.current)||void 0===e||e.abort()}),[]);const X=I.theme.useChartsBaseTheme(),J=Object(n.useMemo)((()=>_?{barSeriesStyle:{rect:{fill:_}}}:{}),[_]),{isLoading:Z,histogram:ee,topValues:te,numberSummary:ae,sampledValues:ne,sampledDocuments:se,totalDocuments:le}=P;let re=!!P.histogram;const ie=f.a.parse(o),oe=f.a.parse(u),ue=k(null==te?void 0:te.buckets),de=G(ue,ne);ue&&ee&&ee.buckets.length&&te&&te.buckets.length&&(re=de/ue>.9);const[ce,me]=Object(n.useState)(re);if(Z)return Object(D.jsx)(p.EuiLoadingSpinner,{"data-test-subj":`${E}-statsLoading`});if(!$)return null;const be=$.getFormatterForField(j);let fe=Object(D.jsx)(s.a.Fragment,null);function pe(t){const a=function(e,t,a,n){const l="unifiedFieldStats-statsFooter-docsCount",{fieldFormats:r}=t,{totalDocuments:i,sampledValues:o,sampledDocuments:u,topValues:m}=e;if(!i)return Object(D.jsx)(s.a.Fragment,null);let b;return b=a?null!=m&&m.areExamples?Object(D.jsx)(g.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromSampleRecordsLabel",defaultMessage:"Calculated from {sampledDocumentsFormatted} sample {sampledDocuments, plural, one {record} other {records}}.",values:{sampledDocuments:u,sampledDocumentsFormatted:Object(D.jsx)("strong",{"data-test-subj":l},r.getDefaultInstance(c.NUMBER,[d.INTEGER]).convert(u))}}):Object(D.jsx)(g.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromSampleValuesLabel",defaultMessage:"Calculated from {sampledValuesFormatted} sample {sampledValues, plural, one {value} other {values}}.",values:{sampledValues:o,sampledValuesFormatted:Object(D.jsx)("strong",{"data-test-subj":l},r.getDefaultInstance(c.NUMBER,[d.INTEGER]).convert(o))}}):u&&u<i?Object(D.jsx)(g.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromSampleRecordsLabel",defaultMessage:"Calculated from {sampledDocumentsFormatted} sample {sampledDocuments, plural, one {record} other {records}}.",values:{sampledDocuments:u,sampledDocumentsFormatted:Object(D.jsx)("strong",{"data-test-subj":l},r.getDefaultInstance(c.NUMBER,[d.INTEGER]).convert(u))}}):Object(D.jsx)(g.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromTotalRecordsLabel",defaultMessage:"Calculated from {totalDocumentsFormatted} {totalDocuments, plural, one {record} other {records}}.",values:{totalDocuments:i,totalDocumentsFormatted:Object(D.jsx)("strong",{"data-test-subj":l},r.getDefaultInstance(c.NUMBER,[d.INTEGER]).convert(i))}}),Object(D.jsx)(p.EuiText,{color:"subdued",size:"xs","data-test-subj":`${n}-statsFooter`},b)}(P,e,Q,E);return Object(D.jsx)(s.a.Fragment,null,fe?Object(D.jsx)("div",{"data-test-subj":`${E}-title`},fe):Object(D.jsx)(s.a.Fragment,null),Object(D.jsx)(p.EuiSpacer,{size:"s"}),t,S?null==S?void 0:S({element:a,totalDocuments:le,sampledDocuments:se}):Object(D.jsx)(s.a.Fragment,null,Object(D.jsx)(p.EuiSpacer,{size:"m"}),a))}if(!Object(O.d)(j,Q)){const e=Object(D.jsx)(M,{message:T.i18n.translate("unifiedFieldList.fieldStats.notAvailableForThisFieldDescription",{defaultMessage:"Analysis is not available for this field."})});return F?F({reason:"unsupported",element:e}):e}if(Object(O.c)(j,Q)&&C(ae))return fe=Object(D.jsx)(p.EuiTitle,{size:"xxxs"},Object(D.jsx)("h6",null,T.i18n.translate("unifiedFieldList.fieldStats.numberSummary.summaryTableTitle",{defaultMessage:"Summary"}))),pe(Object(D.jsx)(V,{dataView:$,field:j,numberSummary:ae,"data-test-subj":E}));if(!(ee&&0!==ee.buckets.length||te&&0!==te.buckets.length)){const e=se&&le&&se<le?Object(D.jsx)(M,{message:T.i18n.translate("unifiedFieldList.fieldStats.noFieldDataInSampleDescription",{defaultMessage:"No field data for {sampledDocumentsFormatted} sample {sampledDocuments, plural, one {record} other {records}}.",values:{sampledDocuments:se,sampledDocumentsFormatted:A.getDefaultInstance(c.NUMBER,[d.INTEGER]).convert(se)}})}):Object(D.jsx)(M,{message:T.i18n.translate("unifiedFieldList.fieldStats.noFieldDataDescription",{defaultMessage:"No field data for the current search."})});return F?F({reason:"no-data",element:e}):e}if(ee&&ee.buckets.length&&te&&te.buckets.length?fe=Object(D.jsx)(s.a.Fragment,null,Object(D.jsx)(p.EuiButtonGroup,{"data-test-subj":"unifiedFieldStats-buttonGroup",buttonSize:"compressed",isFullWidth:!0,legend:T.i18n.translate("unifiedFieldList.fieldStats.displayToggleLegend",{defaultMessage:"Toggle either the"}),options:[{label:T.i18n.translate("unifiedFieldList.fieldStats.topValuesLabel",{defaultMessage:"Top values"}),id:"topValues","data-test-subj":`${E}-buttonGroup-topValuesButton`},{label:T.i18n.translate("unifiedFieldList.fieldStats.fieldDistributionLabel",{defaultMessage:"Distribution"}),id:"histogram","data-test-subj":`${E}-buttonGroup-distributionButton`}],onChange:e=>{me("histogram"===e)},idSelected:ce?"histogram":"topValues"}),Object(D.jsx)(p.EuiSpacer,{size:"xs"})):"date"===j.type?fe=Object(D.jsx)(p.EuiTitle,{size:"xxxs"},Object(D.jsx)("h6",null,T.i18n.translate("unifiedFieldList.fieldStats.fieldTimeDistributionLabel",{defaultMessage:"Time distribution"}))):te&&te.buckets.length&&(fe=Object(D.jsx)(p.EuiTitle,{size:"xxxs"},Object(D.jsx)("h6",null,te.areExamples?T.i18n.translate("unifiedFieldList.fieldStats.examplesLabel",{defaultMessage:"Examples"}):T.i18n.translate("unifiedFieldList.fieldStats.topValuesLabel",{defaultMessage:"Top values"})))),ee&&ee.buckets.length){const e=T.i18n.translate("unifiedFieldList.fieldStats.countLabel",{defaultMessage:"Count"});if("date"===j.type)return pe(Object(D.jsx)("div",{"data-test-subj":"unifiedFieldStats-timeDistribution"},Object(D.jsx)("div",{"data-test-subj":`${E}-histogram`},Object(D.jsx)(y.Chart,{size:{height:200,width:268}},Object(D.jsx)(y.Tooltip,{type:y.TooltipType.None}),Object(D.jsx)(y.Settings,{locale:T.i18n.getLocale(),theme:J,baseTheme:X,xDomain:ie&&oe?{min:ie.valueOf(),max:oe.valueOf(),minInterval:Math.round((oe.valueOf()-ie.valueOf())/10)}:void 0}),Object(D.jsx)(y.Axis,{id:"key",position:y.Position.Bottom,tickFormat:ie&&oe?Object(y.niceTimeFormatter)([ie.valueOf(),oe.valueOf()]):void 0,showOverlappingTicks:!0}),Object(D.jsx)(y.HistogramBarSeries,{data:ee.buckets,id:e,xAccessor:"key",yAccessors:["count"],xScaleType:y.ScaleType.Time,yScaleType:y.ScaleType.Linear,timeZone:i(w)})))));if(ce||!te||!te.buckets.length)return pe(Object(D.jsx)("div",{"data-test-subj":"unifiedFieldStats-histogram"},Object(D.jsx)(y.Chart,{"data-test-subj":`${E}-histogram`,size:{height:200,width:"100%"}},Object(D.jsx)(y.Tooltip,{type:y.TooltipType.None}),Object(D.jsx)(y.Settings,{locale:T.i18n.getLocale(),rotation:90,theme:J,baseTheme:X}),Object(D.jsx)(y.Axis,{id:"key",position:y.Position.Left,showOverlappingTicks:!0,tickFormat:e=>be.convert(e)}),Object(D.jsx)(y.HistogramBarSeries,{data:ee.buckets,id:e,xAccessor:"key",yAccessors:["count"],xScaleType:y.ScaleType.Linear,yScaleType:y.ScaleType.Linear}))))}return te&&te.buckets.length?pe(Object(D.jsx)(L,{areExamples:te.areExamples,buckets:te.buckets,dataView:$,field:j,sampledValuesCount:ne,color:_,"data-test-subj":E,onAddFilter:h,overrideFieldTopValueBar:v})):null};t.default=e=>Object(D.jsx)(error_boundary_ErrorBoundary,null,Object(D.jsx)(B,e))},1257:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return u}));var n=a(6);const s=["_type","_source"];function l(e,t,a,s,r){for(const i in t){if(!t.hasOwnProperty(i))continue;const o=t[i],u=a+i,d=null==s?void 0:s.fields.getByName(u);if(!1===(null==r?void 0:r.shallow)){const t="nested"===(null==d?void 0:d.type);if(Array.isArray(o)&&!t){for(let t=0;t<o.length;t++){const a=o[t];Object(n.isPlainObject)(a)&&l(e,a,u+".",s,r)}continue}}else if(void 0!==e[u])continue;const c=d&&"conflict"!==d.type,m=!Object(n.isPlainObject)(o);c||m?e[u]?Array.isArray(e[u])?e[u].push(o):e[u]=[e[u],o]:e[u]=o:l(e,o,u+".",s,r)}}var r=a(207),i=a(208);function o(e,t){if(e=Object(n.defaults)(e,{count:i.a}),!Object(r.b)(e.field,e.isTextBased))throw new Error(`Analysis is not available this field type: "${e.field.type}". Field name: "${e.field.name}"`);const a=e.values,{groups:s,sampledValues:l}=function(e,t){const a={};let s=0;return e.forEach((function(e){if(Object(n.isObject)(e)&&!Array.isArray(e))throw new Error("Analysis is not available for object fields.");let l,r=0;const i={};l=Array.isArray(e)?e:null==e?[]:[e],l.forEach((e=>{const n=t?t.convert(e):e;i[n]||(a.hasOwnProperty(n)?a[n].count++:a[n]={key:n,count:1,order:r++},i[n]=!0,s++)}))})),{groups:a,sampledValues:s}}(a,t);return{buckets:Object(n.sortBy)(s,["count","order"]).reverse().slice(0,e.count).map((e=>Object(n.pick)(e,["key","count"]))),sampledValues:l,sampledDocuments:e.values.length}}function u(e,t,a){return null!=t&&t.name?Object(n.map)(e,(function(e){return function(e,t,a){const n={};if(l(n,e.fields||{},"",t,a),!1!==(null==a?void 0:a.source)&&e._source)l(n,e._source,"",t,a);else if(null!=a&&a.includeIgnoredValues&&e.ignored_field_values)for(const t in e.ignored_field_values){if(!e.ignored_field_values.hasOwnProperty(t))continue;const a=e.ignored_field_values[t];n[t]?Array.isArray(n[t])?n[t]=[...n[t],...a]:n[t]=[n[t],...a]:n[t]=a}if(null!=t&&t.metaFields)for(let a=0;a<(null==t?void 0:t.metaFields.length);a++){const l=null==t?void 0:t.metaFields[a];s.includes(l)||"_"!==l.charAt(0)||(n[l]=e[l])}return function(e,t){function a(e,a){var n,s;const l=null==t||null===(n=t.metaFields)||void 0===n?void 0:n.includes(String(e)),r=null==t||null===(s=t.metaFields)||void 0===s?void 0:s.includes(String(a));return l&&r?String(e).localeCompare(String(a)):l?1:r?-1:String(e).localeCompare(String(a))}return new Proxy(e,{ownKeys:e=>Reflect.ownKeys(e).sort(a)})}(n,t)}(e,a,{includeIgnoredValues:!0})[t.name]})):[]}},207:function(e,t,a){"use strict";function n(e,t){return t?o(e):e.aggregatable&&s(e,t)||(!e.aggregatable||"geo_point"===e.type||"geo_shape"===e.type)&&r(e,t)}function s(e,t){return!t&&!("document"===e.type||e.type.includes("range")||"geo_point"===e.type||"geo_shape"===e.type||"murmur3"===e.type||"attachment"===e.type)}function l(e,t){return!t&&"counter"===e.timeSeriesMetric}function r(e,t){return t?"string"===e.type&&!i(e)||["geo_point","geo_shape"].includes(e.type):"_score"!==e.name&&["string","text","keyword","version","ip","number","geo_point","geo_shape"].includes(e.type)}function i(e){var t;if("_id"===e.name)return!1;const a=null===(t=e.esTypes)||void 0===t?void 0:t[0];return Boolean("string"===e.type&&a&&["keyword","version"].includes(a))||["keyword","version","ip","number","boolean"].includes(e.type)}function o(e){return i(e)||r(e,!0)}a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return o}))},208:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return i}));const n=5e3,s=10,l=100,r=10,i=1e4}}]);