/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,s,i=t[0],a=t[1],o=0,u=[];o<i.length;o++)s=i[o],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={0:0};function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,s){n=r[e]=[t,s]}));t.push(n[2]=i);var a,o=document.createElement("script");o.charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=function(e){return s.p+"observabilityAIAssistant.chunk."+e+".js"}(e);var c=new Error;a=function(t){o.onerror=o.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",c.name="ChunkLoadError",c.type=s,c.request=i,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:o})}),12e4);o.onerror=o.onload=a,document.head.appendChild(o)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var i=window.observabilityAIAssistant_bundle_jsonpfunction=window.observabilityAIAssistant_bundle_jsonpfunction||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var o=0;o<i.length;o++)t(i[o]);var c=a;s(s.s=47)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){"use strict";n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return i.c})),n.d(t,"h",(function(){return i.d})),n.d(t,"e",(function(){return a.b})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d}));var r=n(14);let s=function(e){return e.AssistantOnly="assistantOnly",e.UserOnly="userOnly",e.Internal="internal",e.All="all",e}({});n(13);var i=n(6),a=n(8),o=n(10),c=n(5);const u=()=>e=>e.pipe(Object(c.scan)(((e,{message:t})=>{var n,r,s,i,a;return e.message.content+=null!==(n=t.content)&&void 0!==n?n:"",e.message.function_call.name+=null!==(r=null===(s=t.function_call)||void 0===s?void 0:s.name)&&void 0!==r?r:"",e.message.function_call.arguments+=null!==(i=null===(a=t.function_call)||void 0===a?void 0:a.arguments)&&void 0!==i?i:"",Object(o.cloneDeep)(e)}),{message:{content:"",function_call:{name:"",arguments:"",trigger:r.b.Assistant},role:r.b.Assistant}}));n(7);let l=function(e){return e.Bedrock=".bedrock",e.OpenAI=".gen-ai",e.Gemini=".gemini",e}({});function d(e){return e===l.Bedrock||e===l.OpenAI||e===l.Gemini}l.OpenAI,l.Bedrock,l.Gemini,n(16)},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return ChatCompletionError})),n.d(t,"d",(function(){return i})),n(3);let r=function(e){return e.ChatCompletionChunk="chatCompletionChunk",e.ConversationCreate="conversationCreate",e.ConversationUpdate="conversationUpdate",e.MessageAdd="messageAdd",e.ChatCompletionError="chatCompletionError",e.BufferFlush="bufferFlush",e.TokenCount="tokenCount",e}({}),s=function(e){return e.InternalError="internalError",e.NotFoundError="notFoundError",e.TokenLimitReachedError="tokenLimitReachedError",e.FunctionNotFoundError="functionNotFoundError",e.FunctionLimitExceededError="functionLimitExceededError",e}({});class ChatCompletionError extends Error{constructor(e,t,n={}){super(t),this.code=e,this.meta=n}}function i(e){return e instanceof ChatCompletionError&&e.code===s.TokenLimitReachedError}},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o}));const r={af:"Afrikaans",ak:"Akan",am:"አማርኛ",ar:"العربية",as:"অসমীয়া",az:"azərbaycan",be:"беларуская",bg:"български",bm:"bamanakan",bn:"বাংলা",bo:"བོད་སྐད་",br:"brezhoneg",bs:"bosanski",ca:"català",cs:"čeština",cy:"Cymraeg",da:"dansk",de:"Deutsch",de_AT:"Österreichisches Deutsch",de_CH:"Schweizer Hochdeutsch",dz:"རྫོང་ཁ",ee:"eʋegbe",el:"Ελληνικά",en:"English",en_AU:"Australian English",en_CA:"Canadian English",en_GB:"British English",en_US:"American English",eo:"esperanto",es:"español",es_ES:"español de España",es_MX:"español de México",et:"eesti",eu:"euskara",fa:"فارسی",ff:"Pulaar",fi:"suomi",fo:"føroyskt",fr:"français",fr_CA:"français canadien",fr_CH:"français suisse",fy:"West-Frysk",ga:"Gaeilge",gd:"Gàidhlig",gl:"galego",gu:"ગુજરાતી",gv:"Gaelg",ha:"Hausa",he:"עברית",hi:"हिंदी",hr:"hrvatski",hu:"magyar",hy:"հայերեն",id:"Bahasa Indonesia",ig:"Igbo",ii:"ꆈꌠꉙ",is:"íslenska",it:"italiano",ja:"日本語",ka:"ქართული",ki:"Gikuyu",kk:"қазақ тілі",kl:"kalaallisut",km:"ខ្មែរ",kn:"ಕನ್ನಡ",ko:"한국어",ks:"کٲشُر",kw:"kernewek",ky:"кыргызча",lb:"Lëtzebuergesch",lg:"Luganda",ln:"lingála",lo:"ລາວ",lt:"lietuvių",lu:"Tshiluba",lv:"latviešu",mg:"Malagasy",mk:"македонски",ml:"മലയാളം",mn:"монгол",mr:"मराठी",ms:"Bahasa Melayu",mt:"Malti",my:"ဗမာ",nb:"norsk bokmål",nd:"isiNdebele",ne:"नेपाली",nl:"Nederlands",nl_BE:"Vlaams",nn:"nynorsk",no:"norsk",om:"Oromoo",or:"ଓଡ଼ିଆ",os:"ирон",pa:"ਪੰਜਾਬੀ",pl:"polski",ps:"پښتو",pt:"português",pt_BR:"português do Brasil",pt_PT:"português europeu",qu:"Runasimi",rm:"rumantsch",rn:"Ikirundi",ro:"română",ro_MD:"moldovenească",ru:"русский",rw:"Kinyarwanda",se:"davvisámegiella",sg:"Sängö",sh:"Srpskohrvatski",si:"සිංහල",sk:"slovenčina",sl:"slovenščina",sn:"chiShona",so:"Soomaali",sq:"shqip",sr:"српски",sv:"svenska",sw:"Kiswahili",ta:"தமிழ்",te:"తెలుగు",th:"ไทย",ti:"ትግርኛ",tl:"Tagalog",to:"lea fakatonga",tr:"Türkçe",ug:"ئۇيغۇرچە",uk:"українська",ur:"اردو",uz:"oʻzbekcha",vi:"Tiếng Việt",yi:"ייִדיש",yo:"Èdè Yorùbá",zh:"中文",zh_Hans:"简体中文",zh_Hant:"繁體中文",zu:"isiZulu"},s={value:"locale_setting",label:"Kibana locale setting"},i={value:"browser_setting",label:"Browser language setting"},a=s,o=[s,i,...Object.entries(r).map((([e,t])=>({value:e,label:t})))]},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a}));const r="observability:aiAssistantLogsIndexPattern",s="observability:aiAssistantResponseLanguage",i="observability:aiAssistantSimulatedFunctionCalling",a="observability:aiAssistantSearchConnectorIndexPattern"},function(e,t,n){e.exports=n(33)(4)},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){"use strict";e.exports=n(51)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let r=function(e){return e.ChatFeedback="observability_ai_assistant_chat_feedback",e.InsightFeedback="observability_ai_assistant_insight_feedback",e.UserSentPromptInChat="observability_ai_assistant_user_sent_prompt_in_chat",e}({})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));let r=function(e){return e.generateQueryOnly="generateQueryOnly",e.executeAndReturnResults="executeAndReturnResults",e.visualizeAuto="visualizeAuto",e.visualizeXy="visualizeXy",e.visualizeBar="visualizeBar",e.visualizeLine="visualizeLine",e.visualizeArea="visualizeArea",e.visualizeTable="visualizeTable",e.visualizeDonut="visualizeDonut",e.visualizeTreemap="visualizeTreemap",e.visualizeHeatmap="visualizeHeatmap",e.visualizeTagcloud="visualizeTagcloud",e.visualizeWaffle="visualizeWaffle",e}({});const s=Object.values(r)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));let r=function(e){return e.System="system",e.Assistant="assistant",e.User="user",e.Function="function",e.Elastic="elastic",e}({}),s=function(e){return e.AssistantSummarization="assistant_summarization",e.UserEntry="user_entry",e.Elastic="elastic",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(24);const s=()=>Object(r.useKibana)()},function(e,t,n){e.exports=n(33)(2)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let r=function(e){return e.executeEsqlQuery="executeEsqlQuery",e.visualizeEsqlQuery="visualizeEsqlQuery",e.updateVisualization="updateVisualization",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));var r=n(2);const s=Object(r.createContext)(void 0),i=s.Provider},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(26),s=n(4),i=n(6);function a({name:e,content:t,data:n}){return{id:Object(r.v4)(),type:i.c.MessageAdd,message:{"@timestamp":(new Date).toISOString(),message:{content:JSON.stringify(t),...n?{data:JSON.stringify(n)}:{},name:e,role:s.c.User}}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(2),s=n(35),i=n.n(s),a=n(34);function o(){return c(Object(a.a)())}function c(e){var t;const[n,s]=Object(r.useState)(void 0),[a,o]=i()("xpack.observabilityAiAssistant.lastUsedConnector",""),[c,u]=Object(r.useState)(!1),[l,d]=Object(r.useState)(void 0),f=Object(r.useMemo)((()=>new AbortController),[]),p=Object(r.useCallback)((async()=>{u(!0),e.callApi("GET /internal/observability_ai_assistant/connectors",{signal:f.signal}).then((e=>{s(e),o((t=>t&&-1===e.findIndex((e=>e.id===t))?"":t)),d(void 0)})).catch((e=>{d(e),s(void 0)})).finally((()=>{u(!1)}))}),[e,f.signal,o]);return Object(r.useEffect)((()=>(p(),()=>{f.abort()})),[e,f,p,o]),{connectors:n,loading:c,error:l,selectedConnector:a||(null==n||null===(t=n[0])||void 0===t?void 0:t.id),selectConnector:e=>{o(e)},reloadConnectors:()=>{p()}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),s=n(3),i=n(1),a=n(15),o=n(0);const c=s.i18n.translate("xpack.observabilityAiAssistant.feedbackButtons.em.thanksForYourFeedbackLabel",{defaultMessage:"Thanks for your feedback"});function u({onClickFeedback:e}){const{notifications:t}=Object(a.a)().services,[n,u]=Object(r.useState)(!1);return Object(o.jsx)(i.EuiFlexGroup,{responsive:!1,direction:"row",alignItems:"center",gutterSize:"s",wrap:!0},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiText,{color:"subdued",size:"s"},Object(o.jsx)("em",null,s.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.title",{defaultMessage:"Was this helpful?"})))),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiFlexGroup,{responsive:!1,direction:"row",alignItems:"center",gutterSize:"xs"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantFeedbackButtonsPositiveButton",color:"success",disabled:n,iconType:"faceHappy",size:"s",onClick:()=>{e("positive"),u(!0),t.toasts.addSuccess(c)}},s.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.positive",{defaultMessage:"Yes"}))),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantFeedbackButtonsNegativeButton",color:"danger",disabled:n,iconType:"faceSad",size:"s",onClick:()=>{e("negative"),u(!0),t.toasts.addSuccess(c)}},s.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.negative",{defaultMessage:"No"}))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return g}));var r=n(3),s=n(10),i=n(2),a=n(37),o=n(4),c=n(15);function u(e){const t=Object(i.useRef)(e);return t.current!==e&&console.trace(`Variable changed from ${t.current} to ${e}, but only the initial value will be taken into account`),t.current}var l=n(25);let d=function(e){return e.Ready="ready",e.Loading="loading",e.Error="error",e.Aborted="aborted",e}({});function f(e,t){return[t,...e.filter((e=>e.message.role!==o.c.System))]}function p({initialMessages:e,initialConversationId:t,notifications:n,service:c,chatService:p,connectorId:b,onConversationUpdate:g,onChatComplete:m,persist:v,disableFunctions:h}){const[y,x]=Object(i.useState)(d.Ready),j=Object(i.useMemo)((()=>p.getSystemMessage()),[p]);u(e),u(t);const[O,k]=Object(i.useState)(t),[_,A]=Object(i.useState)(e),[S,E]=Object(i.useState)(),C=Object(i.useRef)(new AbortController),{getPreferredLanguage:w}=Object(l.a)(),I=Object(i.useRef)(m);I.current=m;const T=Object(i.useRef)(g);T.current=g;const z=Object(i.useCallback)((()=>{x(d.Aborted)}),[]),F=Object(i.useCallback)((e=>{e instanceof a.AbortError?x(d.Aborted):x(d.Error),Object(o.h)(e)?A((t=>{var n,s;return[...t,{"@timestamp":(new Date).toISOString(),message:{content:r.i18n.translate("xpack.observabilityAiAssistant.tokenLimitError",{defaultMessage:"The conversation has exceeded the token limit. The maximum token limit is **{tokenLimit}**, but the current conversation has **{tokenCount}** tokens. Please start a new conversation to continue.",values:{tokenLimit:null===(n=e.meta)||void 0===n?void 0:n.tokenLimit,tokenCount:null===(s=e.meta)||void 0===s?void 0:s.tokenCount}}),role:o.c.Assistant}}]})):n.toasts.addError(e,{title:r.i18n.translate("xpack.observabilityAiAssistant.failedToLoadResponse",{defaultMessage:"Failed to load response from the AI Assistant"})})}),[n.toasts]),P=Object(i.useCallback)((async e=>{if(C.current.signal.removeEventListener("abort",z),C.current.abort(),C.current=new AbortController,E([]),A(e),!b||!e.length)return void x(d.Ready);x(d.Loading);const t=p.complete({getScreenContexts:()=>c.getScreenContexts(),connectorId:b,messages:f(e,j),persist:v,disableFunctions:null!=h&&h,signal:C.current.signal,conversationId:O,responseLanguage:w()});function n(){return[...r,...i?[Object(s.merge)({message:{role:o.c.Assistant,function_call:{trigger:o.c.Assistant}}},i)]:[]]}const r=[];let i;const a=t.subscribe({next:e=>{var t,s;switch(e.type){case o.d.ChatCompletionChunk:var a,c,u,l;i?(i.message.content+=e.message.content||"",i.message.function_call.name+=(null===(a=e.message.function_call)||void 0===a?void 0:a.name)||"",i.message.function_call.arguments+=(null===(c=e.message.function_call)||void 0===c?void 0:c.arguments)||""):i={"@timestamp":(new Date).toISOString(),message:{content:e.message.content||"",function_call:{name:(null===(u=e.message.function_call)||void 0===u?void 0:u.name)||"",arguments:(null===(l=e.message.function_call)||void 0===l?void 0:l.arguments)||""}}};break;case o.d.MessageAdd:i=void 0,r.push(e.message);break;case o.d.ConversationCreate:k(e.conversation.id),null===(t=T.current)||void 0===t||t.call(T,e);break;case o.d.ConversationUpdate:null===(s=T.current)||void 0===s||s.call(T,e)}E(n())},complete:()=>{var t;x(d.Ready);const n=e.concat(r);A(n),E([]),null===(t=I.current)||void 0===t||t.call(I,n)},error:t=>{E([]),A(e.concat(n())),F(t)}});C.current.signal.addEventListener("abort",(()=>{z(),a.unsubscribe()}))}),[p,b,O,F,z,v,h,c,j,w]);return Object(i.useEffect)((()=>()=>{C.current.abort()}),[]),{messages:Object(i.useMemo)((()=>f(_.concat(null!=S?S:[]),j)),[j,_,S]),setMessages:Object(i.useCallback)((e=>{C.current.abort(),E([]),x(d.Ready),A(e)}),[]),state:y,next:P,stop:()=>{C.current.abort()}}}function b(e){const{services:{notifications:t}}=Object(c.a)();return p({...e,notifications:t})}function g({notifications:e}){return t=>p({...t,notifications:e})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2);const s=Object(r.createContext)(void 0)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),s=n(2),i=n(7),a=n(4),o=n(15);function c(){const{services:{uiSettings:e}}=Object(o.a)(),t=e.get(a.e,i.b.value),n=Object(s.useCallback)((()=>t===i.c.value?function(){switch(r.i18n.getLocale()){case"en":default:return"English";case"zh-cn":return"简体中文";case"ja-jp":return"日本語";case"fr-fr":return"français"}}():t===i.a.value?i.e[navigator.language]||"English":i.e[t]||"English"),[t]);return{selectedLanguage:t,getPreferredLanguage:n}}},function(e,t){e.exports=__kbnSharedDeps__.Uuid},function(e,t){e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n(2);var r=n(0);const s={xl:64,l:48,m:32,s:24,xs:16};function i({size:e="s",css:t,className:n}){const i=s[e];return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 64 64",fill:"none",css:t,className:n},Object(r.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(r.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(r.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(r.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),s=(n(2),n(3)),i=n(11),a=n(0);const o=Object(i.css)({name:"1najbre",styles:"height:32px;.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}"}),c=Object(i.css)({name:"rnnx2x",styles:"font-size:12px"});function u(e){var t;return e.loading?Object(a.jsx)(r.EuiFlexGroup,{alignItems:"center",className:o},Object(a.jsx)(r.EuiFlexItem,null,Object(a.jsx)(r.EuiLoadingSpinner,{size:"s"}))):e.error?Object(a.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"s",className:o},Object(a.jsx)(r.EuiFlexItem,{grow:!1},Object(a.jsx)(r.EuiIcon,{type:"warning",color:"danger",size:"s"})),Object(a.jsx)(r.EuiFlexItem,{grow:!1},Object(a.jsx)(r.EuiText,{size:"xs",color:"danger"},s.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.error",{defaultMessage:"Failed to load connectors"})))):null!==(t=e.connectors)&&void 0!==t&&t.length?Object(a.jsx)(r.EuiFlexGroup,{className:o,direction:"row",alignItems:"center",gutterSize:"xs",responsive:!1},Object(a.jsx)(r.EuiFlexItem,{grow:!0},Object(a.jsx)(r.EuiSuperSelect,{compressed:!0,valueOfSelected:e.selectedConnector,options:e.connectors.map((e=>({value:e.id,inputDisplay:Object(a.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},Object(a.jsx)(r.EuiFlexItem,{grow:!1},Object(a.jsx)(r.EuiText,{size:"xs",color:"subdued"},s.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.connectorSelectLabel",{defaultMessage:"Connector:"}))),Object(a.jsx)(r.EuiFlexItem,{grow:!0},Object(a.jsx)(r.EuiTextTruncate,{text:e.name,className:c,truncation:"end"}))),dropdownDisplay:Object(a.jsx)(r.EuiText,{size:"xs"},e.name)}))),onChange:t=>{e.selectConnector(t)}}))):Object(a.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"s",className:o},Object(a.jsx)(r.EuiFlexItem,{grow:!1},Object(a.jsx)(r.EuiText,{size:"xs",color:"warning"},s.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.empty",{defaultMessage:"No connectors"}))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44),s=n(2);function i(e,t,n){const i=null==n?void 0:n.clearValueOnNext,a=Object(s.useRef)(new AbortController),[o,c]=Object(s.useState)(0),[u,l]=Object(s.useState)(),[d,f]=Object(s.useState)(!1),[p,b]=Object(s.useState)(null==n?void 0:n.defaultValue);return Object(s.useEffect)((()=>{a.current.abort();const t=new AbortController;a.current=t,i&&(b(void 0),l(void 0));try{const n=e({signal:t.signal});Object(r.isPromise)(n)?(f(!0),n.then((e=>{l(void 0),b(e)})).catch((e=>{b(void 0),l(e)})).finally((()=>f(!1)))):(l(void 0),b(n),f(!1))}catch(e){b(void 0),l(e),f(!1)}return()=>{t.abort()}}),t.concat(o,i)),Object(s.useMemo)((()=>({error:u,loading:d,value:p,refresh:()=>{c((e=>e+1))}})),[u,p,d])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),s=(n(2),n(3)),i=n(0);function a(){return Object(i.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},Object(i.jsx)(r.EuiFlexItem,{grow:!1},Object(i.jsx)(r.EuiIcon,{type:"alert",color:"danger",size:"s"})),Object(i.jsx)(r.EuiFlexItem,null,Object(i.jsx)(r.EuiText,{size:"s",color:"danger"},s.i18n.translate("xpack.observabilityAiAssistant.failedLoadingResponseText",{defaultMessage:"Failed to load response"}))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n(9),s=n.n(r),i=n(1),a=n(11),o=n(45),c=n.n(o),u=n(2),l=n.n(u),d=n(3),f=n(17),p=n(0);const b=e=>Object(a.css)("background-color:",e.euiTheme.colors.lightestShade,";.euiCodeBlock__pre{margin-bottom:0;padding:",e.euiTheme.size.m,";min-block-size:48px;}.euiCodeBlock__controls{inset-block-start:",e.euiTheme.size.m,";inset-inline-end:",e.euiTheme.size.m,";}","");function g({children:e}){const t=Object(i.useEuiTheme)();return Object(p.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"s",className:b(t)},e)}function m({children:e}){return Object(p.jsx)(g,null,Object(p.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(p.jsx)(i.EuiFlexItem,{grow:!1},Object(p.jsx)(i.EuiCodeBlock,{isCopyable:!0,fontSize:"m"},e))))}function v({value:e,actionsDisabled:t,onActionClick:n}){return Object(p.jsx)(g,null,Object(p.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(p.jsx)(i.EuiFlexItem,{grow:!1},Object(p.jsx)(i.EuiCodeBlock,{isCopyable:!0,fontSize:"m"},e)),Object(p.jsx)(i.EuiFlexItem,null,Object(p.jsx)(i.EuiFlexGroup,{direction:"row",gutterSize:"s"},Object(p.jsx)(i.EuiFlexItem,{grow:!1},Object(p.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantEsqlCodeBlockRunThisQueryButton",size:"xs",iconType:"play",onClick:()=>n({type:f.a.executeEsqlQuery,query:e}),disabled:t},d.i18n.translate("xpack.observabilityAiAssistant.runThisQuery",{defaultMessage:"Display results"}))),Object(p.jsx)(i.EuiFlexItem,{grow:!1},Object(p.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantEsqlCodeBlockVisualizeThisQueryButton",size:"xs",iconType:"lensApp",onClick:()=>n({type:f.a.visualizeEsqlQuery,query:e}),disabled:t},d.i18n.translate("xpack.observabilityAiAssistant.visualizeThisQuery",{defaultMessage:"Visualize this query"})))))))}const h=Object(a.css)("@keyframes blink{0%{opacity:0;}50%{opacity:1;}100%{opacity:0;}}animation:blink ",1,"s infinite;width:10px;height:16px;vertical-align:middle;display:inline-block;background:rgba(0, 0, 0, 0.25);",""),y=()=>Object(p.jsx)("span",{key:"cursor",className:c()(h,"cursor")}),x=" ᠎  ",j=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}if("text"!==t.type&&"inlineCode"!==t.type&&"code"!==t.type)return;const r=t;if(-1===r.value.indexOf(x))return;r.value=r.value.replace(x,"");const s=n.children.indexOf(r);n.children.splice(s+1,0,{type:"cursor",value:x})};return t=>{e(t)}},O=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}"code"===t.type&&"esql"===t.lang?t.type="esql":"code"===t.type&&(t.type="codeBlock")};return t=>{e(t)}};function k({loading:e,content:t,onActionClick:n}){const r=Object(a.css)({name:"26bywx",styles:"overflow-wrap:anywhere"}),o=Object(u.useRef)(n);o.current=n;const{parsingPluginList:c,processingPluginList:d}=Object(u.useMemo)((()=>{const t=Object(i.getDefaultEuiMarkdownParsingPlugins)(),n=Object(i.getDefaultEuiMarkdownProcessingPlugins)(),{components:r}=n[1][1];return n[1][1].components={...r,cursor:y,codeBlock:e=>Object(p.jsx)(l.a.Fragment,null,Object(p.jsx)(m,null,e.value),Object(p.jsx)(i.EuiSpacer,{size:"m"})),esql:t=>Object(p.jsx)(l.a.Fragment,null,Object(p.jsx)(v,{value:t.value,actionsDisabled:e,onActionClick:o.current}),Object(p.jsx)(i.EuiSpacer,{size:"m"})),table:e=>Object(p.jsx)(l.a.Fragment,null,Object(p.jsx)(i.EuiTable,e),Object(p.jsx)(i.EuiSpacer,{size:"m"})),th:e=>{const{children:t,...n}=e;return Object(p.jsx)(i.EuiTableHeaderCell,n,t)},tr:e=>Object(p.jsx)(i.EuiTableRow,e),td:e=>{const{children:t,...n}=e;return Object(p.jsx)(i.EuiTableRowCell,s()({truncateText:!0},n),t)}},{parsingPluginList:[j,O,...t],processingPluginList:n}}),[e]);return Object(p.jsx)(i.EuiText,{size:"s",className:r},Object(p.jsx)(i.EuiMarkdownFormat,{textSize:"s",parsingPluginList:c,processingPluginList:d},`${t}${e?x:""}`))}},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),s=n(18);function i(){const e=Object(r.useContext)(s.a);if(!e)throw new Error("ObservabilityAIAssistantContext not set. Did you wrap your component in `<ObservabilityAIAssistantProvider/>`?");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),s=n(49),i=function(){};t.default=function(e,t,n){if(!s.isClient)return[t,i,i];if(!e)throw new Error("useLocalStorage key may not be falsy");var a=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=r.useState((function(){try{var r=n?n.raw?String:n.serializer:JSON.stringify,s=localStorage.getItem(e);return null!==s?a(s):(t&&localStorage.setItem(e,r(t)),t)}catch(e){return t}})),c=o[0],u=o[1],l=r.useCallback((function(t){try{var r="function"==typeof t?t(c):t;if(void 0===r)return;var s;s=n?n.raw?"string"==typeof r?r:JSON.stringify(r):n.serializer?n.serializer(r):JSON.stringify(r):JSON.stringify(r),localStorage.setItem(e,s),u(a(s))}catch(e){}}),[e,u]),d=r.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[c,l,d]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),s=n(23);function i(){const e=Object(r.useContext)(s.a);if(!e)throw new Error("ObservabilityAIAssistantChatServiceContext not set. Did you wrap your component in `<ObservabilityAIAssistantChatServiceContext.Provider/>`?");return e}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t,n){"use strict";e.exports=n(53)},function(e,t,n){"use strict";e.exports=n(60)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9),s=n.n(r),i=n(1),a=(n(2),n(3)),o=n(0);function c(e){return Object(o.jsx)(i.EuiButtonEmpty,s()({"data-test-subj":"observabilityAiAssistantStopGeneratingButton",color:"text",iconType:"stop",size:"s"},e),a.i18n.translate("xpack.observabilityAiAssistant.stopGeneratingButtonLabel",{defaultMessage:"Stop generating"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9),s=n.n(r),i=n(1),a=(n(2),n(3)),o=n(0);function c(e){return Object(o.jsx)(i.EuiButtonEmpty,s()({size:"s","data-test-subj":"observabilityAiAssistantRegenerateResponseButton",iconType:"sparkles"},e),a.i18n.translate("xpack.observabilityAiAssistant.regenerateResponseButtonLabel",{defaultMessage:"Regenerate"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(12);const s={"@timestamp":{type:"text",_meta:{description:"The timestamp of the message."}},message:{properties:{content:{type:"text",_meta:{description:"The response generated by the LLM.",optional:!0}},name:{type:"text",_meta:{description:"The name of the function that was executed.",optional:!0}},role:{type:"text",_meta:{description:"The actor that generated the response."}},data:{type:"text",_meta:{description:"",optional:!0}},function_call:{_meta:{description:"The function call that was executed.",optional:!0},properties:{name:{type:"text",_meta:{description:"The name of the function that was executed.",optional:!1}},arguments:{type:"text",_meta:{description:"The arguments that were used when executing the function.",optional:!0}},trigger:{type:"text",_meta:{description:"The actor which triggered the execution of this function."}}}}}}},i=[{eventType:r.a.ChatFeedback,schema:{messageWithFeedback:{properties:{message:{properties:s},feedback:{type:"text",_meta:{description:"Whether the user has deemed this response useful or not"}}}},conversation:{properties:{"@timestamp":{type:"text",_meta:{description:"The timestamp of the conversation."}},user:{properties:{id:{type:"text",_meta:{description:"The id of the user.",optional:!0}},name:{type:"text",_meta:{description:"The name of the user."}}}},conversation:{properties:{id:{type:"text",_meta:{description:"The id of the conversation."}},title:{type:"text",_meta:{description:"The title of the conversation."}},last_updated:{type:"text",_meta:{description:"The timestamp of the last message in the conversation."}},token_count:{properties:{completion:{type:"long",_meta:{description:"The number of tokens in the completion."}},prompt:{type:"long",_meta:{description:"The number of tokens in the prompt."}},total:{type:"long",_meta:{description:"The total number of tokens in the conversation."}}}}}},messages:{type:"array",items:{properties:s},_meta:{description:"The messages in the conversation."}},labels:{type:"pass_through",_meta:{description:"The labels of the conversation."}},numeric_labels:{type:"pass_through",_meta:{description:"The numeric labels of the conversation."}},namespace:{type:"text",_meta:{description:"The namespace of the conversation."}},public:{type:"boolean",_meta:{description:"Whether the conversation is public or not."}}}}}},{eventType:r.a.InsightFeedback,schema:{feedback:{type:"text",_meta:{description:"Whether the user has deemed this response useful or not"}},message:{properties:s}}},{eventType:r.a.UserSentPromptInChat,schema:s}],a=e=>{i.forEach((t=>{e.registerEventType(t)}))};function o(e,t){e.reportEvent(t.type,t.payload)}},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,n){n(48),__kbnBundles__.define("plugin/observabilityAIAssistant/public",n,61)},function(e,t,n){n.p=window.__kbnPublicPath__.observabilityAIAssistant},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var r=n(46).__importDefault(n(50));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=r.default},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(s=r;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=r;0!=s--;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;0!=s--;){var a=i[s];if(!("_owner"===a&&t.$$typeof||e(t[a],n[a])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52);n(38),n(39),n(40);var s=r.default({key:"css"}),i=s.flush,a=s.hydrate,o=s.cx,c=s.merge,u=s.getRegisteredStyles,l=s.injectGlobal,d=s.keyframes,f=s.css,p=s.sheet,b=s.cache;t.cache=b,t.css=f,t.cx=o,t.flush=i,t.getRegisteredStyles=u,t.hydrate=a,t.injectGlobal=l,t.keyframes=d,t.merge=c,t.sheet=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),s=n(39),i=n(40);function a(e){return e&&e.__esModule?e:{default:e}}var o=a(r);function c(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,n){var r=[],s=i.getRegisteredStyles(e,r,n);return r.length<2?n:s+t(r)}var l=function e(t){for(var n="",r=0;r<t.length;r++){var s=t[r];if(null!=s){var i=void 0;switch(typeof s){case"boolean":break;case"object":if(Array.isArray(s))i=e(s);else for(var a in i="",s)s[a]&&a&&(i&&(i+=" "),i+=a);break;default:i=s}i&&(n&&(n+=" "),n+=i)}}return n};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=s.serializeStyles(n,t.registered,void 0);return i.insertStyles(t,a,!1),t.key+"-"+a.name};return{css:n,cx:function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return u(t.registered,n,l(r))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=s.serializeStyles(n,t.registered);c(t,i)},keyframes:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=s.serializeStyles(n,t.registered),a="animation-"+i.name;return c(t,{name:i.name,styles:"@keyframes "+a+"{"+i.styles+"}"}),a},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:i.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(54),s=n(56),i=n(58);function a(e){return e&&e.__esModule?e:{default:e}}var o=a(r),c=a(s),u=/[A-Z]|^ms/g,l=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},f=function(e){return null!=e&&"boolean"!=typeof e},p=a(i).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),b=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(l,(function(e,t,n){return m={name:t,styles:n,next:m},t}))}return 1===c.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function g(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return m={name:n.name,styles:n.styles,next:m},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)m={name:r.name,styles:r.styles,next:m},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=g(e,t,n[s])+";";else for(var i in n){var a=n[i];if("object"!=typeof a)null!=t&&void 0!==t[a]?r+=i+"{"+t[a]+"}":f(a)&&(r+=p(i)+":"+b(i,a)+";");else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=t&&void 0!==t[a[0]]){var o=g(e,t,a);switch(i){case"animation":case"animationName":r+=p(i)+":"+o+";";break;default:r+=i+"{"+o+"}"}}else for(var c=0;c<a.length;c++)f(a[c])&&(r+=p(i)+":"+b(i,a[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var s=m,i=n(e);return m=s,g(e,t,i)}}if(null==t)return n;var a=t[n];return void 0!==a?a:n}var m,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,s="";m=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,s+=g(n,t,i)):s+=i[0];for(var a=1;a<e.length;a++)s+=g(n,t,e[a]),r&&(s+=i[a]);v.lastIndex=0;for(var c,u="";null!==(c=v.exec(s));)u+="-"+c[1];return{name:o.default(s)+u,styles:s,next:m}}},function(e,t,n){"use strict";e.exports=n(55)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,r=0,s=e.length;s>=4;++r,s-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(s){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(57)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";e.exports=n(59)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof document,s=function(e,t,n){var s=e.key+"-"+t.name;(!1===n||!1===r&&void 0!==e.compat)&&void 0===e.registered[s]&&(e.registered[s]=t.styles)};t.getRegisteredStyles=function(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r},t.insertStyles=function(e,t,n){s(e,t,n);var i=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a="",o=t;do{var c=e.insert(t===o?"."+i:"",o,e.sheet,!0);r||void 0===c||(a+=c),o=o.next}while(void 0!==o);if(!r&&0!==a.length)return a}},t.registerStyles=s},function(e,t,n){"use strict";n.r(t),n.d(t,"aiAssistantCapabilities",(function(){return L})),n.d(t,"AssistantAvatar",(function(){return R.a})),n.d(t,"ConnectorSelectorBase",(function(){return B.a})),n.d(t,"useAbortableAsync",(function(){return D.a})),n.d(t,"useGenAIConnectorsWithoutContext",(function(){return x.b})),n.d(t,"createStorybookChatService",(function(){return G})),n.d(t,"createStorybookService",(function(){return N})),n.d(t,"createScreenContextAction",(function(){return P})),n.d(t,"ChatState",(function(){return k.a})),n.d(t,"FeedbackButtons",(function(){return U.a})),n.d(t,"ChatItemControls",(function(){return V})),n.d(t,"FailedToLoadResponse",(function(){return $.a})),n.d(t,"MessageText",(function(){return J.a})),n.d(t,"ChatActionClickType",(function(){return K.a})),n.d(t,"VisualizeESQLUserIntention",(function(){return Z.b})),n.d(t,"VISUALIZE_ESQL_USER_INTENTIONS",(function(){return Z.a})),n.d(t,"isSupportedConnectorType",(function(){return E.g})),n.d(t,"FunctionVisibility",(function(){return E.a})),n.d(t,"MessageRole",(function(){return E.c})),n.d(t,"KnowledgeBaseEntryRole",(function(){return E.b})),n.d(t,"concatenateChatCompletionChunks",(function(){return E.f})),n.d(t,"StreamingChatResponseEventType",(function(){return E.d})),n.d(t,"ObservabilityAIAssistantTelemetryEventType",(function(){return X.a})),n.d(t,"createFunctionRequestMessage",(function(){return w})),n.d(t,"createFunctionResponseMessage",(function(){return I.a})),n.d(t,"LANGUAGE_OPTIONS",(function(){return Y.d})),n.d(t,"DEFAULT_LANGUAGE_OPTION",(function(){return Y.b})),n.d(t,"aiAssistantResponseLanguage",(function(){return ee.b})),n.d(t,"aiAssistantLogsIndexPattern",(function(){return ee.a})),n.d(t,"aiAssistantSimulatedFunctionCalling",(function(){return ee.d})),n.d(t,"aiAssistantSearchConnectorIndexPattern",(function(){return ee.c})),n.d(t,"plugin",(function(){return te}));var r=n(9),s=n.n(r),i=n(16),a=n.n(i),o=n(24),c=n(27),u=n(2),l=n.n(u),d=n(1),f=n(0),p={name:"1azakc",styles:"text-align:center"};const b=()=>{const e=p;return Object(f.jsx)("div",{css:e},Object(f.jsx)(d.EuiLoadingSpinner,null))},g=(e,t=Object(f.jsx)(b,null))=>l.a.forwardRef(((n,r)=>Object(f.jsx)(c.KibanaErrorBoundaryProvider,{analytics:n.analytics},Object(f.jsx)(c.KibanaErrorBoundary,null,Object(f.jsx)(u.Suspense,{fallback:t},Object(f.jsx)(e,s()({},n,{ref:r})))))));var m=n(43),v=n(23);const h=Object(u.createContext)(void 0);var y=n(18),x=n(20),j=n(36),O=n(25),k=n(22),_=n(10),A=n(5),S=n(26),E=n(4),C=n(6);function w({name:e,args:t}){return{id:Object(S.v4)(),type:C.c.MessageAdd,message:{"@timestamp":(new Date).toISOString(),message:{function_call:{name:e,arguments:JSON.stringify(t),trigger:E.c.Assistant},role:E.c.Assistant,content:""}}}}var I=n(19);var T=n(3);const z=[{title:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.exampleQuestions.title",{defaultMessage:"Suggest"}),prompt:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.exampleQuestions.prompt",{defaultMessage:"Give me examples of questions I can ask here."}),icon:"sparkles"},{title:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.explainThisPage.title",{defaultMessage:"Explain"}),prompt:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.explainThisPage.prompt",{defaultMessage:"Can you explain this page?"}),icon:"inspect"},{title:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.doIHaveAlerts.title",{defaultMessage:"Alerts"}),prompt:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.doIHaveAlerts.prompt",{defaultMessage:"Do I have any alerts?"}),icon:"bell"},{title:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.whatAreSlos.title",{defaultMessage:"SLOs"}),prompt:T.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.whatAreSlos.prompt",{defaultMessage:"What are SLOs?"}),icon:"bullseye"}];function F({analytics:e,coreStart:t,enabled:r}){const s=(i=t,(e,t)=>{const{params:n}=t,{method:r,pathname:s,version:a}=function(e,t={}){const{method:n,pathname:r,version:s}=function(e){var t;const n=e.split(" "),r=n[0].trim().toLowerCase(),s=n[1].trim(),i=null===(t=n[2])||void 0===t?void 0:t.trim();if(!["get","post","put","delete"].includes(r))throw new Error(`Endpoint ${e} was not prefixed with a valid HTTP method`);if(!i&&s.startsWith("/api"))throw new Error(`Missing version for public endpoint ${e}`);return{method:r,pathname:s,version:i}}(e);return{method:n,pathname:Object.keys(t).reduce(((e,n)=>e.replace(`{${n}}`,t[n])),r),version:s}}(e,null==n?void 0:n.path);return i.http[r](s,{...t,body:n&&n.body?JSON.stringify(n.body):void 0,query:null==n?void 0:n.query,version:a})});var i;const a=[],o=new A.BehaviorSubject([{starterPrompts:z}]),c=new A.Subject;return{isEnabled:()=>r,register:e=>{a.push(e)},start:async({signal:t})=>{const r=await n.e(2).then(n.bind(null,66));return await r.createChatService({analytics:e,apiClient:s,signal:t,registrations:a})},callApi:s,getScreenContexts:()=>o.value,setScreenContext:e=>(o.next(o.value.concat(e)),function(){o.next(Object(_.without)(o.value,e))}),navigate:async e=>(e(),await Object(A.lastValueFrom)(t.http.getLoadingCount$().pipe(Object(A.filter)((e=>0===e)),Object(A.debounceTime)(1e3),Object(A.take)(1))),Object(A.of)(w({name:"context"}),Object(I.a)({name:"context",content:{screenDescription:Object(_.compact)(o.value.map((e=>e.screenDescription))).join("\n\n")}}))),conversations:{openNewConversation:({messages:e,title:t})=>{c.next({messages:e,title:t})},predefinedConversation$:c.asObservable()}}}function P(e,t){return{...e,respond:t}}function M({message:e,instructions:t}){return[{"@timestamp":(new Date).toISOString(),message:{role:E.c.User,content:e}},{"@timestamp":(new Date).toISOString(),message:{role:E.c.Assistant,function_call:{name:"get_contextual_insight_instructions",trigger:E.c.Assistant,arguments:JSON.stringify({})}}},{"@timestamp":(new Date).toISOString(),message:{role:E.c.User,content:JSON.stringify({instructions:t}),name:"get_contextual_insight_instructions"}}]}const L={show:"show"};class plugin_ObservabilityAIAssistantPlugin{constructor(e){a()(this,"logger",void 0),a()(this,"service",void 0),this.logger=e.logger.get()}setup(e,t){return Object(m.a)(e.analytics),{}}start(e,t){const r=this.service=F({analytics:e.analytics,coreStart:e,enabled:!0===e.application.capabilities.observabilityAIAssistant[L.show]}),i={...e,plugins:{start:t}},a=r.isEnabled();return{service:r,useGenAIConnectors:()=>Object(x.b)(r),useChat:Object(k.b)({notifications:e.notifications}),useUserPreferredLanguage:O.a,ObservabilityAIAssistantMultipaneFlyoutContext:h,ObservabilityAIAssistantChatServiceContext:v.a,useObservabilityAIAssistantChatService:j.a,ObservabilityAIAssistantContextualInsight:a?g(((e,t)=>l.a.forwardRef(((n,i)=>Object(f.jsx)(o.KibanaContextProvider,{services:t},Object(f.jsx)(y.b,{value:r},Object(f.jsx)(e,s()({},n,{ref:i})))))))(Object(u.lazy)((()=>n.e(1).then(n.bind(null,65)).then((e=>({default:e.Insight}))))),i)):null,getContextualInsightMessages:M,createScreenContextAction:P}}}var R=n(28),B=n(29),D=n(30);const G=()=>({sendAnalyticsEvent:()=>{},chat:e=>new A.Observable,complete:e=>new A.Observable,getFunctions:()=>[{name:"elasticsearch",description:"Call Elasticsearch APIs on behalf of the user",descriptionForUser:"Call Elasticsearch APIs on behalf of the user",parameters:{type:"object",properties:{method:{type:"string",description:"The HTTP method of the Elasticsearch endpoint",enum:["GET","PUT","POST","DELETE","PATCH"]},path:{type:"string",description:"The path of the Elasticsearch endpoint, including query parameters"}},required:["method","path"]}},{name:"get_service_summary",description:"Gets a summary of a single service, including: the language, service version, deployments, infrastructure, alerting, etc. ",descriptionForUser:"Get a summary for a single service.",parameters:{type:"object"}}],renderFunction:e=>Object(f.jsx)("div",null,T.i18n.translate("xpack.observabilityAiAssistant.chatService.div.helloLabel",{defaultMessage:"Hello"}),e),hasFunction:()=>!0,hasRenderFunction:()=>!0,getSystemMessage:()=>({"@timestamp":(new Date).toISOString(),message:{role:E.c.System,content:"System"}})}),N=()=>({isEnabled:()=>!0,start:async()=>G(),callApi:{},register:()=>{},setScreenContext:()=>_.noop,getScreenContexts:()=>[],conversations:{openNewConversation:_.noop,predefinedConversation$:new A.Observable},navigate:async()=>Object(A.of)()});var U=n(21),q=n(11),H=n(41),Q=n(42);const W=Object(q.css)({name:"1kr8da6",styles:"padding-top:4px;padding-bottom:4px"});function V({error:e,loading:t,canRegenerate:n,canGiveFeedback:r,onFeedbackClick:s,onRegenerateClick:i,onStopGeneratingClick:a}){const{euiTheme:o}=Object(d.useEuiTheme)(),c=!e&&r,u=!t&&n;let p;return p=t?Object(f.jsx)(H.a,{onClick:a}):c||u?Object(f.jsx)(d.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},c?Object(f.jsx)(d.EuiFlexItem,{grow:!0},Object(f.jsx)(U.a,{onClickFeedback:s})):null,u?Object(f.jsx)(d.EuiFlexItem,{grow:!1},Object(f.jsx)(Q.a,{onClick:i})):null):null,p?Object(f.jsx)(l.a.Fragment,null,Object(f.jsx)(d.EuiHorizontalRule,{margin:"none",color:o.colors.lightestShade}),Object(f.jsx)(d.EuiPanel,{hasShadow:!1,paddingSize:"s",className:W},p)):null}var $=n(31),J=n(32),K=n(17),Z=n(13),X=n(12),Y=n(7),ee=n(8);const te=e=>new plugin_ObservabilityAIAssistantPlugin(e)}]);