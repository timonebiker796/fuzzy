(window.savedObjectsManagement_bundle_jsonpfunction=window.savedObjectsManagement_bundle_jsonpfunction||[]).push([[3],{48:function(e,t,s){var a,n=n||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,s=function(){return e.URL||e.webkitURL||e},a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in a,i=e.webkitRequestFileSystem,o=e.requestFileSystem||i||e.mozRequestFileSystem,l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},r="application/octet-stream",c=0,d=function(t){var a=function(){"string"==typeof t?s().revokeObjectURL(t):t.remove()};e.chrome?a():setTimeout(a,500)},u=function(e,t,s){for(var a=(t=[].concat(t)).length;a--;){var n=e["on"+t[a]];if("function"==typeof n)try{n.call(e,s||e)}catch(e){l(e)}}},b=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},p=function(t,l,p){p||(t=b(t));var j,m,h,g=this,O=t.type,f=!1,x=function(){u(g,"writestart progress write writeend".split(" "))},v=function(){!f&&j||(j=s().createObjectURL(t)),m?m.location.href=j:null==e.open(j,"_blank")&&"undefined"!=typeof safari&&(e.location.href=j),g.readyState=g.DONE,x(),d(j)},M=function(e){return function(){if(g.readyState!==g.DONE)return e.apply(this,arguments)}},y={create:!0,exclusive:!1};if(g.readyState=g.INIT,l||(l="download"),n)return j=s().createObjectURL(t),a.href=j,a.download=l,void setTimeout((function(){var e,t;e=a,t=new MouseEvent("click"),e.dispatchEvent(t),x(),d(j),g.readyState=g.DONE}));e.chrome&&O&&O!==r&&(h=t.slice||t.webkitSlice,t=h.call(t,0,t.size,r),f=!0),i&&"download"!==l&&(l+=".download"),(O===r||i)&&(m=e),o?(c+=t.size,o(e.TEMPORARY,c,M((function(e){e.root.getDirectory("saved",y,M((function(e){var s=function(){e.getFile(l,y,M((function(e){e.createWriter(M((function(s){s.onwriteend=function(t){m.location.href=e.toURL(),g.readyState=g.DONE,u(g,"writeend",t),d(e)},s.onerror=function(){var e=s.error;e.code!==e.ABORT_ERR&&v()},"writestart progress write abort".split(" ").forEach((function(e){s["on"+e]=g["on"+e]})),s.write(t),g.abort=function(){s.abort(),g.readyState=g.DONE},g.readyState=g.WRITING})),v)})),v)};e.getFile(l,{create:!1},M((function(e){e.remove(),s()})),M((function(e){e.code===e.NOT_FOUND_ERR?s():v()})))})),v)})),v)):v()},j=p.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,s){return s||(e=b(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(j.abort=function(){var e=this;e.readyState=e.DONE,u(e,"abort")},j.readyState=j.INIT=0,j.WRITING=1,j.DONE=2,j.error=j.onwritestart=j.onprogress=j.onwrite=j.onabort=j.onerror=j.onwriteend=null,function(e,t,s){return new p(e,t,s)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=n:null!==s(49)&&null!=s(50)&&(void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a))},49:function(e,t,s){e.exports=s(8)(1784)},50:function(e,t){(function(t){e.exports=t}).call(this,{})},51:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(52);case"v8light":return s(54)}},52:function(e,t,s){var a=s(24),n=s(53);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},53:function(e,t,s){(t=s(25)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#7dded8}.savedObjectsManagementImportSummary__errorCount{color:#f86b63}.savedObjectsManagementImportSummary__icon{margin-left:4px}",""]),e.exports=t},54:function(e,t,s){var a=s(24),n=s(55);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},55:function(e,t,s){(t=s(25)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#007e77}.savedObjectsManagementImportSummary__errorCount{color:#bd271e}.savedObjectsManagementImportSummary__icon{margin-left:4px}",""]),e.exports=t},59:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return V}));var a=s(4),n=s.n(a),i=s(13),o=s(7),l=s.n(o),r=s(6),c=s(27),d=s(1),u=s(0),b=s.n(u),p=s(48),j=s(61),m=s(3),h=s(12),g=s(2);const O=({onExportAll:e,onImport:t,onRefresh:s,filteredCount:a})=>Object(g.jsx)(r.EuiPageHeader,{pageTitle:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.savedObjectsTitle",defaultMessage:"Saved Objects"}),description:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.howToDeleteSavedObjectsDescription",defaultMessage:"Manage and share your saved objects. To edit the underlying data of an object, go to its associated application."}),bottomBorder:!0,rightSideItems:[Object(g.jsx)(r.EuiButtonEmpty,{size:"s",iconType:"exportAction","data-test-subj":"exportAllObjects",onClick:e},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.exportButtonLabel",defaultMessage:"Export {filteredCount, plural, one{# object} other {# objects}}",values:{filteredCount:a}})),Object(g.jsx)(r.EuiButtonEmpty,{size:"s",iconType:"importAction","data-test-subj":"importObjects",onClick:t},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.importButtonLabel",defaultMessage:"Import"})),Object(g.jsx)(r.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:s},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.refreshButtonLabel",defaultMessage:"Refresh"}))]});var f=s(16),x=s.n(f);const v=1e4;class table_Table extends a.PureComponent{constructor(e){super(e),b()(this,"state",{isSearchTextValid:!0,parseErrorMessage:null,isExportPopoverOpen:!1,isIncludeReferencesDeepChecked:!0,activeAction:void 0}),b()(this,"onChange",(({query:e,error:t})=>{t?this.setState({isSearchTextValid:!1,parseErrorMessage:t.message}):(this.setState({isSearchTextValid:!0,parseErrorMessage:null}),this.props.onQueryChange({query:e}))})),b()(this,"closeExportPopover",(()=>{this.setState({isExportPopoverOpen:!1})})),b()(this,"toggleExportPopoverVisibility",(()=>{this.setState((e=>({isExportPopoverOpen:!e.isExportPopoverOpen})))})),b()(this,"toggleIsIncludeReferencesDeepChecked",(()=>{this.setState((e=>({isIncludeReferencesDeepChecked:!e.isIncludeReferencesDeepChecked})))})),b()(this,"onExportClick",(()=>{const{onExport:e}=this.props,{isIncludeReferencesDeepChecked:t}=this.state;e(t),this.setState({isExportPopoverOpen:!1})})),b()(this,"getUpdatedAtColumn",(()=>({field:"updated_at",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.lastUpdatedColumnTitle",{defaultMessage:"Last updated"}),render:(e,t)=>(e=>{if(!e)return Object(g.jsx)(r.EuiToolTip,{content:d.i18n.translate("savedObjectsManagement.objectsTable.table.updatedDateUnknownLabel",{defaultMessage:"Last updated unknown"})},Object(g.jsx)("span",null,"-"));const t=x()(e);return t.diff(x()(),"days")>-7?Object(g.jsx)(r.EuiToolTip,{content:t.format("LL LT")},Object(g.jsx)("span",null,Object(g.jsx)(h.FormattedRelative,{value:new Date(e).getTime()}))):Object(g.jsx)(r.EuiToolTip,{content:t.format("LL LT")},Object(g.jsx)("span",null,t.format("LL")))})(t.updated_at),sortable:!0,width:"150px"})))}render(){var e,t;const{pageIndex:s,pageSize:i,sort:o,itemId:l,items:c,totalItemCount:u,isSearching:b,filterOptions:p,selectionConfig:j,capabilities:O,onDelete:f,onActionRefresh:x,selectedSavedObjects:M,onTableChange:y,goInspectObject:T,onShowRelationships:S,basePath:w,actionRegistry:C,columnRegistry:E,taggingApi:I,allowedTypes:F}=this.props,R={pageIndex:s,pageSize:i,totalItemCount:Math.min(u,v),pageSizeOptions:[5,10,20,50]},D=[{type:"field_value_selection",field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.typeFilterName",{defaultMessage:"Type"}),multiSelect:"or",options:p},...I?[I.ui.getSearchBarFilter({useName:!0})]:[]],A=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTypeName",{defaultMessage:"Type"}),width:"65px",align:"center",description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!0,"data-test-subj":"savedObjectsTableRowType",render:(e,t)=>{const s=Object(m.getSavedObjectLabel)(e,F);return Object(g.jsx)(r.EuiIconTip,{"aria-label":s,type:t.meta.icon||"apps",size:"s",content:s,iconProps:{"data-test-subj":"objectType"}})}},{field:"meta.title",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTitleName",{defaultMessage:"Title"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTitleDescription",{defaultMessage:"Title of the saved object"}),dataType:"string",sortable:!1,"data-test-subj":"savedObjectsTableRowTitle",render:(e,t)=>{const{path:s=""}=t.meta.inAppUrl||{};return this.props.canGoInApp(t)?Object(g.jsx)(r.EuiLink,{href:w.prepend(s)},e||Object(m.getDefaultTitle)(t)):Object(g.jsx)(r.EuiText,{size:"s"},e||Object(m.getDefaultTitle)(t))}},...I?[I.ui.getTableColumnDefinition({serverPaging:!0})]:[],...E.getAll().map((e=>(e.setColumnContext({capabilities:O}),e.registerOnFinishCallback((()=>{const{refreshOnFinish:t=(()=>[])}=e,s=t();x(s)})),{...e.euiColumn,sortable:!1,"data-test-subj":`savedObjectsTableColumn-${e.id}`}))),this.getUpdatedAtColumn(),{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActionsName",{defaultMessage:"Actions"}),width:"80px",actions:[{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.inspectActionName",{defaultMessage:"Inspect"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.inspectActionDescription",{defaultMessage:"Inspect this saved object"}),type:"icon",icon:"inspect",onClick:e=>T(e),"data-test-subj":"savedObjectsTableAction-inspect"},{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.viewRelationshipsActionName",{defaultMessage:"Relationships"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.viewRelationshipsActionDescription",{defaultMessage:"View the relationships this saved object has to other saved objects"}),type:"icon",icon:"kqlSelector",onClick:e=>S(e),"data-test-subj":"savedObjectsTableAction-relationships"},...C.getAll().map((e=>(e.setActionContext({capabilities:O}),{...e.euiAction,"data-test-subj":`savedObjectsTableAction-${e.id}`,onClick:t=>{this.setState({activeAction:e}),e.registerOnFinishCallback((()=>{this.setState({activeAction:void 0});const{refreshOnFinish:t=(()=>[])}=e,s=t();x(s)})),e.euiAction.onClick&&e.euiAction.onClick(t)}})))]}];let P;if(!this.state.isSearchTextValid){const e=d.i18n.translate("savedObjectsManagement.objectsTable.searchBar.unableToParseQueryErrorMessage",{defaultMessage:"Unable to parse query"});P=Object(g.jsx)(r.EuiFormErrorText,null,`${e}. ${this.state.parseErrorMessage}`)}const k=Object(g.jsx)(r.EuiButton,{iconType:"arrowDown",iconSide:"right",onClick:this.toggleExportPopoverVisibility,isDisabled:0===M.length},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.exportPopoverButtonLabel",defaultMessage:"Export"})),_=null!==(e=null===(t=this.state.activeAction)||void 0===t?void 0:t.render())&&void 0!==e?e:null,B=u>v,N=M.every((({meta:{hiddenType:e}})=>e));return Object(g.jsx)(a.Fragment,null,_,Object(g.jsx)(r.EuiSearchBar,{box:{"data-test-subj":"savedObjectSearchBar"},filters:D,onChange:this.onChange,defaultQuery:this.props.initialQuery,toolsRight:[Object(g.jsx)(r.EuiToolTip,{content:N?Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.deleteDisabledTooltip",defaultMessage:"Selected objects can’t be deleted because they are hidden objects."}):void 0},Object(g.jsx)(r.EuiButton,{key:"deleteSO",iconType:"trash",color:"danger",onClick:f,isDisabled:N||!O.savedObjectsManagement.delete,title:O.savedObjectsManagement.delete?void 0:d.i18n.translate("savedObjectsManagement.objectsTable.table.deleteButtonTitle",{defaultMessage:"Unable to delete saved objects"}),"data-test-subj":"savedObjectsManagementDelete"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.deleteButtonLabel",defaultMessage:"Delete"}))),Object(g.jsx)(r.EuiPopover,{key:"exportSOOptions",button:k,isOpen:this.state.isExportPopoverOpen,closePopover:this.closeExportPopover},Object(g.jsx)(r.EuiFormRow,{label:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.exportOptionsLabel",defaultMessage:"Options"})},Object(g.jsx)(r.EuiSwitch,{name:"includeReferencesDeep",label:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.includeReferencesDeepLabel",defaultMessage:"Include related objects"}),checked:this.state.isIncludeReferencesDeepChecked,onChange:this.toggleIsIncludeReferencesDeepChecked})),Object(g.jsx)(r.EuiFormRow,null,Object(g.jsx)(r.EuiButton,{key:"exportSO",iconType:"exportAction",onClick:this.onExportClick,fill:!0},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.exportButtonLabel",defaultMessage:"Export"}))))]}),P,Object(g.jsx)(r.EuiSpacer,{size:"s"}),B&&Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiText,{color:"subdued",size:"s","data-test-subj":"savedObjectsTableTooManyResultsLabel"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.tooManyResultsLabel",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# object} other {# objects}}",values:{totalItemCount:u,limit:v}})),Object(g.jsx)(r.EuiSpacer,{size:"s"})),Object(g.jsx)("div",{"data-test-subj":"savedObjectsTable"},Object(g.jsx)(r.EuiBasicTable,{loading:b,itemId:l,items:c,columns:A,pagination:R,sorting:{sort:o},selection:j,onChange:y,rowProps:e=>({"data-test-subj":`savedObjectsTableRow row-${e.id}`})})))}}const M=({conflict:e,onFinish:t,allowedTypes:s})=>{var n;const{obj:i,error:o}=e;let l,c=null;l="conflict"===o.type?o.destinationId:o.destinations[0].id;const[u,b]=Object(a.useState)(l);if("ambiguous_conflict"===o.type){const e={options:o.destinations.map((e=>{var t;const s=null!==(t=e.title)&&void 0!==t?t:`${p} [id=${e.id}]`,n=e.updatedAt?x()(e.updatedAt).fromNow():"never",i=`ID: ${e.id}`,o=`Last updated: ${n}`;return{value:e.id,inputDisplay:e.id,dropdownDisplay:Object(g.jsx)(a.Fragment,null,Object(g.jsx)("strong",null,s),Object(g.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(g.jsx)("p",null,i,Object(g.jsx)("br",null),o)))}})),onChange:e=>{b(e)}};c=Object(g.jsx)(r.EuiSuperSelect,{options:e.options,valueOfSelected:u,onChange:e.onChange,prepend:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.selectControlLabel",{defaultMessage:"Object ID"}),hasDividers:!0,fullWidth:!0,compressed:!0})}const{type:p,meta:j}=i,h=j.title||Object(m.getDefaultTitle)(i),O=s.find((e=>e.name===p)),f=null!==(n=null==O?void 0:O.displayName)&&void 0!==n?n:p,v="conflict"===o.type?d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.body.conflict",{defaultMessage:'"{title}" conflicts with an existing object. Overwrite it?',values:{title:h}}):d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.body.ambiguousConflict",{defaultMessage:'"{title}" conflicts with multiple existing objects. Overwrite one?',values:{title:h}});return Object(g.jsx)(r.EuiConfirmModal,{title:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.title",{defaultMessage:"Overwrite {type}?",values:{type:f}}),cancelButtonText:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.cancelButtonText",{defaultMessage:"Skip"}),confirmButtonText:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.overwriteButtonText",{defaultMessage:"Overwrite"}),buttonColor:"danger",onCancel:()=>t(!1),onConfirm:()=>t(!0,u),defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON,maxWidth:"500px"},Object(g.jsx)("p",null,v),c)},y={id:"createNewCopiesDisabled",text:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.disabledTitle",{defaultMessage:"Check for existing objects"}),tooltip:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.disabledText",{defaultMessage:"Check if objects were previously copied or imported."})},T={id:"createNewCopiesEnabled",text:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.enabledTitle",{defaultMessage:"Create new objects with random IDs"}),tooltip:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.enabledText",{defaultMessage:"Use this option to create one or more copies of the object."})},S={id:"overwriteEnabled",label:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.overwrite.enabledLabel",{defaultMessage:"Automatically overwrite conflicts"})},w={id:"overwriteDisabled",label:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.overwrite.disabledLabel",{defaultMessage:"Request action on conflict"})},C=d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.importOptionsTitle",{defaultMessage:"Import options"}),E=({text:e,tooltip:t})=>Object(g.jsx)(r.EuiFlexGroup,null,Object(g.jsx)(r.EuiFlexItem,null,Object(g.jsx)(r.EuiText,null,e)),Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiIconTip,{content:t,position:"left",type:"iInCircle"}))),I=({initialValues:e,updateSelection:t})=>{const[s,n]=Object(a.useState)(e.createNewCopies),[i,o]=Object(a.useState)(e.overwrite),l=e=>{void 0!==e.createNewCopies?n(e.createNewCopies):void 0!==e.overwrite&&o(e.overwrite),t({createNewCopies:s,overwrite:i,...e})};return Object(g.jsx)(r.EuiFormFieldset,{legend:{children:Object(g.jsx)(r.EuiTitle,{size:"xs"},Object(g.jsx)("span",null,C))}},Object(g.jsx)(r.EuiCheckableCard,{id:y.id,label:E(y),checked:!s,onChange:()=>l({createNewCopies:!1})},Object(g.jsx)(r.EuiRadioGroup,{options:[S,w],idSelected:i?S.id:w.id,onChange:e=>l({overwrite:e===S.id}),disabled:s,"data-test-subj":"savedObjectsManagement-importModeControl-overwriteRadioGroup"})),Object(g.jsx)(r.EuiSpacer,{size:"s"}),Object(g.jsx)(r.EuiCheckableCard,{id:T.id,label:E(T),checked:s,onChange:()=>l({createNewCopies:!0})}))};s(51);const F="apps",R=d.i18n.translate("savedObjectsManagement.objectsTable.importSummary.unsupportedTypeError",{defaultMessage:"Unsupported object type"}),D=({importItems:e})=>{if(!e.length)return null;const t=e.reduce(((e,{outcome:t})=>{var s;return e.set(t,(null!==(s=e.get(t))&&void 0!==s?s:0)+1)}),new Map),s=t.get("created"),a=t.get("overwritten"),n=t.get("error");return Object(g.jsx)(r.EuiFlexGroup,null,s&&Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiTitle,{size:"xs"},Object(g.jsx)("h4",{className:"savedObjectsManagementImportSummary__createdCount"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.importSummary.createdCountHeader",defaultMessage:"{createdCount} new",values:{createdCount:s}})))),a&&Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiTitle,{size:"xs"},Object(g.jsx)("h4",{className:"savedObjectsManagementImportSummary__overwrittenCount"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.importSummary.overwrittenCountHeader",defaultMessage:"{overwrittenCount} overwritten",values:{overwrittenCount:a}})))),n&&Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiTitle,{size:"xs"},Object(g.jsx)("h4",{"data-test-subj":"importSavedObjectsErrorsCount",className:"savedObjectsManagementImportSummary__errorCount"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.importSummary.errorCountHeader",defaultMessage:"{errorCount} error",values:{errorCount:n}})))))},A=({item:e})=>{const{outcome:t,errorMessage:s="Error"}=e;switch(t){case"created":return Object(g.jsx)(r.EuiIconTip,{type:"checkInCircleFilled",color:"success",content:d.i18n.translate("savedObjectsManagement.importSummary.createdOutcomeLabel",{defaultMessage:"Created"})});case"overwritten":return Object(g.jsx)(r.EuiIconTip,{type:"check",content:d.i18n.translate("savedObjectsManagement.importSummary.overwrittenOutcomeLabel",{defaultMessage:"Overwritten"})});case"error":return Object(g.jsx)(r.EuiIconTip,{type:"error",color:"danger",content:d.i18n.translate("savedObjectsManagement.importSummary.errorOutcomeLabel",{defaultMessage:"{errorMessage}",values:{errorMessage:s}})})}},P=({warnings:e,basePath:t})=>e.length?Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiSpacer,{size:"m"}),e.map(((s,n)=>Object(g.jsx)(a.Fragment,{key:`warning-${n}`},Object(g.jsx)(k,{warning:s,basePath:t}),n<e.length-1&&Object(g.jsx)(r.EuiSpacer,{size:"s"}))))):null,k=({warning:e,basePath:t})=>{const s=Object(a.useMemo)((()=>"action_required"===e.type?Object(g.jsx)(r.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd",gutterSize:"s"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButton,{size:"s",color:"warning",href:t.prepend(e.actionPath),target:"_blank"},e.buttonLabel||Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.importSummary.warnings.defaultButtonLabel",defaultMessage:"Go"})))):null),[e,t]);return Object(g.jsx)(r.EuiCallOut,{color:"warning",size:"s",iconType:"warning","data-test-subj":"importSavedObjectsWarning",title:e.message},s)},_=({failedImports:e,successfulImports:t,importWarnings:s,basePath:n,allowedTypes:i})=>{const o=Object(a.useMemo)((()=>l.a.sortBy([...e.map((e=>(e=>{const{obj:t}=e,{type:s,id:a,meta:n}=t;return{type:s,id:a,title:n.title||Object(m.getDefaultTitle)(t),icon:n.icon||F,outcome:"error",errorMessage:(({error:e})=>"unknown"===e.type?e.message:"unsupported_type"===e.type?R:void 0)(e)}})(e))),...t.map((e=>(e=>{const{type:t,id:s,meta:a,overwrite:n}=e;return{type:t,id:s,title:a.title||Object(m.getDefaultTitle)(e),icon:a.icon||F,outcome:n?"overwritten":"created"}})(e)))],["type","title"])),[t,e]);return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(r.EuiTitle,{size:"s","data-test-subj":o.length?"importSavedObjectsSuccess":"importSavedObjectsSuccessNoneImported"},Object(g.jsx)("h3",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.importSummary.headerLabel",defaultMessage:"{importCount, plural, one {1 object} other {# objects}} imported",values:{importCount:o.length}}))),Object(g.jsx)(r.EuiSpacer,{size:"s"}),Object(g.jsx)(D,{importItems:o}),Object(g.jsx)(P,{warnings:s,basePath:n}),Object(g.jsx)(r.EuiHorizontalRule,null),o.map(((e,t)=>{const{type:s,title:a,icon:n}=e,o=Object(m.getSavedObjectLabel)(s,i);return Object(g.jsx)(r.EuiFlexGroup,{responsive:!1,key:t,alignItems:"center",gutterSize:"s",className:"savedObjectsManagementImportSummary__row"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiToolTip,{position:"top",content:o},Object(g.jsx)(r.EuiIcon,{"aria-label":o,type:n,size:"s"}))),Object(g.jsx)(r.EuiFlexItem,{className:"savedObjectsManagementImportSummary__title"},Object(g.jsx)(r.EuiText,{size:"s"},Object(g.jsx)("p",{className:"eui-textTruncate",title:a},a))),Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)("div",{className:"eui-textRight"},Object(g.jsx)(A,{item:e}))))})))},B=e=>{var t,s;const a=null!==(t=e.body)&&void 0!==t&&t.error&&null!==(s=e.body)&&void 0!==s&&s.message?`${e.body.error}: ${e.body.message}`:e.message;return d.i18n.translate("savedObjectsManagement.objectsTable.flyout.importFileErrorMessage",{defaultMessage:'The file could not be processed due to error: "{error}"',values:{error:a}})};class flyout_Flyout extends a.Component{constructor(e){super(e),b()(this,"fetchIndexPatterns",(async()=>{var e;const t=null===(e=await this.props.dataViews.getCache())||void 0===e?void 0:e.map((e=>({id:e.id,title:e.attributes.title})));this.setState({indexPatterns:t})})),b()(this,"changeImportMode",(e=>{this.setState((()=>({importMode:e})))})),b()(this,"setImportFile",(e=>{if(!e||!e[0])return void this.setState({file:void 0});const t=e[0];this.setState({file:t})})),b()(this,"import",(async()=>{const{http:e}=this.props,{file:t,importMode:s}=this.state;if(void 0!==t){this.setState({status:"loading",error:void 0});try{const a=await Object(m.importFile)(e,t,s);this.setState(Object(m.processImportResponse)(a),(()=>{var e;0===(null===(e=this.state.unmatchedReferences)||void 0===e?void 0:e.length)&&this.resolveImportErrors()}))}catch(e){return void this.setState({status:"error",error:B(e)})}}else this.setState({status:"error",error:"missing_file"})})),b()(this,"getConflictResolutions",(async e=>{const t={};for(const s of e){const[e,a]=await new Promise((e=>{this.setState({conflictingRecord:{conflict:s,done:e}})}));if(e){const{type:e,id:n}=s.obj;t[`${e}:${n}`]={retry:!0,options:{overwrite:!0,...a&&{destinationId:a}}}}this.setState({conflictingRecord:void 0})}return t})),b()(this,"resolveImportErrors",(async()=>{this.setState({error:void 0,status:"loading",loadingMessage:void 0});try{const e=await Object(m.resolveImportErrors)({http:this.props.http,state:this.state,getConflictResolutions:this.getConflictResolutions});this.setState(e)}catch(e){this.setState({status:"error",error:B(e)})}})),b()(this,"onIndexChanged",((e,t)=>{const s=t.target.value;this.setState((t=>{var a;const n=null===(a=t.unmatchedReferences)||void 0===a?void 0:a.findIndex((t=>t.existingIndexPatternId===e));return void 0===n||-1===n?t:{unmatchedReferences:[...t.unmatchedReferences.slice(0,n),{...t.unmatchedReferences[n],newIndexPatternId:s},...t.unmatchedReferences.slice(n+1)]}}))})),this.state={unmatchedReferences:void 0,unmatchedReferencesTablePagination:{pageIndex:0,pageSize:5},conflictingRecord:void 0,error:void 0,file:void 0,importCount:0,indexPatterns:void 0,importMode:{createNewCopies:!1,overwrite:!0},loadingMessage:void 0,status:"idle"}}componentDidMount(){this.fetchIndexPatterns()}get hasUnmatchedReferences(){return this.state.unmatchedReferences&&this.state.unmatchedReferences.length>0}get resolutions(){return this.state.unmatchedReferences.reduce(((e,{existingIndexPatternId:t,newIndexPatternId:s})=>(s&&e.push({oldId:t,newId:s}),e)),[])}renderUnmatchedReferences(){const{unmatchedReferences:e,unmatchedReferencesTablePagination:t}=this.state;if(!e)return null;const s=[{field:"existingIndexPatternId",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnIdName",{defaultMessage:"ID"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnIdDescription",{defaultMessage:"ID of the data view"}),sortable:!0},{field:"list",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnCountName",{defaultMessage:"Count"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnCountDescription",{defaultMessage:"How many affected objects"}),render:e=>Object(g.jsx)(a.Fragment,null,e.length)},{field:"list",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnSampleOfAffectedObjectsName",{defaultMessage:"Sample of affected objects"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnSampleOfAffectedObjectsDescription",{defaultMessage:"Sample of affected objects"}),render:e=>Object(g.jsx)("ul",{style:{listStyle:"none"}},Object(o.take)(e,3).map(((e,t)=>Object(g.jsx)("li",{key:t},e.title))))},{field:"existingIndexPatternId",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnNewIndexPatternName",{defaultMessage:"New data view"}),render:t=>{var s,a;const n=[{text:"-- Skip Import --",value:""},...this.state.indexPatterns.map((e=>({text:e.title,value:e.id,"data-test-subj":`indexPatternOption-${e.title}`})))],i=null!==(s=null==e||null===(a=e.find((e=>e.existingIndexPatternId===t)))||void 0===a?void 0:a.newIndexPatternId)&&void 0!==s?s:"";return Object(g.jsx)(r.EuiSelect,{value:i,"data-test-subj":`managementChangeIndexSelection-${t}`,onChange:e=>this.onIndexChanged(t,e),options:n})}}],n={...t,pageSizeOptions:[5,10,25]};return Object(g.jsx)(r.EuiInMemoryTable,{items:e,columns:s,pagination:n,onTableChange:({page:e})=>{e&&this.setState({unmatchedReferencesTablePagination:{pageSize:e.size,pageIndex:e.index}})}})}renderError(){const{error:e,status:t}=this.state;return"error"!==t?null:Object(g.jsx)(a.Fragment,null,Object(g.jsx)(r.EuiCallOut,{title:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.errorCalloutTitle",defaultMessage:"Sorry, there was an error"}),color:"danger"},Object(g.jsx)("p",{"data-test-subj":"importSavedObjectsErrorText"},e)),Object(g.jsx)(r.EuiSpacer,{size:"s"}))}renderBody(){const{allowedTypes:e,showPlainSpinner:t}=this.props,{status:s,loadingMessage:a,failedImports:n=[],successfulImports:i=[],importMode:o,importWarnings:l}=this.state;return"loading"===s?Object(g.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},t?Object(g.jsx)(r.EuiLoadingSpinner,{size:"xl"}):Object(g.jsx)(r.EuiLoadingElastic,{size:"xl"}),Object(g.jsx)(r.EuiSpacer,{size:"m"}),Object(g.jsx)(r.EuiText,null,Object(g.jsx)("p",null,a)))):"success"===s?Object(g.jsx)(_,{basePath:this.props.http.basePath,failedImports:n,successfulImports:i,importWarnings:null!=l?l:[],allowedTypes:e}):this.hasUnmatchedReferences?this.renderUnmatchedReferences():Object(g.jsx)(r.EuiForm,null,Object(g.jsx)(r.EuiFormRow,{fullWidth:!0,label:Object(g.jsx)(r.EuiTitle,{size:"xs"},Object(g.jsx)("span",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.selectFileToImportFormRowLabel",defaultMessage:"Select a file to import"})))},Object(g.jsx)(r.EuiFilePicker,{accept:".ndjson",fullWidth:!0,initialPromptText:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importPromptText",defaultMessage:"Import"}),onChange:this.setImportFile})),Object(g.jsx)(r.EuiFormRow,{fullWidth:!0},Object(g.jsx)(I,{initialValues:o,updateSelection:e=>this.changeImportMode(e)})))}renderFooter(){const{status:e,file:t}=this.state,{done:s,close:a}=this.props;let n;return n="success"===e?Object(g.jsx)(r.EuiButton,{onClick:s,size:"s",fill:!0,"data-test-subj":"importSavedObjectsDoneBtn"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessful.confirmButtonLabel",defaultMessage:"Done"})):this.hasUnmatchedReferences?Object(g.jsx)(r.EuiButton,{onClick:this.resolveImportErrors,size:"s",fill:!0,isLoading:"loading"===e,"data-test-subj":"importSavedObjectsConfirmBtn"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessful.confirmAllChangesButtonLabel",defaultMessage:"Confirm all changes"})):Object(g.jsx)(r.EuiButton,{onClick:this.import,size:"s",fill:!0,isDisabled:void 0===t,isLoading:"loading"===e,"data-test-subj":"importSavedObjectsImportBtn"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.import.confirmButtonLabel",defaultMessage:"Import"})),Object(g.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButtonEmpty,{onClick:a,size:"s",disabled:"loading"===e||"success"===e,"data-test-subj":"importSavedObjectsCancelBtn"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.import.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(g.jsx)(r.EuiFlexItem,{grow:!1},n))}renderSubheader(){if("loading"===this.state.status||"success"===this.state.status)return null;let e;return this.hasUnmatchedReferences&&(e=Object(g.jsx)(r.EuiCallOut,{"data-test-subj":"importSavedObjectsConflictsWarning",title:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsTitle",defaultMessage:"Data Views Conflicts"}),color:"warning",iconType:"help"},Object(g.jsx)("p",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsDescription",defaultMessage:"The following saved objects use data views that do not exist. Please select the data views you'd like re-associated with them. You can {indexPatternLink} if necessary.",values:{indexPatternLink:Object(g.jsx)(r.EuiLink,{href:this.props.newIndexPatternUrl},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsCalloutLinkText",defaultMessage:"create a new data view"}))}})))),e?Object(g.jsx)(a.Fragment,null,e&&Object(g.jsx)("span",null,Object(g.jsx)(r.EuiSpacer,{size:"s"}),e)):null}render(){const{close:e,allowedTypes:t}=this.props;let s;const{conflictingRecord:a}=this.state;if(a){const{conflict:e}=a,n=(e,t)=>a.done([e,t]);s=Object(g.jsx)(M,{conflict:e,onFinish:n,allowedTypes:t})}return Object(g.jsx)(r.EuiFlyout,{onClose:e,size:"s","data-test-subj":"importSavedObjectsFlyout"},Object(g.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(r.EuiTitle,{size:"m"},Object(g.jsx)("h2",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSavedObjectTitle",defaultMessage:"Import saved objects"})))),Object(g.jsx)(r.EuiFlyoutBody,null,this.renderSubheader(),this.renderError(),this.renderBody()),Object(g.jsx)(r.EuiFlyoutFooter,null,this.renderFooter()),s)}}const N={field:"relationship",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnRelationshipName",{defaultMessage:"Direct relationship"}),dataType:"string",sortable:!1,width:"125px","data-test-subj":"directRelationship",render:e=>Object(g.jsx)(r.EuiText,{size:"s"},"parent"===e?Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.columnRelationship.parentAsValue",defaultMessage:"Parent"}):Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.columnRelationship.childAsValue",defaultMessage:"Child"}))};class relationships_Relationships extends a.Component{constructor(e){super(e),this.state={relations:[],invalidRelations:[],isLoading:!1,error:void 0}}UNSAFE_componentWillMount(){this.getRelationshipData()}UNSAFE_componentWillReceiveProps(e){e.savedObject.id!==this.props.savedObject.id&&this.getRelationshipData()}async getRelationshipData(){const{savedObject:e,getRelationships:t}=this.props;this.setState({isLoading:!0});try{const{relations:s,invalidRelations:a}=await t(e.type,e.id);this.setState({relations:s,invalidRelations:a,isLoading:!1,error:void 0})}catch(e){this.setState({error:e.message,isLoading:!1})}}renderError(){const{error:e}=this.state;return e?Object(g.jsx)(r.EuiCallOut,{title:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.renderErrorMessage",defaultMessage:"Error"}),color:"danger"},e):null}renderInvalidRelationship(){const{invalidRelations:e}=this.state;if(!e.length)return null;const t=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),width:"150px",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!1,"data-test-subj":"relationshipsObjectType"},{field:"id",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnIdName",{defaultMessage:"Id"}),width:"150px",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnIdDescription",{defaultMessage:"Id of the saved object"}),sortable:!1,"data-test-subj":"relationshipsObjectId"},N,{field:"error",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnErrorName",{defaultMessage:"Error"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnErrorDescription",{defaultMessage:"Error encountered with the relation"}),sortable:!1,"data-test-subj":"relationshipsError"}];return Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiCallOut,{color:"warning",iconType:"warning",title:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.invalidRelationShip",{defaultMessage:"This saved object has some invalid relations."})}),Object(g.jsx)(r.EuiSpacer,null),Object(g.jsx)(r.EuiInMemoryTable,{items:e,columns:t,pagination:!0,rowProps:()=>({"data-test-subj":"invalidRelationshipsTableRow"})}),Object(g.jsx)(r.EuiSpacer,null))}renderRelationshipsTable(){const{goInspectObject:e,basePath:t,savedObject:s,allowedTypes:a,showPlainSpinner:i}=this.props,{relations:o,isLoading:l,error:c}=this.state;if(c)return this.renderError();if(l)return i?Object(g.jsx)(r.EuiLoadingSpinner,{size:"xl"}):Object(g.jsx)(r.EuiLoadingElastic,{size:"xl"});const u=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),width:"50px",align:"center",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!1,render:(e,t)=>{const s=Object(m.getSavedObjectLabel)(e,a);return Object(g.jsx)(r.EuiToolTip,{position:"top",content:s},Object(g.jsx)(r.EuiIcon,{"aria-label":s,type:t.meta.icon||"apps",size:"s","data-test-subj":"relationshipsObjectType"}))}},N,{field:"meta.title",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTitleName",{defaultMessage:"Title"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTitleDescription",{defaultMessage:"Title of the saved object"}),dataType:"string",sortable:!1,render:(e,s)=>{const{path:a=""}=s.meta.inAppUrl||{};return this.props.canGoInApp(s)?Object(g.jsx)(r.EuiLink,{href:t.prepend(a),"data-test-subj":"relationshipsTitle"},e||Object(m.getDefaultTitle)(s)):Object(g.jsx)(r.EuiText,{size:"s","data-test-subj":"relationshipsTitle"},e||Object(m.getDefaultTitle)(s))}},{name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActionsName",{defaultMessage:"Actions"}),actions:[{name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActions.inspectActionName",{defaultMessage:"Inspect"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActions.inspectActionDescription",{defaultMessage:"Inspect this saved object"}),type:"icon",icon:"inspect","data-test-subj":"relationshipsTableAction-inspect",onClick:t=>e(t),available:e=>!(!e.type||!e.id)}]}],b=new Map(o.map((e=>[e.type,{value:e.type,name:e.type,view:e.type}]))),p={filters:[{type:"field_value_selection",field:"relationship",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.name",{defaultMessage:"Direct relationship"}),multiSelect:"or",options:[{value:"parent",name:"parent",view:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.parentAsValue.view",{defaultMessage:"Parent"})},{value:"child",name:"child",view:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.childAsValue.view",{defaultMessage:"Child"})}]},{type:"field_value_selection",field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.type.name",{defaultMessage:"Type"}),multiSelect:"or",options:[...b.values()]}]};return Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiCallOut,null,Object(g.jsx)("p",null,d.i18n.translate("savedObjectsManagement.objectsTable.relationships.relationshipsTitle",{defaultMessage:"Here are the saved objects related to {title}. Deleting this {type} affects its parent objects, but not its children.",values:{type:s.type,title:s.meta.title||Object(m.getDefaultTitle)(s)}}))),Object(g.jsx)(r.EuiSpacer,null),Object(g.jsx)(r.EuiInMemoryTable,{items:o,columns:u,pagination:!0,search:p,rowProps:()=>({"data-test-subj":"relationshipsTableRow"})}))}render(){const{close:e,savedObject:t,allowedTypes:s}=this.props,a=Object(m.getSavedObjectLabel)(t.type,s);return Object(g.jsx)(r.EuiFlyout,{onClose:e},Object(g.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(r.EuiTitle,{size:"m"},Object(g.jsx)("h2",null,Object(g.jsx)(r.EuiToolTip,{position:"top",content:a},Object(g.jsx)(r.EuiIcon,{"aria-label":a,size:"m",type:t.meta.icon||"apps"})),"  ",t.meta.title||Object(m.getDefaultTitle)(t)))),Object(g.jsx)(r.EuiFlyoutBody,null,this.renderInvalidRelationship(),this.renderRelationshipsTable()))}}var L={name:"mjbqp1",styles:"margin-block-end:0!important"};const z=({isDeleting:e,onConfirm:t,onCancel:s,selectedObjects:i,allowedTypes:o,showPlainSpinner:l})=>{const c=Object(a.useMemo)((()=>i.filter((e=>e.meta.hiddenType))),[i]),u=Object(a.useMemo)((()=>i.filter((e=>!e.meta.hiddenType)).map((({type:e,id:t,meta:s,namespaces:a=[]})=>{const{title:n="",icon:i="apps"}=s;return{type:e,id:t,icon:i,title:n,isShared:a.length>1||a.includes("*")}}))),[i]),b=Object(a.useMemo)((()=>u.filter((e=>e.isShared)).length),[u]);return e?Object(g.jsx)(r.EuiOverlayMask,null,l?Object(g.jsx)(r.EuiLoadingSpinner,{size:"xl"}):Object(g.jsx)(r.EuiLoadingElastic,{size:"xl"})):Object(g.jsx)(r.EuiModal,{initialFocus:"soDeleteConfirmModalConfirmBtn",onClose:s},Object(g.jsx)(r.EuiModalHeader,null,Object(g.jsx)(r.EuiModalHeaderTitle,null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModalTitle",defaultMessage:"Delete saved objects"}))),Object(g.jsx)(r.EuiModalBody,null,c.length>0&&Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiCallOut,{"data-test-subj":"cannotDeleteObjectsConfirmWarning",title:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.cannotDeleteCallout.title",defaultMessage:"Some objects have been excluded"}),iconType:"warning",color:"warning"},c.length>0&&Object(g.jsx)("p",{css:L},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.cannotDeleteCallout.content",defaultMessage:"{objectCount, plural, one {# object is} other {# objects are}} hidden and cannot be deleted.",values:{objectCount:c.length}}))),Object(g.jsx)(r.EuiSpacer,{size:"s"})),b>0&&Object(g.jsx)(n.a.Fragment,null,Object(g.jsx)(r.EuiCallOut,{"data-test-subj":"sharedObjectsWarning",title:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.sharedObjectsCallout.title",defaultMessage:"{sharedObjectsCount, plural, one {# saved object is shared} other {# of your saved objects are shared}}",values:{sharedObjectsCount:b}}),iconType:"warning",color:"warning"},Object(g.jsx)("p",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.sharedObjectsCallout.content",defaultMessage:"Shared objects are deleted from every space they are in."}))),Object(g.jsx)(r.EuiSpacer,{size:"s"})),Object(g.jsx)("p",null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.deleteSavedObjectsConfirmModalDescription",defaultMessage:"This action will delete the following saved objects:"})),Object(g.jsx)(r.EuiSpacer,{size:"m"}),Object(g.jsx)(r.EuiInMemoryTable,{items:u,columns:[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.typeColumnName",{defaultMessage:"Type"}),width:"50px",render:(e,{icon:t})=>Object(g.jsx)(r.EuiToolTip,{position:"top",content:Object(m.getSavedObjectLabel)(e,o)},Object(g.jsx)(r.EuiIcon,{type:t}))},{field:"id",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.idColumnName",{defaultMessage:"ID"})},{field:"title",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.titleColumnName",{defaultMessage:"Title"})}],pagination:!0,sorting:!1})),Object(g.jsx)(r.EuiModalFooter,null,Object(g.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiFlexGroup,null,Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButtonEmpty,{onClick:s,"data-test-subj":"confirmModalCancelButton"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButton,{id:"soDeleteConfirmModalConfirmBtn",fill:!0,color:"danger",onClick:t,disabled:0===u.length,"data-test-subj":"confirmModalConfirmButton"},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.deleteButtonLabel",defaultMessage:"Delete {objectsCount, plural, one {# object} other {# objects}}",values:{objectsCount:u.length}}))))))))},U=({onCancel:e,onExport:t,onSelectedOptionsChange:s,options:a,filteredItemCount:n,selectedOptions:i,includeReferences:o,onIncludeReferenceChange:l})=>Object(g.jsx)(r.EuiModal,{onClose:e},Object(g.jsx)(r.EuiModalHeader,null,Object(g.jsx)(r.EuiModalHeaderTitle,null,Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModalTitle",defaultMessage:"Export {filteredItemCount, plural, one{# object} other {# objects}}",values:{filteredItemCount:n}}))),Object(g.jsx)(r.EuiModalBody,null,Object(g.jsx)(r.EuiFormRow,{label:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModalDescription",defaultMessage:"Select which types to export"}),labelType:"legend"},Object(g.jsx)(r.EuiCheckboxGroup,{options:a,idToSelectedMap:i,onChange:e=>{s({...i,[e]:!i[e]})}})),Object(g.jsx)(r.EuiSpacer,{size:"m"}),Object(g.jsx)(r.EuiSwitch,{name:"includeReferencesDeep",label:Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.includeReferencesDeepLabel",defaultMessage:"Include related objects"}),checked:o,onChange:()=>l(!o)})),Object(g.jsx)(r.EuiModalFooter,null,Object(g.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiFlexGroup,null,Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButtonEmpty,{onClick:e},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiButton,{fill:!0,onClick:t},Object(g.jsx)(h.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.exportAllButtonLabel",defaultMessage:"Export all"})))))))),$=d.i18n.translate("savedObjectsManagement.objectsTable.unableFindSavedObjectsNotificationMessage",{defaultMessage:"Unable find saved objects"}),G=d.i18n.translate("savedObjectsManagement.objectsTable.unableFindSavedObjectNotificationMessage",{defaultMessage:"Unable to find saved object"});class saved_objects_table_SavedObjectsTable extends a.Component{constructor(e){var t;super(e),b()(this,"_isMounted",!1),b()(this,"hasCustomBrandingSubscription",void 0),b()(this,"fetchCounts",(async()=>{const{taggingApi:e}=this.props,{queryText:t,visibleTypes:s,selectedTags:a}=Object(m.parseQuery)(this.state.activeQuery,this.props.allowedTypes),n=this.props.allowedTypes.map((e=>e.name)),i=n.filter((e=>!s||s.includes(e))),o=Object(m.getTagFindReferences)({selectedTags:a,taggingApi:e}),l=await Object(m.getSavedObjectCounts)({http:this.props.http,typesToInclude:i,searchString:t,references:o}),r=Object.entries(l).map((([e,t])=>({id:e,label:`${e} (${t||0})`}))),c=r.reduce(((e,{id:t})=>({...e,[t]:!0})),{}),d=await Object(m.getSavedObjectCounts)({http:this.props.http,typesToInclude:n,searchString:t});this.setState((e=>({...e,savedObjectCounts:d,exportAllOptions:r,exportAllSelectedOptions:c})))})),b()(this,"fetchAllSavedObjects",(()=>{this.setState({isSearching:!0},this.debouncedFindObjects)})),b()(this,"fetchSavedObjects",(e=>{this.setState({isSearching:!0},(()=>this.debouncedBulkGetObjects(e)))})),b()(this,"debouncedFindObjects",Object(o.debounce)((async()=>{const{activeQuery:e,page:t,perPage:s,sort:a}=this.state,{notifications:n,http:i,allowedTypes:o,taggingApi:l}=this.props,{queryText:r,visibleTypes:c,selectedTags:d}=Object(m.parseQuery)(e,o),u={search:r?`${r}*`:void 0,perPage:s,page:t+1,type:o.map((e=>e.name)).filter((e=>!c||c.includes(e))),sortField:null==a?void 0:a.field,sortOrder:null==a?void 0:a.direction,hasReference:Object(m.getTagFindReferences)({selectedTags:d,taggingApi:l})};try{const t=await Object(m.findObjects)(i,u);if(!this._isMounted)return;this.setState((({activeQuery:s})=>s.text!==e.text?null:{savedObjects:t.saved_objects,filteredItemCount:t.total,isSearching:!1}))}catch(e){this._isMounted&&this.setState({isSearching:!1}),n.toasts.addDanger({title:$,text:`${e}`})}}),300)),b()(this,"debouncedBulkGetObjects",Object(o.debounce)((async e=>{const{notifications:t,http:s}=this.props;try{const a=await Object(m.bulkGetObjects)(s,e);if(!this._isMounted)return;const{map:n,errors:i}=a.reduce((({map:e,errors:t},s)=>(s.error?t.push(s.error.message):e.set(Q(s),s),{map:e,errors:t})),{map:new Map,errors:[]});i.length&&t.toasts.addDanger({title:G,text:i.join(", ")}),this.setState((({savedObjects:e,filteredItemCount:t})=>({savedObjects:e.map((e=>{const t=n.get(Q(e));return null!=t?t:e})),filteredItemCount:t,isSearching:!1})))}catch(e){this._isMounted&&this.setState({isSearching:!1}),t.toasts.addDanger({title:$,text:`${e}`})}}),300)),b()(this,"refreshAllObjects",(async()=>{await Promise.all([this.fetchAllSavedObjects(),this.fetchCounts()])})),b()(this,"refreshObjects",(async e=>{const t=this.state.savedObjects.reduce(((e,t)=>e.add(Q(t))),new Set),s=e.filter((e=>t.has(Q(e))));s.length&&this.fetchSavedObjects(s)})),b()(this,"onSelectionChanged",(e=>{this.setState({selectedSavedObjects:e})})),b()(this,"onQueryChange",(({query:e})=>{this.setState({activeQuery:e,page:0,selectedSavedObjects:[]},(()=>{this.fetchAllSavedObjects(),this.fetchCounts()}))})),b()(this,"onTableChange",(async e=>{const{index:t,size:s}=e.page||{};this.setState({page:t,perPage:s,selectedSavedObjects:[],sort:e.sort},this.fetchAllSavedObjects)})),b()(this,"onShowRelationships",(e=>{this.setState({isShowingRelationships:!0,relationshipObject:e})})),b()(this,"onHideRelationships",(()=>{this.setState({isShowingRelationships:!1,relationshipObject:void 0})})),b()(this,"onExport",(async e=>{const{selectedSavedObjects:t}=this.state,{notifications:s,http:a}=this.props,n=t.map((e=>({id:e.id,type:e.type})));let i;try{i=await Object(m.fetchExportObjects)(a,n,e)}catch(e){var o,l;throw s.toasts.addDanger({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.toastErrorMessage",{defaultMessage:"Unable to generate export: {error}",values:{error:null!==(o=null===(l=e.body)||void 0===l?void 0:l.message)&&void 0!==o?o:e}})}),e}Object(p.saveAs)(i,"export.ndjson");const r=await Object(m.extractExportDetails)(i);this.showExportCompleteMessage(r)})),b()(this,"onExportAll",(async()=>{const{exportAllSelectedOptions:e,isIncludeReferencesDeepChecked:t,activeQuery:s}=this.state,{notifications:a,http:n,taggingApi:i,allowedTypes:o}=this.props,{queryText:l,selectedTags:r}=Object(m.parseQuery)(s,o),c=Object.entries(e).reduce(((e,[t,s])=>(s&&e.push(t),e)),[]),u=Object(m.getTagFindReferences)({selectedTags:r,taggingApi:i});let b;try{b=await Object(m.fetchExportByTypeAndSearch)({http:n,search:l?`${l}*`:void 0,types:c,references:u,includeReferencesDeep:t})}catch(e){var j,h;throw a.toasts.addDanger({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.toastErrorMessage",{defaultMessage:"Unable to generate export: {error}",values:{error:null!==(j=null===(h=e.body)||void 0===h?void 0:h.message)&&void 0!==j?j:e}})}),e}Object(p.saveAs)(b,"export.ndjson");const g=await Object(m.extractExportDetails)(b);this.showExportCompleteMessage(g),this.setState({isShowingExportAllOptionsModal:!1})})),b()(this,"showExportCompleteMessage",(e=>{const{notifications:t}=this.props;if(e){if(e.missingReferences.length>0)return t.toasts.addWarning({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successWithMissingRefsNotification",{defaultMessage:"Your file is downloading in the background. Some related objects could not be found. Please see the last line in the exported file for a list of missing objects."})});if(e.excludedObjects.length>0)return t.toasts.addSuccess({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successWithExcludedObjectsNotification",{defaultMessage:"Your file is downloading in the background. Some objects were excluded from the export. Please see the last line in the exported file for a list of excluded objects."})})}return t.toasts.addSuccess({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successNotification",{defaultMessage:"Your file is downloading in the background"})})})),b()(this,"finishImport",(()=>{this.hideImportFlyout(),this.fetchAllSavedObjects(),this.fetchCounts()})),b()(this,"showImportFlyout",(()=>{this.setState({isShowingImportFlyout:!0})})),b()(this,"hideImportFlyout",(()=>{this.setState({isShowingImportFlyout:!1})})),b()(this,"onDelete",(()=>{this.setState({isShowingDeleteConfirmModal:!0})})),b()(this,"delete",(async()=>{const{http:e,notifications:t}=this.props,{selectedSavedObjects:s,isDeleting:a}=this.state;if(a)return;this.setState({isDeleting:!0}),s.filter((e=>"index-pattern"===e.type)).length&&await this.props.dataViews.clearCache();const n=await Object(m.bulkDeleteObjects)(e,s.filter((e=>!e.meta.hiddenType)).map((({id:e,type:t})=>({id:e,type:t}))));t.toasts.addInfo({title:d.i18n.translate("savedObjectsManagement.objectsTable.delete.successNotification",{defaultMessage:"Successfully deleted {count, plural, one {# object} other {# objects}}.",values:{count:n.filter((({success:e})=>!!e)).length}})}),this.setState({selectedSavedObjects:s.filter((({id:e,type:t})=>n.some(Object(o.matches)({id:e,type:t,success:!1}))))}),this.fetchAllSavedObjects(),await this.fetchCounts(),this.setState({isShowingDeleteConfirmModal:!1,isDeleting:!1})})),b()(this,"getRelationships",(async(e,t)=>{const{http:s}=this.props,a=this.props.allowedTypes.map((e=>e.name));return await Object(m.getRelationships)(s,e,t,a)})),this.state={totalCount:0,page:0,perPage:e.perPageConfig||50,sort:{field:"updated_at",direction:"desc"},savedObjects:[],savedObjectCounts:e.allowedTypes.reduce(((e,t)=>(e[t.name]=0,e)),{}),activeQuery:null!==(t=e.initialQuery)&&void 0!==t?t:r.Query.parse(""),selectedSavedObjects:[],isShowingImportFlyout:!1,isSearching:!1,filteredItemCount:0,isShowingRelationships:!1,relationshipObject:void 0,isShowingDeleteConfirmModal:!1,isShowingExportAllOptionsModal:!1,isDeleting:!1,exportAllOptions:[],exportAllSelectedOptions:{},isIncludeReferencesDeepChecked:!0,hasCustomBranding:!1}}componentDidMount(){this._isMounted=!0,this.fetchAllSavedObjects(),this.fetchCounts(),this.hasCustomBrandingSubscription=this.props.customBranding.hasCustomBranding$.subscribe((e=>{this.setState({...this.state,hasCustomBranding:e})}))}componentWillUnmount(){var e;this._isMounted=!1,this.debouncedFindObjects.cancel(),this.debouncedBulkGetObjects.cancel(),null===(e=this.hasCustomBrandingSubscription)||void 0===e||e.unsubscribe()}renderFlyout(){if(!this.state.isShowingImportFlyout)return null;const{applications:e}=this.props,t=e.getUrlForApp("management",{path:"kibana/indexPatterns"});return Object(g.jsx)(flyout_Flyout,{close:this.hideImportFlyout,done:this.finishImport,http:this.props.http,dataViews:this.props.dataViews,newIndexPatternUrl:t,basePath:this.props.http.basePath,search:this.props.search,allowedTypes:this.props.allowedTypes,showPlainSpinner:this.state.hasCustomBranding})}renderRelationships(){return this.state.isShowingRelationships?Object(g.jsx)(relationships_Relationships,{basePath:this.props.http.basePath,savedObject:this.state.relationshipObject,getRelationships:this.getRelationships,close:this.onHideRelationships,goInspectObject:this.props.goInspectObject,canGoInApp:this.props.canGoInApp,allowedTypes:this.props.allowedTypes,showPlainSpinner:this.state.hasCustomBranding}):null}renderDeleteConfirmModal(){const{isShowingDeleteConfirmModal:e,isDeleting:t,selectedSavedObjects:s,hasCustomBranding:a}=this.state,{allowedTypes:n}=this.props;return e?Object(g.jsx)(z,{isDeleting:t,onConfirm:()=>{this.delete()},onCancel:()=>{this.setState({isShowingDeleteConfirmModal:!1})},selectedObjects:s,allowedTypes:n,showPlainSpinner:a}):null}renderExportAllOptionsModal(){const{isShowingExportAllOptionsModal:e,filteredItemCount:t,exportAllOptions:s,exportAllSelectedOptions:a,isIncludeReferencesDeepChecked:n}=this.state;return e?Object(g.jsx)(U,{onExport:this.onExportAll,onCancel:()=>{this.setState({isShowingExportAllOptionsModal:!1})},onSelectedOptionsChange:e=>{this.setState({exportAllSelectedOptions:e})},filteredItemCount:t,options:s,selectedOptions:a,includeReferences:n,onIncludeReferenceChange:e=>{this.setState({isIncludeReferencesDeepChecked:e})}}):null}render(){const{selectedSavedObjects:e,page:t,perPage:s,savedObjects:a,filteredItemCount:n,isSearching:i,savedObjectCounts:o,sort:l}=this.state,{http:c,taggingApi:d,allowedTypes:u,applications:b}=this.props,p={onSelectionChange:this.onSelectionChanged},m=u.map((e=>({value:e.displayName,name:e.displayName,view:`${e.displayName} (${o[e.name]||0})`})));return Object(g.jsx)("div",null,this.renderFlyout(),this.renderRelationships(),this.renderDeleteConfirmModal(),this.renderExportAllOptionsModal(),Object(g.jsx)(O,{onExportAll:()=>this.setState({isShowingExportAllOptionsModal:!0}),onImport:this.showImportFlyout,onRefresh:this.refreshAllObjects,filteredCount:n}),Object(g.jsx)(r.EuiSpacer,{size:"l"}),Object(g.jsx)(j.a,{coreStart:{application:b}},Object(g.jsx)(table_Table,{basePath:c.basePath,taggingApi:d,initialQuery:this.props.initialQuery,allowedTypes:u,itemId:e=>`${e.type}:${e.id}`,actionRegistry:this.props.actionRegistry,columnRegistry:this.props.columnRegistry,selectionConfig:p,selectedSavedObjects:e,onQueryChange:this.onQueryChange,onTableChange:this.onTableChange,filterOptions:m,onExport:this.onExport,capabilities:b.capabilities,onDelete:this.onDelete,onActionRefresh:this.refreshObjects,goInspectObject:this.props.goInspectObject,pageIndex:t,pageSize:s,sort:l,items:a,totalItemCount:n,isSearching:i,onShowRelationships:this.onShowRelationships,canGoInApp:this.props.canGoInApp})))}}function Q(e){return`${e.type}:${e.id}`}const W=({children:e})=>Object(g.jsx)(n.a.Fragment,null,e),V=({coreStart:e,dataStart:t,dataViewsApi:s,taggingApi:n,spacesApi:l,allowedTypes:u,actionRegistry:b,columnRegistry:p,setBreadcrumbs:j})=>{const m=e.application.capabilities,h=e.uiSettings.get("savedObjects:perPage",50),{search:O}=Object(i.useLocation)(),f=Object(a.useMemo)((()=>{const e=Object(c.parse)(O);try{var t;return r.Query.parse(null!==(t=e.initialQuery)&&void 0!==t?t:"")}catch(e){return r.Query.parse("")}}),[O]);Object(a.useEffect)((()=>{j([{text:d.i18n.translate("savedObjectsManagement.breadcrumb.index",{defaultMessage:"Saved objects"})}])}),[j]);const x=Object(a.useMemo)((()=>l?l.ui.components.getSpacesContextProvider:W),[l]);return Object(g.jsx)(x,null,Object(g.jsx)(saved_objects_table_SavedObjectsTable,{initialQuery:f,allowedTypes:u,actionRegistry:b,columnRegistry:p,taggingApi:n,dataViews:s,search:t.search,http:e.http,overlays:e.overlays,notifications:e.notifications,applications:e.application,perPageConfig:h,goInspectObject:t=>{const s=t.meta.editUrl?`/app${t.meta.editUrl}`:`/app/management/kibana/objects/${t.type}/${t.id}`;e.application.navigateToUrl(e.http.basePath.prepend(s))},canGoInApp:e=>{const{inAppUrl:t}=e.meta;return!!t&&(!t.uiCapabilitiesPath||Boolean(Object(o.get)(m,t.uiCapabilitiesPath)))},customBranding:e.customBranding}))}}}]);