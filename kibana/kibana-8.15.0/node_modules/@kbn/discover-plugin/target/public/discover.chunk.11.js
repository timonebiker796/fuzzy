(window.discover_bundle_jsonpfunction=window.discover_bundle_jsonpfunction||[]).push([[11],{104:function(e,t,i){"use strict";var s=i(151);i.d(t,"a",(function(){return s}))},299:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(300);case"v8light":return i(302)}},300:function(e,t,i){var s=i(96),r=i(301);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);s(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},301:function(e,t,i){(t=i(97)(!1)).push([e.i,".euiDataGrid__restrictBody .embPanel .embPanel__content{z-index:unset!important}",""]),e.exports=t},302:function(e,t,i){var s=i(96),r=i(303);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);s(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},303:function(e,t,i){(t=i(97)(!1)).push([e.i,".euiDataGrid__restrictBody .embPanel .embPanel__content{z-index:unset!important}",""]),e.exports=t},467:function(e,t,i){"use strict";i.r(t),i.d(t,"SavedSearchEmbeddable",(function(){return saved_search_embeddable_SavedSearchEmbeddable}));var s=i(13),r=i.n(s),a=i(2),n=i.n(a),o=i(0),c=i(10),l=i(1),u=i.n(l),d=i(64),h=i.n(d),p=i(4),g=i(5),b=i(17),v=i(69),m=i(59),S=i(136),j=i(27),w=i(63),O=i(135),x=i(40),f=i(474),P=i(450),C=i(185),T=i(104),y=i(108),I=i(103),E=i(106),F=i(9),z=i(162),R=i(124),q=i(164),M=(i(299),i(150)),A=i(3),H=i(22),D=i(125);const _=e=>{const[t,i]=Object(l.useState)(0),s=new Map;return Object(A.jsx)("div",{className:"euiContextMenu"},1===t?Object(A.jsx)(H.EuiContextMenuPanel,{items:e.warnings.map((t=>{const i=s.has(t.requestName)?s.get(t.requestName)+1:1,r=i>1?`${t.requestName} (${i})`:t.requestName;return s.set(t.requestName,i),Object(A.jsx)(H.EuiContextMenuItem,{key:r,onClick:()=>{var i;null===(i=e.onViewDetailsClick)||void 0===i||i.call(e),t.openInInspector()}},r)})),onClose:()=>{i(0)},title:D.c}):Object(A.jsx)(H.EuiContextMenuPanel,{title:Object(D.b)(e.warnings)},Object(A.jsx)(H.EuiPanel,{color:"transparent",paddingSize:"s"},Object(A.jsx)(H.EuiText,{size:"s"},Object(D.a)(e.warnings)),Object(A.jsx)(H.EuiButtonEmpty,{color:"primary",flush:"left",iconSide:e.warnings.length>1?"right":void 0,iconType:e.warnings.length>1?"arrowRight":void 0,onClick:()=>{var t;e.warnings.length>1?i(1):(null===(t=e.onViewDetailsClick)||void 0===t||t.call(e),e.warnings[0].openInInspector())}},D.c))))},k=e=>{const[t,i]=Object(l.useState)(!1),{euiTheme:s}=Object(H.useEuiTheme)(),r=Object(H.useEuiFontSize)("xs").fontSize;return e.warnings.length?Object(A.jsx)(H.EuiPopover,{panelPaddingSize:"none",button:Object(A.jsx)(H.EuiButton,{minWidth:0,size:"s",color:"warning",onClick:()=>i(!t),"data-test-subj":"searchResponseWarningsBadgeToogleButton",title:p.i18n.translate("searchResponseWarnings.badgeButtonLabel",{defaultMessage:"{warningCount} {warningCount, plural, one {warning} other {warnings}}",values:{warningCount:e.warnings.length}}),css:Object(A.css)("block-size:",s.size.l,";font-size:",r,";padding:0 ",s.size.xs,";&>*{gap:",s.size.xs,";}","")},Object(A.jsx)(H.EuiIcon,{type:"warning",css:Object(A.css)("margin-left:",s.size.xxs,";","")}),e.warnings.length),isOpen:t,closePopover:()=>i(!1)},Object(A.jsx)(_,{onViewDetailsClick:()=>{i(!1)},warnings:e.warnings})):null};var L=i(57);const V=({totalHitCount:e})=>Object(A.jsx)(H.EuiText,{grow:!1,size:"s",style:{paddingRight:2},"data-test-subj":"savedSearchTotalDocuments"},Object(A.jsx)(L.FormattedMessage,{id:"discover.docTable.totalDocuments",defaultMessage:"{totalDocuments} documents",values:{totalDocuments:Object(A.jsx)("strong",null,Object(A.jsx)(L.FormattedNumber,{value:e}))}})),N={name:"n48rgu",styles:"width:100%;position:relative"},B=({isLoading:e,totalHitCount:t,prepend:i,append:s,dataTestSubj:r,interceptedWarnings:a,children:n})=>Object(A.jsx)(H.EuiFlexGroup,{css:N,direction:"column",gutterSize:"xs",responsive:!1,"data-test-subj":r},e&&Object(A.jsx)(H.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),Boolean(i||t)&&Object(A.jsx)(H.EuiFlexItem,{grow:!1},Object(A.jsx)(H.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,wrap:!0},Boolean(i)&&Object(A.jsx)(H.EuiFlexItem,{grow:!1},i),!!t&&Object(A.jsx)(H.EuiFlexItem,{grow:!1,"data-test-subj":"toolBarTotalDocsText"},Object(A.jsx)(V,{totalHitCount:t})))),Object(A.jsx)(H.EuiFlexItem,{style:{minHeight:0}},n),Boolean(s)&&Object(A.jsx)(H.EuiFlexItem,{grow:!1},s),Object(A.jsx)(k,{warnings:null!=a?a:[]}));var W=i(8);const U=u.a.memo(q.a);function G(e){const{interceptedWarnings:t,...i}=e,[s,a]=Object(l.useState)(void 0),n=Object(l.useCallback)(((t,i,s,r)=>Object(A.jsx)(M.a,{dataView:e.dataView,hit:t,hits:i,columns:s,columnsMeta:r,savedSearchId:e.savedSearchId,onFilter:e.onFilter,onRemoveColumn:e.onRemoveColumn,onAddColumn:e.onAddColumn,onClose:()=>a(void 0),setExpandedDoc:a,query:e.query})),[e.dataView,e.onAddColumn,e.onFilter,e.onRemoveColumn,e.query,e.savedSearchId]),o=Object(l.useMemo)((()=>Object(R.a)({leftSide:"number"==typeof e.totalHitCount?Object(A.jsx)(V,{totalHitCount:e.totalHitCount}):void 0})),[e.totalHitCount]),c=Object(W.e)("getCellRenderers"),u=Object(l.useMemo)((()=>c((()=>({})))()),[c]);return Object(A.jsx)(B,{totalHitCount:void 0,isLoading:e.loadingState===z.a.loading,dataTestSubj:"embeddedSavedSearchDocTable",interceptedWarnings:e.interceptedWarnings},Object(A.jsx)(U,r()({},i,{totalHits:e.totalHitCount,setExpandedDoc:a,expandedDoc:s,configRowHeight:e.services.uiSettings.get(x.k),showMultiFields:e.services.uiSettings.get(x.r),maxDocFieldsDisplayed:e.services.uiSettings.get(x.i),renderDocumentView:n,renderCustomToolbar:o,externalCustomRenderers:u,enableComparisonMode:!0,showColumnTokens:!0,configHeaderRowHeight:3,showFullScreenButton:!1,className:"unifiedDataTable"})))}i(149);var Q=i(60),$=i(145);const K={marginLeft:"auto",marginRight:Q.euiLightVars.euiSizeL},Y=({pageSize:e,pageCount:t,activePage:i,onPageSizeChange:s,onPageClick:r})=>{const[a,n]=Object(l.useState)(!1),o=p.i18n.translate("discover.docTable.rows",{defaultMessage:"rows"}),c=()=>n(!1),u=Object($.a)(e).filter((e=>e<=100)).map((t=>{return Object(A.jsx)(H.EuiContextMenuItem,{key:`${t} rows`,icon:(i=t,i===e?"check":"empty"),onClick:()=>{c(),s(t)}},t," ",o);var i}));return Object(A.jsx)(H.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",responsive:!1},Object(A.jsx)(H.EuiFlexItem,{grow:!1},Object(A.jsx)(H.EuiPopover,{button:Object(A.jsx)(H.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>n((e=>!e))},Object(A.jsx)(L.FormattedMessage,{id:"discover.docTable.rowsPerPage",defaultMessage:"Rows per page: {pageSize}",values:{pageSize:e}})),isOpen:a,closePopover:c,panelPaddingSize:"none"},Object(A.jsx)(H.EuiContextMenuPanel,{items:u}))),Object(A.jsx)(H.EuiFlexItem,{grow:!1,style:K},Object(A.jsx)(H.EuiPagination,{"aria-label":p.i18n.translate("discover.docTable.documentsNavigation",{defaultMessage:"Documents navigation"}),pageCount:t,activePage:i,onPageClick:r,compressed:!0})))};var J=i(163);const X=Object(l.memo)(J.a),Z=e=>{const t=e.onUpdateRowsPerPage,i=Object(l.useRef)(null),{curPageIndex:s,pageSize:a,totalPages:n,startIndex:o,hasNextPage:c,changePageIndex:u,changePageSize:d}=(({initialPageSize:e,totalItems:t})=>{const[i,s]=Object(l.useState)(e),[r,a]=Object(l.useState)(0),n=Object(l.useMemo)((()=>{const e=Math.ceil(t/i);return{totalPages:e,startIndex:i*r,hasNextPage:r+1<e}}),[r,i,t]),o=Object(l.useCallback)((e=>a(e)),[]),c=Object(l.useCallback)((e=>s(e)),[]);return Object(l.useEffect)((()=>{n.totalPages<r+1&&o(0)}),[r,n.totalPages,o]),Object(l.useMemo)((()=>({...n,curPageIndex:r,pageSize:i,changePageIndex:o,changePageSize:c})),[o,c,r,n,i])})({initialPageSize:"number"==typeof e.rowsPerPageState&&e.rowsPerPageState>0?Math.min(e.rowsPerPageState,100):50,totalItems:e.rows.length}),h=0!==n,p=Object(l.useCallback)((()=>{i.current&&i.current.scrollTo(0,0)}),[]),g=Object(l.useMemo)((()=>e.rows.slice(o,a+o)),[a,o,e.rows]),b=Object(l.useCallback)((e=>{p(),u(e)}),[u,p]),v=Object(l.useCallback)((e=>{p(),d(e),null==t||t(e)}),[d,p,t]),m=Object(l.useMemo)((()=>!c&&e.totalHitCount&&e.rows.length<e.totalHitCount),[c,e.rows.length,e.totalHitCount]),S=Object(l.useCallback)((e=>Object(A.jsx)("div",{className:"kbnDocTable__container"},Object(A.jsx)("table",{className:"kbnDocTable table","data-test-subj":"docTable"},Object(A.jsx)("thead",null,e.renderHeader()),Object(A.jsx)("tbody",null,e.renderRows(g))))),[g]);return Object(A.jsx)(B,{interceptedWarnings:e.interceptedWarnings,totalHitCount:e.totalHitCount,isLoading:e.isLoading,prepend:m?Object(A.jsx)(H.EuiText,{grow:!1,size:"s",color:"subdued"},Object(A.jsx)(L.FormattedMessage,{id:"discover.docTable.limitedSearchResultLabel",defaultMessage:"Limited to {resultCount} results. Refine your search.",values:{resultCount:e.sampleSizeState}})):void 0,append:h?Object(A.jsx)(Y,{pageSize:a,pageCount:n,activePage:s,onPageClick:b,onPageSizeChange:v}):void 0},Object(A.jsx)(X,r()({ref:i},e,{dataTestSubj:"embeddedSavedSearchDocTable",render:S})))};function ee(e){return Object(A.jsx)(Z,{columns:e.columns,rows:e.rows,rowsPerPageState:e.rowsPerPageState,sampleSizeState:e.sampleSizeState,onUpdateRowsPerPage:e.onUpdateRowsPerPage,totalHitCount:e.totalHitCount,dataView:e.dataView,onSort:e.onSort,onAddColumn:e.onAddColumn,onMoveColumn:e.onMoveColumn,onRemoveColumn:e.onRemoveColumn,sort:e.sort,filters:e.filters,onFilter:e.onFilter,useNewFieldsApi:e.useNewFieldsApi,searchDescription:e.searchDescription,sharedItemTitle:e.sharedItemTitle,isLoading:e.isLoading,isEsqlMode:e.isEsqlMode,interceptedWarnings:e.interceptedWarnings})}const te=u.a.memo(ee),ie=u.a.memo(G);function se({fetchedSampleSize:e,searchProps:t,useLegacyTable:i,query:s}){return i?Object(A.jsx)(te,r()({},t,{sampleSizeState:e,isEsqlMode:Object(c.isOfAggregateQueryType)(s)})):Object(A.jsx)(ie,r()({},t,{sampleSizeState:e,loadingState:t.isLoading?z.a.loading:z.a.loaded,query:s}))}var re=i(109),ae=i(207),ne=i(180),oe=i(117),ce=i(19),le=i(33),ue=i(6);class saved_search_embeddable_SavedSearchEmbeddable extends b.Embeddable{constructor({editable:e,services:t,executeTriggerActions:i},s,r){super(s,{editApp:"discover",editable:e},r),n()(this,"type",F.c),n()(this,"deferEmbeddableLoad",!0),n()(this,"services",void 0),n()(this,"executeTriggerActions",void 0),n()(this,"attributeService",void 0),n()(this,"inspectorAdapters",void 0),n()(this,"subscription",void 0),n()(this,"abortController",void 0),n()(this,"savedSearch",void 0),n()(this,"panelTitleInternal",""),n()(this,"filtersSearchSource",void 0),n()(this,"prevTimeRange",void 0),n()(this,"prevFilters",void 0),n()(this,"prevQuery",void 0),n()(this,"prevSort",void 0),n()(this,"prevSearchSessionId",void 0),n()(this,"prevSampleSizeInput",void 0),n()(this,"searchProps",void 0),n()(this,"initialized",void 0),n()(this,"node",void 0),n()(this,"isEsqlMode",(e=>{const t=e.searchSource.getField("query");return Object(c.isOfAggregateQueryType)(t)})),n()(this,"getFetchedSampleSize",(e=>Object(E.a)(e.sampleSizeState,this.services.uiSettings))),n()(this,"fetch",(async()=>{var e;const t=this.savedSearch,i=this.searchProps;if(!t||!i)return;const s=this.input.searchSessionId,r=!this.services.uiSettings.get(x.o,!1),a=new AbortController;null===(e=this.abortController)||void 0===e||e.abort(),this.abortController=a,((e,t,i,s,r,a)=>{const{sortDir:n}=a;e.setField("size",s),e.setField("sort",Object(I.d)({sort:i,dataView:t,defaultSortDir:n,includeTieBreaker:!0})),r?(e.removeField("fieldsFromSource"),e.setField("fields",[{field:"*",include_unmapped:!0}])):e.removeField("fields")})(t.searchSource,i.dataView,i.sort,this.getFetchedSampleSize(i),r,{sortDir:this.services.uiSettings.get(x.s)}),this.inspectorAdapters.requests.reset(),i.isLoading=!0,i.interceptedWarnings=void 0;const n=this.getOutput().rendered;this.updateOutput({...this.getOutput(),loading:!0,rendered:!1,error:void 0}),n&&this.node&&this.render(this.node);const l=this.input.executionContext,u={type:this.type,name:"discover",id:t.id,description:this.output.title||this.output.defaultTitle||"",url:this.output.editUrl},d=l?{...l,child:u}:u,h=t.searchSource.getField("query"),g=t.searchSource.getField("index"),b=this.isEsqlMode(t);try{if(await this.services.profilesManager.resolveDataSourceProfile({dataSource:Object(c.isOfAggregateQueryType)(h)?Object(ue.c)():g.id?Object(ue.b)({dataViewId:g.id}):void 0,dataView:g,query:h}),b&&h){const e=await Object(ne.a)({query:t.searchSource.getField("query"),inputQuery:this.input.query,filters:this.input.filters,dataView:g,abortSignal:this.abortController.signal,inspectorAdapters:this.services.inspector,data:this.services.data,expressions:this.services.expressions,profilesManager:this.services.profilesManager});return this.updateOutput({...this.getOutput(),loading:!1}),i.columnsMeta=e.esqlQueryColumns?Object(C.a)(e.esqlQueryColumns):void 0,i.rows=e.records,i.totalHitCount=e.records.length,i.isLoading=!1,i.isPlainRecord=!0,void(i.isSortEnabled=!0)}const{rawResponse:e}=await Object(o.lastValueFrom)(t.searchSource.fetch$({abortSignal:a.signal,sessionId:s,inspector:{adapter:this.inspectorAdapters.requests,title:p.i18n.translate("discover.embeddable.inspectorRequestDataTitle",{defaultMessage:"Data"}),description:p.i18n.translate("discover.embeddable.inspectorRequestDescription",{defaultMessage:"This request queries Elasticsearch to fetch the data for the search."})},executionContext:d,disableWarningToasts:!0}));if(this.inspectorAdapters.requests){const e=[];this.services.data.search.showWarnings(this.inspectorAdapters.requests,(t=>(e.push(t),!0))),i.interceptedWarnings=e}this.updateOutput({...this.getOutput(),loading:!1}),i.rows=e.hits.hits.map((e=>Object(f.a)(e,i.dataView))),i.totalHitCount=e.hits.total,i.isLoading=!1}catch(e){const t=!(null==a||!a.signal.aborted);this.destroyed||t||(this.updateOutput({...this.getOutput(),loading:!1,error:e}),i.isLoading=!1)}})),this.services=t,this.executeTriggerActions=i,this.attributeService=t.savedSearch.byValue.attributeService,this.inspectorAdapters={requests:new v.RequestAdapter},this.subscription=this.getUpdated$().subscribe((()=>{const e=this.output.title&&this.panelTitleInternal!==this.output.title;if(e&&(this.panelTitleInternal=this.output.title||""),!this.searchProps)return;const t=this.isFetchRequired(this.searchProps),i=this.isRerenderRequired(this.searchProps);(e||t||i)&&this.reload(t)})),this.initializeSavedSearch(s).then((()=>{this.initializeSearchEmbeddableProps()}))}getCurrentTitle(){var e,t,i;return this.input.hidePanelTitles?"":null!==(e=null!==(t=this.input.title)&&void 0!==t?t:null===(i=this.savedSearch)||void 0===i?void 0:i.title)&&void 0!==e?e:""}async initializeSavedSearch(e){try{const t=await this.attributeService.unwrapAttributes(e);if(this.destroyed)return;this.savedSearch=await this.services.savedSearch.byValue.toSavedSearch(null==e?void 0:e.savedObjectId,t),this.panelTitleInternal=this.getCurrentTitle(),await this.initializeOutput();const i=await Object(o.firstValueFrom)(this.services.core.chrome.getActiveSolutionNavId$());await this.services.profilesManager.resolveRootProfile({solutionNavId:i}),this.setInitializationFinished(),this.initialized=!0}catch(e){this.onFatalError(e)}}async initializeOutput(){var e;const t=this.savedSearch;if(!t)return;const i=t.searchSource.getField("index"),s=i?[i]:[],r=this.getInput(),a=this.getCurrentTitle(),n=r.hidePanelTitles?"":null!==(e=r.description)&&void 0!==e?e:t.description,o=r.savedObjectId,c=Object(le.a)(this),l=!(o||null!=i&&i.isPersisted()),u=l?this.services.locator.getRedirectUrl(c):await this.services.locator.getUrl(c),d=this.services.core.http.basePath.remove(u),h=l?"r":"discover";this.updateOutput({...this.getOutput(),defaultTitle:t.title,defaultDescription:t.description,title:a,description:n,editApp:h,editPath:d,editUrl:u,indexPatterns:s})}inputIsRefType(e){return this.attributeService.inputIsRefType(e)}async getInputAsValueType(){return this.attributeService.getInputAsValueType(this.getExplicitInput())}async getInputAsRefType(){return this.attributeService.getInputAsRefType(this.getExplicitInput(),{showSaveModal:!0,saveModalTitle:this.getTitle()})}reportsEmbeddableLoad(){return!0}getSort(e,t,i){return Object(I.c)(e,t,this.services.uiSettings,i)}initializeSearchEmbeddableProps(){const e=this.savedSearch;if(!e)return;const t=e.searchSource.getField("index");if(!t)return;var i,s;t.isPersisted()||null===(i=(s=this.services).trackUiMetric)||void 0===i||i.call(s,w.METRIC_TYPE.COUNT,ce.a);const r={columns:e.columns||[],savedSearchId:e.id,filters:e.searchSource.getField("filter"),dataView:t,isLoading:!1,sort:this.getSort(e.sort,t,this.isEsqlMode(e)),rows:[],searchDescription:e.description,description:e.description,inspectorAdapters:this.inspectorAdapters,searchTitle:e.title,services:this.services,onAddColumn:e=>{if(!r.columns)return;const t=T.a.addColumn(r.columns,e,!0);this.updateInput({columns:t})},onRemoveColumn:e=>{if(!r.columns)return;const t=T.a.removeColumn(r.columns,e,!0);this.updateInput({columns:t})},onMoveColumn:(e,t)=>{if(!r.columns)return;const i=T.a.moveColumn(r.columns,e,t);this.updateInput({columns:i})},onSetColumns:e=>{this.updateInput({columns:e})},onSort:e=>{const t=[];e.forEach((e=>{t.push(e)})),this.updateInput({sort:t})},...!this.isEsqlMode(e)&&{onFilter:async(e,i,s)=>{let r=Object(m.generateFilters)(this.services.filterManager,e,i,s,t);r=r.map((e=>({...e,$state:{store:c.FilterStateStore.APP_STATE}}))),await this.executeTriggerActions(m.APPLY_FILTER_TRIGGER,{embeddable:this,filters:r})}},useNewFieldsApi:!this.services.uiSettings.get(x.o,!1),showTimeCol:!this.services.uiSettings.get(x.e,!1),ariaLabelledBy:"documentsAriaLabel",rowHeightState:this.input.rowHeight||e.rowHeight,onUpdateRowHeight:e=>{this.updateInput({rowHeight:e})},headerRowHeightState:this.input.headerRowHeight||e.headerRowHeight,onUpdateHeaderRowHeight:e=>{this.updateInput({headerRowHeight:e})},rowsPerPageState:this.input.rowsPerPage||e.rowsPerPage,onUpdateRowsPerPage:e=>{this.updateInput({rowsPerPage:e})},sampleSizeState:this.input.sampleSize||e.sampleSize,onUpdateSampleSize:e=>{this.updateInput({sampleSize:e})},cellActionsTriggerId:F.b},a=e.searchSource.create();a.setField("filter",(()=>{const e=this.getTimeRange();if(this.searchProps&&e)return this.services.timefilter.createFilter(t,e)})),this.filtersSearchSource=e.searchSource.create(),this.filtersSearchSource.setParent(a),e.searchSource.setParent(this.filtersSearchSource),this.load(r),r.isLoading=!0,e.grid&&(r.settings=e.grid)}getTimeRange(){return void 0!==this.input.timeslice?{from:new Date(this.input.timeslice[0]).toISOString(),to:new Date(this.input.timeslice[1]).toISOString(),mode:"absolute"}:this.input.timeRange}isFetchRequired(e){return!(!e||!e.dataView||Object(c.onlyDisabledFiltersChanged)(this.input.filters,this.prevFilters)&&Object(g.isEqual)(this.prevQuery,this.input.query)&&Object(g.isEqual)(this.prevTimeRange,this.getTimeRange())&&Object(g.isEqual)(this.prevSort,this.input.sort)&&this.prevSampleSizeInput===this.input.sampleSize&&this.prevSearchSessionId===this.input.searchSessionId)}isRerenderRequired(e){return!!e&&(this.input.rowsPerPage!==e.rowsPerPageState||this.input.sampleSize!==e.sampleSizeState||this.input.columns&&!Object(g.isEqual)(this.input.columns,e.columns))}async pushContainerStateParamsToProps(e,{forceFetch:t=!1}={forceFetch:!1}){var i,s;const r=this.savedSearch;if(!r)return;const a=this.isFetchRequired(e),n=Object(re.a)({columns:this.input.columns||r.columns},this.services.core.uiSettings);var o,c;e.columns=n.columns||[],e.sort=this.getSort(this.input.sort||r.sort,null==e?void 0:e.dataView,this.isEsqlMode(r)),e.sharedItemTitle=this.panelTitleInternal,e.searchTitle=this.panelTitleInternal,e.rowHeightState=null!==(i=this.input.rowHeight)&&void 0!==i?i:r.rowHeight,e.headerRowHeightState=null!==(s=this.input.headerRowHeight)&&void 0!==s?s:r.headerRowHeight,e.rowsPerPageState=this.input.rowsPerPage||r.rowsPerPage||Object(y.b)(this.services.uiSettings),e.maxAllowedSampleSize=Object(E.b)(this.services.uiSettings),e.sampleSizeState=this.input.sampleSize||r.sampleSize,e.filters=r.searchSource.getField("filter"),e.savedSearchId=r.id,t||a?(this.filtersSearchSource.setField("filter",this.input.filters),this.filtersSearchSource.setField("query",this.input.query),null!==(o=this.input.query)&&void 0!==o&&o.query||null!==(c=this.input.filters)&&void 0!==c&&c.length?this.filtersSearchSource.setField("highlightAll",!0):this.filtersSearchSource.removeField("highlightAll"),this.prevFilters=this.input.filters,this.prevQuery=this.input.query,this.prevTimeRange=this.getTimeRange(),this.prevSearchSessionId=this.input.searchSessionId,this.prevSort=this.input.sort,this.prevSampleSizeInput=this.input.sampleSize,this.searchProps=e,await this.fetch()):this.searchProps&&this.node&&(this.searchProps=e)}async render(e){this.node=e,this.searchProps&&this.initialized&&!this.destroyed&&(super.render(e),this.renderReactComponent(this.node,this.searchProps))}renderReactComponent(e,t){const i=this.savedSearch;if(!t||!i)return;const s=this.isEsqlMode(i),a=Object(oe.a)({viewMode:i.viewMode,isEsqlMode:s}),n=this.getTimeRange();if(!0===this.services.uiSettings.get(x.q)&&a===y.a.AGGREGATED_LEVEL&&t.services&&t.dataView&&Array.isArray(t.columns))return h.a.render(Object(A.jsx)(S.a,t.services.core,Object(A.jsx)(j.KibanaContextProvider,{services:t.services},Object(A.jsx)(ae.b,{dataView:t.dataView,columns:t.columns,savedSearch:i,filters:this.input.filters,query:this.input.query,onAddFilter:t.onFilter,searchSessionId:this.input.searchSessionId,isEsqlMode:s,timeRange:n}))),e),void this.updateOutput({...this.getOutput(),rendered:!0});const o=Object(P.a)({uiSettings:this.services.uiSettings,isEsqlMode:s}),c=i.searchSource.getField("query"),l={savedSearch:i,searchProps:t,useLegacyTable:o,query:c};if(t.services){const{getTriggerCompatibleActions:i}=t.services.uiActions;h.a.render(Object(A.jsx)(S.a,t.services.core,Object(A.jsx)(j.KibanaContextProvider,{services:t.services},Object(A.jsx)(O.a,{getTriggerCompatibleActions:i},Object(A.jsx)(se,r()({},l,{fetchedSampleSize:this.getFetchedSampleSize(l.searchProps)}))))),e);const s=void 0!==this.getOutput().error;!1===this.searchProps.isLoading&&void 0!==l.searchProps.rows?(this.renderComplete.dispatchComplete(),this.updateOutput({...this.getOutput(),rendered:!0})):s&&(this.renderComplete.dispatchError(),this.updateOutput({...this.getOutput(),rendered:!0}))}}async load(e,t=!1){await this.pushContainerStateParamsToProps(e,{forceFetch:t}),this.node&&this.render(this.node)}reload(e=!0){this.searchProps&&this.initialized&&!this.destroyed&&this.load(this.searchProps,e)}getSavedSearch(){return this.savedSearch}getInspectorAdapters(){return this.inspectorAdapters}getFilters(){var e,t;return Object(m.mapAndFlattenFilters)(null!==(e=null===(t=this.savedSearch)||void 0===t?void 0:t.searchSource.getFields().filter)&&void 0!==e?e:[])}getQuery(){var e;return null===(e=this.savedSearch)||void 0===e?void 0:e.searchSource.getFields().query}destroy(){var e,t;super.destroy(),this.searchProps&&delete this.searchProps,this.node&&Object(d.unmountComponentAtNode)(this.node),null===(e=this.subscription)||void 0===e||e.unsubscribe(),null===(t=this.abortController)||void 0===t||t.abort()}hasTimeRange(){return void 0!==this.getTimeRange()}}}}]);