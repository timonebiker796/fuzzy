/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[]).push([[14,23],{109:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},194:function(e,t,r){"use strict";r.r(t),r.d(t,"suggestEMSTermJoinConfig",(function(){return s})),r.d(t,"emsAutoSuggest",(function(){return a}));var n=r(95);async function s(e){try{return a(e,await Object(n.getEmsFileLayers)())}catch(e){return null}}function a(e,t){const r=[];if(e.sampleValuesColumnName){const n=function(e,t,r){const n=[];return e.forEach((e=>{e.getFields().forEach((s=>{if(!s.alias||!s.alias.length)return;const a={layerId:e.getId(),field:s.id,displayName:e.getDisplayName()};s.alias.forEach((e=>{const i=new RegExp(e,"i"),c=!!t.match(i);let u;u=r?!(!s.values||!s.values.length)&&c&&o(r,s.values):c,u&&n.push(a)}))}))})),n}(t,e.sampleValuesColumnName,e.sampleValues);r.push(...n)}if(e.sampleValues&&e.sampleValues.length){const n=function(e,t){const r=[];return e.forEach((e=>{e.getFields().forEach((n=>{n.values&&n.values.length&&o(t,n.values)&&r.push({layerId:e.getId(),field:n.id,displayName:e.getDisplayName()})}))})),r}(t,e.sampleValues);r.push(...n)}const n=r.reduce(((e,t)=>{const r=e.find((e=>e.config.layerId===t.layerId&&e.config.field===t.layerId));return r?r.count+=1:e.push({config:t,count:1}),e}),[]);return n.sort(((e,t)=>t.count-e.count)),n.length?n[0].config:null}function o(e,t){for(let r=0;r<e.length;r++){const n=e[r].toString();if(!t.includes(n))return!1}return!0}},249:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(194);function s(e,t,r){const s=[];return t.rows.forEach((e=>{const t=e[r];t&&"__other__"!==t&&!s.includes(t)&&s.push(t)})),Object(n.emsAutoSuggest)({sampleValues:s},e)}},338:function(e,t,r){"use strict";r.r(t),r.d(t,"PassiveMap",(function(){return l}));var n=r(2),s=r(109),a=r.n(s),o=r(25),i=r(47),c=r(157),u=r(4);function l(e){const t=a()(),r=Object(n.useRef)(void 0),s=Object(n.useRef)(void 0),l=Object(n.useRef)(void 0);return Object(n.useEffect)((()=>{r.current?r.current.updateLayerById(e.passiveLayer):s.current=e.passiveLayer}),[e.passiveLayer]),Object(n.useEffect)((()=>()=>{l.current&&l.current.unsubscribe()}),[]),Object(u.jsx)("div",{className:"mapEmbeddableContainer"},Object(u.jsx)(o.ReactEmbeddableRenderer,{type:i.MAP_SAVED_OBJECT_TYPE,getParentApi:()=>({getSerializedStateForChild:()=>{const t=Object(c.createBasemapLayerDescriptor)(),r=t?[t]:[];return{rawState:{attributes:{title:"",layerListJSON:JSON.stringify([...r,e.passiveLayer])},filters:[],hidePanelTitles:!0,viewMode:o.ViewMode.VIEW,isLayerTOCOpen:!1,hideFilterActions:!0,mapSettings:{disableInteractive:!1,hideToolbarOverlay:!1,hideLayerControl:!1,hideViewControl:!1,initialLocation:i.INITIAL_LOCATION.AUTO_FIT_TO_BOUNDS,autoFitToDataBounds:!0},isSharable:!1},references:[]}}}),onApiAvailable:n=>{r.current=n,s.current&&n.updateLayerById(s.current),e.onRenderComplete&&(l.current=n.onRenderComplete$.subscribe((()=>{t()&&e.onRenderComplete&&e.onRenderComplete()})))},hidePanelChrome:!0}))}},645:function(e,t,r){"use strict";r.r(t),r.d(t,"ChoroplethChart",(function(){return u})),r(2);var n=r(3),s=r(47),a=r(0),o=r(249),i=r(338),c=r(4);function u({data:e,args:t,formatFactory:r,uiSettings:u,emsFileLayers:d,onRenderComplete:p}){if(!t.regionAccessor||!t.valueAccessor)return null;let f=t.emsLayerId?t.emsLayerId:a.Lb,m=t.emsField?t.emsField:"iso2";if(!t.emsLayerId||!t.emsField){const r=Object(o.a)(d,e,t.regionAccessor);r&&(f=r.layerId,m=r.field)}const y=function(e,t){const r=t.find((t=>t.getId()===e));return r?r.getDisplayName():null}(f,d),E={id:t.layerId,label:y?n.i18n.translate("xpack.maps.lens.choroplethChart.choroplethLayerLabel",{defaultMessage:"{emsLayerLabel} by {accessorLabel}",values:{emsLayerLabel:y,accessorLabel:l(e,t.valueAccessor)}}):"",joins:[{leftField:m,right:{id:t.valueAccessor,type:s.SOURCE_TYPES.TABLE_SOURCE,__rows:e.rows,__columns:[{name:t.regionAccessor,label:l(e,t.regionAccessor),type:"string"},{name:t.valueAccessor,label:l(e,t.valueAccessor),type:"number"}],term:t.regionAccessor}}],sourceDescriptor:{type:s.SOURCE_TYPES.EMS_FILE,id:f,tooltipProperties:[m]},style:{type:"VECTOR",properties:{[s.VECTOR_STYLES.FILL_COLOR]:{type:s.STYLE_TYPE.DYNAMIC,options:{color:"Blue to Red",colorCategory:"palette_0",fieldMetaOptions:{isEnabled:!0,sigma:3},type:s.COLOR_MAP_TYPE.ORDINAL,field:{name:t.valueAccessor,origin:s.FIELD_ORIGIN.JOIN},useCustomColorRamp:!1}},[s.VECTOR_STYLES.LINE_COLOR]:{type:s.STYLE_TYPE.STATIC,options:{color:"#3d3d3d"}},[s.VECTOR_STYLES.LINE_WIDTH]:{type:s.STYLE_TYPE.STATIC,options:{size:1}}},isTimeAware:!1},type:s.LAYER_TYPE.GEOJSON_VECTOR};return Object(c.jsx)(i.PassiveMap,{passiveLayer:E,onRenderComplete:p})}function l(e,t){const r=e.columns.find((e=>e.id===t));return r?r.name:t}}}]);