/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[]).push([[0],{483:function(e,t,s){var r,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(e,t){if(!r[e]){r[e]={};for(var s=0;s<e.length;s++)r[e][e.charAt(s)]=s}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var s=o._compress(e,6,(function(e){return t.charAt(e)}));switch(s.length%4){default:case 0:return s;case 1:return s+"===";case 2:return s+"==";case 3:return s+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(s){return i(t,e.charAt(s))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),s=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var n=t.charCodeAt(r);s[2*r]=n>>>8,s[2*r+1]=n%256}return s},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var s=new Array(t.length/2),r=0,i=s.length;r<i;r++)s[r]=256*t[2*r]+t[2*r+1];var n=[];return s.forEach((function(t){n.push(e(t))})),o.decompress(n.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return s.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return i(s,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,s){if(null==e)return"";var r,i,o,n={},l={},a="",u="",c="",p=2,d=3,h=2,f=[],m=0,g=0;for(o=0;o<e.length;o+=1)if(a=e.charAt(o),Object.prototype.hasOwnProperty.call(n,a)||(n[a]=d++,l[a]=!0),u=c+a,Object.prototype.hasOwnProperty.call(n,u))c=u;else{if(Object.prototype.hasOwnProperty.call(l,c)){if(c.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,g==t-1?(g=0,f.push(s(m)),m=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1}else{for(i=1,r=0;r<h;r++)m=m<<1|i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete l[c]}else for(i=n[c],r=0;r<h;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1;0==--p&&(p=Math.pow(2,h),h++),n[u]=d++,c=String(a)}if(""!==c){if(Object.prototype.hasOwnProperty.call(l,c)){if(c.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,g==t-1?(g=0,f.push(s(m)),m=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1}else{for(i=1,r=0;r<h;r++)m=m<<1|i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete l[c]}else for(i=n[c],r=0;r<h;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1;0==--p&&(p=Math.pow(2,h),h++)}for(i=2,r=0;r<h;r++)m=m<<1|1&i,g==t-1?(g=0,f.push(s(m)),m=0):g++,i>>=1;for(;;){if(m<<=1,g==t-1){f.push(s(m));break}g++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,s,r){var i,o,n,l,a,u,c,p=[],d=4,h=4,f=3,m="",g=[],b={val:r(0),position:s,index:1};for(i=0;i<3;i+=1)p[i]=i;for(n=0,a=Math.pow(2,2),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;switch(n){case 0:for(n=0,a=Math.pow(2,8),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;c=e(n);break;case 1:for(n=0,a=Math.pow(2,16),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;c=e(n);break;case 2:return""}for(p[3]=c,o=c,g.push(c);;){if(b.index>t)return"";for(n=0,a=Math.pow(2,f),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;switch(c=n){case 0:for(n=0,a=Math.pow(2,8),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;p[h++]=e(n),c=h-1,d--;break;case 1:for(n=0,a=Math.pow(2,16),u=1;u!=a;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=s,b.val=r(b.index++)),n|=(l>0?1:0)*u,u<<=1;p[h++]=e(n),c=h-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,f),f++),p[c])m=p[c];else{if(c!==h)return null;m=o+o.charAt(0)}g.push(m),p[h++]=o+m.charAt(0),o=m,0==--d&&(d=Math.pow(2,f),f++)}}};return o}();void 0===(r=function(){return i}.call(t,s,t,e))||(e.exports=r)},73:function(e,t,s){"use strict";s.r(t),s.d(t,"RESPONSE_VIEW_ID",(function(){return O})),s.d(t,"VectorTileInspector",(function(){return vector_tile_inspector_VectorTileInspector}));var r=s(6),i=s.n(r),o=s(53),n=s.n(o),l=s(2),a=s.n(l),u=s(3),c=s(69),p=s(14),d=s(70),h=s(54),f=s(4);function m(){return Object(f.jsx)(p.EuiEmptyPrompt,{title:Object(f.jsx)("h2",null,Object(f.jsx)(h.FormattedMessage,{id:"xpack.maps.inspector.vectorTile.noRequestsLoggedTitle",defaultMessage:"No requests logged for vector tiles"})),body:Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)("p",null,Object(f.jsx)(h.FormattedMessage,{id:"xpack.maps.inspector.vectorTile.noRequestsLoggedDescription.mapHasNotLoggedAnyRequestsText",defaultMessage:"This map does not have any vector tile search results."})))})}var g=s(483),b=s(5),y=s(0),x=s(64),v=s.n(x);function j(e){try{const{path:s,body:r}=function(e){const t=function(e){const t=e.split("?"),s=t.length<=1?"":t[1];return new URLSearchParams(s)}(e.tileUrl),s=t.has("requestBody")?t.get("requestBody"):"()";if(!t.has("index"))throw new Error("Required query parameter 'index' not provided.");const r=t.get("index");if(!t.has("geometryFieldName"))throw new Error("Required query parameter 'geometryFieldName' not provided.");const i=t.get("geometryFieldName"),o=!!t.has("hasLabels")&&"true"===t.get("hasLabels");if(!t.has("buffer"))throw new Error("Required query parameter 'buffer' not provided.");const n=parseInt(t.get("buffer"),10);if(e.tileUrl.includes(y.ob))return function({buffer:e,risonRequestBody:t,geometryFieldName:s,gridPrecision:r,hasLabels:i,index:o,renderAs:n=y.ub.POINT,x:l,y:a,z:u}){const c=v.a.decode(t);if(!c)throw new Error("Required requestBody parameter not provided");return{path:`/${encodeURIComponent(o)}/_mvt/${encodeURIComponent(s)}/${u}/${l}/${a}`,body:{buffer:e,size:0,grid_precision:r,exact_bounds:!1,extent:4096,query:c.query,grid_agg:n===y.ub.HEX?"geohex":"geotile",grid_type:n===y.ub.GRID||n===y.ub.HEX?"grid":"centroid",aggs:c.aggs,runtime_mappings:c.runtime_mappings,with_labels:i}}}({buffer:n,risonRequestBody:s,geometryFieldName:i,gridPrecision:parseInt(t.get("gridPrecision"),10),hasLabels:o,index:r,renderAs:t.get("renderAs"),x:e.x,y:e.y,z:e.z});if(e.tileUrl.includes(y.pb))return function({buffer:e,risonRequestBody:t,geometryFieldName:s,hasLabels:r,index:i,x:o,y:n,z:l}){const a=v.a.decode(t);if(!a)throw new Error("Required requestBody parameter not provided");const u="number"==typeof a.size?a.size:1e4,c={buffer:e,grid_precision:0,exact_bounds:!0,extent:4096,query:a.query,runtime_mappings:a.runtime_mappings,track_total_hits:u+1,size:u,with_labels:r};return a.fields&&(c.fields=a.fields),a.sort&&(c.sort=a.sort),{path:`/${encodeURIComponent(i)}/_mvt/${encodeURIComponent(s)}/${l}/${o}/${n}`,body:c}}({buffer:n,risonRequestBody:s,geometryFieldName:i,hasLabels:o,index:r,x:e.x,y:e.y,z:e.z});throw new Error("Unexpected path")}(e.tileRequest),i=`POST ${s}\n${JSON.stringify(r,null,2)}`;let o;if(Object(b.k)().show){var t;const e=Object(g.compressToEncodedURIComponent)(i);o=null===(t=Object(b.L)().url.locators.get("CONSOLE_APP_LOCATOR"))||void 0===t?void 0:t.useUrl({loadFrom:`data:text/plain,${e}`})}return Object(f.jsx)(p.EuiFlexGroup,{direction:"column",gutterSize:"s",wrap:!1,responsive:!0,style:{height:"100%"}},Object(f.jsx)(p.EuiFlexItem,{grow:!1},Object(f.jsx)(p.EuiSpacer,{size:"s"}),Object(f.jsx)(p.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"m",wrap:!0},Object(f.jsx)(p.EuiFlexItem,{grow:!1},Object(f.jsx)("div",null,Object(f.jsx)(p.EuiCopy,{textToCopy:i},(e=>Object(f.jsx)(p.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},u.i18n.translate("xpack.maps.inspector.vectorTileRequest.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"})))))),void 0!==o&&Object(f.jsx)(p.EuiFlexItem,{grow:!1},Object(f.jsx)("div",null,Object(f.jsx)(p.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>{Object(b.D)()(o)},iconType:"wrench"},u.i18n.translate("xpack.maps.inspector.vectorTileRequest.openInConsoleLabel",{defaultMessage:"Open in Console"})))))),Object(f.jsx)(p.EuiFlexItem,{grow:!0},Object(f.jsx)(d.CodeEditor,{languageId:c.XJsonLang.ID,value:i,options:{readOnly:!0,lineNumbers:"off",fontSize:12,minimap:{enabled:!1},folding:!0,scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}})))}catch(t){return Object(f.jsx)(p.EuiCallOut,{title:u.i18n.translate("xpack.maps.inspector.vectorTileRequest.errorMessage",{defaultMessage:"Unable to create Elasticsearch vector tile search request"}),color:"warning",iconType:"help"},Object(f.jsx)("p",null,u.i18n.translate("xpack.maps.inspector.vectorTileRequest.errorTitle",{defaultMessage:"Could not convert tile request, ''{tileUrl}'', to Elasticesarch vector tile search request, error: {error}",values:{tileUrl:e.tileRequest.tileUrl,error:t.message}})))}}function T(){return Object(f.jsx)(p.EuiCallOut,{size:"s",title:u.i18n.translate("xpack.maps.inspector.vectorTile.requestsView",{defaultMessage:"You're viewing vector tile search requests. To view requests submitted to the search API, set View to Requests."}),iconType:"iInCircle"})}const q="request_view",O="response_view";class vector_tile_inspector_VectorTileInspector extends l.Component{constructor(e){super(e),i()(this,"_isMounted",!1),i()(this,"_onAdapterChange",(()=>{const e=this.props.adapters.vectorTiles.getLayerOptions();if(0===e.length)return void this.setState({selectedLayer:null,selectedTileRequest:null,tileRequests:[],layerOptions:[]});const t=this._getDefaultLayer(e),s=this.props.adapters.vectorTiles.getTileRequests(t.value);this.setState({selectedLayer:t,selectedTileRequest:this._getDefaultTileRequest(s),tileRequests:s,layerOptions:e})})),i()(this,"_debouncedOnAdapterChange",n.a.debounce((()=>{this._isMounted&&this._onAdapterChange()}),256)),i()(this,"_onLayerSelect",(e=>{if(0===e.length)return void this.setState({selectedLayer:null,selectedTileRequest:null,tileRequests:[]});const t=e[0],s=this.props.adapters.vectorTiles.getTileRequests(t.value);this.setState({selectedLayer:t,selectedTileRequest:s.length?s[0]:null,tileRequests:s})})),i()(this,"_onTileSelect",(e=>{0!==e.length?this.setState({selectedTileRequest:e[0].value?e[0].value:null}):this.setState({selectedTileRequest:null})})),this.state={selectedLayer:null,selectedTileRequest:null,selectedView:e.options&&e.options.initialTab?e.options.initialTab:q,tileRequests:[],layerOptions:[]}}componentDidMount(){this._isMounted=!0,this._onAdapterChange(),this.props.adapters.vectorTiles.on("change",this._debouncedOnAdapterChange)}componentWillUnmount(){this._isMounted=!1,this.props.adapters.vectorTiles.removeListener("change",this._debouncedOnAdapterChange)}_getDefaultLayer(e){if(this.state.selectedLayer&&e.some((e=>{var t;return(null===(t=this.state.selectedLayer)||void 0===t?void 0:t.value)===e.value})))return this.state.selectedLayer;if(this.props.options&&this.props.options.initialLayerId){const t=e.find((e=>this.props.options.initialLayerId===e.value));if(t)return t}return e[0]}_getDefaultTileRequest(e){if(this.state.selectedTileRequest&&e.some((e=>{var t,s,r,i;return(null===(t=this.state.selectedTileRequest)||void 0===t?void 0:t.layerId)===e.layerId&&(null===(s=this.state.selectedTileRequest)||void 0===s?void 0:s.x)===e.x&&(null===(r=this.state.selectedTileRequest)||void 0===r?void 0:r.y)===e.y&&(null===(i=this.state.selectedTileRequest)||void 0===i?void 0:i.z)===e.z})))return this.state.selectedTileRequest;if(0===e.length)return null;if(this.props.options&&this.props.options.initialTileKey){const t=e.find((e=>this.props.options.initialTileKey===`${e.z}/${e.x}/${e.y}`));if(t)return t}return e[0]}_renderTileRequest(){if(!this.state.selectedTileRequest)return null;if(this.state.selectedView===q)return Object(f.jsx)(j,{key:`${this.state.selectedTileRequest.layerId}${this.state.selectedTileRequest.x}${this.state.selectedTileRequest.y}${this.state.selectedTileRequest.z}`,tileRequest:this.state.selectedTileRequest});const e=(t=this.state.selectedTileRequest).tileError?{error:t.tileError.error?t.tileError.error:t.tileError.message}:t.tileMetaFeature?{meta:t.tileMetaFeature.properties}:void 0;var t;return e?Object(f.jsx)(d.CodeEditor,{languageId:c.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"off",fontSize:12,minimap:{enabled:!1},folding:!0,scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}}):Object(f.jsx)(p.EuiText,null,Object(f.jsx)("p",null,u.i18n.translate("xpack.maps.inspector.vectorTile.tileMetaFeatureNotAvailable",{defaultMessage:"Not available"})))}render(){return 0===this.state.layerOptions.length?Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(T,null),Object(f.jsx)(m,null)):Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(T,null),Object(f.jsx)(p.EuiSpacer,null),Object(f.jsx)(p.EuiFormRow,{display:"columnCompressed",label:u.i18n.translate("xpack.maps.inspector.vectorTile.layerSelectLabel",{defaultMessage:"Layer"})},Object(f.jsx)(p.EuiComboBox,{fullWidth:!0,singleSelection:!0,options:this.state.layerOptions,selectedOptions:this.state.selectedLayer?[this.state.selectedLayer]:[],onChange:this._onLayerSelect,isClearable:!1})),Object(f.jsx)(p.EuiFormRow,{display:"columnCompressed",label:u.i18n.translate("xpack.maps.inspector.vectorTile.tileSelectLabel",{defaultMessage:"Tile"})},Object(f.jsx)(p.EuiComboBox,{fullWidth:!0,singleSelection:!0,options:this.state.tileRequests.map((e=>({label:`${e.z}/${e.x}/${e.y}`,value:e}))),selectedOptions:this.state.selectedTileRequest?[{label:`${this.state.selectedTileRequest.z}/${this.state.selectedTileRequest.x}/${this.state.selectedTileRequest.y}`,value:this.state.selectedTileRequest}]:[],onChange:this._onTileSelect,isClearable:!1})),Object(f.jsx)(p.EuiTabs,{size:"s"},Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(p.EuiTab,{onClick:()=>{this.setState({selectedView:q})},isSelected:this.state.selectedView===q},u.i18n.translate("xpack.maps.inspector.vectorTile.requestTabLabel",{defaultMessage:"Request"})),Object(f.jsx)(p.EuiTab,{onClick:()=>{this.setState({selectedView:O})},isSelected:this.state.selectedView===O},u.i18n.translate("xpack.maps.inspector.vectorTile.responseTabLabel",{defaultMessage:"Response"})))),Object(f.jsx)(p.EuiSpacer,{size:"s"}),this._renderTileRequest())}}}}]);