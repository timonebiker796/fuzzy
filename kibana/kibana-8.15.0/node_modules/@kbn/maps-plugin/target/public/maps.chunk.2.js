/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[]).push([[2],Array(91).concat([function(t,e,i){"use strict";i.d(e,"g",(function(){return n})),i.d(e,"f",(function(){return I})),i.d(e,"e",(function(){return P})),i.d(e,"d",(function(){return k})),i.d(e,"a",(function(){return blended_vector_layer_BlendedVectorLayer})),i.d(e,"b",(function(){return geojson_vector_layer_GeoJsonVectorLayer})),i.d(e,"c",(function(){return mvt_vector_layer_MvtVectorLayer})),i.d(e,"h",(function(){return pt}));var r=i(0);async function n({layerId:t,syncContext:e,source:i,sourceQuery:n}){const{startLoading:a,stopLoading:o,registerCancelCallback:l,dataFilters:c,isFeatureEditorOpenForLayer:u}=e,h=Symbol(`${r.yb}-${t}`),p={sourceQuery:n||void 0,query:c.query,timeFilters:c.timeFilters,timeslice:c.timeslice,embeddableSearchContext:c.embeddableSearchContext,filters:c.filters,joinKeyFilter:c.joinKeyFilter,applyGlobalQuery:i.getApplyGlobalQuery(),applyGlobalTime:i.getApplyGlobalTime(),isFeatureEditorOpenForLayer:u,executionContext:c.executionContext};let d=null;try{a(r.yb,h,p),d=await i.getBoundsForFilters(p,l.bind(null,h))}finally{o(r.yb,h,d||{})}return d}var a=i(6),o=i.n(a),l=i(2),c=i.n(l),u=i(56),h=i(62),p=i(53),d=i.n(p),f=i(14),m=i(3),g=i(132),y=i(100),_=i(4);class term_join_key_label_TermJoinKeyLabel extends l.Component{constructor(...t){super(...t),o()(this,"_isMounted",!1),o()(this,"state",{rightSourceLabels:[]})}componentDidMount(){this._isMounted=!0,this._loadRightSourceLabels()}componentWillUnmount(){this._isMounted=!1}async _loadRightSourceLabels(){const t=await Object(h.asyncMap)(this.props.termJoins,(async t=>{const e=t.getTermField();return`'${await e.getLabel()}'`}));this._isMounted&&this.setState({rightSourceLabels:t})}render(){if(0===this.state.rightSourceLabels.length)return this.props.leftFieldName;const t=m.i18n.translate("xpack.maps.tooltip.joinPropertyTooltipContent",{defaultMessage:"Shared key ''{leftFieldName}'' is joined with {rightSources}",values:{leftFieldName:this.props.leftFieldName,rightSources:this.state.rightSourceLabels.join(",")}});return Object(_.jsx)(c.a.Fragment,null,this.props.leftFieldName,Object(_.jsx)(f.EuiToolTip,{position:"bottom",content:t},Object(_.jsx)(f.EuiIcon,{type:"link"})))}}class term_join_tooltip_property_TermJoinTooltipProperty{constructor(t,e){o()(this,"_tooltipProperty",void 0),o()(this,"_termJoins",void 0),this._tooltipProperty=t,this._termJoins=e}isFilterable(){return!0}getPropertyKey(){return this._tooltipProperty.getPropertyKey()}getPropertyName(){return Object(_.jsx)(term_join_key_label_TermJoinKeyLabel,{leftFieldName:this._tooltipProperty.getPropertyName(),termJoins:this._termJoins})}getRawValue(){return this._tooltipProperty.getRawValue()}getHtmlDisplayValue(){return this._tooltipProperty.getHtmlDisplayValue()}async getESFilters(){const t=[];for(let e=0;e<this._termJoins.length;e++){const i=this._termJoins[e].getTermField();try{const e=await i.createTooltipProperty(this._tooltipProperty.getRawValue());if(e){const i=await e.getESFilters();t.push(...i)}}catch(t){console.error("Cannot create joined filter",t)}}return t}}var v=i(112),x=i(152),b=i(323),w=i(103),C=i(188),S=i(158),M=i(242),T=i(120),E=i(129);const A="SUPPORTS_FEATURE_EDITING_REQUEST_ID";function I(t){return"function"==typeof t.addFeature&&"function"==typeof t.canShowTooltip&&"function"==typeof t.deleteFeature&&"function"==typeof t.getFields&&"function"==typeof t.getJoins&&"function"==typeof t.getLeftJoinFields&&"function"==typeof t.getMbTooltipLayerIds&&"function"==typeof t.getValidJoins&&"function"==typeof t.hasJoins&&"function"==typeof t.supportsFeatureEditing}function P(t,e){return"function"==typeof t[e]}const O=Object(_.jsx)(f.EuiIcon,{size:"m",color:"subdued",type:"minusInCircle"}),k={icon:O,tooltipContent:m.i18n.translate("xpack.maps.vectorLayer.noResultsFoundTooltip",{defaultMessage:"No results found."})};class vector_layer_AbstractVectorLayer extends g.a{static createDescriptor(t,e){var i;const n=super.createDescriptor(t);if(n.type=void 0!==n.type?n.type:r.Z.GEOJSON_VECTOR,!t.style){const t=y.a.createDefaultStyleProperties(e||[]);n.style=y.a.createDescriptor(t)}return t.joins||(n.joins=[]),n.disableTooltips=null!==(i=t.disableTooltips)&&void 0!==i&&i,n}constructor({layerDescriptor:t,source:e,joins:i=[],customIcons:r,chartsPaletteServiceGetColor:n}){super({layerDescriptor:t,source:e}),o()(this,"_style",void 0),o()(this,"_joins",void 0),o()(this,"_descriptor",void 0),o()(this,"_masks",void 0),this._joins=i,this._descriptor=vector_layer_AbstractVectorLayer.createDescriptor(t),this._style=new y.a(this._descriptor.style,e,this,r,n),this._masks=this._createMasks()}async cloneDescriptor(){const t=await super.cloneDescriptor();if(0===t.length)return[];const e=t[0];return e.joins&&e.joins.forEach((t=>{var i;if(!t.right)return;const n=t.right,a=null!==(i=n.id)&&void 0!==i?i:"",o=Object(u.v4)();var l;(t.right.id=o,e.style&&"properties"in e.style)&&(null!==(l=n.metrics)&&void 0!==l?l:[{type:r.b.COUNT}]).forEach((t=>{const i=Object(T.a)({aggType:t.type,aggFieldName:"field"in t?t.field:"",rightSourceId:a}),n=Object(T.a)({aggType:t.type,aggFieldName:"field"in t?t.field:"",rightSourceId:o});Object.keys(e.style.properties).forEach((t=>{const a=e.style.properties[t];if("type"in a&&a.type===r.Eb.DYNAMIC){const t=a.options;t.field&&t.field.origin===r.D.JOIN&&t.field.name===i&&(t.field.name=n)}}))}))})),[e]}getSource(){return super.getSource()}getStyleForEditing(){return this._style}getStyle(){return this._style}getCurrentStyle(){return this._style}getJoins(){return this._joins.slice()}getValidJoins(){return this.getJoins().filter((t=>t.hasCompleteConfig()))}supportsFeatureEditing(){const t=this.getDataRequest(A),e=null==t?void 0:t.getData();return!!e&&e.supportsFeatureEditing}hasJoins(){return this.getValidJoins().length>0}_isLoadingJoins(){return this.getValidJoins().some((t=>{const e=this.getDataRequest(t.getSourceDataRequestId());return!e||e.isLoading()}))}_getSourceErrorTitle(){return m.i18n.translate("xpack.maps.vectorLayer.sourceErrorTitle",{defaultMessage:"An error occurred when loading layer features"})}getErrors(t){const e=super.getErrors(t);return this.getValidJoins().forEach((t=>{const i=this.getDataRequest(t.getSourceDataRequestId()),r=null==i?void 0:i.renderError();r&&e.push({title:m.i18n.translate("xpack.maps.vectorLayer.joinFetchErrorTitle",{defaultMessage:"An error occurred when loading join metrics"}),body:r})})),e}getLayerIcon(t){throw new Error("Should implement AbstractVectorLayer#getLayerIcon")}getLayerTypeIconName(){return"vector"}async hasLegendDetails(){return this.getCurrentStyle().hasLegendDetails()}renderLegendDetails(){return this.getCurrentStyle().renderLegendDetails()}async getBounds(t){return n({layerId:this.getId(),syncContext:t(this.getId()),source:this.getSource(),sourceQuery:this.getQuery()})}async getLeftJoinFields(){return await this.getSource().getLeftJoinFields()}_getJoinFields(){const t=[];return this.getValidJoins().forEach((e=>{const i=e.getJoinFields();t.push(...i)})),t}async getFields(){return[...await this.getSource().getFields(),...this._getJoinFields()]}async getStyleEditorFields(){return[...await this.getSourceForEditing().getFields(),...this._getJoinFields()]}getIndexPatternIds(){const t=[],e=this.getSource();return Object(w.b)(e,"getIndexPatternId")&&t.push(e.getIndexPatternId()),this.getValidJoins().forEach((e=>{const i=e.getRightJoinSource();Object(w.b)(i,"getIndexPatternId")&&t.push(i.getIndexPatternId())})),t}getQueryableIndexPatternIds(){const t=[],e=this.getSource();return e.getApplyGlobalQuery()&&Object(w.b)(e,"getIndexPatternId")&&t.push(e.getIndexPatternId()),this.getValidJoins().forEach((e=>{const i=e.getRightJoinSource();i.getApplyGlobalQuery()&&Object(w.b)(i,"getIndexPatternId")&&t.push(i.getIndexPatternId())})),t}async isFilteredByGlobalTime(){if(this.getSource().getApplyGlobalTime()&&await this.getSource().isTimeAware())return!0;const t=this.getValidJoins().map((async t=>t.getRightJoinSource().getApplyGlobalTime()&&await t.getRightJoinSource().isTimeAware()));return(await Promise.all(t)).some((t=>t))}async _getVectorSourceRequestMeta(t,e,i,r,n){const a=[...r.getSourceFieldNames(),...this.getValidJoins().filter((t=>!Object(C.a)(t.toDescriptor()))).map((t=>t.getLeftField().getName()))],o=await i.getTimesliceMaskFieldName();return o&&a.push(o),Object(M.a)(i,a,e,this.getQuery(),t,n)}async _syncSourceStyleMeta(t,e,i){const n=this.getQuery();return this._syncStyleMeta({source:e,style:i,sourceQuery:n||void 0,dataRequestId:r.Bb,dynamicStyleProps:i.getDynamicPropertiesArray().filter((t=>t.getFieldOrigin()===r.D.SOURCE&&t.isFieldMetaEnabled())),...t})}async _syncStyleMeta({source:t,style:e,sourceQuery:i,dataRequestId:r,dynamicStyleProps:n,dataFilters:a,startLoading:o,stopLoading:l,onLoadError:c,registerCancelCallback:u,inspectorAdapters:h}){if(!Object(w.b)(t,"loadStylePropsMeta")||0===n.length)return;const p=n.map((t=>`${t.getFieldName()}${t.getStyleMetaHash()}`)),f={dynamicStyleFields:d.a.uniq(p).sort(),sourceQuery:i,isTimeAware:this.getCurrentStyle().isTimeAware()&&await t.isTimeAware(),timeFilters:a.timeFilters,searchSessionId:a.searchSessionId},m=this.getDataRequest(r);if(Object(x.c)({prevDataRequest:m,nextMeta:f}))return;const g=Symbol(`layer-${this.getId()}-${r}`);try{o(r,g,f);const i=await this.getDisplayName(t),{styleMeta:c,warnings:p}=await t.loadStylePropsMeta({layerName:i,style:e,dynamicStyleProps:n,registerCancelCallback:u.bind(null,g),sourceQuery:f.sourceQuery,timeFilters:f.timeFilters,searchSessionId:a.searchSessionId,inspectorAdapters:h,executionContext:a.executionContext});l(r,g,c,{...f,warnings:p})}catch(t){throw t instanceof v.b||c(r,g,t),t}}async _syncSourceFormatters(t,e,i){return this._syncFormatters({source:e,dataRequestId:r.Ab,fields:i.getDynamicPropertiesArray().filter((t=>t.getFieldOrigin()===r.D.SOURCE)).map((t=>t.getField())),...t})}async _syncFormatters({source:t,dataRequestId:e,fields:i,startLoading:r,stopLoading:n,onLoadError:a}){if(0===i.length)return;const o=i.map((t=>t.getName())),l={fieldNames:d.a.uniq(o).sort()},c=this.getDataRequest(e);if(Object(x.a)({prevDataRequest:c,nextMeta:l}))return;const u=Symbol(`layer-${this.getId()}-${e}`);try{r(e,u,l);const a={},o=i.filter((t=>t.canValueBeFormatted())).map((async e=>{a[e.getName()]=await t.createFieldFormatter(e)}));await Promise.all(o),n(e,u,a,l)}catch(t){throw a(e,u,t),t}}async _syncJoin({join:t,joinIndex:e,featureCollection:i,startLoading:r,stopLoading:n,onLoadError:a,registerCancelCallback:o,dataFilters:l,isForceRefresh:c,isFeatureEditorOpenForLayer:u,inspectorAdapters:h}){const p=t.getRightJoinSource(),d=t.getSourceDataRequestId(),f=Symbol(`layer-join-refresh:${this.getId()} - ${d}`),m=Object(M.a)(p,[],l,p.getWhereQuery(),c,u),g=this.getDataRequest(d);if(await Object(x.b)({source:p,prevDataRequest:g,nextRequestMeta:m,extentAware:!1,getUpdateDueToTimeslice:()=>!0}))return{dataHasChanged:!1,join:t,joinIndex:e,joinMetrics:null==g?void 0:g.getData()};try{r(d,f,m);const{joinMetrics:a,warnings:l}=await p.getJoinMetrics(m,await this.getDisplayName(),o.bind(null,f),h,i);return n(d,f,a,{warnings:l}),{dataHasChanged:!0,join:t,joinIndex:e,joinMetrics:a}}catch(t){throw t instanceof v.b||a(d,f,t),t}}async _syncJoins(t,e,i){const r=this.getJoins().map(((t,e)=>({join:t,joinIndex:e}))).filter((({join:t})=>t.hasCompleteConfig())),n=[];return await Object(h.asyncForEach)(r,(async({join:r,joinIndex:a})=>{await this._syncJoinStyleMeta(t,r,e),await this._syncJoinFormatters(t,r,e);const o=await this._syncJoin({join:r,joinIndex:a,featureCollection:i,...t});n.push(o)})),n}async _syncJoinStyleMeta(t,e,i){const n=e.getRightJoinSource();return this._syncStyleMeta({source:n,style:i,sourceQuery:n.getWhereQuery(),dataRequestId:e.getSourceMetaDataRequestId(),dynamicStyleProps:this.getCurrentStyle().getDynamicPropertiesArray().filter((t=>{const e=n.getFieldByName(t.getFieldName());return t.getFieldOrigin()===r.D.JOIN&&!!e&&t.isFieldMetaEnabled()})),...t})}async _syncJoinFormatters(t,e,i){const n=e.getRightJoinSource();return this._syncFormatters({source:n,dataRequestId:e.getSourceFormattersDataRequestId(),fields:i.getDynamicPropertiesArray().filter((t=>{const e=n.getFieldByName(t.getFieldName());return t.getFieldOrigin()===r.D.JOIN&&!!e})).map((t=>t.getField())),...t})}async _syncSupportsFeatureEditing({syncContext:t,source:e}){if(t.dataFilters.isReadOnly)return;const{startLoading:i,stopLoading:r,onLoadError:n}=t,a=A,o=Symbol(`layer-${this.getId()}-${a}`);if(!this.getDataRequest(a))try{i(a,o),r(a,o,{supportsFeatureEditing:await e.supportsFeatureEditing()})}catch(t){throw n(a,o,t),t}}_getJoinFilterExpression(){}_createMasks(){const t=[],e=this.getSource();return"getMetricFields"in e&&e.getMetricFields().forEach((i=>{const r=i.getMask();r&&t.push(new E.d({esAggField:i,isGeometrySourceMvt:e.isMvt(),...r}))})),this.getValidJoins().forEach((i=>{const r=i.getRightJoinSource();"getMetricFields"in r&&r.getMetricFields().forEach((i=>{const r=i.getMask();r&&t.push(new E.d({esAggField:i,isGeometrySourceMvt:e.isMvt(),...r}))}))})),t}getMasks(){return this._masks}_getAlphaExpression(){const t=[];return this.getMasks().forEach((e=>{t.push(e.getMatchMaskedExpression()),t.push(0)})),t.length?["case",...t,this.getAlpha()]:this.getAlpha()}_setMbPointsProperties(t,e,i){const r=this.getId(),n=this._getMbLabelLayerId(),a=this._getMbPointLayerId(),o=this._getMbSymbolLayerId(),l=t.getLayer(a),c=t.getLayer(o);let u;if(this.getCurrentStyle().arePointsSymbolizedAsCircles()){if(u=a,!l){const i={id:a,type:"circle",source:r,paint:{}};e&&(i["source-layer"]=e),t.addLayer(i,n)}c&&t.setLayoutProperty(o,"visibility","none")}else{if(u=o,!c){const i={id:o,type:"symbol",source:r};e&&(i["source-layer"]=e),t.addLayer(i,n)}l&&t.setLayoutProperty(a,"visibility","none")}const h=!this.getSource().isMvt(),p=Object(b.e)(h,Object(w.d)(this.getSource()),this._getJoinFilterExpression(),i);d.a.isEqual(p,t.getFilter(u))||t.setFilter(u,p),this.getCurrentStyle().arePointsSymbolizedAsCircles()?this.getCurrentStyle().setMBPaintPropertiesForPoints({alpha:this._getAlphaExpression(),mbMap:t,pointLayerId:u}):this.getCurrentStyle().setMBSymbolPropertiesForPoints({alpha:this._getAlphaExpression(),mbMap:t,symbolLayerId:u}),this.syncVisibilityWithMb(t,u),t.setLayerZoomRange(u,this.getMinZoom(),this.getMaxZoom())}_setMbLinePolygonProperties(t,e,i){const r=this.getId(),n=this._getMbLabelLayerId(),a=this._getMbPolygonLayerId(),o=this._getMbLineLayerId();if(!t.getLayer(a)){const i={id:a,type:"fill",source:r,paint:{}};e&&(i["source-layer"]=e),t.addLayer(i,n)}if(!t.getLayer(o)){const i={id:o,type:"line",source:r,paint:{}};e&&(i["source-layer"]=e),t.addLayer(i,n)}this.getCurrentStyle().setMBPaintProperties({alpha:this._getAlphaExpression(),mbMap:t,fillLayerId:a,lineLayerId:o});const l=this._getJoinFilterExpression();this.syncVisibilityWithMb(t,a),t.setLayerZoomRange(a,this.getMinZoom(),this.getMaxZoom());const c=Object(b.b)(l,i);d.a.isEqual(c,t.getFilter(a))||t.setFilter(a,c),this.syncVisibilityWithMb(t,o),t.setLayerZoomRange(o,this.getMinZoom(),this.getMaxZoom());const u=Object(b.d)(l,i);d.a.isEqual(u,t.getFilter(o))||t.setFilter(o,u)}_setMbLabelProperties(t,e,i){const r=this._getMbLabelLayerId();if(!t.getLayer(r)){const i={id:r,type:"symbol",source:this.getId()};e&&(i["source-layer"]=e),t.addLayer(i)}const n=!this.getSource().isMvt(),a=Object(b.c)(n,Object(w.d)(this.getSource()),this._getJoinFilterExpression(),i);d.a.isEqual(a,t.getFilter(r))||t.setFilter(r,a),this.getCurrentStyle().setMBPropertiesForLabelText({alpha:this._getAlphaExpression(),mbMap:t,textLayerId:r}),this.syncVisibilityWithMb(t,r)}_getMbPointLayerId(){return this.makeMbLayerId("circle")}_getMbLabelLayerId(){return this.makeMbLayerId("label")}_getMbSymbolLayerId(){return this.makeMbLayerId("symbol")}_getMbLineLayerId(){return this.makeMbLayerId("line")}_getMbPolygonLayerId(){return this.makeMbLayerId("fill")}getMbTooltipLayerIds(){return[this._getMbPointLayerId(),this._getMbLabelLayerId(),this._getMbSymbolLayerId(),this._getMbLineLayerId(),this._getMbPolygonLayerId()]}getMbLayerIds(){return this.getMbTooltipLayerIds()}ownsMbLayerId(t){return this.getMbLayerIds().includes(t)}ownsMbSourceId(t){return this.getId()===t}_addJoinsToSourceTooltips(t){for(let e=0;e<t.length;e++){const i=t[e],r=[];for(let t=0;t<this.getJoins().length;t++){const e=this.getJoins()[t].getRightJoinSource();Object(S.f)(e)&&this.getJoins()[t].getLeftField().getName()===i.getPropertyKey()&&r.push(e)}r.length&&(t[e]=new term_join_tooltip_property_TermJoinTooltipProperty(i,r))}}async getPropertiesForTooltip(t,e){const i=this.getSource();let r=await i.getTooltipProperties(t,e);this._addJoinsToSourceTooltips(r);for(let i=0;i<this.getJoins().length;i++){const n=await this.getJoins()[i].getTooltipProperties(t,e);r=[...r,...n]}return r}canShowTooltip(){return this.getSource().hasTooltipProperties()||this.getJoins().length>0}areTooltipsDisabled(){var t;return null!==(t=this._descriptor.disableTooltips)&&void 0!==t&&t}getFeatureId(t){throw new Error("Should implement AbstractVectorLayer#getFeatureId")}getFeatureById(t){throw new Error("Should implement AbstractVectorLayer#getFeatureById")}async getLicensedFeatures(){return await this._source.getLicensedFeatures()}async addFeature(t){const e=this.getSource();await e.addFeature(t)}async deleteFeature(t){const e=this.getSource();await e.deleteFeature(t)}async getStyleMetaDescriptorFromLocalFeatures(){throw new Error("Should implement AbstractVectorLayer#getStyleMetaDescriptorFromLocalFeatures")}}var D=i(325),F=i(586),z=i.n(F),j=i(588),N=i.n(j),B=i(265),V=i.n(B),U=i(589),H=i.n(U),q=i(101);function Z(t){let e=null;if(t.geometry.type===r.J.LINE_STRING)e=G(t);else if(t.geometry.type===r.J.MULTI_LINE_STRING){const i=t.geometry.coordinates;let r=i[0],n=H()(Object(q.lineString)(r));for(let t=1;t<i.length;t++){const e=i[t],a=H()(Object(q.lineString)(e));a>n&&(r=e,n=a)}e=G(Object(q.lineString)(r))}else if(t.geometry.type===r.J.POLYGON)e=V()(t).geometry;else if(t.geometry.type===r.J.MULTI_POLYGON){const i=t.geometry.coordinates;let r=i[0],n=N()(Object(q.polygon)(r));for(let t=1;t<i.length;t++){const e=i[t],a=N()(Object(q.polygon)(e));a>n&&(r=e,n=a)}e=V()(Object(q.polygon)(r)).geometry}else if(t.geometry.type===r.J.GEOMETRY_COLLECTION&&t.geometry.geometries.length){const i=t.geometry.geometries[0];if(i.type===r.J.POINT)e=i;else{if(i.type!==r.J.MULTI_POINT)return Z({...t,geometry:i});e={type:"Point",coordinates:i.coordinates[0]}}}return e?{type:"Feature",id:t.id,properties:{...t.properties,[r.U]:!0},geometry:e}:null}function G(t){const e=H()(t);return z()(t,e/2).geometry}let $=0;function W(){const t=$<Number.MAX_SAFE_INTEGER?$:0;return $=t+1,t}function X(t){return t.length<=5?t.join(","):t.slice(0,5).join(",")+m.i18n.translate("xpack.maps.vectorLayer.joinError.firstTenMsg",{defaultMessage:" (5 of {total})",values:{total:t.length}})}var Y=i(141);const K=[r.J.POINT,r.J.MULTI_POINT],J=[r.J.LINE_STRING,r.J.MULTI_LINE_STRING],tt=[r.J.POLYGON,r.J.MULTI_POLYGON];function et(t,e,i){return 1===e.length?e[0]===t:Object.keys(i).reduce(((e,r)=>{const n=i[r];return r===t?e&&n:e&&!n}),!0)}class geojson_vector_layer_GeoJsonVectorLayer extends vector_layer_AbstractVectorLayer{static createDescriptor(t,e){const i=super.createDescriptor(t);if(i.type=r.Z.GEOJSON_VECTOR,!t.style){const t=y.a.createDefaultStyleProperties(e||[]);i.style=y.a.createDescriptor(t)}return t.joins||(i.joins=[]),i}isLayerLoading(t){var e;if(!this.isVisible()||!this.showAtZoomLevel(t))return!1;if(super.isLayerLoading(t))return!0;const i=this._getSourceFeatureCollection();return!(!i||0===(null==i||null===(e=i.features)||void 0===e?void 0:e.length))&&this._isLoadingJoins()}_isTiled(){return!1}async getBounds(t){return!this.getSource().isBoundsAware()||this.hasJoins()?Object(D.a)(this._getSourceFeatureCollection(),this.hasJoins()):super.getBounds(t)}getLayerIcon(t){const e=this._getSourceFeatureCollection();if(!e||0===e.features.length)return k;if(this.getJoins().length&&!e.features.some((t=>{var e;return null===(e=t.properties)||void 0===e?void 0:e[r.C]})))return{icon:O,tooltipContent:m.i18n.translate("xpack.maps.vectorLayer.noResultsFoundInJoinTooltip",{defaultMessage:"No matching results found in term joins"})};const i=this.getSourceDataRequest(),{tooltipContent:n,areResultsTrimmed:a,isDeprecated:o}=this.getSource().getSourceStatus(i);return{icon:o?Object(_.jsx)(f.EuiIcon,{type:"warning",color:"danger"}):this.getCurrentStyle().getIcon(t&&a),tooltipContent:n,areResultsTrimmed:a}}getFeatureId(t){var e;return null===(e=t.properties)||void 0===e?void 0:e[r.H]}getFeatureById(t){const e=this._getSourceFeatureCollection();if(!e)return null;return e.features.find((e=>this.getFeatureId(e)===t))||null}async getStyleMetaDescriptorFromLocalFeatures(){const t=this.getSourceDataRequest();return this.getCurrentStyle()&&t?await async function(t,e,i){const n={[r.Hb.POINT]:!1,[r.Hb.LINE]:!1,[r.Hb.POLYGON]:!1};if(e.length>1)for(let e=0;e<t.length;e++){var a;const i=t[e];null!==(a=i.properties)&&void 0!==a&&a[r.U]||(!n[r.Hb.POINT]&&K.includes(i.geometry.type)&&(n[r.Hb.POINT]=!0),!n[r.Hb.LINE]&&J.includes(i.geometry.type)&&(n[r.Hb.LINE]=!0),!n[r.Hb.POLYGON]&&tt.includes(i.geometry.type)&&(n[r.Hb.POLYGON]=!0))}const o={geometryTypes:{isPointsOnly:et(r.Hb.POINT,e,n),isLinesOnly:et(r.Hb.LINE,e,n),isPolygonsOnly:et(r.Hb.POLYGON,e,n)},fieldMeta:{}};return 0===i.length||0===t.length||i.forEach((e=>{const i=e.getFieldName();o.fieldMeta[i]||(o.fieldMeta[i]={categories:[]});const r=function(t,e){const i=t.getNumberOfCategories();if(!t.isCategorical()||i<=0)return[];const r=new Map;for(let i=0;i<e.length;i++){const n=e[i],a=n.properties?n.properties[t.getFieldName()]:void 0;void 0!==typeof a&&(r.has(a)?r.set(a,r.get(a)+1):r.set(a,1))}const n=[];for(const[t,e]of r)n.push({key:t,count:e});if(n.sort(((t,e)=>e.count-t.count)),n.length<=i)return n;const a=n.slice(0,i);let o=0;for(let t=i;t<n.length;t++)o+=n[t].count;return[...a,{key:Y.b,count:o}]}(e,t);r.length&&(o.fieldMeta[i].categories=r);const n=function(t,e){const i=t.getField();if(!i||!t.isOrdinal())return null;const r=t.getFieldName(),n=i.isCount();let a=n?1:1/0,o=-1/0;for(let t=0;t<e.length;t++){const i=e[t],l=i.properties?parseFloat(i.properties[r]):NaN;isNaN(l)||(n||(a=Math.min(a,l)),o=Math.max(o,l))}return a===1/0||o===-1/0?null:{min:a,max:o,delta:o-a}}(e,t);n&&(o.fieldMeta[i].range=n)})),o}(d.a.get(t.getData(),"features",[]),await this.getSource().getSupportedShapeTypes(),this.getCurrentStyle().getDynamicPropertiesArray()):null}getErrors(t){const e=super.getErrors(t);return this.getValidJoins().forEach((t=>{const i=t.toDescriptor();i.error&&e.push({title:m.i18n.translate("xpack.maps.geojsonVectorLayer.joinErrorTitle",{defaultMessage:"An error occurred when adding join metrics to layer features"}),body:i.error})})),e}_requiresPrevSourceCleanup(t){const e=t.getSource(this.getMbSourceId());return!!e&&"geojson"!==e.type}syncLayerWithMB(t,e){this._removeStaleMbSourcesAndLayers(t);const i=this.getMbSourceId();t.getSource(i)||t.addSource(i,{type:"geojson",data:r.z}),this._syncFeatureCollectionWithMb(t);const n=this._getTimesliceMaskConfig(e);this._setMbLabelProperties(t,void 0,n),this._setMbPointsProperties(t,void 0,n),this._setMbLinePolygonProperties(t,void 0,n)}_getJoinFilterExpression(){return this.hasJoins()?["==",["get",r.C],!0]:void 0}_syncFeatureCollectionWithMb(t){const e=t.getSource(this.getId()),i=this._getSourceFeatureCollection(),n=g.a.getBoundDataForSource(t,this.getId());if(!i)return n&&this.getCurrentStyle().clearFeatureState(n,t,this.getId()),void e.setData(r.z);const a=this.getCurrentStyle().setFeatureStateAndStyleProps(i,t,this.getId());(i!==n||a)&&e.setData(i)}_getTimesliceMaskConfig(t){var e;if(!t||this.hasJoins())return;const i=null===(e=this.getSourceDataRequest())||void 0===e?void 0:e.getMeta();return void 0!==i&&void 0!==i.timesliceMaskField?{timesliceMaskField:i.timesliceMaskField,timeslice:t}:void 0}async syncData(t){await this._syncData(t,this.getSource(),this.getCurrentStyle())}_isLoadingBounds(){const t=this.getDataRequest(r.yb);return!!t&&t.isLoading()}async _syncData(t,e,i){if(!this._isLoadingBounds())try{await this._syncSourceStyleMeta(t,e,i),await this._syncSourceFormatters(t,e,i);const n=await async function({layerId:t,layerName:e,prevDataRequest:i,requestMeta:n,syncContext:a,source:o,getUpdateDueToTimeslice:l}){const{startLoading:c,stopLoading:u,onLoadError:h,registerCancelCallback:p,isRequestStillActive:f}=a,m=r.zb,g=Symbol(`${t}-${m}`);if(!a.forceRefreshDueToDrawing&&await Object(x.b)({source:o,prevDataRequest:i,nextRequestMeta:n,extentAware:o.isFilterByMapBounds(),getUpdateDueToTimeslice:l}))return{refreshed:!1,featureCollection:i?i.getData():r.z};try{c(m,g,n);const{data:t,meta:i}=await o.getGeoJsonWithMeta(e,n,p.bind(null,g),(()=>f(m,g)),a.inspectorAdapters),l=function(t){const e=[];for(let i=0;i<t.features.length;i++){const t=W();e.push(t)}const i=d.a.shuffle(e),n=[];for(let e=0;e<t.features.length;e++){const a=i[e],o=t.features[e];n.push({type:"Feature",geometry:o.geometry,properties:{[r.H]:null==o.id?a:o.id,...o.properties},id:a})}return{type:"FeatureCollection",features:n}}(t),h=await o.getSupportedShapeTypes();(h.includes(r.Hb.LINE)||h.includes(r.Hb.POLYGON))&&l.features.push(...function(t){const e=[];for(let i=0;i<t.features.length;i++){const r=Z(t.features[i]);r&&e.push(r)}return e}(l));const y=i?{...i}:{};if(n.applyGlobalTime&&await o.isTimeAware()){const t=await o.getTimesliceMaskFieldName();t&&(y.timesliceMaskField=t)}return u(m,g,l,y),{refreshed:!0,featureCollection:l}}catch(t){throw t instanceof v.b||h(m,g,t),t}}({layerId:this.getId(),layerName:await this.getDisplayName(e),prevDataRequest:this.getSourceDataRequest(),requestMeta:await this._getVectorSourceRequestMeta(t.isForceRefresh,t.dataFilters,e,i,t.isFeatureEditorOpenForLayer),syncContext:t,source:e,getUpdateDueToTimeslice:t=>this._getUpdateDueToTimesliceFromSourceRequestMeta(e,t)});if(await this._syncSupportsFeatureEditing({syncContext:t,source:e}),!n.featureCollection||!n.featureCollection.features.length||!this.hasJoins())return;const a=await this._syncJoins(t,i,n.featureCollection);await async function(t,e,i,n){let a=t.refreshed||e.some((t=>t.dataHasChanged));if(!a)return;const o=e.map((t=>({joinedWithAtLeastOneFeature:!1,keys:[],joinState:t})));for(let i=0;i<t.featureCollection.features.length;i++){const n=t.featureCollection.features[i];n.properties||(n.properties={});const l=n.properties[r.C];let c=!0;for(let t=0;t<e.length;t++){const i=e[t],r=i.join,a=o[t],l=r.getJoinKey(n);null!==l&&a.keys.push(l);const u=!!i.joinMetrics&&r.joinPropertiesToFeature(n,i.joinMetrics);u&&!a.joinedWithAtLeastOneFeature&&(a.joinedWithAtLeastOneFeature=!0),c=c&&u}l!==c&&(a=!0),n.properties[r.C]=c}a&&i({...t.featureCollection}),await Object(h.asyncForEach)(o,(async t=>{n(t.joinState.joinIndex,await async function(t){if(!Object(S.f)(t.joinState.join.getRightJoinSource()))return;if(!(t.joinState.joinMetrics&&t.joinState.joinMetrics.size>0)||t.joinedWithAtLeastOneFeature)return;const e=await t.joinState.join.getLeftField().getLabel(),i=t.joinState.join.getRightJoinSource(),r=await i.getTermField().getLabel();return 0===t.keys.length?m.i18n.translate("xpack.maps.vectorLayer.joinError.noLeftFieldValuesMsg",{defaultMessage:"Left field: ''{leftFieldName}'', did not provide any values.",values:{leftFieldName:e}}):m.i18n.translate("xpack.maps.vectorLayer.joinError.noMatchesMsg",{defaultMessage:"Left field values do not match right field values. Left field: ''{leftFieldName}'' has values: {leftFieldValues}. Right field: ''{rightFieldName}'' has values: {rightFieldValues}.",values:{leftFieldName:e,leftFieldValues:X(t.keys),rightFieldName:r,rightFieldValues:X(Array.from(t.joinState.joinMetrics.keys()))}})}(t))}))}(n,a,t.updateSourceData,t.setJoinError)}catch(t){}}_getSourceFeatureCollection(){const t=this.getSourceDataRequest();return t?t.getData():null}_getUpdateDueToTimesliceFromSourceRequestMeta(t,e){const i=this.getSourceDataRequest(),r=null==i?void 0:i.getMeta();return!r||t.getUpdateDueToTimeslice(r,e)}}var it=i(98),at=i(123),ot=i(258);const lt="ACTIVE_COUNT_DATA_ID";function ct(t){return t.isOrdinal()?r.b.AVG:r.b.TERMS}class blended_vector_layer_BlendedVectorLayer extends geojson_vector_layer_GeoJsonVectorLayer{static createDescriptor(t,e){const i=geojson_vector_layer_GeoJsonVectorLayer.createDescriptor(t,e);return i.type=r.Z.BLENDED_VECTOR,i}constructor(t){super({...t,joins:[]}),o()(this,"_isClustered",void 0),o()(this,"_clusterSource",void 0),o()(this,"_clusterStyle",void 0),o()(this,"_documentSource",void 0),o()(this,"_documentStyle",void 0),o()(this,"getSource",(()=>this._isClustered?this._clusterSource:this._documentSource)),this._documentSource=this._source,this._documentStyle=this._style,this._clusterSource=function(t,e){const i=at.a.createDescriptor({indexPatternId:t.getIndexPatternId(),geoField:t.getGeoFieldName(),requestType:r.ub.POINT,resolution:r.L.COARSE});return i.applyGlobalQuery=t.getApplyGlobalQuery(),i.applyGlobalTime=t.getApplyGlobalTime(),i.applyForceRefresh=t.getApplyForceRefresh(),i.metrics=[{type:r.b.COUNT},...e.getDynamicPropertiesArray().map((t=>({type:ct(t),field:t.getFieldName()})))],i.id=t.getId(),new at.a(i)}(this._documentSource,this._documentStyle);const e=function(t,e){const i=Object(it.i)(),n={type:r.Y.VECTOR,properties:{[r.Ib.LABEL_TEXT]:{type:r.Eb.DYNAMIC,options:{...i[r.Ib.LABEL_TEXT].options,field:{name:r.k,origin:r.D.SOURCE}}},[r.Ib.ICON_SIZE]:{type:r.Eb.DYNAMIC,options:{...i[r.Ib.ICON_SIZE].options,field:{name:r.k,origin:r.D.SOURCE}}}},isTimeAware:!0};return t.getAllStyleProperties().forEach((t=>{const i=t.getStyleName();if(![r.Ib.LABEL_TEXT,r.Ib.ICON_SIZE].includes(i)||t.isDynamic()&&t.isComplete())if(i===r.Ib.SYMBOLIZE_AS||i===r.Ib.LABEL_BORDER_SIZE)n.properties[i]={options:{...t.getOptions()}};else if(t.isDynamic()){const a=t.getOptions(),o=a&&a.field&&a.field.name?{...a.field,name:e.getAggKey(ct(t),a.field.name)}:void 0;n.properties[i]={type:r.Eb.DYNAMIC,options:{...a,field:o}}}else n.properties[i]={type:r.Eb.STATIC,options:{...t.getOptions()}}})),n}(this._documentStyle,this._clusterSource);this._clusterStyle=new y.a(e,this._clusterSource,this,t.customIcons,t.chartsPaletteServiceGetColor);let i=!1;const n=this.getDataRequest(lt);if(n){const t=n.getData();t&&t.isSyncClustered&&(i=!0)}this._isClustered=i}async getDisplayName(t){const e=await super.getDisplayName(t);return this._isClustered?m.i18n.translate("xpack.maps.blendedVectorLayer.clusteredLayerName",{defaultMessage:"Clustered {displayName}",values:{displayName:e}}):e}getJoins(){return[]}hasJoins(){return!1}async cloneDescriptor(){const t=await super.cloneDescriptor();if(0===t.length)return[];const e=t[0],i=await super.getDisplayName();return e.label=`Clone of ${i}`,e.sourceDescriptor=this._documentSource.cloneDescriptor(),[e]}getSourceForEditing(){return this._documentSource}getCurrentStyle(){return this._isClustered?this._clusterStyle:this._documentStyle}getStyleForEditing(){return this._documentStyle}async syncData(t){const e=lt,i=Symbol(`layer-active-count:${this.getId()}`),r=await this._getVectorSourceRequestMeta(t.isForceRefresh,t.dataFilters,this.getSource(),this.getCurrentStyle(),t.isFeatureEditorOpenForLayer),n=this.getSource();let a,o;if(await Object(x.b)({source:n,prevDataRequest:this.getDataRequest(e),nextRequestMeta:r,extentAware:n.isFilterByMapBounds(),getUpdateDueToTimeslice:t=>this._getUpdateDueToTimesliceFromSourceRequestMeta(n,t)}))this._isClustered?(a=this._clusterSource,o=this._clusterStyle):(a=this._documentSource,o=this._documentStyle);else{let n;try{t.startLoading(e,i,r);const a=[];n=!await this._documentSource.canLoadAllDocuments(await this.getDisplayName(this._documentSource),r,t.registerCancelCallback.bind(null,i),t.inspectorAdapters,(t=>{a.push(t)})),t.stopLoading(e,i,{isSyncClustered:n},{...r,warnings:a})}catch(r){return void(r instanceof v.b&&Object(ot.b)(r)||t.onLoadError(e,i,r))}n?(this._isClustered=!0,a=this._clusterSource,o=this._clusterStyle):(this._isClustered=!1,a=this._documentSource,o=this._documentStyle)}super._syncData(t,a,o)}async getLicensedFeatures(){return[...await this._clusterSource.getLicensedFeatures(),...await this._documentSource.getLicensedFeatures()]}}var ut=i(58),ht=i(93);async function pt({buffer:t,hasLabels:e,layerId:i,layerName:n,prevDataRequest:a,requestMeta:o,source:l,syncContext:c}){const h=Symbol(`${i}-${r.zb}`),p=a?a.getData():void 0;if(p){const i=p.tileSourceLayer===l.getTileSourceLayer()&&p.tileMinZoom===l.getMinZoom()&&p.tileMaxZoom===l.getMaxZoom(),r=await Object(x.b)({extentAware:!1,source:l,prevDataRequest:a,nextRequestMeta:o,getUpdateDueToTimeslice:t=>!0});if(!c.forceRefreshDueToDrawing&&i&&r&&p.hasLabels===e&&p.buffer===t)return}c.startLoading(r.zb,h,o);try{const a=!p||c.forceRefreshDueToDrawing||o.isForceRefresh&&o.applyForceRefresh?Object(u.v4)():p.refreshToken,d=await l.getTileUrl(o,a,e,t);Object(w.d)(l)&&c.inspectorAdapters.vectorTiles.addLayer(i,n,d);const f={tileUrl:d,tileSourceLayer:l.getTileSourceLayer(),tileMinZoom:l.getMinZoom(),tileMaxZoom:l.getMaxZoom(),refreshToken:a,hasLabels:e,buffer:t};c.stopLoading(r.zb,h,f,{})}catch(t){c.onLoadError(r.zb,h,t)}}var dt=i(133);const ft="maxResultWindow";class mvt_vector_layer_MvtVectorLayer extends vector_layer_AbstractVectorLayer{static createDescriptor(t,e){const i=super.createDescriptor(t,e);if(i.type=r.Z.MVT_VECTOR,!i.style){const t=y.a.createDefaultStyleProperties(e||[]);i.style=y.a.createDescriptor(t)}return i}constructor(t){super(t),o()(this,"_source",void 0),this._source=t.source}isLayerLoading(t){return!(!this.isVisible()||!this.showAtZoomLevel(t))&&(!!super.isLayerLoading(t)||this._isLoadingJoins())}_isTiled(){return!0}async getBounds(t){let e;const i=this.getSource();if(Object(w.b)(i,"getIndexPattern")){const{join:t,joinPropertiesMap:r}=this._getJoinResults();if(t&&r){const n=await i.getIndexPattern(),a=Object(ht.l)(n,t.getLeftField().getName());e=Object(ut.buildPhrasesFilter)(a,Array.from(r.keys()),n)}}const r=t(this.getId());return n({layerId:this.getId(),syncContext:{...r,dataFilters:{...r.dataFilters,joinKeyFilter:e}},source:this.getSource(),sourceQuery:this.getQuery()})}getFeatureId(t){var e,i;return Object(w.d)(this.getSource())?this.getSource().getType()===r.Cb.ES_SEARCH?null===(e=t.properties)||void 0===e?void 0:e._id:null===(i=t.properties)||void 0===i?void 0:i._key:t.id}getLayerIcon(t){if(!Object(w.d)(this.getSource()))return{icon:this.getCurrentStyle().getIcon(!1),tooltipContent:null,areResultsTrimmed:!1};if(this.getSource().getType()===r.Cb.ES_GEO_GRID){const{docCount:t}=Object(dt.e)(this._getTileMetaFeatures());return 0===t?k:{icon:this.getCurrentStyle().getIcon(!1),tooltipContent:null,areResultsTrimmed:!1}}const e=this._getMaxResultWindow();if(void 0===e)return{icon:this.getCurrentStyle().getIcon(!1),tooltipContent:null,areResultsTrimmed:!1};const{totalFeaturesCount:i,tilesWithFeatures:n,tilesWithTrimmedResults:a}=Object(dt.f)(this._getTileMetaFeatures(),e);if(0===i)return k;const o=a>0,l=!this.getStyle().getIsPointsOnly()&&i>1&&n>1,c=l?"~":"",u=o?m.i18n.translate("xpack.maps.tiles.resultsTrimmedMsg",{defaultMessage:"Results limited to {countPrefix}{count} documents.",values:{count:i.toLocaleString(),countPrefix:c}}):m.i18n.translate("xpack.maps.tiles.resultsCompleteMsg",{defaultMessage:"Found {countPrefix}{count} documents.",values:{count:i.toLocaleString(),countPrefix:c}}),h=l?u+m.i18n.translate("xpack.maps.tiles.shapeCountMsg",{defaultMessage:" This count is approximate."}):u;return{icon:this.getCurrentStyle().getIcon(t&&o),tooltipContent:h,areResultsTrimmed:o}}_getMaxResultWindow(){const t=this.getDataRequest(ft);if(!t)return;const e=t.getData();return e?e.maxResultWindow:void 0}async _syncMaxResultWindow({startLoading:t,stopLoading:e}){if(this.getDataRequest(ft))return;const i=Symbol(`${this.getId()}-${ft}`);t(ft,i);const r=await this.getSource().getMaxResultWindow();e(ft,i,{maxResultWindow:r})}async syncData(t){try{this.getSource().getType()===r.Cb.ES_SEARCH&&await this._syncMaxResultWindow(t),await this._syncSourceStyleMeta(t,this.getSource(),this.getCurrentStyle()),await this._syncSourceFormatters(t,this.getSource(),this.getCurrentStyle()),await this._syncSupportsFeatureEditing({syncContext:t,source:this.getSource()});let e=0;const i=this.getCurrentStyle().getAllStyleProperties().find((t=>t.getStyleName()===r.Ib.LINE_WIDTH));i&&(!i.isDynamic()&&i.isComplete()?e=i.getOptions().size:i.isDynamic()&&i.isComplete()&&(e=i.getOptions().maxSize));const n=Math.ceil(3.5*e);await pt({buffer:n,hasLabels:this.getCurrentStyle().hasLabels(),layerId:this.getId(),layerName:await this.getDisplayName(),prevDataRequest:this.getSourceDataRequest(),requestMeta:await this._getVectorSourceRequestMeta(t.isForceRefresh,t.dataFilters,this.getSource(),this.getCurrentStyle(),t.isFeatureEditorOpenForLayer),source:this.getSource(),syncContext:t}),this.hasJoins()&&await this._syncJoins(t,this.getCurrentStyle())}catch(t){}}_syncSourceBindingWithMb(t){if(t.getSource(this.getMbSourceId()))return;const e=this.getSourceDataRequest();if(!e)return;const i=e.getData();if(!i)return;const r=this.getMbSourceId();t.addSource(r,{type:"vector",tiles:[i.tileUrl],minzoom:i.tileMinZoom,maxzoom:i.tileMaxZoom,promoteId:this._getSourcePromoteId()})}getMbLayerIds(){return[...super.getMbLayerIds(),this._getMbTooManyFeaturesLayerId()]}ownsMbSourceId(t){return this.getMbSourceId()===t}_getJoinResults(){const t=this.getValidJoins();if(!t||!t.length)return{};const e=t[0],i=this.getDataRequest(e.getSourceDataRequestId());return{join:e,joinPropertiesMap:null==i?void 0:i.getData(),joinRequestMeta:null==i?void 0:i.getMeta()}}_getMbTooManyFeaturesLayerId(){return this.makeMbLayerId("toomanyfeatures")}_getJoinFilterExpression(){const{join:t,joinPropertiesMap:e}=this._getJoinResults();if(!t)return;const i=["has","__kbn_never_prop__"];if(!e)return i;const r=Array.from(e.keys());return r.length?["match",["get",t.getLeftField().getName()],r,!0,!1]:i}_syncFeatureState(t){const{joinPropertiesMap:e,joinRequestMeta:i}=this._getJoinResults();if(!e)return;const[r]=e.keys(),n=t.getFeatureState({source:this.getMbSourceId(),sourceLayer:this._source.getTileSourceLayer(),id:r}),a=null==i?void 0:i.requestStopTime;if((null==n?void 0:n.requestStopTime)===a)return;t.removeFeatureState({source:this.getMbSourceId(),sourceLayer:this._source.getTileSourceLayer()});const o={source:this.getMbSourceId(),sourceLayer:this._source.getTileSourceLayer(),id:void 0};e.forEach(((e,i)=>{o.id=i,t.setFeatureState(o,{...e,requestStopTime:a})}))}_syncStylePropertiesWithMb(t){if(!t.getSource(this.getMbSourceId()))return;const e=this.getSourceDataRequest();if(!e)return;const i=e.getData();i&&""!==i.tileSourceLayer&&(this._setMbLabelProperties(t,i.tileSourceLayer),this._setMbPointsProperties(t,i.tileSourceLayer),this._setMbLinePolygonProperties(t,i.tileSourceLayer),this._syncTooManyFeaturesProperties(t))}_syncTooManyFeaturesProperties(t){if(this.getSource().getType()!==r.Cb.ES_SEARCH)return;const e=this._getMaxResultWindow();if(void 0===e)return;const i=this._getMbTooManyFeaturesLayerId();if(!t.getLayer(i)){const r={id:i,type:"line",source:this.getId(),paint:{}};r["source-layer"]=dt.c,t.addLayer(r),t.setFilter(i,["all",["==",["get",dt.a],"gte"],[">=",["get",dt.b],e+1]]),t.setPaintProperty(i,"line-color",this.getCurrentStyle().getPrimaryColor()),t.setPaintProperty(i,"line-width",3),t.setPaintProperty(i,"line-dasharray",[2,1]),t.setPaintProperty(i,"line-opacity",this.getAlpha())}this.syncVisibilityWithMb(t,i),t.setLayerZoomRange(i,this.getMinZoom(),this.getMaxZoom())}_getSourcePromoteId(){const{join:t}=this._getJoinResults();return t?{[this._source.getTileSourceLayer()]:t.getLeftField().getName()}:void 0}_requiresPrevSourceCleanup(t){var e;const i=t.getSource(this.getMbSourceId());if(!i)return!1;if(!("tiles"in i))return!0;const r=i,n=this.getSourceDataRequest();if(!n)return!1;const a=n.getData();if(!a)return!1;if((null===(e=r.tiles)||void 0===e?void 0:e[0])!==a.tileUrl||r.minzoom!==a.tileMinZoom||r.maxzoom!==a.tileMaxZoom||!d.a.isEqual(r.promoteId,this._getSourcePromoteId()))return!0;const o=this.getMbLayerIds();for(let e=0;e<o.length;e++){const i=t.getLayer(o[e]);if(i&&i.sourceLayer!==a.tileSourceLayer&&i.sourceLayer!==dt.c)return!0}return!1}syncLayerWithMB(t){this._removeStaleMbSourcesAndLayers(t),this._syncSourceBindingWithMb(t),this._syncFeatureState(t),this._syncStylePropertiesWithMb(t)}getMinZoom(){return Math.max(this._source.getMinZoom(),super.getMinZoom())}getFeatureById(t){return null}async getStyleMetaDescriptorFromLocalFeatures(){const{joinPropertiesMap:t}=this._getJoinResults();return await async function(t,e,i,n){const a={geometryTypes:{isPointsOnly:1===i.length&&i.includes(r.Hb.POINT),isLinesOnly:1===i.length&&i.includes(r.Hb.LINE),isPolygonsOnly:1===i.length&&i.includes(r.Hb.POLYGON)},fieldMeta:{}};return 0!==n.length&&t?(n.forEach((i=>{const n=i.getFieldName();a.fieldMeta[n]||(a.fieldMeta[n]={categories:[]});const o=[];o.length&&(a.fieldMeta[n].categories=o);const l=function(t,e,i){const n=t.getField();if(!n||!t.isOrdinal())return null;const a=n.isCount();let o=a?1:1/0,l=-1/0;if(t.getFieldOrigin()===r.D.SOURCE)for(let t=0;t<e.length;t++){const i=n.pluckRangeFromTileMetaFeature(e[t]);i&&(a||(o=Math.min(i.min,o)),l=Math.max(i.max,l))}else t.getFieldOrigin()===r.D.JOIN&&i&&i.forEach((t=>{const e=t[n.getName()];"number"==typeof e&&(a||(o=Math.min(e,o)),l=Math.max(e,l))}));return o===1/0||l===-1/0?null:{min:o,max:l,delta:l-o}}(i,t,e);l&&(a.fieldMeta[n].range=l)})),a):a}(this._getTileMetaFeatures(),t,await this.getSource().getSupportedShapeTypes(),this.getCurrentStyle().getDynamicPropertiesArray())}}},,,,,function(t,e){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},function(t,e,i){"use strict";i.d(e,"f",(function(){return u})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return p})),i.d(e,"i",(function(){return d})),i.d(e,"g",(function(){return f})),i.d(e,"b",(function(){return m})),i.d(e,"c",(function(){return g})),i.d(e,"a",(function(){return y})),i.d(e,"j",(function(){return _})),i.d(e,"h",(function(){return v}));var r=i(3),n=i(62),a=i(28),o=i(5),l=i(0),c=i(24);function u(t){return t.fields.some((t=>t.timeSeriesDimension||t.timeSeriesMetric))}function h(t){return t.aggregatable?t.type!==l.A.GEO_SHAPE||Object(c.b)()?null:r.i18n.translate("xpack.maps.geoTileAgg.disabled.license",{defaultMessage:"Geo_shape clustering requires a Gold license."}):r.i18n.translate("xpack.maps.geoTileAgg.disabled.docValues",{defaultMessage:"Clustering requires aggregations. Enable aggregations by setting doc_values to true."})}async function p(t=[]){return(await Object(n.asyncMap)(t,(async t=>{try{return await Object(o.w)().get(t)}catch(t){return null}}))).filter((t=>null!==t))}function d(t){return t.filter((t=>t.aggregatable&&!a.indexPatterns.isNestedField(t)&&["number","boolean","date","ip","string"].includes(t.type)))}function f(t){return t.filter((t=>t.sortable&&!a.indexPatterns.isNestedField(t)))}function m(t){return t.filter((t=>!a.indexPatterns.isNestedField(t)&&l.B.includes(t.type)))}function g(t){return t.filter((t=>!a.indexPatterns.isNestedField(t)&&l.A.GEO_POINT===t.type))}function y(t){return t.filter(_)}function _(t){return!!t&&!!t.aggregatable&&!a.indexPatterns.isNestedField(t)&&function(){const t=[l.A.GEO_POINT];return Object(c.b)()&&t.push(l.A.GEO_SHAPE),t}().includes(t.type)}function v(t){return t.filter((t=>!t.isSubtypeMulti()&&!t.isSubtypeNested()))}},function(t,e,i){"use strict";i.d(e,"g",(function(){return o})),i.d(e,"f",(function(){return l})),i.d(e,"c",(function(){return h})),i.d(e,"b",(function(){return p})),i.d(e,"a",(function(){return d})),i.d(e,"d",(function(){return g})),i.d(e,"e",(function(){return y})),i.d(e,"h",(function(){return _})),i.d(e,"j",(function(){return v})),i.d(e,"i",(function(){return x}));var r=i(0),n=i(99),a=i(5);const o=1,l=64,c=7,u=32,h=3,p=14,d=6,f=n.e[0].value,m=n.a[0].value,g=[r.Ib.LABEL_SIZE,r.Ib.LABEL_COLOR,r.Ib.LABEL_BORDER_COLOR,r.Ib.LABEL_BORDER_SIZE],y=[r.Ib.LINE_COLOR,r.Ib.LINE_WIDTH,...g],_=[r.Ib.FILL_COLOR,r.Ib.LINE_COLOR,r.Ib.LINE_WIDTH,...g];function v(t=[]){let e=0;if(t.length){const i=t[t.length-1];n.b.includes(i)&&(e=(n.b.indexOf(i)+1)%n.b.length)}const i=n.b[e],o=n.d[e],l=Object(a.z)();return{[r.Ib.ICON]:{type:r.Eb.STATIC,options:{value:r.r}},[r.Ib.FILL_COLOR]:{type:r.Eb.STATIC,options:{color:i}},[r.Ib.LINE_COLOR]:{type:r.Eb.STATIC,options:{color:o}},[r.Ib.LINE_WIDTH]:{type:r.Eb.STATIC,options:{size:1}},[r.Ib.ICON_SIZE]:{type:r.Eb.STATIC,options:{size:d}},[r.Ib.ICON_ORIENTATION]:{type:r.Eb.STATIC,options:{orientation:0}},[r.Ib.LABEL_TEXT]:{type:r.Eb.STATIC,options:{value:""}},[r.Ib.LABEL_COLOR]:{type:r.Eb.STATIC,options:{color:l?"#FFFFFF":"#000000"}},[r.Ib.LABEL_SIZE]:{type:r.Eb.STATIC,options:{size:p}},[r.Ib.LABEL_ZOOM_RANGE]:{options:{useLayerZoomRange:!0,minZoom:r.mb,maxZoom:r.hb}},[r.Ib.LABEL_BORDER_COLOR]:{type:r.Eb.STATIC,options:{color:l?"#000000":"#FFFFFF"}},[r.Ib.SYMBOLIZE_AS]:{options:{value:r.Fb.CIRCLE}},[r.Ib.LABEL_BORDER_SIZE]:{options:{size:r.V.SMALL}},[r.Ib.LABEL_POSITION]:{options:{position:r.W.CENTER}}}}function x(){return{[r.Ib.ICON]:{type:r.Eb.DYNAMIC,options:{iconPaletteId:"filledShapes",field:void 0,fieldMetaOptions:{isEnabled:!0}}},[r.Ib.FILL_COLOR]:{type:r.Eb.DYNAMIC,options:{color:f,colorCategory:m,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.LINE_COLOR]:{type:r.Eb.DYNAMIC,options:{color:f,colorCategory:m,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.LINE_WIDTH]:{type:r.Eb.DYNAMIC,options:{minSize:1,maxSize:10,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.ICON_SIZE]:{type:r.Eb.DYNAMIC,options:{minSize:c,maxSize:u,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.ICON_ORIENTATION]:{type:r.Eb.DYNAMIC,options:{field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.LABEL_TEXT]:{type:r.Eb.DYNAMIC,options:{field:void 0}},[r.Ib.LABEL_ZOOM_RANGE]:{options:{useLayerZoomRange:!0,minZoom:r.mb,maxZoom:r.hb}},[r.Ib.LABEL_COLOR]:{type:r.Eb.DYNAMIC,options:{color:f,colorCategory:m,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.LABEL_SIZE]:{type:r.Eb.DYNAMIC,options:{minSize:c,maxSize:u,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.LABEL_BORDER_COLOR]:{type:r.Eb.DYNAMIC,options:{color:f,colorCategory:m,field:void 0,fieldMetaOptions:{isEnabled:!0,sigma:h}}},[r.Ib.SYMBOLIZE_AS]:{options:{value:r.Fb.CIRCLE}},[r.Ib.LABEL_BORDER_SIZE]:{options:{size:r.V.SMALL}},[r.Ib.LABEL_POSITION]:{options:{position:r.W.CENTER}}}}},function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return l})),i.d(e,"d",(function(){return c})),i.d(e,"e",(function(){return d})),i.d(e,"a",(function(){return f})),i.d(e,"f",(function(){return m})),i.d(e,"g",(function(){return g})),i.d(e,"i",(function(){return y})),i.d(e,"j",(function(){return _})),i.d(e,"h",(function(){return v}));var r=i(502),n=i.n(r),a=i(14);const o="theclassic",l=Object(a.euiPaletteColorBlind)(),c=[...l.map((t=>n()(t).darken().toHexString())),"#000","#FFF"],u=["rgb(65, 105, 225)","rgb(0, 256, 256)","rgb(0, 256, 0)","rgb(256, 256, 0)","rgb(256, 0, 0)"];function h(t){const e=Math.ceil(t/10);return Object(a.euiPaletteColorBlind)({rotations:e}).slice(0,t-1)}const p=[{value:"Blues",getPalette:t=>Object(a.euiPaletteCool)(t),palette:Object(a.euiPaletteCool)(8),type:"gradient"},{value:"Greens",getPalette:t=>Object(a.euiPaletteGreen)(t),palette:Object(a.euiPaletteGreen)(8),type:"gradient"},{value:"Greys",getPalette:t=>Object(a.euiPaletteGray)(t),palette:Object(a.euiPaletteGray)(8),type:"gradient"},{value:"Reds",getPalette:t=>Object(a.euiPaletteRed)(t),palette:Object(a.euiPaletteRed)(8),type:"gradient"},{value:"Yellow to Red",getPalette:t=>Object(a.euiPaletteWarm)(t),palette:Object(a.euiPaletteWarm)(8),type:"gradient"},{value:"Green to Red",getPalette:t=>Object(a.euiPaletteForStatus)(t),palette:Object(a.euiPaletteForStatus)(8),type:"gradient"},{value:"Blue to Red",getPalette:t=>Object(a.euiPaletteForTemperature)(t),palette:Object(a.euiPaletteForTemperature)(8),type:"gradient"},{value:o,getPalette:t=>Object(a.colorPalette)(u,t,!0,!0),palette:u,type:"gradient"},{value:"palette_0",getPalette:h,palette:Object(a.euiPaletteColorBlind)(),type:"fixed"},{value:"palette_20",getPalette:h,palette:Object(a.euiPaletteColorBlind)({rotations:2}),type:"fixed"},{value:"palette_30",getPalette:h,palette:Object(a.euiPaletteColorBlind)({rotations:3}),type:"fixed"}],d=p.filter((t=>"gradient"===t.type)),f=p.filter((t=>"fixed"===t.type));function m(t){const e=p.find((({value:e})=>e===t));return e?[...e.palette]:[]}function g(t){if(!t)return null;const e=m(t);return 0===e.length?null:e[Math.floor(e.length/2)]}function y(t,e,i,r){if(!t)return null;if(e>i)return null;const n=m(t);if(r&&n.reverse(),0===n.length)return null;if(i===e)return[i,n[n.length-1]];const a=i-e;return n.reduce(((t,i,r,n)=>{const o=e+a*r/n.length;return t.push(o,i),t}),[])}function _(t,e,i){if(!t)return null;const r=d.find((({value:e})=>e===t));if(!r)return null;const n=r.getPalette(e.length);return i&&n.reverse(),n.reduce(((t,i,r)=>(t.push(e[r].value,i),t)),[])}function v(t){const e=t.length;let i=`linear-gradient(to right, ${t[0]} 0%,`;for(let r=1;r<e-1;r++)i=`${i} ${t[r]}       ${Math.floor(100*r/(e-1))}%,`;return`${i} ${t[t.length-1]} 100%)`}},function(t,e,i){"use strict";i.d(e,"a",(function(){return vector_style_VectorStyle}));var r=i(6),n=i.n(r),a=i(2),o=i.n(a),l=i(53),c=i.n(l),u=i(3),h=i(14),p=i(18),d=i.n(p),f=i(128),m=i(0),g=i(4);const y=u.i18n.translate("xpack.maps.styles.staticDynamicSelect.staticLabel",{defaultMessage:"Fixed"}),_=u.i18n.translate("xpack.maps.styles.staticDynamicSelect.dynamicLabel",{defaultMessage:"By value"});class style_prop_editor_StylePropEditor extends a.Component{constructor(...t){super(...t),n()(this,"_prevStaticStyleOptions",this.props.defaultStaticStyleOptions),n()(this,"_prevDynamicStyleOptions",this.props.defaultDynamicStyleOptions),n()(this,"_onTypeToggle",(()=>{this.props.styleProperty.isDynamic()?(this._prevDynamicStyleOptions=this.props.styleProperty.getOptions(),this.props.onStaticStyleChange(this.props.styleProperty.getStyleName(),this._prevStaticStyleOptions)):(this._prevStaticStyleOptions=this.props.styleProperty.getOptions(),this.props.onDynamicStyleChange(this.props.styleProperty.getStyleName(),this._prevDynamicStyleOptions))})),n()(this,"_onDataMappingChange",(t=>{const e={...this.props.styleProperty.getOptions(),...t};this.props.onDynamicStyleChange(this.props.styleProperty.getStyleName(),e)}))}renderStaticDynamicSelect(){const t=[{value:m.Eb.STATIC,text:this.props.customStaticOptionLabel?this.props.customStaticOptionLabel:y},{value:m.Eb.DYNAMIC,text:_}];return Object(g.jsx)(h.EuiSelect,{options:t,value:this.props.styleProperty.isDynamic()?m.Eb.DYNAMIC:m.Eb.STATIC,onChange:this._onTypeToggle,disabled:this.props.disabled||0===this.props.fields.length,"aria-label":u.i18n.translate("xpack.maps.styles.staticDynamicSelect.ariaLabel",{defaultMessage:"Select to style by fixed value or by data value"}),compressed:!0,"data-test-subj":`staticDynamicSelect_${this.props.styleProperty.getStyleName()}`})}render(){const t=this.renderStaticDynamicSelect(),e=this.props.disabled&&this.props.disabledBy?Object(g.jsx)(h.EuiToolTip,{anchorClassName:"mapStyleFormDisabledTooltip",content:Object(f.a)(this.props.disabledBy)},Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},t),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(h.EuiFieldText,{compressed:!0,disabled:!0})))):Object(g.jsx)(a.Fragment,null,o.a.cloneElement(this.props.children,{staticDynamicSelect:t}),this.props.styleProperty.renderDataMappingPopover(this._onDataMappingChange));return Object(g.jsx)(h.EuiFormRow,{label:Object(f.b)(this.props.styleProperty.getStyleName()),display:"rowCompressed"},e)}}var v=i(652),x=i(633),b=i(634);function w({fields:t,selectedFieldName:e,onChange:i,styleName:r,...n}){let a;if(e){const i=t.find((t=>t.name===e));i&&(a={value:i,label:i.label})}const o=function(t){const e=new Map;function i(t){return t.map((t=>({value:t,name:t.name,label:t.label,disabled:t.isUnsupported,title:t.unsupportedMsg,prepend:t.type?Object(g.jsx)(x.a,{type:t.type,fill:"none",className:"eui-alignMiddle"}):null}))).sort(((t,e)=>t.label.toLowerCase().localeCompare(e.label.toLowerCase())))}if(t.forEach((t=>{if(e.has(t.origin)){const i=e.get(t.origin);i.push(t),e.set(t.origin,i)}else e.set(t.origin,[t])})),1===e.size){const t=e.keys().next().value;return i(e.get(t))}const r=[];return e.forEach(((t,e)=>{r.push({label:u.i18n.translate("xpack.maps.style.fieldSelect.OriginLabel",{defaultMessage:"Fields from {fieldOrigin}",values:{fieldOrigin:e}}),options:i(t)})})),r.sort(((t,e)=>t.label.toLowerCase().localeCompare(e.label.toLowerCase()))),r}(t),l=Object(v.a)(t,["label"]);return Object(g.jsx)(h.EuiComboBox,d()({selectedOptions:a?[a]:[],options:o,onChange:t=>{i({field:t.length>0&&t[0].value?t[0].value:null})},isClearable:!1,fullWidth:!0,placeholder:u.i18n.translate("xpack.maps.styles.vector.selectFieldPlaceholder",{defaultMessage:"Select a field"}),"data-test-subj":`styleFieldSelect_${r}`,singleSelection:m.xb,truncationProps:m.lb,inputPopoverProps:{panelMinWidth:l},optionMatcher:b.a},n))}const C=Object(h.euiPaletteColorBlind)({rotations:3}),S=C[0];function M(t,e){const i=t[e].stop;let r=1;return e===t.length-1?0!==e&&(r=i-t[e-1].stop):r=(t[e+1].stop-i)/2,E(t,e,i+r)}function T(t,e){return E(t,e,"")}function E(t,e,i){const r=t.length<C.length?t.length:t.length%C.length,n={stop:i,color:C[r]};return[...t.slice(0,e+1),n,...t.slice(e+1)]}function A(t){return!Object(h.isValidHex)(t)||""===t}function I(t){return""===t||isNaN(t)}function P(t){const e=t.slice(1).map((t=>t.stop)),i=c.a.uniq(e);return e.length!==i.length}function O(t){return t.some(((e,i)=>{let r=!1;return 0!==i&&(r=t[i-1].stop>=e.stop),A(e.color)||I(e.stop)||r}))}var k=i(167);const D=({onChange:t,colorStops:e,isStopsInvalid:i,getStopError:r,renderStopInput:n,addNewRow:a,swatches:o})=>{const l=e.map(((l,p)=>{const{stopError:d,stopInput:f}=function(a,o){return{stopError:r(a,o),stopInput:n(a,(r=>{const n=c.a.cloneDeep(e);n[o].stop=r,t({colorStops:n,isInvalid:i(n)})}),o)}}(l.stop,p),m=l.color,y=A(m)?u.i18n.translate("xpack.maps.styles.colorStops.hexWarningLabel",{defaultMessage:"Color must provide a valid hex value"}):void 0,_=[];let v;if(d&&_.push(d),y&&_.push(y),e.length>1){const r=()=>{const r=function(t,e){return 1===t.length?t:[...t.slice(0,e),...t.slice(e+1)]}(e,p);t({colorStops:r,isInvalid:i(r)})};v=Object(g.jsx)(h.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":u.i18n.translate("xpack.maps.styles.colorStops.deleteButtonAriaLabel",{defaultMessage:"Delete"}),title:u.i18n.translate("xpack.maps.styles.colorStops.deleteButtonLabel",{defaultMessage:"Delete"}),onClick:r})}const x=Object(g.jsx)("div",null,v,Object(g.jsx)(h.EuiButtonIcon,{iconType:"plusInCircle",color:"primary","aria-label":"Add",title:"Add",onClick:()=>{const r=a(e,p);t({colorStops:r,isInvalid:i(r)})}}));return Object(g.jsx)(h.EuiFormRow,{key:p,className:"mapColorStop",isInvalid:0!==_.length,error:_,display:"rowCompressed"},Object(g.jsx)(h.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(g.jsx)(h.EuiFlexItem,{grow:!0,className:"mapStyleSettings__fixedBox"},f),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(k.a,{key:m,onChange:r=>{const n=c.a.cloneDeep(e);n[p].color=r,t({colorStops:n,isInvalid:i(n)})},color:m,swatches:o,append:x}))))}));return Object(g.jsx)("div",null,l,Object(g.jsx)(h.EuiSpacer,{size:"s"}))},F=({colorStops:t=[{stop:0,color:S}],onChange:e,swatches:i})=>Object(g.jsx)(D,{onChange:e,colorStops:t,isStopsInvalid:O,getStopError:(e,i)=>{let r;return I(e)?r=u.i18n.translate("xpack.maps.styles.colorStops.ordinalStop.numberWarningLabel",{defaultMessage:"Stop must be a number"}):0!==i&&t[i-1].stop>=e&&(r=u.i18n.translate("xpack.maps.styles.colorStops.ordinalStop.numberOrderingWarningLabel",{defaultMessage:"Stop must be greater than previous stop value"})),r},renderStopInput:(t,e,i)=>Object(g.jsx)(h.EuiFieldNumber,{"aria-label":u.i18n.translate("xpack.maps.styles.colorStops.ordinalStop.stopLabel",{defaultMessage:"Stop"}),value:0===i?"":t,onChange:function(t){const i=parseFloat(t.target.value),r=isNaN(i)?"":i;e(r)},compressed:!0,disabled:0===i}),addNewRow:M,swatches:i});class stop_input_StopInput extends a.Component{constructor(t){super(t),n()(this,"_isMounted",!1),n()(this,"_onFocus",(()=>{this.state.hasPrevFocus||(this.setState({hasPrevFocus:!0}),this._onSearchChange(""))})),n()(this,"_onChange",(t=>{this.props.onChange(c.a.get(t,"[0].label",""))})),n()(this,"_onCreateOption",(t=>{this.props.onChange(t)})),n()(this,"_onSearchChange",(async t=>{this.setState({isLoadingSuggestions:!0,searchValue:t},(()=>{this._loadSuggestions(t)}))})),n()(this,"_loadSuggestions",c.a.debounce((async t=>{let e=[];try{e=await this.props.getValueSuggestions(t)}catch(t){}this._isMounted&&t===this.state.searchValue&&this.setState({isLoadingSuggestions:!1,suggestions:e})}),300)),n()(this,"_onFieldTextChange",(t=>{this.setState({localFieldTextValue:t.target.value}),this._debouncedOnFieldTextChange()})),n()(this,"_debouncedOnFieldTextChange",c.a.debounce((()=>{this.props.onChange(this.state.localFieldTextValue)}),500)),this.state={suggestions:[],isLoadingSuggestions:!1,hasPrevFocus:!1,fieldDataType:null,localFieldTextValue:t.value}}componentDidMount(){this._isMounted=!0,this._loadFieldDataType()}componentWillUnmount(){this._isMounted=!1,this._loadSuggestions.cancel()}async _loadFieldDataType(){const t=await this.props.field.getDataType();this._isMounted&&this.setState({fieldDataType:t})}_renderSuggestionInput(){const t=this.state.suggestions.map((t=>({label:`${t}`}))),e=[];if(this.props.value){let i=t.find((({label:t})=>t===this.props.value));i||(i={label:this.props.value},t.unshift(i)),e.push(i)}return Object(g.jsx)(h.EuiComboBox,{options:t,selectedOptions:e,singleSelection:m.xb,onChange:this._onChange,onSearchChange:this._onSearchChange,onCreateOption:this._onCreateOption,isClearable:!1,isLoading:this.state.isLoadingSuggestions,onFocus:this._onFocus,"data-test-subj":this.props.dataTestSubj,compressed:!0})}_renderTextInput(){return Object(g.jsx)(h.EuiFieldText,{value:this.state.localFieldTextValue,onChange:this._onFieldTextChange,compressed:!0})}render(){return this.state.fieldDataType?"string"===this.state.fieldDataType||"boolean"===this.state.fieldDataType?this._renderSuggestionInput():this._renderTextInput():null}}const z=({colorStops:t=[{stop:"",color:S}],field:e,onChange:i,getValueSuggestions:r,swatches:n})=>Object(g.jsx)(D,{onChange:i,colorStops:t,isStopsInvalid:P,getStopError:(e,i)=>{let r=0;for(let n=1;n<t.length;n++)t[n].stop===e&&n!==i&&r++;return r?u.i18n.translate("xpack.maps.styles.colorStops.categoricalStop.noDupesWarningLabel",{defaultMessage:"Stop values must be unique"}):null},renderStopInput:(t,i,n)=>{const a="string"==typeof t?t:"";return Object(g.jsx)(stop_input_StopInput,{key:e.getName(),field:e,getValueSuggestions:r,value:a,onChange:i,dataTestSubj:`colorStopInput${n}`})},addNewRow:T,swatches:n});var j=i(99);const N="CUSTOM_COLOR_MAP";class color_map_select_ColorMapSelect extends a.Component{constructor(...t){super(...t),n()(this,"state",{}),n()(this,"_onColorPaletteSelect",(t=>{const e=t===N;this.props.onChange({color:e?null:t,useCustomColorMap:e,type:this.props.colorMapType})})),n()(this,"_onCustomColorMapChange",(({colorStops:t,isInvalid:e})=>{e?this.setState({customColorMap:t}):this.props.onChange({useCustomColorMap:!0,customColorMap:t,type:this.props.colorMapType})}))}static getDerivedStateFromProps(t,e){return t.customColorMap===e.prevPropsCustomColorMap?null:{prevPropsCustomColorMap:t.customColorMap,customColorMap:t.customColorMap}}_renderColorMapToggle(){const t=[{value:m.j.ORDINAL,text:u.i18n.translate("xpack.maps.styles.dynamicColorSelect.quantitativeLabel",{defaultMessage:"As number"})},{value:m.j.CATEGORICAL,text:u.i18n.translate("xpack.maps.styles.dynamicColorSelect.qualitativeLabel",{defaultMessage:"As category"})}],e=this.props.styleProperty.isOrdinal()?m.j.ORDINAL:m.j.CATEGORICAL;return Object(g.jsx)(h.EuiSelect,{options:t,value:e,onChange:this.props.onColorMapTypeChange,"aria-label":u.i18n.translate("xpack.maps.styles.dynamicColorSelect.qualitativeOrQuantitativeAriaLabel",{defaultMessage:"Choose `As number` to map by number in a color range, or `As category`to categorize by color palette."}),compressed:!0})}_renderColorStopsInput(){if(!this.props.isCustomOnly&&!this.props.useCustomColorMap)return null;let t;return t=this.props.colorMapType===m.j.ORDINAL?Object(g.jsx)(F,{colorStops:this.state.customColorMap,onChange:this._onCustomColorMapChange,swatches:this.props.swatches}):Object(g.jsx)(z,{colorStops:this.state.customColorMap,field:this.props.styleProperty.getField(),getValueSuggestions:this.props.styleProperty.getValueSuggestions,onChange:this._onCustomColorMapChange,swatches:this.props.swatches}),Object(g.jsx)(h.EuiFlexGroup,null,Object(g.jsx)(h.EuiFlexItem,null,t))}_getColorPalettes(){return this.props.colorMapType===m.j.CATEGORICAL?j.a:this.props.invert?j.e.map((t=>({...t,palette:[...t.palette].reverse()}))):j.e}_renderColorMapSelections(){if(this.props.isCustomOnly)return null;const t=[{value:N,title:this.props.colorMapType===m.j.ORDINAL?u.i18n.translate("xpack.maps.style.customColorRampLabel",{defaultMessage:"Custom color ramp"}):u.i18n.translate("xpack.maps.style.customColorPaletteLabel",{defaultMessage:"Custom color palette"}),type:"text","data-test-subj":`colorMapSelectOption_${N}`},...this._getColorPalettes()],e=this.props.showColorMapTypeToggle?Object(g.jsx)(h.EuiFlexItem,{grow:!1},this._renderColorMapToggle()):null;return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs"},e,Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(h.EuiColorPalettePicker,{palettes:t,onChange:this._onColorPaletteSelect,valueOfSelected:this.props.useCustomColorMap?N:this.props.colorPaletteId,compressed:!0,"data-test-subj":`colorMapSelect_${this.props.styleProperty.getStyleName()}`}))),Object(g.jsx)(h.EuiSpacer,{size:"s"}))}render(){return Object(g.jsx)(a.Fragment,null,this._renderColorMapSelections(),this._renderColorStopsInput())}}var B=i(63),V=i(114);const U=[B.euiThemeVars.euiColorLightestShade,B.euiThemeVars.euiColorLightShade,B.euiThemeVars.euiColorMediumShade,B.euiThemeVars.euiColorDarkShade,B.euiThemeVars.euiColorDarkestShade];function H(t){return Object(g.jsx)(h.EuiFormRow,null,Object(g.jsx)(h.EuiToolTip,{position:"top",content:u.i18n.translate("xpack.maps.colorStops.otherCategoryColorPickerTooltip",{defaultMessage:'When the selected field has more terms than colors in the palette, the rest of the terms are grouped under "Other" category. Select a palette with more colors to increase the number of terms colored in your map'})},Object(g.jsx)(k.a,{swatches:U,prepend:V.b,onChange:t.onChange,color:t.color?t.color:V.a})))}function q({fields:t,onDynamicStyleChange:e,staticDynamicSelect:i,styleProperty:r,swatches:n}){const a=r.getOptions(),l=({color:t,customColorMap:i,type:n,useCustomColorMap:o})=>{const l={...a,type:n};n===m.j.ORDINAL?(l.useCustomColorRamp=o,i&&(l.customColorRamp=i),t&&(l.color=t)):(l.useCustomColorPalette=o,i&&(l.customColorPalette=i),t&&(l.colorCategory=t)),e(r.getStyleName(),l)},p=t=>{const i=t.target.value;e(r.getStyleName(),{...a,type:i})},d=t=>{e(r.getStyleName(),{...a,otherCategoryColor:t})},f=t=>{e(r.getStyleName(),{...a,invert:t.target.checked})};return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},i||null),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(w,{styleName:r.getStyleName(),fields:t,selectedFieldName:r.getFieldName(),onChange:({field:t})=>{if(!t)return;const{name:i,origin:n,type:o}=t,l=m.h.includes(o)?m.j.CATEGORICAL:m.j.ORDINAL;e(r.getStyleName(),{...a,field:{name:i,origin:n},type:l})},compressed:!0}))),Object(g.jsx)(h.EuiSpacer,{size:"s"}),(()=>{const e=(()=>{const e=r.getFieldName();return e?t.find((t=>t.name===e)):null})();if(!e)return null;const i=void 0!==a.invert&&a.invert,y=!m.h.includes(e.type);return r.isOrdinal()?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(color_map_select_ColorMapSelect,{isCustomOnly:!e.supportsAutoDomain,onChange:l,onColorMapTypeChange:p,colorMapType:m.j.ORDINAL,colorPaletteId:a.color,customColorMap:a.customColorRamp,useCustomColorMap:c.a.get(a,"useCustomColorRamp",!1),styleProperty:r,showColorMapTypeToggle:y,swatches:n,invert:i}),a.useCustomColorRamp?null:Object(g.jsx)(h.EuiFormRow,{display:"columnCompressedSwitch"},Object(g.jsx)(h.EuiSwitch,{label:u.i18n.translate("xpack.maps.style.revereseColorsLabel",{defaultMessage:"Reverse colors"}),checked:i,onChange:f,compressed:!0}))):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(color_map_select_ColorMapSelect,{isCustomOnly:!e.supportsAutoDomain,onColorMapTypeChange:p,onChange:l,colorMapType:m.j.CATEGORICAL,colorPaletteId:a.colorCategory,customColorMap:a.customColorPalette,useCustomColorMap:c.a.get(a,"useCustomColorPalette",!1),styleProperty:r,showColorMapTypeToggle:y,swatches:n,invert:!1}),Object(g.jsx)(H,{onChange:d,color:a.otherCategoryColor}))})())}function Z({onStaticStyleChange:t,staticDynamicSelect:e,styleProperty:i,swatches:r}){return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},e||null),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(k.a,{onChange:e=>{t(i.getStyleName(),{color:e})},color:i.getOptions().color,swatches:r})))}function G(t){const e=t.styleProperty.isDynamic()?Object(g.jsx)(q,d()({},t,{styleProperty:t.styleProperty})):Object(g.jsx)(Z,d()({},t,{styleProperty:t.styleProperty}));return Object(g.jsx)(style_prop_editor_StylePropEditor,d()({},t,{customStaticOptionLabel:u.i18n.translate("xpack.maps.styles.color.staticDynamicSelect.staticLabel",{defaultMessage:"Solid"})}),e)}var $=i(59),W=i(98);function X({minSize:t,maxSize:e,onChange:i,...r}){return Object(g.jsx)($.ValidatedDualRange,d()({min:W.g,max:W.f,step:1,value:[t,e],showInput:"inputWithPopover",showRange:!0,onChange:([t,e])=>{i({minSize:Math.max(W.g,parseInt(t,10)),maxSize:Math.min(W.f,parseInt(e,10))})},allowEmptyRange:!1,append:u.i18n.translate("xpack.maps.vector.dualSize.unitLabel",{defaultMessage:"px",description:"Shorthand for pixel"})},r))}function Y({fields:t,onDynamicStyleChange:e,staticDynamicSelect:i,styleProperty:r}){const n=r.getOptions();let a;return n.field&&n.field.name&&(a=Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(X,{onChange:({minSize:t,maxSize:i})=>{e(r.getStyleName(),{...n,minSize:t,maxSize:i})},minSize:n.minSize,maxSize:n.maxSize,showLabels:!0,compressed:!0}),Object(g.jsx)(h.EuiFormRow,{display:"columnCompressedSwitch"},Object(g.jsx)(h.EuiSwitch,{label:u.i18n.translate("xpack.maps.style.revereseSizeLabel",{defaultMessage:"Reverse size"}),checked:!!n.invert,onChange:t=>{e(r.getStyleName(),{...n,invert:t.target.checked})},compressed:!0})))),Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},i),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(w,{styleName:r.getStyleName(),fields:t,selectedFieldName:r.getFieldName(),onChange:({field:t})=>{t&&e(r.getStyleName(),{...n,field:{name:t.name,origin:t.origin}})},compressed:!0}))),Object(g.jsx)(h.EuiSpacer,{size:"s"}),a)}var K=i(149);function J({onStaticStyleChange:t,staticDynamicSelect:e,styleProperty:i}){return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},e),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(K.a,{min:0,max:100,value:i.getOptions().size,onChange:e=>{t(i.getStyleName(),{size:e})},showInput:"inputWithPopover",showLabels:!0,compressed:!0,append:u.i18n.translate("xpack.maps.vector.size.unitLabel",{defaultMessage:"px",description:"Shorthand for pixel"})})))}function tt(t){const e=t.styleProperty.isDynamic()?Object(g.jsx)(Y,d()({},t,{styleProperty:t.styleProperty})):Object(g.jsx)(J,d()({},t,{styleProperty:t.styleProperty}));return Object(g.jsx)(style_prop_editor_StylePropEditor,t,e)}const et=[{id:m.Fb.CIRCLE,label:u.i18n.translate("xpack.maps.vector.symbolAs.circleLabel",{defaultMessage:"marker"})},{id:m.Fb.ICON,label:u.i18n.translate("xpack.maps.vector.symbolAs.IconLabel",{defaultMessage:"icon"})}];function it({disabled:t,disabledBy:e,styleProperty:i,handlePropertyChange:r}){const n=i.getOptions(),a=et.find((({id:t})=>t===n.value)),o=u.i18n.translate("xpack.maps.vector.symbolLabel",{defaultMessage:"Symbol type"}),l=Object(g.jsx)(h.EuiFormRow,{label:o,display:"columnCompressed"},Object(g.jsx)(h.EuiButtonGroup,{isDisabled:t,buttonSize:"compressed",options:et,idSelected:a?a.id:void 0,onChange:t=>{const e={options:{value:t}};r(m.Ib.SYMBOLIZE_AS,e)},isFullWidth:!0,legend:o}));return t?Object(g.jsx)(h.EuiToolTip,{anchorClassName:"mapStyleFormDisabledTooltip",content:Object(f.a)(e)},l):l}var at=i(54),ot=i(184),lt=i(115),ct=i(5),ut=i(347);class icon_select_IconSelect extends a.Component{constructor(...t){super(...t),n()(this,"state",{isPopoverOpen:!1,isModalVisible:!1}),n()(this,"_handleSave",(({symbolId:t,svg:e,cutoff:i,radius:r,label:n})=>{const a=[...this.props.customIcons.filter((e=>e.symbolId!==t)),{symbolId:t,svg:e,label:n,cutoff:i,radius:r}];this.props.onCustomIconsChange(a),this._hideModal()})),n()(this,"_closePopover",(()=>{this.setState({isPopoverOpen:!1})})),n()(this,"_hideModal",(()=>{this.setState({isModalVisible:!1})})),n()(this,"_openPopover",(()=>{this.setState({isPopoverOpen:!0})})),n()(this,"_showModal",(()=>{this.setState({isModalVisible:!0})})),n()(this,"_toggleModal",(()=>{this.setState((t=>({isModalVisible:!t.isModalVisible})))})),n()(this,"_togglePopover",(()=>{this.setState((t=>({isPopoverOpen:!t.isPopoverOpen})))})),n()(this,"_handleKeyboardActivity",(t=>{var e;"object"==typeof(e=t)&&"keyCode"in e&&(t.key===h.keys.ENTER?(t.preventDefault(),this._togglePopover()):t.key===h.keys.ARROW_DOWN&&this._openPopover())})),n()(this,"_onIconSelect",(t=>{const e=t.find((t=>"on"===t.checked));if(e){const{key:t}=e;this.props.onChange({selectedIconId:t})}this._closePopover()}))}_renderPopoverButton(){const{value:t,svg:e,label:i}=this.props.icon;return Object(g.jsx)(h.EuiFormControlLayout,{icon:{type:"arrowDown",side:"right"},readOnly:!0,fullWidth:!0,compressed:!0,onKeyDown:this._handleKeyboardActivity,append:this.props.append},Object(g.jsx)(h.EuiFieldText,{onClick:this._togglePopover,onKeyDown:this._handleKeyboardActivity,value:i||t,compressed:!0,readOnly:!0,fullWidth:!0,prepend:Object(g.jsx)(ot.a,{key:t,className:"mapIconSelectSymbol__inputButton",symbolId:t,svg:e,fill:Object(ct.z)()?"rgb(223, 229, 239)":"rgb(52, 55, 65)"})}))}_renderIconSelectable(){const t=[{label:u.i18n.translate("xpack.maps.styles.vector.iconSelect.kibanaIconsGroupLabel",{defaultMessage:"Kibana icons"}),isGroupLabel:!0},...lt.c.map((({value:t,label:e,svg:i})=>({key:t,label:e,prepend:Object(g.jsx)(ot.a,{key:t,symbolId:t,fill:Object(ct.z)()?"rgb(223, 229, 239)":"rgb(52, 55, 65)",svg:i})})))],e=this.props.customIcons.map((({symbolId:t,label:e,svg:i})=>({key:t,label:e,prepend:Object(g.jsx)(ot.a,{key:t,symbolId:t,svg:i,fill:Object(ct.z)()?"rgb(223, 229, 239)":"rgb(52, 55, 65)"})})));e.length&&e.splice(0,0,{label:u.i18n.translate("xpack.maps.styles.vector.iconSelect.customIconsGroupLabel",{defaultMessage:"Custom icons"}),isGroupLabel:!0});const i=[...e,...t];return Object(g.jsx)(h.EuiSelectable,{searchable:!0,options:i,onChange:this._onIconSelect,compressed:!0},((t,e)=>Object(g.jsx)("div",{style:{width:"300px"}},Object(g.jsx)(h.EuiPopoverTitle,null,e),t,Object(g.jsx)(h.EuiPopoverFooter,null," ",Object(g.jsx)(h.EuiButton,{fullWidth:!0,size:"s",onClick:this._toggleModal},Object(g.jsx)(at.FormattedMessage,{id:"xpack.maps.styles.vector.iconSelect.addCustomIconButtonLabel",defaultMessage:"Add custom icon"}))))))}render(){return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(h.EuiPopover,{ownFocus:!0,button:this._renderPopoverButton(),isOpen:this.state.isPopoverOpen,closePopover:this._closePopover,anchorPosition:"downLeft",panelPaddingSize:"s",display:"block"},Object(g.jsx)(h.EuiFocusTrap,{clickOutsideDisables:!0},this._renderIconSelectable())),this.state.isModalVisible?Object(g.jsx)(ut.a,{title:"Add custom Icon",cutoff:m.p,radius:m.q,onSave:this._handleSave,onCancel:this._hideModal}):null)}}function ht(t,e){return e.filter((({stop:e})=>t===e)).length>1}function pt(t){const e=lt.b.find((e=>!t.some((({icon:t})=>t===e))));if(e)return e;const i=lt.c.find((({value:e})=>!t.some((({icon:t})=>t===e))));return i?i.value:m.r}function dt({field:t,getValueSuggestions:e,iconStops:i,onChange:r,onCustomIconsChange:n,customIcons:a}){return i.map((({stop:o,icon:l,iconSource:c},p)=>{const d=c===m.N.CUSTOM?a.find((({symbolId:t})=>t===l)):Object(lt.i)(l);if(void 0===d)return;const{svg:f,label:y}=d;let _;i.length>2&&0!==p&&(_=Object(g.jsx)(h.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":u.i18n.translate("xpack.maps.styles.iconStops.deleteButtonAriaLabel",{defaultMessage:"Delete"}),title:u.i18n.translate("xpack.maps.styles.iconStops.deleteButtonLabel",{defaultMessage:"Delete"}),onClick:()=>{r({customStops:[...i.slice(0,p),...i.slice(p+1)]})}}));const v=Object(g.jsx)("div",null,_,Object(g.jsx)(h.EuiButtonIcon,{iconType:"plusInCircle",color:"primary","aria-label":"Add",title:"Add",onClick:()=>{r({customStops:[...i.slice(0,p+1),{stop:"",icon:pt(i)},...i.slice(p+1)]})}})),x=[],b=0===p?Object(g.jsx)(h.EuiFieldText,{"aria-label":V.b,placeholder:V.b,disabled:!0,compressed:!0}):Object(g.jsx)(stop_input_StopInput,{key:t.getName(),field:t,getValueSuggestions:e,value:o,onChange:t=>{const e=[...i];e[p]={...i[p],stop:t},r({customStops:e,isInvalid:ht(t,i)})}});return Object(g.jsx)(h.EuiFormRow,{key:p,className:"mapColorStop",isInvalid:0!==x.length,error:x,display:"rowCompressed"},Object(g.jsx)(h.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},b),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(icon_select_IconSelect,{onCustomIconsChange:n,customIcons:a,onChange:({selectedIconId:t})=>{const e=[...i];e[p]={...i[p],icon:t},r({customStops:e})},icon:{value:l,svg:f,label:y},append:v}))))})).filter((t=>void 0!==t))}const ft="CUSTOM_MAP_ID",mt=[{stop:null,icon:lt.b[0],iconSource:m.N.MAKI},{stop:"",icon:lt.b[1],iconSource:m.N.MAKI}];class icon_map_select_IconMapSelect extends a.Component{constructor(...t){super(...t),n()(this,"state",{customIconStops:this.props.customIconStops?this.props.customIconStops:mt}),n()(this,"_onMapSelect",(t=>{const e=t===ft,i={iconPaletteId:e?null:t,useCustomIconMap:e};this.props.customIconStops||(i.customIconStops=mt),this.props.onChange(i)})),n()(this,"_onCustomMapChange",(({customStops:t,isInvalid:e})=>{this.setState({customIconStops:t}),e||this.props.onChange({useCustomIconMap:!0,customIconStops:t})}))}_renderCustomStopsInput(){return this.props.isCustomOnly||this.props.useCustomIconMap?Object(g.jsx)(dt,{field:this.props.styleProperty.getField(),getValueSuggestions:this.props.styleProperty.getValueSuggestions,iconStops:this.state.customIconStops,onChange:this._onCustomMapChange,onCustomIconsChange:this.props.onCustomIconsChange,customIcons:this.props.customIcons}):null}_renderMapSelect(){if(this.props.isCustomOnly)return null;const t=[{value:ft,inputDisplay:u.i18n.translate("xpack.maps.styles.icon.customMapLabel",{defaultMessage:"Custom icon palette"})},...Object(lt.h)()];let e="";return this.props.useCustomIconMap?e=ft:this.props.iconPaletteId&&(e=this.props.iconPaletteId),Object(g.jsx)(a.Fragment,null,Object(g.jsx)(h.EuiSuperSelect,{options:t,onChange:this._onMapSelect,valueOfSelected:e,hasDividers:!0,compressed:!0}),Object(g.jsx)(h.EuiSpacer,{size:"s"}))}render(){return Object(g.jsx)(a.Fragment,null,this._renderMapSelect(),this._renderCustomStopsInput())}}function gt({fields:t,onDynamicStyleChange:e,onCustomIconsChange:i,customIcons:r,staticDynamicSelect:n,styleProperty:o}){const l=o.getOptions(),u=t=>{e(o.getStyleName(),{...l,...t})};return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},n),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(w,{styleName:o.getStyleName(),fields:t,selectedFieldName:c.a.get(l,"field.name"),onChange:({field:t})=>{if(!t)return;const{name:i,origin:r}=t;e(o.getStyleName(),{...l,field:{name:i,origin:r}})},compressed:!0}))),Object(g.jsx)(h.EuiSpacer,{size:"s"}),function(){const t=o.getField();return t?Object(g.jsx)(icon_map_select_IconMapSelect,d()({},l,{styleProperty:o,customIcons:r,onChange:u,onCustomIconsChange:i,isCustomOnly:!t.supportsFieldMetaFromLocalData()&&!t.supportsFieldMetaFromEs()})):null}())}function yt({onStaticStyleChange:t,onCustomIconsChange:e,customIcons:i,staticDynamicSelect:r,styleProperty:n}){return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},r),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(icon_select_IconSelect,{customIcons:i,onChange:({selectedIconId:e})=>{t(n.getStyleName(),{value:e})},onCustomIconsChange:e,icon:n.getOptions()})))}function _t(t){const e=t.styleProperty.isDynamic()?Object(g.jsx)(gt,d()({},t,{styleProperty:t.styleProperty})):Object(g.jsx)(yt,d()({},t,{styleProperty:t.styleProperty}));return Object(g.jsx)(style_prop_editor_StylePropEditor,t,e)}function vt({fields:t,onDynamicStyleChange:e,staticDynamicSelect:i,styleProperty:r}){const n=r.getOptions();return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},i),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(w,{styleName:r.getStyleName(),fields:t,selectedFieldName:r.getFieldName(),onChange:({field:t})=>{t&&e(r.getStyleName(),{...n,field:t})},compressed:!0})))}function Ct({onStaticStyleChange:t,staticDynamicSelect:e,styleProperty:i}){return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},e),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(h.EuiFieldText,{placeholder:u.i18n.translate("xpack.maps.styles.staticLabel.valuePlaceholder",{defaultMessage:"symbol label"}),value:i.getOptions().value,onChange:e=>{t(i.getStyleName(),{value:e.target.value})},"aria-label":u.i18n.translate("xpack.maps.styles.staticLabel.valueAriaLabel",{defaultMessage:"symbol label"}),compressed:!0})))}function St(t){const e=t.styleProperty.isDynamic()?Object(g.jsx)(vt,d()({},t,{styleProperty:t.styleProperty})):Object(g.jsx)(Ct,d()({},t,{styleProperty:t.styleProperty}));return Object(g.jsx)(style_prop_editor_StylePropEditor,t,e)}function Mt(t){const e=t.styleProperty.getLayerZoomRange(),i=t.styleProperty.getLabelZoomRange(),{useLayerZoomRange:r}=t.styleProperty.getOptions(),n=r?null:Object(g.jsx)(h.EuiFormRow,{hasEmptyLabelSpace:!0},Object(g.jsx)($.ValidatedDualRange,{formRowDisplay:"columnCompressed",min:e.minZoom,max:e.maxZoom,value:[i.minZoom,i.maxZoom],showInput:"inputWithPopover",showRange:!0,showLabels:!0,onChange:i=>{t.handlePropertyChange(t.styleProperty.getStyleName(),{options:{...t.styleProperty.getOptions(),minZoom:Math.max(e.minZoom,parseInt(i[0],10)),maxZoom:Math.min(e.maxZoom,parseInt(i[1],10))}})},allowEmptyRange:!1,compressed:!0,prepend:u.i18n.translate("xpack.maps.styles.labelZoomRange.visibleZoom",{defaultMessage:"Zoom levels"})})),a=Object(g.jsx)(h.EuiForm,null,Object(g.jsx)(h.EuiFormRow,{label:Object(f.b)(t.styleProperty.getStyleName())},Object(g.jsx)(h.EuiSwitch,{label:u.i18n.translate("xpack.maps.styles.labelZoomRange.useLayerZoomLabel",{defaultMessage:"Use layer visibility"}),checked:r,onChange:e=>{t.handlePropertyChange(t.styleProperty.getStyleName(),{options:{...t.styleProperty.getOptions(),useLayerZoomRange:e.target.checked}})},compressed:!0})),n);return t.disabled?Object(g.jsx)(h.EuiToolTip,{anchorClassName:"mapStyleFormDisabledTooltip",content:Object(f.a)(t.disabledBy)},a):a}const Tt=[{value:m.W.TOP,text:u.i18n.translate("xpack.maps.styles.labelPosition.top",{defaultMessage:"Top"})},{value:m.W.CENTER,text:u.i18n.translate("xpack.maps.styles.labelPosition.center",{defaultMessage:"Center"})},{value:m.W.BOTTOM,text:u.i18n.translate("xpack.maps.styles.labelBorderSize.bottom",{defaultMessage:"Bottom"})}];function Et({hasLabel:t,handlePropertyChange:e,styleProperty:i}){const r=!t||i.isDisabled(),n=Object(g.jsx)(h.EuiFormRow,{label:Object(f.b)(m.Ib.LABEL_POSITION)},Object(g.jsx)(h.EuiSelect,{disabled:r,options:Tt,value:r?m.W.CENTER:i.getOptions().position,onChange:function(t){e(i.getStyleName(),{options:{position:t.target.value}})},"aria-label":u.i18n.translate("xpack.maps.styles.labelPositionSelect.ariaLabel",{defaultMessage:"Select label position"}),compressed:!0}));return r?Object(g.jsx)(h.EuiToolTip,{anchorClassName:"mapStyleFormDisabledTooltip",content:t?i.getDisabledReason():Object(f.a)(m.Ib.LABEL_TEXT)},n):n}const At=[{value:m.V.NONE,text:u.i18n.translate("xpack.maps.styles.labelBorderSize.noneLabel",{defaultMessage:"None"})},{value:m.V.SMALL,text:u.i18n.translate("xpack.maps.styles.labelBorderSize.smallLabel",{defaultMessage:"Small"})},{value:m.V.MEDIUM,text:u.i18n.translate("xpack.maps.styles.labelBorderSize.mediumLabel",{defaultMessage:"Medium"})},{value:m.V.LARGE,text:u.i18n.translate("xpack.maps.styles.labelBorderSize.largeLabel",{defaultMessage:"Large"})}];function It({disabled:t,disabledBy:e,handlePropertyChange:i,styleProperty:r}){const n=Object(g.jsx)(h.EuiFormRow,{label:Object(f.b)(m.Ib.LABEL_BORDER_SIZE)},Object(g.jsx)(h.EuiSelect,{disabled:t,options:At,value:r.getOptions().size,onChange:function(t){const e={options:{size:t.target.value}};i(r.getStyleName(),e)},"aria-label":u.i18n.translate("xpack.maps.styles.labelBorderSizeSelect.ariaLabel",{defaultMessage:"Select label border size"}),compressed:!0}));return t?Object(g.jsx)(h.EuiToolTip,{anchorClassName:"mapStyleFormDisabledTooltip",content:Object(f.a)(e)},n):n}function Lt({fields:t,onDynamicStyleChange:e,staticDynamicSelect:i,styleProperty:r}){const n=r.getOptions();return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},i),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(w,{styleName:r.getStyleName(),fields:t,selectedFieldName:r.getFieldName(),onChange:({field:t})=>{e(r.getStyleName(),{...n,field:t})},compressed:!0})))}function Pt({onStaticStyleChange:t,staticDynamicSelect:e,styleProperty:i}){return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd"},Object(g.jsx)(h.EuiFlexItem,{grow:!1,className:"mapStyleSettings__fixedBox"},e),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(K.a,{min:0,max:360,value:i.getOptions().orientation,onChange:e=>{t(i.getStyleName(),{orientation:e})},showInput:"inputWithPopover",showLabels:!0,compressed:!0,append:"°"})))}function Ot(t){const e=t.styleProperty.isDynamic()?Object(g.jsx)(Lt,t):Object(g.jsx)(Pt,t);return Object(g.jsx)(style_prop_editor_StylePropEditor,t,e)}async function kt(t){const e=t.map((async t=>({label:await t.getLabel(),name:t.getName(),origin:t.getOrigin(),type:await t.getDataType(),supportsAutoDomain:t.supportsFieldMetaFromLocalData()||t.supportsFieldMetaFromEs(),isUnsupported:!1}))),i=await Promise.all(e);return new style_fields_helper_StyleFieldsHelper(i)}class style_fields_helper_StyleFieldsHelper{constructor(t){n()(this,"_styleFields",void 0),n()(this,"_ordinalAndCategoricalFields",void 0),n()(this,"_numberFields",void 0),n()(this,"_ordinalFields",void 0);const e=[],i=[],r=[];t.forEach((t=>{(m.h.includes(t.type)||m.sb.includes(t.type))&&e.push(t),"date"!==t.type&&"number"!==t.type||("number"===t.type&&i.push(t),t.supportsAutoDomain&&r.push(t))})),this._styleFields=t,this._ordinalAndCategoricalFields=e,this._numberFields=i,this._ordinalFields=r}hasFieldForStyle(t,e){return this._getFieldsForStyle(e).some((e=>t.getName()===e.name))}_getFieldsForStyle(t){switch(t){case m.Ib.ICON_ORIENTATION:return this._numberFields;case m.Ib.FILL_COLOR:case m.Ib.LINE_COLOR:case m.Ib.LABEL_COLOR:case m.Ib.LABEL_BORDER_COLOR:case m.Ib.ICON:return this._ordinalAndCategoricalFields;case m.Ib.LINE_WIDTH:case m.Ib.LABEL_SIZE:case m.Ib.ICON_SIZE:return this._ordinalFields;case m.Ib.LABEL_TEXT:return this._styleFields;default:return[]}}getFieldsForStyle(t,e){const i=this._getFieldsForStyle(t.getStyleName());return t.isDynamic()&&!t.supportsFeatureState()?i.map((i=>e&&i.origin===m.D.JOIN?{...i,isUnsupported:!0,unsupportedMsg:u.i18n.translate("xpack.maps.style.field.unsupportedWithVectorTileMsg",{defaultMessage:"''{styleLabel}'' does not support this field with vector tiles. To style ''{styleLabel}'' with this field, select 'Limit results' in 'Scaling'.",values:{styleLabel:Object(f.b)(t.getStyleName())}})}:i)):i}getStyleFields(){return this._styleFields}}class vector_style_editor_VectorStyleEditor extends a.Component{constructor(t){super(t),n()(this,"_isMounted",!1),n()(this,"_handleSelectedFeatureChange",(t=>{this.setState({selectedFeature:t})})),n()(this,"_onIsTimeAwareChange",(t=>{this.props.onIsTimeAwareChange(t.target.checked)})),n()(this,"_onStaticStyleChange",((t,e)=>{const i={type:m.Eb.STATIC,options:e};this.props.handlePropertyChange(t,i)})),n()(this,"_onDynamicStyleChange",((t,e)=>{const i={type:m.Eb.DYNAMIC,options:e};this.props.handlePropertyChange(t,i)}));let e=m.Hb.POLYGON;t.isPointsOnly?e=m.Hb.POINT:t.isLinesOnly&&(e=m.Hb.LINE),this.state={styleFields:[],defaultDynamicProperties:Object(W.i)(),defaultStaticProperties:Object(W.j)(),supportedFeatures:[],selectedFeature:e}}componentWillUnmount(){this._isMounted=!1}componentDidMount(){this._isMounted=!0,this._loadFields(),this._loadSupportedFeatures()}componentDidUpdate(){this._loadFields(),this._loadSupportedFeatures()}async _loadFields(){const t=await kt(await this.props.layer.getStyleEditorFields()),e=t.getStyleFields();!this._isMounted||c.a.isEqual(e,this.state.styleFields)&&void 0!==this.state.styleFieldsHelper||this.setState({styleFields:e,styleFieldsHelper:t})}async _loadSupportedFeatures(){const t=await this.props.layer.getSource().getSupportedShapeTypes();this._isMounted&&!c.a.isEqual(t,this.state.supportedFeatures)&&this.setState({supportedFeatures:t})}_hasMarkerOrIcon(){const t=this.props.styleProperties[m.Ib.ICON_SIZE];return t.isDynamic()||t.getOptions().size>0}_hasLabelBorder(){return this.props.styleProperties[m.Ib.LABEL_BORDER_SIZE].getOptions().size!==m.V.NONE}_isLayerSourceMvt(){return this.props.layer.getSource().isMvt()}_renderFillColor(t=!1){const e=this.props.styleProperties[m.Ib.FILL_COLOR];return Object(g.jsx)(G,{disabled:t&&!this._hasMarkerOrIcon(),disabledBy:m.Ib.ICON_SIZE,swatches:j.b,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:e,fields:this.state.styleFieldsHelper.getFieldsForStyle(e,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.FILL_COLOR].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.FILL_COLOR].options})}_renderLineColor(t=!1){const e=t&&!this._hasMarkerOrIcon(),i=this.props.styleProperties[m.Ib.LINE_COLOR];return Object(g.jsx)(G,{disabled:e||!this.props.hasBorder,disabledBy:e?m.Ib.ICON_SIZE:m.Ib.LINE_WIDTH,swatches:j.d,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:i,fields:this.state.styleFieldsHelper.getFieldsForStyle(i,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LINE_COLOR].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LINE_COLOR].options})}_renderLineWidth(t=!1){const e=this.props.styleProperties[m.Ib.LINE_WIDTH];return Object(g.jsx)(tt,{disabled:t&&!this._hasMarkerOrIcon(),disabledBy:m.Ib.ICON_SIZE,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:e,fields:this.state.styleFieldsHelper.getFieldsForStyle(e,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LINE_WIDTH].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LINE_WIDTH].options})}_renderLabelProperties(t){const e=Object(V.g)(this.props.styleProperties[m.Ib.LABEL_TEXT]),i=this._hasLabelBorder(),r=this.props.styleProperties[m.Ib.LABEL_TEXT],n=this.props.styleProperties[m.Ib.LABEL_COLOR],l=this.props.styleProperties[m.Ib.LABEL_SIZE],c=this.props.styleProperties[m.Ib.LABEL_BORDER_COLOR];return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(St,{onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:r,fields:this.state.styleFieldsHelper.getFieldsForStyle(r,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LABEL_TEXT].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LABEL_TEXT].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),t?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(Et,{hasLabel:e,handlePropertyChange:this.props.handlePropertyChange,styleProperty:this.props.styleProperties[m.Ib.LABEL_POSITION]}),Object(g.jsx)(h.EuiSpacer,{size:"m"})):null,Object(g.jsx)(Mt,{disabled:!e,disabledBy:m.Ib.LABEL_TEXT,handlePropertyChange:this.props.handlePropertyChange,styleProperty:this.props.styleProperties[m.Ib.LABEL_ZOOM_RANGE]}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),Object(g.jsx)(G,{disabled:!e,disabledBy:m.Ib.LABEL_TEXT,swatches:j.d,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:n,fields:this.state.styleFieldsHelper.getFieldsForStyle(n,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LABEL_COLOR].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LABEL_COLOR].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),Object(g.jsx)(tt,{disabled:!e,disabledBy:m.Ib.LABEL_TEXT,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:l,fields:this.state.styleFieldsHelper.getFieldsForStyle(l,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LABEL_SIZE].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LABEL_SIZE].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),Object(g.jsx)(G,{disabled:!e||!i,disabledBy:e?m.Ib.LABEL_BORDER_SIZE:m.Ib.LABEL_TEXT,swatches:j.d,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:c,fields:this.state.styleFieldsHelper.getFieldsForStyle(c,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.LABEL_BORDER_COLOR].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.LABEL_BORDER_COLOR].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),Object(g.jsx)(It,{disabled:!e,disabledBy:m.Ib.LABEL_TEXT,handlePropertyChange:this.props.handlePropertyChange,styleProperty:this.props.styleProperties[m.Ib.LABEL_BORDER_SIZE]}),Object(g.jsx)(h.EuiSpacer,{size:"m"}))}_renderPointProperties(){const t=this._hasMarkerOrIcon();let e,i;if(this.props.styleProperties[m.Ib.SYMBOLIZE_AS].isSymbolizedAsIcon()){const r=this.props.styleProperties[m.Ib.ICON_ORIENTATION],n=this.props.styleProperties[m.Ib.ICON];e=Object(g.jsx)(a.Fragment,null,Object(g.jsx)(Ot,{disabled:!t,disabledBy:m.Ib.ICON_SIZE,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:r,fields:this.state.styleFieldsHelper.getFieldsForStyle(r,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.ICON_ORIENTATION].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.ICON_ORIENTATION].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"})),i=Object(g.jsx)(a.Fragment,null,Object(g.jsx)(_t,{disabled:!t,disabledBy:m.Ib.ICON_SIZE,customIcons:this.props.customIcons,onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,onCustomIconsChange:this.props.onCustomIconsChange,styleProperty:n,fields:this.state.styleFieldsHelper.getFieldsForStyle(n,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.ICON].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.ICON].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}))}const r=this.props.styleProperties[m.Ib.ICON_SIZE];return Object(g.jsx)(a.Fragment,null,Object(g.jsx)(it,{disabled:!t,disabledBy:m.Ib.ICON_SIZE,styleProperty:this.props.styleProperties[m.Ib.SYMBOLIZE_AS],handlePropertyChange:this.props.handlePropertyChange}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),i,this._renderFillColor(!0),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLineColor(!0),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLineWidth(!0),Object(g.jsx)(h.EuiSpacer,{size:"m"}),e,Object(g.jsx)(tt,{onStaticStyleChange:this._onStaticStyleChange,onDynamicStyleChange:this._onDynamicStyleChange,styleProperty:r,fields:this.state.styleFieldsHelper.getFieldsForStyle(r,this._isLayerSourceMvt()),defaultStaticStyleOptions:this.state.defaultStaticProperties[m.Ib.ICON_SIZE].options,defaultDynamicStyleOptions:this.state.defaultDynamicProperties[m.Ib.ICON_SIZE].options}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLabelProperties(!0))}_renderLineProperties(){return Object(g.jsx)(a.Fragment,null,this._renderLineColor(),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLineWidth(),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLabelProperties(!1))}_renderPolygonProperties(){return Object(g.jsx)(a.Fragment,null,this._renderFillColor(),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLineColor(),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLineWidth(),Object(g.jsx)(h.EuiSpacer,{size:"m"}),this._renderLabelProperties(!1))}_renderProperties(){const{supportedFeatures:t,selectedFeature:e,styleFieldsHelper:i}=this.state;if(0===t.length||!i)return null;if(1===t.length)switch(t[0]){case m.Hb.POINT:return this._renderPointProperties();case m.Hb.LINE:return this._renderLineProperties();case m.Hb.POLYGON:return this._renderPolygonProperties()}const r=[{id:m.Hb.POINT,label:u.i18n.translate("xpack.maps.vectorStyleEditor.pointLabel",{defaultMessage:"Points"})},{id:m.Hb.LINE,label:u.i18n.translate("xpack.maps.vectorStyleEditor.lineLabel",{defaultMessage:"Lines"})},{id:m.Hb.POLYGON,label:u.i18n.translate("xpack.maps.vectorStyleEditor.polygonLabel",{defaultMessage:"Polygons"})}];let n=this._renderPolygonProperties();return e===m.Hb.LINE?n=this._renderLineProperties():e===m.Hb.POINT&&(n=this._renderPointProperties()),Object(g.jsx)(a.Fragment,null,Object(g.jsx)(h.EuiButtonGroup,{legend:u.i18n.translate("xpack.maps.vectorStyleEditor.featureTypeButtonGroupLegend",{defaultMessage:"vector feature button group"}),options:r,idSelected:e,onChange:this._handleSelectedFeatureChange}),Object(g.jsx)(h.EuiSpacer,{size:"m"}),n)}_renderIsTimeAwareSwitch(){return this.props.showIsTimeAware?Object(g.jsx)(h.EuiFormRow,{display:"columnCompressedSwitch"},Object(g.jsx)(h.EuiSwitch,{label:u.i18n.translate("xpack.maps.vectorStyleEditor.isTimeAwareLabel",{defaultMessage:"Apply global time to style metadata requests"}),checked:this.props.isTimeAware,onChange:this._onIsTimeAwareChange,compressed:!0})):null}render(){return Object(g.jsx)(a.Fragment,null,this._renderProperties(),this._renderIsTimeAwareSwitch())}}class style_meta_StyleMeta{constructor(t){n()(this,"_descriptor",void 0),this._descriptor=t||{fieldMeta:{}}}getRangeFieldMetaDescriptor(t){return this._descriptor.fieldMeta[t]&&this._descriptor.fieldMeta[t].range?this._descriptor.fieldMeta[t].range:null}getCategoryFieldMetaDescriptor(t){return this._descriptor.fieldMeta[t]?this._descriptor.fieldMeta[t].categories:[]}isPointsOnly(){return!!this._descriptor.geometryTypes&&!!this._descriptor.geometryTypes.isPointsOnly}isLinesOnly(){return!!this._descriptor.geometryTypes&&!!this._descriptor.geometryTypes.isLinesOnly}isPolygonsOnly(){return!!this._descriptor.geometryTypes&&!!this._descriptor.geometryTypes.isPolygonsOnly}}const Dt=({style:t})=>Object(g.jsx)("svg",{className:"euiIcon euiIcon--medium mapFillableCircle",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",style:t,viewBox:"0 0 16 16"},Object(g.jsx)("defs",null,Object(g.jsx)("path",{id:"fillableCircle",d:"M8,15 C11.8659932,15 15,11.8659932 15,8 C15,4.13400675 11.8659932,        1 8,1 C4.13400675,1 1,4.13400675 1,8 C1,11.8659932 4.13400675,15 8,        15 Z M8,16 C3.581722,16 0,12.418278 0,8 C0,3.581722 3.581722,0 8,        0 C12.418278,0 16,3.581722 16,8 C16,12.418278 12.418278,16 8,16 Z M8,        12 C10.209139,12 12,10.209139 12,8 C12,5.790861 10.209139,4 8,        4 C5.790861,4 4,5.790861 4,8 C4,10.209139 5.790861,12 8,12 Z M8,        11 C6.34314575,11 5,9.65685425 5,8 C5,6.34314575 6.34314575,5 8,        5 C9.65685425,5 11,6.34314575 11,8 C11,9.65685425 9.65685425,11 8,        11 Z M8,9 C8.55228475,9 9,8.55228475 9,8 C9,7.44771525 8.55228475,7 8,        7 C7.44771525,7 7,7.44771525 7,8 C7,8.55228475 7.44771525,9 8,9 Z"})),Object(g.jsx)("g",null,Object(g.jsx)("ellipse",{id:"path3353",cx:"8.0350437",cy:"7.9660664",rx:"7.3820276",ry:"7.3809776",transform:"matrix(0.99985753,0.01687955,0,1,0,0)"}))),Ft=({style:t})=>Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",style:t},Object(g.jsx)("line",{x1:"0",y1:"6",x2:"16",y2:"6"})),zt=({style:t})=>Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",style:t},Object(g.jsx)("rect",{width:"15",height:"15",x:".5",y:".5",rx:"4"}));function Rt({borderStyle:t={},fillColor:e,isPointsOnly:i,isLinesOnly:r,strokeColor:n,symbolId:a,svg:o}){if(r){const e={stroke:n,strokeWidth:"4px",...t};return Object(g.jsx)(Ft,{style:e})}const l={stroke:n,strokeWidth:"1px",fill:e,...t};return i?a?o?Object(g.jsx)(ot.a,{key:`${a}${e}${n}`,symbolId:a,fill:e,stroke:n,style:t,svg:o}):null:Object(g.jsx)(Dt,{style:l}):Object(g.jsx)(zt,{style:l})}var jt=i(239);function Nt({isLinesOnly:t,isPointsOnly:e,masks:i,styles:r,symbolId:n,svg:a}){const l=[];for(let i=0;i<r.length;i++){const o=r[i].renderLegendDetailRow({isLinesOnly:t,isPointsOnly:e,symbolId:n,svg:a});l.push(Object(g.jsx)("div",{key:i,className:"vectorStyleLegendSpacer"},o))}function c(t){const e=i.filter((e=>e.getEsAggField().getOrigin()===t));if(0===e.length)return null;if(1===e.length){const t=e[0];return Object(g.jsx)(jt.a,{key:t.getEsAggField().getMbFieldName(),esAggField:t.getEsAggField(),operator:t.getOperator(),value:t.getValue()})}return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(h.EuiText,{size:"xs",textAlign:"left",color:"subdued"},Object(g.jsx)("small",null,e[0].getFieldOriginListLabel())),Object(g.jsx)("ul",null,e.map((t=>Object(g.jsx)("li",{key:t.getEsAggField().getMbFieldName(),style:{marginLeft:B.euiThemeVars.euiSizeS}},Object(g.jsx)(jt.a,{esAggField:t.getEsAggField(),onlyShowLabelAndValue:!0,operator:t.getOperator(),value:t.getValue()}))))))}return Object(g.jsx)(o.a.Fragment,null,c(m.D.SOURCE),c(m.D.JOIN),l)}var Bt=i(151);class static_style_property_StaticStyleProperty extends Bt.a{}n()(static_style_property_StaticStyleProperty,"type",m.Eb.STATIC);var Vt=i(141);class right_aligned_text_RightAlignedText extends a.Component{constructor(...t){super(...t),n()(this,"_textRef",o.a.createRef())}componentDidMount(){this._setWidth()}componentDidUpdate(){this._setWidth()}_setWidth(){this._textRef.current&&this.props.setWidth(this._textRef.current.getBBox().width)}render(){return Object(g.jsx)("text",{ref:this._textRef,style:this.props.style,textAnchor:"end",x:this.props.x,y:this.props.y},this.props.value)}}function Ut(t,e,i){return t&&e?`> ${i}`:i}function Ht(t,e,i){return t&&e?`< ${i}`:i}class marker_list_MarkerList{constructor(t,e){n()(this,"_minFontDistance",void 0),n()(this,"_maxMarker",void 0),n()(this,"_markers",[]),this._minFontDistance=.85*t,this._maxMarker=e}push(t){t.textY-this._maxMarker.textY<this._minFontDistance||(0!==this._markers.length?this._markers[this._markers.length-1].textY-t.textY>this._minFontDistance&&this._markers.push(t):this._markers.push(t))}getMarkers(){return[...this._markers.map((t=>t.svg)),this._maxMarker.svg]}}class marker_size_legend_MarkerSizeLegend extends a.Component{static getDerivedStateFromProps(t,e){const i=t.style.getRangeFieldMeta();return c.a.isEqual(i,e.fieldMeta)?null:{maxLabelWidth:0,fieldMeta:i}}constructor(t){super(t),n()(this,"_isMounted",!1),n()(this,"_onRightAlignedWidthChange",(t=>{t>this.state.maxLabelWidth&&this.setState({maxLabelWidth:t})})),this.state={label:"",maxLabelWidth:0,fieldMeta:this.props.style.getRangeFieldMeta()}}componentDidMount(){this._isMounted=!0,this._loadLabel()}componentDidUpdate(){this._loadLabel()}componentWillUnmount(){this._isMounted=!1}async _loadLabel(){const t=this.props.style.getField();if(!t)return;const e=await t.getLabel();this._isMounted&&this.state.label!==e&&this.setState({label:e})}_formatValue(t){return""===t?t:this.props.style.formatField(t)}_renderMarkers(){const t=this.state.fieldMeta,e=this.props.style.getOptions();if(!t||!e)return null;const i=void 0!==e.invert&&e.invert,r={fillOpacity:0,stroke:B.euiThemeVars.euiTextColor,strokeWidth:1},n=2*e.maxSize+5+2*r.strokeWidth,a=e.maxSize+r.strokeWidth,o=n-r.strokeWidth,l=(t,e)=>{const i=o-t,l=i-t,c=this.state.maxLabelWidth+5,u=l+5,h=u>n?n:u;return{svg:Object(g.jsx)("g",{key:t},Object(g.jsx)("line",{style:{stroke:B.euiThemeVars.euiBorderColor},x1:a,y1:l,x2:2.25*a,y2:l}),Object(g.jsx)(right_aligned_text_RightAlignedText,{setWidth:this._onRightAlignedWidthChange,style:{fontSize:10,fill:B.euiThemeVars.euiTextColor},x:2.25*a+c,y:h,value:e}),Object(g.jsx)("circle",{style:r,cx:a,cy:i,r:t})),textY:h}};function c(t){return t*(e.maxSize-e.minSize)+e.minSize}function u(e){const r=Math.pow(e*Math.sqrt(t.delta),2),n=i?t.max-r:r+t.min;return t.delta>3?Math.round(n):n}const h=Ut(this.props.style.isFieldMetaEnabled(),Boolean(t.isMaxOutsideStdRange),this._formatValue(t.max)),p=Ht(this.props.style.isFieldMetaEnabled(),Boolean(t.isMinOutsideStdRange),this._formatValue(t.min)),d=new marker_list_MarkerList(10,l(e.maxSize,i?p:h));return t.delta>0&&(d.push(l(e.minSize,i?h:p)),d.push(l(c(.25),this._formatValue(u(.25)))),d.push(l(c(.5),this._formatValue(u(.5)))),d.push(l(c(.75),this._formatValue(u(.75))))),Object(g.jsx)("svg",{height:n,xmlns:"http://www.w3.org/2000/svg"},d.getMarkers())}render(){return Object(g.jsx)("div",null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"spaceBetween"},Object(g.jsx)(h.EuiFlexItem,{grow:!1},Object(g.jsx)(h.EuiToolTip,{position:"top",title:this.props.style.getDisplayStyleName(),content:this.state.label},Object(g.jsx)(h.EuiText,{className:"eui-textTruncate",size:"xs",style:{maxWidth:"180px"}},Object(g.jsx)("small",null,Object(g.jsx)("strong",null,this.state.label)))))),this._renderMarkers())}}var qt=i(240);const Zt="";class ordinal_legend_OrdinalLegend extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",!1),n()(this,"state",{label:Zt})}componentDidMount(){this._isMounted=!0,this._loadLabel()}componentDidUpdate(){this._loadLabel()}componentWillUnmount(){this._isMounted=!1}async _loadLabel(){const t=this.props.style.getField();if(!t)return;const e=await t.getLabel();this._isMounted&&!c.a.isEqual(this.state.label,e)&&this.setState({label:e})}_formatValue(t){return t===Zt?t:this.props.style.formatField(t)}_renderRangeLegendHeader(){let t;if(this.props.style.getStyleName()===m.Ib.LINE_WIDTH)t=function(){const t={stroke:"grey",fill:"none",width:"12px"};return[Object(g.jsx)(Dt,{style:{...t,strokeWidth:"1px"}}),Object(g.jsx)(Dt,{style:{...t,strokeWidth:"2px"}}),Object(g.jsx)(Dt,{style:{...t,strokeWidth:"3px"}})]}();else{if(this.props.style.getStyleName()!==m.Ib.ICON_SIZE)return null;t=function(){const t={stroke:"grey",fill:"grey"};return[Object(g.jsx)(Dt,{style:{...t,width:"4px"}}),Object(g.jsx)(Dt,{style:{...t,width:"8px"}}),Object(g.jsx)(Dt,{style:{...t,width:"12px"}})]}()}return Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"spaceBetween",alignItems:"center"},t.map(((e,i)=>{let r;return i===t.length-1||(r=Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(h.EuiHorizontalRule,{margin:"xs"}))),Object(g.jsx)(a.Fragment,{key:i},Object(g.jsx)(h.EuiFlexItem,{grow:!1},e),r)})))}render(){const t=this._renderRangeLegendHeader();if(!t)return null;const e=this.props.style.getRangeFieldMeta();let i=Zt,r=Zt;if(e){const t=this._formatValue(c.a.get(e,"min",Zt));i=Ht(this.props.style.isFieldMetaEnabled(),Boolean(e.isMinOutsideStdRange),t);const n=this._formatValue(c.a.get(e,"max",Zt));r=Ut(this.props.style.isFieldMetaEnabled(),Boolean(e.isMaxOutsideStdRange),n)}const n=this.props.style.getOptions(),a=void 0!==n.invert&&n.invert;return Object(g.jsx)(qt.a,{header:t,minLabel:i,maxLabel:r,propertyLabel:this.props.style.getDisplayStyleName(),fieldLabel:this.state.label,invert:a})}}class dynamic_size_property_DynamicSizeProperty extends Vt.a{constructor(t,e,i,r,a,o){super(t,e,i,r,a),n()(this,"_isSymbolizedAsIcon",void 0),this._isSymbolizedAsIcon=o}supportsFeatureState(){return(this.getStyleName()!==m.Ib.ICON_SIZE||!this._isSymbolizedAsIcon)&&this.getStyleName()!==m.Ib.LABEL_SIZE}syncHaloWidthWithMb(t,e){e.setPaintProperty(t,"icon-halo-width",this.getMbSizeExpression())}syncIconSizeWithMb(t,e){e.setLayoutProperty(t,"icon-size",this.getMbSizeExpression())}syncCircleStrokeWidthWithMb(t,e){e.setPaintProperty(t,"circle-stroke-width",this.getMbSizeExpression())}syncCircleRadiusWithMb(t,e){e.setPaintProperty(t,"circle-radius",this.getMbSizeExpression())}syncLineWidthWithMb(t,e){e.setPaintProperty(t,"line-width",this.getMbSizeExpression())}syncLabelSizeWithMb(t,e){e.setLayoutProperty(t,"text-size",this.getMbSizeExpression())}getMbSizeExpression(t){const e=this.getRangeFieldMeta();if(!this.isSizeDynamicConfigComplete()||!e)return this._options.minSize>=0?this._options.minSize:null;const i=this.getStyleName()===m.Ib.ICON_SIZE,r=e.min<1?Math.abs(e.min)+1:0,n=i?Math.sqrt(e.max+r):e.max,a=i?Math.sqrt(e.min+r):e.min,o=null!=t&&t.maxStopOutput?t.maxStopOutput:this.getMaxStopOutput(),l=null!=t&&t.minStopOutput?t.minStopOutput:this.getMinStopOutput(),c=void 0!==this._options.invert&&this._options.invert,u=e.min===e.max?c?[n,l]:[n,o]:c?[a,o,n,l]:[a,l,n,o],h=Object(V.h)({lookupFunction:null!=t&&t.forceFeatureProperties?m.ib.GET:this.getMbLookupFunction(),maxValue:e.max,minValue:e.min,fieldName:this.getMbFieldName(),fallback:c?e.max:e.min}),p=e.min<1?["+",h,r]:h;return["interpolate",["linear"],i?["sqrt",p]:h,...u]}getMaxStopOutput(){return this.getStyleName()===m.Ib.ICON_SIZE&&this._isSymbolizedAsIcon?this._options.maxSize/m.M:this._options.maxSize}getMinStopOutput(){return this.getStyleName()===m.Ib.ICON_SIZE&&this._isSymbolizedAsIcon?this._options.minSize/m.M:this._options.minSize}isSizeDynamicConfigComplete(){return this._field&&this._field.isValid()&&this._options.minSize>=0&&this._options.maxSize>=0}renderLegendDetailRow(){return this.getStyleName()!==m.Ib.ICON_SIZE||this._isSymbolizedAsIcon?Object(g.jsx)(ordinal_legend_OrdinalLegend,{style:this}):Object(g.jsx)(marker_size_legend_MarkerSizeLegend,{style:this})}}class static_size_property_StaticSizeProperty extends static_style_property_StaticStyleProperty{constructor(t,e){"number"!=typeof t.size?super({size:1},e):super(t,e)}syncHaloWidthWithMb(t,e){e.setPaintProperty(t,"icon-halo-width",this._options.size)}syncIconSizeWithMb(t,e){e.setLayoutProperty(t,"icon-size",this._options.size/m.M)}syncCircleStrokeWidthWithMb(t,e,i){i?e.setPaintProperty(t,"circle-stroke-width",0):e.setPaintProperty(t,"circle-stroke-width",this._options.size)}syncCircleRadiusWithMb(t,e){e.setPaintProperty(t,"circle-radius",this._options.size)}syncLineWidthWithMb(t,e){e.setPaintProperty(t,"line-width",this._options.size)}syncLabelSizeWithMb(t,e){e.setLayoutProperty(t,"text-size",this._options.size)}}class static_color_property_StaticColorProperty extends static_style_property_StaticStyleProperty{syncCircleColorWithMb(t,e,i){e.setPaintProperty(t,"circle-color",this._options.color),e.setPaintProperty(t,"circle-opacity",i)}syncFillColorWithMb(t,e,i){e.setPaintProperty(t,"fill-color",this._options.color),e.setPaintProperty(t,"fill-opacity",i)}syncIconColorWithMb(t,e){e.setPaintProperty(t,"icon-color",this._options.color)}syncHaloBorderColorWithMb(t,e){e.setPaintProperty(t,"icon-halo-color",this._options.color)}syncLineColorWithMb(t,e,i){e.setPaintProperty(t,"line-color",this._options.color),e.setPaintProperty(t,"line-opacity",i)}syncCircleStrokeWithMb(t,e,i){e.setPaintProperty(t,"circle-stroke-color",this._options.color),e.setPaintProperty(t,"circle-stroke-opacity",i)}syncLabelColorWithMb(t,e,i){e.setPaintProperty(t,"text-color",this._options.color),e.setPaintProperty(t,"text-opacity",i)}syncLabelBorderColorWithMb(t,e){e.setPaintProperty(t,"text-halo-color",this._options.color)}}function Gt({styleName:t,label:e,color:i,isLinesOnly:r,isPointsOnly:n,symbolId:a,svg:o}){return Object(g.jsx)(h.EuiFlexGroup,{direction:"row",gutterSize:"none"},Object(g.jsx)(h.EuiFlexItem,{className:"mapLegendIconPreview",grow:!1},t===m.Ib.LABEL_COLOR?Object(g.jsx)(h.EuiText,{size:"xs",style:{color:i}},"Tx"):Object(g.jsx)(Rt,{fillColor:t===m.Ib.FILL_COLOR?i:"none",isPointsOnly:n,isLinesOnly:r,strokeColor:i,symbolId:a,svg:o})),Object(g.jsx)(h.EuiFlexItem,null,Object(g.jsx)(h.EuiText,{size:"xs"},e)))}class breaked_legend_BreakedLegend extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",!1),n()(this,"state",{label:""})}componentDidMount(){this._isMounted=!0,this._loadLabel()}componentDidUpdate(){this._loadLabel()}componentWillUnmount(){this._isMounted=!1}async _loadLabel(){const t=this.props.style.getField();if(!t)return;const e=await t.getLabel();this._isMounted&&!c.a.isEqual(this.state.label,e)&&this.setState({label:e})}render(){if(""===this.state.label)return null;const t=this.props.breaks.map((({symbolId:t,svg:e,label:i,color:r},n)=>Object(g.jsx)(h.EuiFlexItem,{key:n},Object(g.jsx)(Gt,{styleName:this.props.style.getStyleName(),label:i,color:r,isLinesOnly:this.props.isLinesOnly,isPointsOnly:this.props.isPointsOnly,symbolId:t,svg:e}))));return Object(g.jsx)("div",null,Object(g.jsx)(h.EuiFlexGroup,{gutterSize:"xs",justifyContent:"spaceBetween"},Object(g.jsx)(h.EuiFlexItem,{grow:!1},Object(g.jsx)(h.EuiToolTip,{position:"top",title:this.props.style.getDisplayStyleName(),content:this.state.label},Object(g.jsx)(h.EuiText,{className:"eui-textTruncate",size:"xs",style:{maxWidth:"180px"}},Object(g.jsx)("small",null,Object(g.jsx)("strong",null,this.state.label)))))),Object(g.jsx)(h.EuiFlexGroup,{direction:"column",gutterSize:"none"},t))}}var $t=i(322);const Wt=u.i18n.translate("xpack.maps.legend.upto",{defaultMessage:"up to"}),Xt="rgba(0,0,0,0)";class dynamic_color_property_DynamicColorProperty extends Vt.a{constructor(t,e,i,r,a,o){super(t,e,i,r,a),n()(this,"_chartsPaletteServiceGetColor",void 0),this._chartsPaletteServiceGetColor=o}syncCircleColorWithMb(t,e,i){const r=this._getMbColor();e.setPaintProperty(t,"circle-color",r),e.setPaintProperty(t,"circle-opacity",i)}syncIconColorWithMb(t,e){const i=this._getMbColor();e.setPaintProperty(t,"icon-color",i)}syncHaloBorderColorWithMb(t,e){const i=this._getMbColor();e.setPaintProperty(t,"icon-halo-color",i)}syncCircleStrokeWithMb(t,e,i){const r=this._getMbColor();e.setPaintProperty(t,"circle-stroke-color",r),e.setPaintProperty(t,"circle-stroke-opacity",i)}syncFillColorWithMb(t,e,i){const r=this._getMbColor();e.setPaintProperty(t,"fill-color",r),e.setPaintProperty(t,"fill-opacity",i)}syncLineColorWithMb(t,e,i){const r=this._getMbColor();e.setPaintProperty(t,"line-color",r),e.setPaintProperty(t,"line-opacity",i)}syncLabelColorWithMb(t,e,i){const r=this._getMbColor();e.setPaintProperty(t,"text-color",r),e.setPaintProperty(t,"text-opacity",i)}syncLabelBorderColorWithMb(t,e){const i=this._getMbColor();e.setPaintProperty(t,"text-halo-color",i)}supportsFieldMeta(){return!!(this.isComplete()&&this._field&&this._field.supportsFieldMetaFromEs())&&(this.isCategorical()&&!this._options.useCustomColorPalette||this.isOrdinal()&&!this._options.useCustomColorRamp)}isOrdinal(){return void 0===this._options.type||this._options.type===m.j.ORDINAL}isCategorical(){return this._options.type===m.j.CATEGORICAL}getNumberOfCategories(){if(!this._options.colorCategory)return 0;const t=Object(j.f)(this._options.colorCategory);return t?t.length:0}_getSupportedDataMappingFunctions(){return[m.n.INTERPOLATE,m.n.PERCENTILES]}_getMbColor(){return this.getMbFieldName()?this.isCategorical()?this._getCategoricalColorMbExpression():this._getOrdinalColorMbExpression():null}_getOrdinalColorMbExpression(){const t=void 0!==this._options.invert&&this._options.invert,e=this.getMbFieldName();if(this._options.useCustomColorRamp){if(!this._options.customColorRamp||!this._options.customColorRamp.length)return null;const t=this._options.customColorRamp.reduce(((t,e)=>[...t,e.stop,e.color]),[]);return["step",Object(V.h)({minValue:t[0],maxValue:t[t.length-2],lookupFunction:this.getMbLookupFunction(),fallback:t[0]-1,fieldName:e}),Xt,...t]}if(this.getDataMappingFunction()===m.n.PERCENTILES){const i=this.getPercentilesFieldMeta();if(!i||!i.length)return null;const r=Object(j.j)(this._options.color?this._options.color:null,i,t);return r?["step",Object(V.h)({minValue:r[0],maxValue:r[r.length-2],lookupFunction:this.getMbLookupFunction(),fallback:r[0]-1,fieldName:e}),Xt,...r]:null}const i=this.getRangeFieldMeta();if(!i)return null;const r=Object(j.i)(this._options.color?this._options.color:null,i.min,i.max,t);if(!r)return null;const n=i.min-1;return["interpolate",["linear"],Object(V.h)({minValue:i.min,maxValue:i.max,lookupFunction:this.getMbLookupFunction(),fallback:n,fieldName:e}),n,Xt,...r]}_getCustomRampColorStops(){return this._options.customColorRamp?this._options.customColorRamp.reduce(((t,e)=>[...t,e.stop,e.color]),[]):[]}_getOtherCategoryColor(){return this._chartsPaletteServiceGetColor?this._chartsPaletteServiceGetColor("__other__"):this._options.otherCategoryColor?this._options.otherCategoryColor:V.a}_getColorPaletteStops(){if(this._options.useCustomColorPalette&&this._options.customColorPalette){if(P(this._options.customColorPalette))return[];const t=[];for(let e=0;e<this._options.customColorPalette.length;e++){const i=this._options.customColorPalette[e];t.push({stop:i.stop,color:i.color,isOtherCategory:!1})}return[...t,{stop:Vt.b,color:this._getOtherCategoryColor(),isOtherCategory:!0}]}const t=this.getCategoryFieldMeta(),e=this._options.colorCategory?Object(j.f)(this._options.colorCategory):null;if(0===t.length||!e)return[];const i=t.findIndex((t=>t.key===Vt.b)),r=i>0?[...t.slice(0,i),...t.slice(i+1)]:[...t],n=Math.min(e.length,r.length),a=[];for(let t=0;t<n;t++)a.push({stop:r[t].key,color:this._chartsPaletteServiceGetColor?this._chartsPaletteServiceGetColor(r[t].key):e[t],isOtherCategory:!1});return i>0?[...a,{stop:Vt.b,color:this._getOtherCategoryColor(),isOtherCategory:!0}]:a}_getCategoricalColorMbExpression(){const t=this._getOtherCategoryColor();if(this._options.useCustomColorPalette&&(!this._options.customColorPalette||!this._options.customColorPalette.length))return t;const e=this._getColorPaletteStops();if(e.length<1)return t;const i=[];for(let t=0;t<e.length;t++){const r=e[t];r.isOtherCategory||(i.push(`${r.stop}`),i.push(r.color))}return i.push(t),["match",["to-string",["get",this.getMbFieldName()]],...i]}_getOrdinalBreaks(t,e){const i=void 0!==this._options.invert&&this._options.invert;let r=null,n=null;if(this._options.useCustomColorRamp){if(!this._options.customColorRamp)return[];r=this._getCustomRampColorStops()}else if(this.getDataMappingFunction()===m.n.PERCENTILES){const t=this.getPercentilesFieldMeta();if(!t)return[];r=Object(j.j)(this._options.color?this._options.color:null,t,i),n=function(e,i){const r=i?parseFloat(t[e/2+1].percentile):parseFloat(t[e/2].percentile);return`${r}${Object($t.a)(r)}: `}}else{const n=this.getRangeFieldMeta();if(!n||!this._options.color)return[];if(0===n.delta){const r=i?Object(j.f)(this._options.color).reverse():Object(j.f)(this._options.color);return[{color:r[r.length-1],label:this.formatField(Object(V.d)(n.max)),symbolId:t,svg:e}]}r=Object(j.i)(this._options.color?this._options.color:null,n.min,n.max,i)}if(!r||r.length<=2)return[];const a=[],o=r.length-2;for(let i=0;i<r.length;i+=2){const l=i<o,c=r[i],u=this.formatField(Object(V.d)(c)),h=r[i+1],p=n?n(i,!1):"";let d="";if(l){const t=r[i+2],e=this.formatField(Object(V.d)(t)),a=n?n(i,!0):"";d=0===i?`< ${a}${e}`:`${p}${u} ${Wt} ${a}${e}`}else d=`>= ${p}${u}`;a.push({color:h,label:d,symbolId:t,svg:e})}return a}_getCategoricalBreaks(t,e){const i=[];return this._getColorPaletteStops().forEach((({stop:r,color:n,isOtherCategory:a})=>{null!==r&&null!=n&&i.push({color:n,svg:e,symbolId:t,label:a?Object(g.jsx)(h.EuiTextColor,{color:"subdued"},V.b):this.formatField(r)})})),i}renderLegendDetailRow({isPointsOnly:t,isLinesOnly:e,symbolId:i,svg:r}){let n=[];return this.isOrdinal()?n=this._getOrdinalBreaks(i,r):this.isCategorical()&&(n=this._getCategoricalBreaks(i,r)),Object(g.jsx)(breaked_legend_BreakedLegend,{style:this,breaks:n,isPointsOnly:t,isLinesOnly:e})}}class static_orientation_property_StaticOrientationProperty extends static_style_property_StaticStyleProperty{constructor(t,e){"number"!=typeof t.orientation?super({orientation:0},e):super(t,e)}syncIconRotationWithMb(t,e){e.setLayoutProperty(t,"icon-rotate",this._options.orientation)}}class dynamic_orientation_property_DynamicOrientationProperty extends Vt.a{syncIconRotationWithMb(t,e){if(this._field&&this._field.isValid()){const i=this.getMbPropertyName();e.setLayoutProperty(t,"icon-rotate",["coalesce",[this.getMbLookupFunction(),i],0])}else e.setLayoutProperty(t,"icon-rotate",0)}supportsFieldMeta(){return!1}supportsFeatureState(){return!1}}class static_text_property_StaticTextProperty extends static_style_property_StaticStyleProperty{isComplete(){return this.getOptions().value.length>0}syncTextFieldWithMb(t,e){this.getOptions().value.length?e.setLayoutProperty(t,"text-field",this.getOptions().value):void 0!==e.getLayoutProperty(t,"text-field")&&e.setLayoutProperty(t,"text-field",void 0)}}class dynamic_text_property_DynamicTextProperty extends Vt.a{syncTextFieldWithMb(t,e){if(this._field&&this._field.isValid()){const i=this.getMbPropertyName();this._field.isCount()?e.setLayoutProperty(t,"text-field",["number-format",[this.getMbLookupFunction(),i],{locale:u.i18n.getLocale()}]):e.setLayoutProperty(t,"text-field",["coalesce",[this.getMbLookupFunction(),i],""])}else void 0!==e.getLayoutProperty(t,"text-field")&&e.setLayoutProperty(t,"text-field",void 0)}isOrdinal(){return!1}supportsFieldMeta(){return!1}supportsFeatureState(){return!1}getMbPropertyValue(t){return this.formatField(t)}}class label_zoom_range_property_LabelZoomRangeProperty extends Bt.a{constructor(t,e,i,r){super(t,e),n()(this,"_layerMinZoom",void 0),n()(this,"_layerMaxZoom",void 0),this._layerMinZoom=i,this._layerMaxZoom=r}syncLabelZoomRange(t,e){const{maxZoom:i,minZoom:r}=this.getLabelZoomRange();e.setLayerZoomRange(t,r,i)}getLayerZoomRange(){return{maxZoom:this._layerMaxZoom,minZoom:this._layerMinZoom}}getLabelZoomRange(){const{useLayerZoomRange:t,maxZoom:e,minZoom:i}=this.getOptions();return t?this.getLayerZoomRange():{maxZoom:Math.min(this._layerMaxZoom,e),minZoom:Math.max(this._layerMinZoom,i)}}}class label_border_size_property_LabelBorderSizeProperty extends Bt.a{constructor(t,e,i){super(t,e),n()(this,"_labelSizeProperty",void 0),this._labelSizeProperty=i}syncLabelBorderSizeWithMb(t,e){if(this.getOptions().size===m.V.NONE)return void e.setPaintProperty(t,"text-halo-width",0);const i=function(t){switch(t){case m.V.LARGE:return.2;case m.V.MEDIUM:return.125;default:return.0625}}(this.getOptions().size);if(this._labelSizeProperty.isDynamic()&&this._labelSizeProperty.isComplete()){const r=this._labelSizeProperty.getMbSizeExpression();if(r)return void e.setPaintProperty(t,"text-halo-width",["max",["*",r,i],1])}const r=c.a.get(this._labelSizeProperty.getOptions(),"size",W.b),n=Math.max(r*i,1);e.setPaintProperty(t,"text-halo-width",n)}}class label_position_property_LabelPositionProperty extends Bt.a{constructor(t,e,i,r,a,o){super(t,e),n()(this,"_iconProperty",void 0),n()(this,"_iconSizeProperty",void 0),n()(this,"_labelSizeProperty",void 0),n()(this,"_isSymbolizedAsIcon",void 0),this._iconProperty=i,this._iconSizeProperty=r,this._labelSizeProperty=a,this._isSymbolizedAsIcon=o}isDisabled(){return!!this._labelSizeProperty.isDynamic()||!(!this._iconSizeProperty.isDynamic()||!this._iconSizeProperty.isComplete())&&this._isIconSizeFromJoin()}getDisabledReason(){return this._labelSizeProperty.isDynamic()?u.i18n.translate("xpack.maps.labelPosition.dynamicLabelSizeNotSupported",{defaultMessage:"{labelPositionPropertyLabel} is not supported with ''{byValueLabel}'' {labelSizePropertyLabel}. Set {labelSizePropertyLabel} to ''{fixedLabel}'' to enable.",values:{byValueLabel:_.toLowerCase(),fixedLabel:y.toLowerCase(),labelSizePropertyLabel:Object(f.b)(m.Ib.LABEL_SIZE).toLowerCase(),labelPositionPropertyLabel:Object(f.b)(m.Ib.LABEL_POSITION)}}):this._isIconSizeFromJoin()?u.i18n.translate("xpack.maps.labelPosition.iconSizeJoinFieldNotSupportMsg",{defaultMessage:"{labelPositionPropertyLabel} is not supported with {iconSizePropertyLabel} join field {iconSizeFieldName}. Set {iconSizePropertyLabel} to source field to enable.",values:{iconSizePropertyLabel:Object(f.b)(m.Ib.ICON_SIZE),iconSizeFieldName:this._iconSizeProperty.getFieldName(),labelPositionPropertyLabel:Object(f.b)(m.Ib.LABEL_POSITION)}}):""}syncLabelPositionWithMb(t,e){if(this._options.position===m.W.CENTER||this.isDisabled())return e.setLayoutProperty(t,"text-offset",[0,0]),void e.setLayoutProperty(t,"text-anchor","center");e.setLayoutProperty(t,"text-anchor",this._options.position===m.W.BOTTOM?"top":"bottom");const i=this._getLabelSize();if(this._iconSizeProperty.isDynamic()&&this._iconSizeProperty.isComplete()&&this._iconSizeProperty.isSizeDynamicConfigComplete()){const r=this._iconSizeProperty.getOptions(),n=this._iconSizeProperty.getMbSizeExpression({forceFeatureProperties:!0,maxStopOutput:["literal",this._getTextOffset(r.maxSize,i)],minStopOutput:["literal",this._getTextOffset(r.minSize,i)]});return void e.setLayoutProperty(t,"text-offset",n)}const r=this._iconSizeProperty.isDynamic()?W.a:this._iconSizeProperty.getOptions().size;e.setLayoutProperty(t,"text-offset",this._getTextOffset(r,i))}_getTextOffset(t,e){const i=t/e;return[0,(this._options.position===m.W.BOTTOM?i:-1*i)*this._getIconScale()]}_getIconScale(){return this._isSymbolizedAsIcon?"center"===(this._iconProperty.isDynamic()?"center":this._iconProperty.getSymbolAnchor())?1:this._options.position===m.W.TOP?1.75:0:1}_getLabelSize(){return this._labelSizeProperty.isDynamic()?W.b:this._labelSizeProperty.getOptions().size}_isIconSizeFromJoin(){return this._iconSizeProperty.isDynamic()&&this._iconSizeProperty.getFieldOrigin()===m.D.JOIN}}function Yt(t,e){if(!t)return e;if(t.type===m.Eb.STATIC)return t.options.color;const i=t.options;if(!i.field||!i.field.name)return e;if(i.type===m.j.CATEGORICAL){if(i.useCustomColorPalette)return i.customColorPalette&&i.customColorPalette.length?i.customColorPalette[0].color:e;if(!i.colorCategory)return e;const t=Object(j.f)(i.colorCategory);return t?t[0]:e}if(i.useCustomColorRamp){if(!i.customColorRamp||!i.customColorRamp.length)return e;const t=Math.floor((i.customColorRamp.length-1)/2);return i.customColorRamp[t].color}if(!i.color)return e;return Object(j.g)(i.color)||e}class symbolize_as_property_SymbolizeAsProperty extends Bt.a{constructor(...t){super(...t),n()(this,"isSymbolizedAsIcon",(()=>this.getOptions().value===m.Fb.ICON))}}class static_icon_property_StaticIconProperty extends static_style_property_StaticStyleProperty{syncIconWithMb(t,e){e.setLayoutProperty(t,"icon-anchor",this.getSymbolAnchor()),e.setLayoutProperty(t,"icon-image",this._options.value)}getSymbolAnchor(){return Object(lt.j)(this._options.value)}}class dynamic_icon_property_DynamicIconProperty extends Vt.a{isOrdinal(){return!1}isCategorical(){return!0}getNumberOfCategories(){return Object(lt.g)(this._options.iconPaletteId).length}syncIconWithMb(t,e){this._isIconDynamicConfigComplete()?(e.setLayoutProperty(t,"icon-image",this._getMbIconImageExpression()),e.setLayoutProperty(t,"icon-anchor",this._getMbIconAnchorExpression())):(e.setLayoutProperty(t,"icon-image",null),e.setLayoutProperty(t,"icon-anchor",null))}_getPaletteStops(){if(this._options.useCustomIconMap&&this._options.customIconStops){const t=[];for(let e=1;e<this._options.customIconStops.length;e++){const{stop:i,icon:r,iconSource:n}=this._options.customIconStops[e];t.push({stop:i,style:r,iconSource:n})}return{fallbackSymbolId:this._options.customIconStops.length>0?this._options.customIconStops[0].icon:null,stops:t}}return Object(V.c)({categories:this.getCategoryFieldMeta(),paletteValues:Object(lt.g)(this._options.iconPaletteId)})}_getMbIconImageExpression(){const{stops:t,fallbackSymbolId:e}=this._getPaletteStops();if(t.length<1||!e)return null;const i=[];return t.forEach((({stop:t,style:e})=>{i.push(`${t}`),i.push(e)})),e&&i.push(e),["match",["to-string",["get",this.getMbFieldName()]],...i]}_getMbIconAnchorExpression(){const{stops:t,fallbackSymbolId:e}=this._getPaletteStops();if(t.length<1||!e)return null;const i=[];return t.forEach((({stop:t,style:e})=>{i.push(`${t}`),i.push(Object(lt.j)(e))})),e&&i.push(Object(lt.j)(e)),["match",["to-string",["get",this.getMbFieldName()]],...i]}_isIconDynamicConfigComplete(){return this._field&&this._field.isValid()}renderLegendDetailRow({isPointsOnly:t,isLinesOnly:e}){const{stops:i,fallbackSymbolId:r}=this._getPaletteStops(),n=[],a=this._layer.getCurrentStyle();if(i.forEach((({stop:t,style:e})=>{if(t){const i=a.getIconSvg(e);n.push({color:"grey",label:this.formatField(t),symbolId:e,svg:i})}})),r){const t=a.getIconSvg(r);n.push({color:"grey",label:Object(g.jsx)(h.EuiTextColor,{color:"success"},V.b),symbolId:r,svg:t})}return Object(g.jsx)(breaked_legend_BreakedLegend,{style:this,breaks:n,isPointsOnly:t,isLinesOnly:e})}}class vector_style_VectorStyle{static createDescriptor(t={},e=!0){return{type:m.Y.VECTOR,properties:{...Object(W.j)(),...t},isTimeAware:e}}static createDefaultStyleProperties(t){return Object(W.j)(t)}constructor(t,e,i,r,a){n()(this,"_descriptor",void 0),n()(this,"_layer",void 0),n()(this,"_customIcons",void 0),n()(this,"_source",void 0),n()(this,"_styleMeta",void 0),n()(this,"_symbolizeAs",void 0),n()(this,"_lineColor",void 0),n()(this,"_fillColor",void 0),n()(this,"_lineWidth",void 0),n()(this,"_icon",void 0),n()(this,"_iconSize",void 0),n()(this,"_iconOrientation",void 0),n()(this,"_label",void 0),n()(this,"_labelZoomRange",void 0),n()(this,"_labelSize",void 0),n()(this,"_labelColor",void 0),n()(this,"_labelBorderColor",void 0),n()(this,"_labelBorderSize",void 0),n()(this,"_labelPosition",void 0),n()(this,"getIsPointsOnly",(()=>this._styleMeta.isPointsOnly())),n()(this,"_getIsLinesOnly",(()=>this._styleMeta.isLinesOnly())),n()(this,"_getIsPolygonsOnly",(()=>this._styleMeta.isPolygonsOnly())),n()(this,"_getFieldFormatter",(t=>{const e=this._getDynamicPropertyByFieldName(t);if(!e)return null;let i;if(e.getFieldOrigin()===m.D.SOURCE)i=m.Ab;else{const e=this._layer.getValidJoins().find((e=>!!e.getRightJoinSource().getFieldByName(t)));e&&(i=e.getSourceFormattersDataRequestId())}if(!i)return null;const r=this._layer.getDataRequest(i);if(!r||!r.hasData())return null;const n=r.getData();return n?n[t]:null})),n()(this,"_getLegendDetailStyleProperties",(()=>{const t=this.hasLabels();return this.getDynamicPropertiesArray().filter((e=>{const i=e.getStyleName();return![m.Ib.ICON_ORIENTATION,m.Ib.LABEL_TEXT].includes(i)&&!(!t&&W.d.includes(i))&&(this._getIsLinesOnly()?W.e.includes(i):!this._getIsPolygonsOnly()||W.h.includes(i))}))})),this._source=e,this._layer=i,this._customIcons=r,this._descriptor=t?{...t,...vector_style_VectorStyle.createDescriptor(t.properties,t.isTimeAware)}:vector_style_VectorStyle.createDescriptor(),this._styleMeta=new style_meta_StyleMeta(this._descriptor.__styleMeta),this._symbolizeAs=new symbolize_as_property_SymbolizeAsProperty(this._descriptor.properties[m.Ib.SYMBOLIZE_AS].options,m.Ib.SYMBOLIZE_AS),this._lineColor=this._makeColorProperty(this._descriptor.properties[m.Ib.LINE_COLOR],m.Ib.LINE_COLOR,a),this._fillColor=this._makeColorProperty(this._descriptor.properties[m.Ib.FILL_COLOR],m.Ib.FILL_COLOR,a),this._lineWidth=this._makeSizeProperty(this._descriptor.properties[m.Ib.LINE_WIDTH],m.Ib.LINE_WIDTH,this._symbolizeAs.isSymbolizedAsIcon()),this._icon=this._makeIconProperty(this._descriptor.properties[m.Ib.ICON]),this._iconSize=this._makeSizeProperty(this._descriptor.properties[m.Ib.ICON_SIZE],m.Ib.ICON_SIZE,this._symbolizeAs.isSymbolizedAsIcon()),this._iconOrientation=this._makeOrientationProperty(this._descriptor.properties[m.Ib.ICON_ORIENTATION],m.Ib.ICON_ORIENTATION),this._label=this._makeLabelProperty(this._descriptor.properties[m.Ib.LABEL_TEXT]),this._labelZoomRange=new label_zoom_range_property_LabelZoomRangeProperty(this._descriptor.properties[m.Ib.LABEL_ZOOM_RANGE].options,m.Ib.LABEL_ZOOM_RANGE,i.getMinZoom(),i.getMaxZoom()),this._labelSize=this._makeSizeProperty(this._descriptor.properties[m.Ib.LABEL_SIZE],m.Ib.LABEL_SIZE,this._symbolizeAs.isSymbolizedAsIcon()),this._labelColor=this._makeColorProperty(this._descriptor.properties[m.Ib.LABEL_COLOR],m.Ib.LABEL_COLOR,a),this._labelBorderColor=this._makeColorProperty(this._descriptor.properties[m.Ib.LABEL_BORDER_COLOR],m.Ib.LABEL_BORDER_COLOR,a),this._labelBorderSize=new label_border_size_property_LabelBorderSizeProperty(this._descriptor.properties[m.Ib.LABEL_BORDER_SIZE].options,m.Ib.LABEL_BORDER_SIZE,this._labelSize),this._labelPosition=new label_position_property_LabelPositionProperty(this._descriptor.properties[m.Ib.LABEL_POSITION].options,m.Ib.LABEL_POSITION,this._icon,this._iconSize,this._labelSize,this._symbolizeAs.isSymbolizedAsIcon())}async _updateFieldsInDescriptor(t,e,i,r){const n=this.getPropertiesDescriptor(),a=Object.keys(n).filter((e=>{const i=Kt(n,e);return!!(i&&i.field&&i.field.name)&&!t.some((t=>i&&i.field&&i.field.name===t.getName()))}));let o=!1;const l={...n};return a.forEach((r=>{for(let u=0;u<i.length;u++){const h=i[u],p=t[u];if(!h.isEqual(p)){if(!e.hasFieldForStyle(p,r))return;o=!0,l[r]={type:m.Eb.DYNAMIC,options:{...n[r].options,field:(a=p,c={origin:h.getOrigin(),name:h.getName()},{origin:c.origin,name:a.getName()})}}}}var a,c})),this._deleteFieldsFromDescriptorAndUpdateStyling(l,o,e,r)}async _deleteFieldsFromDescriptorAndUpdateStyling(t,e,i,r){const n={};return Object.keys(t).filter((e=>{const i=Kt(t,e);return i&&i.field&&i.field.name})).forEach((e=>{var a;const o=this.getAllStyleProperties().find((t=>t.getStyleName()===e));if(!o)return;const l=i.getFieldsForStyle(o,this._layer.getSource().isMvt()).filter((t=>!t.isUnsupported));if(0===l.length){const t=Object(W.j)(r);return void(n[e]=t[e])}const c=t[e];if(!c||!c.options)return;const u=null===(a=c.options.field)||void 0===a?void 0:a.name;u&&(l.some((t=>u===t.name))||(n[e]={type:Vt.a.type,options:{...t[e].options}},"field"in n[e].options&&delete n[e].options.field))})),0!==Object.keys(n).length?{hasChanges:!0,nextStyleDescriptor:vector_style_VectorStyle.createDescriptor({...t,...n},this.isTimeAware())}:{hasChanges:e,nextStyleDescriptor:vector_style_VectorStyle.createDescriptor({...t},this.isTimeAware())}}async getDescriptorWithUpdatedStyleProps(t,e,i){const r=await kt(t);return i&&i.length===t.length?await this._updateFieldsInDescriptor(t,r,i,e):await this._deleteFieldsFromDescriptorAndUpdateStyling(this.getPropertiesDescriptor(),!1,r,e)}getType(){return m.Y.VECTOR}getAllStyleProperties(){return[this._symbolizeAs,this._icon,this._lineColor,this._fillColor,this._lineWidth,this._iconSize,this._iconOrientation,this._label,this._labelZoomRange,this._labelSize,this._labelColor,this._labelBorderColor,this._labelBorderSize,this._labelPosition]}_hasBorder(){return this._lineWidth.isDynamic()?this._lineWidth.isComplete():0!==this._lineWidth.getOptions().size}renderEditor(t,e){const i=this.getPropertiesDescriptor(),r=this.getDynamicPropertiesArray().filter((t=>t.isFieldMetaEnabled())),n={};return this.getAllStyleProperties().forEach((t=>{n[t.getStyleName()]=t})),Object(g.jsx)(vector_style_editor_VectorStyleEditor,{handlePropertyChange:(e,r)=>{i[e]=r;const n=vector_style_VectorStyle.createDescriptor(i,this.isTimeAware());t(n)},styleProperties:n,layer:this._layer,isPointsOnly:this.getIsPointsOnly(),isLinesOnly:this._getIsLinesOnly(),onIsTimeAwareChange:e=>{const r=vector_style_VectorStyle.createDescriptor(i,e);t(r)},onCustomIconsChange:e,isTimeAware:this.isTimeAware(),showIsTimeAware:r.length>0,customIcons:this._customIcons,hasBorder:this._hasBorder()})}getSourceFieldNames(){const t=[];return this.getDynamicPropertiesArray().forEach((e=>{e.getFieldOrigin()===m.D.SOURCE&&t.push(e.getFieldName())})),t}isTimeAware(){return this._descriptor.isTimeAware}getPropertiesDescriptor(){return this._descriptor.properties||{}}getDynamicPropertiesArray(){return this.getAllStyleProperties().filter((t=>t.isDynamic()&&t.isComplete()))}_getDynamicPropertyByFieldName(t){return this.getDynamicPropertiesArray().find((e=>t===e.getFieldName()))}getStyleMeta(){return this._styleMeta}getIconSvg(t){const e=this._getIconMeta(t);return e?e.svg:void 0}_getSymbolId(){return this.arePointsSymbolizedAsCircles()||this._icon.isDynamic()?void 0:this._icon.getOptions().value}_getIconMeta(t){const e=this._customIcons.find((({symbolId:e})=>e===t));if(e)return{...e,iconSource:m.N.CUSTOM};const i=Object(lt.i)(t);return i?{...i,iconSource:m.N.MAKI}:void 0}getPrimaryColor(){const t=this._getIsLinesOnly()?m.Ib.LINE_COLOR:m.Ib.FILL_COLOR;return Yt(this._descriptor.properties[t],"grey")}getIcon(t){const e=this._getIsLinesOnly(),i=this.getIsPointsOnly();let r;e?r=Yt(this._descriptor.properties[m.Ib.LINE_COLOR],"grey"):this._hasBorder()&&(r=Yt(this._descriptor.properties[m.Ib.LINE_COLOR],"none"));const n=e?void 0:Yt(this._descriptor.properties[m.Ib.FILL_COLOR],"grey"),a=t?{borderColor:this.getPrimaryColor(),borderStyle:"dashed",borderWidth:"1px"}:{},o=this._getSymbolId(),l=o?this.getIconSvg(o):void 0;return Object(g.jsx)(Rt,{borderStyle:a,isPointsOnly:i,isLinesOnly:e,strokeColor:r,fillColor:n,symbolId:o,svg:l})}isUsingCustomIcon(t){if(this._icon.isDynamic()){const{customIconStops:e}=this._icon.getOptions();return!!e&&e.some((({icon:e})=>e===t))}const{value:e}=this._icon.getOptions();return e===t}async hasLegendDetails(){return this._getLegendDetailStyleProperties().length>0}renderLegendDetails(){const t=this._getSymbolId(),e=t?this.getIconSvg(t):void 0;return Object(g.jsx)(Nt,{masks:this._layer.getMasks(),styles:this._getLegendDetailStyleProperties(),isPointsOnly:this.getIsPointsOnly(),isLinesOnly:this._getIsLinesOnly(),symbolId:t,svg:e})}clearFeatureState(t,e,i){const r={source:"",id:void 0};for(let n=0;n<t.features.length;n++){const a=t.features[n];r.source=i,r.id=a.id,e.removeFeatureState(r)}}setFeatureStateAndStyleProps(t,e,i){if(!t)return!1;const r=this.getDynamicPropertiesArray();if(0===r.length)return!1;let n=!1;for(let a=0;a<r.length;a++)r[a].enrichGeoJsonAndMbFeatureState(t,e,i)||(n=!0);return n}arePointsSymbolizedAsCircles(){return!this._symbolizeAs.isSymbolizedAsIcon()}hasLabels(){return Object(V.g)(this._label)}setMBPaintProperties({alpha:t,mbMap:e,fillLayerId:i,lineLayerId:r}){this._fillColor.syncFillColorWithMb(i,e,t),this._lineColor.syncLineColorWithMb(r,e,t),this._lineWidth.syncLineWidthWithMb(r,e)}setMBPaintPropertiesForPoints({alpha:t,mbMap:e,pointLayerId:i}){this._fillColor.syncCircleColorWithMb(i,e,t),this._lineColor.syncCircleStrokeWithMb(i,e,t);const r=!this._iconSize.isDynamic()&&0===this._iconSize.getOptions().size;this._lineWidth.syncCircleStrokeWidthWithMb(i,e,r),this._iconSize.syncCircleRadiusWithMb(i,e)}setMBPropertiesForLabelText({alpha:t,mbMap:e,textLayerId:i}){this._label.syncTextFieldWithMb(i,e),this._labelZoomRange.syncLabelZoomRange(i,e),this._labelColor.syncLabelColorWithMb(i,e,t),this._labelSize.syncLabelSizeWithMb(i,e),this._labelBorderSize.syncLabelBorderSizeWithMb(i,e),this._labelPosition.syncLabelPositionWithMb(i,e),this._labelBorderColor.syncLabelBorderColorWithMb(i,e)}setMBSymbolPropertiesForPoints({mbMap:t,symbolLayerId:e,alpha:i}){t.setLayoutProperty(e,"icon-ignore-placement",!0),t.setPaintProperty(e,"icon-opacity",i),t.setLayoutProperty(e,"icon-allow-overlap",!0),this._icon.syncIconWithMb(e,t),this._fillColor.syncIconColorWithMb(e,t),this._lineColor.syncHaloBorderColorWithMb(e,t),this._lineWidth.syncHaloWidthWithMb(e,t),this._iconSize.syncIconSizeWithMb(e,t),this._iconOrientation.syncIconRotationWithMb(e,t)}_makeField(t){if(!t||!t.name)return null;if(t.origin===m.D.SOURCE)return this._source.getFieldByName(t.name);if(t.origin===m.D.JOIN){const e=this._layer.getValidJoins().find((e=>!!e.getRightJoinSource().getFieldByName(t.name)));return e?e.getRightJoinSource().getFieldByName(t.name):null}throw new Error(`Unknown origin-type ${t.origin}`)}_makeSizeProperty(t,e,i){if(t&&t.options){if(t.type===static_style_property_StaticStyleProperty.type)return new static_size_property_StaticSizeProperty(t.options,e);if(t.type===Vt.a.type){const r=t.options,n=this._makeField(r.field);return new dynamic_size_property_DynamicSizeProperty(r,e,n,this._layer,this._getFieldFormatter,i)}throw new Error(`${t} not implemented`)}return new static_size_property_StaticSizeProperty({size:0},e)}_makeColorProperty(t,e,i){if(t&&t.options){if(t.type===static_style_property_StaticStyleProperty.type)return new static_color_property_StaticColorProperty(t.options,e);if(t.type===Vt.a.type){const r=t.options,n=this._makeField(r.field);return new dynamic_color_property_DynamicColorProperty(r,e,n,this._layer,this._getFieldFormatter,i)}throw new Error(`${t} not implemented`)}return new static_color_property_StaticColorProperty({color:""},e)}_makeOrientationProperty(t,e){if(t&&t.options){if(t.type===static_style_property_StaticStyleProperty.type)return new static_orientation_property_StaticOrientationProperty(t.options,e);if(t.type===Vt.a.type){const i=t.options,r=this._makeField(i.field);return new dynamic_orientation_property_DynamicOrientationProperty(i,e,r,this._layer,this._getFieldFormatter)}throw new Error(`${t} not implemented`)}return new static_orientation_property_StaticOrientationProperty({orientation:0},e)}_makeLabelProperty(t){if(t&&t.options){if(t.type===static_style_property_StaticStyleProperty.type)return new static_text_property_StaticTextProperty(t.options,m.Ib.LABEL_TEXT);if(t.type===Vt.a.type){const e=t.options,i=this._makeField(e.field);return new dynamic_text_property_DynamicTextProperty(e,m.Ib.LABEL_TEXT,i,this._layer,this._getFieldFormatter)}throw new Error(`${t} not implemented`)}return new static_text_property_StaticTextProperty({value:""},m.Ib.LABEL_TEXT)}_makeIconProperty(t){if(t&&t.options){if(t.type===static_style_property_StaticStyleProperty.type){const{value:e}={...t.options},i=this._getIconMeta(e);let r,n,a;return i&&({svg:r,label:n,iconSource:a}=i),new static_icon_property_StaticIconProperty({value:e,svg:r,label:n,iconSource:a},m.Ib.ICON)}if(t.type===Vt.a.type){const e={...t.options};e.customIconStops&&e.customIconStops.forEach((t=>{const e=this._getIconMeta(t.icon);e&&(t.iconSource=e.iconSource)}));const i=this._makeField(e.field);return new dynamic_icon_property_DynamicIconProperty(e,m.Ib.ICON,i,this._layer,this._getFieldFormatter)}throw new Error(`${t} not implemented`)}return new static_icon_property_StaticIconProperty({value:m.r},m.Ib.ICON)}}function Kt(t,e){if(!t[e])return null;const i=t[e];return i&&"type"in i&&i.type===m.Eb.DYNAMIC&&i.options?i.options:null}},,,,function(t,e,i){"use strict";var r,n=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function o(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},r=[],n=0;n<t.length;n++){var l=t[n],c=e.base?l[0]+e.base:l[0],u=i[c]||0,h="".concat(c," ").concat(u);i[c]=u+1;var p=o(h),d={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(a[p].references++,a[p].updater(d)):a.push({identifier:h,updater:g(d,e),references:1}),r.push(h)}return r}function c(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var a=i.nc;a&&(r.nonce=a)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var o=n(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var u,h=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function p(t,e,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=h(e,n);else{var a=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function d(t,e,i){var r=i.css,n=i.media,a=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var f=null,m=0;function g(t,e){var i,r,n;if(e.singleton){var a=m++;i=f||(f=c(e)),r=p.bind(null,i,a,!1),n=p.bind(null,i,a,!0)}else i=c(e),r=d.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<i.length;r++){var n=o(i[r]);a[n].references--}for(var c=l(t,e),u=0;u<i.length;u++){var h=o(i[u]);0===a[h].references&&(a[h].updater(),a.splice(h,1))}i=c}}}},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i,r,n,a=t[1]||"",o=t[3];if(!o)return a;if(e&&"function"==typeof btoa){var l=(i=o,r=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(n," */")),c=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[a].concat(c).concat([l]).join("\n")}return[a].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,r){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(n[o]=!0)}for(var l=0;l<t.length;l++){var c=[].concat(t[l]);r&&n[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),e.push(c))}},e}},,function(t,e,i){(function(){var e,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_,v,x={}.hasOwnProperty;v=i(119),_=v.isObject,y=v.isFunction,g=v.isEmpty,m=v.getValue,u=null,n=null,a=null,o=null,l=null,d=null,f=null,p=null,c=null,r=null,h=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,u||(u=i(221),n=i(223),a=i(224),o=i(225),l=i(226),d=i(231),f=i(232),p=i(233),c=i(310),r=i(96),h=i(508),i(222),e=i(509))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new h(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,i,n,a;if(this.nodeType===r.Element||this.nodeType===r.DocumentFragment){for(a="",e=0,i=(n=this.children).length;e<i;e++)(t=n[e]).textContent&&(a+=t.textContent);return a}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,i,r,n,a;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),a=[],i=0,r=(n=this.children).length;i<r;i++)e=n[i],a.push(e.setParent(this));return a},t.prototype.element=function(t,e,i){var r,n,a,o,l,c,u,h,p,d,f;if(c=null,null===e&&null==i&&(e=(p=[{},null])[0],i=p[1]),null==e&&(e={}),e=m(e),_(e)||(i=(d=[e,i])[0],e=d[1]),null!=t&&(t=m(t)),Array.isArray(t))for(a=0,u=t.length;a<u;a++)n=t[a],c=this.element(n);else if(y(t))c=this.element(t.apply());else if(_(t)){for(l in t)if(x.call(t,l))if(f=t[l],y(f)&&(f=f.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===l.indexOf(this.stringify.convertAttKey))c=this.attribute(l.substr(this.stringify.convertAttKey.length),f);else if(!this.options.separateArrayItems&&Array.isArray(f)&&g(f))c=this.dummy();else if(_(f)&&g(f))c=this.element(l);else if(this.options.keepNullNodes||null!=f)if(!this.options.separateArrayItems&&Array.isArray(f))for(o=0,h=f.length;o<h;o++)n=f[o],(r={})[l]=n,c=this.element(r);else _(f)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===l.indexOf(this.stringify.convertTextKey)?c=this.element(f):(c=this.element(l)).element(f):c=this.element(l,f);else c=this.dummy()}else c=this.options.keepNullNodes||null!==i?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(i):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(i):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(i):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(i):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),i):this.node(t,e,i):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return c},t.prototype.insertBefore=function(t,e,i){var r,n,a,o,l;if(null!=t?t.type:void 0)return o=e,(a=t).setParent(this),o?(n=children.indexOf(o),l=children.splice(n),children.push(a),Array.prototype.push.apply(children,l)):children.push(a),a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),l=this.parent.children.splice(n),r=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,l),r},t.prototype.insertAfter=function(t,e,i){var r,n,a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),a=this.parent.children.splice(n+1),r=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,a),r},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,i){var r,n;return null!=t&&(t=m(t)),e||(e={}),e=m(e),_(e)||(i=(n=[e,i])[0],e=n[1]),r=new u(this,t,e),null!=i&&r.text(i),this.children.push(r),r},t.prototype.text=function(t){var e;return _(t)&&this.element(t),e=new f(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new n(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new a(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.commentAfter=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.raw=function(t){var e;return e=new d(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new c(this)},t.prototype.instruction=function(t,e){var i,r,n,a,o;if(null!=t&&(t=m(t)),null!=e&&(e=m(e)),Array.isArray(t))for(a=0,o=t.length;a<o;a++)i=t[a],this.instruction(i);else if(_(t))for(i in t)x.call(t,i)&&(r=t[i],this.instruction(i,r));else y(e)&&(e=e.apply()),n=new p(this,t,e),this.children.push(n);return this},t.prototype.instructionBefore=function(t,e){var i,r;return i=this.parent.children.indexOf(this),r=this.parent.children.splice(i),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.instructionAfter=function(t,e){var i,r;return i=this.parent.children.indexOf(this),r=this.parent.children.splice(i+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.declaration=function(t,e,i){var n,a;return n=this.document(),a=new o(n,t,e,i),0===n.children.length?n.children.unshift(a):n.children[0].type===r.Declaration?n.children[0]=a:n.children.unshift(a),n.root()||n},t.prototype.dtd=function(t,e){var i,n,a,o,c,u,h,p,d;for(i=this.document(),n=new l(i,t,e),a=o=0,u=(p=i.children).length;o<u;a=++o)if(p[a].type===r.DocType)return i.children[a]=n,n;for(a=c=0,h=(d=i.children).length;c<h;a=++c)if(d[a].isRoot)return i.children.splice(a,0,n),n;return i.children.push(n),n},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===r.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===r.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,i;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(i=this.parent)?i.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,i){return this.element(t,e,i)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var i,r;return(i=this)===t?0:this.document()!==t.document()?(r=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?r|=e.Preceding:r|=e.Following,r):i.isAncestor(t)?e.Contains|e.Preceding:i.isDescendant(t)?e.Contains|e.Following:i.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,i,r;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=i=0,r=this.children.length-1;0<=r?i<=r:i>=r;e=0<=r?++i:--i)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,i,r,n;for(i=0,r=(n=this.children).length;i<r;i++){if(t===(e=n[i]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e<i},t.prototype.isFollowing=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e>i},t.prototype.treePosition=function(t){var e,i;return i=0,e=!1,this.foreachTreeNode(this.document(),(function(r){if(i++,!e&&r===t)return e=!0})),e?i:-1},t.prototype.foreachTreeNode=function(t,e){var i,r,n,a,o;for(t||(t=this.document()),r=0,n=(a=t.children).length;r<n;r++){if(o=e(i=a[r]))return o;if(o=this.foreachTreeNode(i,e))return o}},t}()}).call(this)},function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var r=i(18),n=i.n(r),a=i(53),o=i.n(a),l=i(2),c=i.n(l),u=i(4),h=i(14),p=i(633),d=i(652),f=i(634),m=i(0),g={name:"1t9g6or",styles:"position:absolute;width:100%;top:0;bottom:0;left:0;right:0"};function y({fields:t,getFieldDisabledReason:e,isFieldDisabled:i,onChange:r,value:a,...l}){const y=[];if(a&&t){const e=t.find((t=>t.name===a));e&&y.push({value:e,label:e.displayName?e.displayName:e.name})}const _=function(t,e,i){return t?t.map((t=>{const r=t.type?Object(u.jsx)(p.a,{type:t.type,fill:"none",className:"eui-alignMiddle"}):null,n={value:t,label:t.displayName?t.displayName:t.name,prepend:r,name:t.name};if(e&&e(t)){n.disabled=!0;const t=n.disabled&&i?i(n.value):null;t&&(n.prepend=Object(u.jsx)(c.a.Fragment,null,r,Object(u.jsx)(h.EuiToolTip,{position:"left",content:t,anchorProps:{css:g}},Object(u.jsx)("div",null))))}return n})).sort(((t,e)=>t.label.toLowerCase().localeCompare(e.label.toLowerCase()))):[]}(t,i,e),v=Object(d.a)(_,["label"]);return Object(u.jsx)(h.EuiComboBox,n()({singleSelection:!0,options:_,selectedOptions:y,onChange:t=>{r(o.a.get(t,"0.value.name"))},isDisabled:!t||0===t.length,truncationProps:m.lb,inputPopoverProps:{panelMinWidth:v},optionMatcher:f.a},l))}},,,,,,function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return l})),i.d(e,"e",(function(){return c})),i.d(e,"f",(function(){return u})),i.d(e,"d",(function(){return h})),i.d(e,"c",(function(){return p})),i.d(e,"h",(function(){return d})),i.d(e,"g",(function(){return f}));var r=i(63),n=i(3),a=i(0);const o=n.i18n.translate("xpack.maps.styles.categorical.otherCategoryLabel",{defaultMessage:"Other"}),l=r.euiThemeVars.euiColorLightShade;function c(t,e){return`${u(e)}__${t}`}function u(t){return`__kbn__dynamic__${t}`}function h(t){if("number"!=typeof t)return t;let e=0,i=10;for(;t<i&&e<8;)e++,i/=10;return 0===e?Math.round(t):parseFloat(t.toFixed(e+1))}function p({categories:t,paletteValues:e}){const i=[];let r=null;if(t.length&&e.length){const n=Math.min(e.length,t.length+1);r=e[n-1];for(let r=0;r<n-1;r++)i.push({stop:t[r].key,style:e[r],iconSource:a.N.MAKI})}return{stops:i,fallbackSymbolId:r}}function d({lookupFunction:t,fieldName:e,minValue:i,maxValue:r,fallback:n}){return["coalesce",["case",["==",[t,e],null],n,["max",["min",["to-number",[t,e]],r],i]],n]}function f(t){return t.isDynamic()?t.isComplete():null!=t.getOptions().value&&t.getOptions().value.length>0}},function(t,e,i){"use strict";i.d(e,"a",(function(){return g})),i.d(e,"c",(function(){return y})),i.d(e,"e",(function(){return _})),i.d(e,"i",(function(){return v})),i.d(e,"j",(function(){return x})),i.d(e,"f",(function(){return b})),i.d(e,"d",(function(){return w})),i.d(e,"k",(function(){return C})),i.d(e,"b",(function(){return M})),i.d(e,"h",(function(){return T})),i.d(e,"g",(function(){return E})),i(2);var r=i(306),n=i.n(r),a=i(56),o=i(530),l=i(528),c=i.n(l),u=i(0),h=i(319),p=i(184),d=i(5),f=i(320),m=i(4);const g=Math.floor(window.devicePixelRatio*(u.m/u.cb)*.75),y=Object.entries(f.a).map((([t,{svg:e,label:i}])=>({value:t,label:i,svg:e})));async function _({svg:t,renderSize:e=64,cutoff:i=.25,radius:r=.25}){const n=e+12,a=document.createElement("canvas");a.width=n,a.height=n;const l=a.getContext("2d");if(!l)return null;const u=o.Canvg.fromString(l,t,{ignoreDimensions:!0,offsetX:1.5,offsetY:1.5});u.resize(n-3,n-3),await u.render();const h=c()(l,{channel:3,cutoff:i,radius:r*n}),p=document.createElement("canvas");p.width=n,p.height=n;const d=p.getContext("2d");if(!d)return null;const f=d.createImageData(n,n);for(let t=0;t<n;t++)for(let e=0;e<n;e++)f.data[e*n*4+4*t+0]=0,f.data[e*n*4+4*t+1]=0,f.data[e*n*4+4*t+2]=0,f.data[e*n*4+4*t+3]=255*h[e*n+t];return f}function v(t){return null===f.a||void 0===f.a?void 0:f.a[t]}function x(t){switch(t){case"embassy":case"marker":case"marker-stroked":return"bottom";default:return"center"}}function b(){return`${u.l}${Object(a.v4)()}`}function w(t){const e=window.URL||window.webkitURL||window,i=new Blob([t],{type:"image/svg+xml"});return e.createObjectURL(i)}async function C(t,e,i){const r=await Object(h.a)(t);return r.svg.style=`\n    svg * {\n      ${e?`fill: ${e}`:"#000"} !important;\n      ${i?`stroke: ${i}`:"#000"} !important;\n      stroke-width: 1 !important;\n      vector-effect: non-scaling-stroke !important;\n    }\n  `,(new n.a.Builder).buildObject(r)}const S=[{id:"filledShapes",icons:["circle","marker","square","star","triangle","hospital"]},{id:"hollowShapes",icons:["circle-stroked","marker-stroked","square-stroked","star-stroked","triangle-stroked"]}],M=[];function T(){const t=Object(d.z)();return S.map((({id:e,icons:i})=>{const r=i.map((e=>Object(m.jsx)("div",{style:{width:"10%",position:"relative",height:"100%",display:"inline-block",paddingTop:"4px"},key:e},Object(m.jsx)(p.a,{className:"mapIcon",symbolId:e,fill:t?"rgb(223, 229, 239)":"rgb(52, 55, 65)",svg:v(e).svg}))));return{value:e,inputDisplay:Object(m.jsx)("div",null,r)}}))}function E(t){const e=S.find((({id:e})=>e===t));return e?[...e.icons]:[]}S.forEach((t=>{t.icons.forEach((t=>{M.includes(t)||M.push(t)}))}))},,,,function(t,e){(function(){var e,i,r,n,a,o,l,c=[].slice,u={}.hasOwnProperty;e=function(){var t,e,i,r,n,o;if(o=arguments[0],n=2<=arguments.length?c.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(t=0,i=n.length;t<i;t++)if(null!=(r=n[t]))for(e in r)u.call(r,e)&&(o[e]=r[e]);return o},a=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},o=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},r=function(t){return a(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},n=function(t){var e;if(r(t))return!t.length;for(e in t)if(u.call(t,e))return!1;return!0},l=function(t){var e,i;return o(t)&&(i=Object.getPrototypeOf(t))&&(e=i.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},i=function(t){return a(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=a,t.exports.isObject=o,t.exports.isArray=r,t.exports.isEmpty=n,t.exports.isPlainObject=l,t.exports.getValue=i}).call(this)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a}));var r=i(0);function n({aggType:t,aggFieldName:e,rightSourceId:i}){const n=t!==r.b.COUNT?`${t}${r.a}${e}`:t;return`${r.T}${n}__${i}`}function a({aggType:t,aggFieldName:e}){return t!==r.b.COUNT?`${t}${r.a}${e}`:r.k}},,function(t,e,i){"use strict";i.d(e,"a",(function(){return es_agg_source_AbstractESAggSource})),i.d(e,"b",(function(){return x})),i.d(e,"c",(function(){return _})),i(211);var r=i(6),n=i.n(r),a=i(3),o=i(103),l=i(0),c=i(153),u=i(125);class top_term_percentage_field_TopTermPercentageField{constructor(t){n()(this,"_topTermAggField",void 0),this._topTermAggField=t}supportsFieldMetaFromEs(){return!1}supportsFieldMetaFromLocalData(){return!this.getSource().isMvt()}getSource(){return this._topTermAggField.getSource()}getMbFieldName(){return this.getName()}getOrigin(){return this._topTermAggField.getOrigin()}getName(){return`${this._topTermAggField.getName()}${l.Gb}`}getRootName(){return""}async getLabel(){return`${await this._topTermAggField.getLabel()}%`}isValid(){return this._topTermAggField.isValid()}async getDataType(){return"number"}async createTooltipProperty(t){return new u.a(this.getName(),await this.getLabel(),t)}getValueAggDsl(){return null}getBucketCount(){return 0}isCount(){return!1}async getExtendedStatsFieldMetaRequest(){return null}async getPercentilesFieldMetaRequest(t){return null}async getCategoricalFieldMetaRequest(){return null}canValueBeFormatted(){return!1}isEqual(t){return t.getName()===this.getName()}pluckRangeFromTileMetaFeature(t){return null}getMask(){}}var h=i(324);class es_agg_tooltip_property_ESAggTooltipProperty extends h.a{constructor(t,e,i,r,a){super(t,e,i,a),n()(this,"_aggType",void 0),n()(this,"_aggField",void 0),this._aggType=r,this._aggField=i}getHtmlDisplayValue(){const t=this.getRawValue();return void 0!==t&&this._aggField.isCount()?parseInt(t,10).toLocaleString():super.getHtmlDisplayValue()}isFilterable(){return this._aggType===l.b.TERMS&&super.isFilterable()}}var p=i(133);class count_agg_field_CountAggField{constructor({label:t,source:e,origin:i,mask:r}){n()(this,"_source",void 0),n()(this,"_origin",void 0),n()(this,"_label",void 0),n()(this,"_mask",void 0),this._source=e,this._origin=i,this._label=t,this._mask=r}supportsFieldMetaFromEs(){return!1}supportsFieldMetaFromLocalData(){return!0}_getAggType(){return l.b.COUNT}getSource(){return this._source}getOrigin(){return this._origin}getName(){return this._source.getAggKey(this._getAggType(),this.getRootName())}getMbFieldName(){return this._source.isMvt()?"_count":this.getName()}getRootName(){return""}async getLabel(){return this._label?this._label:await this._source.getAggLabel(l.b.COUNT,"")}isValid(){return!0}async getDataType(){return"number"}async createTooltipProperty(t){const e=await this._source.getIndexPattern(),i=new u.a(this.getName(),await this.getLabel(),t);return new es_agg_tooltip_property_ESAggTooltipProperty(i,e,this,this._getAggType(),this._source.getApplyGlobalQuery())}getValueAggDsl(t){return null}getBucketCount(){return 0}isCount(){return!0}canValueBeFormatted(){return!1}async getExtendedStatsFieldMetaRequest(){return null}async getPercentilesFieldMetaRequest(t){return null}async getCategoricalFieldMetaRequest(t){return null}isEqual(t){return t.getName()===this.getName()}pluckRangeFromTileMetaFeature(t){return Object(p.d)(t,"_count")}getMask(){return this._mask}}var d=i(241),f=i(93);class agg_field_AggField extends count_agg_field_CountAggField{constructor(t){super(t),n()(this,"_esDocField",void 0),n()(this,"_aggType",void 0),this._esDocField=t.esDocField,this._aggType=t.aggType}supportsFieldMetaFromEs(){return!Object(d.a)(this._getAggType())}supportsFieldMetaFromLocalData(){return!this._source.isMvt()||"number"===this._getDataTypeSynchronous()}isValid(){return!!this._esDocField}getMbFieldName(){return this._source.isMvt()?this.getName()+".value":this.getName()}canValueBeFormatted(){return this._getAggType()!==l.b.UNIQUE_COUNT}isCount(){return this._getAggType()===l.b.UNIQUE_COUNT}_getAggType(){return this._aggType}getValueAggDsl(t){const e=Object(f.l)(t,this.getRootName()),i=this._getAggType(),r=i===l.b.TERMS?{size:1,shard_size:5}:{};return{[i]:Object(f.a)(r,e)}}getRootName(){return this._esDocField?this._esDocField.getName():""}async getLabel(){return this._label?this._label:await this._source.getAggLabel(this._aggType,this._esDocField?await this._esDocField.getLabel():"")}_getDataTypeSynchronous(){return this._getAggType()===l.b.TERMS?"string":"number"}async getDataType(){return this._getDataTypeSynchronous()}getBucketCount(){return this._getAggType()===l.b.TERMS?5:0}async getExtendedStatsFieldMetaRequest(){return this._esDocField?await this._esDocField.getExtendedStatsFieldMetaRequest():null}async getPercentilesFieldMetaRequest(t){return this._esDocField?await this._esDocField.getPercentilesFieldMetaRequest(t):null}async getCategoricalFieldMetaRequest(t){return this._esDocField?await this._esDocField.getCategoricalFieldMetaRequest(t):null}pluckRangeFromTileMetaFeature(t){return Object(p.d)(t,this.getName())}}var m=i(322);class percentile_agg_field_PercentileAggField extends agg_field_AggField{constructor(t){super({...t,aggType:l.b.PERCENTILE}),n()(this,"_percentile",void 0),this._percentile=t.percentile}supportsFieldMetaFromEs(){return!0}supportsFieldMetaFromLocalData(){return!0}getMbFieldName(){return this._source.isMvt()?this.getName()+`.values.${this._percentile}${Number.isInteger(this._percentile)?".0":""}`:this.getName()}canValueBeFormatted(){return!0}async getLabel(){if(this._label)return this._label;if(50===this._percentile)return`${a.i18n.translate("xpack.maps.fields.percentileMedianLabek",{defaultMessage:"median"})} ${this.getRootName()}`;const t=Object(m.a)(this._percentile);return`${this._percentile}${t} ${await this._source.getAggLabel(this._getAggType(),this.getRootName())}`}getName(){return`${super.getName()}_${this._percentile}`}getValueAggDsl(t){const e=Object(f.l)(t,this.getRootName()),i=Object(f.a)({},e);return i.percents=[this._percentile],{percentiles:i}}}function g(t,e,i){let r;r=t.type===l.b.COUNT?new count_agg_field_CountAggField({label:t.label,source:e,origin:i,mask:t.mask}):t.type===l.b.PERCENTILE?new percentile_agg_field_PercentileAggField({label:t.label,esDocField:"field"in t&&t.field?new c.a({fieldName:t.field,source:e,origin:i}):void 0,percentile:"percentile"in t&&"number"==typeof t.percentile?t.percentile:l.v,source:e,origin:i,mask:t.mask}):new agg_field_AggField({label:t.label,esDocField:"field"in t&&t.field?new c.a({fieldName:t.field,source:e,origin:i}):void 0,aggType:t.type,source:e,origin:i,mask:t.mask});const n=[r];return"field"in t&&t.type===l.b.TERMS&&n.push(new top_term_percentage_field_TopTermPercentageField(r)),n}var y=i(120);function _(t){switch(t){case l.b.AVG:return a.i18n.translate("xpack.maps.aggType.averageLabel",{defaultMessage:"average"});case l.b.COUNT:return a.i18n.translate("xpack.maps.aggType.countLabel",{defaultMessage:"count"});case l.b.MAX:return a.i18n.translate("xpack.maps.aggType.maximumLabel",{defaultMessage:"max"});case l.b.MIN:return a.i18n.translate("xpack.maps.aggType.minimumLabel",{defaultMessage:"min"});case l.b.PERCENTILE:return a.i18n.translate("xpack.maps.aggType.percentileLabel",{defaultMessage:"percentile"});case l.b.SUM:return a.i18n.translate("xpack.maps.aggType.sumLabel",{defaultMessage:"sum"});case l.b.TERMS:return a.i18n.translate("xpack.maps.aggType.topTermLabel",{defaultMessage:"top term"});case l.b.UNIQUE_COUNT:return a.i18n.translate("xpack.maps.aggType.cardinalityTermLabel",{defaultMessage:"unique count"});default:return t}}var v=i(129);const x={type:l.b.COUNT};class es_agg_source_AbstractESAggSource extends o.a{static createDescriptor(t){return{...o.a.createDescriptor(t),type:t.type?t.type:"",metrics:t.metrics&&t.metrics.length>0?t.metrics:[x]}}constructor(t){super(t),n()(this,"_metricFields",void 0),this._metricFields=[],t.metrics&&t.metrics.forEach((t=>{this._metricFields.push(...g(t,this,this.getOriginForField()))}))}getBucketsName(){return v.c}getFieldByName(t){return this.getMetricFieldForName(t)}createField({fieldName:t}){throw new Error("Cannot create a new field from just a fieldname for an es_agg_source.")}getMetricFieldForName(t){return this.getMetricFields().find((e=>e.getName()===t))||null}getOriginForField(){return l.D.SOURCE}getMetricFields(){const t=this._metricFields.filter((t=>t.isValid()));return 0===t.length?g({type:l.b.COUNT},this,this.getOriginForField()):t}getAggKey(t,e){return Object(y.b)({aggType:t,aggFieldName:e})}async getAggLabel(t,e){switch(t){case l.b.COUNT:return _(t);case l.b.TERMS:return a.i18n.translate("xpack.maps.source.esAggSource.topTermLabel",{defaultMessage:"top {fieldLabel}",values:{fieldLabel:e}});default:return`${_(t)} ${e}`}}async getFields(){return this.getMetricFields()}getValueAggsDsl(t,e){const i={};return this.getMetricFields().filter((t=>!e||e(t))).forEach((e=>{e.getValueAggDsl(t)&&(i[e.getName()]=e.getValueAggDsl(t))})),i}async getTooltipProperties(t){const e=await this.getFields(),i=[];return e.forEach((e=>{let r;for(const i in t)if(t.hasOwnProperty(i)&&e.getMbFieldName()===i){r=t[i];break}const n=e.createTooltipProperty(r);i.push(n)})),await Promise.all(i)}isGeoGridPrecisionAware(){return!1}isFieldAware(){return!1}getSyncMeta(t){return{metrics:this.getMetricFields().map((t=>t.getName()))}}getGeoGridPrecision(t){return 0}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return H})),i.d(e,"c",(function(){return q})),i.d(e,"a",(function(){return es_geo_grid_source_ESGeoGridSource}));var r=i(6),n=i.n(r),a=i(2),o=i.n(a),l=i(53),c=i.n(l),u=i(3),h=i(60),p=i(346),d=i(58),f=i(93),m=i(0),g=i(146);const y=["key",m.G];function _(t,e){return v(t,e,(t=>c.a.get(t,"aggregations.compositeSplit.buckets",[])),(t=>t.key[m.I]))}function v(t,e,i,r){const n=[],a=i(t);for(let t=0;t<a.length;t++){const i=a[t],o=r(i);n.push({type:"Feature",geometry:x({gridKey:o,[m.G]:i[m.G],renderAs:e}),id:o,properties:Object(f.j)(i,y)})}return n}function x({gridKey:t,gridCentroid:e,renderAs:i}){const{top:r,bottom:n,right:a,left:o}=Object(g.b)(t);return i===m.ub.GRID?{type:"Polygon",coordinates:[[[a,r],[o,r],[o,n],[a,n],[a,r]]]}:{type:"Point",coordinates:[Object(f.d)(e.location.lon,o,a),Object(f.d)(e.location.lat,n,r)]}}var b=i(56),w=i(54),C=i(14),S=i(28),M=i(92),T=i(174),E=i(5);function A(t,e){return t===m.ub.HEATMAP||t===m.ub.HEX||e===m.L.SUPER_FINE}var I=i(4);function P(t){return t.type===m.b.TERMS}class resolution_editor_ResolutionEditor extends a.Component{constructor(...t){super(...t),n()(this,"state",{showModal:!1}),n()(this,"_onResolutionChange",(t=>{const e=this._sliderValueToResolution(parseInt(t.currentTarget.value,10));A(this.props.renderAs,e)&&this.props.metrics.find(P)?this.setState({showModal:!0}):this.props.onChange(e,this.props.metrics)})),n()(this,"_closeModal",(()=>{this.setState({showModal:!1})})),n()(this,"_acceptModal",(()=>{this._closeModal();const t=this.props.metrics.filter((t=>!P(t)));this.props.onChange(m.L.SUPER_FINE,t.length?t:[{type:m.b.COUNT}])}))}_getScale(){return this.props.renderAs===m.ub.HEX?{[m.L.SUPER_FINE]:3,[m.L.MOST_FINE]:2,[m.L.FINE]:2,[m.L.COARSE]:1}:{[m.L.SUPER_FINE]:4,[m.L.MOST_FINE]:3,[m.L.FINE]:2,[m.L.COARSE]:1}}_getTicks(){const t=this._getScale(),e=[{label:Object(I.jsx)("span",null," "),value:t[m.L.FINE]}];return t[m.L.FINE]!==t[m.L.MOST_FINE]&&e.push({label:Object(I.jsx)("span",null," "),value:t[m.L.MOST_FINE]}),[{label:u.i18n.translate("xpack.maps.source.esGrid.lowLabel",{defaultMessage:"low"}),value:t[m.L.COARSE]},...e,{label:u.i18n.translate("xpack.maps.source.esGrid.highLabel",{defaultMessage:"high"}),value:t[m.L.SUPER_FINE]}]}_resolutionToSliderValue(t){return this._getScale()[t]}_sliderValueToResolution(t){const e=this._getScale();return Object.keys(e).find((i=>e[i]===t))||m.L.COARSE}_renderModal(){return this.state.showModal?Object(I.jsx)(C.EuiConfirmModal,{title:u.i18n.translate("xpack.maps.source.esGrid.vectorTileModal.title",{defaultMessage:"'Top terms' metrics not supported"}),onCancel:this._closeModal,onConfirm:this._acceptModal,cancelButtonText:u.i18n.translate("xpack.maps.source.esGrid.vectorTileModal.cancelBtnLabel",{defaultMessage:"Cancel"}),confirmButtonText:u.i18n.translate("xpack.maps.source.esGrid.vectorTileModal.confirmBtnLabel",{defaultMessage:"Accept"}),buttonColor:"danger",defaultFocusedButton:"cancel"},Object(I.jsx)("p",null,Object(I.jsx)(w.FormattedMessage,{id:"xpack.maps.source.esGrid.vectorTileModal.message",defaultMessage:"High resolution uses vector tiles from the Elasticsearch vector tile API. Elasticsearch vector tile API does not support 'Top terms' metric. Switching to super fine grid resolution will remove all 'Top terms' metrics from your layer configuration."}))):null}render(){const t=this.props.renderAs!==m.ub.POINT&&this.props.renderAs!==m.ub.GRID||this.props.resolution!==m.L.SUPER_FINE?void 0:u.i18n.translate("xpack.maps.source.esGrid.superFineHelpText",{defaultMessage:"High resolution uses vector tiles."}),e=this._getTicks();return Object(I.jsx)(o.a.Fragment,null,this._renderModal(),Object(I.jsx)(C.EuiFormRow,{label:u.i18n.translate("xpack.maps.geoGrid.resolutionLabel",{defaultMessage:"Resolution"}),helpText:t,display:"columnCompressed"},Object(I.jsx)(C.EuiRange,{value:this._resolutionToSliderValue(this.props.resolution),onChange:this._onResolutionChange,min:1,max:e.length,showTicks:!0,tickInterval:1,ticks:e,compressed:!0})))}}var O=i(241),k=i(253);class update_source_editor_UpdateSourceEditor extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",void 0),n()(this,"state",{fields:[],metricsEditorKey:Object(b.v4)()}),n()(this,"_onMetricsChange",(t=>{this.props.onChange({propName:"metrics",value:t})})),n()(this,"_onResolutionChange",(async(t,e)=>{await this.props.onChange({propName:"metrics",value:e},{propName:"resolution",value:t,newLayerType:this._getNewLayerType(this.props.renderAs,t)}),this.setState({metricsEditorKey:Object(b.v4)()})})),n()(this,"_onRequestTypeSelect",(t=>{this.props.onChange({propName:"requestType",value:t,newLayerType:this._getNewLayerType(t,this.props.resolution)})}))}componentDidMount(){this._isMounted=!0,this._loadFields()}componentWillUnmount(){this._isMounted=!1}async _loadFields(){let t;try{t=await Object(E.w)().get(this.props.indexPatternId)}catch(t){return void(this._isMounted&&this.setState({loadError:Object(M.c)(this.props.indexPatternId)}))}this._isMounted&&this.setState({fields:t.fields.filter((t=>!S.indexPatterns.isNestedField(t)))})}_getNewLayerType(t,e){let i;return i=t===m.ub.HEATMAP?m.Z.HEATMAP:A(t,e)?m.Z.MVT_VECTOR:m.Z.GEOJSON_VECTOR,void 0!==i&&i!==this.props.currentLayerType?i:void 0}_getMetricsFilter(){return this.props.currentLayerType===m.Z.HEATMAP?t=>!!t.value&&Object(O.a)(t.value):t=>t.value!==m.b.TERMS}_renderMetricsPanel(){return Object(I.jsx)(C.EuiPanel,null,Object(I.jsx)(C.EuiTitle,{size:"xs"},Object(I.jsx)("h6",null,Object(I.jsx)(w.FormattedMessage,{id:"xpack.maps.source.esGrid.metricsLabel",defaultMessage:"Metrics"}))),Object(I.jsx)(C.EuiSpacer,{size:"m"}),Object(I.jsx)(T.a,{key:this.state.metricsEditorKey,allowMultipleMetrics:this.props.currentLayerType!==m.Z.HEATMAP,bucketsName:this.props.bucketsName,isJoin:!1,metricsFilter:this._getMetricsFilter(),fields:this.state.fields,metrics:this.props.metrics,onChange:this._onMetricsChange}))}render(){return Object(I.jsx)(a.Fragment,null,this._renderMetricsPanel(),Object(I.jsx)(C.EuiSpacer,{size:"s"}),Object(I.jsx)(C.EuiPanel,null,Object(I.jsx)(C.EuiTitle,{size:"xs"},Object(I.jsx)("h6",null,this.props.currentLayerType===m.Z.HEATMAP?q:H)),Object(I.jsx)(C.EuiSpacer,{size:"m"}),Object(I.jsx)(resolution_editor_ResolutionEditor,{renderAs:this.props.renderAs,resolution:this.props.resolution,onChange:this._onResolutionChange,metrics:this.props.metrics}),Object(I.jsx)(k.a,{isColumnCompressed:!0,renderAs:this.props.renderAs,onChange:this._onRequestTypeSelect})),Object(I.jsx)(C.EuiSpacer,{size:"s"}))}}var D=i(122),F=i(112),z=i(24),j=i(106),N=i(117),B=i(126),V=i(100),U=i(244);const H=u.i18n.translate("xpack.maps.source.esGridClustersTitle",{defaultMessage:"Clusters"}),q=u.i18n.translate("xpack.maps.source.esGridHeatmapTitle",{defaultMessage:"Heat map"});class es_geo_grid_source_ESGeoGridSource extends D.a{static createDescriptor(t){const e=D.a.createDescriptor(t);if(!Object(N.a)(e.geoField))throw new Error("Cannot create an ESGeoGridSourceDescriptor without a geoField");return{...e,type:m.Cb.ES_GEO_GRID,geoField:e.geoField,requestType:t.requestType||m.ub.POINT,resolution:t.resolution?t.resolution:m.L.COARSE}}constructor(t){const e=es_geo_grid_source_ESGeoGridSource.createDescriptor(t);super(e),n()(this,"_descriptor",void 0),this._descriptor=e}getBucketsName(){return this._descriptor.requestType===m.ub.HEX?u.i18n.translate("xpack.maps.source.esGeoGrid.hex.bucketsName",{defaultMessage:"hexagons"}):this._descriptor.requestType===m.ub.GRID?u.i18n.translate("xpack.maps.source.esGeoGrid.grid.bucketsName",{defaultMessage:"grid"}):u.i18n.translate("xpack.maps.source.esGeoGrid.cluster.bucketsName",{defaultMessage:"clusters"})}renderSourceSettingsEditor(t){return Object(I.jsx)(update_source_editor_UpdateSourceEditor,{bucketsName:this.getBucketsName(),currentLayerType:t.currentLayerType,geoFieldName:this.getGeoFieldName(),indexPatternId:this.getIndexPatternId(),onChange:async function(...e){t.onChange(...e);const i=e.find((t=>"resolution"===t.propName));if(i&&"getPropertiesDescriptor"in t.style){const e=t.style.getPropertiesDescriptor();if(e[m.Ib.ICON_SIZE].type===m.Eb.DYNAMIC){e[m.Ib.ICON_SIZE]={...e[m.Ib.ICON_SIZE],options:{...e[m.Ib.ICON_SIZE].options,...Object(U.a)(i.value)}};const r=V.a.createDescriptor(e,t.style.isTimeAware());t.onStyleDescriptorChange(r)}}},metrics:this._descriptor.metrics,renderAs:this._descriptor.requestType,resolution:this._descriptor.resolution})}getSyncMeta(t){return{...super.getSyncMeta(t),geogridPrecision:this.getGeoGridPrecision(t.zoom),requestType:this._descriptor.requestType,resolution:this._descriptor.resolution}}async getImmutableProperties(){return[{label:Object(M.a)(),value:this._descriptor.requestType===m.ub.HEATMAP?q:H},{label:Object(M.b)(),value:await this.getDisplayName()},{label:u.i18n.translate("xpack.maps.source.esGrid.geospatialFieldLabel",{defaultMessage:"Cluster field"}),value:this._descriptor.geoField}]}isMvt(){return A(this._descriptor.requestType,this._descriptor.resolution)}isGeoGridPrecisionAware(){return!this.isMvt()}supportsJoins(){return!1}getGridResolution(){return this._descriptor.resolution}getGeoGridPrecision(t){if(this.isMvt())return 0;const e=Math.ceil(t)+this._getGeoGridPrecisionResolutionDelta();return Math.min(e,29)}_getGeoGridPrecisionResolutionDelta(){if(this._descriptor.requestType===m.ub.HEX){if(this._descriptor.resolution===m.L.COARSE)return 2;if(this._descriptor.resolution===m.L.FINE||this._descriptor.resolution===m.L.MOST_FINE)return 5;if(this._descriptor.resolution===m.L.SUPER_FINE)return 8}if(this._descriptor.resolution===m.L.COARSE)return 2;if(this._descriptor.resolution===m.L.FINE)return 3;if(this._descriptor.resolution===m.L.MOST_FINE)return 4;if(this._descriptor.resolution===m.L.SUPER_FINE)return 8;throw new Error(u.i18n.translate("xpack.maps.source.esGrid.resolutionParamErrorMessage",{defaultMessage:"Grid resolution param not recognized: {resolution}",values:{resolution:this._descriptor.resolution}}))}async _compositeAggRequest({searchSource:t,searchSessionId:e,indexPattern:i,precision:r,layerName:n,registerCancelCallback:a,bucketsPerGrid:o,isRequestStillActive:l,bufferedExtent:c,inspectorAdapters:h,executionContext:p,onWarning:d}){const g=Math.floor(m.s/o),y={compositeSplit:{composite:{size:g,sources:[{[m.I]:{geotile_grid:{bounds:Object(f.o)(c),field:this._descriptor.geoField,precision:r}}}]},aggs:{[m.G]:{geo_centroid:{field:this._descriptor.geoField}},...this.getValueAggsDsl(i)}}},v=[];let x=0,b=null;for(;;){var w;if(!l())throw new F.b;if(x++,x>5)throw new Error(u.i18n.translate("xpack.maps.source.esGrid.compositePaginationErrorMessage",{defaultMessage:'{layerName} is causing too many requests. Reduce "Grid resolution" and/or reduce the number of top term "Metrics".',values:{layerName:n}}));b&&(y.compositeSplit.composite.after=b),t.setField("aggs",y);const i=b?`${this.getId()} afterKey ${b.geoSplit}`:this.getId(),r=await this._runEsQuery({requestId:i,requestName:Object(j.b)(`${n} (${x})`),searchSource:t,registerCancelCallback:a,searchSessionId:e,executionContext:Object(B.b)({description:"es_geo_grid_source:cluster_composite"},p),requestsAdapter:h.requests,onWarning:d});v.push(..._(r,this._descriptor.requestType));const o=null===(w=r.aggregations)||void 0===w?void 0:w.compositeSplit;if(b=o.after_key,o.buckets.length<g)break}return v}async _nonCompositeAggRequest({searchSource:t,searchSessionId:e,indexPattern:i,precision:r,layerName:n,registerCancelCallback:a,bufferedExtent:o,tooManyBuckets:l,inspectorAdapters:u,executionContext:h,onWarning:p}){const d=l?this.getValueAggsDsl(i,(t=>0===t.getBucketCount())):this.getValueAggsDsl(i);return t.setField("aggs",{[m.I]:{geotile_grid:{bounds:Object(f.o)(o),field:this._descriptor.geoField,precision:r,size:m.s,shard_size:m.s},aggs:{[m.G]:{geo_centroid:{field:this._descriptor.geoField}},...d}}}),g=await this._runEsQuery({requestId:this.getId(),requestName:Object(j.b)(n),searchSource:t,registerCancelCallback:a,searchSessionId:e,executionContext:Object(B.b)({description:"es_geo_grid_source:cluster"},h),requestsAdapter:u.requests,onWarning:p}),y=this._descriptor.requestType,v(g,y,(t=>c.a.get(t,`aggregations.${m.I}.buckets`,[])),(t=>t.key));var g,y}async _isGeoShape(){try{return(await this._getGeoField()).type===m.A.GEO_SHAPE}catch(t){return!1}}async getGeoJsonWithMeta(t,e,i,r,n){if(!e.buffer)throw new Error("Cannot get GeoJson without searchFilter.buffer");const a=await this.getIndexPattern(),o=await this.makeSearchSource(e,0);o.setField("trackTotalHits",!1);let l=1;this.getMetricFields().forEach((t=>{l+=t.getBucketCount()}));const c=this._descriptor.resolution!==m.L.COARSE&&l>1,u=!await this._isGeoShape(),h=this.getGeoGridPrecision(e.zoom),p=[],d=t=>{p.push(t)};return{data:{type:"FeatureCollection",features:u&&c?await this._compositeAggRequest({searchSource:o,searchSessionId:e.searchSessionId,indexPattern:a,precision:h,layerName:t,registerCancelCallback:i,bucketsPerGrid:l,isRequestStillActive:r,bufferedExtent:e.buffer,inspectorAdapters:n,executionContext:e.executionContext,onWarning:d}):await this._nonCompositeAggRequest({searchSource:o,searchSessionId:e.searchSessionId,indexPattern:a,precision:h,layerName:t,registerCancelCallback:i,bufferedExtent:e.buffer,tooManyBuckets:c,inspectorAdapters:n,executionContext:e.executionContext,onWarning:d})},meta:{areResultsTrimmed:!1,warnings:p}}}getTileSourceLayer(){return"aggs"}async getTileUrl(t,e,i,r){const n=await this.getIndexPattern(),a=await this.makeSearchSource(t,0);return a.setField("aggs",this.getValueAggsDsl(n)),a.setField("filter",[...a.getField("filter"),Object(d.buildExistsFilter)({name:this._descriptor.geoField,type:"geo_point"},n)]),`${Object(E.t)().basePath.prepend(`${m.ob}/{z}/{x}/{y}.pbf`)}?${Object(p.a)({geometryFieldName:this._descriptor.geoField,index:n.getIndexPattern(),gridPrecision:this._getGeoGridPrecisionResolutionDelta(),hasLabels:i,buffer:r,requestBody:c.a.pick(a.getSearchRequestBody(),["aggs","query","runtime_mappings"]),renderAs:this._descriptor.requestType,token:e,executionContextId:Object(B.a)(t.executionContext)})}`}isFilterByMapBounds(){return!this.isMvt()}hasTooltipProperties(){return!0}async getSupportedShapeTypes(){return this._descriptor.requestType===m.ub.GRID||this._descriptor.requestType===m.ub.HEX?[m.Hb.POLYGON]:[m.Hb.POINT]}async getLicensedFeatures(){return await this._isGeoShape()?[z.a.GEO_SHAPE_AGGS_GEO_TILE]:[]}getFeatureActions({addFilters:t,featureId:e,geoFieldNames:i,onClose:r}){return 0===i.length||null===t?[]:[{label:u.i18n.translate("xpack.maps.tooltip.action.filterByClusterLabel",{defaultMessage:"Filter by cluster"}),id:"FILTER_BY_CLUSTER_ACTION",onClick:()=>{const n=Object(f.b)({geoFieldNames:i,gridId:e,isHex:this._descriptor.requestType===m.ub.HEX});t([n],h.ACTION_GLOBAL_APPLY_FILTER),r()}}]}}},,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return o}));var r=i(3),n=i(0);function a(t){return r.i18n.translate("xpack.maps.styles.vector.disabledByMessage",{defaultMessage:"Set ''{styleLabel}'' to enable",values:{styleLabel:o(t)}})}function o(t){switch(t){case n.Ib.FILL_COLOR:return r.i18n.translate("xpack.maps.styles.vector.fillColorLabel",{defaultMessage:"Fill color"});case n.Ib.LINE_COLOR:return r.i18n.translate("xpack.maps.styles.vector.borderColorLabel",{defaultMessage:"Border color"});case n.Ib.LINE_WIDTH:return r.i18n.translate("xpack.maps.styles.vector.borderWidthLabel",{defaultMessage:"Border width"});case n.Ib.ICON:return r.i18n.translate("xpack.maps.styles.vector.iconLabel",{defaultMessage:"Icon"});case n.Ib.ICON_SIZE:return r.i18n.translate("xpack.maps.styles.vector.symbolSizeLabel",{defaultMessage:"Symbol size"});case n.Ib.ICON_ORIENTATION:return r.i18n.translate("xpack.maps.styles.vector.orientationLabel",{defaultMessage:"Symbol orientation"});case n.Ib.LABEL_TEXT:return r.i18n.translate("xpack.maps.styles.vector.labelLabel",{defaultMessage:"Label"});case n.Ib.LABEL_ZOOM_RANGE:return r.i18n.translate("xpack.maps.styles.vector.labelZoomRangeLabel",{defaultMessage:"Label visibility"});case n.Ib.LABEL_COLOR:return r.i18n.translate("xpack.maps.styles.vector.labelColorLabel",{defaultMessage:"Label color"});case n.Ib.LABEL_SIZE:return r.i18n.translate("xpack.maps.styles.vector.labelSizeLabel",{defaultMessage:"Label size"});case n.Ib.LABEL_BORDER_COLOR:return r.i18n.translate("xpack.maps.styles.vector.labelBorderColorLabel",{defaultMessage:"Label border color"});case n.Ib.LABEL_BORDER_SIZE:return r.i18n.translate("xpack.maps.styles.vector.labelBorderWidthLabel",{defaultMessage:"Label border width"});case n.Ib.LABEL_POSITION:return r.i18n.translate("xpack.maps.styles.vector.labelPositionLabel",{defaultMessage:"Label position"});default:return t}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return l})),i.d(e,"a",(function(){return c})),i.d(e,"c",(function(){return u})),i.d(e,"g",(function(){return m})),i.d(e,"f",(function(){return g})),i.d(e,"e",(function(){return y})),i.d(e,"d",(function(){return Mask}));var r=i(6),n=i.n(r),a=i(3),o=i(0);const l=a.i18n.translate("xpack.maps.mask.belowLabel",{defaultMessage:"below"}),c=a.i18n.translate("xpack.maps.mask.aboveLabel",{defaultMessage:"above"}),u=a.i18n.translate("xpack.maps.mask.genericBucketsName",{defaultMessage:"buckets"}),h=a.i18n.translate("xpack.maps.mask.genericFeaturesName",{defaultMessage:"features"}),p=a.i18n.translate("xpack.maps.mask.genericAggLabel",{defaultMessage:"value"}),d=a.i18n.translate("xpack.maps.mask.when",{defaultMessage:"when"}),f=a.i18n.translate("xpack.maps.mask.whenJoinMetric",{defaultMessage:"{whenLabel} join metric",values:{whenLabel:d}});function m(t,e){return`${function(t){return t===o.gb.BELOW?l:t===o.gb.ABOVE?c:t}(t)} ${e}`}function g({bucketsName:t,isJoin:e}){return a.i18n.translate("xpack.maps.mask.maskLabel",{defaultMessage:"Hide {hideNoun}",values:{hideNoun:e?h:t||u}})}function y({aggLabel:t,bucketsName:e,isJoin:i}){return a.i18n.translate("xpack.maps.mask.maskDescription",{defaultMessage:"{maskAdverb} {aggLabel} is ",values:{aggLabel:t||p,maskAdverb:i?f:d}})}class Mask{constructor({esAggField:t,isGeometrySourceMvt:e,operator:i,value:r}){n()(this,"_esAggField",void 0),n()(this,"_isGeometrySourceMvt",void 0),n()(this,"_operator",void 0),n()(this,"_value",void 0),this._esAggField=t,this._isGeometrySourceMvt=e,this._operator=i,this._value=r}_isFeatureState(){return this._esAggField.getOrigin()!==o.D.SOURCE&&!!this._isGeometrySourceMvt}getMatchMaskedExpression(){return[this._operator===o.gb.BELOW?"<":">",[this._isFeatureState()?o.ib.FEATURE_STATE:o.ib.GET,this._esAggField.getMbFieldName()],this._value]}getMatchUnmaskedExpression(){return[this._operator===o.gb.BELOW?">=":"<=",[this._isFeatureState()?o.ib.FEATURE_STATE:o.ib.GET,this._esAggField.getMbFieldName()],this._value]}getEsAggField(){return this._esAggField}getFieldOriginListLabel(){const t=this._esAggField.getSource(),e=this._esAggField.getOrigin()===o.D.JOIN;return`${g({bucketsName:"getBucketsName"in t?t.getBucketsName():void 0,isJoin:e})} ${e?f:d}`}getOperator(){return this._operator}getValue(){return this._value}isFeatureMasked(t){const e=this._isFeatureState()?null==t?void 0:t.state[this._esAggField.getMbFieldName()]:null==t?void 0:t.properties[this._esAggField.getMbFieldName()];return"number"==typeof e&&(this._operator===o.gb.BELOW?e<this._value:e>this._value)}}},,,,,,,,,function(t,e,i){"use strict";var r=i(187),n=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=p;var a=Object.create(i(168));a.inherits=i(150);var o=i(313),l=i(237);a.inherits(p,o);for(var c=n(l.prototype),u=0;u<c.length;u++){var h=c[u];p.prototype[h]||(p.prototype[h]=l.prototype[h])}function p(t){if(!(this instanceof p))return new p(t);o.call(this,t),l.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),p.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},,,function(t,e,i){"use strict";i.d(e,"b",(function(){return E})),i.d(e,"a",(function(){return dynamic_style_property_DynamicStyleProperty}));var r=i(6),n=i.n(r),a=i(53),o=i.n(a),l=i(2),c=i.n(l),u=i(151),h=i(98),p=i(0),d=i(14),f=i(3),m=i(54),g=i(4);class data_mapping_popover_DataMappingPopover extends l.Component{constructor(...t){super(...t),n()(this,"state",{isPopoverOpen:!1}),n()(this,"_togglePopover",(()=>{this.setState((t=>({isPopoverOpen:!t.isPopoverOpen})))})),n()(this,"_closePopover",(()=>{this.setState({isPopoverOpen:!1})}))}_renderButton(){return Object(g.jsx)(d.EuiButtonEmpty,{onClick:this._togglePopover,size:"xs",iconType:"controlsHorizontal",iconSide:"left"},Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.fieldMetaOptions.popoverToggle",defaultMessage:"Data mapping"}))}render(){return Object(g.jsx)(d.EuiPopover,{id:"dataMappingPopover",anchorPosition:"leftCenter",button:this._renderButton(),isOpen:this.state.isPopoverOpen,closePopover:this._closePopover,ownFocus:!0},this.props.children)}}function y(t){return Object(g.jsx)(data_mapping_popover_DataMappingPopover,null,Object(g.jsx)(d.EuiFormRow,{display:"columnCompressedSwitch"},Object(g.jsx)(c.a.Fragment,null,Object(g.jsx)(d.EuiSwitch,{label:f.i18n.translate("xpack.maps.styles.fieldMetaOptions.isEnabled.categoricalLabel",{defaultMessage:"Get categories from data set"}),checked:t.fieldMetaOptions.isEnabled,onChange:e=>{t.onChange({fieldMetaOptions:{...t.fieldMetaOptions,isEnabled:e.target.checked}})},disabled:!t.supportsFieldMetaFromLocalData,compressed:!0})," ",Object(g.jsx)(d.EuiToolTip,{content:Object(g.jsx)(d.EuiText,null,Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.categoricalDataMapping.isEnabled.server",defaultMessage:"Calculate categories from the entire data set. Styling is consistent when users pan, zoom, and filter."})),Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.categoricalDataMapping.isEnabled.local",defaultMessage:"When disabled, calculate categories from local data and recalculate categories when the data changes. Styling may be inconsistent when users pan, zoom, and filter."})))},Object(g.jsx)(d.EuiIcon,{type:"questionInCircle",color:"subdued"})))))}const _=f.i18n.translate("xpack.maps.addBtnTitle",{defaultMessage:"Add"}),v=f.i18n.translate("xpack.maps.deleteBtnTitle",{defaultMessage:"Delete"}),x=({onAdd:t,onRemove:e,showDeleteButton:i})=>Object(g.jsx)("div",null,i?Object(g.jsx)(d.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":v,title:v,onClick:e}):null,Object(g.jsx)(d.EuiButtonIcon,{iconType:"plusInCircle",color:"primary","aria-label":_,title:_,onClick:t}));function b(t){return"number"!=typeof t||t<=0||t>=100}class percentiles_form_PercentilesForm extends l.Component{constructor(t){super(t),n()(this,"_onSubmit",(()=>{this.state.percentiles.some(b)||this.props.onChange(this.state.percentiles)})),this.state={percentiles:t.initialPercentiles}}render(){const t=this.state.percentiles.map(((t,e)=>{const i=b(t),r=i?f.i18n.translate("xpack.maps.styles.invalidPercentileMsg",{defaultMessage:"Percentile must be a number between 0 and 100, exclusive"}):null;return Object(g.jsx)(d.EuiFormRow,{key:e,display:"rowCompressed",isInvalid:i,error:r},Object(g.jsx)(d.EuiFieldNumber,{isInvalid:i,value:t,onChange:t=>{const i=parseFloat(t.target.value),r=[...this.state.percentiles];r[e]=isNaN(i)?"":i,this.setState({percentiles:r},this._onSubmit)},append:Object(g.jsx)(x,{onAdd:()=>{let i="";if("number"==typeof t){let r=1;if(e===this.state.percentiles.length-1){if(0!==e){const i=this.state.percentiles[e-1];"number"==typeof i&&(r=t-i)}}else{const i=this.state.percentiles[e+1];"number"==typeof i&&(r=(i-t)/2)}i=t+r,i>=100&&(i=99)}const r=[...this.state.percentiles.slice(0,e+1),i,...this.state.percentiles.slice(e+1)];this.setState({percentiles:r},this._onSubmit)},onRemove:()=>{const t=1===this.state.percentiles.length?this.state.percentiles:[...this.state.percentiles.slice(0,e),...this.state.percentiles.slice(e+1)];this.setState({percentiles:t},this._onSubmit)},showDeleteButton:this.state.percentiles.length>1}),compressed:!0}))}));return Object(g.jsx)("div",null,t)}}const w=f.i18n.translate("xpack.maps.styles.ordinalDataMapping.interpolateTitle",{defaultMessage:"Interpolate between min and max"}),C=f.i18n.translate("xpack.maps.styles.ordinalDataMapping.percentilesTitle",{defaultMessage:"Use percentiles"}),S=[{value:p.n.INTERPOLATE,inputDisplay:w,dropdownDisplay:Object(g.jsx)(l.Fragment,null,Object(g.jsx)("strong",null,w),Object(g.jsx)(d.EuiText,{size:"s",color:"subdued"},Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.ordinalDataMapping.interpolateDescription",defaultMessage:"Interpolate values from the data domain to the style on a linear scale"}))))},{value:p.n.PERCENTILES,inputDisplay:C,dropdownDisplay:Object(g.jsx)(l.Fragment,null,Object(g.jsx)("strong",null,C),Object(g.jsx)(d.EuiText,{size:"s",color:"subdued"},Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.ordinalDataMapping.percentilesDescription",defaultMessage:"Divide style into bands that map to values"}))))}];function M(t){function e(e){t.onChange({fieldMetaOptions:{...t.fieldMetaOptions,isEnabled:e.target.checked}})}function i(e){t.onChange({fieldMetaOptions:{...t.fieldMetaOptions,sigma:parseInt(e.currentTarget.value,10)}})}const r=S.filter((e=>t.supportedDataMappingFunctions.includes(e.value)));return Object(g.jsx)(data_mapping_popover_DataMappingPopover,null,Object(g.jsx)(l.Fragment,null,Object(g.jsx)(d.EuiFormRow,{label:f.i18n.translate("xpack.maps.styles.ordinalDataMapping.dataMappingLabel",{defaultMessage:"Fitting"}),helpText:f.i18n.translate("xpack.maps.styles.ordinalDataMapping.dataMappingTooltipContent",{defaultMessage:"Fit values from the data domain to the style"})},Object(g.jsx)(d.EuiSuperSelect,{options:r,valueOfSelected:t.dataMappingFunction,onChange:function(e){const i=e===p.n.PERCENTILES?{dataMappingFunction:e,fieldMetaOptions:{...t.fieldMetaOptions,isEnabled:!0,percentiles:t.fieldMetaOptions.percentiles?t.fieldMetaOptions.percentiles:p.w}}:{dataMappingFunction:e};t.onChange(i)},itemLayoutAlign:"top",hasDividers:!0})),Object(g.jsx)(d.EuiHorizontalRule,null),t.dataMappingFunction===p.n.PERCENTILES?Object(g.jsx)(percentiles_form_PercentilesForm,{initialPercentiles:t.fieldMetaOptions.percentiles?t.fieldMetaOptions.percentiles:p.w,onChange:function(e){t.onChange({fieldMetaOptions:{...t.fieldMetaOptions,percentiles:o.a.uniq(e.sort())}})}}):function(){const r=t.fieldMetaOptions.isEnabled?Object(g.jsx)(d.EuiFormRow,{label:Object(g.jsx)(d.EuiToolTip,{anchorClassName:"eui-alignMiddle",content:f.i18n.translate("xpack.maps.styles.ordinalDataMapping.sigmaTooltipContent",{defaultMessage:"To de-emphasize outliers, set sigma to a smaller value. Smaller sigmas move the min and max closer to the median."})},Object(g.jsx)("span",null,f.i18n.translate("xpack.maps.styles.ordinalDataMapping.sigmaLabel",{defaultMessage:"Sigma"})," ",Object(g.jsx)(d.EuiIcon,{type:"questionInCircle",color:"subdued"}))),display:"columnCompressed"},Object(g.jsx)(d.EuiRange,{min:1,max:5,step:.25,value:o.a.get(t.fieldMetaOptions,"sigma",h.c),onChange:i,showTicks:!0,tickInterval:1,compressed:!0})):null;return Object(g.jsx)(l.Fragment,null,Object(g.jsx)(d.EuiFormRow,{display:"columnCompressedSwitch"},Object(g.jsx)(c.a.Fragment,null,Object(g.jsx)(d.EuiSwitch,{label:f.i18n.translate("xpack.maps.styles.ordinalDataMapping.isEnabledSwitchLabel",{defaultMessage:"Get min and max from data set"}),checked:t.fieldMetaOptions.isEnabled,onChange:e,disabled:!t.supportsFieldMetaFromLocalData,compressed:!0})," ",Object(g.jsx)(d.EuiToolTip,{content:Object(g.jsx)(d.EuiText,null,Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.ordinalDataMapping.isEnabled.server",defaultMessage:"Calculate min and max from the entire data set. Styling is consistent when users pan, zoom, and filter. To minimize outliers, min and max are clamped to the standard deviation (sigma) from the medium."})),Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"xpack.maps.styles.ordinalDataMapping.isEnabled.local",defaultMessage:"When disabled, calculate min and max from local data and recalculate min and max when the data changes. Styling may be inconsistent when users pan, zoom, and filter."})))},Object(g.jsx)(d.EuiIcon,{type:"questionInCircle",color:"subdued"})))),r)}()))}var T=i(114);const E="__other_bucket__";class dynamic_style_property_DynamicStyleProperty extends u.a{constructor(t,e,i,r,a){super(t,e),n()(this,"_field",void 0),n()(this,"_layer",void 0),n()(this,"_getFieldFormatter",void 0),n()(this,"getValueSuggestions",(async t=>null===this._field?[]:await this._field.getSource().getValueSuggestions(this._field,t))),this._field=i,this._layer=r,this._getFieldFormatter=a}_getStyleMetaDataRequestId(t){if(this.getFieldOrigin()===p.D.SOURCE)return p.Bb;const e=this._layer.getValidJoins().find((e=>!!e.getRightJoinSource().getFieldByName(t)));return e?e.getSourceMetaDataRequestId():null}_getRangeFieldMetaFromLocalFeatures(){const t=this._layer.getStyle().getStyleMeta(),e=this.getFieldName();return t.getRangeFieldMetaDescriptor(e)}_getRangeFieldMetaFromStyleMetaRequest(){const t=this._getStyleMetaDataRequestId(this.getFieldName());if(!t)return null;const e=this._layer.getDataRequest(t);if(!e||!e.hasData())return null;const i=e.getData();return this._pluckOrdinalStyleMetaFromFieldMetaData(i)||null}getRangeFieldMeta(){const t=this._getRangeFieldMetaFromLocalFeatures();if(!this.isFieldMetaEnabled())return t;return this._getRangeFieldMetaFromStyleMetaRequest()||t}getPercentilesFieldMeta(){if(!this._field)return null;const t=this._getStyleMetaDataRequestId(this.getFieldName());if(!t)return null;const e=this._layer.getDataRequest(t);return e&&e.hasData()?function(t){if(void 0===t||void 0===t.values)return null;const e=Object.keys(t.values).map((e=>({percentile:e,value:t.values[e]})));return o.a.uniqBy(e,"value")}(e.getData()[`${this._field.getRootName()}_percentiles`]):null}_getCategoryFieldMetaFromLocalFeatures(){const t=this._layer.getStyle().getStyleMeta(),e=this.getFieldName();return t.getCategoryFieldMetaDescriptor(e)}_getCategoryFieldMetaFromStyleMetaRequest(){const t=this._getStyleMetaDataRequestId(this.getFieldName());if(!t)return[];const e=this._layer.getDataRequest(t);if(!e||!e.hasData())return[];const i=e.getData();return this._pluckCategoricalStyleMetaFromFieldMetaData(i)}getCategoryFieldMeta(){const t=this._getCategoryFieldMetaFromLocalFeatures();if(!this.isFieldMetaEnabled())return t;const e=this._getCategoryFieldMetaFromStyleMetaRequest();return e.length?e:t}getField(){return this._field}getFieldName(){return this._field?this._field.getName():""}getMbFieldName(){return this._field?this._field.getMbFieldName():""}isDynamic(){return!0}isOrdinal(){return!0}isCategorical(){return!1}getNumberOfCategories(){return 0}getStyleMetaHash(){const t=this.getFieldMetaOptions(),e=[t.isEnabled.toString()];if(this.isOrdinal()){const i=this.getDataMappingFunction();e.push(i),i===p.n.PERCENTILES&&t.percentiles&&e.push(t.percentiles.join(""))}else this.isCategorical()&&e.push(this.getNumberOfCategories().toString());return e.join("")}isComplete(){return!!this._field}getFieldOrigin(){return this._field?this._field.getOrigin():null}isFieldMetaEnabled(){const t=this.getFieldMetaOptions();return this.supportsFieldMeta()&&o.a.get(t,"isEnabled",!0)}supportsFieldMeta(){return this.isComplete()&&!!this._field&&this._field.supportsFieldMetaFromEs()}async getFieldMetaRequest(){if(!this._field)return null;if(this.isOrdinal())return this.getDataMappingFunction()===p.n.INTERPOLATE?this._field.getExtendedStatsFieldMetaRequest():this._field.getPercentilesFieldMetaRequest(void 0!==this.getFieldMetaOptions().percentiles?this.getFieldMetaOptions().percentiles:p.w);if(this.isCategorical()){const t=this.getNumberOfCategories();return this._field.getCategoricalFieldMetaRequest(t)}return null}supportsFeatureState(){return!0}usesFeatureState(){return!!this._field&&!this._field.getSource().isMvt()&&this.supportsFeatureState()}getMbLookupFunction(){return this.usesFeatureState()?p.ib.FEATURE_STATE:p.ib.GET}getFieldMetaOptions(){const t=o.a.get(this.getOptions(),"fieldMetaOptions",{isEnabled:!0});return this._field&&!this._field.supportsFieldMetaFromLocalData()?{...t,isEnabled:!0}:t}getDataMappingFunction(){return"dataMappingFunction"in this._options?this._options.dataMappingFunction:p.n.INTERPOLATE}_pluckOrdinalStyleMetaFromFieldMetaData(t){if(!this.isOrdinal()||!this._field)return null;const e=t[`${this._field.getRootName()}_range`];if(!e||!("avg"in e))return null;const i=o.a.get(this.getFieldMetaOptions(),"sigma",h.c),r=e.avg-e.std_deviation*i,n=e.avg+e.std_deviation*i,a=Math.max(e.min,r),l=Math.min(e.max,n);return{min:a,max:l,delta:l-a,isMinOutsideStdRange:e.min<r,isMaxOutsideStdRange:e.max>n}}_pluckCategoricalStyleMetaFromFieldMetaData(t){if(!this.isCategorical()||!this._field)return[];const e=t[`${this._field.getRootName()}_terms`];if(!e||!("buckets"in e))return[];const i=e.buckets.map((t=>({key:t.key,count:t.doc_count})));return e.sum_other_doc_count>0&&i.push({key:E,count:e.sum_other_doc_count}),i}formatField(t){if(this.getField()){const e=this.getFieldName(),i=this._getFieldFormatter(e);return i?i(t):super.formatField(t)}return super.formatField(t)}_getSupportedDataMappingFunctions(){return[p.n.INTERPOLATE]}renderDataMappingPopover(t){return this._field&&this.supportsFieldMeta()?this.isCategorical()?Object(g.jsx)(y,{fieldMetaOptions:this.getFieldMetaOptions(),onChange:t,supportsFieldMetaFromLocalData:this._field.supportsFieldMetaFromLocalData()}):Object(g.jsx)(M,{fieldMetaOptions:this.getFieldMetaOptions(),styleName:this.getStyleName(),onChange:t,dataMappingFunction:this.getDataMappingFunction(),supportedDataMappingFunctions:this._getSupportedDataMappingFunctions(),supportsFieldMetaFromLocalData:this._field.supportsFieldMetaFromLocalData()}):null}getMbPropertyName(){if(!this._field)return"";let t;return t=this.usesFeatureState()?this._field.getName():!this._field.getSource().isMvt()&&this._field.supportsFieldMetaFromLocalData()?Object(T.e)(this.getStyleName(),this._field.getName()):this._field.getMbFieldName(),t}getMbPropertyValue(t){return this.isOrdinal()?function(t){if("string"!=typeof t)return t;const e=parseFloat(t);return isNaN(e)?null:e}(t):t}enrichGeoJsonAndMbFeatureState(t,e,i){const r=this.usesFeatureState(),n={source:i,id:void 0},a={},o=this.getMbPropertyName();for(let i=0;i<t.features.length;i++){const l=t.features[i],c=l.properties?l.properties[this.getFieldName()]:void 0,u=this.getMbPropertyValue(c);r?(a[o]=u,n.id=l.id,e.setFeatureState(n,a)):l.properties&&(l.properties[o]=u)}return r}}n()(dynamic_style_property_DynamicStyleProperty,"type",p.Eb.DYNAMIC)},,function(t,e,i){t.exports=i(27)(3085)},,function(t,e,i){"use strict";var r,n="object"==typeof Reflect?Reflect:null,a=n&&"function"==typeof n.apply?n.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function l(){l.init.call(this)}t.exports=l,t.exports.once=function(t,e){return new Promise((function(i,r){function n(i){t.removeListener(e,a),r(i)}function a(){"function"==typeof t.removeListener&&t.removeListener("error",n),i([].slice.call(arguments))}_(t,e,a,{once:!0}),"error"!==e&&function(t,e,i){"function"==typeof t.on&&_(t,"error",e,{once:!0})}(t,n)}))},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?l.defaultMaxListeners:t._maxListeners}function p(t,e,i,r){var n,a,o,l;if(u(i),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),a=t._events),o=a[e]),void 0===o)o=a[e]=i,++t._eventsCount;else if("function"==typeof o?o=a[e]=r?[i,o]:[o,i]:r?o.unshift(i):o.push(i),(n=h(t))>0&&o.length>n&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,l=c,console&&console.warn&&console.warn(l)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,i){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},n=d.bind(r);return n.listener=i,r.wrapFn=n,n}function m(t,e,i){var r=t._events;if(void 0===r)return[];var n=r[e];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(n):y(n,n.length)}function g(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(t,e){for(var i=new Array(e),r=0;r<e;++r)i[r]=t[r];return i}function _(t,e,i,r){if("function"==typeof t.on)r.once?t.once(e,i):t.on(e,i);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function n(a){r.once&&t.removeEventListener(e,n),i(a)}))}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var r="error"===t,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var l=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw l.context=o,l}var c=n[t];if(void 0===c)return!1;if("function"==typeof c)a(c,this,e);else{var u=c.length,h=y(c,u);for(i=0;i<u;++i)a(h[i],this,e)}return!0},l.prototype.addListener=function(t,e){return p(this,t,e,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(t,e){return p(this,t,e,!0)},l.prototype.once=function(t,e){return u(e),this.on(t,f(this,t,e)),this},l.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,f(this,t,e)),this},l.prototype.removeListener=function(t,e){var i,r,n,a,o;if(u(e),void 0===(r=this._events))return this;if(void 0===(i=r[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,a=i.length-1;a>=0;a--)if(i[a]===e||i[a].listener===e){o=i[a].listener,n=a;break}if(n<0)return this;0===n?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,n),1===i.length&&(r[t]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(t){var e,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var n,a=Object.keys(i);for(r=0;r<a.length;++r)"removeListener"!==(n=a[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},l.prototype.listeners=function(t){return m(this,t,!0)},l.prototype.rawListeners=function(t){return m(this,t,!1)},l.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},l.prototype.listenerCount=g,l.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return ValidatedRange}));var r=i(18),n=i.n(r),a=i(6),o=i.n(a),l=i(2),c=i.n(l),u=i(14),h=i(54),p=i(4);function d(t,e,i){return i>=t&&i<=e}class ValidatedRange extends c.a.Component{constructor(...t){super(...t),o()(this,"state",{}),o()(this,"_onRangeChange",(t=>{const e=parseFloat(t.target.value,10);let i=isNaN(e)?"":e;i=Number(i);const r=!!d(this.props.min,this.props.max,i);this.setState({value:i,isValid:r}),r&&this.props.onChange(i)}))}static getDerivedStateFromProps(t,e){return t.value!==e.prevValue?{value:t.value,prevValue:t.value,isValid:d(t.min,t.max,t.value)}:null}render(){const{max:t,min:e,value:i,onChange:r,...a}=this.props,o=Object(p.jsx)(u.EuiRange,n()({min:e,max:t,value:this.state.value.toString(),onChange:this._onRangeChange},a));return this.state.isValid?o:Object(p.jsx)("div",null,o,Object(p.jsx)(u.EuiFormErrorText,null,Object(p.jsx)(h.FormattedMessage,{id:"xpack.maps.validatedRange.rangeErrorMessage",defaultMessage:"Must be between {min} and {max}",values:{min:e,max:t}})))}}},function(t,e,i){t.exports=i(27)(3852)},function(t,e,i){"use strict";i.d(e,"a",(function(){return AbstractStyleProperty}));var r=i(6),n=i.n(r),a=i(128);class AbstractStyleProperty{constructor(t,e){n()(this,"_options",void 0),n()(this,"_styleName",void 0),this._options=t,this._styleName=e}isDynamic(){return!1}isComplete(){return!0}formatField(t){return null==t?"":"boolean"==typeof t?t.toString():Array.isArray(t)?t.join(", "):t}getStyleName(){return this._styleName}getOptions(){return this._options}renderLegendDetailRow({isPointsOnly:t,isLinesOnly:e}){return null}renderDataMappingPopover(t){return null}getDisplayStyleName(){return Object(a.b)(this.getStyleName())}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return p})),i.d(e,"c",(function(){return d})),i.d(e,"a",(function(){return f}));var r=i(53),n=i.n(r),a=i(263),o=i.n(a),l=i(264),c=i.n(l);const u=!0,h=!1;async function p({source:t,prevDataRequest:e,nextRequestMeta:i,extentAware:r,getUpdateDueToTimeslice:a}){if(i.isForceRefresh&&i.applyForceRefresh)return!1;const l=await t.isTimeAware(),p=t.isFieldAware(),d=t.isQueryAware();if(!(l||r||p||d))return!!e&&e.hasDataOrRequestInProgress();if(!e)return!1;const f=e.getMeta();if(!f)return!1;if(f.isFeatureEditorOpenForLayer!==i.isFeatureEditorOpenForLayer)return!1;let m=!1,g=!1,y=!1;l&&(m=f.applyGlobalTime!==i.applyGlobalTime,i.applyGlobalTime&&(g=!n.a.isEqual(f.timeFilters,i.timeFilters),n.a.isEqual(f.timeslice,i.timeslice)||(y=a(i.timeslice))));let _=!1;p&&(_=!n.a.isEqual(f.fieldNames,i.fieldNames));let v=!1,x=!1,b=!1,w=!1;d&&(w=f.applyGlobalQuery!==i.applyGlobalQuery,b=!n.a.isEqual(f.sourceQuery,i.sourceQuery),i.applyGlobalQuery&&(v=!n.a.isEqual(f.query,i.query),x=!n.a.isEqual(f.filters,i.filters)));let C=!1;(l||d)&&i.applyForceRefresh&&(C=f.searchSessionId!==i.searchSessionId);let S=!1;r&&(S=function(t={},e={}){const{buffer:i}=t,{buffer:r}=e;if(!i||!i||!r)return u;if(n.a.isEqual(i,r))return h;const a=o()([i.minLon,i.minLat,i.maxLon,i.maxLat]),l=o()([r.minLon,r.minLat,r.maxLon,r.maxLat]),p=c()(a,l),d=n.a.get(t,"areResultsTrimmed",!1);return p&&!d?h:u}(f,i));const M=!n.a.isEqual(f.sourceMeta,i.sourceMeta);return!(m||g||y||S||_||v||x||b||w||M||C)}function d({prevDataRequest:t,nextMeta:e}){if(!t)return!1;const i=t.getMeta();if(!i)return!1;const r=!n.a.isEqual(i.dynamicStyleFields,e.dynamicStyleFields),a=!n.a.isEqual(i.sourceQuery,e.sourceQuery),o=e.isTimeAware!==i.isTimeAware,l=!!e.isTimeAware&&!n.a.isEqual(i.timeFilters,e.timeFilters),c=i.searchSessionId!==e.searchSessionId;return!(r||a||o||l||c)}function f({prevDataRequest:t,nextMeta:e}){if(!t)return!1;const i=t.getMeta();return!!i&&n.a.isEqual(i.fieldNames,e.fieldNames)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return ESDocField}));var r=i(6),n=i.n(r),a=i(28),o=i(324),l=i(125),c=i(169);class ESDocField extends c.a{constructor({fieldName:t,source:e,origin:i}){super({fieldName:t,origin:i}),n()(this,"_source",void 0),this._source=e}supportsFieldMetaFromEs(){return!0}supportsFieldMetaFromLocalData(){return!this.getSource().isMvt()}canValueBeFormatted(){return!0}getSource(){return this._source}async _getIndexPatternField(){const t=(await this._source.getIndexPattern()).fields.getByName(this.getName());return t&&a.indexPatterns.isNestedField(t)?void 0:t}async createTooltipProperty(t){const e=await this._source.getIndexPattern(),i=new l.a(this.getName(),await this.getLabel(),t);return new o.a(i,e,this,this._source.getApplyGlobalQuery())}async getDataType(){const t=await this._getIndexPatternField();return t?t.type:""}async getLabel(){const t=await this._getIndexPatternField();return t&&t.displayName?t.displayName:super.getLabel()}async getExtendedStatsFieldMetaRequest(){const t=await this._getIndexPatternField();if(!t||"number"!==t.type&&"date"!==t.type)return null;const e={};return t.scripted&&t.script?e.script={source:t.script,lang:t.lang}:e.field=this.getName(),{[`${this.getName()}_range`]:{extended_stats:e}}}async getPercentilesFieldMetaRequest(t){const e=await this._getIndexPatternField();if(!e||"number"!==e.type)return null;const i={percents:[0,...t]};return e.scripted&&e.script?i.script={source:e.script,lang:e.lang}:i.field=this.getName(),{[`${this.getName()}_percentiles`]:{percentiles:i}}}async getCategoricalFieldMetaRequest(t){const e=await this._getIndexPatternField();if(!e||t<=0)return null;const i={size:t};return e.scripted&&e.script?i.script={source:e.script,lang:e.lang}:i.field=this.getName(),{[`${this.getName()}_terms`]:{terms:i}}}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(3);const n={apply:r.i18n.translate("xpack.maps.panel.applyLabel",{defaultMessage:"Apply"}),clear:r.i18n.translate("xpack.maps.panel.clearLabel",{defaultMessage:"Clear"}),close:r.i18n.translate("xpack.maps.panel.closeLabel",{defaultMessage:"Close"}),discardChanges:r.i18n.translate("xpack.maps.panel.discardChangesLabel",{defaultMessage:"Discard changes"}),edit:r.i18n.translate("xpack.maps.panel.editLabel",{defaultMessage:"Edit"}),keepChanges:r.i18n.translate("xpack.maps.panel.keepChangesLabel",{defaultMessage:"Keep changes"})}},,,,function(t,e,i){"use strict";function r(t){return"getTermField"in t}function n(t){return void 0!==t.indexPatternId&&void 0!==t.geoField}i.d(e,"f",(function(){return r})),i.d(e,"e",(function(){return n})),i.d(e,"a",(function(){return _})),i.d(e,"b",(function(){return es_distance_source_ESDistanceSource})),i.d(e,"c",(function(){return es_term_source_ESTermSource})),i.d(e,"g",(function(){return x})),i.d(e,"d",(function(){return table_source_TableSource}));var a=i(6),o=i.n(a),l=i(3),c=i(0),u=i(120),h=i(122),p=i(117),d=i(126),f=i(93);const m=[c.k];function g(t,e){var i,r,n;const a=new Map,o=null!==(i=null==t||null===(r=t.aggregations)||void 0===r||null===(n=r.distance)||void 0===n?void 0:n.buckets)&&void 0!==i?i:{};for(const t in o)if(o.hasOwnProperty(t)){const i=o[t];if(0===i[c.k])continue;const r=Object(f.j)(i,m);r[e]=i[c.k],a.set(t,r)}return a}const y=t=>l.i18n.translate("xpack.maps.joinSource.joinMetricsRequestName",{defaultMessage:"load join metrics ({layerName})",values:{layerName:t}}),_=5;class es_distance_source_ESDistanceSource extends h.a{static createDescriptor(t){const e=h.a.createDescriptor(t);if(!Object(p.a)(t.geoField))throw new Error("Cannot create an ESDistanceSource without a geoField property");return{...e,geoField:t.geoField,distance:"number"==typeof t.distance?t.distance:_,type:c.Cb.ES_DISTANCE_SOURCE}}constructor(t){const e=es_distance_source_ESDistanceSource.createDescriptor(t);super(e),o()(this,"_descriptor",void 0),this._descriptor=e}hasCompleteConfig(){return n(this._descriptor)}getOriginForField(){return c.D.JOIN}getWhereQuery(){return this._descriptor.whereQuery}getAggKey(t,e){return Object(u.a)({aggType:t,aggFieldName:e,rightSourceId:this._descriptor.id})}async getJoinMetrics(t,e,i,r,n){if(void 0===n)throw new Error(l.i18n.translate("xpack.maps.esDistanceSource.noFeatureCollectionMsg",{defaultMessage:"Unable to perform distance join, features not provided. To enable distance join, select 'Limit results' in 'Scaling'"}));if(!this.hasCompleteConfig())return{joinMetrics:new Map,warnings:[]};const a=`${this._descriptor.distance}km`;let o=!1;const u={};for(let t=0;t<n.features.length;t++){var h;const e=n.features[t];"Point"===e.geometry.type&&null!=e&&null!==(h=e.properties)&&void 0!==h&&h._id&&(u[e.properties._id]={geo_distance:{distance:a,[this._descriptor.geoField]:e.geometry.coordinates}},o||(o=!0))}if(!o)return{joinMetrics:new Map,warnings:[]};const p=await this.getIndexPattern(),f=await this.makeSearchSource(t,0);f.setField("trackTotalHits",!1),f.setField("aggs",{distance:{filters:{filters:u},aggs:this.getValueAggsDsl(p)}});const m=[];return{joinMetrics:g(await this._runEsQuery({requestId:this.getId(),requestName:y(e),searchSource:f,registerCancelCallback:i,searchSessionId:t.searchSessionId,executionContext:Object(d.b)({description:"es_distance_source:distance_join_request"},t.executionContext),requestsAdapter:r.requests,onWarning:t=>{m.push(t)}}),this.getAggKey(c.b.COUNT)),warnings:m}}isFilterByMapBounds(){return!1}getSyncMeta(t){return{...super.getSyncMeta(t),distance:this._descriptor.distance,geoField:this._descriptor.geoField}}getRightFields(){return this.getMetricFields()}}o()(es_distance_source_ESDistanceSource,"type",c.Cb.ES_DISTANCE_SOURCE);var v=i(153);function x(t){return void 0!==t.indexPatternId&&void 0!==t.term}const b="join",w=["key","doc_count"];function C(t,e){var i,r,n;const a=new Map;return(null!==(i=null==t||null===(r=t.aggregations)||void 0===r||null===(n=r[b])||void 0===n?void 0:n.buckets)&&void 0!==i?i:[]).forEach((t=>{const i=Object(f.j)(t,w);e&&(i[e]=t.doc_count),a.set(t.key.toString(),i)})),a}class es_term_source_ESTermSource extends h.a{static createDescriptor(t){const e=h.a.createDescriptor(t);if(!Object(p.a)(t.term))throw new Error("Cannot create an ESTermSource without a term");return{...e,term:t.term,type:c.Cb.ES_TERM_SOURCE}}constructor(t){const e=es_term_source_ESTermSource.createDescriptor(t);super(e),o()(this,"_termField",void 0),o()(this,"_descriptor",void 0),this._descriptor=e,this._termField=new v.a({fieldName:this._descriptor.term,source:this,origin:this.getOriginForField()})}hasCompleteConfig(){return x(this._descriptor)}getTermField(){return this._termField}getOriginForField(){return c.D.JOIN}getWhereQuery(){return this._descriptor.whereQuery}getAggKey(t,e){return Object(u.a)({aggType:t,aggFieldName:e,rightSourceId:this._descriptor.id})}async getAggLabel(t,e){let i;try{i=(await this.getIndexPattern()).getName()}catch(t){i=this._descriptor.indexPatternId}return t===c.b.COUNT?l.i18n.translate("xpack.maps.source.esJoin.countLabel",{defaultMessage:"count of {indexPatternLabel}",values:{indexPatternLabel:i}}):super.getAggLabel(t,e)}async getJoinMetrics(t,e,i,r){if(!this.hasCompleteConfig())return{joinMetrics:new Map,warnings:[]};const n=await this.getIndexPattern(),a=await this.makeSearchSource(t,0);a.setField("trackTotalHits",!1);const o=Object(f.l)(n,this._termField.getName()),l={size:void 0!==this._descriptor.size?this._descriptor.size:c.s};a.setField("aggs",{[b]:{terms:Object(f.a)(l,o),aggs:{...this.getValueAggsDsl(n)}}});const u=[];return{joinMetrics:C(await this._runEsQuery({requestId:this.getId(),requestName:y(e),searchSource:a,registerCancelCallback:i,searchSessionId:t.searchSessionId,executionContext:Object(d.b)({description:"es_term_source:terms"},t.executionContext),requestsAdapter:r.requests,onWarning:t=>{u.push(t)}}),this.getAggKey(c.b.COUNT)),warnings:u}}isFilterByMapBounds(){return!1}async getDisplayName(){return`es_table ${this.getIndexPatternId()}`}getSyncMeta(t){return{...super.getSyncMeta(t),indexPatternId:this._descriptor.indexPatternId,size:this._descriptor.size,term:this._descriptor.term}}getRightFields(){return this.getMetricFields()}}o()(es_term_source_ESTermSource,"type",c.Cb.ES_TERM_SOURCE);var S=i(56),M=i(106),T=i(189),E=i(125);class table_source_TableSource extends M.a{static createDescriptor(t){return{type:c.Cb.TABLE_SOURCE,__rows:t.__rows||[],__columns:t.__columns||[],term:t.term||"",id:t.id||Object(S.v4)()}}constructor(t){const e=table_source_TableSource.createDescriptor(t);super(e),o()(this,"_descriptor",void 0),this._descriptor=e}async getDisplayName(){return`table source ${Object(S.v4)()}`}async getJoinMetrics(t,e,i){const r=new Map,n=this._descriptor.__columns.map((t=>t.name));for(let t=0;t<this._descriptor.__rows.length;t++){const e=this._descriptor.__rows[t];let i;const a={};for(const t in e)e.hasOwnProperty(t)&&(t===this._descriptor.term&&e[t]&&(i=e[t]),n.indexOf(t)>=0&&t!==this._descriptor.term&&(a[t]=e[t]));i&&!r.has(i.toString())&&r.set(i.toString(),a)}return{joinMetrics:r,warnings:[]}}getTermField(){const t=this._descriptor.__columns.find((t=>t.name===this._descriptor.term));if(!t)throw new Error(`Cannot find column for ${this._descriptor.term} in ${JSON.stringify(this._descriptor.__columns)}`);return new T.a({fieldName:t.name,label:t.label,source:this,origin:c.D.JOIN,dataType:t.type})}getWhereQuery(){}hasCompleteConfig(){return!0}getId(){return this._descriptor.id}getRightFields(){return this._descriptor.__columns.map((t=>new T.a({fieldName:t.name,label:t.label,source:this,origin:c.D.JOIN,dataType:t.type})))}hasTooltipProperties(){return!1}async getBoundsForFilters(t,e){return null}getFieldByName(t){const e=this._descriptor.__columns.find((e=>e.name===t));return e?new T.a({fieldName:e.name,label:e.label,source:this,origin:c.D.JOIN,dataType:e.type}):null}getFields(){throw new Error("must implement")}async getGeoJsonWithMeta(t,e,i,r){throw new Error("TableSource cannot return GeoJson")}async getLeftJoinFields(){throw new Error("TableSource cannot be used as a left-layer in a term join")}getSourceStatus(t){throw new Error("must add tooltip content")}async getSupportedShapeTypes(){return[]}isBoundsAware(){return!1}async getTooltipProperties(t){const e=[];for(const i in t)if(t.hasOwnProperty(i)){const r=this.getFieldByName(i);r&&e.push(new E.a(i,await r.getLabel(),t[i]))}return e}}o()(table_source_TableSource,"type",c.Cb.TABLE_SOURCE)},,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return MbValidatedColorPicker}));var r=i(6),n=i.n(r),a=i(2),o=i(14),l=i(4);const c="rgba(0,0,0,0)";class MbValidatedColorPicker extends a.Component{constructor(...t){super(...t),n()(this,"state",{colorInputValue:this.props.color===c?"":this.props.color}),n()(this,"_onColorChange",(t=>{this.setState({colorInputValue:t}),this.props.onChange(Object(o.isValidHex)(t)?t:c)}))}render(){return Object(l.jsx)(o.EuiColorPicker,{onChange:this._onColorChange,color:this.state.colorInputValue,swatches:this.props.swatches,append:this.props.append,prepend:this.props.prepend,compressed:!0})}}},function(t,e,i){(function(t){function i(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===i(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===i(t)},e.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,i(143).Buffer)},function(t,e,i){"use strict";i.d(e,"a",(function(){return AbstractField}));var r=i(6),n=i.n(r),a=i(0),o=i(125);class AbstractField{constructor({fieldName:t,origin:e}){n()(this,"_fieldName",void 0),n()(this,"_origin",void 0),this._fieldName=t,this._origin=e||a.D.SOURCE}supportsFieldMetaFromEs(){throw new Error("must implement AbstractField#supportsFieldMetaFromEs")}supportsFieldMetaFromLocalData(){throw new Error("must implement AbstractField#supportsFieldMetaFromLocalData")}getName(){return this._fieldName}getMbFieldName(){return this.getName()}getRootName(){return this.getName()}canValueBeFormatted(){return!1}getSource(){throw new Error("must implement AbstractField#getSource")}isValid(){return!!this._fieldName}async getDataType(){return"string"}async getLabel(){return this._fieldName}async createTooltipProperty(t){const e=await this.getLabel();return new o.a(this.getName(),e,t)}getOrigin(){return this._origin}async getExtendedStatsFieldMetaRequest(){return null}async getPercentilesFieldMetaRequest(t){return null}async getCategoricalFieldMetaRequest(t){return null}isEqual(t){return this._origin===t.getOrigin()&&this._fieldName===t.getName()}pluckRangeFromTileMetaFeature(t){return null}isCount(){return!1}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(3);const n={fieldSelectPlaceholder:r.i18n.translate("xpack.maps.input.fieldSelectPlaceholder",{defaultMessage:"Select field"}),relationshipLabel:r.i18n.translate("xpack.maps.input.relationshipLabel",{defaultMessage:"Relationship"})}},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return metrics_editor_MetricsEditor}));var r=i(6),n=i.n(r),a=i(2),o=i.n(a),l=i(54),c=i(14),u=i(3),h=i(18),p=i.n(h),d=i(0),f=i(122),m=i(4);const g=[{label:Object(f.c)(d.b.AVG),value:d.b.AVG},{label:Object(f.c)(d.b.COUNT),value:d.b.COUNT},{label:Object(f.c)(d.b.MAX),value:d.b.MAX},{label:Object(f.c)(d.b.MIN),value:d.b.MIN},{label:Object(f.c)(d.b.PERCENTILE),value:d.b.PERCENTILE},{label:Object(f.c)(d.b.SUM),value:d.b.SUM},{label:Object(f.c)(d.b.TERMS),value:d.b.TERMS},{label:Object(f.c)(d.b.UNIQUE_COUNT),value:d.b.UNIQUE_COUNT}];function y({value:t,onChange:e,metricsFilter:i,...r}){const n=i?g.filter(i):g;return Object(m.jsx)(c.EuiComboBox,p()({placeholder:u.i18n.translate("xpack.maps.metricSelect.selectAggregationPlaceholder",{defaultMessage:"Select aggregation"}),singleSelection:!0,isClearable:!1,options:n,selectedOptions:g.filter((e=>t===e.value)),onChange:function(t){if(0===t.length)return;const i=t[0].value;e(i)}},r))}var _=i(108),v=i(97),x=i(326),b=i(129),w=i(154);const C=[{value:d.gb.BELOW,text:b.b},{value:d.gb.ABOVE,text:b.a}];class mask_editor_MaskEditor extends a.Component{constructor(t){super(t),n()(this,"_onSet",(()=>{this._isValueInValid()||(this.props.onChange({...this.props.metric,mask:{operator:this.state.operator,value:this.state.value}}),this.props.onClose())})),n()(this,"_onClear",(()=>{const t={...this.props.metric};delete t.mask,this.props.onChange(t),this.props.onClose()})),n()(this,"_onOperatorChange",(t=>{this.setState({operator:t.target.value})})),n()(this,"_onValueChange",(t=>{const e=parseFloat(t.target.value);this.setState({value:isNaN(e)?t.target.value:e})})),this.state={operator:void 0!==this.props.metric.mask?this.props.metric.mask.operator:d.gb.BELOW,value:void 0!==this.props.metric.mask?this.props.metric.mask.value:""}}_hasChanges(){return void 0===this.props.metric.mask||this.props.metric.mask.operator!==this.state.operator||this.props.metric.mask.value!==this.state.value}_isValueInValid(){return"string"==typeof this.state.value}_renderForm(){return Object(m.jsx)(c.EuiFlexGroup,{gutterSize:"s"},Object(m.jsx)(c.EuiFlexItem,null,Object(m.jsx)(c.EuiFormRow,null,Object(m.jsx)(c.EuiSelect,{id:"maskOperatorSelect",options:C,value:this.state.operator,onChange:this._onOperatorChange,"aria-label":u.i18n.translate("xpack.maps.maskEditor.operatorSelectLabel",{defaultMessage:"Mask operator select"})}))),Object(m.jsx)(c.EuiFlexItem,null,Object(m.jsx)(c.EuiFormRow,null,Object(m.jsx)(c.EuiFieldNumber,{value:this.state.value,onChange:this._onValueChange,"aria-label":u.i18n.translate("xpack.maps.maskEditor.valueInputLabel",{defaultMessage:"Mask value input"})}))))}_renderFooter(){return Object(m.jsx)(c.EuiPopoverFooter,{paddingSize:"s"},Object(m.jsx)(c.EuiFlexGroup,null,Object(m.jsx)(c.EuiFlexItem,null,Object(m.jsx)(c.EuiButtonEmpty,{onClick:this.props.onClose,size:"s"},w.a.close)),Object(m.jsx)(c.EuiFlexItem,null,Object(m.jsx)(c.EuiButtonEmpty,{color:"danger",isDisabled:void 0===this.props.metric.mask,onClick:this._onClear,size:"s"},w.a.clear)),Object(m.jsx)(c.EuiFlexItem,null,Object(m.jsx)(c.EuiButton,{fill:!0,isDisabled:this._isValueInValid()||!this._hasChanges(),onClick:this._onSet,size:"s"},w.a.apply))))}render(){return Object(m.jsx)(o.a.Fragment,null,this._renderForm(),Object(m.jsx)(c.EuiSpacer,{size:"xs"}),this._renderFooter())}}class mask_expression_MaskExpression extends a.Component{constructor(...t){super(...t),n()(this,"state",{isPopoverOpen:!1}),n()(this,"_togglePopover",(()=>{this.setState((t=>({isPopoverOpen:!t.isPopoverOpen})))})),n()(this,"_closePopover",(()=>{this.setState({isPopoverOpen:!1})}))}_getMaskExpressionValue(){return void 0===this.props.metric.mask?"...":Object(b.g)(this.props.metric.mask.operator,this.props.metric.mask.value)}_getAggLabel(){const t=Object(f.c)(this.props.metric.type);if(this.props.metric.type===d.b.COUNT||void 0===this.props.metric.field)return t;const e=this.props.fields.find((t=>t.name===this.props.metric.field));return`${t} ${null!=e&&e.displayName?null==e?void 0:e.displayName:this.props.metric.field}`}render(){return this.props.metric.type===d.b.TERMS?null:Object(m.jsx)(c.EuiPopover,{id:"mask",button:Object(m.jsx)(c.EuiExpression,{color:"subdued",description:Object(b.e)({aggLabel:this._getAggLabel(),isJoin:this.props.isJoin}),value:this._getMaskExpressionValue(),onClick:this._togglePopover,uppercase:!1}),isOpen:this.state.isPopoverOpen,closePopover:this._closePopover,panelPaddingSize:"s",anchorPosition:"downCenter",repositionOnScroll:!0},Object(m.jsx)(mask_editor_MaskEditor,{metric:this.props.metric,onChange:this.props.onChange,onClose:this._closePopover}))}}var S=i(170);function M(t,e){if(!t)return[];if(e===d.b.UNIQUE_COUNT||e===d.b.TERMS)return Object(v.i)(t);const i=["number"];return e!==d.b.SUM&&i.push("date"),t.filter((t=>t.aggregatable&&i.includes(t.type)&&("counter"!==t.timeSeriesMetric||["min","max"].includes(e))))}function T({bucketsName:t,fields:e,isJoin:i,metricsFilter:r,metric:n,onChange:o,showRemoveButton:h,onRemove:p}){const f=t=>{t&&n.type!==d.b.COUNT&&o({label:n.label,type:n.type,field:t})},g=t=>{n.type===d.b.PERCENTILE&&o({...n,percentile:t})};let v,w,C,T;if(n.type&&n.type!==d.b.COUNT){const t=void 0===n.field;v=Object(m.jsx)(c.EuiFormRow,{label:u.i18n.translate("xpack.maps.metricsEditor.selectFieldLabel",{defaultMessage:"Field"}),display:"columnCompressed",isInvalid:t,error:u.i18n.translate("xpack.maps.metricsEditor.selectFieldError",{defaultMessage:"Field required for aggregation"})},Object(m.jsx)(_.a,{placeholder:S.a.fieldSelectPlaceholder,value:n.field?n.field:null,onChange:f,fields:M(e,n.type),isClearable:!1,isInvalid:t,compressed:!0}))}if(n.type===d.b.PERCENTILE){const t=u.i18n.translate("xpack.maps.metricsEditor.selectPercentileLabel",{defaultMessage:"Percentile"});w=Object(m.jsx)(x.a,{min:0,max:100,onChange:g,label:t,initialValue:"number"==typeof n.percentile?n.percentile:d.v,display:"columnCompressed"})}return n.type&&(C=Object(m.jsx)(c.EuiFormRow,{label:u.i18n.translate("xpack.maps.metricsEditor.customLabel",{defaultMessage:"Custom label"}),display:"columnCompressed"},Object(m.jsx)(c.EuiFieldText,{onChange:t=>{o({...n,label:t.target.value})},value:n.label?n.label:"",compressed:!0}))),h&&(T=Object(m.jsx)("div",{className:"mapMetricEditorPanel__metricRemoveButton"},Object(m.jsx)(c.EuiButtonEmpty,{iconType:"trash",size:"xs",color:"danger",onClick:p,"aria-label":u.i18n.translate("xpack.maps.metricsEditor.deleteMetricAriaLabel",{defaultMessage:"Delete metric"})},Object(m.jsx)(l.FormattedMessage,{id:"xpack.maps.metricsEditor.deleteMetricButtonLabel",defaultMessage:"Delete metric"})))),Object(m.jsx)(a.Fragment,null,Object(m.jsx)(c.EuiFormRow,{label:u.i18n.translate("xpack.maps.metricsEditor.aggregationLabel",{defaultMessage:"Aggregation"}),display:"columnCompressed"},Object(m.jsx)(y,{onChange:t=>{if(!t)return;const i={type:t,label:n.label};if(t===d.b.COUNT||!("field"in n)||!n.field)return void o(i);const r=M(e,t).find((t=>t.name===n.field)),a={...i,field:r?n.field:void 0};t===d.b.PERCENTILE?o({...a,percentile:"percentile"in n?n.percentile:d.v}):o(a)},value:n.type,metricsFilter:r,compressed:!0})),v,w,C,Object(m.jsx)(c.EuiFormRow,{label:Object(b.f)({bucketsName:t,isJoin:i}),display:"columnCompressed"},Object(m.jsx)(mask_expression_MaskExpression,{fields:e,isJoin:i,metric:n,onChange:o})),T)}class metrics_editor_MetricsEditor extends a.Component{constructor(t){super(t),n()(this,"_addMetric",(()=>{this.setState({metrics:[...this.state.metrics,{type:d.b.COUNT}]},this._onSubmit)})),this.state={metrics:0===this.props.metrics.length?[f.b]:this.props.metrics}}_onSubmit(){this.state.metrics.some((t=>{return!((e=t).type===d.b.COUNT||void 0!==e.field);var e}))||this.props.onChange(this.state.metrics)}_renderMetrics(){return this.state.metrics.map(((t,e)=>Object(m.jsx)("div",{key:e,className:"mapMetricEditorPanel__metricEditor"},Object(m.jsx)(T,{bucketsName:this.props.bucketsName,isJoin:this.props.isJoin,onChange:t=>{this.setState({metrics:[...this.state.metrics.slice(0,e),t,...this.state.metrics.slice(e+1)]},this._onSubmit)},metric:t,fields:this.props.fields,metricsFilter:this.props.metricsFilter,showRemoveButton:e>0,onRemove:()=>{this.setState({metrics:[...this.state.metrics.slice(0,e),...this.state.metrics.slice(e+1)]},this._onSubmit)}}))))}_renderAddMetricButton(){return this.props.allowMultipleMetrics?Object(m.jsx)(a.Fragment,null,Object(m.jsx)(c.EuiSpacer,{size:"xs"}),Object(m.jsx)(c.EuiTextAlign,{textAlign:"center"},Object(m.jsx)(c.EuiButtonEmpty,{onClick:this._addMetric,size:"xs",iconType:"plusInCircleFilled"},Object(m.jsx)(l.FormattedMessage,{id:"xpack.maps.metricsEditor.addMetricButtonLabel",defaultMessage:"Add metric"})))):null}render(){return Object(m.jsx)(a.Fragment,null,Object(m.jsx)("div",{className:"mapMapLayerPanel__metrics"},this._renderMetrics()),this._renderAddMetricButton())}}},,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return SymbolIcon}));var r=i(18),n=i.n(r),a=i(6),o=i.n(a),l=i(2),c=i(115),u=i(4);class SymbolIcon extends l.Component{constructor(...t){super(...t),o()(this,"_isMounted",!1),o()(this,"state",{imgDataUrl:null})}componentDidMount(){this._isMounted=!0,this._loadSymbol()}componentWillUnmount(){this._isMounted=!1}async _loadSymbol(){let t;try{const e=await Object(c.k)(this.props.svg,this.props.fill,this.props.stroke);t=Object(c.d)(e)}catch(t){return}this._isMounted&&this.setState({imgDataUrl:t})}render(){if(!this.state.imgDataUrl)return null;const{symbolId:t,fill:e,stroke:i,...r}=this.props;return Object(u.jsx)("img",n()({width:"16px",height:"18px",src:this.state.imgDataUrl,alt:this.props.symbolId},r))}}},function(t,e,i){(function(){var e,r={}.hasOwnProperty;e=i(107),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},function(t,e){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},function(t,e,i){"use strict";(function(e){void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,i,r,n){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,o,l=arguments.length;switch(l){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,i)}));case 3:return e.nextTick((function(){t.call(null,i,r)}));case 4:return e.nextTick((function(){t.call(null,i,r,n)}));default:for(a=new Array(l-1),o=0;o<a.length;)a[o++]=arguments[o];return e.nextTick((function(){t.apply(null,a)}))}}}:t.exports=e}).call(this,i(127))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(0);function n(t){var e;return(null==t||null===(e=t.right)||void 0===e?void 0:e.type)===r.Cb.ES_DISTANCE_SOURCE}},function(t,e,i){"use strict";i.d(e,"a",(function(){return InlineField}));var r=i(6),n=i.n(r),a=i(169);class InlineField extends a.a{constructor({fieldName:t,label:e,source:i,origin:r,dataType:a}){super({fieldName:t,origin:r}),n()(this,"_label",void 0),n()(this,"_source",void 0),n()(this,"_dataType",void 0),this._label=e,this._source=i,this._dataType=a}supportsFieldMetaFromEs(){return!1}supportsFieldMetaFromLocalData(){return!0}getSource(){return this._source}async getLabel(){return this._label?this._label:this.getName()}async getDataType(){return this._dataType}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},function(t,e,i){(function(){var e,r,n,a,o,l,c,u,h={}.hasOwnProperty;u=i(119),c=u.isObject,l=u.isFunction,o=u.getValue,a=i(107),e=i(96),r=i(309),n=i(222),t.exports=function(t){function i(t,r,n){var a,o,l,c;if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(r),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(o=0,l=(c=t.children).length;o<l;o++)if((a=c[o]).type===e.DocType){a.name=this.name;break}}return function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(i.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(i.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),i.prototype.clone=function(){var t,e,i,r;for(e in(i=Object.create(this)).isRoot&&(i.documentObject=null),i.attribs={},r=this.attribs)h.call(r,e)&&(t=r[e],i.attribs[e]=t.clone());return i.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=i,i.children.push(e)})),i},i.prototype.attribute=function(t,e){var i,n;if(null!=t&&(t=o(t)),c(t))for(i in t)h.call(t,i)&&(n=t[i],this.attribute(i,n));else l(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new r(this,t,""):null!=e&&(this.attribs[t]=new r(this,t,e));return this},i.prototype.removeAttribute=function(t){var e,i,r;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=o(t),Array.isArray(t))for(i=0,r=t.length;i<r;i++)e=t[i],delete this.attribs[e];else delete this.attribs[t];return this},i.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},i.prototype.att=function(t,e){return this.attribute(t,e)},i.prototype.a=function(t,e){return this.attribute(t,e)},i.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},i.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},i.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},i.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},i.prototype.setIdAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.isEqualNode=function(t){var e,r,n;if(!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=r=0,n=this.attribs.length-1;0<=n?r<=n:r>=n;e=0<=n?++r:--r)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},i}(a)}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(96),r=i(185),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(96),r=i(185),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n,a={}.hasOwnProperty;n=i(119).isObject,r=i(107),e=i(96),t.exports=function(t){function i(t,r,a,o){var l;i.__super__.constructor.call(this,t),n(r)&&(r=(l=r).version,a=l.encoding,o=l.standalone),r||(r="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(r),null!=a&&(this.encoding=this.stringify.xmlEncoding(a)),null!=o&&(this.standalone=this.stringify.xmlStandalone(o))}return function(t,e){for(var i in e)a.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n,a,o,l,c,u,h={}.hasOwnProperty;u=i(119).isObject,c=i(107),e=i(96),r=i(227),a=i(228),n=i(229),o=i(230),l=i(222),t.exports=function(t){function i(t,r,n){var a,o,l,c,h,p;if(i.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(o=0,l=(c=t.children).length;o<l;o++)if((a=c[o]).type===e.Element){this.name=a.name;break}this.documentObject=t,u(r)&&(r=(h=r).pubID,n=h.sysID),null==n&&(n=(p=[r,n])[0],r=p[1]),null!=r&&(this.pubID=this.stringify.dtdPubID(r)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"entities",{get:function(){var t,i,r,n,a;for(n={},i=0,r=(a=this.children).length;i<r;i++)(t=a[i]).type!==e.EntityDeclaration||t.pe||(n[t.name]=t);return new l(n)}}),Object.defineProperty(i.prototype,"notations",{get:function(){var t,i,r,n,a;for(n={},i=0,r=(a=this.children).length;i<r;i++)(t=a[i]).type===e.NotationDeclaration&&(n[t.name]=t);return new l(n)}}),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),i.prototype.element=function(t,e){var i;return i=new n(this,t,e),this.children.push(i),this},i.prototype.attList=function(t,e,i,n,a){var o;return o=new r(this,t,e,i,n,a),this.children.push(o),this},i.prototype.entity=function(t,e){var i;return i=new a(this,!1,t,e),this.children.push(i),this},i.prototype.pEntity=function(t,e){var i;return i=new a(this,!0,t,e),this.children.push(i),this},i.prototype.notation=function(t,e){var i;return i=new o(this,t,e),this.children.push(i),this},i.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},i.prototype.ele=function(t,e){return this.element(t,e)},i.prototype.att=function(t,e,i,r,n){return this.attList(t,e,i,r,n)},i.prototype.ent=function(t,e){return this.entity(t,e)},i.prototype.pent=function(t,e){return this.pEntity(t,e)},i.prototype.not=function(t,e){return this.notation(t,e)},i.prototype.up=function(){return this.root()||this.documentObject},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId},i}(c)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(107),e=i(96),t.exports=function(t){function i(t,r,n,a,o,l){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(r));if(!a)throw new Error("Missing DTD attribute type. "+this.debugInfo(r));if(!o)throw new Error("Missing DTD attribute default. "+this.debugInfo(r));if(0!==o.indexOf("#")&&(o="#"+o),!o.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(r));if(l&&!o.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(r));this.elementName=this.stringify.name(r),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(a),l&&(this.defaultValue=this.stringify.dtdAttDefault(l)),this.defaultValueType=o}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n,a={}.hasOwnProperty;n=i(119).isObject,r=i(107),e=i(96),t.exports=function(t){function i(t,r,a,o){if(i.__super__.constructor.call(this,t),null==a)throw new Error("Missing DTD entity name. "+this.debugInfo(a));if(null==o)throw new Error("Missing DTD entity value. "+this.debugInfo(a));if(this.pe=!!r,this.name=this.stringify.name(a),this.type=e.EntityDeclaration,n(o)){if(!o.pubID&&!o.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(a));if(o.pubID&&!o.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(a));if(this.internal=!1,null!=o.pubID&&(this.pubID=this.stringify.dtdPubID(o.pubID)),null!=o.sysID&&(this.sysID=this.stringify.dtdSysID(o.sysID)),null!=o.nData&&(this.nData=this.stringify.dtdNData(o.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(a))}else this.value=this.stringify.dtdEntityValue(o),this.internal=!0}return function(t,e){for(var i in e)a.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(107),e=i(96),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(r),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(107),e=i(96),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD notation name. "+this.debugInfo(r));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(r));this.name=this.stringify.name(r),this.type=e.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),i.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(96),r=i(107),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(96),r=i(185),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"wholeText",{get:function(){var t,e,i;for(i="",e=this.previousSibling;e;)i=e.data+i,e=e.previousSibling;for(i+=this.data,t=this.nextSibling;t;)i+=t.data,t=t.nextSibling;return i}}),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},i.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(r)}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(96),r=i(185),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(r),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},i}(r)}).call(this)},function(t,e,i){(function(){var e,r={}.hasOwnProperty;e=i(312),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var i,r,n,a,o;for(e=this.filterOptions(e),a="",r=0,n=(o=t.children).length;r<n;r++)i=o[r],a+=this.writeChildNode(i,e,0);return e.pretty&&a.slice(-e.newline.length)===e.newline&&(a=a.slice(0,-e.newline.length)),a},e}(e)}).call(this)},function(t,e,i){(e=t.exports=i(313)).Stream=e,e.Readable=e,e.Writable=i(237),e.Duplex=i(138),e.Transform=i(317),e.PassThrough=i(522)},function(t,e,i){var r=i(143),n=r.Buffer;function a(t,e){for(var i in t)e[i]=t[i]}function o(t,e,i){return n(t,e,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(a(r,e),e.Buffer=o),a(n,o),o.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return n(t,e,i)},o.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=n(t);return void 0!==e?"string"==typeof i?r.fill(e,i):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,i){"use strict";(function(e,r,n){var a=i(187);function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var r=t.entry;for(t.entry=null;r;){var n=r.callback;e.pendingcb--,n(undefined),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=v;var l,c=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:a.nextTick;v.WritableState=_;var u=Object.create(i(168));u.inherits=i(150);var h,p={deprecate:i(520)},d=i(314),f=i(236).Buffer,m=n.Uint8Array||function(){},g=i(315);function y(){}function _(t,e){l=l||i(138),t=t||{};var r=e instanceof l;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,u=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(u||0===u)?u:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var p=!1===t.decodeStrings;this.decodeStrings=!p,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,r=i.sync,n=i.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,r,n){--e.pendingcb,i?(a.nextTick(n,r),a.nextTick(M,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(n(r),t._writableState.errorEmitted=!0,t.emit("error",r),M(t,e))}(t,i,r,e,n);else{var o=C(i);o||i.corked||i.bufferProcessing||!i.bufferedRequest||w(t,i),r?c(b,t,i,o,n):b(t,i,o,n)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function v(t){if(l=l||i(138),!(h.call(v,this)||this instanceof l))return new v(t);this._writableState=new _(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function x(t,e,i,r,n,a,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,i?t._writev(n,e.onwrite):t._write(n,a,e.onwrite),e.sync=!1}function b(t,e,i,r){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),M(t,e)}function w(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,n=new Array(r),a=e.corkedRequestsFree;a.entry=i;for(var l=0,c=!0;i;)n[l]=i,i.isBuf||(c=!1),i=i.next,l+=1;n.allBuffers=c,x(t,e,!0,e.length,n,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,h=i.encoding,p=i.callback;if(x(t,e,!1,e.objectMode?1:u.length,u,h,p),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function C(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final((function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),M(t,e)}))}function M(t,e){var i=C(e);return i&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,a.nextTick(S,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}u.inherits(v,d),_.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(_.prototype,"buffer",{get:p.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!h.call(this,t)||this===v&&t&&t._writableState instanceof _}})):h=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,i){var r,n=this._writableState,o=!1,l=!n.objectMode&&(r=t,f.isBuffer(r)||r instanceof m);return l&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(i=e,e=null),l?e="buffer":e||(e=n.defaultEncoding),"function"!=typeof i&&(i=y),n.ended?function(t,e){var i=new Error("write after end");t.emit("error",i),a.nextTick(e,i)}(this,i):(l||function(t,e,i,r){var n=!0,o=!1;return null===i?o=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),a.nextTick(r,o),n=!1),n}(this,n,t,i))&&(n.pendingcb++,o=function(t,e,i,r,n,a){if(!i){var o=function(t,e,i){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,i)),e}(e,r,n);r!==o&&(i=!0,n="buffer",r=o)}var l=e.objectMode?1:r.length;e.length+=l;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:a,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else x(t,e,!1,l,r,n,a);return c}(this,n,l,t,e,i)),o},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,i){var r=this._writableState;"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,i){e.ending=!0,M(t,e),i&&(e.finished?a.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}(this,r,i)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,i(127),i(316).setImmediate,i(118))},function(t,e,i){"use strict";var r=i(521).Buffer,n=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===n||!n(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=c,this.end=u,e=4;break;case"utf8":this.fillLast=l,e=4;break;case"base64":this.text=h,this.end=p,e=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function l(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function c(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function h(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function p(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function f(t){return t&&t.length?this.write(t):""}e.StringDecoder=a,a.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},a.prototype.text=function(t,e){var i=function(t,e,i){var r=e.length-1;if(r<i)return 0;var n=o(e[r]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--r<i||-2===n?0:(n=o(e[r]))>=0?(n>0&&(t.lastNeed=n-2),n):--r<i||-2===n?0:(n=o(e[r]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var r=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,i){"use strict";i.d(e,"a",(function(){return MaskLegend}));var r=i(6),n=i.n(r),a=i(2),o=i(3),l=i(14),c=i(0),u=i(129),h=i(4);class MaskLegend extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",!1),n()(this,"state",{}),n()(this,"_loadAggLabel",(async()=>{const t=await this.props.esAggField.getLabel();this._isMounted&&t!==this.state.aggLabel&&this.setState({aggLabel:t})}))}componentDidMount(){this._isMounted=!0,this._loadAggLabel()}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(){this._loadAggLabel()}_getBucketsName(){const t=this.props.esAggField.getSource();return"getBucketsName"in t?t.getBucketsName():void 0}_getPrefix(){if(this.props.onlyShowLabelAndValue)return o.i18n.translate("xpack.maps.maskLegend.is",{defaultMessage:"{aggLabel} is",values:{aggLabel:this.state.aggLabel}});const t=this.props.esAggField.getOrigin()===c.D.JOIN;return`${Object(u.f)({bucketsName:this._getBucketsName(),isJoin:t})} ${Object(u.e)({aggLabel:this.state.aggLabel,isJoin:t})}`}render(){return Object(h.jsx)(l.EuiText,{size:"xs",textAlign:"left",color:"subdued"},Object(h.jsx)("small",null,`${this._getPrefix()} `,Object(h.jsx)("strong",null,Object(u.g)(this.props.operator,this.props.value))))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i(2);var r=i(14),n=i(4);function a({header:t,minLabel:e,maxLabel:i,propertyLabel:a,fieldLabel:o,invert:l}){return Object(n.jsx)("div",null,Object(n.jsx)(r.EuiFlexGroup,{gutterSize:"xs",justifyContent:"spaceBetween"},Object(n.jsx)(r.EuiFlexItem,{grow:!1},Object(n.jsx)(r.EuiToolTip,{position:"top",title:a,content:o},Object(n.jsx)(r.EuiText,{className:"eui-textTruncate",size:"xs",style:{maxWidth:"180px"}},Object(n.jsx)("small",null,Object(n.jsx)("strong",null,o)))))),t,Object(n.jsx)(r.EuiFlexGroup,{gutterSize:"xs",justifyContent:"spaceBetween"},Object(n.jsx)(r.EuiFlexItem,{grow:!0},Object(n.jsx)(r.EuiText,{size:"xs"},Object(n.jsx)("small",null,l?i:e))),Object(n.jsx)(r.EuiFlexItem,{grow:!0},Object(n.jsx)(r.EuiText,{textAlign:"right",size:"xs"},Object(n.jsx)("small",null,l?e:i)))))}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(0);function n(t){return[r.b.COUNT,r.b.SUM,r.b.UNIQUE_COUNT].includes(t)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(53),n=i.n(r);function a(t,e,i,r,a,o){return{...i,fieldNames:n.a.uniq(e).sort(),sourceQuery:r||void 0,applyGlobalQuery:t.getApplyGlobalQuery(),applyGlobalTime:t.getApplyGlobalTime(),sourceMeta:t.getSyncMeta(i),applyForceRefresh:t.getApplyForceRefresh(),isForceRefresh:a,isFeatureEditorOpenForLayer:o}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(124),n=i(101);e.default=function(t,e,i){void 0===i&&(i={});var a=r.getCoord(t),o=r.getCoord(e),l=n.degreesToRadians(o[1]-a[1]),c=n.degreesToRadians(o[0]-a[0]),u=n.degreesToRadians(a[1]),h=n.degreesToRadians(o[1]),p=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(u)*Math.cos(h);return n.radiansToLength(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),i.units)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(0);function n(t){return t===r.L.COARSE?{minSize:16,maxSize:48}:t===r.L.FINE?{minSize:8,maxSize:24}:t===r.L.MOST_FINE?{minSize:4,maxSize:12}:{minSize:2,maxSize:6}}},,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return m})),i(2);var r=i(14),n=i(3),a=i(0),o=i(5),l=i(24);const c=n.i18n.translate("xpack.maps.source.esGeoGrid.pointsDropdownOption",{defaultMessage:"Clusters"}),u=n.i18n.translate("xpack.maps.source.esGeoGrid.gridRectangleDropdownOption",{defaultMessage:"Grids"}),h=n.i18n.translate("xpack.maps.source.esGeoGrid.hexDropdownOption",{defaultMessage:"Hexagons"});var p=i(54),d=i(4);function f(t){return Object(d.jsx)(r.EuiToolTip,{content:Object(d.jsx)(r.EuiText,{size:"s"},Object(d.jsx)("dl",null,Object(d.jsx)("dt",null,c),Object(d.jsx)("dd",null,Object(d.jsx)("p",null,Object(d.jsx)(p.FormattedMessage,{id:"xpack.maps.source.esGeoGrid.clusterDescription",defaultMessage:"Group documents into grids with a weighted center for each grid cell."}))),Object(d.jsx)("dt",null,u),Object(d.jsx)("dd",null,Object(d.jsx)("p",null,Object(d.jsx)(p.FormattedMessage,{id:"xpack.maps.source.esGeoGrid.gridDescription",defaultMessage:"Group documents into grids."}))),Object(d.jsx)("dt",null,h),Object(d.jsx)("dd",null,Object(d.jsx)("p",null,Object(d.jsx)(p.FormattedMessage,{id:"xpack.maps.source.esGeoGrid.hexDescription",defaultMessage:"Group documents into hexagons."})),t.isHexDisabled?Object(d.jsx)("em",null,t.hexDisabledReason):null)))},Object(d.jsx)("span",null,Object(d.jsx)(p.FormattedMessage,{id:"xpack.maps.source.esGeoGrid.showAsLabel",defaultMessage:"Show as"})," ",Object(d.jsx)(r.EuiIcon,{type:"questionInCircle",color:"subdued"})))}function m(t){if(t.renderAs===a.ub.HEATMAP)return null;let e=!1,i="";Object(o.y)()||Object(l.b)()||(e=!0,i=n.i18n.translate("xpack.maps.hexbin.license.disabledReason",{defaultMessage:"{hexLabel} is a subscription feature.",values:{hexLabel:h}}));const p=[{id:a.ub.POINT,label:c,value:a.ub.POINT},{id:a.ub.GRID,label:u,value:a.ub.GRID},{id:a.ub.HEX,label:h,value:a.ub.HEX,isDisabled:e}],m=p.find((e=>e.value===t.renderAs))||p[0],g=Object(d.jsx)(f,{isHexDisabled:e,hexDisabledReason:i});return Object(d.jsx)(r.EuiFormRow,{label:g,display:t.isColumnCompressed?"columnCompressed":"row"},Object(d.jsx)(r.EuiButtonGroup,{type:"single",legend:n.i18n.translate("xpack.maps.source.esGeoGrid.showAsSelector",{defaultMessage:"Choose the display method"}),options:p,idSelected:m.id,onChange:function(e){const i=p.find((t=>t.id===e));i&&t.onChange(i.value)},isFullWidth:!0,buttonSize:"compressed"}))}},,,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(101);e.default=function(t,e){void 0===e&&(e={});var i=Number(t[0]),n=Number(t[1]),a=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[i,n],c=[i,o],u=[a,o],h=[a,n];return r.polygon([[l,h,u,c,l]],e.properties,{bbox:t,id:e.id})}},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(i(166)),a=r(i(376)),o=r(i(377)),l=i(124);function c(t,e){var i,r=!1;for(i=0;i<t.coordinates.length;i++)if(y(t.coordinates[i],e.coordinates)){r=!0;break}return r}function u(t,e){for(var i=0,r=e.coordinates;i<r.length;i++){for(var n=r[i],a=!1,o=0,l=t.coordinates;o<l.length;o++)if(y(n,l[o])){a=!0;break}if(!a)return!1}return!0}function h(t,e){for(var i=!1,r=0,n=e.coordinates;r<n.length;r++){var a=n[r];if(o.default(a,t,{ignoreEndVertices:!0})&&(i=!0),!o.default(a,t))return!1}return!!i}function p(t,e){for(var i=0,r=e.coordinates;i<r.length;i++){var n=r[i];if(!a.default(n,t,{ignoreBoundary:!0}))return!1}return!0}function d(t,e){for(var i=!1,r=0,n=e.coordinates;r<n.length;r++){var a=n[r];if(o.default({type:"Point",coordinates:a},t,{ignoreEndVertices:!0})&&(i=!0),!o.default({type:"Point",coordinates:a},t,{ignoreEndVertices:!1}))return!1}return i}function f(t,e){var i=!1,r=0;if(!g(n.default(t),n.default(e)))return!1;for(;r<e.coordinates.length-1;r++){var o=_(e.coordinates[r],e.coordinates[r+1]);if(a.default({type:"Point",coordinates:o},t,{ignoreBoundary:!0})){i=!0;break}}return i}function m(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!g(n.default(t),n.default(e)))return!1;for(var i=0,r=l.getGeom(e).coordinates;i<r.length;i++)for(var o=0,c=r[i];o<c.length;o++){var u=c[o];if(!a.default(u,t))return!1}return!0}function g(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function y(t,e){return t[0]===e[0]&&t[1]===e[1]}function _(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}e.default=function(t,e){var i=l.getGeom(t),r=l.getGeom(e),n=l.getType(t),g=l.getType(e),_=l.getCoords(t),v=l.getCoords(e);switch(n){case"Point":if("Point"===g)return y(_,v);throw new Error("feature2 "+g+" geometry not supported");case"MultiPoint":switch(g){case"Point":return c(i,r);case"MultiPoint":return u(i,r);default:throw new Error("feature2 "+g+" geometry not supported")}case"LineString":switch(g){case"Point":return o.default(r,i,{ignoreEndVertices:!0});case"LineString":return d(i,r);case"MultiPoint":return h(i,r);default:throw new Error("feature2 "+g+" geometry not supported")}case"Polygon":switch(g){case"Point":return a.default(r,i,{ignoreBoundary:!0});case"LineString":return f(i,r);case"Polygon":return m(i,r);case"MultiPoint":return p(i,r);default:throw new Error("feature2 "+g+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},e.isPointInMultiPoint=c,e.isMultiPointInMultiPoint=u,e.isMultiPointOnLine=h,e.isMultiPointInPoly=p,e.isLineOnLine=d,e.isLineInPoly=f,e.isPolyInPoly=m,e.doBBoxOverlap=g,e.compareCoords=y,e.getMidpoint=_},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(378),n=i(384),a=i(101),o=i(124),l=i(144);e.default=function t(e,i){switch(void 0===i&&(i={}),o.getType(e)){case"Point":return e;case"Polygon":var c=[];l.coordEach(e,(function(t){c.push(t)}));var u,h,p,d,f,m,g,y,_=n.default(e,{properties:i.properties}),v=_.geometry.coordinates,x=0,b=0,w=0,C=c.map((function(t){return[t[0]-v[0],t[1]-v[1]]}));for(u=0;u<c.length-1;u++)d=(h=C[u])[0],m=h[1],f=(p=C[u+1])[0],w+=y=d*(g=p[1])-f*m,x+=(d+f)*y,b+=(m+g)*y;if(0===w)return _;var S=1/(.5*w*6);return a.point([v[0]+S*x,v[1]+S*b],i.properties);default:var M=r.default(e);return M?t(M,{properties:i.properties}):n.default(e,{properties:i.properties})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){(function(){"use strict";var t,r,n,a,o={}.hasOwnProperty;r=i(220),t=i(503),n=i(512),a=i(318),e.defaults=r.defaults,e.processors=a,e.ValidationError=function(t){function e(t){this.message=t}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,Error),e}(),e.Builder=t.Builder,e.Parser=n.Parser,e.parseString=n.parseString,e.parseStringPromise=n.parseStringPromise}).call(this)},function(t,e){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},function(t,e,i){(function(){var e,r,n,a,o,l,c,u={}.hasOwnProperty;c=i(119).isPlainObject,n=i(307),r=i(505),a=i(107),e=i(96),l=i(311),o=i(234),t.exports=function(t){function i(t){i.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new r,t||(t={}),t.writer||(t.writer=new o),this.options=t,this.stringify=new l(t)}return function(t,e){for(var i in e)u.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"implementation",{value:new n}),Object.defineProperty(i.prototype,"doctype",{get:function(){var t,i,r,n;for(i=0,r=(n=this.children).length;i<r;i++)if((t=n[i]).type===e.DocType)return t;return null}}),Object.defineProperty(i.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(i.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(i.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(i.prototype,"origin",{get:function(){return null}}),Object.defineProperty(i.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(i.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(i.prototype,"contentType",{get:function(){return null}}),i.prototype.end=function(t){var e;return e={},t?c(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},i.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},i.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.renameNode=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createNodeIterator=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTreeWalker=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(a)}).call(this)},function(t,e,i){(function(){var e;e=i(96),i(107),t.exports=function(){function t(t,i,r){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==i)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(r),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value},t}()}).call(this)},function(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(107),e=i(96),t.exports=function(t){function i(t){i.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return""},i}(r)}).call(this)},function(t,e){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty;t.exports=function(){function t(t){var r,n,a;for(r in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),n=t.stringify||{})i.call(n,r)&&(a=n[r],this[r]=a)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,i;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+i.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+i.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},function(t,e,i){(function(){var e,r,n,a={}.hasOwnProperty;n=i(119).assign,e=i(96),i(225),i(226),i(223),i(224),i(221),i(231),i(232),i(233),i(310),i(227),i(229),i(228),i(230),r=i(186),t.exports=function(){function t(t){var e,i,r;for(e in t||(t={}),this.options=t,i=t.writer||{})a.call(i,e)&&(r=i[e],this["_"+e]=this[e],this[e]=r)}return t.prototype.filterOptions=function(t){var e,i,a,o,l,c,u,h;return t||(t={}),t=n({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(i=t.indent)?i:"  ",e.newline=null!=(a=t.newline)?a:"\n",e.offset=null!=(o=t.offset)?o:0,e.dontPrettyTextNodes=null!=(l=null!=(c=t.dontPrettyTextNodes)?c:t.dontprettytextnodes)?l:0,e.spaceBeforeSlash=null!=(u=null!=(h=t.spaceBeforeSlash)?h:t.spacebeforeslash)?u:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=r.None,e},t.prototype.indent=function(t,e,i){var r;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(r=(i||0)+e.offset+1)>0?new Array(r).join(e.indent):""},t.prototype.endline=function(t,e,i){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,i){var r;return this.openAttribute(t,e,i),r=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,i),r},t.prototype.cdata=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<![CDATA[",e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+="]]>"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.comment=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"\x3c!-- ",e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=" --\x3e"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.declaration=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<?xml",e.state=r.InsideTag,n+=' version="'+t.version+'"',null!=t.encoding&&(n+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(n+=' standalone="'+t.standalone+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.docType=function(t,e,i){var n,a,o,l,c;if(i||(i=0),this.openNode(t,e,i),e.state=r.OpenTag,l=this.indent(t,e,i),l+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?l+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(l+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(l+=" [",l+=this.endline(t,e,i),e.state=r.InsideTag,a=0,o=(c=t.children).length;a<o;a++)n=c[a],l+=this.writeChildNode(n,e,i+1);e.state=r.CloseTag,l+="]"}return e.state=r.CloseTag,l+=e.spaceBeforeSlash+">",l+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),l},t.prototype.element=function(t,i,n){var o,l,c,u,h,p,d,f,m,g,y,_,v,x;for(m in n||(n=0),g=!1,y="",this.openNode(t,i,n),i.state=r.OpenTag,y+=this.indent(t,i,n)+"<"+t.name,_=t.attribs)a.call(_,m)&&(o=_[m],y+=this.attribute(o,i,n));if(u=0===(c=t.children.length)?null:t.children[0],0===c||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(y+=">",i.state=r.CloseTag,y+="</"+t.name+">"+this.endline(t,i,n)):(i.state=r.CloseTag,y+=i.spaceBeforeSlash+"/>"+this.endline(t,i,n));else if(!i.pretty||1!==c||u.type!==e.Text&&u.type!==e.Raw||null==u.value){if(i.dontPrettyTextNodes)for(h=0,d=(v=t.children).length;h<d;h++)if(((l=v[h]).type===e.Text||l.type===e.Raw)&&null!=l.value){i.suppressPrettyCount++,g=!0;break}for(y+=">"+this.endline(t,i,n),i.state=r.InsideTag,p=0,f=(x=t.children).length;p<f;p++)l=x[p],y+=this.writeChildNode(l,i,n+1);i.state=r.CloseTag,y+=this.indent(t,i,n)+"</"+t.name+">",g&&i.suppressPrettyCount--,y+=this.endline(t,i,n),i.state=r.None}else y+=">",i.state=r.InsideTag,i.suppressPrettyCount++,g=!0,y+=this.writeChildNode(u,i,n+1),i.suppressPrettyCount--,g=!1,i.state=r.CloseTag,y+="</"+t.name+">"+this.endline(t,i,n);return this.closeNode(t,i,n),y},t.prototype.writeChildNode=function(t,i,r){switch(t.type){case e.CData:return this.cdata(t,i,r);case e.Comment:return this.comment(t,i,r);case e.Element:return this.element(t,i,r);case e.Raw:return this.raw(t,i,r);case e.Text:return this.text(t,i,r);case e.ProcessingInstruction:return this.processingInstruction(t,i,r);case e.Dummy:return"";case e.Declaration:return this.declaration(t,i,r);case e.DocType:return this.docType(t,i,r);case e.AttributeDeclaration:return this.dtdAttList(t,i,r);case e.ElementDeclaration:return this.dtdElement(t,i,r);case e.EntityDeclaration:return this.dtdEntity(t,i,r);case e.NotationDeclaration:return this.dtdNotation(t,i,r);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<?",e.state=r.InsideTag,n+=t.target,t.value&&(n+=" "+t.value),e.state=r.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.raw=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i),e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.text=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i),e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdAttList=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ATTLIST",e.state=r.InsideTag,n+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(n+=" "+t.defaultValueType),t.defaultValue&&(n+=' "'+t.defaultValue+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdElement=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ELEMENT",e.state=r.InsideTag,n+=" "+t.name+" "+t.value,e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdEntity=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ENTITY",e.state=r.InsideTag,t.pe&&(n+=" %"),n+=" "+t.name,t.value?n+=' "'+t.value+'"':(t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.nData&&(n+=" NDATA "+t.nData)),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdNotation=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!NOTATION",e.state=r.InsideTag,n+=" "+t.name,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?n+=' PUBLIC "'+t.pubID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.openNode=function(t,e,i){},t.prototype.closeNode=function(t,e,i){},t.prototype.openAttribute=function(t,e,i){},t.prototype.closeAttribute=function(t,e,i){},t}()}).call(this)},function(t,e,i){"use strict";(function(e,r){var n=i(187);t.exports=x;var a,o=i(515);x.ReadableState=v,i(145).EventEmitter;var l=function(t,e){return t.listeners(e).length},c=i(314),u=i(236).Buffer,h=e.Uint8Array||function(){},p=Object.create(i(168));p.inherits=i(150);var d=i(516),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var m,g=i(517),y=i(315);p.inherits(x,c);var _=["error","close","destroy","pause","resume"];function v(t,e){t=t||{};var r=e instanceof(a=a||i(138));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,o=t.readableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(o||0===o)?o:l,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(m||(m=i(238).StringDecoder),this.decoder=new m(t.encoding),this.encoding=t.encoding)}function x(t){if(a=a||i(138),!(this instanceof x))return new x(t);this._readableState=new v(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function b(t,e,i,r,n){var a,o=t._readableState;return null===e?(o.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,M(t)}}(t,o)):(n||(a=function(t,e){var i,r;return r=e,u.isBuffer(r)||r instanceof h||"string"==typeof e||void 0===e||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i}(o,e)),a?t.emit("error",a):o.objectMode||e&&e.length>0?("string"==typeof e||o.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||0!==e.length?w(t,o,e,!1):E(t,o)):w(t,o,e,!1))):r||(o.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(o)}function w(t,e,i,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,r?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&M(t)),E(t,e)}Object.defineProperty(x.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),x.prototype.destroy=y.destroy,x.prototype._undestroy=y.undestroy,x.prototype._destroy=function(t,e){this.push(null),e(t)},x.prototype.push=function(t,e){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),i=!0),b(this,t,e,!1,i)},x.prototype.unshift=function(t){return b(this,t,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(t){return m||(m=i(238).StringDecoder),this._readableState.decoder=new m(t),this._readableState.encoding=t,this};var C=8388608;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=C?t=C:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function M(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(f("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?n.nextTick(T,t):T(t))}function T(t){f("emit readable"),t.emit("readable"),O(t)}function E(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(A,t,e))}function A(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(f("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}function I(t){f("readable nexttick read 0"),t.read(0)}function P(t,e){e.reading||(f("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),O(t),e.flowing&&!e.reading&&t.read(0)}function O(t){var e=t._readableState;for(f("flow",e.flowing);e.flowing&&null!==t.read(););}function k(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):i=function(t,e,i){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():i?function(t,e){var i=e.head,r=1,n=i.data;for(t-=n.length;i=i.next;){var a=i.data,o=t>a.length?a.length:t;if(o===a.length?n+=a:n+=a.slice(0,t),0==(t-=o)){o===a.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=a.slice(o));break}++r}return e.length-=r,n}(t,e):function(t,e){var i=u.allocUnsafe(t),r=e.head,n=1;for(r.data.copy(i),t-=r.data.length;r=r.next;){var a=r.data,o=t>a.length?a.length:t;if(a.copy(i,i.length-t,0,o),0==(t-=o)){o===a.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=a.slice(o));break}++n}return e.length-=n,i}(t,e),r}(t,e.buffer,e.decoder),i);var i}function D(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,n.nextTick(F,e,t))}function F(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function z(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}x.prototype.read=function(t){f("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return f("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?D(this):M(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&D(this),null;var r,n=e.needReadable;return f("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&f("length less than watermark",n=!0),e.ended||e.reading?f("reading or ended",n=!1):n&&(f("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(i,e))),null===(r=t>0?k(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&D(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},x.prototype.pipe=function(t,e){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,e);var c=e&&!1===e.end||t===r.stdout||t===r.stderr?v:u;function u(){f("onend"),t.end()}a.endEmitted?n.nextTick(c):i.once("end",c),t.on("unpipe",(function e(r,n){f("onunpipe"),r===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),t.removeListener("close",y),t.removeListener("finish",_),t.removeListener("drain",h),t.removeListener("error",g),t.removeListener("unpipe",e),i.removeListener("end",u),i.removeListener("end",v),i.removeListener("data",m),p=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}));var h=function(t){return function(){var e=t._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&l(t,"data")&&(e.flowing=!0,O(t))}}(i);t.on("drain",h);var p=!1,d=!1;function m(e){f("ondata"),d=!1,!1!==t.write(e)||d||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==z(a.pipes,t))&&!p&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,d=!0),i.pause())}function g(e){f("onerror",e),v(),t.removeListener("error",g),0===l(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",_),v()}function _(){f("onfinish"),t.removeListener("close",y),v()}function v(){f("unpipe"),i.unpipe(t)}return i.on("data",m),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?o(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",g),t.once("close",y),t.once("finish",_),t.emit("pipe",i),a.flowing||(f("pipe resume"),i.resume()),t},x.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i)),this;if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this,i);return this}var o=z(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i)),this},x.prototype.on=function(t,e){var i=c.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&M(this):n.nextTick(I,this))}return i},x.prototype.addListener=x.prototype.on,x.prototype.resume=function(){var t=this._readableState;return t.flowing||(f("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(P,t,e))}(this,t)),this},x.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},x.prototype.wrap=function(t){var e=this,i=this._readableState,r=!1;for(var n in t.on("end",(function(){if(f("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(n){f("wrapped data"),i.decoder&&(n=i.decoder.write(n)),i.objectMode&&null==n||(i.objectMode||n&&n.length)&&(e.push(n)||(r=!0,t.pause()))})),t)void 0===this[n]&&"function"==typeof t[n]&&(this[n]=function(e){return function(){return t[e].apply(t,arguments)}}(n));for(var a=0;a<_.length;a++)t.on(_[a],this.emit.bind(this,_[a]));return this._read=function(e){f("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),x._fromList=k}).call(this,i(118),i(127))},function(t,e,i){t.exports=i(145).EventEmitter},function(t,e,i){"use strict";var r=i(187);function n(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var i=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(n,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(n,i,t),i._writableState&&(i._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,i){(function(t){var r=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new n(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(519),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(118))},function(t,e,i){"use strict";t.exports=o;var r=i(138),n=Object.create(i(168));function a(t,e){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=e&&this.push(e),r(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",l)}function l(){var t=this;"function"==typeof this._flush?this._flush((function(e,i){c(t,e,i)})):c(this,null,null)}function c(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}n.inherits=i(150),n.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,i){var r=this._transformState;if(r.writecb=i,r.writechunk=t,r.writeencoding=e,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var i=this;r.prototype._destroy.call(this,t,(function(t){e(t),i.emit("close")}))}},function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(306);async function n(t){const e=new Promise(((e,i)=>{Object(r.parseString)(t,((t,r)=>{t?i(t):e(r)}))}));return await e}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));const r={aerialway:{label:"Aerialway",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="aerialway-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13,5H8V2.6c0.1854-0.1047,0.3325-0.2659,0.42-0.46L13.5,1.5C13.7761,1.5,14,1.2761,14,1s-0.2239-0.5-0.5-0.5L8.28,1.15&#xA;&#x9;C8.0954,0.9037,7.8077,0.7562,7.5,0.75C7.0963,0.752,6.7334,0.9966,6.58,1.37L1.5,2C1.2239,2,1,2.2239,1,2.5S1.2239,3,1.5,3&#xA;&#x9;l5.22-0.65C6.7967,2.4503,6.8917,2.5351,7,2.6V5H2C1.4477,5,1,5.4477,1,6v7c0,0.5523,0.4477,1,1,1h11c0.5523,0,1-0.4477,1-1V6&#xA;&#x9;C14,5.4477,13.5523,5,13,5z M7,11H3V7h4V11z M12,11H8V7h4V11z"/>\n</svg>'},airfield:{label:"Airfield",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="airfield-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5" d="M6.8182,0.6818H4.7727&#xA;&#x9;C4.0909,0.6818,4.0909,0,4.7727,0h5.4545c0.6818,0,0.6818,0.6818,0,0.6818H8.1818c0,0,0.8182,0.5909,0.8182,1.9545V4h6v2L9,8l-0.5,5&#xA;&#x9;l2.5,1.3182V15H4v-0.6818L6.5,13L6,8L0,6V4h6V2.6364C6,1.2727,6.8182,0.6818,6.8182,0.6818z"/>\n</svg>'},airport:{label:"Airport",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="airport-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path7712-0" d="M15,6.8182L15,8.5l-6.5-1&#xA;&#x9;l-0.3182,4.7727L11,14v1l-3.5-0.6818L4,15v-1l2.8182-1.7273L6.5,7.5L0,8.5V6.8182L6.5,4.5v-3c0,0,0-1.5,1-1.5s1,1.5,1,1.5v2.8182&#xA;&#x9;L15,6.8182z"/>\n</svg>'},"alcohol-shop":{label:"Alcohol shop",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="alcohol-shop-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,4h-4v3.44l0,0c0,0,0,0,0,0.06c0.003,0.9096,0.6193,1.7026,1.5,1.93V13H11c-0.2761,0-0.5,0.2239-0.5,0.5&#xA;&#x9;S10.7239,14,11,14h2c0.2761,0,0.5-0.2239,0.5-0.5S13.2761,13,13,13h-0.5V9.43c0.8807-0.2274,1.497-1.0204,1.5-1.93c0,0,0,0,0-0.06&#xA;&#x9;l0,0V4z M13,7.5c0,0.5523-0.4477,1-1,1s-1-0.4477-1-1V5h2V7.5z M5.5,2.5V2C5.7761,2,6,1.7761,6,1.5S5.7761,1,5.5,1V0.5&#xA;&#x9;C5.5,0.2239,5.2761,0,5,0H4C3.7239,0,3.5,0.2239,3.5,0.5V1C3.2239,1,3,1.2239,3,1.5S3.2239,2,3.5,2v0.5C3.5,3.93,1,5.57,1,7v6&#xA;&#x9;c0,0.5523,0.4477,1,1,1h5c0.5318-0.0465,0.9535-0.4682,1-1V7C8,5.65,5.5,3.85,5.5,2.5z M4.5,12C3.1193,12,2,10.8807,2,9.5&#xA;&#x9;S3.1193,7,4.5,7S7,8.1193,7,9.5S5.8807,12,4.5,12z"/>\n</svg>'},"american-football":{label:"American football",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="american-football-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7.53,3C3.09,3,1,7.5,1,7.5S3.09,12,7.53,12S14,7.5,14,7.5S12,3,7.53,3z M11,7v1.5C11,8.7761,10.7761,9,10.5,9&#xA;&#x9;S10,8.7761,10,8.5V8H8v0.5C8,8.7761,7.7761,9,7.5,9S7,8.7761,7,8.5V8H5v0.5C5,8.7761,4.7761,9,4.5,9S4,8.7761,4,8.5v-2&#xA;&#x9;C4,6.2239,4.2239,6,4.5,6S5,6.2239,5,6.5V7h2V6.5C7,6.2239,7.2239,6,7.5,6S8,6.2239,8,6.5V7h2V6.5C10,6.2239,10.2239,6,10.5,6&#xA;&#x9;S11,6.2239,11,6.5V7z"/>\n</svg>'},"amusement-park":{label:"Amusement park",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="amusement-park-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5082" d="M7.5,0C3.919,0,1,2.919,1,6.5c0,2.3161,1.2251,4.3484,3.0566,5.5H4l-1,2h9l-1-2h-0.0566&#xA;&#x9;C12.7749,10.8484,14,8.8161,14,6.5C14,2.919,11.081,0,7.5,0z M7.375,1.5059v3.5c-0.3108,0.026-0.6057,0.1482-0.8438,0.3496&#xA;&#x9;L4.0566,2.8809C4.9243,2.0555,6.0851,1.5376,7.375,1.5059z M7.625,1.5059c1.2899,0.0317,2.4507,0.5496,3.3184,1.375L8.4688,5.3555&#xA;&#x9;c-0.0007-0.0007-0.0013-0.0013-0.002-0.002C8.229,5.1532,7.9348,5.0317,7.625,5.0059V1.5059z M3.8809,3.0566l2.4746,2.4746&#xA;&#x9;c-0.0007,0.0007-0.0013,0.0013-0.002,0.002C6.1532,5.771,6.0317,6.0652,6.0059,6.375h-3.5&#xA;&#x9;C2.5376,5.0851,3.0555,3.9243,3.8809,3.0566z M11.1191,3.0566c0.8254,0.8676,1.3433,2.0285,1.375,3.3184h-3.5&#xA;&#x9;c-0.026-0.3108-0.1482-0.6057-0.3496-0.8438L11.1191,3.0566z M2.5059,6.625h3.5c0.026,0.3108,0.1482,0.6057,0.3496,0.8438&#xA;&#x9;L3.8809,9.9434C3.0555,9.0757,2.5376,7.9149,2.5059,6.625z M8.9941,6.625h3.5c-0.0317,1.2899-0.5496,2.4507-1.375,3.3184&#xA;&#x9;L8.6445,7.4688c0.0007-0.0007,0.0013-0.0013,0.002-0.002C8.8468,7.229,8.9683,6.9348,8.9941,6.625z M6.5312,7.6445&#xA;&#x9;c0.0007,0.0007,0.0013,0.0013,0.002,0.002C6.6716,7.7624,6.8297,7.8524,7,7.9121v3.5625c-1.1403-0.1124-2.1606-0.6108-2.9434-1.3555&#xA;&#x9;L6.5312,7.6445z M8.4688,7.6445l2.4746,2.4746c-0.7828,0.7447-1.803,1.243-2.9434,1.3555V7.9121&#xA;&#x9;C8.1711,7.852,8.33,7.7613,8.4688,7.6445z"/>\n</svg>'},aquarium:{label:"Aquarium",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="aquarium-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M10.9,11.6c-0.3-0.6-0.3-2.3,0-2.8c0.4-0.6,3.4,1.4,3.4,1.4c0.9,0.4,0.9-6.1,0-5.7&#xA;&#x9;c0,0-3.1,2.1-3.4,1.4c-0.3-0.7-0.3-2.1,0-2.8C11.2,2.5,15,2.4,15,2.4C15,1.7,12.1,1,10.9,1S8.4,1.1,6.8,1.8C5.2,2.4,3.9,3.4,2.7,4.6&#xA;&#x9;S0,8.2,0,8.9s1.5,2.8,3.7,3.7s3.3,1.1,4.5,1.3c1.1,0.1,2.6,0,3.9-0.3c1-0.2,2.9-0.7,2.9-1.1C15,12.3,11.2,12.2,10.9,11.6z M4.5,9.3&#xA;&#x9;C3.7,9.3,3,8.6,3,7.8s0.7-1.5,1.5-1.5S6,7,6,7.8S5.3,9.3,4.5,9.3z"/>\n</svg>'},"arrow-es":{label:"Arrow",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="arrow-es-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M10.2605799,13.3863593 C10.1395968,13.4287864 10.0527368,13.45 10,13.45 C9.86888463,13.45 9.7495566,13.3995324 9.66038175,13.3169629 C9.62336122,13.2826846 7.87888372,11.1717162 7.85312988,11.1460236 C7.76268134,11.05579 7.6378559,11 7.5,11 C7.36106093,11 7.23535789,11.0566702 7.14474446,11.1481569 C7.11712067,11.176047 5.38316951,13.2743383 5.3512134,13.3058781 C5.26092214,13.3949932 5.13688483,13.45 5,13.45 C4.94846592,13.45 4.86607927,13.4308817 4.75284004,13.3926451 C3.95322232,13.0192244 3.32116699,12.5002136 3.1295929,12.3130188 C3.04943242,12.222975 2.999749,12.1044865 2.999749,11.9743938 C2.999749,11.8971872 3.01724809,11.8240676 3.04849642,11.7587851 L7.04,1.29 L7.04612499,1.289958 C7.12548958,1.1187486 7.29887718,1 7.5,1 C7.6986843,1 7.87030186,1.11588651 7.9509469,1.28375376 L7.95635553,1.28371668 L11.962677,11.7834625 C11.993942,11.8487592 12.0005287,11.9135014 12.0005287,11.99073 C12.0005287,12.1135282 11.962677,12.2262726 11.8828125,12.3130188 C11.7159576,12.47 10.804184,13.1774445 10.2605799,13.3863593 Z"/>\n</svg>'},"art-gallery":{label:"Art gallery",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="art-gallery-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M10.71,4L7.85,1.15C7.6555,0.9539,7.339,0.9526,7.1429,1.1471C7.1419,1.1481,7.141,1.149,7.14,1.15L4.29,4H1.5&#xA;&#x9;C1.2239,4,1,4.2239,1,4.5v9C1,13.7761,1.2239,14,1.5,14h12c0.2761,0,0.5-0.2239,0.5-0.5v-9C14,4.2239,13.7761,4,13.5,4H10.71z&#xA;&#x9; M7.5,2.21L9.29,4H5.71L7.5,2.21z M13,13H2V5h11V13z M5,8C4.4477,8,4,7.5523,4,7s0.4477-1,1-1s1,0.4477,1,1S5.5523,8,5,8z M12,12&#xA;&#x9;H4.5L6,9l1.25,2.5L9.5,7L12,12z"/>\n</svg>'},attraction:{label:"Attraction",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="attraction-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect7143" d="M6,2C5.446,2,5.2478,2.5045,5,3L4.5,4h-2C1.669,4,1,4.669,1,5.5v5C1,11.331,1.669,12,2.5,12h10&#xA;&#x9;c0.831,0,1.5-0.669,1.5-1.5v-5C14,4.669,13.331,4,12.5,4h-2L10,3C9.75,2.5,9.554,2,9,2H6z M2.5,5C2.7761,5,3,5.2239,3,5.5&#xA;&#x9;S2.7761,6,2.5,6S2,5.7761,2,5.5S2.2239,5,2.5,5z M7.5,5c1.6569,0,3,1.3431,3,3s-1.3431,3-3,3s-3-1.3431-3-3S5.8431,5,7.5,5z&#xA;&#x9; M7.5,6.5C6.6716,6.5,6,7.1716,6,8l0,0c0,0.8284,0.6716,1.5,1.5,1.5l0,0C8.3284,9.5,9,8.8284,9,8l0,0C9,7.1716,8.3284,6.5,7.5,6.5&#xA;&#x9;L7.5,6.5z"/>\n</svg>'},bakery:{label:"Bakery",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bakery-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5230" d="M5.2941,4.3824L6,9.5&#xA;&#x9;c0,0,0,1,1,1h1c1,0,1-1,1-1l0.7059-5.1176C9.7059,3,7.5,3,7.5,3S5.291,3,5.2941,4.3824z M3.5,5C2,5,2,6,2,6l1,4h1.5&#xA;&#x9;c0.755,0,0.7941-0.7647,0.7941-0.7647L4.5,5H3.5z M1.5,7.5c0,0-0.6176-0.0294-1.0588,0.4118C0,8.3529,0,8.7941,0,8.7941V11h0.8824&#xA;&#x9;C2,11,2,10,2,10L1.5,7.5z"/>\n  <path id="path5230-2" d="M11.5,5C13,5,13,6,13,6l-1,4h-1.5&#xA;&#x9;c-0.755,0-0.7941-0.7647-0.7941-0.7647L10.5,5H11.5z M13.5,7.5c0,0,0.6176-0.0294,1.0588,0.4118C15,8.3529,15,8.7941,15,8.7941V11&#xA;&#x9;h-0.8824C13,11,13,10,13,10L13.5,7.5z"/>\n</svg>'},bank:{label:"Bank",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bank-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect5668" d="M1,3C0.446,3,0,3.446,0,4v7c0,0.554,0.446,1,1,1h13c0.554,0,1-0.446,1-1V4c0-0.554-0.446-1-1-1H1z M1,4h1.5&#xA;&#x9;C2.7761,4,3,4.2239,3,4.5S2.7761,5,2.5,5S2,4.7761,2,4.5L1.5,5C1.7761,5,2,5.2239,2,5.5S1.7761,6,1.5,6S1,5.7761,1,5.5V4z M7.5,4&#xA;&#x9;C8.8807,4,10,5.567,10,7.5l0,0C10,9.433,8.8807,11,7.5,11S5,9.433,5,7.5S6.1193,4,7.5,4z M12.5,4H14v1.5C14,5.7761,13.7761,6,13.5,6&#xA;&#x9;S13,5.7761,13,5.5S13.2239,5,13.5,5L13,4.5C13,4.7761,12.7761,5,12.5,5S12,4.7761,12,4.5S12.2239,4,12.5,4z M7.5,5.5&#xA;&#x9;c-0.323,0-0.5336,0.1088-0.6816,0.25h1.3633C8.0336,5.6088,7.823,5.5,7.5,5.5z M6.625,6C6.5795,6.091,6.5633,6.1711,6.5449,6.25&#xA;&#x9;h1.9102C8.4367,6.1711,8.4205,6.091,8.375,6H6.625z M6.5,6.5v0.25h2V6.5H6.5z M6.5,7v0.25h2V7H6.5z M6.5,7.5v0.25h2V7.5H6.5z M6.5,8&#xA;&#x9;L6.25,8.25h2L8.5,8H6.5z M6,8.5c0,0,0.0353,0.1024,0.1016,0.25H8.375L8,8.5H6z M1.5,9C1.7761,9,2,9.2239,2,9.5S1.7761,10,1.5,10&#xA;&#x9;L2,10.5C2,10.2239,2.2239,10,2.5,10S3,10.2239,3,10.5S2.7761,11,2.5,11H1V9.5C1,9.2239,1.2239,9,1.5,9z M6.2383,9&#xA;&#x9;C6.2842,9.0856,6.3144,9.159,6.375,9.25h2.2676C8.7092,9.1121,8.75,9,8.75,9H6.2383z M13.5,9C13.7761,9,14,9.2239,14,9.5V11h-1.5&#xA;&#x9;c-0.2761,0-0.5-0.2239-0.5-0.5s0.2239-0.5,0.5-0.5s0.5,0.2239,0.5,0.5l0.5-0.5C13.2239,10,13,9.7761,13,9.5S13.2239,9,13.5,9z&#xA;&#x9; M6.5664,9.5c0.0786,0.0912,0.1647,0.1763,0.2598,0.25h1.4199C8.3462,9.6727,8.4338,9.5883,8.5,9.5H6.5664z"/>\n</svg>'},bar:{label:"Bar",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bar-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4" d="M7.5,1c-2,0-7,0.25-6.5,0.75L7,8v4&#xA;&#x9;c0,1-3,0.5-3,2h7c0-1.5-3-1-3-2V8l6-6.25C14.5,1.25,9.5,1,7.5,1z M7.5,2c2.5,0,4.75,0.25,4.75,0.25L11.5,3h-8L2.75,2.25&#xA;&#x9;C2.75,2.25,5,2,7.5,2z"/>\n</svg>'},barrier:{label:"Barrier",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="barrier-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M13,3H2A1,1,0,0,0,1,4v6a1,1,0,0,0,1,1H3v2.5a.5.5,0,0,0,1,0V13h7v.5a.5.5,0,0,0,1,0V11h1a1,1,0,0,0,1-1V4A1,1,0,0,0,13,3Zm0,1V6L11,4ZM9.5,4,13,7.5V10L7,4Zm-4,6L2,6.5V4l6,6ZM2,10V8l2,2Zm9,2H4V11h7Zm-.207-2H9.5l-6-6h2l6,6Z"/>\n</svg>'},baseball:{label:"Baseball",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="baseball-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M10,3.5C10,4.3284,9.3284,5,8.5,5S7,4.3284,7,3.5S7.6716,2,8.5,2S10,2.6716,10,3.5z M7,0.28C7,0.1254,6.8746,0,6.72,0&#xA;&#x9;c0,0,0,0,0,0C6.6221,0.0262,6.5348,0.0821,6.47,0.16L4,4.59C3.9941,4.6331,3.9941,4.6769,4,4.72C4,4.8746,4.1254,5,4.28,5&#xA;&#x9;c0.1015-0.0243,0.1926-0.0803,0.26-0.16L7,0.41C7.006,0.3669,7.006,0.3231,7,0.28z M12.9,14.2L12.9,14.2L10,6.39l0,0&#xA;&#x9;C9.9526,6.1627,9.7522,5.9999,9.52,6h-5c-0.2761,0-0.5,0.2239-0.5,0.5S4.2439,7,4.52,7H7l1.45,2.51l-4.27,4.61l0,0&#xA;&#x9;C4.0659,14.2132,3.9998,14.3527,4,14.5C4,14.7761,4.2239,15,4.5,15c0.1224-0.0006,0.2401-0.047,0.33-0.13l0,0l4.45-4.15l2.76,4l0,0&#xA;&#x9;c0.0895,0.1592,0.2574,0.2584,0.44,0.26c0.2796,0.0002,0.5092-0.2207,0.52-0.5C12.9958,14.3787,12.961,14.281,12.9,14.2z"/>\n</svg>'},basketball:{label:"Basketball",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="basketball-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="icon_concepts:_sports_leisure" d="M3.66,7.0016H2.03a5.3231,5.3231,0,0,1,1.01-2.71A8.7122,8.7122,0,0,1,3.66,7.0016Zm1.075,0h2.34v-4.97a5.4585,5.4585,0,0,0-3.24,1.44A9.2947,9.2947,0,0,1,4.735,7.0016Zm3.19-4.97v4.97h2.34a9.2947,9.2947,0,0,1,.9-3.53A5.4585,5.4585,0,0,0,7.925,2.0316Zm4.035,2.26a8.7122,8.7122,0,0,0-.62,2.71h1.63A5.3231,5.3231,0,0,0,11.96,4.2916ZM14,8.7516a.7555.7555,0,0,1-.75.75H11.72l-.76,1.52v2.38a.392.392,0,0,1-.24.35.5863.5863,0,0,1-.14.02.3274.3274,0,0,1-.26-.11l-1.02-1.01-1.59,1.06a.3975.3975,0,0,1-.42,0l-1.59-1.06-1.02,1.01a.3709.3709,0,0,1-.4.09.392.392,0,0,1-.24-.35v-2.38l-.76-1.52H1.75a.75.75,0,0,1,0-1.5h11.5A.749.749,0,0,1,14,8.75Zm-7.14.75H4.12l.63,1.27a.3175.3175,0,0,1,.04.16v1.56l.56-.55Zm1.98,2.55L7.5,9.8916l-1.34,2.16,1.34.9Zm2.05-2.55H8.14l1.51,2.44.56.55v-1.56a.3175.3175,0,0,1,.04-.16Z"/>\n</svg>'},bbq:{label:"BBQ",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="bbq-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M9.32,7.655C10.8782,7.108,11.9471,5.6506,12,4H3c0.053,1.6299,1.0978,3.0728,2.63,3.631L4.923,9.044&#xA;&#x9;c-1.3571-0.2355-2.6482,0.6737-2.8837,2.0308s0.6737,2.6482,2.0308,2.8837C4.9927,14.1187,5.9273,13.7485,6.49,13h4.223l0.335,0.717&#xA;&#x9;c0.0836,0.1735,0.2594,0.2836,0.452,0.283c0.0733,0.0003,0.1457-0.0158,0.212-0.047c0.2497-0.117,0.3575-0.4141,0.241-0.664&#xA;&#x9;L9.32,7.655z M4.5,12.75c-0.6904,0-1.25-0.5596-1.25-1.25s0.5596-1.25,1.25-1.25s1.25,0.5596,1.25,1.25&#xA;&#x9;C5.7484,12.1897,5.1897,12.7484,4.5,12.75z M6.95,12c0.2066-1.007-0.2268-2.0374-1.091-2.594L6.6,7.923&#xA;&#x9;c0.577,0.1042,1.168,0.1042,1.745,0l1.9,4.07L6.95,12z M4.75,1C4.6119,1,4.5,1.1119,4.5,1.25c0,0.5-0.5,0.5-0.5,0.5c-1,0-1,1-1,1&#xA;&#x9;C3,2.8881,3.1119,3,3.25,3S3.5,2.8881,3.5,2.75c0-0.5,0.5-0.5,0.5-0.5c1,0,1-1,1-1C5,1.1119,4.8881,1,4.75,1z M6.75,1&#xA;&#x9;C6.6119,1,6.5,1.1119,6.5,1.25c0,0.5-0.5,0.5-0.5,0.5c-1,0-1,1-1,1C5,2.8881,5.1119,3,5.25,3S5.5,2.8881,5.5,2.75&#xA;&#x9;c0-0.5,0.5-0.5,0.5-0.5c1,0,1-1,1-1C7,1.1119,6.8881,1,6.75,1z M8.75,1C8.6119,1,8.5,1.1119,8.5,1.25c0,0.5-0.5,0.5-0.5,0.5&#xA;&#x9;c-1,0-1,1-1,1C7,2.8881,7.1119,3,7.25,3S7.5,2.8881,7.5,2.75c0-0.5,0.5-0.5,0.5-0.5c1,0,1-1,1-1C9,1.1119,8.8881,1,8.75,1z M10.75,1&#xA;&#x9;c-0.1381,0-0.25,0.1119-0.25,0.25c0,0.5-0.5,0.5-0.5,0.5c-1,0-1,1-1,1C9,2.8881,9.1119,3,9.25,3S9.5,2.8881,9.5,2.75&#xA;&#x9;c0-0.5,0.5-0.5,0.5-0.5c1,0,1-1,1-1C11,1.1119,10.8881,1,10.75,1z M12.75,1c-0.1381,0-0.25,0.1119-0.25,0.25c0,0.5-0.5,0.5-0.5,0.5&#xA;&#x9;c-1,0-1,1-1,1C11,2.8881,11.1119,3,11.25,3s0.25-0.1119,0.25-0.25c0-0.5,0.5-0.5,0.5-0.5c1,0,1-1,1-1C13,1.1119,12.8881,1,12.75,1z"/>\n</svg>'},beach:{label:"Beach",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="beach-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M5.3608,1.67l-.01,4.02a4.4523,4.4523,0,0,0-1.1-.11c-.37.1-.74.63-1.1.76A4.2019,4.2019,0,0,1,5.3608,1.67Zm2.41-.64,2.03,3.45a3.1832,3.1832,0,0,1,.84-.61c.36-.1.94.17,1.34.11A4.2018,4.2018,0,0,0,7.7708,1.03ZM1.0008,13h13c-.66-.66-2.64-1.11-4.34-1.33l-1.87-7c.52-.05,1.15.03,1.53,0l-2.11-3.6h-.01a6.1743,6.1743,0,0,0-.7.14,4.3792,4.3792,0,0,0-.64.22l-.01,4.15c.35-.17.84-.54,1.3-.74l1.8,6.74c-.58-.05-1.09-.08-1.45-.08C6.0308,11.5,2.0008,12,1.0008,13Z"/>\n</svg>'},beer:{label:"Beer",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="beer-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12,5V2c0,0-1-1-4.5-1S3,2,3,2v3c0.0288,1.3915,0.3706,2.7586,1,4c0.6255,1.4348,0.6255,3.0652,0,4.5c0,0,0,1,3.5,1&#xA;&#x9;s3.5-1,3.5-1c-0.6255-1.4348-0.6255-3.0652,0-4.5C11.6294,7.7586,11.9712,6.3915,12,5z M7.5,13.5&#xA;&#x9;c-0.7966,0.035-1.5937-0.0596-2.36-0.28c0.203-0.7224,0.304-1.4696,0.3-2.22h4.12c-0.004,0.7504,0.097,1.4976,0.3,2.22&#xA;&#x9;C9.0937,13.4404,8.2966,13.535,7.5,13.5z M7.5,5C6.3136,5.0299,5.1306,4.8609,4,4.5v-2C5.131,2.1411,6.3137,1.9722,7.5,2&#xA;&#x9;C8.6863,1.9722,9.869,2.1411,11,2.5v2C9.8694,4.8609,8.6864,5.0299,7.5,5z"/>\n</svg>'},bicycle:{label:"Bicycle",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bicycle-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4668" d="&#xA;&#x9;M7.5,2c-0.6761-0.01-0.6761,1.0096,0,1H9v1.2656l-2.8027,2.334L5.2226,4H5.5c0.6761,0.01,0.6761-1.0096,0-1h-2&#xA;&#x9;c-0.6761-0.01-0.6761,1.0096,0,1h0.6523L5.043,6.375C4.5752,6.1424,4.0559,6,3.5,6C1.5729,6,0,7.5729,0,9.5S1.5729,13,3.5,13&#xA;&#x9;S7,11.4271,7,9.5c0-0.6699-0.2003-1.2911-0.5293-1.8242L9.291,5.3262l0.4629,1.1602C8.7114,7.0937,8,8.2112,8,9.5&#xA;&#x9;c0,1.9271,1.5729,3.5,3.5,3.5S15,11.4271,15,9.5S13.4271,6,11.5,6c-0.2831,0-0.5544,0.0434-0.8184,0.1074L10,4.4023V2.5&#xA;&#x9;c0-0.2761-0.2239-0.5-0.5-0.5H7.5z M3.5,7c0.5923,0,1.1276,0.2119,1.5547,0.5527l-1.875,1.5625&#xA;&#x9;c-0.5109,0.4273,0.1278,1.1945,0.6406,0.7695l1.875-1.5625C5.8835,8.674,6,9.0711,6,9.5C6,10.8866,4.8866,12,3.5,12S1,10.8866,1,9.5&#xA;&#x9;S2.1133,7,3.5,7L3.5,7z M11.5,7C12.8866,7,14,8.1134,14,9.5S12.8866,12,11.5,12S9,10.8866,9,9.5c0-0.877,0.4468-1.6421,1.125-2.0879&#xA;&#x9;l0.9102,2.2734c0.246,0.6231,1.1804,0.2501,0.9297-0.3711l-0.9082-2.2695C11.2009,7.0193,11.3481,7,11.5,7L11.5,7z"/>\n</svg>'},"bicycle-share":{label:"Bicycle share",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bicycle-share-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="circle4604" d="&#xA;&#x9;M10,1C9.4477,1,9,1.4477,9,2c0,0.5523,0.4477,1,1,1s1-0.4477,1-1C11,1.4477,10.5523,1,10,1z M8.1445,2.9941&#xA;&#x9;c-0.13,0.0005-0.2547,0.0517-0.3477,0.1426l-2.6406,2.5c-0.2256,0.2128-0.2051,0.5775,0.043,0.7637L7,7.75v2.75&#xA;&#x9;c-0.01,0.6762,1.0096,0.6762,1,0v-3c0.0003-0.1574-0.0735-0.3057-0.1992-0.4004L7.0332,6.5234l1.818-1.7212l0.7484,0.9985&#xA;&#x9;C9.6943,5.9265,9.8426,6.0003,10,6h1.5c0.6761,0.01,0.6761-1.0096,0-1h-1.25L9.5,4L8.9004,3.1992&#xA;&#x9;C8.8103,3.0756,8.6685,3,8.5156,2.9941H8.1445z M3,7c-1.6569,0-3,1.3432-3,3s1.3431,3,3,3s3-1.3432,3-3S4.6569,7,3,7z M12,7&#xA;&#x9;c-1.6569,0-3,1.3432-3,3s1.3431,3,3,3s3-1.3432,3-3S13.6569,7,12,7z M3,8c1.1046,0,2,0.8954,2,2s-0.8954,2-2,2s-2-0.8954-2-2&#xA;&#x9;S1.8954,8,3,8z M12,8c1.1046,0,2,0.8954,2,2s-0.8954,2-2,2s-2-0.8954-2-2S10.8954,8,12,8z"/>\n</svg>'},"blood-bank":{label:"Blood bank",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="blood-bank-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11.2,7.1L11.2,7.1L7.5,2L3.8,7.1h0C3.3,7.8,3,8.7,3,9.6C3,12,5,14,7.5,14c0,0,0,0,0,0C10,14,12,12,12,9.6c0,0,0,0,0,0&#xA;&#x9;C12,8.7,11.7,7.8,11.2,7.1z M10,10H8v2H7v-2H5V9h2V7h1v2h2V10z"/>\n</svg>'},"boat-es":{label:"Boat",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="boat-es-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7.5,1 C8,1 9.87566518,2.18104212 10.5,4.5 C10.9049265,6.00401254 11.0940068,8.88591087 11,13.1405515 C10.9938023,13.421051 10.753592,13.5685436 10.630388,13.6000274 C9.58692536,13.8666758 8.54346268,14 7.5,14 C6.45774448,14 5.41548895,13.8669841 4.37323343,13.6009523 C4.24882229,13.5691968 4,13.4234619 4,13.1482845 C4,8.89280475 4.09292918,6.01197734 4.5,4.5 C5.1272892,2.1700687 7,1 7.5,1 Z M5,6.5 L5,7 C5.23163517,6.54355194 6.28428417,6 7.49376313,6 C8.70324208,6 9.76836483,6.54355194 10,7 L10,6.5 C10,5.67157288 8.874475,5 7.49376313,5 C6.11305125,5 5,5.67157288 5,6.5 Z M6,8 C5.44771525,8 5,8.44771525 5,9 L5,11 C5,11.5522847 5.44771525,12 6,12 L9,12 C9.55228475,12 10,11.5522847 10,11 L10,9 C10,8.44771525 9.55228475,8 9,8 L6,8 Z"/>\n</svg>'},"bowling-alley":{label:"Bowling alley",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="bowling-alley-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="icon_concepts:_sports_leisure" d="M8.83,5.39a11.0127,11.0127,0,0,0-.96,4.28,11.4686,11.4686,0,0,0,.58,3.69A4.9424,4.9424,0,0,1,6,14,5,5,0,1,1,8.98,4.99C8.94,5.12,8.88,5.25,8.83,5.39ZM4.12,8.5a.62.62,0,1,0-.62.62h0a.6105.6105,0,0,0,.62-.6009C4.12,8.5128,4.12,8.5064,4.12,8.5ZM4.5,7.12a.62.62,0,1,0-.62-.62h0a.6106.6106,0,0,0,.6011.62ZM6.12,8.5a.62.62,0,1,0-.62.62h0a.6105.6105,0,0,0,.62-.6009C6.12,8.5128,6.12,8.5064,6.12,8.5Zm4.8022-5.3341c0-.7222-.1444-.7222-.1444-1.4444a.7222.7222,0,0,1,1.4444-.0007v.0007c0,.7222-.1444.7222-.1444,1.4444,0,2.1667,1.5528,3.6168,1.5528,6.5,0,2.1667-.6861,4.3333-1.4083,4.3333H10.7778c-.7222,0-1.4083-2.1667-1.4083-4.3333C9.3694,6.7826,10.9222,5.3325,10.9222,3.1659Z"/>\n</svg>'},bridge:{label:"Bridge",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="bridge-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M0,8.842V13h2v-1c0.036-1.089,0.911-1.964,2-2c1.089,0.036,1.964,0.911,2,2v1h3v-1c0.036-1.089,0.911-1.964,2-2&#xA;&#x9;c1.089,0.036,1.964,0.911,2,2v1h2V8.842C10.6,3.082,3.071,4.4,0,8.842z M9.5,5.734c0.514,0.121,1.016,0.289,1.5,0.5V9H9.5V5.734z&#xA;&#x9; M9,5.634V9H7.5V5.506C8.003,5.506,8.505,5.549,9,5.634z M3.5,6.477C3.98,6.229,4.482,6.026,5,5.871V9H3.5V6.477z M5.5,9V5.73&#xA;&#x9;C5.993,5.615,6.495,5.543,7,5.515V9H5.5z M3,6.744V9H0.5C1.176,8.094,2.032,7.328,3,6.744z M11.5,9V6.5l-0.053-0.053&#xA;&#x9;C12.649,7.05,13.694,7.924,14.5,9H11.5z"/>\n</svg>'},building:{label:"Building",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="building-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M3,2v11h5v-3h3v3h1V2H3z M7,12H4v-2h3V12z M7,9H4V7h3V9z M7,6H4V4h3V6z M11,9H8V7h3V9z M11,6H8V4h3V6z"/>\n</svg>'},"building-alt1":{label:"Building 2",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="building-alt1-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,13.5v-9C11,4.2,10.8,4,10.5,4H9V1L5,2.1v11.4H2V14h11v-0.5H11z M7,13.5V3h1v10.5H7z"/>\n</svg>'},bus:{label:"Bus",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="bus-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path8043" d="M4,0C2.6364,0,1,0.7433,1,2.7461v5.4531V12c0,0,0,1,1,1v1c0,0,0,1,1,1s1-1,1-1v-1h7v1c0,0,0,1,1,1s1-1,1-1v-1&#xA;&#x9;c0,0,1,0,1-1V2.7461C14,0.7006,12.764,0,11.4004,0H4z M4.25,1.5h6.5C10.8885,1.5,11,1.6115,11,1.75S10.8885,2,10.75,2h-6.5&#xA;&#x9;C4.1115,2,4,1.8885,4,1.75S4.1115,1.5,4.25,1.5z M3,3h9c1,0,1,0.9668,1,0.9668V7c0,0,0,1-1,1H3C2,8,2,7,2,7V4C2,4,2,3,3,3z M3,10&#xA;&#x9;c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1s-1-0.4477-1-1S2.4477,10,3,10z M12,10c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1s-1-0.4477-1-1&#xA;&#x9;S11.4477,10,12,10z"/>\n</svg>'},cafe:{label:"Cafe",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="cafe-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12,5h-2V3H2v4c0.0133,2.2091,1.8149,3.9891,4.024,3.9758C7.4345,10.9673,8.7362,10.2166,9.45,9H12c1.1046,0,2-0.8954,2-2&#xA;&#x9;S13.1046,5,12,5z M12,8H9.86C9.9487,7.6739,9.9958,7.3379,10,7V6h2c0.5523,0,1,0.4477,1,1S12.5523,8,12,8z M10,12.5&#xA;&#x9;c0,0.2761-0.2239,0.5-0.5,0.5h-7C2.2239,13,2,12.7761,2,12.5S2.2239,12,2.5,12h7C9.7761,12,10,12.2239,10,12.5z"/>\n</svg>'},campsite:{label:"Campsite",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="campsite-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect3335" d="M7,1.5&#xA;&#x9;l-5.5,9H1c-1,0-1,1-1,1v1c0,0,0,1,1,1h13c1,0,1-1,1-1v-1c0,0,0-1-1-1h-0.5L8,1.5C7.8,1.1,7.2,1.1,7,1.5z M7.5,5l3.2,5.5H4.2L7.5,5z"/>\n</svg>'},car:{label:"Car",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="car-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,7c-0.004-0.6904-0.4787-1.2889-1.15-1.45l-1.39-3.24l0,0l0,0l0,0C11.3833,2.1233,11.2019,2.001,11,2H4&#xA;&#x9;C3.8124,2.0034,3.6425,2.1115,3.56,2.28l0,0l0,0l0,0L2.15,5.54C1.475,5.702,0.9994,6.3059,1,7v3.5h1v1c0,0.5523,0.4477,1,1,1&#xA;&#x9;s1-0.4477,1-1v-1h7v1c0,0.5523,0.4477,1,1,1s1-0.4477,1-1v-1h1V7z M4.3,3h6.4l1.05,2.5h-8.5L4.3,3z M3,9C2.4477,9,2,8.5523,2,8&#xA;&#x9;s0.4477-1,1-1s1,0.4477,1,1S3.5523,9,3,9z M12,9c-0.5523,0-1-0.4477-1-1s0.4477-1,1-1s1,0.4477,1,1S12.5523,9,12,9z"/>\n</svg>'},"car-top-es":{label:"Car 2",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="car-top-es-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,7 L11,12 C11,13.1045695 10.1045695,14 9,14 L6,14 C4.8954305,14 4,13.1045695 4,12 L4,7 L3,7 C3,6.44771525 3.44771525,6 4,6 L4,4 C4,2.34314575 5.34314575,1 7,1 L8,1 C9.65685425,1 11,2.34314575 11,4 L11,6 C11.5522847,6 12,6.44771525 12,7 L11,7 Z M5.5,10 L5,11 C5.83333333,11.3333333 6.66666667,11.5 7.5,11.5 C8.33333333,11.5 9.16666667,11.3333333 10,11 L9.5,10 L7.5,10 L5.5,10 Z M5,6 L5.5,7 C6.16666667,6.66666667 6.83333333,6.5 7.5,6.5 C8.16666667,6.5 8.83333333,6.66666667 9.5,7 L10,6 C9.16666667,5.33333333 8.33333333,5 7.5,5 C6.66666667,5 5.83333333,5.33333333 5,6 Z M4.89290929,3.32453333 C5.05156229,3.45765901 5.39601532,3.30835135 5.66226667,2.99104535 C5.92851801,2.67373936 6.01574371,2.30859234 5.85709071,2.17546667 C5.69843771,2.04234099 5.35398468,2.19164865 5.08773333,2.50895465 C4.82148199,2.82626064 4.73425629,3.19140766 4.89290929,3.32453333 Z M10.1114481,3.32453333 C10.2701011,3.19140766 10.1828754,2.82626064 9.91662404,2.50895465 C9.65037269,2.19164865 9.30591967,2.04234099 9.14726667,2.17546667 C8.98861367,2.30859234 9.07583936,2.67373936 9.34209071,2.99104535 C9.60834205,3.30835135 9.95279508,3.45765901 10.1114481,3.32453333 Z"/>\n</svg>'},"car-rental":{label:"Car rental",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="car-rental-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <g>\n    <path d="M11.5039,1H10C9.2616,1,8.6238,1.4047,8.2774,2H3.5l-1,1l1,1l1-1l1,1l1-1l1,1h0.7774C8.6238,4.5953,9.2616,5,10,5h1.4982&#xA;&#x9;&#x9;C11.7753,5,12,4.7753,12,4.4982V1.4961C12,1.2221,11.7779,1,11.5039,1z M11,3.5C11,3.7761,10.7761,4,10.5,4S10,3.7761,10,3.5v-1&#xA;&#x9;&#x9;C10,2.2238,10.2239,2,10.5,2S11,2.2238,11,2.5V3.5z"/>\n    <path d="M10.9252,9.0103l-0.3636-2.1802C10.4824,6.3491,10.0713,6,9.583,6H5.417C4.9302,6,4.5186,6.3486,4.4385,6.8291&#xA;&#x9;&#x9;L4.0746,9.0117C3.4776,9.0436,3,9.5277,3,10.1327V13h1c0,0.5522,0.4477,1,1,1s1-0.4478,1-1h3c0,0.5522,0.4477,1,1,1s1-0.4478,1-1h1&#xA;&#x9;&#x9;v-2.8744C12,9.522,11.5219,9.0383,10.9252,9.0103z M4.75,12C4.3358,12,4,11.6642,4,11.25c0-0.4142,0.3358-0.75,0.75-0.75&#xA;&#x9;&#x9;s0.75,0.3358,0.75,0.75C5.5,11.6642,5.1642,12,4.75,12z M5.0887,9L5.417,7l4.1582-0.0068L9.9098,9H5.0887z M10.25,12&#xA;&#x9;&#x9;c-0.4142,0-0.75-0.3358-0.75-0.75c0-0.4142,0.3358-0.75,0.75-0.75S11,10.8358,11,11.25C11,11.6642,10.6642,12,10.25,12z"/>\n  </g>\n</svg>'},"car-repair":{label:"Car repair",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="car-repair-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <g>\n    <path d="M10.9252,9.0103l-0.3636-2.1802C10.4824,6.3491,10.0713,6,9.583,6H5.417C4.9302,6,4.5186,6.3486,4.4385,6.8291&#xA;&#x9;&#x9;L4.0746,9.0117C3.4776,9.0436,3,9.5277,3,10.1327V13h1c0,0.5522,0.4477,1,1,1s1-0.4478,1-1h3c0,0.5522,0.4477,1,1,1s1-0.4478,1-1h1&#xA;&#x9;&#x9;v-2.8744C12,9.522,11.5219,9.0383,10.9252,9.0103z M4.75,12C4.3358,12,4,11.6642,4,11.25c0-0.4142,0.3358-0.75,0.75-0.75&#xA;&#x9;&#x9;s0.75,0.3358,0.75,0.75C5.5,11.6642,5.1642,12,4.75,12z M5.0887,9L5.417,7l4.1582-0.0068L9.9098,9H5.0887z M10.25,12&#xA;&#x9;&#x9;c-0.4142,0-0.75-0.3358-0.75-0.75c0-0.4142,0.3358-0.75,0.75-0.75S11,10.8358,11,11.25C11,11.6642,10.6642,12,10.25,12z"/>\n    <path d="M12,2H5.7889C5.4029,1.1177,4.5247,0.5,3.5,0.5S1.5971,1.1177,1.2111,2H3.5L4,3L3.5,4H1.2111&#xA;&#x9;&#x9;C1.5972,4.8821,2.4754,5.5,3.5,5.5S5.4028,4.8821,5.7889,4H12c0.5527,0,1-0.4478,1-1S12.5527,2,12,2z"/>\n  </g>\n</svg>'},casino:{label:"Casino",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="casino-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M8.5,10c0.4561,0.6072,1.1821,1,2,1c1.3807,0,2.5-1.1193,2.5-2.5c0-0.5642-0.1938-1.0789-0.509-1.4973L12.5,7l-5-6l-5,6&#xA;&#x9;l0.009,0.0027C2.1938,7.4211,2,7.9358,2,8.5C2,9.8807,3.1193,11,4.5,11c0.8179,0,1.5439-0.3928,2-1&#xA;&#x9;C6.5997,9.8672,6.7902,9.6135,7,9.3337V11.5C7,13,4.5,13,4.5,13C4.2239,13,4,13.2238,4,13.5C4,13.7761,4.2239,14,4.5,14H7h1h2.5&#xA;&#x9;c0.2761,0,0.5-0.2239,0.5-0.5c0-0.2762-0.2239-0.5-0.5-0.5c0,0-2.5,0-2.5-1.5V9.3337C8.2098,9.6135,8.4003,9.8672,8.5,10z"/>\n</svg>'},castle:{label:"Castle",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="castle-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,4H4C3.4477,4,3,3.5523,3,3V0.5C3,0.2239,3.2239,0,3.5,0S4,0.2239,4,0.5V2h1V1c0-0.5523,0.4477-1,1-1s1,0.4477,1,1v1h1V1&#xA;&#x9;c0-0.5523,0.4477-1,1-1s1,0.4477,1,1v1h1V0.5C11,0.2239,11.2239,0,11.5,0S12,0.2239,12,0.5V3C12,3.5523,11.5523,4,11,4z M14,14.5&#xA;&#x9;c0,0.2761-0.2239,0.5-0.5,0.5h-12C1.2239,15,1,14.7761,1,14.5S1.2239,14,1.5,14H2c0.5523,0,1-0.4477,1-1c0,0,1-6,1-7&#xA;&#x9;c0-0.5523,0.4477-1,1-1h5c0.5523,0,1,0.4477,1,1c0,1,1,7,1,7c0,0.5523,0.4477,1,1,1h0.5c0.2723-0.0001,0.4946,0.2178,0.5,0.49V14.5z&#xA;&#x9; M9,10.5C9,9.6716,8.3284,9,7.5,9S6,9.6716,6,10.5V14h3V10.5z"/>\n</svg>'},cemetery:{label:"Cemetery",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="cemetery-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11.46,12h-0.68L12,3.55c0.0175-0.2867-0.2008-0.5332-0.4874-0.5507C11.4884,2.9979,11.4641,2.9981,11.44,3h-1.18&#xA;&#x9;c0-0.92-1.23-2-2.75-2S4.77,2.08,4.77,3H3.54C3.253,2.9885,3.0111,3.2117,2.9995,3.4987C2.9988,3.5158,2.999,3.5329,3,3.55L4.2,12&#xA;&#x9;H3.55C3.2609,11.9886,3.0162,12.2112,3,12.5V14h9v-1.51C11.9839,12.2067,11.7435,11.9886,11.46,12z M4.5,5h6v1h-6V5z"/>\n</svg>'},"charging-station":{label:"Charging station",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="charging-station-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13,4V2.49C12.9946,2.2178,12.7723,1.9999,12.5,2c-0.2816,0.0047-0.5062,0.2367-0.5015,0.5184&#xA;&#x9;C11.9987,2.5289,11.9992,2.5395,12,2.55V5c0,0.5523,0.4477,1,1,1v5.5c0,0.2761-0.2239,0.5-0.5,0.5S12,11.7761,12,11.5v-2&#xA;&#x9;C12,8.6716,11.3284,8,10.5,8H9V2c0-0.5523-0.4477-1-1-1H2C1.4477,1,1,1.4477,1,2v11c0,0.5523,0.4477,1,1,1h6c0.5523,0,1-0.4477,1-1&#xA;&#x9;V9h1.5C10.7761,9,11,9.2239,11,9.5v2c0,0.8284,0.6716,1.5,1.5,1.5c0.8284,0,1.5-0.6716,1.5-1.5V5C14,4.4477,13.5523,4,13,4z&#xA;&#x9; M7.2004,7.3995l-2.6006,3.4674l-0.0164-0.0072C4.5369,10.9384,4.4667,11,4.3688,11c-0.1476,0-0.2672-0.1196-0.2672-0.2672&#xA;&#x9;c0-0.028,0.0217-0.0463,0.0297-0.0717l-0.0177-0.0078l0.7766-2.3245C4.9442,8.1671,4.8238,8,4.6533,8H2.9994&#xA;&#x9;C2.7936,8,2.6762,7.7651,2.7996,7.6005l2.6006-3.4674l0.0164,0.0072C5.4631,4.0616,5.5333,4,5.6312,4&#xA;&#x9;c0.1476,0,0.2672,0.1196,0.2672,0.2672c0,0.028-0.0217,0.0463-0.0297,0.0717l0.0176,0.0078L5.1099,6.6711&#xA;&#x9;C5.0558,6.8329,5.1762,7,5.3467,7h1.6539C7.2064,7,7.3238,7.2349,7.2004,7.3995z"/>\n</svg>'},cinema:{label:"Cinema",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="cinema-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,7.5v2c0,0.2761-0.2239,0.5-0.5,0.5S13,9.7761,13,9.5c0,0,0.06-0.5-1-0.5h-1v2.5c0,0.2761-0.2239,0.5-0.5,0.5h-8&#xA;&#x9;C2.2239,12,2,11.7761,2,11.5v-4C2,7.2239,2.2239,7,2.5,7h8C10.7761,7,11,7.2239,11,7.5V8h1c1.06,0,1-0.5,1-0.5&#xA;&#x9;C13,7.2239,13.2239,7,13.5,7S14,7.2239,14,7.5z M4,3C2.8954,3,2,3.8954,2,5s0.8954,2,2,2s2-0.8954,2-2S5.1046,3,4,3z M4,6&#xA;&#x9;C3.4477,6,3,5.5523,3,5s0.4477-1,1-1s1,0.4477,1,1S4.5523,6,4,6z M8.5,2C7.1193,2,6,3.1193,6,4.5S7.1193,7,8.5,7S11,5.8807,11,4.5&#xA;&#x9;S9.8807,2,8.5,2z M8.5,6C7.6716,6,7,5.3284,7,4.5S7.6716,3,8.5,3S10,3.6716,10,4.5S9.3284,6,8.5,6z"/>\n</svg>'},circle:{label:"Circle",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="circle-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,7.5c0,3.5899-2.9101,6.5-6.5,6.5S1,11.0899,1,7.5S3.9101,1,7.5,1S14,3.9101,14,7.5z"/>\n</svg>'},"circle-stroked":{label:"Circle stroked",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="circle-stroked-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path8564-5-6-4" d="M7.5,0C11.6422,0,15,3.3578,15,7.5S11.6422,15,7.5,15&#xA;&#x9;S0,11.6422,0,7.5S3.3578,0,7.5,0z M7.5,1.6666c-3.2217,0-5.8333,2.6117-5.8333,5.8334S4.2783,13.3334,7.5,13.3334&#xA;&#x9;s5.8333-2.6117,5.8333-5.8334S10.7217,1.6666,7.5,1.6666z"/>\n</svg>'},city:{label:"City",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15" id="city-15">\n  <path d="M13.6368,3.9994h-1.6387V1.3608C11.99804,1.16148,11.83642,0.99994,11.6371,1l0,0h-0.278&#xA;&#x9;c-0.19932,0-0.3609,0.16158-0.3609,0.3609l0,0v2.6385H9.36c-0.19932,0-0.3609,0.16158-0.3609,0.3609l0,0l0,0v5.6381h-3.637&#xA;&#x9;c-0.20042,0-0.3629,0.16248-0.3629,0.3629v3.2745c0.00055,0.20003,0.16287,0.3619,0.3629,0.3619h8.2747&#xA;&#x9;c0.19932,0,0.3609-0.16158,0.3609-0.3609l0,0V4.36c0-0.19932-0.16158-0.3609-0.3609-0.3609l0,0L13.6368,3.9994z M6.9989,11.9981h-1&#xA;&#x9;v-1h1V11.9981z M8.9989,11.9981h-1v-1h1V11.9981z M10.9989,11.9981h-1v-1h1V11.9981z M10.9989,9.9981h-1v-1h1V9.9981z&#xA;&#x9; M10.9989,7.9981h-1v-1h1V7.9981z M10.9989,5.9981h-1v-1h1V5.9981z M12.9989,11.9971h-1v-1h1V11.9971z M12.9989,9.9971h-1v-1h1&#xA;&#x9;V9.9971z M12.9989,7.9971h-1v-1h1V7.9971z M12.9989,5.9971h-1v-1h1V5.9971z M7.9987,1.3608C7.99864,1.16152,7.83708,1,7.6378,1H5.36&#xA;&#x9;C5.16068,1,4.9991,1.16158,4.9991,1.3609l0,0V3H3.36C3.16138,3.00049,3.00049,3.16138,3,3.36l0,0v0.6394H1.3608&#xA;&#x9;C1.16164,3.99945,1.00017,4.16084,1,4.36l0,0v9.2765c0,0.19932,0.16158,0.3609,0.3609,0.3609h2.6385V8.9986h3.9993V1.3608z&#xA;&#x9; M3,11.9981H2v-1h1V11.9981z M3,9.9981H2v-1h1V9.9981z M3,7.9981H2v-1h1V7.9981z M3,5.9981H2v-1h1V5.9981z M5,7.9981H4v-1h1V7.9981z&#xA;&#x9; M5,5.9981H4v-1h1V5.9981z M7,7.9981H6v-1h1V7.9981z M7,5.9981H6v-1h1V5.9981z M7,3.9981H6V3h1v1V3.9981z"/>\n</svg>'},"clothing-store":{label:"Clothing store",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="clothing-store-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect4181-0-0" d="&#xA;&#x9;M3.5,1L0,4v3h2.9L3,14h9V7h3V4l-3.5-3H10L7.5,5L5,1H3.5z"/>\n</svg>'},college:{label:"College",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="college-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7.5,1L0,4.5l2,0.9v1.7C1.4,7.3,1,7.9,1,8.5s0.4,1.2,1,1.4V10l-0.9,2.1&#xA; C0.8,13,1,14,2.5,14s1.7-1,1.4-1.9L3,10c0.6-0.3,1-0.8,1-1.5S3.6,7.3,3,7.1V5.9L7.5,8L15,4.5L7.5,1z M11.9,7.5l-4.5,2L5,8.4v0.1&#xA; c0,0.7-0.3,1.3-0.8,1.8l0.6,1.4v0.1C4.9,12.2,5,12.6,4.9,13c0.7,0.3,1.5,0.5,2.5,0.5c3.3,0,4.5-2,4.5-3L11.9,7.5L11.9,7.5z"/>\n</svg>'},commercial:{label:"Commercial",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="commercial-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,7H1c0.0881-1.3829,0.427-2.7383,1-4h11C13.5731,4.2617,13.9119,5.6171,14,7z M3,8h9v6h-1V9H8v5H3V8z M4,11h3V9H4V11z"/>\n</svg>'},"communications-tower":{label:"Communications tower",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="communications-tower-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="communications-tower-15">\n    <path d="M11.8545,6.4336l-.4131-.2813a4.7623,4.7623,0,0,0,.2813-4.8779l-.0835-.1533L12.0747.875l.0908.167a5.2619,5.2619,0,0,1-.311,5.3916Zm1.1521,7.1316V14h-11v-.4348H4.4952L6.0439,6.4a.5.5,0,0,1,.4888-.3945h.7255V4.6014A1.14,1.14,0,0,1,6.3756,3.5a1.1568,1.1568,0,1,1,2.3136,0,1.14,1.14,0,0,1-.931,1.1112V6.0059h.7223A.5.5,0,0,1,8.9692,6.4l1.5478,7.1648ZM8.4543,8.751H6.5588L6.236,10.2441H8.777ZM6.1279,10.7441l-.3233,1.4952H9.2082l-.3231-1.4952ZM6.936,7.0059,6.6669,8.251H8.3463L8.0771,7.0059ZM5.5179,13.5652H9.4948l-.1786-.8259h-3.62ZM5.21,5.0137a2.7523,2.7523,0,0,1,.0161-3.0518L4.812,1.6826a3.25,3.25,0,0,0-.019,3.6065ZM10.7568,3.5a3.2433,3.2433,0,0,0-.5341-1.7861l-.418.2754a2.7517,2.7517,0,0,1-.0176,3.0488l.4141.2793A3.2341,3.2341,0,0,0,10.7568,3.5ZM3.5342,6.1182A4.7637,4.7637,0,0,1,3.3813,1.13L2.9478.88a5.2643,5.2643,0,0,0,.1694,5.5137Z"/>\n  </g>\n</svg>'},confectionery:{label:"Confectionery",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="confectionery-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="confectionary-15">\n    <path d="M13,4a1,1,0,0,0-1-1,1,1,0,0,0-2,0V5.0673A3.4808,3.4808,0,0,0,4.3583,9H2a1,1,0,0,0,0,2,1,1,0,0,0,1,1,1,1,0,0,0,2,0V9.9326A3.4807,3.4807,0,0,0,10.6417,6H13a1,1,0,0,0,0-2ZM7.5,9.9925A2.484,2.484,0,0,1,6.3184,5.319a1.0809,1.0809,0,0,1,.5459.307A2.1243,2.1243,0,0,1,7.25,7.0117l.001.9561A2.5821,2.5821,0,0,0,7.76,9.7031a1.5462,1.5462,0,0,0,.2591.2333A2.4861,2.4861,0,0,1,7.5,9.9925ZM8.6815,9.681a1.0813,1.0813,0,0,1-.5458-.307A2.1243,2.1243,0,0,1,7.75,7.9883l-.001-.9561A2.5821,2.5821,0,0,0,7.24,5.2969a1.5557,1.5557,0,0,0-.2592-.2334A2.4843,2.4843,0,0,1,8.6815,9.681Z"/>\n  </g>\n</svg>'},convenience:{label:"Convenience",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="convenience-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="convenience-store-15">\n    <path d="M2.9982,3.0687s.1875-1.062,1-1.062H5.0043V1.7276a.5.5,0,0,1,.5-.5H9.4882a.5.5,0,0,1,.5.5v.2791h1.01a.8324.8324,0,0,1,.6373.2937,1.7589,1.7589,0,0,1,.3627.7683s.3108,1.5719.5921,2.9181h-.938L11,3,3.982,2.9956,3.3336,5.9868H2.382Zm11,4.9144a1,1,0,0,1-.9992,1l-1.0008,3.973s-.1875,1.0417-1,1.0417h-7c-.8125,0-1-1.0417-1-1.0417L1.9822,8.98a.9985.9985,0,0,1,.016-1.9968h11A1,1,0,0,1,13.9982,7.9831ZM5.0327,12.13,5.03,11.0051,4.6392,9.4686a.5373.5373,0,1,0-1.0649.1445L3.78,11.0075l.1874,1.2672A.5373.5373,0,1,0,5.0327,12.13Zm2-2.5967A.5332.5332,0,0,0,6.4994,9l-.0039.0008L6.4886,9a.4992.4992,0,0,0-.3575.1509.529.529,0,0,0-.1648.3828v2.68a.5332.5332,0,1,0,1.0663,0Zm1.998,0A.5314.5314,0,0,0,8.694,9.04a.4992.4992,0,0,0-.393,0,.5312.5312,0,0,0-.3366.4934v2.68a.5331.5331,0,1,0,1.0662,0Zm2.3857.08a.5373.5373,0,1,0-1.0649-.1445L9.96,10.9938,9.9579,12.13a.5373.5373,0,1,0,1.0649.1446Z"/>\n  </g>\n</svg>'},cricket:{label:"Cricket",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="cricket-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M8,1.5C8,2.3284,7.3284,3,6.5,3S5,2.3284,5,1.5S5.6716,0,6.5,0S8,0.6716,8,1.5z M10.88,7.18L10.88,7.18l-2-2l0,0l0,0&#xA;&#x9;C8.7815,5.0616,8.6339,4.9952,8.48,5H3.75C3.3736,4.9915,3.0508,5.2669,3,5.64l0,0l-1,7.7l0,0c-0.0068,0.0464-0.0068,0.0936,0,0.14&#xA;&#x9;c0,0.2761,0.2239,0.5,0.5,0.5c0.2251,0.0153,0.4315-0.1251,0.5-0.34l0,0l1.2-3.89l0,0l0.26-0.83l0.4,0.44l0,0L6,10.6v2.9&#xA;&#x9;C6,13.7761,6.2239,14,6.5,14S7,13.7761,7,13.5v-3l0,0l0,0c-0.0081-0.0788-0.0356-0.1544-0.08-0.22l0,0L5.48,8.5l1-2.5h1.71l2,1.84&#xA;&#x9;l0,0c0.0928,0.1077,0.2278,0.1697,0.37,0.17C10.8163,7.9791,11.007,7.7581,11,7.5C10.9997,7.3824,10.9571,7.2688,10.88,7.18z&#xA;&#x9; M14,11.27c-0.4142,0-0.75,0.3358-0.75,0.75s0.3358,0.75,0.75,0.75s0.75-0.3358,0.75-0.75S14.4142,11.27,14,11.27z M10.76,9.74V9&#xA;&#x9;c0-0.1381-0.1119-0.25-0.25-0.25S10.26,8.8619,10.26,9v0.74c-0.1522,0.0855-0.2474,0.2455-0.25,0.42v3.34&#xA;&#x9;c0,0.2761,0.2239,0.5,0.5,0.5s0.5-0.2239,0.5-0.5v-3.34C11.0074,9.9855,10.9122,9.8255,10.76,9.74z"/>\n</svg>'},cross:{label:"Cross",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="cross-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M2.64,1.27L7.5,6.13l4.84-4.84C12.5114,1.1076,12.7497,1.0029,13,1c0.5523,0,1,0.4477,1,1&#xA;&#x9;c0.0047,0.2478-0.093,0.4866-0.27,0.66L8.84,7.5l4.89,4.89c0.1648,0.1612,0.2615,0.3796,0.27,0.61c0,0.5523-0.4477,1-1,1&#xA;&#x9;c-0.2577,0.0107-0.508-0.0873-0.69-0.27L7.5,8.87l-4.85,4.85C2.4793,13.8963,2.2453,13.9971,2,14c-0.5523,0-1-0.4477-1-1&#xA;&#x9;c-0.0047-0.2478,0.093-0.4866,0.27-0.66L6.16,7.5L1.27,2.61C1.1052,2.4488,1.0085,2.2304,1,2c0-0.5523,0.4477-1,1-1&#xA;&#x9;C2.2404,1.0029,2.4701,1.0998,2.64,1.27z"/>\n</svg>'},dam:{label:"Dam",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="dam-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.94,9.5c0,0.2761-0.2239,0.5-0.5,0.5l0,0c-0.259,0.0219-0.4994,0.1439-0.67,0.34c-0.2714,0.2887-0.6175,0.4964-1,0.6&#xA;&#x9;c-0.6115,0.1816-1.2734,0.0424-1.76-0.37l-0.39-0.35c-0.2976-0.3038-0.7851-0.3087-1.0889-0.0111&#xA;&#x9;C8.5274,10.2126,8.5237,10.2163,8.52,10.22c-0.14,0.12-0.27,0.25-0.42,0.37c-0.7278,0.5784-1.7663,0.5489-2.46-0.07L5.3,10.19&#xA;&#x9;l-0.1-0.06l0.3,1.22l0.49,2c0.0829,0.2634-0.0634,0.5441-0.3267,0.6271C5.6105,13.9937,5.5553,14.0014,5.5,14h-4&#xA;&#x9;C1.2239,14,1,13.7761,1,13.5v-12C1,1.2239,1.2239,1,1.5,1h1.1c0.2346-0.0011,0.4384,0.1611,0.49,0.39L4,5.06V5.2&#xA;&#x9;c0.6569-0.314,1.4361-0.2205,2,0.24c0.16,0.13,0.31,0.28,0.47,0.41c0.2847,0.2546,0.7153,0.2546,1,0c0.16-0.13,0.31-0.28,0.47-0.41&#xA;&#x9;c0.7076-0.5968,1.7424-0.5968,2.45,0c0.15,0.13,0.29,0.27,0.44,0.39c0.2847,0.2546,0.7153,0.2546,1,0l0.47-0.41&#xA;&#x9;c0.3163-0.2672,0.7159-0.4157,1.13-0.42l0,0c0.2761,0,0.5,0.2239,0.5,0.5S13.7061,6,13.43,6l0,0&#xA;&#x9;c-0.259,0.0219-0.4994,0.1439-0.67,0.34c-0.2714,0.2887-0.6175,0.4964-1,0.6C11.1485,7.1216,10.4866,6.9824,10,6.57L9.67,6.23&#xA;&#x9;C9.3724,5.9262,8.8849,5.9213,8.5811,6.2189C8.5774,6.2226,8.5737,6.2263,8.57,6.23C8.43,6.35,8.3,6.48,8.15,6.6&#xA;&#x9;C7.4222,7.1784,6.3837,7.1489,5.69,6.53L5.3,6.19c-0.2847-0.2546-0.7153-0.2546-1,0L4.24,6.24L4.93,9&#xA;&#x9;C5.3226,9.029,5.6965,9.1793,6,9.43c0.16,0.13,0.31,0.28,0.47,0.41c0.2847,0.2546,0.7153,0.2546,1,0c0.16-0.13,0.31-0.28,0.47-0.41&#xA;&#x9;c0.7076-0.5968,1.7424-0.5968,2.45,0c0.15,0.13,0.29,0.27,0.44,0.39c0.2847,0.2546,0.7153,0.2546,1,0l0.47-0.41&#xA;&#x9;c0.3177-0.2636,0.7172-0.4085,1.13-0.41l0,0c0.2761-0.0055,0.5044,0.2138,0.5099,0.4899C13.94,9.4933,13.94,9.4966,13.94,9.5z"/>\n</svg>'},danger:{label:"Danger",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="danger-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.94,14.68c-0.0749,0.194-0.262,0.3215-0.47,0.32c-0.0595,0.0107-0.1205,0.0107-0.18,0L7.5,12.56L1.7,15&#xA;&#x9;c-0.2572,0.1005-0.5472-0.0266-0.6476-0.2838C1.0516,14.7141,1.0508,14.7121,1.05,14.71c-0.1291-0.2441-0.0358-0.5467,0.2084-0.6757&#xA;&#x9;C1.2845,14.0205,1.3118,14.009,1.34,14l4.85-2l-4.85-2C1.0758,9.9197,0.9267,9.6404,1.007,9.3762s0.3596-0.4133,0.6238-0.333&#xA;&#x9;C1.6545,9.0504,1.6776,9.0594,1.7,9.07l5.8,2.41l5.8-2.41c0.2494-0.1185,0.5477-0.0124,0.6662,0.237&#xA;&#x9;c0.1185,0.2494,0.0124,0.5477-0.237,0.6662C13.7068,9.9839,13.6837,9.9928,13.66,10L8.8,12l4.85,2&#xA;&#x9;c0.2607,0.091,0.3983,0.3761,0.3074,0.6368C13.9523,14.6515,13.9465,14.6659,13.94,14.68z M12,4.23v0.45&#xA;&#x9;c-0.0021,0.2129-0.0722,0.4196-0.2,0.59C11.2414,5.8883,10.6399,6.4664,10,7v1.16c0.0015,0.208-0.126,0.3951-0.32,0.47L7.52,9.5&#xA;&#x9;H7.45L5.28,8.63C5.1016,8.5428,4.9917,8.3584,5,8.16V7C4.3528,6.4675,3.7446,5.8893,3.18,5.27C3.0593,5.0972,2.9963,4.8907,3,4.68&#xA;&#x9;V4.23C3.1669,2.0117,4.8974,0.2307,7.11,0h0.36l0,0h0.39C10.0862,0.2131,11.8348,1.9997,12,4.23z M6,4c0-0.5523-0.4477-1-1-1&#xA;&#x9;S4,3.4477,4,4s0.4477,1,1,1S6,4.5523,6,4z M7,7c0-0.2761-0.2239-0.5-0.5-0.5S6,6.7239,6,7v0.5C6,7.7761,6.2239,8,6.5,8&#xA;&#x9;S7,7.7761,7,7.5V7z M9,7c0-0.2761-0.2239-0.5-0.5-0.5S8,6.7239,8,7v0.5C8,7.7761,8.2239,8,8.5,8S9,7.7761,9,7.5V7z M11,4&#xA;&#x9;c0-0.5523-0.4477-1-1-1S9,3.4477,9,4s0.4477,1,1,1S11,4.5523,11,4z"/>\n</svg>'},defibrillator:{label:"Defibrillator",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" id="defibrillator-15">\n  <path d="M1.55,6.3381C-0.8368,1.7416,5.18-1.3228,7.502,3.2737c2.3215-4.5965,8.3387-1.5322,5.9523,3.0644-0.0869.1671-.2028,0.3456-0.3114,0.5212H11.335L9.5205,4.1377A0.6252,0.6252,0,0,0,8.42,4.2524l-1.6484,4.12-1.33-1.33A0.6254,0.6254,0,0,0,5,6.8594H1.8611C1.7525,6.6837,1.6366,6.5052,1.55,6.3381ZM11,8.1094a0.6263,0.6263,0,0,1-.5205-0.2783L9.1387,5.82,7.58,9.7168a0.6245,0.6245,0,0,1-.4546.38A0.6047,0.6047,0,0,1,7,10.1094a0.6251,0.6251,0,0,1-.4419-0.1826L4.7412,8.1094H2.7358a42.67,42.67,0,0,0,4.46,4.6732,0.4642,0.4642,0,0,0,.6222,0,43.26,43.26,0,0,0,4.4505-4.6732H11Z"/>\n</svg>'},dentist:{label:"Dentist",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="dentist-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M4.36,14c-1,0-0.56-2.67-0.86-5c-0.1-0.76-1-1.49-1.12-2.06C2,5,1.39,1.44,3.66,1S6,3,7.54,3s1.57-2.36,3.85-2&#xA;&#x9;s1.59,3.9,1.29,5.9c-0.1,0.45-1.1,1.48-1.18,2.06c-0.33,2.4,0.32,5-0.8,5c-0.93,0-1.32-2.72-2-4.5C8.43,8.63,8.06,8,7.54,8&#xA;&#x9;C6,8,5.75,14,4.36,14z"/>\n</svg>'},doctor:{label:"Doctor",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="doctor-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M5.5,7C4.1193,7,3,5.8807,3,4.5l0,0v-2C3,2.2239,3.2239,2,3.5,2H4c0.2761,0,0.5-0.2239,0.5-0.5S4.2761,1,4,1H3.5&#xA;&#x9;C2.6716,1,2,1.6716,2,2.5v2c0.0013,1.1466,0.5658,2.2195,1.51,2.87l0,0C4.4131,8.1662,4.9514,9.297,5,10.5C5,12.433,6.567,14,8.5,14&#xA;&#x9;s3.5-1.567,3.5-3.5V9.93c1.0695-0.2761,1.7126-1.367,1.4365-2.4365C13.1603,6.424,12.0695,5.7809,11,6.057&#xA;&#x9;C9.9305,6.3332,9.2874,7.424,9.5635,8.4935C9.7454,9.198,10.2955,9.7481,11,9.93v0.57c0,1.3807-1.1193,2.5-2.5,2.5S6,11.8807,6,10.5&#xA;&#x9;c0.0511-1.2045,0.5932-2.3356,1.5-3.13l0,0C8.4404,6.7172,9.001,5.6448,9,4.5v-2C9,1.6716,8.3284,1,7.5,1H7&#xA;&#x9;C6.7239,1,6.5,1.2239,6.5,1.5S6.7239,2,7,2h0.5C7.7761,2,8,2.2239,8,2.5v2l0,0C8,5.8807,6.8807,7,5.5,7 M11.5,9&#xA;&#x9;c-0.5523,0-1-0.4477-1-1s0.4477-1,1-1s1,0.4477,1,1S12.0523,9,11.5,9z"/>\n</svg>'},"dog-park":{label:"Dog park",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="dog-park-15" width="15px" height="15px" viewBox="0 0 15 15">\n  <g id="g3">\n    <path d="M 10.300781 1.2207031 C 9.9144812 1.2207031 9.6 1.2 9.5 2 L 9.0996094 4.5214844 L 11.5 6.5 L 13.5 6.5 C 14.9 6.5 15 5.5410156 15 5.5410156 L 13.099609 3.3222656 C 12.399609 2.6222656 11.7 2.5 11 2.5 L 11 2 C 11 2 11.067481 1.2206031 10.300781 1.2207031 z M 4.75 1.5 C 4.75 1.5 3.7992187 1.5206031 3.1992188 1.7207031 C 2.5992187 1.9207031 2 2.6210938 2 3.6210938 L 2 7.5214844 C 2 9.2214844 1.3 9.5 1 9.5 C 1 9.5 0 9.5214844 0 10.521484 L 0 12.720703 C 0 12.720703 0.00078125 13.521484 0.80078125 13.521484 L 1 13.521484 L 1.5 13.521484 L 2 13.521484 L 2 13.021484 L 2 12.822266 C 2 12.422266 1.8 12.221094 1.5 12.121094 L 1.5 11.021484 C 2.5 11.021484 2.6 10.820703 3 10.720703 L 3.5507812 12.917969 C 3.6507813 13.217969 3.7507813 13.417578 4.0507812 13.517578 L 5.0507812 13.517578 L 6 13.5 L 6 12.699219 C 6 12.022819 5 12 5 12 L 5 9.5 L 8.5 9.5 L 9.1992188 12.121094 C 9.5992188 13.521094 10.5 13.5 10.5 13.5 L 11 13.5 L 12 13.5 L 12 12.699219 C 12 11.987419 11 12 11 12 L 11.099609 7.921875 L 8 5.5 L 3.5 5.5 L 3.5 3.5 C 3.5 3.1 3.7765 3.0053 4 3 C 4.4941 2.9882 4.75 3 4.75 3 C 5.1642 3 5.5 2.6642 5.5 2.25 C 5.5 1.8358 5.1642 1.5 4.75 1.5 z M 11.75 4 C 11.8881 4 12 4.1119 12 4.25 C 12 4.3881 11.8881 4.5 11.75 4.5 C 11.6119 4.5 11.5 4.3881 11.5 4.25 C 11.5 4.1119 11.6119 4 11.75 4 z " id="path5"/>\n  </g>\n</svg>'},"drinking-water":{label:"Drinking water",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" id="drinking-water-15">\n  <path d="M6,1A2,2,0,0,0,4,3V6.5a0.5,0.5,0,0,0,.5.5h2A0.5,0.5,0,0,0,7,6.5v-2A0.5,0.5,0,0,1,7.5,4H14V1H6Z"/>\n  <path d="M7,15H4a0.5,0.5,0,0,1-.48-0.38L2,8.62A0.5,0.5,0,0,1,2.5,8h6A0.5,0.5,0,0,1,9,8.62l-1.5,6A0.5,0.5,0,0,1,7,15ZM3.65,11l3.71,0L7.86,9H3.14Z"/>\n</svg>'},embassy:{label:"Embassy",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="embassy-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M6.65,2C5.43,2,4.48,3.38,4.11,3.82C4.0365,3.9102,3.9975,4.0237,4,4.14v4.4C3.9884,8.7827,4.1758,8.9889,4.4185,9.0005&#xA;&#x9;C4.528,9.0057,4.6355,8.9699,4.72,8.9c0.4665-0.6264,1.1589-1.0461,1.93-1.17C8.06,7.73,8.6,9,10.07,9&#xA;&#x9;c0.9948-0.0976,1.9415-0.4756,2.73-1.09c0.1272-0.0934,0.2016-0.2422,0.2-0.4V2.45c0.0275-0.2414-0.1459-0.4595-0.3874-0.487&#xA;&#x9;C12.5332,1.954,12.4527,1.9668,12.38,2c-0.6813,0.5212-1.4706,0.8834-2.31,1.06C8.6,3.08,8.12,2,6.65,2z M2.5,3&#xA;&#x9;c-0.5523,0-1-0.4477-1-1s0.4477-1,1-1s1,0.4477,1,1S3.0523,3,2.5,3z M3,4v9.48c0,0.2761-0.2239,0.5-0.5,0.5S2,13.7561,2,13.48V4&#xA;&#x9;c0-0.2761,0.2239-0.5,0.5-0.5S3,3.7239,3,4z"/>\n</svg>'},"emergency-phone":{label:"Emergency phone",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="emergency-phone-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M7.875,11.49a.51.51,0,0,0,.72,0l.72-.72,2.18,2.16-.37.37a2.24,2.24,0,0,1-1.44.7H8.24a2.24,2.24,0,0,1-1.45-.7L1.72,8.23A2.24,2.24,0,0,1,1,6.78V5.33a2.24,2.24,0,0,1,.72-1.45l.36-.36L4.26,5.69l-.73.73a.51.51,0,0,0,0,.72Zm4.72.38a1,1,0,0,0,.036-1.414h0l-.036-.036-.72-.72a1,1,0,0,0-1.414-.036h0l-.036.036ZM5.315,4.62a1,1,0,0,0,.036-1.414h0L4.595,2.45a1,1,0,0,0-1.414-.036h0L3.14,2.45ZM10,2V4H8V5h2V7h1V5h2V4H11V2Z"/>\n</svg>'},entrance:{label:"Entrance",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="entrance-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7,6.5v-1c0-0.5523-0.4477-1-1-1s-1,0.4477-1,1v3L7,6.5z M4.65,10.56L5,3c0-0.5523,0.4477-1,1-1s1,0.4477,1,1S6.5523,4,6,4&#xA;&#x9;S5,3.5523,5,3L4.65,10.56z"/>\n  <path d="M14,6L14,6c0,0.5523-0.4477,1-1,1h-1.58c-0.2658-0.0015-0.5213,0.1028-0.71,0.29l-5.42,5.42&#xA;&#x9;c-0.1863,0.1847-0.4377,0.2889-0.7,0.29H2c-0.5523,0-1-0.4477-1-1l0,0c0-0.5523,0.4477-1,1-1h1.59&#xA;&#x9;c0.2623-0.0011,0.5137-0.1053,0.7-0.29l5.42-5.42C9.8987,5.1028,10.1542,4.9985,10.42,5H13C13.5523,5,14,5.4477,14,6z"/>\n</svg>'},"entrance-alt1":{label:"Entrance 2",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="entrance-alt1-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M6.554,9.639a.5.5,0,0,0,.707.707L9.928,7.669a.25.25,0,0,0,0-.354h0L7.261,4.639a.5.5,0,0,0-.707.707L8.2,7H1.5a.5.5,0,0,0,0,1H8.2ZM12,1H5.5a.5.5,0,0,0,0,1h6a.5.5,0,0,1,.5.5v10a.5.5,0,0,1-.5.5H5.25a.5.5,0,0,0,0,1H12a1,1,0,0,0,1-1V2A1,1,0,0,0,12,1Z"/>\n</svg>'},farm:{label:"Farm",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="farm-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M8,7L5,5,2,7,1,9v4H3V11H7v2H9V9ZM6,9H4V7H6V9Zm8,4H11V3.5a1.5,1.5,0,0,1,3,0V13Z"/>\n</svg>'},"fast-food":{label:"Fast food",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="fast-food-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,8c0,0.5523-0.4477,1-1,1H2C1.4477,9,1,8.5523,1,8s0.4477-1,1-1h11C13.5523,7,14,7.4477,14,8z M3.5,10H2&#xA;&#x9;c0,1.6569,1.3431,3,3,3h5c1.6569,0,3-1.3431,3-3H3.5z M3,6H2V4c0-1.1046,0.8954-2,2-2h7c1.1046,0,2,0.8954,2,2v2H3z M11,4.5&#xA;&#x9;C11,4.7761,11.2239,5,11.5,5S12,4.7761,12,4.5S11.7761,4,11.5,4S11,4.2239,11,4.5z M9,3.5C9,3.7761,9.2239,4,9.5,4S10,3.7761,10,3.5&#xA;&#x9;S9.7761,3,9.5,3S9,3.2239,9,3.5z M7,4.5C7,4.7761,7.2239,5,7.5,5S8,4.7761,8,4.5S7.7761,4,7.5,4S7,4.2239,7,4.5z M5,3.5&#xA;&#x9;C5,3.7761,5.2239,4,5.5,4S6,3.7761,6,3.5S5.7761,3,5.5,3S5,3.2239,5,3.5z M3,4.5C3,4.7761,3.2239,5,3.5,5S4,4.7761,4,4.5&#xA;&#x9;S3.7761,4,3.5,4S3,4.2239,3,4.5z"/>\n</svg>'},fence:{label:"Fence",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="fence-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M13.5,10H13V7h.5a.5.5,0,0,0,0-1H13V4l-.286-.573a.249.249,0,0,0-.424-.006L12,4V6H11V4l-.286-.573a.249.249,0,0,0-.424-.006L10,4V6H9V4l-.286-.573a.249.249,0,0,0-.424-.006L8,4V6H7V4l-.286-.573a.249.249,0,0,0-.424-.006L6,4V6H5V4l-.286-.573a.249.249,0,0,0-.424-.006L4,4V6H3V4l-.286-.573a.249.249,0,0,0-.424-.006L2,4V6H1.5a.5.5,0,0,0,0,1H2v3H1.5a.5.5,0,0,0,0,1H2v1.5a.5.5,0,0,0,1,0V11H4v1.5a.5.5,0,0,0,1,0V11H6v1.5a.5.5,0,0,0,1,0V11H8v1.5a.5.5,0,0,0,1,0V11h1v1.5a.5.5,0,0,0,1,0V11h1v1.5a.5.5,0,0,0,1,0V11h.5a.5.5,0,0,0,0-1ZM3,10V7H4v3Zm2,0V7H6v3Zm2,0V7H8v3Zm2,0V7h1v3Zm2,0V7h1v3Z"/>\n</svg>'},ferry:{label:"Ferry",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="ferry-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M5.33,11c0.6745,0.009,1.3262,0.245,1.85,0.67l0.26,0.23h0.05l0.31-0.28c0.9817-0.8115,2.379-0.8846,3.44-0.18L13.5,7L12,6&#xA;&#x9;V2.45c-0.0466-0.8-0.6989-1.4305-1.5-1.45H10c0.0343-0.518-0.3579-0.9657-0.8759-1C9.0828-0.0027,9.0413-0.0027,9,0H6&#xA;&#x9;C5.482-0.0343,5.0343,0.3579,5,0.8759C4.9973,0.9172,4.9973,0.9587,5,1H4.5C3.6989,1.0195,3.0466,1.65,3,2.45V6L1.5,7l2.25,4.53&#xA;&#x9;C4.2143,11.2041,4.7631,11.02,5.33,11z M4,2.45c0.0105-0.2594,0.2293-0.4611,0.4886-0.4506C4.4924,1.9996,4.4962,1.9998,4.5,2h6&#xA;&#x9;c0.259-0.0171,0.4829,0.1789,0.5,0.4379c0.0014,0.0207,0.0014,0.0414,0,0.0621v3l-3.5-2L4,5.45C4,5.45,4,2.45,4,2.45z M14,13v1&#xA;&#x9;c-0.2626,0.0194-0.5069,0.1416-0.68,0.34c-0.2717,0.2883-0.6178,0.4959-1,0.6c-0.6147,0.1815-1.2795,0.0425-1.77-0.37l-0.39-0.35&#xA;&#x9;c-0.3043-0.3026-0.7957-0.3026-1.1,0c-0.14,0.12-0.27,0.25-0.42,0.37c-0.7328,0.5856-1.7814,0.556-2.48-0.07l-0.39-0.35&#xA;&#x9;c-0.2864-0.2502-0.7136-0.2502-1,0c-0.19,0.15-0.36,0.32-0.55,0.47c-0.7043,0.5215-1.6732,0.4968-2.35-0.06l-0.31-0.27&#xA;&#x9;C1.4153,14.1443,1.2172,14.0346,1,14v-1c0.2585-0.032,0.5205,0.0169,0.75,0.14c0.2782,0.1722,0.5424,0.3661,0.79,0.58&#xA;&#x9;c0.2051,0.2235,0.5147,0.319,0.81,0.25c0.1125-0.0333,0.2177-0.0876,0.31-0.16c0.16-0.12,0.29-0.26,0.45-0.39&#xA;&#x9;c0.7106-0.5888,1.7394-0.5888,2.45,0c0.16,0.13,0.31,0.28,0.47,0.41c0.2864,0.2502,0.7136,0.2502,1,0c0.16-0.13,0.31-0.28,0.47-0.41&#xA;&#x9;c0.7123-0.5943,1.7477-0.5943,2.46,0c0.15,0.13,0.29,0.27,0.44,0.39c0.2864,0.2502,0.7136,0.2502,1,0l0.47-0.41&#xA;&#x9;C13.1895,13.1408,13.5886,12.9995,14,13z"/>\n</svg>'},"fire-station":{label:"Fire station",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="fire-station-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path10041-3-3" d="M7.5,0.5L5,4.5l-1.5-2&#xA;&#x9;C2.9452,3.4753,0.8036,5.7924,0.8036,8.3036C0.8036,12.002,3.8017,15,7.5,15s6.6964-2.998,6.6964-6.6964&#xA;&#x9;c0-2.5112-2.1416-4.8283-2.6964-5.8036l-1.5,2L7.5,0.5z M7.5,7c0,0,2.5,2.5618,2.5,4.5c0,0.8371-0.8259,2-2.5,2S5,12.3371,5,11.5&#xA;&#x9;C5,9.6283,7.5,7,7.5,7z"/>\n</svg>'},"fitness-centre":{label:"Fitness centre",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="fitness-centre-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="daec40ff-71f5-4432-9d75-dcba7b9c1b89" d="M14.5,7V8h-1v2h-1v1H11V8H4v3H2.5V10h-1V8H.5V7h1V5h1V4H4V7h7V4h1.5V5h1V7Z"/>\n</svg>'},florist:{label:"Florist",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="florist-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M1.5,1A2.7,2.7,0,0,1,4,3l.5-3L5,3A2.7,2.7,0,0,1,7.5,1c-.2.03-1,.26-1,2v.083A1.959,1.959,0,0,1,4.5,5H4.417A1.959,1.959,0,0,1,2.5,3C2.5,1.261,1.7,1.03,1.5,1ZM12.012,11l3-.5-3-.5A2.686,2.686,0,0,0,14,7.5c-.03.2-.248,1-1.988,1a2,2,0,0,0,0,4c1.739,0,1.958.8,1.988,1A2.686,2.686,0,0,0,12.012,11ZM9.688,5.548a1,1,0,0,1,0-2,1,1,0,0,1,0-2,.986.986,0,0,1,.852.507l.023-.012a.978.978,0,0,1-.116-.444,1,1,0,1,1,2,0,.978.978,0,0,1-.116.444l.019.01a.986.986,0,0,1,.85-.5,1,1,0,0,1,.025,2,1,1,0,0,1-.025,2,.986.986,0,0,1-.85-.5l-.016.009a.978.978,0,0,1,.113.44,1,1,0,0,1-2,0,.978.978,0,0,1,.113-.44l-.02-.011a.986.986,0,0,1-.852.507Zm.71-1.995A1.051,1.051,0,1,0,11.449,2.5,1.051,1.051,0,0,0,10.4,3.553v0ZM4.946,11.444l-.516-.515L8.892,6.475A1.746,1.746,0,0,1,8.44,6.22L4.076,10.575l-.519-.518A16.051,16.051,0,0,0,4.912,6a3.373,3.373,0,0,1-.412.035c-.041,0-.073-.008-.112-.01A16.953,16.953,0,0,1,3.131,9.631L2.76,9.26a.246.246,0,0,0-.4.079L.231,14.445a.287.287,0,0,0-.016.089.25.25,0,0,0,.25.25.289.289,0,0,0,.1-.019l5.1-2.124a.246.246,0,0,0,.079-.4l-.372-.372a16.874,16.874,0,0,1,3.612-1.256c0-.059-.015-.106-.015-.166A3.349,3.349,0,0,1,9,10.089,16.076,16.076,0,0,0,4.946,11.444Z"/>\n</svg>'},fuel:{label:"Fuel",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="fuel-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13,6L13,6v5.5c0,0.2761-0.2239,0.5-0.5,0.5S12,11.7761,12,11.5v-2C12,8.6716,11.3284,8,10.5,8H9V2c0-0.5523-0.4477-1-1-1H2&#xA;&#x9;C1.4477,1,1,1.4477,1,2v11c0,0.5523,0.4477,1,1,1h6c0.5523,0,1-0.4477,1-1V9h1.5C10.7761,9,11,9.2239,11,9.5v2&#xA;&#x9;c0,0.8284,0.6716,1.5,1.5,1.5s1.5-0.6716,1.5-1.5V5c0-0.5523-0.4477-1-1-1l0,0V2.49C12.9946,2.2178,12.7723,1.9999,12.5,2&#xA;&#x9;c-0.2816,0.0047-0.5062,0.2367-0.5015,0.5184C11.9987,2.5289,11.9992,2.5395,12,2.55V5C12,5.5523,12.4477,6,13,6s1-0.4477,1-1&#xA;&#x9;s-0.4477-1-1-1 M8,6.5C8,6.7761,7.7761,7,7.5,7h-5C2.2239,7,2,6.7761,2,6.5v-3C2,3.2239,2.2239,3,2.5,3h5C7.7761,3,8,3.2239,8,3.5&#xA;&#x9;V6.5z"/>\n</svg>'},furniture:{label:"Furniture",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="furniture-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <g>\n    <path d="M9,10.1419V8.5013C9,8.2244,8.7756,8,8.4987,8H7.5013C7.2244,8,7,8.2244,7,8.5013v1.6406&#xA;&#x9;&#x9;c-1.538,0.3984-2.7227,1.6744-2.9573,3.2719C3.9976,13.7202,4.2291,14,4.5389,14h6.9222c0.3098,0,0.5413-0.2798,0.4962-0.5862&#xA;&#x9;&#x9;C11.7227,11.8163,10.538,10.5403,9,10.1419z"/>\n    <path d="M13.6394,6.2788l-2.5016-5.0034C11.0533,1.1066,10.8808,1,10.692,1H5.308C5.1192,1,4.9467,1.1066,4.8622,1.2755&#xA;&#x9;&#x9;L2.3606,6.2788C2.1949,6.6102,2.4359,7,2.8063,7H11v1.5C11,8.7761,11.2239,9,11.5,9S12,8.7761,12,8.5V7h1.1937&#xA;&#x9;&#x9;C13.5641,7,13.8051,6.6102,13.6394,6.2788z"/>\n  </g>\n</svg>'},gaming:{label:"Gaming",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="gaming-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.1,12.5c-0.6,0.3-1.4,0.1-1.8-0.5l-1.1-1.4H4.8L3.7,12l0,0c-0.5,0.7-1.4,0.8-2.1,0.3c-0.5-0.4-0.7-1-0.6-1.5l0.7-3.7l0,0&#xA;&#x9;C1.9,5.9,3,5,4.2,5v0H7V3.5C7,2.7,7.6,2,8.4,2h3.1C11.8,2,12,2.2,12,2.5S11.8,3,11.5,3h-3C8.2,3,8,3.2,8,3.4c0,0,0,0.1,0,0.1V5h2.8&#xA;&#x9;v0c1.2,0,2.3,0.9,2.5,2.1l0,0l0.7,3.7l0,0C14.1,11.5,13.8,12.2,13.1,12.5z M6,7.5C6,6.7,5.3,6,4.5,6S3,6.7,3,7.5S3.7,9,4.5,9&#xA;&#x9;S6,8.3,6,7.5z M12,7.5C12,7.2,11.8,7,11.5,7H11V6.5C11,6.2,10.8,6,10.5,6S10,6.2,10,6.5V7H9.5C9.2,7,9,7.2,9,7.5S9.2,8,9.5,8H10v0.5&#xA;&#x9;C10,8.8,10.2,9,10.5,9S11,8.8,11,8.5V8h0.5C11.8,8,12,7.8,12,7.5z"/>\n</svg>'},garden:{label:"Garden",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="garden-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13,8c0,3.31-2.19,6-5.5,6S2,11.31,2,8c2.2643,0.0191,4.2694,1.4667,5,3.61V7H4.5C3.6716,7,3,6.3284,3,5.5v-3&#xA;&#x9;C3,2.2239,3.2239,2,3.5,2c0.1574,0,0.3056,0.0741,0.4,0.2l1.53,2l1.65-3c0.1498-0.232,0.4593-0.2985,0.6913-0.1487&#xA;&#x9;C7.8308,1.0898,7.8815,1.1404,7.92,1.2l1.65,3l1.53-2c0.1657-0.2209,0.4791-0.2657,0.7-0.1C11.9259,2.1944,12,2.3426,12,2.5v3&#xA;&#x9;C12,6.3284,11.3284,7,10.5,7H8v4.61C8.7306,9.4667,10.7357,8.0191,13,8z"/>\n</svg>'},"garden-centre":{label:"Garden centre",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" id="garden-centre-15">\n  <path d="M4,5L4,4.5C4,3.12 5.12,2 6.5,2C7.88,2 9,3.12 9,4.5L9,10.293L11.365,7.928L11.018,6.633C11.018,6.631 11.017,6.629 11.017,6.627L11.016,6.627L11.016,6.627C10.973,6.461 11.016,6.276 11.147,6.146C11.342,5.951 11.659,5.951 11.854,6.146L13.854,8.146C14.049,8.341 14.049,8.658 13.854,8.853C13.724,8.983 13.541,9.027 13.375,8.984C13.375,8.984 13.375,8.984 13.375,8.984C13.372,8.983 13.369,8.982 13.365,8.981L12.072,8.635L9,11.707L9,12C9,12.552 8.552,13 8,13L5,13C4.448,13 4,12.552 4,12L4,11.536L1.732,9.268C0.757,8.292 0.757,6.708 1.732,5.732C2.22,5.244 2.86,5 3.5,5L3.5,5L4,5ZM4,6L3.5,6L3.5,6C3.116,6 2.732,6.147 2.439,6.439C1.854,7.025 1.854,7.975 2.439,8.561L4,10.121L4,6ZM8,5L8,4.5C8,3.672 7.328,3 6.5,3C5.672,3 5,3.672 5,4.5L5,5L8,5Z"/>\n</svg>'},gift:{label:"Gift",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="gift-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M6.5,5v2H0V5H6.5z M8.5,5v2H15V5H8.5z M1,8v4.5C1,13.3284,1.6716,14,2.5,14h4V8H1z M8.5,8v6h4c0.8284,0,1.5-0.6716,1.5-1.5&#xA;&#x9;V8H8.5z M10.5,0c-1.4033-0.0444-2.6497,0.8904-3,2.25C7.1497,0.8904,5.9033-0.0444,4.5,0c-1.0709-0.0337-1.9663,0.8072-2,1.8781&#xA;&#x9;C2.4987,1.9187,2.4987,1.9594,2.5,2C2.3443,2.9427,2.9822,3.8331,3.9249,3.9888C4.0853,4.0153,4.2486,4.0191,4.41,4h6.13&#xA;&#x9;c0.9548,0.1497,1.8503-0.5029,2-1.4577c0.0282-0.1797,0.0282-0.3626,0-0.5423c0.0002-1.1046-0.895-2.0002-1.9996-2.0004&#xA;&#x9;C10.5269-0.0004,10.5135-0.0003,10.5,0z M4.5,3c-0.506,0.0463-0.9537-0.3264-1-0.8323C3.4949,2.1119,3.4949,2.0558,3.5,2&#xA;&#x9;C3.4537,1.494,3.8264,1.0463,4.3323,1C4.3881,0.9949,4.4442,0.9949,4.5,1c1.1046,0,2,0.8954,2,2H4.5z M10.5,3h-2&#xA;&#x9;c0-1.1046,0.8954-2,2-2c0.5523,0,1,0.4477,1,1c0.0463,0.506-0.3264,0.9537-0.8323,1C10.6119,3.0051,10.5558,3.0051,10.5,3z"/>\n</svg>'},globe:{label:"Globe",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="globe-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <g>\n    <g>\n      <path d="M11.9807,9.4807l-0.7208-0.7208C10.3425,9.8168,9.006,10.5,7.5,10.5c-2.757,0-5-2.243-5-5&#xA;&#x9;&#x9;&#x9;c0-1.506,0.6832-2.8425,1.7401-3.7599L3.5193,1.0193C2.2831,2.1183,1.5,3.7158,1.5,5.5c0,3.1449,2.4208,5.72,5.5,5.9747V13H6.5&#xA;&#x9;&#x9;&#x9;C6.2239,13,6,13.2238,6,13.5C6,13.7761,6.2239,14,6.5,14h2C8.7761,14,9,13.7761,9,13.5C9,13.2238,8.7761,13,8.5,13H8v-1.5273&#xA;&#x9;&#x9;&#x9;C9.5806,11.341,10.9858,10.5997,11.9807,9.4807z"/>\n    </g>\n    <g>\n      <path d="M7.5,9C9.433,9,11,7.433,11,5.5S9.433,2,7.5,2S4,3.567,4,5.5S5.567,9,7.5,9z M8.5,4l0.3638-0.5915&#xA;&#x9;&#x9;&#x9;c0.3463,0.2263,0.6249,0.5394,0.8235,0.9042L9.5,5h-1V4z M6.6563,3.1563L7.5,4v1L8,6h1.5h0.4396&#xA;&#x9;&#x9;&#x9;C9.7708,6.826,9.2026,7.5041,8.4381,7.8144L8,7H6.5L5.0504,5C5.2251,4.1396,5.8452,3.4486,6.6563,3.1563z"/>\n    </g>\n  </g>\n</svg>'},golf:{label:"Golf",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="golf-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path11758" d="&#xA;&#x9;M3.3999,1.1c0,0.1,0,0.2,0,0.2c0,0.4,0.3,0.7,0.7,0.7c0.3,0,0.5-0.2,0.6-0.5l0,0L4.9,1l5.6,2.3L6.6,6C6.2,6.3,6.2,6.7,6.3,7.1&#xA;&#x9;l0.9,2.1l-1.3,3.9C5.7,13.6,6.1,14,6.5,14c0.3,0,0.5-0.1,0.6-0.5l1.4-4l0.1,0.3v3.5c0,0,0,0.7,0.7,0.7s0.7-0.7,0.7-0.7V10&#xA;&#x9;c0-0.2,0-0.3-0.1-0.5L8.5,6.1l2.7-1.9c0.2-0.2,0.4-0.3,0.4-0.6s-0.2-0.5-0.4-0.6L4,0.1c-0.0878,0-0.118,0.0179-0.2001,0.1&#xA;&#x9;L3.3999,1.1z M5.5,3C4.7,3,4,3.7,4,4.5S4.7,6,5.5,6S7,5.3,7,4.5S6.2999,3,5.5,3z"/>\n</svg>'},grocery:{label:"Grocery",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="grocery-15" width="15px" height="15px" viewBox="0 0 15 15">\n  <g id="g3">\n    <path d="M 13.199219 1.5 C 13.199219 1.5 11.808806 1.4588 11.253906 2 C 10.720406 2.5202 10.5 2.9177 10.5 4 L 1.1992188 4 L 2.59375 8.8144531 C 2.59725 8.8217531 2.6036219 8.8287375 2.6074219 8.8359375 C 2.8418219 9.4932375 3.4545469 9.9666406 4.1855469 9.9941406 C 4.1885469 9.9954406 4.1992187 10 4.1992188 10 L 10.699219 10 L 10.699219 10.199219 C 10.699219 10.199219 10.7 10.500391 10.5 10.900391 C 10.3 11.300391 10.200391 11.5 9.4003906 11.5 L 2.9003906 11.5 C 1.9003906 11.5 1.9003906 13 2.9003906 13 L 4.0996094 13 L 4.1992188 13 L 9.0996094 13 L 9.1992188 13 L 9.3007812 13 C 10.500781 13 11.399219 12.299609 11.699219 11.599609 C 11.999219 10.899609 12 10.300781 12 10.300781 L 12 10 L 12 4 C 12 3.4764 12.228619 3 12.699219 3 L 13.25 3 C 13.6642 3 14 2.6642 14 2.25 C 14 1.8358 13.6642 1.5 13.25 1.5 L 13.199219 1.5 z M 9.1992188 13 C 8.5992188 13 8.1992188 13.4 8.1992188 14 C 8.1992188 14.6 8.5992187 15 9.1992188 15 C 9.7992187 15 10.199219 14.6 10.199219 14 C 10.199219 13.4 9.7992188 13 9.1992188 13 z M 4.1992188 13 C 3.5992188 13 3.1992188 13.4 3.1992188 14 C 3.1992188 14.6 3.5992187 15 4.1992188 15 C 4.7992188 15 5.1992188 14.6 5.1992188 14 C 5.1992188 13.4 4.7992187 13 4.1992188 13 z " id="path5"/>\n  </g>\n</svg>'},hairdresser:{label:"Hairdresser",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="hairdresser-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M15,3c0,0-2-0.6-3.5,0.5l-4.3,3C6.4,5.9,5.2,5.2,4,4.8V4c0-1.1-0.9-2-2-2C0.9,2,0,2.9,0,4v1.5&#xA;&#x9;C0,6,0.5,6,0.5,6H2h0.5C4.5,6,6,7.5,6,7.5S4.5,9,2.5,9H2H0.5C0.5,9,0,9,0,9.5V11c0,1.1,0.9,2,2,2c1.1,0,2-0.9,2-2v-0.8&#xA;&#x9;c1.2-0.4,2.4-1.1,3.2-1.7l4.3,3C13,12.6,15,12,15,12L8.5,7.5L15,3z M3,5H2H1V4c0-0.6,0.4-1,1-1c0.6,0,1,0.4,1,1V5z M3,11&#xA;&#x9;c0,0.6-0.4,1-1,1c-0.6,0-1-0.4-1-1v-1h1h1V11z M7.25,8c-0.2761,0-0.5-0.2239-0.5-0.5S6.9739,7,7.25,7s0.5,0.2239,0.5,0.5&#xA;&#x9;S7.5261,8,7.25,8z"/>\n</svg>'},harbor:{label:"Harbor",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="harbor-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5263" d="M7.5,0C5.5,0,4,1.567,4,3.5c0.0024,1.5629,1.0397,2.902,2.5,3.3379v6.0391&#xA;&#x9;c-0.9305-0.1647-1.8755-0.5496-2.6484-1.2695C2.7992,10.6273,2.002,9.0676,2.002,6.498c0.0077-0.5646-0.4531-1.0236-1.0176-1.0137&#xA;&#x9;C0.4329,5.493-0.0076,5.9465,0,6.498c0,3.0029,1.0119,5.1955,2.4902,6.5723C3.9685,14.4471,5.8379,15,7.5,15&#xA;&#x9;c1.6656,0,3.535-0.5596,5.0117-1.9395S14.998,9.4868,14.998,6.498c0.0648-1.3953-2.0628-1.3953-1.998,0&#xA;&#x9;c0,2.553-0.7997,4.1149-1.8535,5.0996C10.3731,12.3203,9.4288,12.7084,8.5,12.875V6.8418C9.9607,6.4058,10.9986,5.0642,11,3.5&#xA;&#x9;C11,1.567,9.5,0,7.5,0z M7.5,2C8.3284,2,9,2.6716,9,3.5S8.3284,5,7.5,5S6,4.3284,6,3.5S6.6716,2,7.5,2z"/>\n</svg>'},hardware:{label:"Hardware",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="hardware-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.7919,3.2619c0,0-1.676,1.675-2.1163,2.1208c-0.085,0.0861-0.1688,0.1135-0.282,0.0961&#xA;&#x9;c-0.1481-0.0226-0.2974-0.038-0.4462-0.0558c-0.4072-0.0485-0.8145-0.0966-1.2292-0.1458C9.649,4.6852,9.5787,4.1049,9.5177,3.5236&#xA;&#x9;C9.512,3.4689,9.5509,3.3943,9.5925,3.3522c0.5071-0.5134,1.9261-1.9287,2.134-2.136c-0.4508-0.2129-1.2243-0.2968-1.8007-0.2031&#xA;&#x9;c-2.1801,0.3543-3.5112,2.534-2.8206,4.625C7.1432,5.753,7.1194,5.8201,7.0374,5.902C5.1891,7.7454,3.3436,9.5914,1.498,11.4374&#xA;&#x9;c-0.0616,0.0616-0.1231,0.124-0.1779,0.1913c-0.5264,0.6473-0.3873,1.6264,0.2974,2.102c0.6044,0.4197,1.3658,0.3442,1.9053-0.1948&#xA;&#x9;c1.8534-1.8519,3.7059-3.7047,5.556-5.5598C9.1707,7.884,9.2437,7.8526,9.3779,7.8983c0.6189,0.2109,1.2524,0.2354,1.8884,0.0884&#xA;&#x9;c1.9386-0.4478,3.1251-2.3732,2.6549-4.3034C13.8895,3.5532,13.843,3.4244,13.7919,3.2619z"/>\n</svg>'},heart:{label:"Heart",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>\n</svg>'},heliport:{label:"Heliport",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="heliport-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path10415" d="M4,2C3,2,3,3,4,3h4v1C7.723,4,7.5,4.223,7.5,4.5V5H5H3.9707H3.9316&#xA;&#x9;C3.7041,4.1201,2.9122,3.5011,2,3.5c-1.1046,0-2,0.8954-2,2s0.8954,2,2,2c0.3722-0.001,0.7368-0.1058,1.0527-0.3027L5.5,10.5&#xA;&#x9;C6.5074,11.9505,8.3182,12,9,12h5c0,0,1,0,1-1v-0.9941C15,9.2734,14.874,8.874,14.5,8.5l-3-3c0,0-0.5916-0.5-1.2734-0.5H9.5V4.5&#xA;&#x9;C9.5,4.223,9.277,4,9,4V3h4c1,0,1-1,0-1C13,2,4,2,4,2z M2,4.5c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1s-1-0.4477-1-1&#xA;&#x9;C1,4.9477,1.4477,4.5,2,4.5z M10,6c0.5,0,0.7896,0.3231,1,0.5L13.5,9H10c0,0-1,0-1-1V7C9,7,9,6,10,6z"/>\n</svg>'},home:{label:"Home",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15" id="home-15">\n  <path d="M2,13.7478c0,0.13807,0.11193,0.25,0.25,0.25h3.749v-3h3v3h3.749c0.13807,0,0.25-0.11193,0.25-0.25V7.9987H2&#xA;&#x9;C2,7.9987,2,13.7478,2,13.7478z M13.93,6.5778l-0.9319-0.8189V2c0-0.55228-0.44771-1-1-1s-1,0.44772-1,1v2L7.6808,1.09&#xA;&#x9;C7.5863,0.9897,7.42846,0.98478,7.3279,1.079L7.3169,1.09L1.0678,6.553C0.9734,6.65376,0.97856,6.81197,1.07932,6.90637&#xA;&#x9;C1.12478,6.94896,1.18451,6.97304,1.2468,6.9739L3,6.9989h10.7468c0.13807,0.00046,0.25037-0.1111,0.25083-0.24917&#xA;&#x9;C13.99784,6.68592,13.97365,6.62445,13.93,6.5779V6.5778z"/>\n</svg>'},"horse-riding":{label:"Horse riding",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="horse-riding-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M6,1A1,1,0,1,1,7,2,1,1,0,0,1,6,1ZM8,3.5a.484.484,0,0,0,0-.058A.472.472,0,0,0,7.5,3h-1a.484.484,0,0,0-.058,0A.472.472,0,0,0,6,3.5V7H8Zm6.85,3.644L12.8,4.8l.085-.509a.478.478,0,0,0,.008-.063.25.25,0,0,0-.25-.25.346.346,0,0,0-.158.056L9,7H8L9,8V9.5a.5.5,0,0,1-1,0v-1L6,7H4a1.5,1.5,0,0,0-1.243.661A1.466,1.466,0,0,0,1.563,7H1.5A1.449,1.449,0,0,0,0,8.4v.086A3.781,3.781,0,0,0,.559,10.4a.278.278,0,0,0,.191.1A.25.25,0,0,0,1,10.25V9s-.02-.924.753-1c.5-.048.747.253.747.5V11L2,13v1.75a.25.25,0,0,0,.25.25.254.254,0,0,0,.25-.234V13L4,11v1l.5,2.8a.255.255,0,0,0,.246.2A.25.25,0,0,0,5,14.754H5L4.855,12.3,5.5,11H8v1l.508,2.813A.257.257,0,0,0,8.75,15,.25.25,0,0,0,9,14.75V12l.367-1a1.155,1.155,0,0,0,.543-.6l2.161-3.767a.863.863,0,0,0,1.023.4l1.066.818a.591.591,0,0,0,.35.135.487.487,0,0,0,.475-.4A.552.552,0,0,0,14.85,7.144Z"/>\n</svg>'},hospital:{label:"Hospital",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="hospital-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect4194" d="M7,1C6.4,1,6,1.4,6,2v4H2C1.4,6,1,6.4,1,7v1&#xA;&#x9;c0,0.6,0.4,1,1,1h4v4c0,0.6,0.4,1,1,1h1c0.6,0,1-0.4,1-1V9h4c0.6,0,1-0.4,1-1V7c0-0.6-0.4-1-1-1H9V2c0-0.6-0.4-1-1-1H7z"/>\n</svg>'},"ice-cream":{label:"Ice cream",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="ice-cream-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M5.44,8.17c0.7156,0.0006,1.414-0.2194,2-0.63C7.9037,7.8634,8.4391,8.0693,9,8.14h0.44L8,13.7&#xA;&#x9;c-0.1082,0.2541-0.4019,0.3723-0.656,0.264C7.2252,13.9134,7.1306,13.8188,7.08,13.7L5.44,8.17z"/>\n  <path d="M11.44,4.67c0,1.1046-0.8954,2-2,2s-2-0.8954-2-2l0,0l0,0l0,0c0,1.1046-0.8954,2-2,2s-2-0.8954-2-2s0.8954-2,2-2h0.12&#xA;&#x9;C5.1756,1.6345,5.7035,0.4834,6.739,0.099s2.1866,0.1435,2.571,1.179c0.1667,0.449,0.1667,0.9429,0,1.3919h0.13&#xA;&#x9;C10.5446,2.67,11.44,3.5654,11.44,4.67z"/>\n</svg>'},industry:{label:"Industry",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="industry-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,1v12H1V8.72c0.0016-0.1419,0.0634-0.2764,0.17-0.37l3-3.22c0.2074-0.1823,0.5234-0.1618,0.7056,0.0456&#xA;&#x9;C4.9568,5.268,5.0011,5.387,5,5.51v3l3.16-3.37c0.2025-0.1878,0.5188-0.1759,0.7066,0.0266C8.9532,5.2599,9.0009,5.3827,9,5.51V11h3&#xA;&#x9;V1H14z"/>\n</svg>'},information:{label:"Information",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="information-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect8399" d="M7.5,1&#xA;&#x9;C6.7,1,6,1.7,6,2.5S6.7,4,7.5,4S9,3.3,9,2.5S8.3,1,7.5,1z M4,5v1c0,0,2,0,2,2v2c0,2-2,2-2,2v1h7v-1c0,0-2,0-2-2V6c0-0.5-0.5-1-1-1H4&#xA;&#x9;z"/>\n</svg>'},"jewelry-store":{label:"Jewelry store",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="jewelry-store-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12,8.5c0,2.4853-2.0147,4.5-4.5,4.5S3,10.9853,3,8.5c0-1.8483,1.1164-3.4329,2.7099-4.1255l0.1761,0.137l0.7739,0.6019&#xA;&#x9;C5.1366,5.4922,4,6.8611,4,8.5C4,10.4299,5.5701,12,7.5,12S11,10.4299,11,8.5c0-1.6389-1.1366-3.0078-2.6599-3.3866l0.95-0.7388&#xA;&#x9;C10.8836,5.0672,12,6.6517,12,8.5z M7.5,4.5L10,2.5555L9,1H6L5,2.5555l1.5,1.1667L7.5,4.5z"/>\n</svg>'},karaoke:{label:"Karaoke",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" id="karaoke-15">\n  <g>\n    <path d="M12.1,2.952A2.988,2.988,0,0,0,6.99,4.917l3.142,3.142A2.988,2.988,0,0,0,12.1,2.952Z"/>\n    <path d="M4.672,8.255,2.55,10.377a1,1,0,0,0,0,1.414l.707.707a1,1,0,0,0,1.414,0l2.121-2.121L8.914,8.255,6.793,6.134Zm.741,2.087-.707-.707L6.793,7.548l.707.707Z"/>\n  </g>\n</svg>'},landmark:{label:"Landmark",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="landmark-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12.5,12H12v-0.5c0-0.3-0.2-0.5-0.5-0.5H11V6h1l1-2c-1,0.1-2,0.1-3,0C9.2,3.4,8.6,2.8,8,2V1.5C8,1.2,7.8,1,7.5,1&#xA;&#x9;S7,1.2,7,1.5V2C6.4,2.8,5.8,3.4,5,4C4,4.1,3,4.1,2,4l1,2h1v5c0,0-0.5,0-0.5,0C3.2,11,3,11.2,3,11.5V12H2.5C2.2,12,2,12.2,2,12.5V13&#xA;&#x9;h11v-0.5C13,12.2,12.8,12,12.5,12z M7,11H5V6h2V11z M10,11H8V6h2V11z"/>\n</svg>'},landuse:{label:"Landuse",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="landuse-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M8.911,3.854A.248.248,0,0,1,9,4.044V7.75A.25.25,0,0,1,8.75,8H6.25A.25.25,0,0,1,6,7.75V6H5V7.75A.25.25,0,0,1,4.75,8H2.25A.25.25,0,0,1,2,7.75v-3.7a.248.248,0,0,1,.089-.19L5.343,1.132a.245.245,0,0,1,.315,0ZM7.752,9.5a.248.248,0,0,0-.138.042L5,11.5H4v-2a.5.5,0,0,0-1,0v2H2v-2a.5.5,0,0,0-1,0v4.25a.25.25,0,0,0,.25.25h6.5A.25.25,0,0,0,8,13.75v-4A.248.248,0,0,0,7.752,9.5ZM14,6.245v6.5a.253.253,0,0,1-.253.253H10.253A.253.253,0,0,1,10,12.747V6.25A.249.249,0,0,1,10.25,6H11V5.249A.249.249,0,0,1,11.249,5h1.5A.253.253,0,0,1,13,5.253V6h.755A.245.245,0,0,1,14,6.245ZM13,11H11v1h2Zm0-2H11v1h2Zm0-2H11V8h2Z"/>\n</svg>'},laundry:{label:"Laundry",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="laundry-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path3291-2" d="M8,1L6,3H3c0,0-1,0-1,1v9c0,1,1,1,1,1h9c0,0,1,0,1-1V2c0-1-1-1-1-1&#xA;&#x9;S8,1,8,1z M8.5,2h2C10.777,2,11,2.223,11,2.5S10.777,3,10.5,3h-2C8.223,3,8,2.777,8,2.5S8.223,2,8.5,2z M7.5,6&#xA;&#x9;c1.6569,0,3,1.3431,3,3s-1.3431,3-3,3s-3-1.3431-3-3S5.8431,6,7.5,6z"/>\n</svg>'},library:{label:"Library",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="library-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7.47,4.92C7.47,4.92,5.7,3,1,3v8c4.7,0,6.47,2,6.47,2S9.3,11,14,11V3C9.3,3,7.47,4.92,7.47,4.92z M13,10&#xA;&#x9;c-1.9614,0.0492-3.8727,0.6299-5.53,1.68C5.836,10.6273,3.9432,10.0459,2,10V4c3.4,0.26,4.73,1.6,4.75,1.61l0.73,0.74L8.2,5.6&#xA;&#x9;c0,0,1.4-1.34,4.8-1.6V10z M8,10.24l-0.1-0.17c1.3011-0.5931,2.6827-0.9907,4.1-1.18v0.2c-1.3839,0.1953-2.7316,0.5929-4,1.18V10.24&#xA;&#x9;z M8,9.24L7.9,9.07C9.2016,8.4802,10.5832,8.086,12,7.9v0.2c-1.3844,0.1988-2.7321,0.5997-4,1.19V9.24z M8,8.24L7.9,8.07&#xA;&#x9;C9.2015,7.48,10.5831,7.0857,12,6.9v0.2c-1.3845,0.1981-2.7323,0.599-4,1.19V8.24z M8,7.24L7.9,7.07&#xA;&#x9;C9.2013,6.4794,10.583,6.0851,12,5.9v0.2c-1.3844,0.1986-2.7321,0.5996-4,1.19V7.24z M6.9,10.24C5.6639,9.6641,4.3499,9.2733,3,9.08&#xA;&#x9;v-0.2c1.3872,0.2028,2.7358,0.6141,4,1.22L6.9,10.24z M6.9,9.24C5.6629,8.671,4.3488,8.2869,3,8.1V7.9&#xA;&#x9;c1.386,0.2027,2.7341,0.6105,4,1.21L6.9,9.24z M6.9,8.24C5.6631,7.6705,4.3489,7.2863,3,7.1V6.9c1.3868,0.199,2.7354,0.607,4,1.21&#xA;&#x9;L6.9,8.24z M6.9,7.24C5.6629,6.671,4.3488,6.2869,3,6.1V5.9c1.386,0.2024,2.7342,0.6102,4,1.21L6.9,7.24z"/>\n</svg>'},lighthouse:{label:"Lighthouse",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="lighthouse-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M4.5,6L0,7V6.5l4.5-1V6z M4.5,3.5L0,2.5V3l4.5,1V3.5z M10.5,3.5V4L15,3V2.5L10.5,3.5z M10.5,6L15,7V6.5l-4.5-1V6z M8,7V2&#xA;&#x9;h2.5c0.2761,0.0552,0.5448-0.1239,0.6-0.4c0.0552-0.2761-0.1239-0.5448-0.4-0.6l-3-1C7.5696-0.0586,7.4204-0.0586,7.29,0l-3,1&#xA;&#x9;c-0.2761,0.0552-0.4552,0.3239-0.4,0.6S4.2139,2.0552,4.49,2H7v5H5l-2,7h9l-2-7H8z"/>\n</svg>'},lodging:{label:"Lodging",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="lodging-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect6507" d="M0.5,2.5C0.2,2.5,0,2.7,0,3v7.5v2C0,12.8,0.2,13,0.5,13S1,12.8,1,12.5V11h13v1.5&#xA;&#x9;c0,0.3,0.2,0.5,0.5,0.5s0.5-0.2,0.5-0.5v-2c0-0.3-0.2-0.5-0.5-0.5H1V3C1,2.7,0.8,2.5,0.5,2.5z M3.5,3C2.7,3,2,3.7,2,4.5l0,0&#xA;&#x9;C2,5.3,2.7,6,3.5,6l0,0C4.3,6,5,5.3,5,4.5l0,0C5,3.7,4.3,3,3.5,3L3.5,3z M7,4C5.5,4,5.5,5.5,5.5,5.5V7h-3C2.2,7,2,7.2,2,7.5v1&#xA;&#x9;C2,8.8,2.2,9,2.5,9H6h9V6.5C15,4,12.5,4,12.5,4H7z"/>\n</svg>'},logging:{label:"Logging",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="logging-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M13.91,3.41,13.5,3l.2-.28c.02-.03.04-.05.06-.08A.969.969,0,0,0,14,1.99a1,1,0,0,0-1.62-.77c-.03.02-.06.05-.09.07L12,1.5l-.386-.386a.354.354,0,0,0-.525.475l.417.417-.5.5-.392-.392a.354.354,0,0,0-.525.475L10.5,3l-.5.5-.381-.381a.354.354,0,1,0-.528.472h0l.028.028L9.5,4,9,4.5l-.395-.395a.354.354,0,0,0-.517.483L8.5,5,8,5.5l-.365-.365a.354.354,0,0,0-.556.439h0C7.1,5.6,7.508,6,7.508,6L7,6.5l-.394-.392a.392.392,0,0,0-.5-.028.384.384,0,0,0-.028.5L6.1,6.6l.4.4L6,7.5l-.4-.4a.37.37,0,0,0-.5,0L6.248,8.244,12.09,2.41,12.5,2H13v.5l-.41.41L6.751,8.749,7.9,9.9a.355.355,0,0,0,0-.5l-.008-.009L7.5,9,8,8.5l.384.384a.354.354,0,0,0,.528-.472L8.5,8,9,7.5l.38.38a.354.354,0,0,0,.528-.472l-.02-.02L9.5,7l.5-.5.377.377A.35.35,0,0,0,10.64,7a.347.347,0,0,0,.252-.6L10.5,6l.5-.5.38.38a.354.354,0,0,0,.528-.472L11.88,5.38,11.5,5l.5-.5.381.381a.354.354,0,0,0,.528-.472l-.025-.025L12.5,4l.5-.5.382.382a.354.354,0,0,0,.528-.472ZM4.39,7.916C3.893,7.419,3.641,7,3,7H1.5a.5.5,0,0,0-.5.5v3A2.19,2.19,0,0,0,1.5,12l.815.811A2.251,2.251,0,0,0,5.493,13h0L7.5,11ZM3.5,10,2.262,11.238A1.3,1.3,0,0,1,2,10.5V8H3a.545.545,0,0,1,.335.194.455.455,0,0,1,.165.418Z"/>\n</svg>'},marker:{label:"Marker",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="marker-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4133" d="M7.5,0C5.0676,0,2.2297,1.4865,2.2297,5.2703&#xA;&#x9;C2.2297,7.8378,6.2838,13.5135,7.5,15c1.0811-1.4865,5.2703-7.027,5.2703-9.7297C12.7703,1.4865,9.9324,0,7.5,0z"/>\n</svg>'},"marker-stroked":{label:"Marker stroked",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="marker-stroked-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="Layer_7" d="M7.5,14.941l-.4-.495c-.973-1.189-4.9-6.556-4.9-9.16A5.066,5.066,0,0,1,7.036,0q.222-.01.445,0a5.066,5.066,0,0,1,5.286,4.836q.01.225,0,.45c0,2.213-2.669,6.111-4.678,8.851ZM7.481.986a4.077,4.077,0,0,0-4.3,4.3c0,1.832,2.759,6.038,4.286,8.034,1.25-1.71,4.315-5.989,4.315-8.034a4.077,4.077,0,0,0-4.3-4.3Z"/>\n</svg>'},"mobile-phone":{label:"Mobile phone",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="mobile-phone-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M10,2h0V1.5a.5.5,0,0,0-1,0V2H5A1,1,0,0,0,4,3V13a1,1,0,0,0,1,1h5a1,1,0,0,0,1-1V3A1,1,0,0,0,10,2ZM6,13H5V12H6Zm0-2H5V10H6ZM6,9H5V8H6Zm2,4H7V12H8Zm0-2H7V10H8ZM8,9H7V8H8Zm2,4H9V12h1Zm0-2H9V10h1Zm0-2H9V8h1Zm0-2.5a.5.5,0,0,1-.5.5h-4A.5.5,0,0,1,5,6.5v-3A.5.5,0,0,1,5.5,3h4a.5.5,0,0,1,.5.5Z"/>\n</svg>'},monument:{label:"Monument",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="monument-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path11719-7" d="M7.5,0L6,2.5v7h3v-7L7.5,0z M3,11.5&#xA;&#x9;L3,15h9v-3.5L10.5,10h-6L3,11.5z"/>\n</svg>'},mountain:{label:"Mountain",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="mountain-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5571" d="M7.5,2C7.2,2,7.1,2.2,6.9,2.4&#xA;&#x9;l-5.8,9.5C1,12,1,12.2,1,12.3C1,12.8,1.4,13,1.7,13h11.6c0.4,0,0.7-0.2,0.7-0.7c0-0.2,0-0.2-0.1-0.4L8.2,2.4C8,2.2,7.8,2,7.5,2z&#xA;&#x9; M7.5,3.5L10.8,9H10L8.5,7.5L7.5,9l-1-1.5L5,9H4.1L7.5,3.5z"/>\n</svg>'},museum:{label:"Museum",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="museum-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path7509" d="M7.5,0L1,3.4453V4h13V3.4453L7.5,0z M2,5v5l-1,1.5547V13h13v-1.4453L13,10&#xA;&#x9;V5H2z M4.6152,6c0.169-0.0023,0.3318,0.0639,0.4512,0.1836L7.5,8.6172l2.4336-2.4336c0.2445-0.2437,0.6402-0.2432,0.884,0.0013&#xA;&#x9;C10.9341,6.3017,10.9997,6.46,11,6.625v4.2422c0.0049,0.3452-0.271,0.629-0.6162,0.6338c-0.3452,0.0049-0.629-0.271-0.6338-0.6162&#xA;&#x9;c-0.0001-0.0059-0.0001-0.0118,0-0.0177V8.1328L7.9414,9.9414c-0.244,0.2433-0.6388,0.2433-0.8828,0L5.25,8.1328v2.7344&#xA;&#x9;c0.0049,0.3452-0.271,0.629-0.6162,0.6338C4.2887,11.5059,4.0049,11.2301,4,10.8849c-0.0001-0.0059-0.0001-0.0118,0-0.0177V6.625&#xA;&#x9;C4,6.2836,4.2739,6.0054,4.6152,6z"/>\n</svg>'},music:{label:"Music",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="music-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.5,1c-0.0804,0.0008-0.1594,0.0214-0.23,0.06L4.5,3.5C4.2239,3.5,4,3.7239,4,4v6.28C3.6971,10.1002,3.3522,10.0037,3,10&#xA;&#x9;c-1.1046,0-2,0.8954-2,2s0.8954,2,2,2s2-0.8954,2-2V7.36l8-2.22v3.64c-0.3029-0.1798-0.6478-0.2763-1-0.28c-1.1046,0-2,0.8954-2,2&#xA;&#x9;s0.8954,2,2,2s2-0.8954,2-2v-9C14,1.2239,13.7761,1,13.5,1z M13,4.14L5,6.36v-2l8-2.22C13,2.14,13,4.14,13,4.14z"/>\n</svg>'},natural:{label:"Natural",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="natural-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M8.753,6.278a.5.5,0,0,1-.51,0A4.109,4.109,0,0,1,6.5,3.5a2.779,2.779,0,0,0-.59-1.506l-.019-.027a.257.257,0,0,1-.056-.144.237.237,0,0,1,.25-.25.264.264,0,0,1,.057.011A3.523,3.523,0,0,1,7.5,2.5L8.28.94a.246.246,0,0,1,.44,0L9.5,2.5a3.4,3.4,0,0,1,1.339-.907.283.283,0,0,1,.1-.021c.175.009.212.119.221.249a.35.35,0,0,1-.043.141A5.2,5.2,0,0,0,10.5,3.5,4.113,4.113,0,0,1,8.753,6.278ZM5,8H6.289a.25.25,0,0,0,.25-.25.241.241,0,0,0-.061-.15L4.7,5.235a.255.255,0,0,0-.391,0L2.518,7.589a.274.274,0,0,0-.062.161.25.25,0,0,0,.25.25H4L1.335,10.6a.273.273,0,0,0-.058.152A.25.25,0,0,0,1.529,11H3L1.435,12.565a.255.255,0,0,0,.18.435H4v1H5V13H7.385a.255.255,0,0,0,.18-.435L6,11H7.471a.25.25,0,0,0,.25-.25.233.233,0,0,0-.058-.149Zm9.345,3.748a.252.252,0,0,1-.252.252H8.908a.252.252,0,0,1-.226-.365L11.27,6.451a.252.252,0,0,1,.451,0l2.6,5.184h0A.251.251,0,0,1,14.345,11.748ZM12.75,10,11.5,7.5,10.25,10Z"/>\n</svg>'},"oil-rig-es":{label:"Oil rig",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="oil-rig-es-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M14,13H12L10,2H9V1H8V0H7V1H6V2H5L3,13H1L0,15H15ZM5.82,3H9.18l.55,3H5.27ZM9,7,7.5,9.25,6,7ZM4,13,5.07,7.11,7,10,5,13Zm2,0,1.5-2.25L9,13Zm4,0L8,10,9.93,7.11,11,13Z"/>\n</svg>'},optician:{label:"Optician",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="optician-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14.5,6h-0.6766c-0.2828-0.5892-0.8801-1-1.5763-1H9.752C8.9344,5,8.2513,5.5656,8.059,6.3246&#xA;&#x9;C7.8854,6.2835,7.6991,6.25,7.5,6.25S7.1146,6.2834,6.941,6.3245C6.7487,5.5656,6.0654,5,5.2476,5H2.7529&#xA;&#x9;C2.0566,5,1.4592,5.4108,1.1765,6H0.4992C0.2235,6,0,6.2234,0,6.4991v0.0016C0,6.7765,0.2235,7,0.4992,7H1v0.5&#xA;&#x9;C1,9.0889,2.0024,10,3.75,10h0.5C5.9976,10,7,9.0889,7,7.5V7.3413C7.1503,7.2933,7.3307,7.25,7.5,7.25&#xA;&#x9;c0.1693,0,0.3499,0.0433,0.5,0.0913V7.5C8,9.0889,9.002,10,10.75,10h0.5C12.998,10,14,9.0889,14,7.5V7h0.5&#xA;&#x9;C14.7761,7,15,6.7761,15,6.5C15,6.2238,14.7761,6,14.5,6z M6,7.5C6,8.1982,5.8013,9,4.25,9h-0.5C2.1987,9,2,8.1982,2,7.5V6.7524&#xA;&#x9;C2,6.3374,2.3379,6,2.7529,6h2.4946C5.6626,6,6,6.3374,6,6.7524V7.5z M13,7.5C13,8.1982,12.8008,9,11.25,9h-0.5&#xA;&#x9;C9.1992,9,9,8.1982,9,7.5V6.7524C9,6.3374,9.3369,6,9.752,6h2.4951C12.6621,6,13,6.3379,13,6.7529V7.5z"/>\n</svg>'},paint:{label:"Paint",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="paint-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.5,2.5h-1V1.5027C12.5,1.225,12.2749,1,11.9973,1H1.5027C1.2251,1,1,1.225,1,1.5027v2.9946C1,4.7749,1.2251,5,1.5027,5&#xA;&#x9;h10.4946C12.2749,5,12.5,4.7749,12.5,4.4973V3.5H13v3.1021L6.8877,8.0127C6.6606,8.0654,6.5,8.2676,6.5,8.5v1.5074&#xA;&#x9;c-0.2783,0.02-0.5,0.246-0.5,0.5295v2.9261C6,13.7596,6.2404,14,6.5369,14h0.9261C7.7596,14,8,13.7596,8,13.4631v-2.9261&#xA;&#x9;c0-0.2834-0.2217-0.5095-0.5-0.5295v-1.11l6.1123-1.4102C13.8389,7.4351,14,7.2329,14,7V3C14,2.7236,13.7764,2.5,13.5,2.5z"/>\n</svg>'},park:{label:"Park",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="park-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,5.75c0.0113-0.6863-0.3798-1.3159-1-1.61C12.9475,3.4906,12.4014,2.9926,11.75,3&#xA;&#x9;c-0.0988,0.0079-0.1962,0.0281-0.29,0.06c-0.0607-0.66-0.6449-1.1458-1.3048-1.0851C9.8965,1.9987,9.6526,2.1058,9.46,2.28l0,0&#xA;&#x9;c0-0.6904-0.5596-1.25-1.25-1.25S6.96,1.5896,6.96,2.28C6.96,2.28,7,2.3,7,2.33C6.4886,1.8913,5.7184,1.9503,5.2797,2.4618&#xA;&#x9;C5.1316,2.6345,5.0347,2.8451,5,3.07C4.8417,3.0195,4.6761,2.9959,4.51,3C3.6816,2.9931,3.0044,3.659,2.9975,4.4874&#xA;&#x9;C2.9958,4.6872,3.0341,4.8852,3.11,5.07C2.3175,5.2915,1.8546,6.1136,2.0761,6.9061C2.2163,7.4078,2.6083,7.7998,3.11,7.94&#xA;&#x9;c0.2533,0.7829,1.0934,1.2123,1.8763,0.959C5.5216,8.7258,5.9137,8.2659,6,7.71C6.183,7.8691,6.4093,7.9701,6.65,8v5L5,14h5l-1.6-1&#xA;&#x9;v-2c0.7381-0.8915,1.6915-1.5799,2.77-2c0.8012,0.1879,1.603-0.3092,1.7909-1.1103C12.9893,7.7686,13.0025,7.6444,13,7.52&#xA;&#x9;c0.0029-0.0533,0.0029-0.1067,0-0.16C13.6202,7.0659,14.0113,6.4363,14,5.75z M8.4,10.26V6.82C8.6703,7.3007,9.1785,7.5987,9.73,7.6&#xA;&#x9;h0.28c0.0156,0.4391,0.2242,0.849,0.57,1.12C9.7643,9.094,9.0251,9.6162,8.4,10.26z"/>\n</svg>'},"park-alt1":{label:"Park 2",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="park-alt1-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M9.428,10.429a.269.269,0,0,1-.074-.18A.25.25,0,0,1,9.6,10h1.447a.25.25,0,0,0,.25-.25.258.258,0,0,0-.079-.179L9.07,7.419a.3.3,0,0,1-.063-.17A.249.249,0,0,1,9.257,7H10.4a.251.251,0,0,0,.25-.251.247.247,0,0,0-.077-.178L8.432,4.434,8.418,4.42a.262.262,0,0,1-.066-.17A.25.25,0,0,1,8.6,4h.866a.25.25,0,0,0,.25-.25.246.246,0,0,0-.068-.164h.006L7.7,1.238a.253.253,0,0,0-.042-.044A.249.249,0,0,0,7.5,1.139h0a.249.249,0,0,0-.158.055.253.253,0,0,0-.042.044L5.352,3.586a.246.246,0,0,0-.068.164.25.25,0,0,0,.25.25H6.4a.241.241,0,0,1,.184.42l-.014.014L4.431,6.571a.247.247,0,0,0-.077.178A.251.251,0,0,0,4.6,7H5.745a.249.249,0,0,1,.25.249.3.3,0,0,1-.063.17L3.782,9.571A.258.258,0,0,0,3.7,9.75a.25.25,0,0,0,.25.25H5.4a.25.25,0,0,1,.248.249.269.269,0,0,1-.074.18l-2.14,2.132-.009.009a.248.248,0,0,0,0,.351A.256.256,0,0,0,3.605,13H7v1l1-.008V13h3.391a.263.263,0,0,0,.26-.254.248.248,0,0,0-.071-.177Z"/>\n</svg>'},parking:{label:"Parking",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="parking-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11.85,8.37c-0.9532,0.7086-2.1239,1.0623-3.31,1H5.79V14H3V1h5.72c1.1305-0.0605,2.244,0.2952,3.13,1&#xA;&#x9;c0.8321,0.8147,1.2543,1.9601,1.15,3.12C13.1271,6.3214,12.7045,7.5159,11.85,8.37z M9.75,3.7C9.3254,3.3892,8.8052,3.237,8.28,3.27&#xA;&#x9;H5.79v3.82h2.49c0.5315,0.0326,1.056-0.1351,1.47-0.47c0.3795-0.3947,0.5693-0.9346,0.52-1.48C10.324,4.606,10.1327,4.0763,9.75,3.7&#xA;&#x9;z"/>\n</svg>'},"parking-garage":{label:"Parking garage",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="parking-garage-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M10.5,10.14c-0.6637,0.4788-1.4732,0.7121-2.29,0.66h-1.9V14h-1.9V5h3.92&#xA;&#x9;c0.7801-0.0414,1.5484,0.2041,2.16,0.69c0.5779,0.5595,0.875,1.3483,0.81,2.15C11.4042,8.6892,11.1088,9.5388,10.5,10.14z M9,6.9&#xA;&#x9;C8.711,6.6881,8.3579,6.5822,8,6.6H6.31v2.65H8c0.3612,0.0191,0.717-0.0947,1-0.32c0.2559-0.2675,0.3867-0.6308,0.36-1&#xA;&#x9;C9.4072,7.5493,9.274,7.1684,9,6.9z M14.41,4.21c0.114-0.2486,0.007-0.5427-0.24-0.66L7.5,0.45l-6.71,3.1&#xA;&#x9;C0.5387,3.666,0.429,3.9637,0.545,4.215C0.661,4.4663,0.9587,4.576,1.21,4.46l0,0L7.5,1.55l6.29,2.9&#xA;&#x9;c0.2486,0.114,0.5427,0.007,0.66-0.24H14.41z"/>\n</svg>'},pharmacy:{label:"Pharmacy",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="pharmacy-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M9.5,4l1.07-1.54c0.0599,0.0046,0.1201,0.0046,0.18,0c0.6904-0.0004,1.2497-0.5603,1.2494-1.2506&#xA;&#x9;C11.999,0.519,11.4391-0.0404,10.7487-0.04C10.0584-0.0396,9.499,0.5203,9.4994,1.2106c0,0.0131,0.0002,0.0262,0.0006,0.0394&#xA;&#x9;c0,0,0,0.07,0,0.1L7,4H9.5z M12,6V5H3v1l1.5,3.5L3,13v1h9v-1l-1-3.5L12,6z M10,10H8v2H7v-2H5V9h2V7h1v2h2V10z"/>\n</svg>'},"picnic-site":{label:"Picnic site",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="picnic-site-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect4760" d="M4,3C3.446,3,3,3.446,3,4s0.446,1,1,1h1.2969&#xA;&#x9;L4.6523,7H2.5c-0.554,0-1,0.446-1,1s0.446,1,1,1h1.5098L3.041,12.0098c-0.1284,0.3939,0.0868,0.8173,0.4807,0.9457&#xA;&#x9;s0.8173-0.0868,0.9457-0.4807c0.0005-0.0013,0.0009-0.0027,0.0013-0.004L5.5859,9h3.8281l1.1172,3.4707&#xA;&#x9;c0.1273,0.3943,0.5501,0.6107,0.9443,0.4834s0.6107-0.5501,0.4834-0.9443l0,0L10.9902,9H12.5c0.554,0,1-0.446,1-1s-0.446-1-1-1&#xA;&#x9;h-2.1523L9.7031,5H11c0.554,0,1-0.446,1-1s-0.446-1-1-1H4z M6.873,5H8.127l0.6445,2h-2.543L6.873,5z"/>\n</svg>'},pitch:{label:"Pitch",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="pitch-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M5,3C4.4477,3,4,2.5523,4,2s0.4477-1,1-1s1,0.4477,1,1S5.5523,3,5,3z M12.5,10H10L9,7L8,5.25L9,5l2.3,1l0,0&#xA;&#x9;c0.2761,0.1105,0.5895-0.0239,0.7-0.3S11.9761,5.1105,11.7,5l0,0L9,4H7L5,5L4,6H2.5C2.2239,6,2,6.2239,2,6.5S2.2239,7,2.5,7H5l1-1&#xA;&#x9;l1,2l-2,2v3.5C5,13.7761,5.2239,14,5.5,14S6,13.7761,6,13.5v-3.11L8,9l1,2h3.5c0.2761,0,0.5-0.2239,0.5-0.5S12.7761,10,12.5,10z"/>\n</svg>'},"place-of-worship":{label:"Place of worship",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="place-of-worship-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path9064" d="M7.5,0l-2,2v2h4V2&#xA;&#x9;L7.5,0z M5.5,4.5L4,6h7L9.5,4.5H5.5z M2,6.5c-0.5523,0-1,0.4477-1,1V13h2V7.5C3,6.9477,2.5523,6.5,2,6.5z M4,6.5V13h7V6.5H4z&#xA;&#x9; M13,6.5c-0.5523,0-1,0.4477-1,1V13h2V7.5C14,6.9477,13.5523,6.5,13,6.5z"/>\n</svg>'},playground:{label:"Playground",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="playground-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M2,1.15c0.2091-0.8016,1.0284-1.2819,1.83-1.0729s1.2819,1.0284,1.0729,1.83C4.7026,2.6752,3.9386,3.1542,3.16,3&#xA;&#x9;C2.3474,2.839,1.8191,2.0498,1.98,1.2371C1.9858,1.2079,1.9925,1.1788,2,1.15z M13,12.32c0.1032,0.5426-0.2531,1.066-0.7956,1.1692&#xA;&#x9;c-0.0015,0.0003-0.0029,0.0006-0.0044,0.0008c-0.4252,0.086-0.8574-0.1119-1.07-0.49l0,0L9.45,9.63L8,9.92L7.78,10H7.72v2.15&#xA;&#x9;L8.34,12h0.14c0.2871,0.0054,0.5155,0.2425,0.5101,0.5297C8.9862,12.7361,8.8606,12.9207,8.67,13l-5,1l0,0&#xA;&#x9;c-0.0563,0.0095-0.1137,0.0095-0.17,0c-0.2872,0-0.52-0.2328-0.52-0.52c0-0.2099,0.1262-0.3993,0.32-0.48l0,0l4.15-0.83V10&#xA;&#x9;l-3.22,0.58l0,0c-0.164,0.0423-0.336,0.0423-0.5,0c-0.3394-0.0867-0.6088-0.3446-0.71-0.68H3L2,5.83l0,0&#xA;&#x9;C1.9688,5.6884,1.9688,5.5416,2,5.4c0.0936-0.387,0.4078-0.6815,0.8-0.75l0,0l4.7-0.52V0h0.22v4.1h0.06L8,4.08L8.4,4h0.21&#xA;&#x9;c0.2673,0.0643,0.4326,0.3323,0.37,0.6C8.9361,4.835,8.729,5.0041,8.49,5L8,5.08H7.78H7.72v2.86h0.06L8,7.88l1.81-0.36l0,0l0,0&#xA;&#x9;c0.4275-0.0352,0.8299,0.2062,1,0.6l0,0l2,3.94l0,0C12.887,12.1358,12.9511,12.2236,13,12.32z M7.5,5.13L5,5.4l0.74,2.94L7.5,8V5.13&#xA;&#x9;z"/>\n</svg>'},police:{label:"Police",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="police-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect4718" d="M5.5,1L6,2h5l0.5-1H5.5z M6,2.5v1.25c0,0,0,2.75,2.5,2.75S11,3.75,11,3.75V2.5H6z M1.9844,3.9863&#xA;&#x9;C1.4329,3.9949,0.9924,4.4485,1,5v4c-0.0001,0.6398,0.5922,1.1152,1.2168,0.9766L5,9.3574V14l5.8789-6.9297&#xA;&#x9;C10.7391,7.0294,10.5947,7,10.4414,7H6.5L3,7.7539V5C3.0077,4.4362,2.5481,3.9775,1.9844,3.9863z M11.748,7.7109L6.4121,14H12&#xA;&#x9;V8.5586C12,8.2451,11.9061,7.9548,11.748,7.7109z"/>\n</svg>'},post:{label:"Post",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="post-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M14,6.5V12c0,0.5523-0.4477,1-1,1H2c-0.5523,0-1-0.4477-1-1V6.5C1,6.2239,1.2239,6,1.5,6&#xA;&#x9;c0.0692-0.0152,0.1408-0.0152,0.21,0l0,0l5.79,4l5.8-4l0,0c0.066-0.0138,0.134-0.0138,0.2,0C13.7761,6,14,6.2239,14,6.5z M1.25,3.92&#xA;&#x9;L1.25,3.92L1.33,4L7.5,8l6.19-4l0,0h0.06l0,0c0.1796-0.0981,0.2792-0.2975,0.25-0.5C14,3.2239,13.7761,3,13.5,3h-12&#xA;&#x9;C1.2239,3,1,3.2239,1,3.5C1.0026,3.6745,1.0978,3.8345,1.25,3.92z"/>\n</svg>'},prison:{label:"Prison",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="prison-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect3607" d="M3.5,1v13H12V1H3.5z M9.5,2H11v3.5H9.5V2z M4.5,2.0547H6V7H4.5V2.0547z M7,2.0547h1.5V7H7V2.0547z M10.25,6.5&#xA;&#x9;C10.6642,6.5,11,6.8358,11,7.25S10.6642,8,10.25,8l0,0C9.8358,8,9.5,7.6642,9.5,7.25l0,0C9.5,6.8358,9.8358,6.5,10.25,6.5z M7,8&#xA;&#x9;h1.4727L8.5,13H7.0273L7,8z M4.5,8.166H6V13H4.5V8.166z M9.5,9H11v4H9.5V9z"/>\n</svg>'},rail:{label:"Rail",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="rail-15" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M 3 1 C 2.4477 1 2 1.4477 2 2 L 2 10 C 2 10.5523 2.4477 11 3 11 L 12 11 C 12.5523 11 13 10.5523 13 10 L 13 2 C 13 1.4477 12.5523 1 12 1 L 3 1 z M 5.75 1.5 L 5.7597656 1.5 L 9.2597656 1.5 C 9.3978656 1.5 9.5097656 1.6119 9.5097656 1.75 C 9.5097656 1.8881 9.3978656 2 9.2597656 2 L 5.75 2 C 5.6119 2 5.5 1.8881 5.5 1.75 C 5.5 1.6119 5.6119 1.5 5.75 1.5 z M 3.5 3 L 7 3 L 7 7 L 3.5 7 C 3.2239 7 3 6.7761 3 6.5 L 3 3.5 C 3 3.2239 3.2239 3 3.5 3 z M 8 3 L 11.5 3 C 11.7761 3 12 3.2239 12 3.5 L 12 6.5 C 12 6.7761 11.7761 7 11.5 7 L 8 7 L 8 3 z M 5 8 C 5.5523 8 6 8.4477 6 9 C 6 9.5523 5.5523 10 5 10 C 4.4477 10 4 9.5523 4 9 C 4 8.4477 4.4477 8 5 8 z M 10 8 C 10.5523 8 11 8.4477 11 9 C 11 9.5523 10.5523 10 10 10 C 9.4477 10 9 9.5523 9 9 C 9 8.4477 9.4477 8 10 8 z M 10.445312 11.994141 C 10.380597 11.999652 10.314981 12.018581 10.253906 12.050781 C 10.030606 12.168381 9.9302313 12.433922 10.019531 12.669922 L 10.189453 13 L 4.8105469 13 L 4.9394531 12.730469 C 5.0371531 12.472169 4.9067375 12.183637 4.6484375 12.085938 C 4.4124375 11.996738 4.1468969 12.097113 4.0292969 12.320312 L 3.0292969 14.320312 C 3.0080969 14.377912 2.9986 14.4387 3 14.5 C 3 14.7761 3.2239 15 3.5 15 C 3.6802 14.999 3.8450875 14.899434 3.9296875 14.740234 L 3.9296875 14.689453 L 4 14.689453 L 4.3105469 14 L 10.689453 14 L 11 14.689453 L 11 14.740234 C 11.0846 14.899434 11.249488 14.999 11.429688 15 C 11.705787 15 11.929688 14.7761 11.929688 14.5 C 11.949587 14.4212 11.949587 14.338566 11.929688 14.259766 L 10.929688 12.259766 C 10.833163 12.076541 10.639459 11.977608 10.445312 11.994141 z " id="path3"/>\n</svg>'},"rail-light":{label:"Rail light",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="rail-light-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path14245" d="M5.5,0C5,0,5,0.5,5,0.5v1C5,1.777,5.223,2,5.5,2S6,1.777,6,1.5V1h1v2H6c0,0-2,0-2,2v3c0,3,3,3,3,3h1&#xA;&#x9;c0,0,3,0,3-3V5c0-2-2-2-2-2H8V1h1v0.5C9,1.777,9.223,2,9.5,2S10,1.777,10,1.5v-1C10,0,9.5,0,9.5,0H5.5z M7.5,4l2.0449,0.7734L10,6.5&#xA;&#x9;C10.1316,7,9.5,7,9.5,7h-4c0,0-0.6316,0-0.5-0.5l0.4551-1.7266L7.5,4z M7.5,8C7.7761,8,8,8.2239,8,8.5S7.7761,9,7.5,9&#xA;&#x9;S7,8.7761,7,8.5S7.2239,8,7.5,8z M4.125,12L3,15h1.5l0.375-1h5.25l0.375,1H12l-1.125-3h-1.5l0.375,1h-4.5l0.375-1H4.125z"/>\n</svg>'},"rail-metro":{label:"Rail metro",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="rail-metro-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path5258" d="M5.5,0c0,0-0.75,0-1,1L3,6.5V10c0,1,1,1,1,1h7c0,0,1,0,1-1V6.5L10.5,1c-0.2727-1-1-1-1-1H5.5z M6.5,1.5h2&#xA;&#x9;c0,0,0.5357,0,0.75,1L10,6c0.2146,1.0017-1,1-1,1H6c0,0-1.2146,0.0017-1-1l0.75-3.5C5.9643,1.5,6.5,1.5,6.5,1.5z M5,8&#xA;&#x9;c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1S4,9.5523,4,9S4.4477,8,5,8z M6.75,8h1.5C8.3885,8,8.5,8.1115,8.5,8.25S8.3885,8.5,8.25,8.5&#xA;&#x9;h-1.5C6.6115,8.5,6.5,8.3885,6.5,8.25S6.6115,8,6.75,8z M10,8c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1S9,9.5523,9,9S9.4477,8,10,8z&#xA;&#x9; M4.125,12L3,15h1.5l0.375-1h5.25l0.375,1H12l-1.125-3h-1.5l0.375,1h-4.5l0.375-1H4.125z"/>\n</svg>'},"ranger-station":{label:"Ranger station",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="ranger-station-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect4911" d="M9,0.5l-2,1v3.7734L2,8v6h4v-4h3&#xA;&#x9;v4h4V8L8,5.2734V4l1-0.5l2,1l2-1v-3l-2,1L9,0.5z"/>\n</svg>'},recycling:{label:"Recycling",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="recycling-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M2.4556,8.6134C2.118,9.2112,1.501,10.3021,2.593,11.0312c0.3432,0.2268,0.7275,0.3836,1.131,0.4614&#xA;&#x9;C4.0314,11.5382,4.0466,12.0111,3.6855,12c-0.3849-0.0193-2.2596-0.1934-2.5606-1.5995c-0.1556-0.8213,0.0204-1.5571,0.504-2.3556&#xA;&#x9;L2.3263,6.812L1.0196,6.0688L4.5,4v4L3.1941,7.3057L2.4556,8.6134z M6.7,2.034c1.155-0.628,1.823,0.43,2.191,1.007l0.8059,1.2631&#xA;&#x9;L8.431,5.112L12,6.986L11.803,2.96l-1.2639,0.8066L9.779,2.578C9.2572,1.8321,8.875,1.2812,7.944,1.033&#xA;&#x9;C6.307,0.7203,5.3007,2.6194,5.311,2.607c-0.1639,0.2871,0.2156,0.5399,0.451,0.21C6.0202,2.4969,6.339,2.2309,6.7,2.034z&#xA;&#x9; M13.294,8.221c-0.0877-0.1897-0.5487-0.1413-0.419,0.267c0.1312,0.3892,0.1845,0.8003,0.157,1.21C12.939,11.01,11.684,11,11,11H9.5&#xA;&#x9;V9.5l-3.5,2l3.488,2.025L9.4926,12H11c0.8906,0.0153,1.5999-0.1759,2.2-0.713C14.4,10.226,13.294,8.221,13.294,8.221z"/>\n</svg>'},"religious-buddhist":{label:"Religious buddhist",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15" id="religious-buddhist-15">\n  <path d="M13.4978,6.9989h-0.5329c-0.09997-1.10708-0.53528-2.15731-1.2478-3.0105l0.378-0.3784&#xA;&#x9;c0.19605-0.19447,0.19733-0.51105,0.00286-0.7071C11.90698,2.71037,11.59733,2.70518,11.4,2.8912l0,0l-0.0123,0.0123L11.01,3.2815&#xA;&#x9;c-0.85331-0.71298-1.90385-1.14864-3.0113-1.2488V1.5c0-0.27614-0.22386-0.5-0.5-0.5s-0.5,0.22386-0.5,0.5v0.5327&#xA;&#x9;C5.8916,2.13306,4.84144,2.56871,3.9884,3.2815L3.61,2.9C3.41007,2.70952,3.09358,2.71717,2.9031,2.9171&#xA;&#x9;c-0.184,0.19312-0.184,0.49668,0,0.6898l0.3784,0.3775C2.56787,4.83856,2.13216,5.89031,2.0327,6.9989H1.5&#xA;&#x9;c-0.27614,0-0.5,0.22386-0.5,0.5s0.22386,0.5,0.5,0.5h0.5327c0.09987,1.10695,0.535,2.15711,1.2473,3.0103l-0.3779,0.3779&#xA;&#x9;c-0.19538,0.19514-0.19557,0.51173-0.00043,0.70711c0.19053,0.19076,0.49798,0.19611,0.69503,0.01209L3.609,12.094l0.3779-0.3779&#xA;&#x9;c0.8533,0.71312,1.90395,1.1488,3.0115,1.2488v0.5329c0,0.27614,0.22386,0.5,0.5,0.5s0.5-0.22386,0.5-0.5v-0.5329&#xA;&#x9;c1.10719-0.10026,2.15744-0.53592,3.0105-1.2488l0.3779,0.3779c0.19514,0.19538,0.51173,0.19557,0.70711,0.00043&#xA;&#x9;c0.19076-0.19053,0.19611-0.49798,0.01209-0.69503l-0.0123-0.0123l0,0l-0.3779-0.3779c0.71283-0.8531,1.14848-1.90333,1.2488-3.0105&#xA;&#x9;h0.5329c0.27609-0.00544,0.49549-0.23366,0.49006-0.50975C13.98227,7.22064,13.76611,7.00435,13.4978,6.9989z M7.9987,3.0505&#xA;&#x9;c0.83871,0.09248,1.63383,0.42154,2.2926,0.9488l-2.15,2.15c-0.04663-0.0218-0.09436-0.04116-0.143-0.058V3.0505H7.9987z&#xA;&#x9; M6.9987,3.0505V6.091c-0.04864,0.01684-0.09637,0.0362-0.143,0.058l-2.15-2.15c0.65897-0.52726,1.45431-0.85622,2.2932-0.9485&#xA;&#x9;H6.9987z M3.9987,4.7062l2.15,2.15c-0.0218,0.04663-0.04116,0.09436-0.058,0.143H3.0505&#xA;&#x9;c0.09243-0.83886,0.42154-1.63413,0.9489-2.293L3.9987,4.7062z M3.0505,7.9987H6.091c0.01687,0.04863,0.03623,0.09636,0.058,0.143&#xA;&#x9;l-2.15,2.15C3.47173,9.63281,3.14276,8.83753,3.0505,7.9987z M6.9989,11.9471c-0.83871-0.09248-1.63383-0.42154-2.2926-0.9488&#xA;&#x9;l2.15-2.15c0.04663,0.0218,0.09436,0.04116,0.143,0.058v3.0405L6.9989,11.9471z M7.9989,11.9471V8.9066&#xA;&#x9;c0.04864-0.01683,0.09638-0.03619,0.143-0.058l2.15,2.15c-0.65895,0.5273-1.4543,0.85627-2.2932,0.9485H7.9989z M10.9989,10.2914&#xA;&#x9;l-2.15-2.15c0.02177-0.04664,0.04113-0.09437,0.058-0.143h3.0415c-0.09276,0.83901-0.42232,1.6343-0.9502,2.293H10.9989z&#xA;&#x9; M8.9066,6.9989c-0.01684-0.04864-0.0362-0.09637-0.058-0.143l2.15-2.15c0.52726,0.65877,0.85632,1.45389,0.9488,2.2926H8.9066&#xA;&#x9;V6.9989z"/>\n</svg>'},"religious-christian":{label:"Religious christian",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="religious-christian-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect3338" d="M6,0.9552V4H3v3h3v8h3V7h3V4H9V1&#xA;&#x9;c0-1-0.9776-1-0.9776-1H6.9887C6.9887,0,6,0,6,0.9552z"/>\n</svg>'},"religious-jewish":{label:"Religious jewish",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="religious-jewish-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M15,12H9.78L7.5,15l-2.26-3H0l2.7-4L0,4h5.3l2.2-4l2.34,4H15l-2.56,4L15,12z"/>\n</svg>'},"religious-muslim":{label:"Religious muslim",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="religious-muslim-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path7552-2-1" d="M6.7941,0C3,0,0,3,0,6.7941&#xA;&#x9;s3,6.7941,6.7941,6.7941c2.1176,0,4.4118-0.7059,5.6471-2.2941C11.6471,11.8235,10.1471,12.4412,9,12.4412&#xA;&#x9;c-2.9118,0-5.1176-2.9118-5.1176-5.8235S6.0882,1.1471,9,1.1471c1.0588,0,2.5588,0.6176,3.4412,1.1471&#xA;&#x9;C11.2059,0.7059,8.9118,0,6.7941,0z M11,3l-1,2.5H7L9.5,7l-1,3L11,8.5l2.5,1.5l-1-3L15,5.5h-3L11,3z"/>\n</svg>'},"residential-community":{label:"Residential community",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="residential-community-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11.8,13.5V11c0.7-0.1,1.2-0.7,1.2-1.5S12.3,8,11.5,8S10,8.7,10,9.5c0,0.7,0.5,1.4,1.2,1.5v2.5H7V2H2v11.5H1V14h13v-0.5&#xA;&#x9;H11.8z M6,11H3v-1h3V11z M6,9H3V8h3V9z M6,7H3V6h3V7z M6,5H3V4h3V5z"/>\n</svg>'},restaurant:{label:"Restaurant",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="restaurant-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path11774" d="M3.5,0l-1,5.5c-0.1464,0.805,1.7815,1.181,1.75,2L4,14c-0.0384,0.9993,1,1,1,1s1.0384-0.0007,1-1L5.75,7.5&#xA;&#x9;c-0.0314-0.8176,1.7334-1.1808,1.75-2L6.5,0H6l0.25,4L5.5,4.5L5.25,0h-0.5L4.5,4.5L3.75,4L4,0H3.5z M12,0&#xA;&#x9;c-0.7364,0-1.9642,0.6549-2.4551,1.6367C9.1358,2.3731,9,4.0182,9,5v2.5c0,0.8182,1.0909,1,1.5,1L10,14c-0.0905,0.9959,1,1,1,1&#xA;&#x9;s1,0,1-1V0z"/>\n</svg>'},"restaurant-noodle":{label:"Restaurant noodle",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="restaurant-noodle-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="restaurant-noodle-15">\n    <path d="M4.457,11.9892,1,8V7H14V8l-3.4961,3.9891ZM3.9882,2.5a.5.5,0,0,0-1,0v.5671l-1.7969.3675a.25.25,0,1,0,.094.4911l1.7029-.2776v.5662l-1.75.0357a.25.25,0,0,0,0,.5l1.75.0357V5.998h1Zm9.5,1.5-7.5.2625V2.9951l7.594-1.0737a.5.5,0,0,0-.1881-.9822L5.9792,2.4555a.4963.4963,0,0,0-.991.0445v.2276l-.493.1009V3.18l.493-.08V4.2974l-.493.01v.4608L13.4882,5a.5.5,0,0,0,0-1ZM10,13H5v.5757h5Z"/>\n  </g>\n</svg>'},"restaurant-pizza":{label:"Restaurant pizza",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="restaurant-pizza-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="restaurant-pizza-15">\n    <path d="M2.3926,8.9315,1.0245,8.3148A14.0478,14.0478,0,0,1,8.7637.9994l.027.07L9.3022,2.4l-.0037.0013a12.6131,12.6131,0,0,0-6.9057,6.53Zm10.9631,4.96L3.42,9.413a11.6038,11.6038,0,0,1,6.354-6.0088l.0033-.0013.8163,2.1222c-.0281-.0022-.0521-.0162-.0808-.0162a1.062,1.062,0,1,0,.7642,1.7932L13.69,13.575A.2487.2487,0,0,1,13.3557,13.891Zm-4.93-5.3727a.9245.9245,0,1,0-.9245.9244A.9245.9245,0,0,0,8.4255,8.5183Zm3.0169,2.03a.9252.9252,0,1,0-.9252.9252A.9252.9252,0,0,0,11.4424,10.5478Z"/>\n  </g>\n</svg>'},"restaurant-seafood":{label:"Restaurant seafood",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="restaurant-seafood-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="restaurant-seafood-15">\n    <path d="M11.433,10.0889h2.49v.75H11.8525A4.81,4.81,0,0,1,13.4751,13.14l-.71.2422a4.01,4.01,0,0,0-1.74-2.1971,1.7775,1.7775,0,0,1-1.0352.4538L8.4374,12.9852H6.5188L4.9839,11.623a2.0222,2.0222,0,0,1-1.0929-.44,4.0093,4.0093,0,0,0-1.7426,2.1988l-.71-.2422a4.8146,4.8146,0,0,1,1.622-2.3007H.99v-.75H3.4839l.8633-.6764L3.3329,7.7567a2.2738,2.2738,0,0,1-.269.0293,2.0192,2.0192,0,0,1-2.0532-2.08c0-2.08,1.979-4.16,1.979-4.16L2.2531,5.9931l1.7255-.0012L4.9913,2.9852l0,2.9956a2.0936,2.0936,0,0,1-.6993,1.4121l.8536,1.3936L5.23,8.7208a3.8669,3.8669,0,0,1,4.4784,0l.0605.0474.869-1.4152a2.1177,2.1177,0,0,1-.6433-1.3722l0-2.9956.9836,3.0067,1.7547.0012-.7367-4.4466s1.982,2.08,1.982,4.16a2.0211,2.0211,0,0,1-2.0562,2.08,2.3125,2.3125,0,0,1-.3441-.0376L10.5676,9.3945l.8407.6593C11.4212,10.0638,11.4218,10.0782,11.433,10.0889Z"/>\n  </g>\n</svg>'},roadblock:{label:"Roadblock",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="roadblock-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="roadblock-24" d="M7.5,0C3.3579,0,0,3.3579,0,7.5S3.3579,15,7.5,15S15,11.6421,15,7.5S11.6421,0,7.5,0z M3,6h9v3H3V6z"/>\n</svg>'},rocket:{label:"Rocket",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="rocket-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path7143" d="M12.5547,1c-2.1441,0-5.0211,1.471-6.9531,4H4&#xA;&#x9;C2.8427,5,2.1794,5.8638,1.7227,6.7773L1.1113,8h1.4434H4l1.5,1.5L7,11v1.4453v1.4434l1.2227-0.6113&#xA;&#x9;C9.1362,12.8206,10,12.1573,10,11V9.3984c2.529-1.932,4-4.809,4-6.9531V1H12.5547z M10,4c0.5523,0,1,0.4477,1,1l0,0&#xA;&#x9;c0,0.5523-0.4477,1-1,1l0,0C9.4477,6,9,5.5523,9,5v0C9,4.4477,9.4477,4,10,4L10,4z M3.5,10L3,10.5C2.2778,11.2222,2,13,2,13&#xA;&#x9;s1.698-0.198,2.5-1L5,11.5L3.5,10z"/>\n</svg>'},school:{label:"School",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="school-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,13v-1h2v-1H9.5v-1H13V9h-2V8h2V7h-2V6h2V5H9.5V4H13V3h-2V2h2V1H8v13h5v-1H11z M6,11H2V1h4V11z M6,12l-2,2l-2-2H6z"/>\n</svg>'},scooter:{label:"Scooter",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="scooter-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M4.908,12a1.5,1.5,0,1,1-2.816,0Zm8.65-6C13.539,6,13,6,13,6V3h.351a.282.282,0,0,0,.223-.148l.268-.536a.334.334,0,0,0,.009-.066A.25.25,0,0,0,13.6,2H13V1.7a.215.215,0,0,0-.2-.2H9.25a.25.25,0,0,0,0,.5H12V6.6L7.6,10H6V7.5A.5.5,0,0,0,5.5,7H5V5H6.75a.25.25,0,0,0,0-.5L2.266,4.034c-.006,0-.01-.007-.016-.007a.25.25,0,0,0-.25.25V4.75A.25.25,0,0,0,2.25,5H3V7H2.5A1.538,1.538,0,0,0,1,8.5v2a.472.472,0,0,0,.442.5C1.461,11,7.5,11,7.5,11L10,10h3.5a.472.472,0,0,0,.5-.442C14,9.539,14,6.5,14,6.5A.472.472,0,0,0,13.558,6ZM12.5,11A1.5,1.5,0,1,0,14,12.5,1.538,1.538,0,0,0,12.5,11Z"/>\n</svg>'},shelter:{label:"Shelter",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="shelter-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M4,7v5h9.5v2H2l0,0l0,0V7.78L1,8.16V6l13-5v2.14L4,7z"/>\n</svg>'},shoe:{label:"Shoe",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="shoe-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <g>\n    <path d="M9.5,7C9.086,6.7652,8.6109,6.4041,8.1848,6.0524l-2.1743-2.831C5.8204,2.9729,5.4644,2.927,5.2227,3.1172&#xA;&#x9;&#x9;C5.0977,3.214,5.0262,3.3536,5.0097,3.5H5V5H3.2087C3.0751,5,2.9469,4.9469,2.8524,4.8524C2.8524,4.8524,2.5,4,2,4&#xA;&#x9;&#x9;S1.4997,4,1.4997,4C1.2238,4,1,4.2237,1,4.4997V6.25v0.634V9h5.5c1.5,0,2,1,3.5,1s4,0,4,0V9.5C14,8,10.5469,7.5938,9.5,7z"/>\n    <path d="M9.5,11c-0.6318,0-1.0469-0.207-1.5264-0.4473C7.4556,10.2939,6.8682,10,6,10H1.5004H1v1.4996&#xA;&#x9;&#x9;C1,11.7759,1.224,12,1.5004,12h3.9993C5.776,12,6,11.7759,6,11.4996V11c0.6318,0,1.0464,0.207,1.5264,0.4473&#xA;&#x9;&#x9;C8.0449,11.7061,8.6318,12,9.5,12h4c0.2764,0,0.5-0.2236,0.5-0.5V11H9.5z"/>\n  </g>\n</svg>'},shop:{label:"Shop",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="shop-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.33,6H11.5l-0.39-2.33c-0.1601-0.7182-0.7017-1.2905-1.41-1.49C9.3507,2.0676,8.9869,2.007,8.62,2H6.38&#xA;&#x9;C6.0131,2.007,5.6493,2.0676,5.3,2.18C4.5917,2.3795,4.0501,2.9518,3.89,3.67L3.5,6H1.67C1.3939,5.9983,1.1687,6.2208,1.167,6.497&#xA;&#x9;C1.1667,6.5489,1.1744,6.6005,1.19,6.65l1.88,6.3l0,0C3.2664,13.5746,3.8453,13.9996,4.5,14h6c0.651-0.0047,1.2247-0.4289,1.42-1.05&#xA;&#x9;l0,0l1.88-6.3c0.0829-0.2634-0.0635-0.5441-0.3269-0.627C13.4268,6.0084,13.3786,6.0007,13.33,6z M4.52,6l0.36-2.17&#xA;&#x9;c0.0807-0.3625,0.3736-0.6395,0.74-0.7C5.8663,3.0524,6.1219,3.0087,6.38,3h2.24c0.2614,0.0078,0.5205,0.0515,0.77,0.13&#xA;&#x9;c0.3664,0.0605,0.6593,0.3375,0.74,0.7L10.48,6h-6H4.52z"/>\n</svg>'},skateboard:{label:"Skateboard",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="skateboard-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="icon_concepts:_sports_leisure" d="M11,8H4A2.0024,2.0024,0,0,1,2,6H3A1.001,1.001,0,0,0,4,7h7a1.001,1.001,0,0,0,1-1h1A2.0024,2.0024,0,0,1,11,8Zm0,1a1,1,0,1,0,1,1A1,1,0,0,0,11,9ZM4,9a1,1,0,1,0,1,1A1,1,0,0,0,4,9Z"/>\n</svg>'},skiing:{label:"Skiing",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="skiing-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M15,4.5C15,5.3284,14.3284,6,13.5,6S12,5.3284,12,4.5S12.6716,3,13.5,3S15,3.6716,15,4.5z M13.72,11.89&#xA;&#x9;c-0.0623-0.1197-0.2083-0.1684-0.33-0.11c-0.6846,0.4194-1.5208,0.5111-2.28,0.25L4.78,8.86L7.5,7.5v-3L9,5.25v3L10.5,9L12,8.25&#xA;&#x9;L10.5,7.5V3l-3-1.5L6,2.25v4.5L3.28,8.11L0.61,6.78C0.4857,6.7192,0.3358,6.7707,0.275,6.895C0.2142,7.0193,0.2657,7.1692,0.39,7.23&#xA;&#x9;l10.5,5.25c0.3156,0.135,0.6568,0.1998,1,0.19c0.5998-0.0103,1.1889-0.161,1.72-0.44c0.1236-0.0615,0.174-0.2116,0.1125-0.3352&#xA;&#x9;C13.7217,11.8932,13.7208,11.8916,13.72,11.89z"/>\n</svg>'},slaughterhouse:{label:"Slaughterhouse",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="slaughterhouse-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M15,8.1c0,1.376-1.363.694-1.363.694L12.5,9H11a5.309,5.309,0,0,1-1.5,2,3.272,3.272,0,0,1-.523,1.125c-.077.091-.061.2-.068.33L9,14.755a.264.264,0,0,1-.266.25A.242.242,0,0,1,8.5,14.8L8,11.5H4v3.253A.247.247,0,0,1,3.753,15h0a.25.25,0,0,1-.241-.2L3,12v-.5a8.2,8.2,0,0,1-1.426-.1A1.886,1.886,0,0,1,.9,12.826c-.128.083-.148.211-.133.386,0,0,.19,1.532.19,1.538a.25.25,0,0,1-.25.25.238.238,0,0,1-.23-.174l-.427-1.7a.35.35,0,0,1,.055-.3c.437-.68-.049-2.55-.049-2.55A1.354,1.354,0,0,1,0,9.922V7.5A2.027,2.027,0,0,1,2.736,5.586s.1.03.142.049a15.15,15.15,0,0,0,3.814.038l.179-.062a1.842,1.842,0,0,1,1.26,0,.972.972,0,0,1,.227.089,1.994,1.994,0,0,1,.287.171A1.8,1.8,0,0,0,9.5,6h1V5l.5.5c.5-1.5,2.5-1,2.5-1a1.687,1.687,0,0,0-1.5,1l2.5,2a.613.613,0,0,1,.186-.069A.318.318,0,0,1,15,7.752V8.1Z"/>\n</svg>'},slipway:{label:"Slipway",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="slipway-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <g id="slipway-final">\n    <path d="M1.0417,11l12,1.495V13h-12Zm12-4-1,1v.5833L4.2381,5.3318l.0624-.1248L5.652,3.8447h.8311a.35.35,0,0,0,0-.6992H5.5065a.3518.3518,0,0,0-.248.1025L3.7643,4.7529a.3714.3714,0,0,0-.0654.0909l-.109.218L1.0417,4c0,2-.0293,3.9578,2.8595,4.4994C5.321,8.7656,12.0417,10,12.0417,10l2-2Z"/>\n  </g>\n</svg>'},snowmobile:{label:"Snowmobile",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" id="snowmobile-15">\n  <path d="M15,11a1,1,0,0,1-1,1l0,0v0H9.4142a1,1,0,0,1-.7071-.2929L7.146,10.146A.4984.4984,0,0,0,6.7935,10H3.3343a1.0023,1.0023,0,0,1-.6015-.2006L1.3857,8.7888A1.0134,1.0134,0,0,1,1,8a.9953.9953,0,0,1,.4719-.8444L5,5,6.0385,3.3076h0A.5.5,0,0,1,7,3.5V7L8,8H9l5.4115-.9922a.5.5,0,0,1,.3555.915L13,9l1.6313,1.2243A.99.99,0,0,1,15,11ZM5.5,11H3.2247a3.0035,3.0035,0,0,1-1.44-.3679L.74,10.0612a.5.5,0,0,0-.48.8775l1.2687.6934A3.0032,3.0032,0,0,0,2.969,12H5.5a.5.5,0,0,0,0-1Z"/>\n</svg>'},soccer:{label:"Soccer",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="soccer-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,1.5C11,2.3284,10.3284,3,9.5,3S8,2.3284,8,1.5S8.6716,0,9.5,0S11,0.6716,11,1.5z M11,11c-0.5523,0-1,0.4477-1,1&#xA;&#x9;s0.4477,1,1,1s1-0.4477,1-1S11.5523,11,11,11z M12.84,6.09l-1.91-1.91l0,0C10.8399,4.0675,10.7041,4.0014,10.56,4H3.5&#xA;&#x9;C3.2239,4,3,4.2239,3,4.5S3.2239,5,3.5,5h2.7L3,11.3l0,0c-0.0138,0.066-0.0138,0.134,0,0.2c-0.058,0.2761,0.1189,0.547,0.395,0.605&#xA;&#x9;C3.6711,12.163,3.942,11.9861,4,11.71l0,0L5,10h2l-1.93,4.24l0,0C5.0228,14.3184,4.9986,14.4085,5,14.5&#xA;&#x9;c-0.0552,0.2761,0.1239,0.5448,0.4,0.6c0.2761,0.0552,0.5448-0.1239,0.6-0.4l0,0l4.7-9.38l1.44,1.48&#xA;&#x9;c0.211,0.1782,0.5264,0.1516,0.7046-0.0593C13.0037,6.5523,13.0018,6.2761,12.84,6.09z"/>\n</svg>'},square:{label:"Square",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="square-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13,14H2c-0.5523,0-1-0.4477-1-1V2c0-0.5523,0.4477-1,1-1h11c0.5523,0,1,0.4477,1,1v11C14,13.5523,13.5523,14,13,14z"/>\n</svg>'},"square-stroked":{label:"Square stroked",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="square-stroked-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12.7,2.3v10.4H2.3V2.3H12.7 M13,1H2C1.4477,1,1,1.4477,1,2v11c0,0.5523,0.4477,1,1,1h11c0.5523,0,1-0.4477,1-1V2&#xA;&#x9;C14,1.4477,13.5523,1,13,1L13,1z"/>\n</svg>'},stadium:{label:"Stadium",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="stadium-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4177" d="M7,1v2v1.5v0.5098C4.1695,5.1037,2.0021,5.9665,2,7v4.5c0,1.1046,2.4624,2,5.5,2s5.5-0.8954,5.5-2V7&#xA;&#x9;c-0.0021-1.0335-2.1695-1.8963-5-1.9902V4.0625L11,2.75L7,1z M3,8.1465c0.5148,0.2671,1.2014,0.4843,2,0.6328v2.9668&#xA;&#x9;C3.7948,11.477,3,11.0199,3,10.5V8.1465z M12,8.1484V10.5c0,0.5199-0.7948,0.977-2,1.2461V8.7812&#xA;&#x9;C10.7986,8.6328,11.4852,8.4155,12,8.1484z M6,8.9219C6.4877,8.973,6.9925,8.9992,7.5,9C8.0073,8.9999,8.5121,8.9743,9,8.9238&#xA;&#x9;v2.9844C8.5287,11.964,8.0288,12,7.5,12S6.4713,11.964,6,11.9082V8.9219z"/>\n</svg>'},star:{label:"Star",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="star-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4749-2-8-2" d="M7.5,0l-2,5h-5l4,3.5l-2,6l5-3.5&#xA;&#x9;l5,3.5l-2-6l4-3.5h-5L7.5,0z"/>\n</svg>'},"star-stroked":{label:"Star stroked",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="star-stroked-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4749-2-8-2" d="M7.5,3.19l1.07,2.68L8.82,6.5h3l-2,1.75l-0.5,0.44l0.23,0.63l1,3.13l-2.48-1.77&#xA;&#x9;l-0.57-0.4l-0.57,0.4l-2.52,1.77l1-3.13l0.21-0.63l-0.5-0.44l-2-1.75h3l0.25-0.63L7.5,3.19 M7.5,0.5l-2,5h-5l4,3.5l-2,6l5-3.5l5,3.5&#xA;&#x9;l-2-6l4-3.5h-5L7.5,0.5L7.5,0.5z"/>\n</svg>'},suitcase:{label:"Suitcase",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="suitcase-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path17" d="M11,4V2c0-1-1-1-1-1H5.0497&#xA;&#x9;c0,0-1.1039,0.0015-1.0497,1v2H2c0,0-1,0-1,1v7c0,1,1,1,1,1h11c0,0,1,0,1-1V5c0-1-1-1-1-1H11z M5.5,2.5h4V4h-4V2.5z"/>\n</svg>'},sushi:{label:"Sushi",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="sushi-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path4999" d="M5.5,3C5.2239,3,5,3.2239,5,3.5H2.75C1.2265,3.5,0,4.7265,0,6.25c0,0.8274,0.3687,1.5592,0.9434,2.0625&#xA;&#x9;C0.3803,8.6675,0,9.2893,0,10c0,1.0994,0.9006,2,2,2h3.5h2H10c1.0994,0,2-0.9006,2-2c0-0.4883-0.1863-0.9294-0.4805-1.2773&#xA;&#x9;l2.1777,0.9629c0.3716,0.1831,0.8213,0.0303,1.0044-0.3413c0.1831-0.3716,0.0303-0.8213-0.3413-1.0044&#xA;&#x9;c-0.0188-0.0093-0.038-0.0178-0.0576-0.0254l-1.8105-0.8027l1.6309-0.2715c0.4099-0.0599,0.6936-0.4408,0.6337-0.8507&#xA;&#x9;c-0.0544-0.3724-0.3765-0.6469-0.7528-0.6415c-0.0426,0.0003-0.085,0.0042-0.127,0.0117l-2.1309,0.3555&#xA;&#x9;C11.2595,4.9521,10.0387,3.7837,8,3.5488V3.5C8,3.2239,7.7761,3,7.5,3H5.5z M6,4h1v5v2H6V9V4z M9.5,8&#xA;&#x9;c0.259,0,0.4638,0.1974,0.4902,0.4492l0.0762-0.1328c0.1385-0.2399,0.4437-0.3201,0.6836-0.1816s0.3201,0.4418,0.1816,0.6816&#xA;&#x9;l-0.2578,0.4473C10.8727,9.445,11,9.7021,11,10c0,0.5626-0.4374,1-1,1H8V9h1V8.5C9,8.223,9.223,8,9.5,8z M2.4395,8.0703&#xA;&#x9;c0.1934-0.0242,0.3903,0.0662,0.4941,0.2461l0.2012,0.3477C3.226,8.5647,3.3538,8.5,3.5,8.5C3.777,8.5,4,8.723,4,9h1v2H2&#xA;&#x9;c-0.5626,0-1-0.4374-1-1s0.4374-1,1-1h0.1738L2.0684,8.8164C1.9299,8.5765,2.0101,8.2733,2.25,8.1348&#xA;&#x9;C2.31,8.1001,2.375,8.0784,2.4395,8.0703z"/>\n</svg>'},swimming:{label:"Swimming",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="swimming-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path16388" d="M10.1113,2C9.9989,2,9.6758,2.1465,9.6758,2.1465L6.3535,3.8262&#xA;&#x9;C5.9111,4.0024,5.7358,4.7081,6.002,5.0605l0.9707,1.4082L3.002,8.498L5,9.998l2.502-1.5l2.5,1.5l1.002-1.002l-3-4l2.5566-1.5293&#xA;&#x9;c0.5286-0.2662,0.4434-0.7045,0.4434-0.9707C10.9999,2.2861,10.6437,2,10.1113,2z M12.252,5C11.2847,5,10.5,5.7827,10.5,6.75&#xA;&#x9;s0.7847,1.752,1.752,1.752s1.75-0.7847,1.75-1.752S13.2192,5,12.252,5z M2.5,10L0,11.5V13l2.5-1.5L5,13l2.502-1.5l2.5,1.5L12,11.5&#xA;&#x9;l3,1.5v-1.5L12,10l-1.998,1.5l-2.5-1.5L5,11.5L2.5,10z"/>\n</svg>'},"table-tennis":{label:"Table tennis",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="table-tennis-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="icon_concepts:_sports_leisure" d="M11.9676,10.2275a3.8116,3.8116,0,0,1-1.9122.9831L3.7678,4.9338A4.0283,4.0283,0,0,1,4.7725,3.0324C7.03.7745,9.98.2235,12.3781,2.6219S14.2255,7.97,11.9676,10.2275Zm-6.987,1.6093A3.8422,3.8422,0,0,1,6.149,11.278,4.5328,4.5328,0,0,1,8,11.4452L3.5456,7a4.4126,4.4126,0,0,1,.1572,1.9223,3.6639,3.6639,0,0,1-.5208,1.1159c-1.072,1.263-2.132,1.727-2.132,2.1879A1.8378,1.8378,0,0,0,2.7739,13.95C3.2348,13.95,3.6917,12.9368,4.9806,11.8368Z"/>\n</svg>'},teahouse:{label:"Teahouse",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="teahouse-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M11,7c-0.2,1.4-0.5,2.7-1,4c-0.3,0.4-0.6,0.7-1,1v2H6v-2c-0.4-0.3-0.7-0.6-1-1C4.5,9.7,4.2,8.4,4,7H11z M8.1,5.7&#xA;&#x9;c1.2-0.3,1.7-0.3,1.8-1.5c0-0.6-0.4-0.8-1.5-1.4C7.5,2.4,7.1,1.8,7.2,1C6.8,1.9,7,3,8,3.5C10,4.5,8.1,5.7,8.1,5.7z M5.8,6&#xA;&#x9;c0.7-0.2,1.1-0.2,1.1-0.9c0-0.4-0.3-0.5-0.9-0.9C5.4,4,5.1,3.5,5.2,3C4.9,3.6,5.1,4.3,5.7,4.6C6.9,5.2,5.8,6,5.8,6z"/>\n</svg>'},telephone:{label:"Telephone",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" id="telephone-15">\n  <path d="M4.51,8.88a0.51,0.51,0,0,0,0,.72l0.72,0.72L3.07,12.5,2.7,12.13A2.24,2.24,0,0,1,2,10.69V9.24a2.24,2.24,0,0,1,.7-1.45L7.77,2.72A2.24,2.24,0,0,1,9.22,2h1.45a2.24,2.24,0,0,1,1.45.72l0.36,0.36L10.31,5.26,9.58,4.53a0.51,0.51,0,0,0-.72,0ZM4.13,13.6a1,1,0,0,0,1.4137.0363Q5.5623,13.6186,5.58,13.6l0.72-.72a1,1,0,0,0,.0363-1.4137Q6.3186,11.4477,6.3,11.43Zm7.25-7.28a1,1,0,0,0,1.4137.0363C12.8061,6.3445,13.55,5.6,13.55,5.6a1,1,0,0,0,.0363-1.4137Q13.5686,4.1677,13.55,4.15Z"/>\n</svg>'},tennis:{label:"Tennis",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="tennis-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.1284,1.87c-1.5418-1.5406-4.5535-.7759-6.28,1.05a6.8282,6.8282,0,0,0-1.88,4.4,5.7275,5.7275,0,0,1-.57,2.72.6814.6814,0,0,0-.67.17l-2.49,2.5a.6941.6941,0,0,0,0,.98l.07.07a.7051.7051,0,0,0,.98,0l2.5-2.49a.683.683,0,0,0,.18-.66,8.5694,8.5694,0,0,1,3.12-.58,6.5487,6.5487,0,0,0,3.99-1.87C14.1084,6.13,14.579,3.3194,13.1284,1.87Zm-2.2-.04a2.3071,2.3071,0,0,1,1.64.61,2.548,2.548,0,0,1,.5,2.44l-2.95-2.96A3.8648,3.8648,0,0,1,10.9284,1.83Zm-4.57,6.81a2.6485,2.6485,0,0,1-.48-2.55l3.04,3.04A2.8522,2.8522,0,0,1,6.3584,8.64Zm2.88.39-3.26-3.27a5.1623,5.1623,0,0,1,.49-1.08l3.85,3.85A5.5093,5.5093,0,0,1,9.2384,9.03Zm1.34-.66-3.94-3.95a5.2032,5.2032,0,0,1,.74-.9l4.1,4.1A5.6869,5.6869,0,0,1,10.5784,8.37Zm1.11-.96-4.1-4.1a5.5714,5.5714,0,0,1,.84-.65l3.92,3.92A5.7187,5.7187,0,0,1,11.6884,7.41Zm.82-1.09L8.6984,2.5a4.1707,4.1707,0,0,1,1.09-.48l3.2,3.2A5.5656,5.5656,0,0,1,12.5084,6.32Z"/>\n</svg>'},theatre:{label:"Theatre",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="theatre-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path6342-3" d="M2,1c0,0-1,0-1,1v5.1582C1,8.8885,1.354,11,4.5,11H5V8L2.5,9c0,0,0-2.5,2.5-2.5V5&#xA;&#x9;c0-0.7078,0.0868-1.3209,0.5-1.7754C5.8815,2.805,6.5046,1.9674,8.1562,2.7539L9,3.3027V2c0,0,0-1-1-1C7.2922,1,6.0224,2,5,2&#xA;&#x9;S2.7865,1,2,1z M3,3c0.5523,0,1,0.4477,1,1S3.5523,5,3,5S2,4.5523,2,4S2.4477,3,3,3z M7,4c0,0-1,0-1,1v5c0,2,1,4,4,4s4-2,4-4V5&#xA;&#x9;c0-1-1-1-1-1c-0.7078,0-1.9776,1-3,1S7.7865,4,7,4z M8,6c0.5523,0,1,0.4477,1,1S8.5523,8,8,8S7,7.5523,7,7S7.4477,6,8,6z M12,6&#xA;&#x9;c0.5523,0,1,0.4477,1,1s-0.4477,1-1,1s-1-0.4477-1-1S11.4477,6,12,6z M7.5,10H10h2.5c0,0,0,2.5-2.5,2.5S7.5,10,7.5,10z"/>\n</svg>'},toilet:{label:"Toilet",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="toilet-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M4.5,3C3.6716,3,3,2.3284,3,1.5S3.6716,0,4.5,0S6,0.6716,6,1.5S5.3284,3,4.5,3z M14,1.5C14,0.6716,13.3284,0,12.5,0&#xA;&#x9;S11,0.6716,11,1.5S11.6716,3,12.5,3S14,2.3284,14,1.5z M8.86,6.64L8.86,6.64L6.38,4.15l0,0C6.2798,4.0492,6.142,3.9949,6,4H3&#xA;&#x9;C2.8697,4.0003,2.7445,4.0503,2.65,4.14l0,0L0.14,6.63c-0.2261,0.177-0.2659,0.5039-0.0889,0.73s0.5039,0.2659,0.73,0.0889&#xA;&#x9;C0.8142,7.423,0.8441,7.3931,0.87,7.36L3,5.2L1,11h2v3.33c-0.0075,0.0497-0.0075,0.1003,0,0.15&#xA;&#x9;c0.0555,0.2761,0.3244,0.455,0.6005,0.3995C3.802,14.839,3.9595,14.6815,4,14.48l0,0V11h1v3.5l0,0&#xA;&#x9;c0.0555,0.2761,0.3244,0.455,0.6005,0.3995C5.802,14.859,5.9595,14.7015,6,14.5c0.0075-0.0497,0.0075-0.1003,0-0.15V11h2L6,5.2&#xA;&#x9;l2.14,2.16l0,0c0.0967,0.1081,0.2349,0.17,0.38,0.17C8.7954,7.5088,9.0061,7.2761,9,7C9.0023,6.8663,8.9521,6.737,8.86,6.64z&#xA;&#x9; M14.5,4h-4C10.2239,4,10,4.2239,10,4.5v5c0,0.2761,0.2239,0.5,0.5,0.5S11,9.7761,11,9.5v5c0,0.2761,0.2239,0.5,0.5,0.5&#xA;&#x9;s0.5-0.2239,0.5-0.5v-5h1v5c0,0.2761,0.2239,0.5,0.5,0.5s0.5-0.2239,0.5-0.5v-5c0,0.2761,0.2239,0.5,0.5,0.5S15,9.7761,15,9.5v-5&#xA;&#x9;C15,4.2239,14.7761,4,14.5,4z"/>\n</svg>'},town:{label:"Town",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="town-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M10.651,7.121a.251.251,0,0,0-.314,0L8.092,8.929A.247.247,0,0,0,8,9.122v4.625A.253.253,0,0,0,8.253,14H9.747A.253.253,0,0,0,10,13.747h0V12h1v1.747a.253.253,0,0,0,.253.253h1.494A.253.253,0,0,0,13,13.747h0V9.12a.25.25,0,0,0-.094-.2ZM10,11H9V10h1Zm2,0H11V10h1ZM5.71,1.815a.252.252,0,0,0-.42,0L2.042,5.936A.252.252,0,0,0,2,6.076v7.671A.252.252,0,0,0,2.251,14h2.5A.252.252,0,0,0,5,13.748V12H6v1.748A.252.252,0,0,0,6.252,14H7V8a.5.5,0,0,1,.188-.391L9,6C9,5.95,5.71,1.815,5.71,1.815ZM4,10H3V9H4ZM4,7H3V6H4Zm2,3H5V9H6ZM6,7H5V6H6Z"/>\n</svg>'},"town-hall":{label:"Town hall",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="town-hall-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path7509" d="M7.5,0L1,3.4453V4h13V3.4453L7.5,0z M2,5v5l-1,1.5547V13h13v-1.4453L13,10V5H2z M4,6h1v5.5H4V6z M7,6h1v5.5H7&#xA;&#x9;V6z M10,6h1v5.5h-1V6z"/>\n</svg>'},triangle:{label:"Triangle",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="triangle-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path21090-9" d="M7.5385,2&#xA;&#x9;C7.2437,2,7.0502,2.1772,6.9231,2.3846l-5.8462,9.5385C1,12,1,12.1538,1,12.3077C1,12.8462,1.3846,13,1.6923,13h11.6154&#xA;&#x9;C13.6923,13,14,12.8462,14,12.3077c0-0.1538,0-0.2308-0.0769-0.3846L8.1538,2.3846C8.028,2.1765,7.7882,2,7.5385,2z"/>\n</svg>'},"triangle-stroked":{label:"Triangle stroked",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="triangle-stroked-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="rect3338" d="M7.5243,1.5004&#xA;&#x9;C7.2429,1.4913,6.9787,1.6423,6.8336,1.8952l-5.5,9.8692C1.0218,12.3078,1.395,12.9999,2,13h11&#xA;&#x9;c0.605-0.0001,0.9782-0.6922,0.6664-1.2355l-5.5-9.8692C8.0302,1.6579,7.7884,1.5092,7.5243,1.5004z M7.5,3.8993l4.1267,7.4704&#xA;&#x9;H3.3733L7.5,3.8993z"/>\n</svg>'},veterinary:{label:"Veterinary",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="veterinary-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path3340" d="M7.5,6c-2.5,0-3,2.28-3,3.47l0,0c-0.6097,0.2059-1.1834,0.5062-1.7,0.89&#xA;&#x9;c-0.871,0.6614-1.0492,1.8998-0.4,2.78c0.6799,0.8542,1.9081,1.0297,2.8,0.4c0.6779-0.4601,1.4808-0.701,2.3-0.69&#xA;&#x9;c0.8192-0.011,1.6221,0.2299,2.3,0.69c0.8575,0.6854,2.1072,0.5515,2.8-0.3c0.6888-0.8134,0.5878-2.0313-0.2256-2.7201&#xA;&#x9;c-0.0243-0.0206-0.0491-0.0406-0.0744-0.0599l-0.1-0.1c-0.5333-0.3564-1.1032-0.6548-1.7-0.89l0,0C10.5,8.29,10,6,7.5,6z"/>\n  <path id="ellipse4153" d="M2.08,4.3c-0.7348,0.3676-1.0652,1.2371-0.76,2c0.064,0.8282,0.7809,1.4517,1.61,1.4&#xA;&#x9;c0.7348-0.3676,1.0652-1.2371,0.76-2C3.626,4.8718,2.9091,4.2483,2.08,4.3z"/>\n  <path id="ellipse4163" d="M12.93,4.3c0.7348,0.3676,1.0653,1.2371,0.76,2c-0.064,0.8282-0.7809,1.4517-1.61,1.4&#xA;&#x9;c-0.7348-0.3676-1.0653-1.2371-0.76-2C11.384,4.8718,12.1009,4.2483,12.93,4.3z"/>\n  <path id="ellipse4165" d="M5.08,1.3c-0.68,0.09-1,0.94-0.76,1.87C4.4301,3.9951,5.1003,4.6321,5.93,4.7c0.68-0.09,1-0.94,0.76-1.87&#xA;&#x9;C6.5799,2.0049,5.9097,1.3679,5.08,1.3z"/>\n  <path id="ellipse4167" d="M9.93,1.3c0.68,0.09,1,0.94,0.76,1.87C10.5791,3.9986,9.9036,4.6365,9.07,4.7c-0.68-0.08-1-0.94-0.76-1.87&#xA;&#x9;C8.4209,2.0014,9.0964,1.3634,9.93,1.3z"/>\n</svg>'},viewpoint:{label:"Viewpoint",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="viewpoint-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="cf3b542b-d2af-4732-9b92-9e3dc05e460f" d="M6.02,8.425a2.3859,2.3859,0,0,0-.46.44l-4.55-3.5a7.9976,7.9976,0,0,1,1.51-1.51Zm6.46-4.56-3.5,4.55a2.3971,2.3971,0,0,1,.45.45l4.56-3.5A7.945,7.945,0,0,0,12.48,3.865ZM7.3042,10.0129a1.5,1.5,0,1,0,1.6829,1.2914h0A1.5,1.5,0,0,0,7.3042,10.0129ZM6.43,2.235a7.9329,7.9329,0,0,0-2.06.55l2.2,5.32a2.0438,2.0438,0,0,1,.61-.17Zm2.14.01-.75,5.69a2.49,2.49,0,0,1,.61.16l2.2-5.3A7.2129,7.2129,0,0,0,8.57,2.245Z"/>\n</svg>'},village:{label:"Village",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="village-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M6.176,4.176a.249.249,0,0,0-.352,0l-4.4,4.4A.25.25,0,0,0,1.6,9H3v4.751A.249.249,0,0,0,3.249,14h3.5A.249.249,0,0,0,7,13.753H7V8.323a.249.249,0,0,1,.073-.176L8.5,6.5ZM6,12H5V11H6Zm0-2H5V9H6Zm6.75-4h-.5a.25.25,0,0,0-.25.25V8L10.676,6.176a.249.249,0,0,0-.352,0L8.056,8.932A.246.246,0,0,0,8,9.088v4.66A.249.249,0,0,0,8.246,14h1.5A.253.253,0,0,0,10,13.748h0V12h1v1.747a.253.253,0,0,0,.253.253h1.5A.25.25,0,0,0,13,13.751V6.25A.25.25,0,0,0,12.75,6ZM10,11H9V10h1Zm2,0H11V10h1Z"/>\n</svg>'},volcano:{label:"Volcano",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="volcano-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path6447" d="M8.4844,1.0002&#xA;&#x9;c-0.1464,0.005-0.2835,0.0731-0.375,0.1875L6.4492,3.2619L4.8438,1.7385C4.4079,1.3374,3.7599,1.893,4.0899,2.385l1.666,2.4004&#xA;&#x9;C5.9472,5.061,6.3503,5.0737,6.5586,4.8108C6.7249,4.6009,7,4.133,7.5,4.133s0.7929,0.4907,0.9414,0.6777&#xA;&#x9;c0.175,0.2204,0.4973,0.2531,0.7129,0.0723l1.668-1.4004c0.4408-0.3741,0.0006-1.0735-0.5273-0.8379L9,3.2268V1.5002&#xA;&#x9;C9.0002,1.2179,8.7666,0.9915,8.4844,1.0002L8.4844,1.0002z M5,6.0002L2.0762,11.924C1.9993,12.0009,2,12.155,2,12.3088&#xA;&#x9;c0,0.5385,0.3837,0.6914,0.6914,0.6914h9.6172c0.3846,0,0.6914-0.153,0.6914-0.6914c0-0.1538,0.0008-0.2309-0.0762-0.3848L10,6.0002&#xA;&#x9;c-0.5,0-1,0.5-1,1v0.5c0,0.277-0.223,0.5-0.5,0.5S8,7.7772,8,7.5002v-0.5c0-0.2761-0.2238-0.5-0.5-0.5S7,6.7241,7,7.0002v2&#xA;&#x9;c0,0.277-0.223,0.5-0.5,0.5S6,9.2772,6,9.0002v-2C6,6.5002,5.5,6.0002,5,6.0002z"/>\n</svg>'},volleyball:{label:"Volleyball",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="volleyball-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path id="e086ca83-8703-4df5-a97c-5939eb32113a" d="M13.91,7.94a5.9086,5.9086,0,0,1-.13.94,8.8218,8.8218,0,0,0-2.17-1.49,8.89,8.89,0,0,0-1.4-.56,8.6142,8.6142,0,0,0-1.82-.35.221.221,0,0,0-.08-.01A7.32,7.32,0,0,1,7.5,4.59c-.01-.01-.01-.01,0-.02a7.7573,7.7573,0,0,1,1.52.15,7.0987,7.0987,0,0,1,1.56.5,6.8585,6.8585,0,0,1,1.4.78A7.4165,7.4165,0,0,1,13.91,7.94Zm-1.87-5a6.2232,6.2232,0,0,0-1.85-1.27,4.2725,4.2725,0,0,0-.98-.36,5.6412,5.6412,0,0,0-1.55-.23,1.2882,1.2882,0,0,0-.32,0A7.4263,7.4263,0,0,0,7.21,2.5c0,.2.01.39.02.58a2.28,2.28,0,0,1,.26-.01,2.6438,2.6438,0,0,1,.28.01,8.2865,8.2865,0,0,1,1.49.16,8.9879,8.9879,0,0,1,1.35.37,8.7922,8.7922,0,0,1,1.53.7,10.18,10.18,0,0,1,1.39.97A6.4588,6.4588,0,0,0,12.04,2.94ZM4.01,8.76a9.4084,9.4084,0,0,1-.62-1.37,9.1038,9.1038,0,0,1-.37-1.41,9.1748,9.1748,0,0,1-.16-1.67V4.28a8.455,8.455,0,0,1,.1-1.34A6.28,6.28,0,0,0,1.47,5.3a6.2222,6.2222,0,0,0-.4,2.2c0,.15.01.3.02.44a5.9086,5.9086,0,0,0,.13.94,5.7343,5.7343,0,0,0,.41,1.23c.22-.05.44-.11.65-.17a8.0188,8.0188,0,0,0,1.9-.88C4.12,8.96,4.06,8.86,4.01,8.76Zm2.6-2.28a9,9,0,0,1-.63-1.76,9.135,9.135,0,0,1-.24-1.48c-.02-.25-.03-.49-.03-.74a9.3777,9.3777,0,0,1,.08-1.19,4.2725,4.2725,0,0,0-.98.36,7.7038,7.7038,0,0,0-.42,1.94c-.02.22-.03.44-.03.67a7.2659,7.2659,0,0,0,.06.93,7.4258,7.4258,0,0,0,.37,1.63,6.4705,6.4705,0,0,0,.59,1.28A8.0174,8.0174,0,0,0,6.65,6.55.2522.2522,0,0,1,6.61,6.48ZM12.7,9.93s0-.01-.01,0a7.0128,7.0128,0,0,0-1.7-1.16c-.06.1-.11.19-.17.29a8.783,8.783,0,0,1-.88,1.22,8.9125,8.9125,0,0,1-1.06,1.07,10.4181,10.4181,0,0,1-1.38.98,8.9933,8.9933,0,0,1-2.64,1.02,6.2985,6.2985,0,0,0,5.28,0,5.9674,5.9674,0,0,0,2.42-1.89,4.8258,4.8258,0,0,0,.65-1.03A6.0315,6.0315,0,0,0,12.7,9.93Zm-5.17-2c-.01.01-.02.03-.03.04a9.26,9.26,0,0,1-1.25,1.4,9.5925,9.5925,0,0,1-1.19.91,9.2683,9.2683,0,0,1-2.62,1.18,6.0989,6.0989,0,0,0,.53.61,7.7353,7.7353,0,0,0,3.15-.72,7.3839,7.3839,0,0,0,1.38-.82A7.6429,7.6429,0,0,0,8.75,9.37a7.7441,7.7441,0,0,0,.82-1.15A7.3414,7.3414,0,0,0,7.53,7.93Z"/>\n</svg>'},warehouse:{label:"Warehouse",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="warehouse-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M13.5,5c-0.0762,0.0003-0.1514-0.0168-0.22-0.05L7.5,2L1.72,4.93C1.4632,5.0515,1.1565,4.9418,1.035,4.685&#xA;&#x9;S1.0232,4.1215,1.28,4L7.5,0.92L13.72,4c0.2761,0.0608,0.4508,0.3339,0.39,0.61C14.0492,4.8861,13.7761,5.0608,13.5,5z M5,10H2v3h3&#xA;&#x9;V10z M9,10H6v3h3V10z M13,10h-3v3h3V10z M11,6H8v3h3V6z M7,6H4v3h3V6z"/>\n</svg>'},"waste-basket":{label:"Waste basket",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="waste-basket-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12.41,5.58l-1.34,8c-0.0433,0.2368-0.2493,0.4091-0.49,0.41H4.42c-0.2407-0.0009-0.4467-0.1732-0.49-0.41l-1.34-8&#xA;&#x9;C2.5458,5.3074,2.731,5.0506,3.0035,5.0064C3.0288,5.0023,3.0544,5.0002,3.08,5h8.83c0.2761-0.0036,0.5028,0.2174,0.5064,0.4935&#xA;&#x9;C12.4168,5.5225,12.4146,5.5514,12.41,5.58z M13,3.5C13,3.7761,12.7761,4,12.5,4h-10C2.2239,4,2,3.7761,2,3.5S2.2239,3,2.5,3H5V1.5&#xA;&#x9;C5,1.2239,5.2239,1,5.5,1h4C9.7761,1,10,1.2239,10,1.5V3h2.5C12.7761,3,13,3.2239,13,3.5z M9,3V2H6v1H9z"/>\n</svg>'},watch:{label:"Watch",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="watch-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12.5,7H12c-0.0175,0-0.0323,0.0082-0.0494,0.0099C11.8021,5.6575,11.0757,4.4804,10,3.7599V1.4977&#xA;&#x9;&#x9;C10,1.2228,9.7772,1,9.5023,1H5.4977C5.2228,1,5,1.2228,5,1.4977v2.2621C3.7946,4.5673,3,5.9402,3,7.5s0.7946,2.9327,2,3.7401&#xA;&#x9;&#x9;v2.2621C5,13.7771,5.2228,14,5.4977,14h4.0045C9.7772,14,10,13.7771,10,13.5022v-2.2621c1.0757-0.7205,1.8021-1.8976,1.9506-3.2501&#xA;&#x9;&#x9;C11.9677,7.9918,11.9825,8,12,8h0.5C12.7761,8,13,7.7761,13,7.5C13,7.2238,12.7761,7,12.5,7z M7.5,11C5.567,11,4,9.433,4,7.5&#xA;&#x9;&#x9;S5.567,4,7.5,4S11,5.567,11,7.5S9.433,11,7.5,11z"/>\n  <path d="M9,7H8V5.5C8,5.2238,7.7761,5,7.5,5S7,5.2238,7,5.5v2C7,7.7761,7.2239,8,7.5,8H9c0.2761,0,0.5-0.2239,0.5-0.5&#xA;&#x9;&#x9;C9.5,7.2238,9.2761,7,9,7z"/>\n</svg>'},water:{label:"Water",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="water-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M7.49,15C4.5288,14.827,2.1676,12.4615,2,9.5C2,6.6,6.25,1.66,7.49,0c1.24,1.66,5,6.59,5,9.49S10.17,15,7.49,15z"/>\n</svg>'},waterfall:{label:"Waterfall",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg id="waterfall-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15">\n  <path d="M12.9,3H15V1H5c0,0-4,0-4,4v5.5h0c-1.1,0.8-1.3,2.4-0.5,3.5s2.4,1.3,3.5,0.5c1,0.8,2.5,0.6,3.4-0.4C8,14.7,8.9,15,9.8,15&#xA;&#x9;c2.1,0,3.7-1.6,3.8-3.7c0-1.6-1-3-2.5-3.5V5C11,3.9,11.8,3,12.9,3z M10,8v0.5c1.5,0.1,2.6,1.5,2.5,3c-0.1,1.4-1.3,2.5-2.7,2.5&#xA;&#x9;c-1.1,0.1-1.8-0.6-2.1-1H6.9c-0.1,0.2-0.4,1-1.4,1s-1.3-0.6-1.4-1H3.9c-0.2,0.4-0.5,0.8-0.9,0.9c-0.9,0.3-1.7-0.2-1.9-1&#xA;&#x9;c-0.2-0.8,0.2-1.6,0.9-1.8V6c0-0.5,0.4-1,1-1c0,0,0,0,0,0h0c0.5,0,1,0.4,1,1c0,0,0,0,0,0c0,0,0,0,0,0v4.5C4,10.8,4.2,11,4.5,11&#xA;&#x9;S5,10.8,5,10.5V7c0-0.6,0.4-1,1-1s1,0.4,1,1v3.5C7,10.8,7.2,11,7.5,11S8,10.8,8,10.5V6c0-0.6,0.4-1,1-1s1,0.4,1,1V8z"/>\n</svg>'},watermill:{label:"Watermill",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="watermill-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M2,10.2L4,9l2.5,1.5l1.4659-0.8788C7.6592,9.4698,7.3716,9.285,7.1231,9.0536l1.4131-1.4131&#xA;&#x9;C8.7672,7.836,9.0557,7.9606,9.375,7.9874V9.224l0.25,0.1501V7.9874c0.3193-0.0268,0.6078-0.1514,0.8388-0.3469l1.4131,1.4131&#xA;&#x9;c-0.4059,0.3781-0.9044,0.6492-1.4528,0.8003L11.5,10.5l0.6984-0.4191C13.2863,9.2595,14,7.9682,14,6.5C14,4.0147,11.9853,2,9.5,2&#xA;&#x9;C8.1917,2,7.0241,2.5674,6.2018,3.4587L4.5,2L1,5h1V10.2z M12.0536,8.8769l-1.4131-1.4131c0.1954-0.231,0.3201-0.5196,0.3469-0.8388&#xA;&#x9;h1.9999C12.956,7.4946,12.6089,8.2806,12.0536,8.8769z M12.9874,6.375h-1.9999c-0.0268-0.3193-0.1514-0.6078-0.3469-0.8388&#xA;&#x9;l1.4131-1.4131C12.6089,4.7193,12.956,5.5054,12.9874,6.375z M9.625,3.0126c0.8696,0.0314,1.6557,0.3784,2.2519,0.9337&#xA;&#x9;l-1.4131,1.4131c-0.231-0.1954-0.5196-0.32-0.8388-0.3468C9.625,5.0126,9.625,3.0126,9.625,3.0126z M9.375,3.0126v1.9999&#xA;&#x9;C9.0558,5.0394,8.7672,5.164,8.5362,5.3594L7.1231,3.9463C7.7193,3.3911,8.5054,3.044,9.375,3.0126z M6.9464,4.1231l1.4131,1.4131&#xA;&#x9;C8.164,5.7672,8.0394,6.0557,8.0126,6.375h-2C6.044,5.5054,6.3911,4.7193,6.9464,4.1231z M8.0126,6.625&#xA;&#x9;c0.0268,0.3192,0.1515,0.6078,0.3469,0.8388L6.9464,8.8769C6.3911,8.2807,6.044,7.4946,6.0126,6.625H8.0126z M9.002,10L6.5,11.5&#xA;&#x9;L4,10l-2.5,1.5V13L4,11.5L6.5,13l2.502-1.5L11.5,13l2.5-1.5V10l-2.5,1.5L9.002,10z"/>\n</svg>'},wetland:{label:"Wetland",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="wetland-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M1.48,4.5C1.905,4.1467,2.4483,3.968,3,4c1.2273-0.0869,2.3154,0.7836,2.5,2l0.78,4.68c-0.6394-0.2893-1.3759-0.2709-2,0.05&#xA;&#x9;L3.48,6C3.1874,5.1347,2.3926,4.5387,1.48,4.5z M7.48,11.24c0.3816-0.3076,0.825-0.5293,1.3-0.65L10,3&#xA;&#x9;c0.2926-0.8653,1.0874-1.4613,2-1.5c-0.4198-0.3485-0.955-0.5269-1.5-0.5C9.2727,0.9131,8.1846,1.7836,8,3l-1.3,7.79&#xA;&#x9;C6.9786,10.9052,7.2408,11.0565,7.48,11.24z M11.8,10.74L11.8,10.74c0.1565-0.1277,0.3238-0.2414,0.5-0.34L13,6&#xA;&#x9;c0.2926-0.8653,1.0874-1.4613,2-1.5c-0.4198-0.3485-0.955-0.5269-1.5-0.5c-1.2273-0.0869-2.3154,0.7836-2.5,2l-0.67,4&#xA;&#x9;C10.8731,10.123,11.3778,10.377,11.8,10.74z M14,12L14,12c-0.4346-0.01-0.8579,0.1394-1.19,0.42l-0.47,0.41&#xA;&#x9;c-0.2847,0.2546-0.7153,0.2546-1,0c-0.15-0.12-0.29-0.26-0.44-0.39c-0.7076-0.5968-1.7424-0.5968-2.45,0&#xA;&#x9;c-0.16,0.13-0.31,0.28-0.47,0.41c-0.2847,0.2546-0.7153,0.2546-1,0c-0.16-0.13-0.31-0.28-0.47-0.41&#xA;&#x9;c-0.7059-0.5912-1.7341-0.5912-2.44,0c-0.15,0.13-0.29,0.27-0.44,0.39c-0.0892,0.0715-0.1909,0.1258-0.3,0.16&#xA;&#x9;c-0.2922,0.0652-0.5969-0.0301-0.8-0.25c-0.2475-0.214-0.5117-0.4079-0.79-0.58C1.5336,12.0421,1.2974,11.9865,1.06,12H1&#xA;&#x9;c-0.2761,0-0.5,0.2239-0.5,0.5S0.7239,13,1,13l0,0c0.246,0.0145,0.4762,0.126,0.64,0.31L2,13.57&#xA;&#x9;c0.6717,0.55,1.6308,0.5747,2.33,0.06c0.19-0.14,0.36-0.32,0.55-0.47c0.2847-0.2546,0.7153-0.2546,1,0l0.39,0.35&#xA;&#x9;c0.6937,0.6189,1.7322,0.6484,2.46,0.07c0.15-0.11,0.27-0.25,0.42-0.37c0.2976-0.3038,0.7851-0.3087,1.0889-0.0111&#xA;&#x9;c0.0037,0.0037,0.0074,0.0074,0.0111,0.0111l0.39,0.35c0.4866,0.4124,1.1485,0.5516,1.76,0.37c0.3825-0.1036,0.7286-0.3113,1-0.6&#xA;&#x9;c0.1549-0.1772,0.3674-0.294,0.6-0.33l0,0c0.2761,0,0.5-0.2239,0.5-0.5S14.2761,12,14,12z"/>\n</svg>'},wheelchair:{label:"Wheelchair",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="wheelchair-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M12,1.5C12,2.3284,11.3284,3,10.5,3S9,2.3284,9,1.5S9.6716,0,10.5,0S12,0.6716,12,1.5z M2.82,4.87l1.74-1.71l1.85,1.29&#xA;&#x9;L5.67,5.7c1.0747,0.3341,2.0207,0.9904,2.71,1.88l0.88-1.5c0.2295-0.4158,0.0785-0.939-0.3373-1.1685&#xA;&#x9;C8.9218,4.911,8.9209,4.9105,8.92,4.91L8.3,4.54L4.79,2.1C4.5927,1.9594,4.3231,1.9805,4.15,2.15l-2,2&#xA;&#x9;C1.9852,4.3716,2.0312,4.6848,2.2528,4.8496C2.4193,4.9735,2.645,4.9816,2.82,4.87z M8.13,10.94&#xA;&#x9;c-0.0143,1.2308-0.5794,2.3904-1.54,3.16c-0.7118,0.5804-1.6016,0.8982-2.52,0.9C1.8261,15,0.0055,13.1839,0,10.94&#xA;&#x9;c0.0023-0.9231,0.3238-1.8169,0.91-2.53c0.1868-0.232,0.398-0.4432,0.63-0.63c0.7131-0.5862,1.6069-0.9077,2.53-0.91&#xA;&#x9;C6.3139,6.8755,8.13,8.6961,8.13,10.94z M6,12.21C6.7679,11.2051,6.5758,9.7679,5.5709,9C4.7501,8.3727,3.6109,8.3727,2.79,9&#xA;&#x9;C2.5283,9.151,2.311,9.3683,2.16,9.63c-0.6923,1.0584-0.3956,2.4777,0.6628,3.17c0.7615,0.4981,1.7457,0.4981,2.5072,0&#xA;&#x9;C5.5805,12.6365,5.8061,12.4378,6,12.21z M14.2,13.21l-2.49-5C11.5906,7.9251,11.3088,7.7425,11,7.75H8.51&#xA;&#x9;c0.3293,0.4578,0.5856,0.9638,0.76,1.5h1.26l2.29,4.58c0.185,0.3728,0.6372,0.525,1.01,0.34c0.3728-0.185,0.525-0.6372,0.34-1.01&#xA;&#x9;L14.2,13.21z"/>\n</svg>'},windmill:{label:"Windmill",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="windmill-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path d="M6,5L3.5,7.5l1,1L7,6V5.5L7.5,5L8,5.5V6l2.5,2.5l1-1L9,5H8.5L8,4.5L8.5,4H9l2.5-2.5l-1-1L8,3v0.5L7.5,4L7,3.5V3L4.5,0.5&#xA;&#x9;l-1,1L6,4h0.5L7,4.5L6.5,5H6z M11.5,13h-1l-1-4l-2-2l-2,2l-1,4h-1C3.2239,13,3,13.2238,3,13.5C3,13.7761,3.2239,14,3.5,14h8&#xA;&#x9;c0.2761,0,0.5-0.2239,0.5-0.5C12,13.2238,11.7761,13,11.5,13z M8,13H7v-1.5024C7,11.2228,7.2228,11,7.4976,11&#xA;&#x9;C7.7751,11,8,11.2249,8,11.5024V13z"/>\n</svg>'},zoo:{label:"Zoo",svg:'<?xml version="1.0" encoding="UTF-8"?>\n<svg version="1.1" id="zoo-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">\n  <path id="path17499" d="&#xA;&#x9;M8.3879,3.8928C8.3879,3.8928,7.6818,5,7,5H4.5C3.8182,5,3.2016,5.4086,2.7273,5.8636L0.5,8C0.231,8.258,0.0072,8.7681,0,9&#xA;&#x9;c-0.0156,0.5,0,1,0,1s1,0,1-1V8.5l1-1h0.5l0.158,0.2892c0,0-0.9535,1.8244-0.9535,3.5289C1.7046,12,2.3864,12,2.3864,12h0.6818&#xA;&#x9;c0,0,0.3409,0,0-0.3409l-0.3409-0.3409C2.7273,10.6364,3.5002,9.6667,4,9c0,0,0.0168,1.1579,0,2c-0.008,0.4096,0.2721,1,0.6818,1&#xA;&#x9;h0.6818c0,0,0.3409,0,0-0.3409l-0.3409-0.3409C4.7105,10.7495,5.5,8.5,5.5,8.5C6.7716,8.5,7,9,8.5,9l0.3636,2.3182&#xA;&#x9;C8.975,12.0282,9.5,12,9.5,12H11c0.3409,0,0.9611-0.3115,0.3409-0.7736L11,11V9c1.2142-0.1722,2-1,2-2h1c0.3214,0,1,0,1-0.5v-1&#xA;&#x9;l-1.7045-1.6818C12.5444,3.0772,12,2.5,11,2.5C9.5469,2.5,8.8636,3.0688,8.3879,3.8928z"/>\n</svg>'}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var r=i(581),n=i.n(r),a=i(582),o=i.n(a),l=i(583),c=i.n(l);i(584);const u=n.a;u.workerUrl=c.a,u.setRTLTextPlugin(o.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(3);function n(t){const e=t%10;return 1===e&&11!==t?r.i18n.translate("xpack.maps.styles.firstOrdinalSuffix",{defaultMessage:"st"}):2===e&&12!==t?r.i18n.translate("xpack.maps.styles.secondOrdinalSuffix",{defaultMessage:"nd"}):3===e&&13!==t?r.i18n.translate("xpack.maps.styles.thirdOrdinalSuffix",{defaultMessage:"rd"}):r.i18n.translate("xpack.maps.styles.ordinalSuffix",{defaultMessage:"th"})}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"d",(function(){return l})),i.d(e,"e",(function(){return u})),i.d(e,"c",(function(){return h}));var r=i(0);const n=["!=",["get",r.U],!0];function a(t,e,i){const r=[...t];return e&&r.push(e),i&&(r.push(["has",i.timesliceMaskField]),r.push([">=",["get",i.timesliceMaskField],i.timeslice.from]),r.push(["<",["get",i.timesliceMaskField],i.timeslice.to])),["all",...r]}function o(t,e){return a([["any",["==",["geometry-type"],r.J.POLYGON],["==",["geometry-type"],r.J.MULTI_POLYGON]]],t,e)}function l(t,e){return a([["any",["==",["geometry-type"],r.J.POLYGON],["==",["geometry-type"],r.J.MULTI_POLYGON],["==",["geometry-type"],r.J.LINE_STRING],["==",["geometry-type"],r.J.MULTI_LINE_STRING]]],t,e)}const c=["any",["==",["geometry-type"],r.J.POINT],["==",["geometry-type"],r.J.MULTI_POINT]];function u(t,e,i,r){const o=[];return t?o.push(n):e&&o.push(["!=",["get","_mvt_label_position"],!0]),o.push(c),a(o,i,r)}function h(t,e,i,r){const n=[];return t?n.push(c):e&&n.push(["==",["get","_mvt_label_position"],!0]),a(n,i,r)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return ESTooltipProperty}));var r=i(6),n=i.n(r),a=(i(2),i(53)),o=i.n(a),l=i(58),c=i(4);class ESTooltipProperty{constructor(t,e,i,r){n()(this,"_tooltipProperty",void 0),n()(this,"_indexPattern",void 0),n()(this,"_field",void 0),n()(this,"_applyGlobalQuery",void 0),this._tooltipProperty=t,this._indexPattern=e,this._field=i,this._applyGlobalQuery=r}getPropertyKey(){return this._tooltipProperty.getPropertyKey()}getPropertyName(){return this._tooltipProperty.getPropertyName()}getRawValue(){return this._tooltipProperty.getRawValue()}_getIndexPatternField(){return this._indexPattern.fields.getByName(this._field.getRootName())}getHtmlDisplayValue(){if(void 0===this.getRawValue())return"-";const t=this._getIndexPatternField();if(!t||!this._field.canValueBeFormatted()){const t=this.getRawValue();return Array.isArray(t)?o.a.escape(t.join()):o.a.escape(t)}const e=this._indexPattern.getFormatterForField(t),i=e.getConverterFor("html");return i?Object(c.jsx)("span",{dangerouslySetInnerHTML:{__html:i(this.getRawValue())}}):e.convert(this.getRawValue())}isFilterable(){if(!this._applyGlobalQuery)return!1;const t=this._getIndexPatternField();return!!t&&("string"===t.type||"date"===t.type||"ip"===t.type||"number"===t.type)}async getESFilters(){if(!this._applyGlobalQuery)return[];const t=this._getIndexPatternField();if(!t)return[];const e=this.getRawValue();if(null==e){const e=Object(l.buildExistsFilter)(t,this._indexPattern);return e.meta.negate=!0,[e]}return(Array.isArray(e)?e:[e]).map((e=>Object(l.buildPhraseFilter)(t,e,this._indexPattern)))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(166),n=i.n(r),a=i(0);function o(t,e){if(!t)return null;const i=e?t.features.filter((t=>t.properties&&t.properties[a.C])):t.features;if(0===i.length)return null;const r=n()({type:"FeatureCollection",features:i});return{minLon:r[0],minLat:r[1],maxLon:r[2],maxLat:r[3]}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return ValidatedNumberInput}));var r=i(6),n=i.n(r),a=i(2),o=i(14),l=i(3),c=i(53),u=i.n(c),h=i(4);function p(t,e){return l.i18n.translate("xpack.maps.validatedNumberInput.invalidClampErrorMessage",{defaultMessage:"Must be between {min} and {max}",values:{min:t,max:e}})}function d(t,e,i){const r=parseFloat(t.toString());if(isNaN(r))return{isValid:!1,errorMessage:p(e,i)};const n=r>=e&&r<=i;return{parsedValue:r,isValid:n,errorMessage:n?"":p(e,i)}}class ValidatedNumberInput extends a.Component{constructor(t){super(t),n()(this,"_submit",u.a.debounce((t=>{this.props.onChange(t)}),250)),n()(this,"_onChange",(t=>{const e=t.target.value,{isValid:i,errorMessage:r,parsedValue:n}=d(e,this.props.min,this.props.max);this.setState({value:e,errorMessage:r,isValid:i}),i&&this._submit(n)}));const{isValid:e,errorMessage:i}=d(t.initialValue,this.props.min,this.props.max);this.state={value:t.initialValue,errorMessage:i,isValid:e}}render(){return Object(h.jsx)(o.EuiFormRow,{label:this.props.label,isInvalid:!this.state.isValid,error:this.state.errorMessage?[this.state.errorMessage]:[],display:this.props.display,helpText:this.props.helpText},Object(h.jsx)(o.EuiFieldNumber,{isInvalid:!this.state.isValid,min:this.props.min,max:this.props.max,value:this.state.value,onChange:this._onChange,"aria-label":`${this.props.label} number input`}))}}},,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(64),n=i.n(r);function a(t){const e=new URLSearchParams;return Object.keys(t).forEach((i=>{const r=t[i];null!=r&&("object"!=typeof r?("number"!=typeof r&&"boolean"!=typeof r||e.set(i,r.toString()),e.set(i,r)):e.set(i,n.a.encode(r)))})),e.toString()}},function(t,e,i){"use strict";i.d(e,"a",(function(){return custom_icon_modal_CustomIconModal}));var r=i(6),n=i.n(r),a=i(2),o=i.n(a),l=i(14),c=i(19),u=i(3),h=i(321),p=i(115),d=i(4);class icon_preview_IconPreview extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",!1),n()(this,"_containerRef",null),n()(this,"state",{map:null,iconColor:"#E7664C"}),n()(this,"_setIconColor",(t=>{this.setState({iconColor:t},(()=>{this._syncPaintPropertiesToMap()}))})),n()(this,"_setContainerRef",(t=>{this._containerRef=t}))}componentDidMount(){this._isMounted=!0,this._initializeMap()}componentDidUpdate(t){this.props.svg===t.svg&&this.props.cutoff===t.cutoff&&this.props.radius===t.radius||this._syncImageToMap()}componentWillUnmount(){this._isMounted=!1,this.state.map&&(this.state.map.remove(),this.state.map=null)}async _syncImageToMap(){if(this._isMounted&&this.state.map){const t=this.state.map,{svg:e,cutoff:i,radius:r,isSvgInvalid:n}=this.props;if(!e||n)return void t.setLayoutProperty("icon-layer","visibility","none");const a=await Object(p.e)({svg:e,cutoff:i,radius:r});a&&(t.hasImage(icon_preview_IconPreview.iconId)?t.updateImage(icon_preview_IconPreview.iconId,a):t.addImage(icon_preview_IconPreview.iconId,a,{sdf:!0,pixelRatio:p.a})),t.setLayoutProperty("icon-layer","icon-image",icon_preview_IconPreview.iconId),t.setLayoutProperty("icon-layer","icon-size",6),t.setLayoutProperty("icon-layer","visibility","visible"),this._syncPaintPropertiesToMap()}}_syncPaintPropertiesToMap(){const{map:t,iconColor:e}=this.state;t&&(t.setPaintProperty("icon-layer","icon-halo-color","#000000"),t.setPaintProperty("icon-layer","icon-halo-width",1),t.setPaintProperty("icon-layer","icon-color",e),t.setLayoutProperty("icon-layer","icon-size",12))}_createMapInstance(){const t=new h.a.Map({container:this._containerRef,interactive:!1,center:[0,0],zoom:2,style:{version:8,name:"Empty",sources:{},layers:[{id:"background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}});return t.on("load",(()=>{t.addLayer({id:"icon-layer",type:"symbol",source:{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{}}}}),this._syncImageToMap()})),t}_initializeMap(){const t=this._createMapInstance();this.setState({map:t})}render(){const t=this.state.iconColor;return Object(d.jsx)("div",null,Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,grow:!0},Object(d.jsx)(l.EuiTitle,{size:"xxxs"},Object(d.jsx)("h4",null,Object(d.jsx)(l.EuiToolTip,{content:u.i18n.translate("xpack.maps.customIconModal.elementPreviewTooltip",{defaultMessage:"Dynamic styling requires rendering SVG icons using a signed distance function. As a result, sharp corners and intricate details may not render correctly. You may be able to tweak the Alpha threshold and Radius for better results."})},Object(d.jsx)(o.a.Fragment,null,u.i18n.translate("xpack.maps.customIconModal.elementPreviewTitle",{defaultMessage:"Render preview"})," ",Object(d.jsx)(l.EuiIcon,{color:"subdued",type:"questionInCircle"}))))),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiPanel,{hasBorder:!0,hasShadow:!1},Object(d.jsx)("div",{id:"mapsCustomIconPreview__mapContainer",ref:this._setContainerRef,"data-test-subj":"mapsCustomIconPreview",className:"mapsCustomIconPreview__mapContainer"})),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiFormRow,{label:"Preview color"},Object(d.jsx)(l.EuiColorPicker,{onChange:this._setIconColor,color:t})))))}}n()(icon_preview_IconPreview,"iconId","iconPreview");var f=i(149),m=i(47),g=i(5);class custom_icon_modal_CustomIconModal extends a.Component{constructor(...t){super(...t),n()(this,"_isMounted",!1),n()(this,"state",{label:this.props.label||"",svg:this.props.svg||"",cutoff:this.props.cutoff,radius:this.props.radius,isFileInvalid:!this.props.svg}),n()(this,"_handleLabelChange",(t=>{this.setState({label:t})})),n()(this,"_handleCutoffChange",(t=>{this.setState({cutoff:t})})),n()(this,"_handleRadiusChange",(t=>{this.setState({radius:t})})),n()(this,"_resetAdvancedOptions",(()=>{this.setState({radius:this.props.radius,cutoff:this.props.cutoff})})),n()(this,"_onFileSelect",(async t=>{if(this.setState({label:"",svg:"",isFileInvalid:!1}),t&&t.length){const i=t[0],{type:r}=i;if("image/svg+xml"===r){var e;const t=null!==(e=this.props.label)&&void 0!==e?e:function(t){const e=t.split(".");return e.length>1&&e.pop(),e.join(".")}(i.name);try{const e=await i.text();if(!this._isMounted)return;this.setState({isFileInvalid:!1,label:t,svg:e})}catch(t){if(!this._isMounted)return;this.setState({isFileInvalid:!0})}}else this.setState({isFileInvalid:!0})}}))}componentWillUnmount(){this._isMounted=!1}componentDidMount(){this._isMounted=!0}_renderAdvancedOptions(){const{cutoff:t,radius:e}=this.state;return Object(d.jsx)(l.EuiAccordion,{id:"advancedOptionsAccordion",buttonContent:u.i18n.translate("xpack.maps.customIconModal.advancedOptionsLabel",{defaultMessage:"Advanced options"}),paddingSize:"xs"},Object(d.jsx)(l.EuiPanel,{color:"subdued",paddingSize:"s"},Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"xs"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{size:"xs",onClick:this._resetAdvancedOptions},u.i18n.translate("xpack.maps.customIconModal.resetButtonLabel",{defaultMessage:"Reset"})))),Object(d.jsx)(l.EuiFormRow,{className:"mapsCustomIconForm__cutoff",label:Object(d.jsx)(l.EuiToolTip,{content:u.i18n.translate("xpack.maps.customIconModal.cutoffRangeTooltip",{defaultMessage:"Adjusts the balance of the signed distance function between the inside (approaching 1) and outside (approaching 0) of the icon."})},Object(d.jsx)(o.a.Fragment,null,u.i18n.translate("xpack.maps.customIconModal.cutoffRangeLabel",{defaultMessage:"Alpha threshold"})," ",Object(d.jsx)(l.EuiIcon,{color:"subdued",type:"questionInCircle"}))),display:"rowCompressed"},Object(d.jsx)(f.a,{min:0,max:1,value:t,step:.01,showInput:!0,showLabels:!0,compressed:!0,className:"mapsCutoffRange",onChange:this._handleCutoffChange})),Object(d.jsx)(l.EuiFormRow,{className:"mapsCustomIconForm__radius",label:Object(d.jsx)(l.EuiToolTip,{content:u.i18n.translate("xpack.maps.customIconModal.raduisRangeTooltip",{defaultMessage:"Adjusts the size of the signed distance function around the Alpha threshold as a percent of icon size."})},Object(d.jsx)(o.a.Fragment,null,u.i18n.translate("xpack.maps.customIconModal.radiusRangeLabel",{defaultMessage:"Radius"})," ",Object(d.jsx)(l.EuiIcon,{color:"subdued",type:"questionInCircle"}))),display:"rowCompressed"},Object(d.jsx)(f.a,{min:0,max:1,value:e,step:.01,showInput:!0,showLabels:!0,compressed:!0,className:"mapsRadiusRange",onChange:this._handleRadiusChange}))))}_renderIconForm(){const{label:t,svg:e}=this.state;return""!==e?Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(l.EuiFormRow,{label:u.i18n.translate("xpack.maps.customIconModal.nameInputLabel",{defaultMessage:"Name"}),display:"rowCompressed"},Object(d.jsx)(l.EuiFieldText,{value:t,className:"mapsCustomIconForm__label",onChange:t=>this._handleLabelChange(t.target.value),required:!0,"data-test-subj":"mapsCustomIconForm-label"})),Object(d.jsx)(l.EuiSpacer,null),this._renderAdvancedOptions()):null}_renderIconPreview(){const{svg:t,isFileInvalid:e,cutoff:i,radius:r}=this.state;return""!==t?Object(d.jsx)(l.EuiFlexItem,{className:"mapsIconPreview__wrapper mapsCustomIconForm__preview",grow:!1},Object(d.jsx)(icon_preview_IconPreview,{svg:t,isSvgInvalid:e,cutoff:i,radius:r})):null}render(){const t=Object(g.U)(),{symbolId:e,onSave:i,onCancel:r,onDelete:n,title:a}=this.props,{label:o,svg:h,cutoff:f,radius:y,isFileInvalid:_}=this.state,v=0!==o.length&&0!==h.length&&!_,x=h&&_?u.i18n.translate("xpack.maps.customIconModal.invalidFileError",{defaultMessage:"Icon must be in SVG format. Other image types are not supported."}):"";return Object(d.jsx)(l.EuiModal,{className:"mapsCustomIconModal",maxWidth:700,onClose:r,initialFocus:".mapsCustomIconForm__image"},Object(d.jsx)(l.EuiModalHeader,null,Object(d.jsx)(l.EuiModalHeaderTitle,{component:"h3"},a)),Object(d.jsx)(l.EuiModalBody,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"flexStart",gutterSize:"m"},Object(d.jsx)(l.EuiFlexItem,{className:"mapsCustomIconForm",grow:2},Object(d.jsx)(l.EuiFormRow,{className:"mapsCustomIconForm__image",display:"rowCompressed",isInvalid:!!x,error:x,helpText:u.i18n.translate("xpack.maps.customIconModal.imageInputDescription",{defaultMessage:"SVGs without sharp corners and intricate details work best. Modifying the settings under Advanced options may improve rendering."})},Object(d.jsx)(l.EuiFilePicker,{initialPromptText:u.i18n.translate("xpack.maps.customIconModal.imageFilePickerPlaceholder",{defaultMessage:"Select or drag and drop an SVG icon"}),onChange:this._onFileSelect,className:"mapsImageUpload",accept:".svg",isInvalid:!!x,required:!0})),Object(d.jsx)(l.EuiSpacer,null),this._renderIconForm()),this._renderIconPreview())),Object(d.jsx)(l.EuiModalFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:r},u.i18n.translate("xpack.maps.customIconModal.cancelButtonLabel",{defaultMessage:"Cancel"}))),n&&e?Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{color:"danger",onClick:()=>{null==t||t.reportUiCounter(m.APP_ID,c.METRIC_TYPE.CLICK,"settings_custom_icons_delete"),n(e)},"data-test-subj":"mapsCustomIconForm-submit"},u.i18n.translate("xpack.maps.customIconModal.deleteButtonLabel",{defaultMessage:"Delete"}))):null,Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,onClick:()=>{n||null==t||t.reportUiCounter(m.APP_ID,c.METRIC_TYPE.CLICK,"settings_custom_icons_add"),i({symbolId:null!=e?e:Object(p.f)(),label:o,svg:h,cutoff:f,radius:y})},"data-test-subj":"mapsCustomIconForm-submit",isDisabled:!v},u.i18n.translate("xpack.maps.customIconModal.saveButtonLabel",{defaultMessage:"Save"}))))))}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(124);function n(t,e,i){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],l=e[n][1],c=e[a][0],u=e[a][1];if(t[1]*(o-c)+l*(c-t[0])+u*(t[0]-o)==0&&(o-t[0])*(c-t[0])<=0&&(l-t[1])*(u-t[1])<=0)return!i;l>t[1]!=u>t[1]&&t[0]<(c-o)*(t[1]-l)/(u-l)+o&&(r=!r)}return r}e.default=function(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var a=r.getCoord(t),o=r.getGeom(e),l=o.type,c=e.bbox,u=o.coordinates;if(c&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(a,c))return!1;"Polygon"===l&&(u=[u]);for(var h=!1,p=0;p<u.length&&!h;p++)if(n(a,u[p][0],i.ignoreBoundary)){for(var d=!1,f=1;f<u[p].length&&!d;)n(a,u[p][f],!i.ignoreBoundary)&&(d=!0),f++;d||(h=!0)}return h}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(124);function n(t,e,i,r){var n=i[0],a=i[1],o=t[0],l=t[1],c=e[0],u=e[1],h=c-o,p=u-l;return 0==(i[0]-o)*p-(i[1]-l)*h&&(r?"start"===r?Math.abs(h)>=Math.abs(p)?h>0?o<n&&n<=c:c<=n&&n<o:p>0?l<a&&a<=u:u<=a&&a<l:"end"===r?Math.abs(h)>=Math.abs(p)?h>0?o<=n&&n<c:c<n&&n<=o:p>0?l<=a&&a<u:u<a&&a<=l:"both"===r&&(Math.abs(h)>=Math.abs(p)?h>0?o<n&&n<c:c<n&&n<o:p>0?l<a&&a<u:u<a&&a<l):Math.abs(h)>=Math.abs(p)?h>0?o<=n&&n<=c:c<=n&&n<=o:p>0?l<=a&&a<=u:u<=a&&a<=l)}e.default=function(t,e,i){void 0===i&&(i={});for(var a=r.getCoord(t),o=r.getCoords(e),l=0;l<o.length-1;l++){var c=!1;if(i.ignoreEndVertices&&(0===l&&(c="start"),l===o.length-2&&(c="end"),0===l&&l+1===o.length-1&&(c="both")),n(o[l],o[l+1],a,c))return!0}return!1}},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(101),a=i(144),o=r(i(379));e.default=function(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var i=[];if(a.coordEach(t,(function(t){i.push([t[0],t[1]])})),!i.length)return null;var r=o.default(i,e.concavity);return r.length>3?n.polygon([r]):null}},function(t,e,i){"use strict";var r=i(380),n=i(381),a=i(382);const o=i(383).orient2d;function l(t,e,i){e=Math.max(0,void 0===e?2:e),i=i||0;var n=function(t){for(var e=t[0],i=t[0],r=t[0],n=t[0],o=0;o<t.length;o++){var l=t[o];l[0]<e[0]&&(e=l),l[0]>r[0]&&(r=l),l[1]<i[1]&&(i=l),l[1]>n[1]&&(n=l)}var c=[e,i,r,n],u=c.slice();for(o=0;o<t.length;o++)a(t[o],c)||u.push(t[o]);return function(t){t.sort(x);for(var e=[],i=0;i<t.length;i++){for(;e.length>=2&&f(e[e.length-2],e[e.length-1],t[i])<=0;)e.pop();e.push(t[i])}for(var r=[],n=t.length-1;n>=0;n--){for(;r.length>=2&&f(r[r.length-2],r[r.length-1],t[n])<=0;)r.pop();r.push(t[n])}return r.pop(),e.pop(),e.concat(r)}(u)}(t),o=new r(16);o.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},o.compareMinX=function(t,e){return t[0]-e[0]},o.compareMinY=function(t,e){return t[1]-e[1]},o.load(t);for(var l,u=[],h=0;h<n.length;h++){var p=n[h];o.remove(p),l=g(p,l),u.push(l)}var d=new r(16);for(h=0;h<u.length;h++)d.insert(m(u[h]));for(var _=e*e,v=i*i;u.length;){var b=u.shift(),w=b.p,C=b.next.p,S=y(w,C);if(!(S<v)){var M=S/_;(p=c(o,b.prev.p,w,C,b.next.next.p,M,d))&&Math.min(y(p,w),y(p,C))<=M&&(u.push(b),u.push(g(p,b)),o.remove(p),d.remove(b),d.insert(m(b)),d.insert(m(b.next)))}}b=l;var T=[];do{T.push(b.p),b=b.next}while(b!==l);return T.push(b.p),T}function c(t,e,i,r,a,o,l){for(var c=new n([],u),p=t.data;p;){for(var f=0;f<p.children.length;f++){var m=p.children[f],g=p.leaf?_(m,i,r):h(i,r,m);g>o||c.push({node:m,dist:g})}for(;c.length&&!c.peek().node.children;){var y=c.pop(),v=y.node,x=_(v,e,i),b=_(v,r,a);if(y.dist<x&&y.dist<b&&d(i,v,l)&&d(r,v,l))return v}(p=c.pop())&&(p=p.node)}return null}function u(t,e){return t.dist-e.dist}function h(t,e,i){if(p(t,i)||p(e,i))return 0;var r=v(t[0],t[1],e[0],e[1],i.minX,i.minY,i.maxX,i.minY);if(0===r)return 0;var n=v(t[0],t[1],e[0],e[1],i.minX,i.minY,i.minX,i.maxY);if(0===n)return 0;var a=v(t[0],t[1],e[0],e[1],i.maxX,i.minY,i.maxX,i.maxY);if(0===a)return 0;var o=v(t[0],t[1],e[0],e[1],i.minX,i.maxY,i.maxX,i.maxY);return 0===o?0:Math.min(r,n,a,o)}function p(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function d(t,e,i){for(var r,n,a,o,l=Math.min(t[0],e[0]),c=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),p=i.search({minX:l,minY:c,maxX:u,maxY:h}),d=0;d<p.length;d++)if(r=p[d].p,n=p[d].next.p,a=t,r!==(o=e)&&n!==a&&f(r,n,a)>0!=f(r,n,o)>0&&f(a,o,r)>0!=f(a,o,n)>0)return!1;return!0}function f(t,e,i){return o(t[0],t[1],e[0],e[1],i[0],i[1])}function m(t){var e=t.p,i=t.next.p;return t.minX=Math.min(e[0],i[0]),t.minY=Math.min(e[1],i[1]),t.maxX=Math.max(e[0],i[0]),t.maxY=Math.max(e[1],i[1]),t}function g(t,e){var i={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(i.next=e.next,i.prev=e,e.next.prev=i,e.next=i):(i.prev=i,i.next=i),i}function y(t,e){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function _(t,e,i){var r=e[0],n=e[1],a=i[0]-r,o=i[1]-n;if(0!==a||0!==o){var l=((t[0]-r)*a+(t[1]-n)*o)/(a*a+o*o);l>1?(r=i[0],n=i[1]):l>0&&(r+=a*l,n+=o*l)}return(a=t[0]-r)*a+(o=t[1]-n)*o}function v(t,e,i,r,n,a,o,l){var c,u,h,p,d=i-t,f=r-e,m=o-n,g=l-a,y=t-n,_=e-a,v=d*d+f*f,x=d*m+f*g,b=m*m+g*g,w=d*y+f*_,C=m*y+g*_,S=v*b-x*x,M=S,T=S;0===S?(u=0,M=1,p=C,T=b):(p=v*C-x*w,(u=x*C-b*w)<0?(u=0,p=C,T=b):u>M&&(u=M,p=C+x,T=b)),p<0?(p=0,-w<0?u=0:-w>v?u=M:(u=-w,M=v)):p>T&&(p=T,-w+x<0?u=0:-w+x>v?u=M:(u=-w+x,M=v));var E=(1-(h=0===p?0:p/T))*n+h*o-((1-(c=0===u?0:u/M))*t+c*i),A=(1-h)*a+h*l-((1-c)*e+c*r);return E*E+A*A}function x(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}t.exports=l,t.exports.default=l},function(t,e,i){t.exports=function(){"use strict";function t(t,r,n,a,o){!function t(i,r,n,a,o){for(;a>n;){if(a-n>600){var l=a-n+1,c=r-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1);t(i,r,Math.max(n,Math.floor(r-c*h/l+p)),Math.min(a,Math.floor(r+(l-c)*h/l+p)),o)}var d=i[r],f=n,m=a;for(e(i,n,r),o(i[a],d)>0&&e(i,n,a);f<m;){for(e(i,f,m),f++,m--;o(i[f],d)<0;)f++;for(;o(i[m],d)>0;)m--}0===o(i[n],d)?e(i,n,m):e(i,++m,a),m<=r&&(n=m+1),r<=m&&(a=m-1)}}(t,r,n||0,a||t.length-1,o||i)}function e(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function a(t,e){o(t,0,t.children.length,e,t)}function o(t,e,i,r,n){n||(n=m(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a=e;a<i;a++){var o=t.children[a];l(n,t.leaf?r(o):o)}return n}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,r,n,a){for(var o=[i,r];o.length;)if(!((r=o.pop())-(i=o.pop())<=n)){var l=i+Math.ceil((r-i)/n/2)*n;t(e,l,i,r,a),o.push(i,l,l,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,i=[];if(!f(t,e))return i;for(var r=this.toBBox,n=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],l=e.leaf?r(o):o;f(t,l)&&(e.leaf?i.push(o):d(t,l)?this._all(o,i):n.push(o))}e=n.pop()}return i},r.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var i=[];e;){for(var r=0;r<e.children.length;r++){var n=e.children[r],a=e.leaf?this.toBBox(n):n;if(f(t,a)){if(e.leaf||d(t,a))return!0;i.push(n)}}e=i.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=m([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var i,r,a,o=this.data,l=this.toBBox(t),c=[],u=[];o||c.length;){if(o||(o=c.pop(),r=c[c.length-1],i=u.pop(),a=!0),o.leaf){var h=n(t,o.children,e);if(-1!==h)return o.children.splice(h,1),c.push(o),this._condense(c),this}a||o.leaf||!d(o,l)?r?(i++,o=r.children[i],a=!1):o=null:(c.push(o),u.push(i),i=0,r=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},r.prototype._build=function(t,e,i,r){var n,o=i-e+1,l=this._maxEntries;if(o<=l)return a(n=m(t.slice(e,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(o)/Math.log(l)),l=Math.ceil(o/Math.pow(l,r-1))),(n=m([])).leaf=!1,n.height=r;var c=Math.ceil(o/l),u=c*Math.ceil(Math.sqrt(l));g(t,e,i,u,this.compareMinX);for(var h=e;h<=i;h+=u){var p=Math.min(h+u-1,i);g(t,h,p,c,this.compareMinY);for(var d=h;d<=p;d+=c){var f=Math.min(d+c-1,p);n.children.push(this._build(t,d,f,r-1))}}return a(n,this.toBBox),n},r.prototype._chooseSubtree=function(t,e,i,r){for(;r.push(e),!e.leaf&&r.length-1!==i;){for(var n=1/0,a=1/0,o=void 0,l=0;l<e.children.length;l++){var c=e.children[l],u=h(c),p=(d=t,f=c,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-u);p<a?(a=p,n=u<n?u:n,o=c):p===a&&u<n&&(n=u,o=c)}e=o||e.children[0]}var d,f;return e},r.prototype._insert=function(t,e,i){var r=i?t:this.toBBox(t),n=[],a=this._chooseSubtree(r,this.data,e,n);for(a.children.push(t),l(a,r);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(r,n,e)},r.prototype._split=function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var o=this._chooseSplitIndex(i,n,r),l=m(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,a(i,this.toBBox),a(l,this.toBBox),e?t[e-1].children.push(l):this._splitRoot(i,l)},r.prototype._splitRoot=function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,i){for(var r,n,a,l,c,u,p,d=1/0,f=1/0,m=e;m<=i-e;m++){var g=o(t,0,m,this.toBBox),y=o(t,m,i,this.toBBox),_=(n=g,a=y,void 0,void 0,void 0,void 0,l=Math.max(n.minX,a.minX),c=Math.max(n.minY,a.minY),u=Math.min(n.maxX,a.maxX),p=Math.min(n.maxY,a.maxY),Math.max(0,u-l)*Math.max(0,p-c)),v=h(g)+h(y);_<d?(d=_,r=m,f=v<f?v:f):_===d&&v<f&&(f=v,r=m)}return r||i-e},r.prototype._chooseSplitAxis=function(t,e,i){var r=t.leaf?this.compareMinX:c,n=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,i,r){t.children.sort(r);for(var n=this.toBBox,a=o(t,0,e,n),c=o(t,i-e,i,n),u=p(a)+p(c),h=e;h<i-e;h++){var d=t.children[h];l(a,t.leaf?n(d):d),u+=p(a)}for(var f=i-e-1;f>=e;f--){var m=t.children[f];l(c,t.leaf?n(m):m),u+=p(c)}return u},r.prototype._adjustParentBBoxes=function(t,e,i){for(var r=i;r>=0;r--)l(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():a(t[e],this.toBBox)},r}()},function(t,e,i){t.exports=function(){"use strict";var t=function(t,i){if(void 0===t&&(t=[]),void 0===i&&(i=e),this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function e(t,e){return t<e?-1:t>e?1:0}return t.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(t){for(var e=this.data,i=this.compare,r=e[t];t>0;){var n=t-1>>1,a=e[n];if(i(r,a)>=0)break;e[t]=a,t=n}e[t]=r},t.prototype._down=function(t){for(var e=this.data,i=this.compare,r=this.length>>1,n=e[t];t<r;){var a=1+(t<<1),o=e[a],l=a+1;if(l<this.length&&i(e[l],o)<0&&(a=l,o=e[l]),i(o,n)>=0)break;e[t]=o,t=a}e[t]=n},t}()},function(t,e){t.exports=function(t,e){for(var i=t[0],r=t[1],n=!1,a=0,o=e.length-1;a<e.length;o=a++){var l=e[a][0],c=e[a][1],u=e[o][0],h=e[o][1];c>r!=h>r&&i<(u-l)*(r-c)/(h-c)+l&&(n=!n)}return n}},function(t,e,i){!function(t){"use strict";const e=134217729;function i(t,e,i,r,n){let a,o,l,c,u=e[0],h=r[0],p=0,d=0;h>u==h>-u?(a=u,u=e[++p]):(a=h,h=r[++d]);let f=0;if(p<t&&d<i)for(h>u==h>-u?(l=a-((o=u+a)-u),u=e[++p]):(l=a-((o=h+a)-h),h=r[++d]),a=o,0!==l&&(n[f++]=l);p<t&&d<i;)h>u==h>-u?(l=a-((o=a+u)-(c=o-a))+(u-c),u=e[++p]):(l=a-((o=a+h)-(c=o-a))+(h-c),h=r[++d]),a=o,0!==l&&(n[f++]=l);for(;p<t;)l=a-((o=a+u)-(c=o-a))+(u-c),u=e[++p],a=o,0!==l&&(n[f++]=l);for(;d<i;)l=a-((o=a+h)-(c=o-a))+(h-c),h=r[++d],a=o,0!==l&&(n[f++]=l);return 0===a&&0!==f||(n[f++]=a),f}function r(t){return new Float64Array(t)}const n=r(4),a=r(8),o=r(12),l=r(16),c=r(4);t.orient2d=function(t,r,u,h,p,d){const f=(r-d)*(u-p),m=(t-p)*(h-d),g=f-m;if(0===f||0===m||f>0!=m>0)return g;const y=Math.abs(f+m);return Math.abs(g)>=33306690738754716e-32*y?g:-function(t,r,u,h,p,d,f){let m,g,y,_,v,x,b,w,C,S,M,T,E,A,I,P,O,k;const D=t-p,F=u-p,z=r-d,j=h-d;v=(I=(w=D-(b=(x=e*D)-(x-D)))*(S=j-(C=(x=e*j)-(x-j)))-((A=D*j)-b*C-w*C-b*S))-(M=I-(O=(w=z-(b=(x=e*z)-(x-z)))*(S=F-(C=(x=e*F)-(x-F)))-((P=z*F)-b*C-w*C-b*S))),n[0]=I-(M+v)+(v-O),v=(E=A-((T=A+M)-(v=T-A))+(M-v))-(M=E-P),n[1]=E-(M+v)+(v-P),v=(k=T+M)-T,n[2]=T-(k-v)+(M-v),n[3]=k;let N=function(t,e){let i=e[0];for(let t=1;t<4;t++)i+=e[t];return i}(0,n),B=22204460492503146e-32*f;if(N>=B||-N>=B)return N;if(m=t-(D+(v=t-D))+(v-p),y=u-(F+(v=u-F))+(v-p),g=r-(z+(v=r-z))+(v-d),_=h-(j+(v=h-j))+(v-d),0===m&&0===g&&0===y&&0===_)return N;if(B=11093356479670487e-47*f+33306690738754706e-32*Math.abs(N),(N+=D*_+j*m-(z*y+F*g))>=B||-N>=B)return N;v=(I=(w=m-(b=(x=e*m)-(x-m)))*(S=j-(C=(x=e*j)-(x-j)))-((A=m*j)-b*C-w*C-b*S))-(M=I-(O=(w=g-(b=(x=e*g)-(x-g)))*(S=F-(C=(x=e*F)-(x-F)))-((P=g*F)-b*C-w*C-b*S))),c[0]=I-(M+v)+(v-O),v=(E=A-((T=A+M)-(v=T-A))+(M-v))-(M=E-P),c[1]=E-(M+v)+(v-P),v=(k=T+M)-T,c[2]=T-(k-v)+(M-v),c[3]=k;const V=i(4,n,4,c,a);v=(I=(w=D-(b=(x=e*D)-(x-D)))*(S=_-(C=(x=e*_)-(x-_)))-((A=D*_)-b*C-w*C-b*S))-(M=I-(O=(w=z-(b=(x=e*z)-(x-z)))*(S=y-(C=(x=e*y)-(x-y)))-((P=z*y)-b*C-w*C-b*S))),c[0]=I-(M+v)+(v-O),v=(E=A-((T=A+M)-(v=T-A))+(M-v))-(M=E-P),c[1]=E-(M+v)+(v-P),v=(k=T+M)-T,c[2]=T-(k-v)+(M-v),c[3]=k;const U=i(V,a,4,c,o);v=(I=(w=m-(b=(x=e*m)-(x-m)))*(S=_-(C=(x=e*_)-(x-_)))-((A=m*_)-b*C-w*C-b*S))-(M=I-(O=(w=g-(b=(x=e*g)-(x-g)))*(S=y-(C=(x=e*y)-(x-y)))-((P=g*y)-b*C-w*C-b*S))),c[0]=I-(M+v)+(v-O),v=(E=A-((T=A+M)-(v=T-A))+(M-v))-(M=E-P),c[1]=E-(M+v)+(v-P),v=(k=T+M)-T,c[2]=T-(k-v)+(M-v),c[3]=k;const H=i(U,o,4,c,l);return l[H-1]}(t,r,u,h,p,d,y)},t.orient2dfast=function(t,e,i,r,n,a){return(e-a)*(i-n)-(t-n)*(r-a)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(144),n=i(101);e.default=function(t,e){void 0===e&&(e={});var i=0,a=0,o=0;return r.coordEach(t,(function(t){i+=t[0],a+=t[1],o++})),n.point([i/o,a/o],e.properties)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var r;!function(n){var a=/^\s+/,o=/\s+$/,l=0,c=n.round,u=n.min,h=n.max,p=n.random;function d(t,e){if(e=e||{},(t=t||"")instanceof d)return t;if(!(this instanceof d))return new d(t,e);var i=function(t){var e,i,r,l={r:0,g:0,b:0},c=1,p=null,d=null,f=null,m=!1,g=!1;return"string"==typeof t&&(t=function(t){t=t.replace(a,"").replace(o,"").toLowerCase();var e,i=!1;if(O[t])t=O[t],i=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=G.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=G.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=G.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=G.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=G.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=G.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=G.hex8.exec(t))?{r:j(e[1]),g:j(e[2]),b:j(e[3]),a:U(e[4]),format:i?"name":"hex8"}:(e=G.hex6.exec(t))?{r:j(e[1]),g:j(e[2]),b:j(e[3]),format:i?"name":"hex"}:(e=G.hex4.exec(t))?{r:j(e[1]+""+e[1]),g:j(e[2]+""+e[2]),b:j(e[3]+""+e[3]),a:U(e[4]+""+e[4]),format:i?"name":"hex8"}:!!(e=G.hex3.exec(t))&&{r:j(e[1]+""+e[1]),g:j(e[2]+""+e[2]),b:j(e[3]+""+e[3]),format:i?"name":"hex"}}(t)),"object"==typeof t&&($(t.r)&&$(t.g)&&$(t.b)?(e=t.r,i=t.g,r=t.b,l={r:255*F(e,255),g:255*F(i,255),b:255*F(r,255)},m=!0,g="%"===String(t.r).substr(-1)?"prgb":"rgb"):$(t.h)&&$(t.s)&&$(t.v)?(p=B(t.s),d=B(t.v),l=function(t,e,i){t=6*F(t,360),e=F(e,100),i=F(i,100);var r=n.floor(t),a=t-r,o=i*(1-e),l=i*(1-a*e),c=i*(1-(1-a)*e),u=r%6;return{r:255*[i,l,o,o,c,i][u],g:255*[c,i,i,l,o,o][u],b:255*[o,o,c,i,i,l][u]}}(t.h,p,d),m=!0,g="hsv"):$(t.h)&&$(t.s)&&$(t.l)&&(p=B(t.s),f=B(t.l),l=function(t,e,i){var r,n,a;function o(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}if(t=F(t,360),e=F(e,100),i=F(i,100),0===e)r=n=a=i;else{var l=i<.5?i*(1+e):i+e-i*e,c=2*i-l;r=o(c,l,t+1/3),n=o(c,l,t),a=o(c,l,t-1/3)}return{r:255*r,g:255*n,b:255*a}}(t.h,p,f),m=!0,g="hsl"),t.hasOwnProperty("a")&&(c=t.a)),c=D(c),{ok:m,format:t.format||g,r:u(255,h(l.r,0)),g:u(255,h(l.g,0)),b:u(255,h(l.b,0)),a:c}}(t);this._originalInput=t,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=c(100*this._a)/100,this._format=e.format||i.format,this._gradientType=e.gradientType,this._r<1&&(this._r=c(this._r)),this._g<1&&(this._g=c(this._g)),this._b<1&&(this._b=c(this._b)),this._ok=i.ok,this._tc_id=l++}function f(t,e,i){t=F(t,255),e=F(e,255),i=F(i,255);var r,n,a=h(t,e,i),o=u(t,e,i),l=(a+o)/2;if(a==o)r=n=0;else{var c=a-o;switch(n=l>.5?c/(2-a-o):c/(a+o),a){case t:r=(e-i)/c+(e<i?6:0);break;case e:r=(i-t)/c+2;break;case i:r=(t-e)/c+4}r/=6}return{h:r,s:n,l:l}}function m(t,e,i){t=F(t,255),e=F(e,255),i=F(i,255);var r,n,a=h(t,e,i),o=u(t,e,i),l=a,c=a-o;if(n=0===a?0:c/a,a==o)r=0;else{switch(a){case t:r=(e-i)/c+(e<i?6:0);break;case e:r=(i-t)/c+2;break;case i:r=(t-e)/c+4}r/=6}return{h:r,s:n,v:l}}function g(t,e,i,r){var n=[N(c(t).toString(16)),N(c(e).toString(16)),N(c(i).toString(16))];return r&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function y(t,e,i,r){return[N(V(r)),N(c(t).toString(16)),N(c(e).toString(16)),N(c(i).toString(16))].join("")}function _(t,e){e=0===e?0:e||10;var i=d(t).toHsl();return i.s-=e/100,i.s=z(i.s),d(i)}function v(t,e){e=0===e?0:e||10;var i=d(t).toHsl();return i.s+=e/100,i.s=z(i.s),d(i)}function x(t){return d(t).desaturate(100)}function b(t,e){e=0===e?0:e||10;var i=d(t).toHsl();return i.l+=e/100,i.l=z(i.l),d(i)}function w(t,e){e=0===e?0:e||10;var i=d(t).toRgb();return i.r=h(0,u(255,i.r-c(-e/100*255))),i.g=h(0,u(255,i.g-c(-e/100*255))),i.b=h(0,u(255,i.b-c(-e/100*255))),d(i)}function C(t,e){e=0===e?0:e||10;var i=d(t).toHsl();return i.l-=e/100,i.l=z(i.l),d(i)}function S(t,e){var i=d(t).toHsl(),r=(i.h+e)%360;return i.h=r<0?360+r:r,d(i)}function M(t){var e=d(t).toHsl();return e.h=(e.h+180)%360,d(e)}function T(t){var e=d(t).toHsl(),i=e.h;return[d(t),d({h:(i+120)%360,s:e.s,l:e.l}),d({h:(i+240)%360,s:e.s,l:e.l})]}function E(t){var e=d(t).toHsl(),i=e.h;return[d(t),d({h:(i+90)%360,s:e.s,l:e.l}),d({h:(i+180)%360,s:e.s,l:e.l}),d({h:(i+270)%360,s:e.s,l:e.l})]}function A(t){var e=d(t).toHsl(),i=e.h;return[d(t),d({h:(i+72)%360,s:e.s,l:e.l}),d({h:(i+216)%360,s:e.s,l:e.l})]}function I(t,e,i){e=e||6,i=i||30;var r=d(t).toHsl(),n=360/i,a=[d(t)];for(r.h=(r.h-(n*e>>1)+720)%360;--e;)r.h=(r.h+n)%360,a.push(d(r));return a}function P(t,e){e=e||6;for(var i=d(t).toHsv(),r=i.h,n=i.s,a=i.v,o=[],l=1/e;e--;)o.push(d({h:r,s:n,v:a})),a=(a+l)%1;return o}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,i,r=this.toRgb();return t=r.r/255,e=r.g/255,i=r.b/255,.2126*(t<=.03928?t/12.92:n.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:n.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:n.pow((i+.055)/1.055,2.4))},setAlpha:function(t){return this._a=D(t),this._roundA=c(100*this._a)/100,this},toHsv:function(){var t=m(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=m(this._r,this._g,this._b),e=c(360*t.h),i=c(100*t.s),r=c(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+r+"%)":"hsva("+e+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=f(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=f(this._r,this._g,this._b),e=c(360*t.h),i=c(100*t.s),r=c(100*t.l);return 1==this._a?"hsl("+e+", "+i+"%, "+r+"%)":"hsla("+e+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return g(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,i,r,n){var a=[N(c(t).toString(16)),N(c(e).toString(16)),N(c(i).toString(16)),N(V(r))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:c(this._r),g:c(this._g),b:c(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+c(this._r)+", "+c(this._g)+", "+c(this._b)+")":"rgba("+c(this._r)+", "+c(this._g)+", "+c(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:c(100*F(this._r,255))+"%",g:c(100*F(this._g,255))+"%",b:c(100*F(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+c(100*F(this._r,255))+"%, "+c(100*F(this._g,255))+"%, "+c(100*F(this._b,255))+"%)":"rgba("+c(100*F(this._r,255))+"%, "+c(100*F(this._g,255))+"%, "+c(100*F(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(k[g(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+y(this._r,this._g,this._b,this._a),i=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var n=d(t);i="#"+y(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,r=this._a<1&&this._a>=0;return e||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex4"===t&&(i=this.toHex8String(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(b,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(C,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(v,arguments)},greyscale:function(){return this._applyModification(x,arguments)},spin:function(){return this._applyModification(S,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(M,arguments)},monochromatic:function(){return this._applyCombination(P,arguments)},splitcomplement:function(){return this._applyCombination(A,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(E,arguments)}},d.fromRatio=function(t,e){if("object"==typeof t){var i={};for(var r in t)t.hasOwnProperty(r)&&(i[r]="a"===r?t[r]:B(t[r]));t=i}return d(t,e)},d.equals=function(t,e){return!(!t||!e)&&d(t).toRgbString()==d(e).toRgbString()},d.random=function(){return d.fromRatio({r:p(),g:p(),b:p()})},d.mix=function(t,e,i){i=0===i?0:i||50;var r=d(t).toRgb(),n=d(e).toRgb(),a=i/100;return d({r:(n.r-r.r)*a+r.r,g:(n.g-r.g)*a+r.g,b:(n.b-r.b)*a+r.b,a:(n.a-r.a)*a+r.a})},d.readability=function(t,e){var i=d(t),r=d(e);return(n.max(i.getLuminance(),r.getLuminance())+.05)/(n.min(i.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(t,e,i){var r,n,a,o,l,c=d.readability(t,e);switch(n=!1,(a=i,"AA"!==(o=((a=a||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==o&&(o="AA"),"small"!==(l=(a.size||"small").toLowerCase())&&"large"!==l&&(l="small"),r={level:o,size:l}).level+r.size){case"AAsmall":case"AAAlarge":n=c>=4.5;break;case"AAlarge":n=c>=3;break;case"AAAsmall":n=c>=7}return n},d.mostReadable=function(t,e,i){var r,n,a,o,l=null,c=0;n=(i=i||{}).includeFallbackColors,a=i.level,o=i.size;for(var u=0;u<e.length;u++)(r=d.readability(t,e[u]))>c&&(c=r,l=d(e[u]));return d.isReadable(t,l,{level:a,size:o})||!n?l:(i.includeFallbackColors=!1,d.mostReadable(t,["#fff","#000"],i))};var O=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},k=d.hexNames=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}(O);function D(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function F(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var i=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=u(e,h(0,parseFloat(t))),i&&(t=parseInt(t*e,10)/100),n.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function z(t){return u(1,h(0,t))}function j(t){return parseInt(t,16)}function N(t){return 1==t.length?"0"+t:""+t}function B(t){return t<=1&&(t=100*t+"%"),t}function V(t){return n.round(255*parseFloat(t)).toString(16)}function U(t){return j(t)/255}var H,q,Z,G=(q="[\\s|\\(]+("+(H="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",Z="[\\s|\\(]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")[,|\\s]+("+H+")\\s*\\)?",{CSS_UNIT:new RegExp(H),rgb:new RegExp("rgb"+q),rgba:new RegExp("rgba"+Z),hsl:new RegExp("hsl"+q),hsla:new RegExp("hsla"+Z),hsv:new RegExp("hsv"+q),hsva:new RegExp("hsva"+Z),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function $(t){return!!G.CSS_UNIT.exec(t)}t.exports?t.exports=d:void 0===(r=function(){return d}.call(e,i,e,t))||(t.exports=r)}(Math)},function(t,e,i){(function(){"use strict";var t,r,n,a,o,l={}.hasOwnProperty;t=i(504),r=i(220).defaults,a=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},o=function(t){return"<![CDATA["+n(t)+"]]>"},n=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,i,n;for(e in this.options={},i=r[.2])l.call(i,e)&&(n=i[e],this.options[e]=n);for(e in t)l.call(t,e)&&(n=t[e],this.options[e]=n)}return e.prototype.buildObject=function(e){var i,n,c,u,h,p;return i=this.options.attrkey,n=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===r[.2].rootName?e=e[h=Object.keys(e)[0]]:h=this.options.rootName,p=this,c=function(t,e){var r,u,h,d,f,m;if("object"!=typeof e)p.options.cdata&&a(e)?t.raw(o(e)):t.txt(e);else if(Array.isArray(e)){for(d in e)if(l.call(e,d))for(f in u=e[d])h=u[f],t=c(t.ele(f),h).up()}else for(f in e)if(l.call(e,f))if(u=e[f],f===i){if("object"==typeof u)for(r in u)m=u[r],t=t.att(r,m)}else if(f===n)t=p.options.cdata&&a(u)?t.raw(o(u)):t.txt(u);else if(Array.isArray(u))for(d in u)l.call(u,d)&&(t="string"==typeof(h=u[d])?p.options.cdata&&a(h)?t.ele(f).raw(o(h)).up():t.ele(f,h).up():c(t.ele(f),h).up());else"object"==typeof u?t=c(t.ele(f),u).up():"string"==typeof u&&p.options.cdata&&a(u)?t=t.ele(f).raw(o(u)).up():(null==u&&(u=""),t=t.ele(f,u.toString()).up());return t},u=t.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(u,e).end(this.options.renderOpts)},e}()}).call(this)},function(t,e,i){(function(){var e,r,n,a,o,l,c,u,h,p;p=i(119),u=p.assign,h=p.isFunction,n=i(307),a=i(308),o=i(510),c=i(234),l=i(511),e=i(96),r=i(186),t.exports.create=function(t,e,i,r){var n,o;if(null==t)throw new Error("Root element needs a name.");return r=u({},e,i,r),o=(n=new a(r)).element(t),r.headless||(n.declaration(r),null==r.pubID&&null==r.sysID||n.dtd(r)),o},t.exports.begin=function(t,e,i){var r;return h(t)&&(e=(r=[t,e])[0],i=r[1],t={}),e?new o(t,e,i):new a(t)},t.exports.stringWriter=function(t){return new c(t)},t.exports.streamWriter=function(t,e){return new l(t,e)},t.exports.implementation=new n,t.exports.nodeType=e,t.exports.writerState=r}).call(this)},function(t,e,i){(function(){var e,r;e=i(506),r=i(507),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new r(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},function(t,e){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},function(t,e,i){(function(){var e,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_,v,x,b,w,C,S,M,T={}.hasOwnProperty;M=i(119),C=M.isObject,w=M.isFunction,S=M.isPlainObject,b=M.getValue,e=i(96),f=i(308),m=i(221),a=i(223),o=i(224),y=i(231),x=i(232),g=i(233),p=i(225),d=i(226),l=i(227),u=i(228),c=i(229),h=i(230),n=i(309),v=i(311),_=i(234),r=i(186),t.exports=function(){function t(t,i,r){var n;this.name="?xml",this.type=e.Document,t||(t={}),n={},t.writer?S(t.writer)&&(n=t.writer,t.writer=new _):t.writer=new _,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new v(t),this.onDataCallback=i||function(){},this.onEndCallback=r||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var i,r,n,a,o,l,c,u;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(r in n={},c=t.attribs)T.call(c,r)&&(i=c[r],n[r]=i.value);this.node(t.name,n);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(o=0,l=(u=t.children).length;o<l;o++)a=u[o],this.createChildNode(a),a.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,i){var r;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=b(t),null==e&&(e={}),e=b(e),C(e)||(i=(r=[e,i])[0],e=r[1]),this.currentNode=new m(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=i&&this.text(i),this},t.prototype.element=function(t,i,r){var n,a,o,l,c,u;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||C(t)||w(t))for(l=this.options.noValidation,this.options.noValidation=!0,(u=new f(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=l,a=0,o=(c=u.children).length;a<o;a++)n=c[a],this.createChildNode(n),n.type===e.Element&&this.up();else this.node(t,i,r);return this},t.prototype.attribute=function(t,e){var i,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=b(t)),C(t))for(i in t)T.call(t,i)&&(r=t[i],this.attribute(i,r));else w(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new n(this,t,""):null!=e&&(this.currentNode.attribs[t]=new n(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new x(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new a(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new y(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var i,r,n,a,o;if(this.openCurrent(),null!=t&&(t=b(t)),null!=e&&(e=b(e)),Array.isArray(t))for(i=0,a=t.length;i<a;i++)r=t[i],this.instruction(r);else if(C(t))for(r in t)T.call(t,r)&&(n=t[r],this.instruction(r,n));else w(e)&&(e=e.apply()),o=new g(this,t,e),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,i){var r;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return r=new p(this,t,e,i),this.onData(this.writer.declaration(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,i){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new d(this,e,i),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var i;return this.openCurrent(),i=new c(this,t,e),this.onData(this.writer.dtdElement(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,i,r,n){var a;return this.openCurrent(),a=new l(this,t,e,i,r,n),this.onData(this.writer.dtdAttList(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var i;return this.openCurrent(),i=new u(this,!1,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var i;return this.openCurrent(),i=new u(this,!0,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var i;return this.openCurrent(),i=new h(this,t,e),this.onData(this.writer.dtdNotation(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var i,n,a,o;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),n="",t.type===e.Element){for(a in this.writerOptions.state=r.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,o=t.attribs)T.call(o,a)&&(i=o[a],n+=this.writer.attribute(i,this.writerOptions,this.currentLevel));n+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.InsideTag}else this.writerOptions.state=r.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.children?(n+=" [",this.writerOptions.state=r.InsideTag):(this.writerOptions.state=r.CloseTag,n+=">"),n+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var i;if(!t.isClosed)return"",this.writerOptions.state=r.CloseTag,i=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.None,this.onData(i,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.dtd=function(t,e,i){return this.doctype(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},function(t,e,i){(function(){var e,r,n,a={}.hasOwnProperty;e=i(96),n=i(312),r=i(186),t.exports=function(t){function i(t,e){this.stream=t,i.__super__.constructor.call(this,e)}return function(t,e){for(var i in e)a.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.endline=function(t,e,n){return t.isLastRootNode&&e.state===r.CloseTag?"":i.__super__.endline.call(this,t,e,n)},i.prototype.document=function(t,e){var i,r,n,a,o,l,c,u,h;for(r=n=0,o=(c=t.children).length;n<o;r=++n)(i=c[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),h=[],a=0,l=(u=t.children).length;a<l;a++)i=u[a],h.push(this.writeChildNode(i,e,0));return h},i.prototype.attribute=function(t,e,r){return this.stream.write(i.__super__.attribute.call(this,t,e,r))},i.prototype.cdata=function(t,e,r){return this.stream.write(i.__super__.cdata.call(this,t,e,r))},i.prototype.comment=function(t,e,r){return this.stream.write(i.__super__.comment.call(this,t,e,r))},i.prototype.declaration=function(t,e,r){return this.stream.write(i.__super__.declaration.call(this,t,e,r))},i.prototype.docType=function(t,e,i){var n,a,o,l;if(i||(i=0),this.openNode(t,e,i),e.state=r.OpenTag,this.stream.write(this.indent(t,e,i)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,i)),e.state=r.InsideTag,a=0,o=(l=t.children).length;a<o;a++)n=l[a],this.writeChildNode(n,e,i+1);e.state=r.CloseTag,this.stream.write("]")}return e.state=r.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,i)),e.state=r.None,this.closeNode(t,e,i)},i.prototype.element=function(t,i,n){var o,l,c,u,h,p,d,f,m;for(d in n||(n=0),this.openNode(t,i,n),i.state=r.OpenTag,this.stream.write(this.indent(t,i,n)+"<"+t.name),f=t.attribs)a.call(f,d)&&(o=f[d],this.attribute(o,i,n));if(u=0===(c=t.children.length)?null:t.children[0],0===c||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(this.stream.write(">"),i.state=r.CloseTag,this.stream.write("</"+t.name+">")):(i.state=r.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==c||u.type!==e.Text&&u.type!==e.Raw||null==u.value){for(this.stream.write(">"+this.endline(t,i,n)),i.state=r.InsideTag,h=0,p=(m=t.children).length;h<p;h++)l=m[h],this.writeChildNode(l,i,n+1);i.state=r.CloseTag,this.stream.write(this.indent(t,i,n)+"</"+t.name+">")}else this.stream.write(">"),i.state=r.InsideTag,i.suppressPrettyCount++,this.writeChildNode(u,i,n+1),i.suppressPrettyCount--,i.state=r.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,i,n)),i.state=r.None,this.closeNode(t,i,n)},i.prototype.processingInstruction=function(t,e,r){return this.stream.write(i.__super__.processingInstruction.call(this,t,e,r))},i.prototype.raw=function(t,e,r){return this.stream.write(i.__super__.raw.call(this,t,e,r))},i.prototype.text=function(t,e,r){return this.stream.write(i.__super__.text.call(this,t,e,r))},i.prototype.dtdAttList=function(t,e,r){return this.stream.write(i.__super__.dtdAttList.call(this,t,e,r))},i.prototype.dtdElement=function(t,e,r){return this.stream.write(i.__super__.dtdElement.call(this,t,e,r))},i.prototype.dtdEntity=function(t,e,r){return this.stream.write(i.__super__.dtdEntity.call(this,t,e,r))},i.prototype.dtdNotation=function(t,e,r){return this.stream.write(i.__super__.dtdNotation.call(this,t,e,r))},i}(n)}).call(this)},function(t,e,i){(function(){"use strict";var t,r,n,a,o,l,c,u,h=function(t,e){return function(){return t.apply(e,arguments)}},p={}.hasOwnProperty;c=i(513),n=i(145),t=i(527),l=i(318),u=i(316).setImmediate,r=i(220).defaults,a=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},o=function(t,e,i){var r,n;for(r=0,n=t.length;r<n;r++)e=(0,t[r])(e,i);return e},e.Parser=function(i){function n(t){var i,n,a;if(this.parseStringPromise=h(this.parseStringPromise,this),this.parseString=h(this.parseString,this),this.reset=h(this.reset,this),this.assignOrPush=h(this.assignOrPush,this),this.processAsync=h(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(i in this.options={},n=r[.2])p.call(n,i)&&(a=n[i],this.options[i]=a);for(i in t)p.call(t,i)&&(a=t[i],this.options[i]=a);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(l.normalize)),this.reset()}return function(t,e){for(var i in e)p.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(n,i),n.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),u(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},n.prototype.assignOrPush=function(t,e,i){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(i)):this.options.explicitArray?t[e]=[i]:t[e]=i},n.prototype.reset=function(){var t,e,i,r,n;return this.removeAllListeners(),this.saxParser=c.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(n=this,function(t){if(n.saxParser.resume(),!n.saxParser.errThrown)return n.saxParser.errThrown=!0,n.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,r=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(i){return function(n){var a,l,c,u,h;if((c=Object.create(null))[e]="",!i.options.ignoreAttrs)for(a in h=n.attributes)p.call(h,a)&&(t in c||i.options.mergeAttrs||(c[t]=Object.create(null)),l=i.options.attrValueProcessors?o(i.options.attrValueProcessors,n.attributes[a],a):n.attributes[a],u=i.options.attrNameProcessors?o(i.options.attrNameProcessors,a):a,i.options.mergeAttrs?i.assignOrPush(c,u,l):c[t][u]=l);return c["#name"]=i.options.tagNameProcessors?o(i.options.tagNameProcessors,n.name):n.name,i.options.xmlns&&(c[i.options.xmlnskey]={uri:n.uri,local:n.local}),r.push(c)}}(this),this.saxParser.onclosetag=function(t){return function(){var i,n,l,c,u,h,d,f,m,g;if(h=r.pop(),u=h["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete h["#name"],!0===h.cdata&&(i=h.cdata,delete h.cdata),m=r[r.length-1],h[e].match(/^\s*$/)&&!i?(n=h[e],delete h[e]):(t.options.trim&&(h[e]=h[e].trim()),t.options.normalize&&(h[e]=h[e].replace(/\s{2,}/g," ").trim()),h[e]=t.options.valueProcessors?o(t.options.valueProcessors,h[e],u):h[e],1===Object.keys(h).length&&e in h&&!t.EXPLICIT_CHARKEY&&(h=h[e])),a(h)&&(h="function"==typeof t.options.emptyTag?t.options.emptyTag():""!==t.options.emptyTag?t.options.emptyTag:n),null!=t.options.validator&&(g="/"+function(){var t,e,i;for(i=[],t=0,e=r.length;t<e;t++)c=r[t],i.push(c["#name"]);return i}().concat(u).join("/"),function(){var e;try{return h=t.options.validator(g,m&&m[u],h)}catch(i){return e=i,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof h)if(t.options.preserveChildrenOrder){if(m){for(l in m[t.options.childkey]=m[t.options.childkey]||[],d=Object.create(null),h)p.call(h,l)&&(d[l]=h[l]);m[t.options.childkey].push(d),delete h["#name"],1===Object.keys(h).length&&e in h&&!t.EXPLICIT_CHARKEY&&(h=h[e])}}else c=Object.create(null),t.options.attrkey in h&&(c[t.options.attrkey]=h[t.options.attrkey],delete h[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in h&&(c[t.options.charkey]=h[t.options.charkey],delete h[t.options.charkey]),Object.getOwnPropertyNames(h).length>0&&(c[t.options.childkey]=h),h=c;return r.length>0?t.assignOrPush(m,u,h):(t.options.explicitRoot&&(f=h,(h=Object.create(null))[u]=f),t.resultObject=h,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),i=function(t){return function(i){var n,a;if(a=r[r.length-1])return a[e]+=i,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==i.replace(/\\n/g,"").trim())&&(a[t.options.childkey]=a[t.options.childkey]||[],(n={"#name":"__text__"})[e]=i,t.options.normalize&&(n[e]=n[e].replace(/\s{2,}/g," ").trim()),a[t.options.childkey].push(n)),a}}(this),this.saxParser.ontext=i,this.saxParser.oncdata=function(t){var e;if(e=i(t))return e.cdata=!0}},n.prototype.parseString=function(e,i){var r;null!=i&&"function"==typeof i&&(this.on("end",(function(t){return this.reset(),i(null,t)})),this.on("error",(function(t){return this.reset(),i(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,u(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(r=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",r),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw r}},n.prototype.parseStringPromise=function(t){return new Promise((e=this,function(i,r){return e.parseString(t,(function(t,e){return t?r(t):i(e)}))}));var e},n}(n),e.parseString=function(t,i,r){var n,a;return null!=r?("function"==typeof r&&(n=r),"object"==typeof i&&(a=i)):("function"==typeof i&&(n=i),a={}),new e.Parser(a).parseString(t,n)},e.parseStringPromise=function(t,i){var r;return"object"==typeof i&&(r=i),new e.Parser(r).parseStringPromise(t)}}).call(this)},function(t,e,i){(function(t){!function(e){e.parser=function(t,e){return new a(t,e)},e.SAXParser=a,e.SAXStream=l,e.createStream=function(t,e){return new l(t,e)},e.MAX_BUFFER_LENGTH=65536;var r,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(t,i){if(!(this instanceof a))return new a(t,i);var r=this;!function(t){for(var e=0,i=n.length;e<i;e++)t[n[e]]=""}(r),r.q=r.c="",r.bufferCheckPosition=e.MAX_BUFFER_LENGTH,r.opt=i||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!t,r.noscript=!(!t&&!r.opt.noscript),r.state=T.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(d)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),A(r,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),a.prototype={end:function(){D(this)},write:function(t){var i=this;if(this.error)throw this.error;if(i.closed)return k(i,"Cannot write after close. Assign an onready handler.");if(null===t)return D(i);"object"==typeof t&&(t=t.toString());for(var r=0,a="";a=q(t,r++),i.c=a,a;)switch(i.trackPosition&&(i.position++,"\n"===a?(i.line++,i.column=0):i.column++),i.state){case T.BEGIN:if(i.state=T.BEGIN_WHITESPACE,"\ufeff"===a)continue;H(i,a);continue;case T.BEGIN_WHITESPACE:H(i,a);continue;case T.TEXT:if(i.sawRoot&&!i.closedRoot){for(var o=r-1;a&&"<"!==a&&"&"!==a;)(a=q(t,r++))&&i.trackPosition&&(i.position++,"\n"===a?(i.line++,i.column=0):i.column++);i.textNode+=t.substring(o,r-1)}"<"!==a||i.sawRoot&&i.closedRoot&&!i.strict?(_(a)||i.sawRoot&&!i.closedRoot||F(i,"Text data outside of root node."),"&"===a?i.state=T.TEXT_ENTITY:i.textNode+=a):(i.state=T.OPEN_WAKA,i.startTagPosition=i.position);continue;case T.SCRIPT:"<"===a?i.state=T.SCRIPT_ENDING:i.script+=a;continue;case T.SCRIPT_ENDING:"/"===a?i.state=T.CLOSE_TAG:(i.script+="<"+a,i.state=T.SCRIPT);continue;case T.OPEN_WAKA:if("!"===a)i.state=T.SGML_DECL,i.sgmlDecl="";else if(_(a));else if(b(f,a))i.state=T.OPEN_TAG,i.tagName=a;else if("/"===a)i.state=T.CLOSE_TAG,i.tagName="";else if("?"===a)i.state=T.PROC_INST,i.procInstName=i.procInstBody="";else{if(F(i,"Unencoded <"),i.startTagPosition+1<i.position){var l=i.position-i.startTagPosition;a=new Array(l).join(" ")+a}i.textNode+="<"+a,i.state=T.TEXT}continue;case T.SGML_DECL:(i.sgmlDecl+a).toUpperCase()===c?(I(i,"onopencdata"),i.state=T.CDATA,i.sgmlDecl="",i.cdata=""):i.sgmlDecl+a==="--"?(i.state=T.COMMENT,i.comment="",i.sgmlDecl=""):(i.sgmlDecl+a).toUpperCase()===u?(i.state=T.DOCTYPE,(i.doctype||i.sawRoot)&&F(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===a?(I(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=T.TEXT):v(a)?(i.state=T.SGML_DECL_QUOTED,i.sgmlDecl+=a):i.sgmlDecl+=a;continue;case T.SGML_DECL_QUOTED:a===i.q&&(i.state=T.SGML_DECL,i.q=""),i.sgmlDecl+=a;continue;case T.DOCTYPE:">"===a?(i.state=T.TEXT,I(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=a,"["===a?i.state=T.DOCTYPE_DTD:v(a)&&(i.state=T.DOCTYPE_QUOTED,i.q=a));continue;case T.DOCTYPE_QUOTED:i.doctype+=a,a===i.q&&(i.q="",i.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:i.doctype+=a,"]"===a?i.state=T.DOCTYPE:v(a)&&(i.state=T.DOCTYPE_DTD_QUOTED,i.q=a);continue;case T.DOCTYPE_DTD_QUOTED:i.doctype+=a,a===i.q&&(i.state=T.DOCTYPE_DTD,i.q="");continue;case T.COMMENT:"-"===a?i.state=T.COMMENT_ENDING:i.comment+=a;continue;case T.COMMENT_ENDING:"-"===a?(i.state=T.COMMENT_ENDED,i.comment=O(i.opt,i.comment),i.comment&&I(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+a,i.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==a?(F(i,"Malformed comment"),i.comment+="--"+a,i.state=T.COMMENT):i.state=T.TEXT;continue;case T.CDATA:"]"===a?i.state=T.CDATA_ENDING:i.cdata+=a;continue;case T.CDATA_ENDING:"]"===a?i.state=T.CDATA_ENDING_2:(i.cdata+="]"+a,i.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===a?(i.cdata&&I(i,"oncdata",i.cdata),I(i,"onclosecdata"),i.cdata="",i.state=T.TEXT):"]"===a?i.cdata+="]":(i.cdata+="]]"+a,i.state=T.CDATA);continue;case T.PROC_INST:"?"===a?i.state=T.PROC_INST_ENDING:_(a)?i.state=T.PROC_INST_BODY:i.procInstName+=a;continue;case T.PROC_INST_BODY:if(!i.procInstBody&&_(a))continue;"?"===a?i.state=T.PROC_INST_ENDING:i.procInstBody+=a;continue;case T.PROC_INST_ENDING:">"===a?(I(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=T.TEXT):(i.procInstBody+="?"+a,i.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:b(m,a)?i.tagName+=a:(z(i),">"===a?B(i):"/"===a?i.state=T.OPEN_TAG_SLASH:(_(a)||F(i,"Invalid character in tag name"),i.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===a?(B(i,!0),V(i)):(F(i,"Forward-slash in opening tag not followed by >"),i.state=T.ATTRIB);continue;case T.ATTRIB:if(_(a))continue;">"===a?B(i):"/"===a?i.state=T.OPEN_TAG_SLASH:b(f,a)?(i.attribName=a,i.attribValue="",i.state=T.ATTRIB_NAME):F(i,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===a?i.state=T.ATTRIB_VALUE:">"===a?(F(i,"Attribute without value"),i.attribValue=i.attribName,N(i),B(i)):_(a)?i.state=T.ATTRIB_NAME_SAW_WHITE:b(m,a)?i.attribName+=a:F(i,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===a)i.state=T.ATTRIB_VALUE;else{if(_(a))continue;F(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",I(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===a?B(i):b(f,a)?(i.attribName=a,i.state=T.ATTRIB_NAME):(F(i,"Invalid attribute name"),i.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(_(a))continue;v(a)?(i.q=a,i.state=T.ATTRIB_VALUE_QUOTED):(F(i,"Unquoted attribute value"),i.state=T.ATTRIB_VALUE_UNQUOTED,i.attribValue=a);continue;case T.ATTRIB_VALUE_QUOTED:if(a!==i.q){"&"===a?i.state=T.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=a;continue}N(i),i.q="",i.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:_(a)?i.state=T.ATTRIB:">"===a?B(i):"/"===a?i.state=T.OPEN_TAG_SLASH:b(f,a)?(F(i,"No whitespace between attributes"),i.attribName=a,i.attribValue="",i.state=T.ATTRIB_NAME):F(i,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!x(a)){"&"===a?i.state=T.ATTRIB_VALUE_ENTITY_U:i.attribValue+=a;continue}N(i),">"===a?B(i):i.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(i.tagName)">"===a?V(i):b(m,a)?i.tagName+=a:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=T.SCRIPT):(_(a)||F(i,"Invalid tagname in closing tag"),i.state=T.CLOSE_TAG_SAW_WHITE);else{if(_(a))continue;w(f,a)?i.script?(i.script+="</"+a,i.state=T.SCRIPT):F(i,"Invalid tagname in closing tag."):i.tagName=a}continue;case T.CLOSE_TAG_SAW_WHITE:if(_(a))continue;">"===a?V(i):F(i,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:var h,p;switch(i.state){case T.TEXT_ENTITY:h=T.TEXT,p="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:h=T.ATTRIB_VALUE_QUOTED,p="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:h=T.ATTRIB_VALUE_UNQUOTED,p="attribValue"}if(";"===a)if(i.opt.unparsedEntities){var d=U(i);i.entity="",i.state=h,i.write(d)}else i[p]+=U(i),i.entity="",i.state=h;else b(i.entity.length?y:g,a)?i.entity+=a:(F(i,"Invalid character in entity name"),i[p]+="&"+i.entity+a,i.entity="",i.state=h);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&function(t){for(var i=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,a=0,o=n.length;a<o;a++){var l=t[n[a]].length;if(l>i)switch(n[a]){case"textNode":P(t);break;case"cdata":I(t,"oncdata",t.cdata),t.cdata="";break;case"script":I(t,"onscript",t.script),t.script="";break;default:k(t,"Max buffer length exceeded: "+n[a])}r=Math.max(r,l)}var c=e.MAX_BUFFER_LENGTH-r;t.bufferCheckPosition=c+t.position}(i),i}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;P(t=this),""!==t.cdata&&(I(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(I(t,"onscript",t.script),t.script="")}};try{r=i(514).Stream}catch(t){r=function(){}}r||(r=function(){});var o=e.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function l(t,e){if(!(this instanceof l))return new l(t,e);r.apply(this),this._parser=new a(t,e),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(t){i.emit("error",t),i._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(i,"on"+t,{get:function(){return i._parser["on"+t]},set:function(e){if(!e)return i.removeAllListeners(t),i._parser["on"+t]=e,e;i.on(t,e)},enumerable:!0,configurable:!1})}))}l.prototype=Object.create(r.prototype,{constructor:{value:l}}),l.prototype.write=function(e){if("function"==typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(e)){if(!this._decoder){var r=i(238).StringDecoder;this._decoder=new r("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},l.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},l.prototype.on=function(t,e){var i=this;return i._parser["on"+t]||-1===o.indexOf(t)||(i._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),i.emit.apply(i,e)}),r.prototype.on.call(i,t,e)};var c="[CDATA[",u="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",d={xml:h,xmlns:p},f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function _(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function v(t){return'"'===t||"'"===t}function x(t){return">"===t||_(t)}function b(t,e){return t.test(e)}function w(t,e){return!b(t,e)}var C,S,M,T=0;for(var E in e.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var i=e.ENTITIES[t],r="number"==typeof i?String.fromCharCode(i):i;e.ENTITIES[t]=r})),e.STATE)e.STATE[e.STATE[E]]=E;function A(t,e,i){t[e]&&t[e](i)}function I(t,e,i){t.textNode&&P(t),A(t,e,i)}function P(t){t.textNode=O(t.opt,t.textNode),t.textNode&&A(t,"ontext",t.textNode),t.textNode=""}function O(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function k(t,e){return P(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,A(t,"onerror",e),t}function D(t){return t.sawRoot&&!t.closedRoot&&F(t,"Unclosed root tag"),t.state!==T.BEGIN&&t.state!==T.BEGIN_WHITESPACE&&t.state!==T.TEXT&&k(t,"Unexpected end"),P(t),t.c="",t.closed=!0,A(t,"onend"),a.call(t,t.strict,t.opt),t}function F(t,e){if("object"!=typeof t||!(t instanceof a))throw new Error("bad call to strictFail");t.strict&&k(t,e)}function z(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,I(t,"onopentagstart",i)}function j(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),r=i[0],n=i[1];return e&&"xmlns"===t&&(r="xmlns",n=""),{prefix:r,local:n}}function N(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=j(t.attribName,!0),i=e.prefix,r=e.local;if("xmlns"===i)if("xml"===r&&t.attribValue!==h)F(t,"xml: prefix must be bound to "+h+"\nActual: "+t.attribValue);else if("xmlns"===r&&t.attribValue!==p)F(t,"xmlns: prefix must be bound to "+p+"\nActual: "+t.attribValue);else{var n=t.tag,a=t.tags[t.tags.length-1]||t;n.ns===a.ns&&(n.ns=Object.create(a.ns)),n.ns[r]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,I(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function B(t,e){if(t.opt.xmlns){var i=t.tag,r=j(t.tagName);i.prefix=r.prefix,i.local=r.local,i.uri=i.ns[r.prefix]||"",i.prefix&&!i.uri&&(F(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=r.prefix);var n=t.tags[t.tags.length-1]||t;i.ns&&n.ns!==i.ns&&Object.keys(i.ns).forEach((function(e){I(t,"onopennamespace",{prefix:e,uri:i.ns[e]})}));for(var a=0,o=t.attribList.length;a<o;a++){var l=t.attribList[a],c=l[0],u=l[1],h=j(c,!0),p=h.prefix,d=h.local,f=""===p?"":i.ns[p]||"",m={name:c,value:u,prefix:p,local:d,uri:f};p&&"xmlns"!==p&&!f&&(F(t,"Unbound namespace prefix: "+JSON.stringify(p)),m.uri=p),t.tag.attributes[c]=m,I(t,"onattribute",m)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),I(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=T.TEXT:t.state=T.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function V(t){if(!t.tagName)return F(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=T.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=T.SCRIPT);I(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var r=i;e--&&t.tags[e].name!==r;)F(t,"Unexpected close tag");if(e<0)return F(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=T.TEXT);t.tagName=i;for(var n=t.tags.length;n-- >e;){var a=t.tag=t.tags.pop();t.tagName=t.tag.name,I(t,"onclosetag",t.tagName);var o={};for(var l in a.ns)o[l]=a.ns[l];var c=t.tags[t.tags.length-1]||t;t.opt.xmlns&&a.ns!==c.ns&&Object.keys(a.ns).forEach((function(e){var i=a.ns[e];I(t,"onclosenamespace",{prefix:e,uri:i})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=T.TEXT}function U(t){var e,i=t.entity,r=i.toLowerCase(),n="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[r]?t.ENTITIES[r]:("#"===(i=r).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),n=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),n=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(e)||n.toLowerCase()!==i?(F(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function H(t,e){"<"===e?(t.state=T.OPEN_WAKA,t.startTagPosition=t.position):_(e)||(F(t,"Non-whitespace before first tag."),t.textNode=e,t.state=T.TEXT)}function q(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}T=e.STATE,String.fromCodePoint||(C=String.fromCharCode,S=Math.floor,M=function(){var t,e,i=[],r=-1,n=arguments.length;if(!n)return"";for(var a="";++r<n;){var o=Number(arguments[r]);if(!isFinite(o)||o<0||o>1114111||S(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?i.push(o):(t=55296+((o-=65536)>>10),e=o%1024+56320,i.push(t,e)),(r+1===n||i.length>16384)&&(a+=C.apply(null,i),i.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:M,configurable:!0,writable:!0}):String.fromCodePoint=M)}(e)}).call(this,i(143).Buffer)},function(t,e,i){t.exports=n;var r=i(145).EventEmitter;function n(){r.call(this)}i(150)(n,r),n.Readable=i(235),n.Writable=i(523),n.Duplex=i(524),n.Transform=i(525),n.PassThrough=i(526),n.Stream=n,n.prototype.pipe=function(t,e){var i=this;function n(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function a(){i.readable&&i.resume&&i.resume()}i.on("data",n),t.on("drain",a),t._isStdio||e&&!1===e.end||(i.on("end",l),i.on("close",c));var o=!1;function l(){o||(o=!0,t.end())}function c(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(h(),0===r.listenerCount(this,"error"))throw t}function h(){i.removeListener("data",n),t.removeListener("drain",a),i.removeListener("end",l),i.removeListener("close",c),i.removeListener("error",u),t.removeListener("error",u),i.removeListener("end",h),i.removeListener("close",h),t.removeListener("close",h)}return i.on("error",u),t.on("error",u),i.on("end",h),i.on("close",h),t.on("close",h),t.emit("pipe",i),t}},function(t,e,i){t.exports=i(27)(3088)},function(t,e){},function(t,e,i){"use strict";var r=i(236).Buffer,n=i(518);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,i,n=r.allocUnsafe(t>>>0),a=this.head,o=0;a;)e=n,i=o,a.data.copy(e,i),o+=a.data.length,a=a.next;return n},t}(),n&&n.inspect&&n.inspect.custom&&(t.exports.prototype[n.inspect.custom]=function(){var t=n.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var r,n,a,o,l,c=1,u={},h=!1,p=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){m(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(o="setImmediate$"+Math.random()+"$",l=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&m(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",l,!1):t.attachEvent("onmessage",l),r=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){m(t.data)},r=function(t){a.port2.postMessage(t)}):p&&"onreadystatechange"in p.createElement("script")?(n=p.documentElement,r=function(t){var e=p.createElement("script");e.onreadystatechange=function(){m(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):r=function(t){setTimeout(m,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var n={callback:t,args:e};return u[c]=n,r(c),c++},d.clearImmediate=f}function f(t){delete u[t]}function m(t){if(h)setTimeout(m,0,t);else{var e=u[t];if(e){h=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(undefined,i)}}(e)}finally{f(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(118),i(127))},function(t,e,i){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(t){return!1}var i=e.localStorage[t];return null!=i&&"true"===String(i).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,i(118))},function(t,e,i){var r=i(143),n=r.Buffer;function a(t,e){for(var i in t)e[i]=t[i]}function o(t,e,i){return n(t,e,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(a(r,e),e.Buffer=o),a(n,o),o.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return n(t,e,i)},o.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=n(t);return void 0!==e?"string"==typeof i?r.fill(e,i):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,i){"use strict";t.exports=a;var r=i(317),n=Object.create(i(168));function a(t){if(!(this instanceof a))return new a(t);r.call(this,t)}n.inherits=i(150),n.inherits(a,r),a.prototype._transform=function(t,e,i){i(null,t)}},function(t,e,i){t.exports=i(237)},function(t,e,i){t.exports=i(138)},function(t,e,i){t.exports=i(235).Transform},function(t,e,i){t.exports=i(235).PassThrough},function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},function(t,e,i){"use strict";var r=i(529);t.exports=function(t,e){e||(e={});var i,o,l,c,u,h,p,d,f,m,g,y=null==e.cutoff?.25:e.cutoff,_=null==e.radius?8:e.radius,v=e.channel||0;if(ArrayBuffer.isView(t)||Array.isArray(t)){if(!e.width||!e.height)throw Error("For raw data width and height should be provided by options");i=e.width,o=e.height,c=t,h=e.stride?e.stride:Math.floor(t.length/i/o)}else window.HTMLCanvasElement&&t instanceof window.HTMLCanvasElement?(p=(d=t).getContext("2d"),i=d.width,o=d.height,c=(f=p.getImageData(0,0,i,o)).data,h=4):window.CanvasRenderingContext2D&&t instanceof window.CanvasRenderingContext2D?(p=t,i=(d=t.canvas).width,o=d.height,c=(f=p.getImageData(0,0,i,o)).data,h=4):window.ImageData&&t instanceof window.ImageData&&(f=t,i=t.width,o=t.height,c=f.data,h=4);if(l=Math.max(i,o),window.Uint8ClampedArray&&c instanceof window.Uint8ClampedArray||window.Uint8Array&&c instanceof window.Uint8Array)for(u=c,c=Array(i*o),m=0,g=u.length;m<g;m++)c[m]=u[m*h+v]/255;else if(1!==h)throw Error("Raw data can have only 1 value per pixel");var x=Array(i*o),b=Array(i*o),w=Array(l),C=Array(l),S=Array(l+1),M=Array(l);for(m=0,g=i*o;m<g;m++){var T=c[m];x[m]=1===T?0:0===T?n:Math.pow(Math.max(0,.5-T),2),b[m]=1===T?n:0===T?0:Math.pow(Math.max(0,T-.5),2)}a(x,i,o,w,C,M,S),a(b,i,o,w,C,M,S);var E=window.Float32Array?new Float32Array(i*o):new Array(i*o);for(m=0,g=i*o;m<g;m++)E[m]=r(1-((x[m]-b[m])/_+y),0,1);return E};var n=1e20;function a(t,e,i,r,n,a,l){for(var c=0;c<e;c++){for(var u=0;u<i;u++)r[u]=t[u*e+c];for(o(r,n,a,l,i),u=0;u<i;u++)t[u*e+c]=n[u]}for(u=0;u<i;u++){for(c=0;c<e;c++)r[c]=t[u*e+c];for(o(r,n,a,l,e),c=0;c<e;c++)t[u*e+c]=Math.sqrt(n[c])}}function o(t,e,i,r,a){i[0]=0,r[0]=-n,r[1]=+n;for(var o=1,l=0;o<a;o++){for(var c=(t[o]+o*o-(t[i[l]]+i[l]*i[l]))/(2*o-2*i[l]);c<=r[l];)l--,c=(t[o]+o*o-(t[i[l]]+i[l]*i[l]))/(2*o-2*i[l]);i[++l]=o,r[l]=c,r[l+1]=+n}for(o=0,l=0;o<a;o++){for(;r[l+1]<o;)l++;e[o]=(o-i[l])*(o-i[l])+t[i[l]]}}},function(t,e){t.exports=function(t,e,i){return e<i?t<e?e:t>i?i:t:t<i?i:t>e?e:t}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),i(531),i(532),i(533);var r=i(534),n=i(535);i(536),i(537),i(538),i(539),i(540),i(541),i(542);var a=i(543),o=i(6),l=i(544),c=i(545);i(546),i(547),i(548),i(549),i(550);var u=i(551);i(553),i(554);var h=i(555);i(556),i(557);var p=i(558),d=i(559),f=i(560);i(561),i(562),i(563),i(564),i(565);var m=i(566);i(567),i(568);var g=i(569);i(570),i(571);var y=i(572);i(573);var _=i(574);i(575),i(576),i(577),i(578),i(579);var v=i(580);function x(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var b=x(r),w=x(n),C=x(a),S=x(o),M=x(l),T=x(c),E=x(u),A=x(h),I=x(p),P=x(d),O=x(f),k=x(m),D=x(g),F=x(_),z=Object.freeze({__proto__:null,offscreen:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).DOMParser,e={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,createCanvas:function(t,e){return new OffscreenCanvas(t,e)},createImage:function(t){return w.default(b.default.mark((function e(){var i,r,n;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return i=e.sent,e.next=5,i.blob();case 5:return r=e.sent,e.next=8,createImageBitmap(r);case 8:return n=e.sent,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})))()}};return"undefined"==typeof DOMParser&&void 0!==t||Reflect.deleteProperty(e,"DOMParser"),e},node:function(t){var e=t.DOMParser,i=t.canvas;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,fetch:t.fetch,createCanvas:i.createCanvas,createImage:i.loadImage}}});function j(t){return t.replace(/(?!\u3000)\s+/gm," ")}function N(t){return t.replace(/^[\n \t]+/,"")}function B(t){return t.replace(/[\n \t]+$/,"")}function V(t){return((t||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[]).map(parseFloat)}var U=/^[A-Z-]+$/;function H(t){return U.test(t)?t.toLowerCase():t}function q(t){var e=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(t)||[];return e[2]||e[3]||e[4]}function Z(t){if(!t.startsWith("rgb"))return t;var e=3;return t.replace(/\d+(\.\d+)?/g,(function(t,i){return e--&&i?String(Math.round(parseFloat(t))):t}))}var G=/(\[[^\]]+\])/g,$=/(#[^\s+>~.[:]+)/g,W=/(\.[^\s+>~.[:]+)/g,X=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Y=/(:[\w-]+\([^)]*\))/gi,K=/(:[^\s+>~.[:]+)/g,J=/([^\s+>~.[:]+)/g;function tt(t,e){var i=e.exec(t);return i?[t.replace(e," "),i.length]:[t,0]}function et(t){var e=[0,0,0],i=t.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),r=0,n=tt(i,G),a=C.default(n,2);i=a[0],r=a[1],e[1]+=r;var o=tt(i,$),l=C.default(o,2);i=l[0],r=l[1],e[0]+=r;var c=tt(i,W),u=C.default(c,2);i=u[0],r=u[1],e[1]+=r;var h=tt(i,X),p=C.default(h,2);i=p[0],r=p[1],e[2]+=r;var d=tt(i,Y),f=C.default(d,2);i=f[0],r=f[1],e[1]+=r;var m=tt(i,K),g=C.default(m,2);i=g[0],r=g[1],e[1]+=r;var y=tt(i=i.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),J),_=C.default(y,2);return i=_[0],r=_[1],e[2]+=r,e.join("")}var it=1e-8;function at(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function ot(t,e){return(t[0]*e[0]+t[1]*e[1])/(at(t)*at(e))}function lt(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(ot(t,e))}function ct(t){return t*t*t}function ut(t){return 3*t*t*(1-t)}function ht(t){return 3*t*(1-t)*(1-t)}function pt(t){return(1-t)*(1-t)*(1-t)}function dt(t){return t*t}function ft(t){return 2*t*(1-t)}function mt(t){return(1-t)*(1-t)}var gt=function(){function t(e,i,r){M.default(this,t),this.document=e,this.name=i,this.value=r,this.isNormalizedColor=!1}return T.default(t,[{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",i=this.document,r=this.name;return j(this.getString()).trim().split(e).map((function(e){return new t(i,r,e)}))}},{key:"hasValue",value:function(t){var e=this.value;return null!==e&&""!==e&&(t||0!==e)&&void 0!==e}},{key:"isString",value:function(t){var e=this.value,i="string"==typeof e;return i&&t?t.test(e):i}},{key:"isUrlDefinition",value:function(){return this.isString(/^url\(/)}},{key:"isPixels",value:function(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}},{key:"setValue",value:function(t){return this.value=t,this}},{key:"getValue",value:function(t){return void 0===t||this.hasValue()?this.value:t}},{key:"getNumber",value:function(t){if(!this.hasValue())return void 0===t?0:parseFloat(t);var e=this.value,i=parseFloat(e);return this.isString(/%$/)&&(i/=100),i}},{key:"getString",value:function(t){return void 0===t||this.hasValue()?void 0===this.value?"":String(this.value):String(t)}},{key:"getColor",value:function(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=Z(e),this.value=e),e}},{key:"getDpi",value:function(){return 96}},{key:"getRem",value:function(){return this.document.rootEmSize}},{key:"getEm",value:function(){return this.document.emSize}},{key:"getUnits",value:function(){return this.getString().replace(/[0-9.-]/g,"")}},{key:"getPixels",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasValue())return 0;var i="boolean"==typeof t?[void 0,t]:[t],r=C.default(i,2),n=r[0],a=r[1],o=this.document.screen.viewPort;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(o.computeSize("x"),o.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(o.computeSize("x"),o.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*o.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*o.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return 15*this.getNumber();case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case this.isString(/%$/)&&a:return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*o.computeSize(n);default:var l=this.getNumber();return e&&l<1?l*o.computeSize(n):l}}},{key:"getMilliseconds",value:function(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():1e3*this.getNumber():0}},{key:"getRadians",value:function(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}},{key:"getDefinition",value:function(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}},{key:"getFillStyleDefinition",value:function(t,e){var i=this.getDefinition();if(!i)return null;if("function"==typeof i.createGradient)return i.createGradient(this.document.ctx,t,e);if("function"==typeof i.createPattern){if(i.getHrefAttribute().hasValue()){var r=i.getAttribute("patternTransform");i=i.getHrefAttribute().getDefinition(),r.hasValue()&&i.getAttribute("patternTransform",!0).setValue(r.value)}return i.createPattern(this.document.ctx,t,e)}return null}},{key:"getTextBaseline",value:function(){return this.hasValue()?t.textBaselineMapping[this.getString()]:null}},{key:"addOpacity",value:function(e){for(var i=this.getColor(),r=i.length,n=0,a=0;a<r&&(","===i[a]&&n++,3!==n);a++);if(e.hasValue()&&this.isString()&&3!==n){var o=new A.default(i);o.ok&&(o.alpha=e.getNumber(),i=o.toRGBA())}return new t(this.document,this.name,i)}}],[{key:"empty",value:function(e){return new t(e,"EMPTY","")}}]),t}();gt.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};var yt=function(){function t(){M.default(this,t),this.viewPorts=[]}return T.default(t,[{key:"clear",value:function(){this.viewPorts=[]}},{key:"setCurrent",value:function(t,e){this.viewPorts.push({width:t,height:e})}},{key:"removeCurrent",value:function(){this.viewPorts.pop()}},{key:"getCurrent",value:function(){var t=this.viewPorts;return t[t.length-1]}},{key:"computeSize",value:function(t){return"number"==typeof t?t:"x"===t?this.width:"y"===t?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},{key:"width",get:function(){return this.getCurrent().width}},{key:"height",get:function(){return this.getCurrent().height}}]),t}(),_t=function(){function t(e,i){M.default(this,t),this.x=e,this.y=i}return T.default(t,[{key:"angleTo",value:function(t){return Math.atan2(t.y-this.y,t.x-this.x)}},{key:"applyTransform",value:function(t){var e=this.x,i=this.y,r=e*t[0]+i*t[2]+t[4],n=e*t[1]+i*t[3]+t[5];this.x=r,this.y=n}}],[{key:"parse",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=V(e),n=C.default(r,2),a=n[0],o=void 0===a?i:a,l=n[1];return new t(o,void 0===l?i:l)}},{key:"parseScale",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=V(e),n=C.default(r,2),a=n[0],o=void 0===a?i:a,l=n[1];return new t(o,void 0===l?o:l)}},{key:"parsePath",value:function(e){for(var i=V(e),r=i.length,n=[],a=0;a<r;a+=2)n.push(new t(i[a],i[a+1]));return n}}]),t}(),vt=function(){function t(e){M.default(this,t),this.screen=e,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}return T.default(t,[{key:"isWorking",value:function(){return this.working}},{key:"start",value:function(){if(!this.working){var t=this.screen,e=this.onClick,i=this.onMouseMove,r=t.ctx.canvas;r.onclick=e,r.onmousemove=i,this.working=!0}}},{key:"stop",value:function(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}},{key:"hasEvents",value:function(){return this.working&&this.events.length>0}},{key:"runEvents",value:function(){if(this.working){var t=this.screen,e=this.events,i=this.eventElements,r=t.ctx.canvas.style;r&&(r.cursor=""),e.forEach((function(t,e){for(var r=t.run,n=i[e];n;)r(n),n=n.parent})),this.events=[],this.eventElements=[]}}},{key:"checkPath",value:function(t,e){if(this.working&&e){var i=this.events,r=this.eventElements;i.forEach((function(i,n){var a=i.x,o=i.y;!r[n]&&e.isPointInPath&&e.isPointInPath(a,o)&&(r[n]=t)}))}}},{key:"checkBoundingBox",value:function(t,e){if(this.working&&e){var i=this.events,r=this.eventElements;i.forEach((function(i,n){var a=i.x,o=i.y;!r[n]&&e.isPointInBox(a,o)&&(r[n]=t)}))}}},{key:"mapXY",value:function(t,e){for(var i=this.screen,r=i.window,n=i.ctx,a=new _t(t,e),o=n.canvas;o;)a.x-=o.offsetLeft,a.y-=o.offsetTop,o=o.offsetParent;return r.scrollX&&(a.x+=r.scrollX),r.scrollY&&(a.y+=r.scrollY),a}},{key:"onClick",value:function(t){var e=this.mapXY(t.clientX,t.clientY),i=e.x,r=e.y;this.events.push({type:"onclick",x:i,y:r,run:function(t){t.onClick&&t.onClick()}})}},{key:"onMouseMove",value:function(t){var e=this.mapXY(t.clientX,t.clientY),i=e.x,r=e.y;this.events.push({type:"onmousemove",x:i,y:r,run:function(t){t.onMouseMove&&t.onMouseMove()}})}}]),t}(),Ct="undefined"!=typeof window?window:null,St="undefined"!=typeof fetch?fetch.bind(void 0):null,Mt=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.fetch,n=void 0===r?St:r,a=i.window,o=void 0===a?Ct:a;M.default(this,t),this.ctx=e,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new yt,this.mouse=new vt(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=o,this.fetch=n}return T.default(t,[{key:"wait",value:function(t){this.waits.push(t)}},{key:"ready",value:function(){return this.readyPromise?this.readyPromise:Promise.resolve()}},{key:"isReady",value:function(){if(this.isReadyLock)return!0;var t=this.waits.every((function(t){return t()}));return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}},{key:"setDefaults",value:function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}},{key:"setViewBox",value:function(t){var e=t.document,i=t.ctx,r=t.aspectRatio,n=t.width,a=t.desiredWidth,o=t.height,l=t.desiredHeight,c=t.minX,u=void 0===c?0:c,h=t.minY,p=void 0===h?0:h,d=t.refX,f=t.refY,m=t.clip,g=void 0!==m&&m,y=t.clipX,_=void 0===y?0:y,v=t.clipY,x=void 0===v?0:v,b=j(r).replace(/^defer\s/,"").split(" "),w=C.default(b,2),S=w[0]||"xMidYMid",M=w[1]||"meet",T=n/a,E=o/l,A=Math.min(T,E),I=Math.max(T,E),P=a,O=l;"meet"===M&&(P*=A,O*=A),"slice"===M&&(P*=I,O*=I);var k=new gt(e,"refX",d),D=new gt(e,"refY",f),F=k.hasValue()&&D.hasValue();if(F&&i.translate(-A*k.getPixels("x"),-A*D.getPixels("y")),g){var z=A*_,N=A*x;i.beginPath(),i.moveTo(z,N),i.lineTo(n,N),i.lineTo(n,o),i.lineTo(z,o),i.closePath(),i.clip()}if(!F){var B="meet"===M&&A===E,V="slice"===M&&I===E,U="meet"===M&&A===T,H="slice"===M&&I===T;S.startsWith("xMid")&&(B||V)&&i.translate(n/2-P/2,0),S.endsWith("YMid")&&(U||H)&&i.translate(0,o/2-O/2),S.startsWith("xMax")&&(B||V)&&i.translate(n-P,0),S.endsWith("YMax")&&(U||H)&&i.translate(0,o-O)}switch(!0){case"none"===S:i.scale(T,E);break;case"meet"===M:i.scale(A,A);break;case"slice"===M:i.scale(I,I)}i.translate(-u,-p)}},{key:"start",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.enableRedraw,n=void 0!==r&&r,a=i.ignoreMouse,o=void 0!==a&&a,l=i.ignoreAnimation,c=void 0!==l&&l,u=i.ignoreDimensions,h=void 0!==u&&u,p=i.ignoreClear,d=void 0!==p&&p,f=i.forceRedraw,m=i.scaleWidth,g=i.scaleHeight,y=i.offsetX,_=i.offsetY,v=this.FRAMERATE,x=this.mouse,b=1e3/v;if(this.frameDuration=b,this.readyPromise=new Promise((function(t){e.resolveReady=t})),this.isReady()&&this.render(t,h,d,m,g,y,_),n){var w=Date.now(),C=w,S=0;o||x.start(),this.intervalId=E.default((function i(){w=Date.now(),(S=w-C)>=b&&(C=w-S%b,e.shouldUpdate(c,f)&&(e.render(t,h,d,m,g,y,_),x.runEvents())),e.intervalId=E.default(i)}))}}},{key:"stop",value:function(){this.intervalId&&(E.default.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}},{key:"shouldUpdate",value:function(t,e){if(!t){var i=this.frameDuration;if(this.animations.reduce((function(t,e){return e.update(i)||t}),!1))return!0}return!("function"!=typeof e||!e())||!(this.isReadyLock||!this.isReady())||!!this.mouse.hasEvents()}},{key:"render",value:function(t,e,i,r,n,a,o){var l=this.CLIENT_WIDTH,c=this.CLIENT_HEIGHT,u=this.viewPort,h=this.ctx,p=this.isFirstRender,d=h.canvas;u.clear(),d.width&&d.height?u.setCurrent(d.width,d.height):u.setCurrent(l,c);var f=t.getStyle("width"),m=t.getStyle("height");!e&&(p||"number"!=typeof r&&"number"!=typeof n)&&(f.hasValue()&&(d.width=f.getPixels("x"),d.style&&(d.style.width="".concat(d.width,"px"))),m.hasValue()&&(d.height=m.getPixels("y"),d.style&&(d.style.height="".concat(d.height,"px"))));var g=d.clientWidth||d.width,y=d.clientHeight||d.height;if(e&&f.hasValue()&&m.hasValue()&&(g=f.getPixels("x"),y=m.getPixels("y")),u.setCurrent(g,y),"number"==typeof a&&t.getAttribute("x",!0).setValue(a),"number"==typeof o&&t.getAttribute("y",!0).setValue(o),"number"==typeof r||"number"==typeof n){var _=V(t.getAttribute("viewBox").getString()),v=0,x=0;if("number"==typeof r){var b=t.getStyle("width");b.hasValue()?v=b.getPixels("x")/r:isNaN(_[2])||(v=_[2]/r)}if("number"==typeof n){var w=t.getStyle("height");w.hasValue()?x=w.getPixels("y")/n:isNaN(_[3])||(x=_[3]/n)}v||(v=x),x||(x=v),t.getAttribute("width",!0).setValue(r),t.getAttribute("height",!0).setValue(n);var C=t.getStyle("transform",!0,!0);C.setValue("".concat(C.getString()," scale(").concat(1/v,", ").concat(1/x,")"))}i||h.clearRect(0,0,g,y),t.render(h),p&&(this.isFirstRender=!1)}}]),t}();Mt.defaultWindow=Ct,Mt.defaultFetch=St;var Tt=Mt.defaultFetch,Et="undefined"!=typeof DOMParser?DOMParser:null,At=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.fetch,r=void 0===i?Tt:i,n=e.DOMParser,a=void 0===n?Et:n;M.default(this,t),this.fetch=r,this.DOMParser=a}var e,i;return T.default(t,[{key:"parse",value:(i=w.default(b.default.mark((function t(e){return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.startsWith("<")){t.next=2;break}return t.abrupt("return",this.parseFromString(e));case 2:return t.abrupt("return",this.load(e));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"parseFromString",value:function(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch(i){return this.checkDocument(e.parseFromString(t,"text/xml"))}}},{key:"checkDocument",value:function(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}},{key:"load",value:(e=w.default(b.default.mark((function t(e){var i,r;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(e);case 2:return i=t.sent,t.next=5,i.text();case 5:return r=t.sent,t.abrupt("return",this.parseFromString(r));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),It=function(){function t(e,i){M.default(this,t),this.type="translate",this.point=null,this.point=_t.parse(i)}return T.default(t,[{key:"apply",value:function(t){var e=this.point,i=e.x,r=e.y;t.translate(i||0,r||0)}},{key:"unapply",value:function(t){var e=this.point,i=e.x,r=e.y;t.translate(-1*i||0,-1*r||0)}},{key:"applyToPoint",value:function(t){var e=this.point,i=e.x,r=e.y;t.applyTransform([1,0,0,1,i||0,r||0])}}]),t}(),Lt=function(){function t(e,i,r){M.default(this,t),this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var n=V(i);this.angle=new gt(e,"angle",n[0]),this.originX=r[0],this.originY=r[1],this.cx=n[1]||0,this.cy=n[2]||0}return T.default(t,[{key:"apply",value:function(t){var e=this.cx,i=this.cy,r=this.originX,n=this.originY,a=this.angle,o=e+r.getPixels("x"),l=i+n.getPixels("y");t.translate(o,l),t.rotate(a.getRadians()),t.translate(-o,-l)}},{key:"unapply",value:function(t){var e=this.cx,i=this.cy,r=this.originX,n=this.originY,a=this.angle,o=e+r.getPixels("x"),l=i+n.getPixels("y");t.translate(o,l),t.rotate(-1*a.getRadians()),t.translate(-o,-l)}},{key:"applyToPoint",value:function(t){var e=this.cx,i=this.cy,r=this.angle.getRadians();t.applyTransform([1,0,0,1,e||0,i||0]),t.applyTransform([Math.cos(r),Math.sin(r),-Math.sin(r),Math.cos(r),0,0]),t.applyTransform([1,0,0,1,-e||0,-i||0])}}]),t}(),Pt=function(){function t(e,i,r){M.default(this,t),this.type="scale",this.scale=null,this.originX=null,this.originY=null;var n=_t.parseScale(i);0!==n.x&&0!==n.y||(n.x=it,n.y=it),this.scale=n,this.originX=r[0],this.originY=r[1]}return T.default(t,[{key:"apply",value:function(t){var e=this.scale,i=e.x,r=e.y,n=this.originX,a=this.originY,o=n.getPixels("x"),l=a.getPixels("y");t.translate(o,l),t.scale(i,r||i),t.translate(-o,-l)}},{key:"unapply",value:function(t){var e=this.scale,i=e.x,r=e.y,n=this.originX,a=this.originY,o=n.getPixels("x"),l=a.getPixels("y");t.translate(o,l),t.scale(1/i,1/r||i),t.translate(-o,-l)}},{key:"applyToPoint",value:function(t){var e=this.scale,i=e.x,r=e.y;t.applyTransform([i||0,0,0,r||0,0,0])}}]),t}(),Ot=function(){function t(e,i,r){M.default(this,t),this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=V(i),this.originX=r[0],this.originY=r[1]}return T.default(t,[{key:"apply",value:function(t){var e=this.originX,i=this.originY,r=this.matrix,n=e.getPixels("x"),a=i.getPixels("y");t.translate(n,a),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),t.translate(-n,-a)}},{key:"unapply",value:function(t){var e=this.originX,i=this.originY,r=this.matrix,n=r[0],a=r[2],o=r[4],l=r[1],c=r[3],u=r[5],h=1/(n*(1*c-0*u)-a*(1*l-0*u)+o*(0*l-0*c)),p=e.getPixels("x"),d=i.getPixels("y");t.translate(p,d),t.transform(h*(1*c-0*u),h*(0*u-1*l),h*(0*o-1*a),h*(1*n-0*o),h*(a*u-o*c),h*(o*l-n*u)),t.translate(-p,-d)}},{key:"applyToPoint",value:function(t){t.applyTransform(this.matrix)}}]),t}();var kt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="skew",a.angle=null,a.angle=new gt(t,"angle",e),a}return n}(Ot);var Dt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="skewX",a.matrix=[1,0,Math.tan(a.angle.getRadians()),1,0,0],a}return n}(kt);var Ft=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="skewY",a.matrix=[1,Math.tan(a.angle.getRadians()),0,1,0,0],a}return n}(kt),zt=function(){function t(e,i,r){var n=this;M.default(this,t),this.document=e,this.transforms=[];var a=function(t){return j(t).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}(i);a.forEach((function(e){if("none"!==e){var i=function(t){var e=t.split("("),i=C.default(e,2),r=i[0],n=i[1];return[r.trim(),n.trim().replace(")","")]}(e),a=C.default(i,2),o=a[0],l=a[1],c=t.transformTypes[o];void 0!==c&&n.transforms.push(new c(n.document,l,r))}}))}return T.default(t,[{key:"apply",value:function(t){for(var e=this.transforms,i=e.length,r=0;r<i;r++)e[r].apply(t)}},{key:"unapply",value:function(t){for(var e=this.transforms,i=e.length-1;i>=0;i--)e[i].unapply(t)}},{key:"applyToPoint",value:function(t){for(var e=this.transforms,i=e.length,r=0;r<i;r++)e[r].applyToPoint(t)}}],[{key:"fromElement",value:function(e,i){var r=i.getStyle("transform",!1,!0),n=i.getStyle("transform-origin",!1,!0).split(),a=C.default(n,2),o=a[0],l=a[1],c=[o,void 0===l?o:l];return r.hasValue()?new t(e,r.getString(),c):null}}]),t}();zt.transformTypes={translate:It,rotate:Lt,scale:Pt,matrix:Ot,skewX:Dt,skewY:Ft};var Rt=function(){function t(e,i){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(M.default(this,t),this.document=e,this.node=i,this.captureTextNodes=n,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],i&&1===i.nodeType){Array.from(i.attributes).forEach((function(t){var i=H(t.nodeName);r.attributes[i]=new gt(e,i,t.value)})),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()&&this.getAttribute("style").getString().split(";").map((function(t){return t.trim()})).forEach((function(t){if(t){var i=t.split(":").map((function(t){return t.trim()})),n=C.default(i,2),a=n[0],o=n[1];r.styles[a]=new gt(e,a,o)}}));var a=e.definitions,o=this.getAttribute("id");o.hasValue()&&(a[o.getString()]||(a[o.getString()]=this)),Array.from(i.childNodes).forEach((function(t){if(1===t.nodeType)r.addChild(t);else if(n&&(3===t.nodeType||4===t.nodeType)){var i=e.createTextNode(t);i.getText().length>0&&r.addChild(i)}}))}}return T.default(t,[{key:"getAttribute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.attributes[t];if(!i&&e){var r=new gt(this.document,t,"");return this.attributes[t]=r,r}return i||gt.empty(this.document)}},{key:"getHrefAttribute",value:function(){for(var t in this.attributes)if("href"===t||t.endsWith(":href"))return this.attributes[t];return gt.empty(this.document)}},{key:"getStyle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.styles[t];if(r)return r;var n=this.getAttribute(t);if(null!=n&&n.hasValue())return this.styles[t]=n,n;if(!i){var a=this.parent;if(a){var o=a.getStyle(t);if(null!=o&&o.hasValue())return o}}if(e){var l=new gt(this.document,t,"");return this.styles[t]=l,l}return r||gt.empty(this.document)}},{key:"render",value:function(t){if("none"!==this.getStyle("display").getString()&&"hidden"!==this.getStyle("visibility").getString()){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if("none"!==this.getStyle("filter").getValue("none")){var i=this.getStyle("filter").getDefinition();i&&(this.applyEffects(t),i.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}},{key:"setContext",value:function(t){}},{key:"applyEffects",value:function(t){var e=zt.fromElement(this.document,this);e&&e.apply(t);var i=this.getStyle("clip-path",!1,!0);if(i.hasValue()){var r=i.getDefinition();r&&r.apply(t)}}},{key:"clearContext",value:function(t){}},{key:"renderChildren",value:function(t){this.children.forEach((function(e){e.render(t)}))}},{key:"addChild",value:function(e){var i=e instanceof t?e:this.document.createElement(e);i.parent=this,t.ignoreChildTypes.includes(i.type)||this.children.push(i)}},{key:"matchesSelector",value:function(t){var e=this.node;if("function"==typeof e.matches)return e.matches(t);var i=e.getAttribute("class");return!(!i||""===i)&&i.split(" ").some((function(e){return".".concat(e)===t}))}},{key:"addStylesFromStyleDefinition",value:function(){var t=this.document,e=t.styles,i=t.stylesSpecificity;for(var r in e)if(!r.startsWith("@")&&this.matchesSelector(r)){var n=e[r],a=i[r];if(n)for(var o in n){var l=this.stylesSpecificity[o];void 0===l&&(l="000"),a>=l&&(this.styles[o]=n[o],this.stylesSpecificity[o]=a)}}}},{key:"removeStyles",value:function(t,e){return e.reduce((function(e,i){var r=t.getStyle(i);if(!r.hasValue())return e;var n=r.getString();return r.setValue(""),[].concat(k.default(e),[[i,n]])}),[])}},{key:"restoreStyles",value:function(t,e){e.forEach((function(e){var i=C.default(e,2),r=i[0],n=i[1];t.getStyle(r,!0).setValue(n)}))}}]),t}();Rt.ignoreChildTypes=["title"];var jt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){return M.default(this,n),r.call(this,t,e,i)}return n}(Rt);function Nt(t){var e=t.trim();return/^('|")/.test(e)?e:'"'.concat(e,'"')}function Bt(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return e;default:return/^oblique\s+(-|)\d+deg$/.test(e)?e:""}}function Vt(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return e;default:return/^[\d.]+$/.test(e)?e:""}}var Ut=function(){function e(t,i,r,n,a,o){M.default(this,e);var l=o?"string"==typeof o?e.parse(o):o:{};this.fontFamily=a||l.fontFamily,this.fontSize=n||l.fontSize,this.fontStyle=t||l.fontStyle,this.fontWeight=r||l.fontWeight,this.fontVariant=i||l.fontVariant}return T.default(e,[{key:"toString",value:function(){return[Bt(this.fontStyle),this.fontVariant,Vt(this.fontWeight),this.fontSize,(e=this.fontFamily,void 0===t?e:e.trim().split(",").map(Nt).join(","))].join(" ").trim();var e}}],[{key:"parse",value:function(){var t=arguments.length>1?arguments[1]:void 0,i="",r="",n="",a="",o="",l=j(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().split(" "),c={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return l.forEach((function(t){switch(!0){case!c.fontStyle&&e.styles.includes(t):"inherit"!==t&&(i=t),c.fontStyle=!0;break;case!c.fontVariant&&e.variants.includes(t):"inherit"!==t&&(r=t),c.fontStyle=!0,c.fontVariant=!0;break;case!c.fontWeight&&e.weights.includes(t):"inherit"!==t&&(n=t),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0;break;case!c.fontSize:if("inherit"!==t){var l=t.split("/"),u=C.default(l,1);a=u[0]}c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0,c.fontSize=!0;break;default:"inherit"!==t&&(o+=t)}})),new e(i,r,n,a,o,t)}}]),e}();Ut.styles="normal|italic|oblique|inherit",Ut.variants="normal|small-caps|inherit",Ut.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";var Ht=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.NaN,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.NaN,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.NaN,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.NaN;M.default(this,t),this.x1=e,this.y1=i,this.x2=r,this.y2=n,this.addPoint(e,i),this.addPoint(r,n)}return T.default(t,[{key:"addPoint",value:function(t,e){void 0!==t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),void 0!==e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}},{key:"addX",value:function(t){this.addPoint(t,null)}},{key:"addY",value:function(t){this.addPoint(null,t)}},{key:"addBoundingBox",value:function(t){if(t){var e=t.x1,i=t.y1,r=t.x2,n=t.y2;this.addPoint(e,i),this.addPoint(r,n)}}},{key:"sumCubic",value:function(t,e,i,r,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*i+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*n}},{key:"bezierCurveAdd",value:function(t,e,i,r,n){var a=6*e-12*i+6*r,o=-3*e+9*i-9*r+3*n,l=3*i-3*e;if(0!==o){var c=Math.pow(a,2)-4*l*o;if(!(c<0)){var u=(-a+Math.sqrt(c))/(2*o);0<u&&u<1&&(t?this.addX(this.sumCubic(u,e,i,r,n)):this.addY(this.sumCubic(u,e,i,r,n)));var h=(-a-Math.sqrt(c))/(2*o);0<h&&h<1&&(t?this.addX(this.sumCubic(h,e,i,r,n)):this.addY(this.sumCubic(h,e,i,r,n)))}}else{if(0===a)return;var p=-l/a;0<p&&p<1&&(t?this.addX(this.sumCubic(p,e,i,r,n)):this.addY(this.sumCubic(p,e,i,r,n)))}}},{key:"addBezierCurve",value:function(t,e,i,r,n,a,o,l){this.addPoint(t,e),this.addPoint(o,l),this.bezierCurveAdd(!0,t,i,n,o),this.bezierCurveAdd(!1,e,r,a,l)}},{key:"addQuadraticCurve",value:function(t,e,i,r,n,a){var o=t+2/3*(i-t),l=e+2/3*(r-e),c=o+1/3*(n-t),u=l+1/3*(a-e);this.addBezierCurve(t,e,o,c,l,u,n,a)}},{key:"isPointInBox",value:function(t,e){var i=this.x1,r=this.y1,n=this.x2,a=this.y2;return i<=t&&t<=n&&r<=e&&e<=a}},{key:"x",get:function(){return this.x1}},{key:"y",get:function(){return this.y1}},{key:"width",get:function(){return this.x2-this.x1}},{key:"height",get:function(){return this.y2-this.y1}}]),t}();var qt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t){var e;return M.default(this,n),(e=r.call(this,t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,""))).control=null,e.start=null,e.current=null,e.command=null,e.commands=e.commands,e.i=-1,e.previousCommand=null,e.points=[],e.angles=[],e}return T.default(n,[{key:"reset",value:function(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new _t(0,0),this.control=new _t(0,0),this.current=new _t(0,0),this.points=[],this.angles=[]}},{key:"isEnd",value:function(){return this.i>=this.commands.length-1}},{key:"next",value:function(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}},{key:"getPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y",i=new _t(this.command[t],this.command[e]);return this.makeAbsolute(i)}},{key:"getAsControlPoint",value:function(t,e){var i=this.getPoint(t,e);return this.control=i,i}},{key:"getAsCurrentPoint",value:function(t,e){var i=this.getPoint(t,e);return this.current=i,i}},{key:"getReflectedControlPoint",value:function(){var t=this.previousCommand.type;if(t!==y.SVGPathData.CURVE_TO&&t!==y.SVGPathData.SMOOTH_CURVE_TO&&t!==y.SVGPathData.QUAD_TO&&t!==y.SVGPathData.SMOOTH_QUAD_TO)return this.current;var e=this.current,i=e.x,r=e.y,n=this.control,a=n.x,o=n.y;return new _t(2*i-a,2*r-o)}},{key:"makeAbsolute",value:function(t){if(this.command.relative){var e=this.current,i=e.x,r=e.y;t.x+=i,t.y+=r}return t}},{key:"addMarker",value:function(t,e,i){var r=this.points,n=this.angles;i&&n.length>0&&!n[n.length-1]&&(n[n.length-1]=r[r.length-1].angleTo(i)),this.addMarkerAngle(t,e?e.angleTo(t):null)}},{key:"addMarkerAngle",value:function(t,e){this.points.push(t),this.angles.push(e)}},{key:"getMarkerPoints",value:function(){return this.points}},{key:"getMarkerAngles",value:function(){for(var t=this.angles,e=t.length,i=0;i<e;i++)if(!t[i])for(var r=i+1;r<e;r++)if(t[r]){t[i]=t[r];break}return t}}]),n}(y.SVGPathData);var Zt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).modifiedEmSizeStack=!1,t}return T.default(n,[{key:"calculateOpacity",value:function(){for(var t=1,e=this;e;){var i=e.getStyle("opacity",!1,!0);i.hasValue(!0)&&(t*=i.getNumber()),e=e.parent}return t}},{key:"setContext",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e){var i=this.getStyle("fill"),r=this.getStyle("fill-opacity"),n=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(i.isUrlDefinition()){var o=i.getFillStyleDefinition(this,r);o&&(t.fillStyle=o)}else if(i.hasValue()){"currentColor"===i.getString()&&i.setValue(this.getStyle("color").getColor());var l=i.getColor();"inherit"!==l&&(t.fillStyle="none"===l?"rgba(0,0,0,0)":l)}if(r.hasValue()){var c=new gt(this.document,"fill",t.fillStyle).addOpacity(r).getColor();t.fillStyle=c}if(n.isUrlDefinition()){var u=n.getFillStyleDefinition(this,a);u&&(t.strokeStyle=u)}else if(n.hasValue()){"currentColor"===n.getString()&&n.setValue(this.getStyle("color").getColor());var h=n.getString();"inherit"!==h&&(t.strokeStyle="none"===h?"rgba(0,0,0,0)":h)}if(a.hasValue()){var p=new gt(this.document,"stroke",t.strokeStyle).addOpacity(a).getString();t.strokeStyle=p}var d=this.getStyle("stroke-width");if(d.hasValue()){var f=d.getPixels();t.lineWidth=f||it}var m=this.getStyle("stroke-linecap"),g=this.getStyle("stroke-linejoin"),y=this.getStyle("stroke-miterlimit"),_=this.getStyle("stroke-dasharray"),v=this.getStyle("stroke-dashoffset");if(m.hasValue()&&(t.lineCap=m.getString()),g.hasValue()&&(t.lineJoin=g.getString()),y.hasValue()&&(t.miterLimit=y.getNumber()),_.hasValue()&&"none"!==_.getString()){var x=V(_.getString());void 0!==t.setLineDash?t.setLineDash(x):void 0!==t.webkitLineDash?t.webkitLineDash=x:void 0===t.mozDash||1===x.length&&0===x[0]||(t.mozDash=x);var b=v.getPixels();void 0!==t.lineDashOffset?t.lineDashOffset=b:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=b:void 0!==t.mozDashOffset&&(t.mozDashOffset=b)}}if(this.modifiedEmSizeStack=!1,void 0!==t.font){var w=this.getStyle("font"),C=this.getStyle("font-style"),S=this.getStyle("font-variant"),M=this.getStyle("font-weight"),T=this.getStyle("font-size"),E=this.getStyle("font-family"),A=new Ut(C.getString(),S.getString(),M.getString(),T.hasValue()?"".concat(T.getPixels(!0),"px"):"",E.getString(),Ut.parse(w.getString(),t.font));C.setValue(A.fontStyle),S.setValue(A.fontVariant),M.setValue(A.fontWeight),T.setValue(A.fontSize),E.setValue(A.fontFamily),t.font=A.toString(),T.isPixels()&&(this.document.emSize=T.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}},{key:"clearContext",value:function(t){D.default(O.default(n.prototype),"clearContext",this).call(this,t),this.modifiedEmSizeStack&&this.document.popEmSize()}}]),n}(Rt);var Gt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="path",a.pathParser=null,a.pathParser=new qt(a.getAttribute("d").getString()),a}return T.default(n,[{key:"path",value:function(t){var e=this.pathParser,i=new Ht;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case qt.MOVE_TO:this.pathM(t,i);break;case qt.LINE_TO:this.pathL(t,i);break;case qt.HORIZ_LINE_TO:this.pathH(t,i);break;case qt.VERT_LINE_TO:this.pathV(t,i);break;case qt.CURVE_TO:this.pathC(t,i);break;case qt.SMOOTH_CURVE_TO:this.pathS(t,i);break;case qt.QUAD_TO:this.pathQ(t,i);break;case qt.SMOOTH_QUAD_TO:this.pathT(t,i);break;case qt.ARC:this.pathA(t,i);break;case qt.CLOSE_PATH:this.pathZ(t,i)}return i}},{key:"getBoundingBox",value:function(t){return this.path()}},{key:"getMarkers",value:function(){var t=this.pathParser,e=t.getMarkerPoints(),i=t.getMarkerAngles();return e.map((function(t,e){return[t,i[e]]}))}},{key:"renderChildren",value:function(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");""!==t.fillStyle&&("inherit"!==e.getString("inherit")?t.fill(e.getString()):t.fill()),""!==t.strokeStyle&&("non-scaling-stroke"===this.getAttribute("vector-effect").getString()?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var i=this.getMarkers();if(i){var r=i.length-1,n=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(n.isUrlDefinition()){var l=n.getDefinition(),c=C.default(i[0],2),u=c[0],h=c[1];l.render(t,u,h)}if(a.isUrlDefinition())for(var p=a.getDefinition(),d=1;d<r;d++){var f=C.default(i[d],2),m=f[0],g=f[1];p.render(t,m,g)}if(o.isUrlDefinition()){var y=o.getDefinition(),_=C.default(i[r],2),v=_[0],x=_[1];y.render(t,v,x)}}}},{key:"pathM",value:function(t,e){var i=this.pathParser,r=n.pathM(i).point,a=r.x,o=r.y;i.addMarker(r),e.addPoint(a,o),t&&t.moveTo(a,o)}},{key:"pathL",value:function(t,e){var i=this.pathParser,r=n.pathL(i),a=r.current,o=r.point,l=o.x,c=o.y;i.addMarker(o,a),e.addPoint(l,c),t&&t.lineTo(l,c)}},{key:"pathH",value:function(t,e){var i=this.pathParser,r=n.pathH(i),a=r.current,o=r.point,l=o.x,c=o.y;i.addMarker(o,a),e.addPoint(l,c),t&&t.lineTo(l,c)}},{key:"pathV",value:function(t,e){var i=this.pathParser,r=n.pathV(i),a=r.current,o=r.point,l=o.x,c=o.y;i.addMarker(o,a),e.addPoint(l,c),t&&t.lineTo(l,c)}},{key:"pathC",value:function(t,e){var i=this.pathParser,r=n.pathC(i),a=r.current,o=r.point,l=r.controlPoint,c=r.currentPoint;i.addMarker(c,l,o),e.addBezierCurve(a.x,a.y,o.x,o.y,l.x,l.y,c.x,c.y),t&&t.bezierCurveTo(o.x,o.y,l.x,l.y,c.x,c.y)}},{key:"pathS",value:function(t,e){var i=this.pathParser,r=n.pathS(i),a=r.current,o=r.point,l=r.controlPoint,c=r.currentPoint;i.addMarker(c,l,o),e.addBezierCurve(a.x,a.y,o.x,o.y,l.x,l.y,c.x,c.y),t&&t.bezierCurveTo(o.x,o.y,l.x,l.y,c.x,c.y)}},{key:"pathQ",value:function(t,e){var i=this.pathParser,r=n.pathQ(i),a=r.current,o=r.controlPoint,l=r.currentPoint;i.addMarker(l,o,o),e.addQuadraticCurve(a.x,a.y,o.x,o.y,l.x,l.y),t&&t.quadraticCurveTo(o.x,o.y,l.x,l.y)}},{key:"pathT",value:function(t,e){var i=this.pathParser,r=n.pathT(i),a=r.current,o=r.controlPoint,l=r.currentPoint;i.addMarker(l,o,o),e.addQuadraticCurve(a.x,a.y,o.x,o.y,l.x,l.y),t&&t.quadraticCurveTo(o.x,o.y,l.x,l.y)}},{key:"pathA",value:function(t,e){var i=this.pathParser,r=n.pathA(i),a=r.currentPoint,o=r.rX,l=r.rY,c=r.sweepFlag,u=r.xAxisRotation,h=r.centp,p=r.a1,d=r.ad,f=1-c?1:-1,m=p+f*(d/2),g=new _t(h.x+o*Math.cos(m),h.y+l*Math.sin(m));if(i.addMarkerAngle(g,m-f*Math.PI/2),i.addMarkerAngle(a,m-f*Math.PI),e.addPoint(a.x,a.y),t&&!isNaN(p)&&!isNaN(d)){var y=o>l?o:l,_=o>l?1:o/l,v=o>l?l/o:1;t.translate(h.x,h.y),t.rotate(u),t.scale(_,v),t.arc(0,0,y,p,p+d,Boolean(1-c)),t.scale(1/_,1/v),t.rotate(-u),t.translate(-h.x,-h.y)}}},{key:"pathZ",value:function(t,e){n.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}}],[{key:"pathM",value:function(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}},{key:"pathL",value:function(t){return{current:t.current,point:t.getAsCurrentPoint()}}},{key:"pathH",value:function(t){var e=t.current,i=t.command,r=new _t((i.relative?e.x:0)+i.x,e.y);return t.current=r,{current:e,point:r}}},{key:"pathV",value:function(t){var e=t.current,i=t.command,r=new _t(e.x,(i.relative?e.y:0)+i.y);return t.current=r,{current:e,point:r}}},{key:"pathC",value:function(t){return{current:t.current,point:t.getPoint("x1","y1"),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathS",value:function(t){return{current:t.current,point:t.getReflectedControlPoint(),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathQ",value:function(t){return{current:t.current,controlPoint:t.getAsControlPoint("x1","y1"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathT",value:function(t){var e=t.current,i=t.getReflectedControlPoint();return t.control=i,{current:e,controlPoint:i,currentPoint:t.getAsCurrentPoint()}}},{key:"pathA",value:function(t){var e=t.current,i=t.command,r=i.rX,n=i.rY,a=i.xRot,o=i.lArcFlag,l=i.sweepFlag,c=a*(Math.PI/180),u=t.getAsCurrentPoint(),h=new _t(Math.cos(c)*(e.x-u.x)/2+Math.sin(c)*(e.y-u.y)/2,-Math.sin(c)*(e.x-u.x)/2+Math.cos(c)*(e.y-u.y)/2),p=Math.pow(h.x,2)/Math.pow(r,2)+Math.pow(h.y,2)/Math.pow(n,2);p>1&&(r*=Math.sqrt(p),n*=Math.sqrt(p));var d=(o===l?-1:1)*Math.sqrt((Math.pow(r,2)*Math.pow(n,2)-Math.pow(r,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(r,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)));isNaN(d)&&(d=0);var f=new _t(d*r*h.y/n,d*-n*h.x/r),m=new _t((e.x+u.x)/2+Math.cos(c)*f.x-Math.sin(c)*f.y,(e.y+u.y)/2+Math.sin(c)*f.x+Math.cos(c)*f.y),g=lt([1,0],[(h.x-f.x)/r,(h.y-f.y)/n]),y=[(h.x-f.x)/r,(h.y-f.y)/n],_=[(-h.x-f.x)/r,(-h.y-f.y)/n],v=lt(y,_);return ot(y,_)<=-1&&(v=Math.PI),ot(y,_)>=1&&(v=0),{currentPoint:u,rX:r,rY:n,sweepFlag:l,xAxisRotation:c,centp:m,a1:g,ad:v}}},{key:"pathZ",value:function(t){t.current=t.start}}]),n}(Zt);var $t=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="glyph",a.horizAdvX=a.getAttribute("horiz-adv-x").getNumber(),a.unicode=a.getAttribute("unicode").getString(),a.arabicForm=a.getAttribute("arabic-form").getString(),a}return n}(Gt);var Wt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,(this instanceof n?this.constructor:void 0)===n||i)).type="text",a.x=0,a.y=0,a.measureCache=-1,a}return T.default(n,[{key:"setContext",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];D.default(O.default(n.prototype),"setContext",this).call(this,t,e);var i=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();i&&(t.textBaseline=i)}},{key:"initializeCoordinates",value:function(t){this.x=this.getAttribute("x").getPixels("x"),this.y=this.getAttribute("y").getPixels("y");var e=this.getAttribute("dx"),i=this.getAttribute("dy");e.hasValue()&&(this.x+=e.getPixels("x")),i.hasValue()&&(this.y+=i.getPixels("y")),this.x+=this.getAnchorDelta(t,this,0)}},{key:"getBoundingBox",value:function(t){var e=this;if("text"!==this.type)return this.getTElementBoundingBox(t);this.initializeCoordinates(t);var i=null;return this.children.forEach((function(r,n){var a=e.getChildBoundingBox(t,e,e,n);i?i.addBoundingBox(a):i=a})),i}},{key:"getFontSize",value:function(){var t=this.document,e=this.parent,i=Ut.parse(t.ctx.font).fontSize;return e.getStyle("font-size").getNumber(i)}},{key:"getTElementBoundingBox",value:function(t){var e=this.getFontSize();return new Ht(this.x,this.y-e,this.x+this.measureText(t),this.y)}},{key:"getGlyph",value:function(t,e,i){var r=e[i],n=null;if(t.isArabic){var a=e.length,o=e[i-1],l=e[i+1],c="isolated";if((0===i||" "===o)&&i<a-2&&" "!==l&&(c="terminal"),i>0&&" "!==o&&i<a-2&&" "!==l&&(c="medial"),i>0&&" "!==o&&(i===a-1||" "===l)&&(c="initial"),void 0!==t.glyphs[r]){var u=t.glyphs[r];n=u instanceof $t?u:u[c]}}else n=t.glyphs[r];return n||(n=t.missingGlyph),n}},{key:"getText",value:function(){return""}},{key:"getTextFromNode",value:function(t){var e=t||this.node,i=Array.from(e.parentNode.childNodes),r=i.indexOf(e),n=i.length-1,a=j(e.textContent||"");return 0===r&&(a=N(a)),r===n&&(a=B(a)),a}},{key:"renderChildren",value:function(t){var e=this;if("text"===this.type){this.initializeCoordinates(t),this.children.forEach((function(i,r){e.renderChild(t,e,e,r)}));var i=this.document.screen.mouse;i.isWorking()&&i.checkBoundingBox(this,this.getBoundingBox(t))}else this.renderTElementChildren(t)}},{key:"renderTElementChildren",value:function(t){var e=this.document,i=this.parent,r=this.getText(),n=i.getStyle("font-family").getDefinition();if(n)for(var a=n.fontFace.unitsPerEm,o=Ut.parse(e.ctx.font),l=i.getStyle("font-size").getNumber(o.fontSize),c=i.getStyle("font-style").getString(o.fontStyle),u=l/a,h=n.isRTL?r.split("").reverse().join(""):r,p=V(i.getAttribute("dx").getString()),d=h.length,f=0;f<d;f++){var m=this.getGlyph(n,h,f);t.translate(this.x,this.y),t.scale(u,-u);var g=t.lineWidth;t.lineWidth=t.lineWidth*a/l,"italic"===c&&t.transform(1,0,.4,1,0,0),m.render(t),"italic"===c&&t.transform(1,0,-.4,1,0,0),t.lineWidth=g,t.scale(1/u,-1/u),t.translate(-this.x,-this.y),this.x+=l*(m.horizAdvX||n.horizAdvX)/a,void 0===p[f]||isNaN(p[f])||(this.x+=p[f])}else{var y=this.x,_=this.y;t.fillStyle&&t.fillText(r,y,_),t.strokeStyle&&t.strokeText(r,y,_)}}},{key:"getAnchorDelta",value:function(t,e,i){var r=this.getStyle("text-anchor").getString("start");if("start"!==r){for(var n=e.children,a=n.length,o=null,l=0,c=i;c<a&&(o=n[c],!(c>i&&o.getAttribute("x").hasValue()||o.getAttribute("text-anchor").hasValue()));c++)l+=o.measureTextRecursive(t);return-1*("end"===r?l:l/2)}return 0}},{key:"adjustChildCoordinates",value:function(t,e,i,r){var n=i.children[r];if("function"!=typeof n.measureText)return n;t.save(),n.setContext(t,!0);var a=n.getAttribute("x"),o=n.getAttribute("y"),l=n.getAttribute("dx"),c=n.getAttribute("dy"),u=n.getAttribute("text-anchor").getString("start");if(0===r&&"textNode"!==n.type&&(a.hasValue()||a.setValue(e.getAttribute("x").getValue("0")),o.hasValue()||o.setValue(e.getAttribute("y").getValue("0")),l.hasValue()||l.setValue(e.getAttribute("dx").getValue("0")),c.hasValue()||c.setValue(e.getAttribute("dy").getValue("0"))),a.hasValue()){if(n.x=a.getPixels("x")+e.getAnchorDelta(t,i,r),"start"!==u){var h=n.measureTextRecursive(t);n.x+=-1*("end"===u?h:h/2)}l.hasValue()&&(n.x+=l.getPixels("x"))}else{if("start"!==u){var p=n.measureTextRecursive(t);e.x+=-1*("end"===u?p:p/2)}l.hasValue()&&(e.x+=l.getPixels("x")),n.x=e.x}return e.x=n.x+n.measureText(t),o.hasValue()?(n.y=o.getPixels("y"),c.hasValue()&&(n.y+=c.getPixels("y"))):(c.hasValue()&&(e.y+=c.getPixels("y")),n.y=e.y),e.y=n.y,n.clearContext(t),t.restore(),n}},{key:"getChildBoundingBox",value:function(t,e,i,r){var n=this.adjustChildCoordinates(t,e,i,r);if("function"!=typeof n.getBoundingBox)return null;var a=n.getBoundingBox(t);return a?(n.children.forEach((function(i,r){var o=e.getChildBoundingBox(t,e,n,r);a.addBoundingBox(o)})),a):null}},{key:"renderChild",value:function(t,e,i,r){var n=this.adjustChildCoordinates(t,e,i,r);n.render(t),n.children.forEach((function(i,r){e.renderChild(t,e,n,r)}))}},{key:"measureTextRecursive",value:function(t){return this.children.reduce((function(e,i){return e+i.measureTextRecursive(t)}),this.measureText(t))}},{key:"measureText",value:function(t){var e=this.measureCache;if(~e)return e;var i=this.getText(),r=this.measureTargetText(t,i);return this.measureCache=r,r}},{key:"measureTargetText",value:function(t,e){if(!e.length)return 0;var i=this.parent,r=i.getStyle("font-family").getDefinition();if(r){for(var n=this.getFontSize(),a=r.isRTL?e.split("").reverse().join(""):e,o=V(i.getAttribute("dx").getString()),l=a.length,c=0,u=0;u<l;u++)c+=(this.getGlyph(r,a,u).horizAdvX||r.horizAdvX)*n/r.fontFace.unitsPerEm,void 0===o[u]||isNaN(o[u])||(c+=o[u]);return c}if(!t.measureText)return 10*e.length;t.save(),this.setContext(t,!0);var h=t.measureText(e).width;return this.clearContext(t),t.restore(),h}}]),n}(Zt);var Xt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,(this instanceof n?this.constructor:void 0)===n||i)).type="tspan",a.text=a.children.length>0?"":a.getTextFromNode(),a}return T.default(n,[{key:"getText",value:function(){return this.text}}]),n}(Wt);var Yt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="textNode",t}return n}(Xt);var Kt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="svg",t.root=!1,t}return T.default(n,[{key:"setContext",value:function(t){var e,i=this.document,r=i.screen,a=i.window,o=t.canvas;if(r.setDefaults(t),o.style&&void 0!==t.font&&a&&void 0!==a.getComputedStyle){t.font=a.getComputedStyle(o).getPropertyValue("font");var l=new gt(i,"fontSize",Ut.parse(t.font).fontSize);l.hasValue()&&(i.rootEmSize=l.getPixels("y"),i.emSize=i.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var c=r.viewPort,u=c.width,h=c.height;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var p=this.getAttribute("refX"),d=this.getAttribute("refY"),f=this.getAttribute("viewBox"),m=f.hasValue()?V(f.getString()):null,g=!this.root&&"visible"!==this.getStyle("overflow").getValue("hidden"),y=0,_=0,v=0,x=0;m&&(y=m[0],_=m[1]),this.root||(u=this.getStyle("width").getPixels("x"),h=this.getStyle("height").getPixels("y"),"marker"===this.type&&(v=y,x=_,y=0,_=0)),r.viewPort.setCurrent(u,h),!this.node||this.parent&&"foreignObject"!==(null===(e=this.node.parentNode)||void 0===e?void 0:e.nodeName)||!this.getStyle("transform",!1,!0).hasValue()||this.getStyle("transform-origin",!1,!0).hasValue()||this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),D.default(O.default(n.prototype),"setContext",this).call(this,t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),m&&(u=m[2],h=m[3]),i.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:r.viewPort.width,desiredWidth:u,height:r.viewPort.height,desiredHeight:h,minX:y,minY:_,refX:p.getValue(),refY:d.getValue(),clip:g,clipX:v,clipY:x}),m&&(r.viewPort.removeCurrent(),r.viewPort.setCurrent(u,h))}},{key:"clearContext",value:function(t){D.default(O.default(n.prototype),"clearContext",this).call(this,t),this.document.screen.viewPort.removeCurrent()}},{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getAttribute("width",!0),n=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),l=r.getNumber(0),c=n.getNumber(0);if(i)if("string"==typeof i)this.getAttribute("preserveAspectRatio",!0).setValue(i);else{var u=this.getAttribute("preserveAspectRatio");u.hasValue()&&u.setValue(u.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(r.setValue(t),n.setValue(e),a.hasValue()||a.setValue("0 0 ".concat(l||t," ").concat(c||e)),o.hasValue()){var h=this.getStyle("width"),p=this.getStyle("height");h.hasValue()&&h.setValue("".concat(t,"px")),p.hasValue()&&p.setValue("".concat(e,"px"))}}}]),n}(Zt);var Jt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="rect",t}return T.default(n,[{key:"path",value:function(t){var e=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),r=this.getStyle("width",!1,!0).getPixels("x"),n=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),l=a.getPixels("x"),c=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(c=l),o.hasValue()&&!a.hasValue()&&(l=c),l=Math.min(l,r/2),c=Math.min(c,n/2),t){var u=(Math.sqrt(2)-1)/3*4;t.beginPath(),n>0&&r>0&&(t.moveTo(e+l,i),t.lineTo(e+r-l,i),t.bezierCurveTo(e+r-l+u*l,i,e+r,i+c-u*c,e+r,i+c),t.lineTo(e+r,i+n-c),t.bezierCurveTo(e+r,i+n-c+u*c,e+r-l+u*l,i+n,e+r-l,i+n),t.lineTo(e+l,i+n),t.bezierCurveTo(e+l-u*l,i+n,e,i+n-c+u*c,e,i+n-c),t.lineTo(e,i+c),t.bezierCurveTo(e,i+c-u*c,e+l-u*l,i,e+l,i),t.closePath())}return new Ht(e,i,e+r,i+n)}},{key:"getMarkers",value:function(){return null}}]),n}(Gt);var Qt=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="circle",t}return T.default(n,[{key:"path",value:function(t){var e=this.getAttribute("cx").getPixels("x"),i=this.getAttribute("cy").getPixels("y"),r=this.getAttribute("r").getPixels();return t&&r>0&&(t.beginPath(),t.arc(e,i,r,0,2*Math.PI,!1),t.closePath()),new Ht(e-r,i-r,e+r,i+r)}},{key:"getMarkers",value:function(){return null}}]),n}(Gt);var te=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="ellipse",t}return T.default(n,[{key:"path",value:function(t){var e=(Math.sqrt(2)-1)/3*4,i=this.getAttribute("rx").getPixels("x"),r=this.getAttribute("ry").getPixels("y"),n=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return t&&i>0&&r>0&&(t.beginPath(),t.moveTo(n+i,a),t.bezierCurveTo(n+i,a+e*r,n+e*i,a+r,n,a+r),t.bezierCurveTo(n-e*i,a+r,n-i,a+e*r,n-i,a),t.bezierCurveTo(n-i,a-e*r,n-e*i,a-r,n,a-r),t.bezierCurveTo(n+e*i,a-r,n+i,a-e*r,n+i,a),t.closePath()),new Ht(n-i,a-r,n+i,a+r)}},{key:"getMarkers",value:function(){return null}}]),n}(Gt);var ee=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="line",t}return T.default(n,[{key:"getPoints",value:function(){return[new _t(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new _t(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}},{key:"path",value:function(t){var e=this.getPoints(),i=C.default(e,2),r=i[0],n=r.x,a=r.y,o=i[1],l=o.x,c=o.y;return t&&(t.beginPath(),t.moveTo(n,a),t.lineTo(l,c)),new Ht(n,a,l,c)}},{key:"getMarkers",value:function(){var t=this.getPoints(),e=C.default(t,2),i=e[0],r=e[1],n=i.angleTo(r);return[[i,n],[r,n]]}}]),n}(Gt);var ie=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="polyline",a.points=[],a.points=_t.parsePath(a.getAttribute("points").getString()),a}return T.default(n,[{key:"path",value:function(t){var e=this.points,i=C.default(e,1)[0],r=i.x,n=i.y,a=new Ht(r,n);return t&&(t.beginPath(),t.moveTo(r,n)),e.forEach((function(e){var i=e.x,r=e.y;a.addPoint(i,r),t&&t.lineTo(i,r)})),a}},{key:"getMarkers",value:function(){var t=this.points,e=t.length-1,i=[];return t.forEach((function(r,n){n!==e&&i.push([r,r.angleTo(t[n+1])])})),i.length>0&&i.push([t[t.length-1],i[i.length-1][1]]),i}}]),n}(Gt);var re=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="polygon",t}return T.default(n,[{key:"path",value:function(t){var e=D.default(O.default(n.prototype),"path",this).call(this,t),i=C.default(this.points,1)[0],r=i.x,a=i.y;return t&&(t.lineTo(r,a),t.closePath()),e}}]),n}(ie);var ne=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="pattern",t}return T.default(n,[{key:"createPattern",value:function(t,e,i){var r=this.getStyle("width").getPixels("x",!0),n=this.getStyle("height").getPixels("y",!0),a=new Kt(this.document,null);a.attributes.viewBox=new gt(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new gt(this.document,"width","".concat(r,"px")),a.attributes.height=new gt(this.document,"height","".concat(n,"px")),a.attributes.transform=new gt(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(r,n),l=o.getContext("2d"),c=this.getAttribute("x"),u=this.getAttribute("y");c.hasValue()&&u.hasValue()&&l.translate(c.getPixels("x",!0),u.getPixels("y",!0)),i.hasValue()?this.styles["fill-opacity"]=i:Reflect.deleteProperty(this.styles,"fill-opacity");for(var h=-1;h<=1;h++)for(var p=-1;p<=1;p++)l.save(),a.attributes.x=new gt(this.document,"x",h*o.width),a.attributes.y=new gt(this.document,"y",p*o.height),a.render(l),l.restore();return t.createPattern(o,"repeat")}}]),n}(Rt);var se=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="marker",t}return T.default(n,[{key:"render",value:function(t,e,i){if(e){var r=e.x,n=e.y,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(r,n),"auto"===a&&t.rotate(i),"strokeWidth"===o&&t.scale(t.lineWidth,t.lineWidth),t.save();var l=new Kt(this.document,null);l.type=this.type,l.attributes.viewBox=new gt(this.document,"viewBox",this.getAttribute("viewBox").getValue()),l.attributes.refX=new gt(this.document,"refX",this.getAttribute("refX").getValue()),l.attributes.refY=new gt(this.document,"refY",this.getAttribute("refY").getValue()),l.attributes.width=new gt(this.document,"width",this.getAttribute("markerWidth").getValue()),l.attributes.height=new gt(this.document,"height",this.getAttribute("markerHeight").getValue()),l.attributes.overflow=new gt(this.document,"overflow",this.getAttribute("overflow").getValue()),l.attributes.fill=new gt(this.document,"fill",this.getAttribute("fill").getColor("black")),l.attributes.stroke=new gt(this.document,"stroke",this.getAttribute("stroke").getValue("none")),l.children=this.children,l.render(t),t.restore(),"strokeWidth"===o&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"===a&&t.rotate(-i),t.translate(-r,-n)}}}]),n}(Rt);var ae=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="defs",t}return T.default(n,[{key:"render",value:function(){}}]),n}(Rt);var de=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="g",t}return T.default(n,[{key:"getBoundingBox",value:function(t){var e=new Ht;return this.children.forEach((function(i){e.addBoundingBox(i.getBoundingBox(t))})),e}}]),n}(Zt);var fe=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).attributesToInherit=["gradientUnits"],a.stops=[];var o=F.default(a),l=o.stops;return o.children.forEach((function(t){"stop"===t.type&&l.push(t)})),a}return T.default(n,[{key:"getGradientUnits",value:function(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}},{key:"createGradient",value:function(t,e,i){var r=this,n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));var a=n.stops,o=this.getGradient(t,e);if(!o)return this.addParentOpacity(i,a[a.length-1].color);if(a.forEach((function(t){o.addColorStop(t.offset,r.addParentOpacity(i,t.color))})),this.getAttribute("gradientTransform").hasValue()){var l=this.document,c=l.screen,u=c.MAX_VIRTUAL_PIXELS,h=c.viewPort,p=C.default(h.viewPorts,1)[0],d=new Jt(l,null);d.attributes.x=new gt(l,"x",-u/3),d.attributes.y=new gt(l,"y",-u/3),d.attributes.width=new gt(l,"width",u),d.attributes.height=new gt(l,"height",u);var f=new de(l,null);f.attributes.transform=new gt(l,"transform",this.getAttribute("gradientTransform").getValue()),f.children=[d];var m=new Kt(l,null);m.attributes.x=new gt(l,"x",0),m.attributes.y=new gt(l,"y",0),m.attributes.width=new gt(l,"width",p.width),m.attributes.height=new gt(l,"height",p.height),m.children=[f];var g=l.createCanvas(p.width,p.height),y=g.getContext("2d");return y.fillStyle=o,m.render(y),y.createPattern(g,"no-repeat")}return o}},{key:"inheritStopContainer",value:function(t){var e=this;this.attributesToInherit.forEach((function(i){!e.getAttribute(i).hasValue()&&t.getAttribute(i).hasValue()&&e.getAttribute(i,!0).setValue(t.getAttribute(i).getValue())}))}},{key:"addParentOpacity",value:function(t,e){return t.hasValue()?new gt(this.document,"color",e).addOpacity(t).getColor():e}}]),n}(Rt);var me=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="linearGradient",a.attributesToInherit.push("x1","y1","x2","y2"),a}return T.default(n,[{key:"getGradient",value:function(t,e){var i="objectBoundingBox"===this.getGradientUnits(),r=i?e.getBoundingBox(t):null;if(i&&!r)return null;this.getAttribute("x1").hasValue()||this.getAttribute("y1").hasValue()||this.getAttribute("x2").hasValue()||this.getAttribute("y2").hasValue()||(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var n=i?r.x+r.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=i?r.y+r.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=i?r.x+r.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),l=i?r.y+r.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return n===o&&a===l?null:t.createLinearGradient(n,a,o,l)}}]),n}(fe);var _e=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="radialGradient",a.attributesToInherit.push("cx","cy","r","fx","fy","fr"),a}return T.default(n,[{key:"getGradient",value:function(t,e){var i="objectBoundingBox"===this.getGradientUnits(),r=e.getBoundingBox(t);if(i&&!r)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var n=i?r.x+r.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=i?r.y+r.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=n,l=a;this.getAttribute("fx").hasValue()&&(o=i?r.x+r.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(l=i?r.y+r.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var c=i?(r.width+r.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),u=this.getAttribute("fr").getPixels();return t.createRadialGradient(o,l,u,n,a,c)}}]),n}(fe);var xe=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="stop";var o=Math.max(0,Math.min(1,a.getAttribute("offset").getNumber())),l=a.getStyle("stop-opacity"),c=a.getStyle("stop-color",!0);return""===c.getString()&&c.setValue("#000"),l.hasValue()&&(c=c.addOpacity(l)),a.offset=o,a.color=c.getColor(),a}return n}(Rt);var be=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="animate",a.duration=0,a.initialValue=null,a.initialUnits="",a.removed=!1,a.frozen=!1,t.screen.animations.push(F.default(a)),a.begin=a.getAttribute("begin").getMilliseconds(),a.maxDuration=a.begin+a.getAttribute("dur").getMilliseconds(),a.from=a.getAttribute("from"),a.to=a.getAttribute("to"),a.values=new gt(t,"values",null);var o=a.getAttribute("values");return o.hasValue()&&a.values.setValue(o.getString().split(";")),a}return T.default(n,[{key:"getProperty",value:function(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return"CSS"===t?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}},{key:"calcValue",value:function(){var t=this.initialUnits,e=this.getProgress(),i=e.progress,r=e.from,n=e.to,a=r.getNumber()+(n.getNumber()-r.getNumber())*i;return"%"===t&&(a*=100),"".concat(a).concat(t)}},{key:"update",value:function(t){var e=this.parent,i=this.getProperty();if(this.initialValue||(this.initialValue=i.getString(),this.initialUnits=i.getUnits()),this.duration>this.maxDuration){var r=this.getAttribute("fill").getString("remove");if("indefinite"===this.getAttribute("repeatCount").getString()||"indefinite"===this.getAttribute("repeatDur").getString())this.duration=0;else if("freeze"!==r||this.frozen){if("remove"===r&&!this.removed)return this.removed=!0,i.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0}else this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=i.getString();return!1}this.duration+=t;var n=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var l=o.getString();a="".concat(l,"(").concat(a,")")}i.setValue(a),n=!0}return n}},{key:"getProgress",value:function(){var t=this.document,e=this.values,i={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var r=i.progress*(e.getValue().length-1),n=Math.floor(r),a=Math.ceil(r);i.from=new gt(t,"from",parseFloat(e.getValue()[n])),i.to=new gt(t,"to",parseFloat(e.getValue()[a])),i.progress=(r-n)/(a-n)}else i.from=this.from,i.to=this.to;return i}}]),n}(Rt);var Ce=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="animateColor",t}return T.default(n,[{key:"calcValue",value:function(){var t=this.getProgress(),e=t.progress,i=t.from,r=t.to,n=new A.default(i.getColor()),a=new A.default(r.getColor());if(n.ok&&a.ok){var o=n.r+(a.r-n.r)*e,l=n.g+(a.g-n.g)*e,c=n.b+(a.b-n.b)*e;return"rgb(".concat(Math.floor(o),", ").concat(Math.floor(l),", ").concat(Math.floor(c),")")}return this.getAttribute("from").getColor()}}]),n}(be);var Me=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="animateTransform",t}return T.default(n,[{key:"calcValue",value:function(){var t=this.getProgress(),e=t.progress,i=t.from,r=t.to,n=V(i.getString()),a=V(r.getString()),o=n.map((function(t,i){return t+(a[i]-t)*e})).join(" ");return o}}]),n}(be);function Te(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var Ee=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="font",a.glyphs={},a.horizAdvX=a.getAttribute("horiz-adv-x").getNumber();var o,l=t.definitions,c=function(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Te(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Te(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw a}}}}(F.default(a).children);try{for(c.s();!(o=c.n()).done;){var u=o.value;switch(u.type){case"font-face":a.fontFace=u;var h=u.getStyle("font-family");h.hasValue()&&(l[h.getString()]=F.default(a));break;case"missing-glyph":a.missingGlyph=u;break;case"glyph":var p=u;p.arabicForm?(a.isRTL=!0,a.isArabic=!0,void 0===a.glyphs[p.unicode]&&(a.glyphs[p.unicode]={}),a.glyphs[p.unicode][p.arabicForm]=p):a.glyphs[p.unicode]=p}}}catch(t){c.e(t)}finally{c.f()}return a}return T.default(n,[{key:"render",value:function(){}}]),n}(Rt);var Le=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="font-face",a.ascent=a.getAttribute("ascent").getNumber(),a.descent=a.getAttribute("descent").getNumber(),a.unitsPerEm=a.getAttribute("units-per-em").getNumber(),a}return n}(Rt);var Pe=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="missing-glyph",t.horizAdvX=0,t}return n}(Gt);var Oe=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="tref",t}return T.default(n,[{key:"getText",value:function(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}}]),n}(Wt);var ke=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="a";var o=e.childNodes,l=o[0],c=o.length>0&&Array.from(o).every((function(t){return 3===t.nodeType}));return a.hasText=c,a.text=c?a.getTextFromNode(l):"",a}return T.default(n,[{key:"getText",value:function(){return this.text}},{key:"renderChildren",value:function(t){if(this.hasText){D.default(O.default(n.prototype),"renderChildren",this).call(this,t);var e=this.document,i=this.x,r=this.y,a=e.screen.mouse,o=new gt(e,"fontSize",Ut.parse(e.ctx.font).fontSize);a.isWorking()&&a.checkBoundingBox(this,new Ht(i,r-o.getPixels("y"),i+this.measureText(t),r))}else if(this.children.length>0){var l=new de(this.document,null);l.children=this.children,l.parent=this,l.render(t)}}},{key:"onClick",value:function(){var t=this.document.window;t&&t.open(this.getHrefAttribute().getString())}},{key:"onMouseMove",value:function(){this.document.ctx.canvas.style.cursor="pointer"}}]),n}(Wt);function De(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function Fe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function ze(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Fe(Object(i),!0).forEach((function(e){S.default(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Fe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Re=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="textPath",a.textWidth=0,a.textHeight=0,a.pathLength=-1,a.glyphInfo=null,a.letterSpacingCache=[],a.measuresCache=new Map([["",0]]);var o=a.getHrefAttribute().getDefinition();return a.text=a.getTextFromNode(),a.dataArray=a.parsePathData(o),a}return T.default(n,[{key:"getText",value:function(){return this.text}},{key:"path",value:function(t){var e=this.dataArray;t&&t.beginPath(),e.forEach((function(e){var i=e.type,r=e.points;switch(i){case qt.LINE_TO:t&&t.lineTo(r[0],r[1]);break;case qt.MOVE_TO:t&&t.moveTo(r[0],r[1]);break;case qt.CURVE_TO:t&&t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case qt.QUAD_TO:t&&t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case qt.ARC:var n=C.default(r,8),a=n[0],o=n[1],l=n[2],c=n[3],u=n[4],h=n[5],p=n[6],d=n[7],f=l>c?l:c,m=l>c?1:l/c,g=l>c?c/l:1;t&&(t.translate(a,o),t.rotate(p),t.scale(m,g),t.arc(0,0,f,u,u+h,Boolean(1-d)),t.scale(1/m,1/g),t.rotate(-p),t.translate(-a,-o));break;case qt.CLOSE_PATH:t&&t.closePath()}}))}},{key:"renderChildren",value:function(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),i=this.getFontSize(),r=this.glyphInfo,n=t.fillStyle;"underline"===e&&t.beginPath(),r.forEach((function(r,n){var a=r.p0,o=r.p1,l=r.rotation,c=r.text;t.save(),t.translate(a.x,a.y),t.rotate(l),t.fillStyle&&t.fillText(c,0,0),t.strokeStyle&&t.strokeText(c,0,0),t.restore(),"underline"===e&&(0===n&&t.moveTo(a.x,a.y+i/8),t.lineTo(o.x,o.y+i/5))})),"underline"===e&&(t.lineWidth=i/20,t.strokeStyle=n,t.stroke(),t.closePath()),t.restore()}},{key:"getLetterSpacingAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.letterSpacingCache[t]||0}},{key:"findSegmentToFitChar",value:function(t,e,i,r,n,a,o,l,c){var u=a,h=this.measureText(t,l);" "===l&&"justify"===e&&i<r&&(h+=(r-i)/n),c>-1&&(u+=this.getLetterSpacingAt(c));var p=this.textHeight/20,d=this.getEquidistantPointOnPath(u,p,0),f=this.getEquidistantPointOnPath(u+h,p,0),m={p0:d,p1:f},g=d&&f?Math.atan2(f.y-d.y,f.x-d.x):0;if(o){var y=Math.cos(Math.PI/2+g)*o,_=Math.cos(-g)*o;m.p0=ze(ze({},d),{},{x:d.x+y,y:d.y+_}),m.p1=ze(ze({},f),{},{x:f.x+y,y:f.y+_})}return{offset:u+=h,segment:m,rotation:g}}},{key:"measureText",value:function(t,e){var i=this.measuresCache,r=e||this.getText();if(i.has(r))return i.get(r);var n=this.measureTargetText(t,r);return i.set(r,n),n}},{key:"setTextData",value:function(t){var e=this;if(!this.glyphInfo){var i=this.getText(),r=i.split(""),n=i.split(" ").length-1,a=this.parent.getAttribute("dx").split().map((function(t){return t.getPixels("x")})),o=this.parent.getAttribute("dy").getPixels("y"),l=this.parent.getStyle("text-anchor").getString("start"),c=this.getStyle("letter-spacing"),u=this.parent.getStyle("letter-spacing"),h=0;c.hasValue()&&"inherit"!==c.getValue()?c.hasValue()&&"initial"!==c.getValue()&&"unset"!==c.getValue()&&(h=c.getPixels()):h=u.getPixels();var p=[],d=i.length;this.letterSpacingCache=p;for(var f=0;f<d;f++)p.push(void 0!==a[f]?a[f]:h);var m=p.reduce((function(t,e,i){return 0===i?0:t+e||0}),0),g=this.measureText(t),y=Math.max(g+m,0);this.textWidth=g,this.textHeight=this.getFontSize(),this.glyphInfo=[];var _=this.getPathLength(),v=this.getStyle("startOffset").getNumber(0)*_,x=0;"middle"!==l&&"center"!==l||(x=-y/2),"end"!==l&&"right"!==l||(x=-y),x+=v,r.forEach((function(i,a){var c=e.findSegmentToFitChar(t,l,y,_,n,x,o,i,a),u=c.offset,h=c.segment,p=c.rotation;x=u,h.p0&&h.p1&&e.glyphInfo.push({text:r[a],p0:h.p0,p1:h.p1,rotation:p})}))}}},{key:"parsePathData",value:function(t){if(this.pathLength=-1,!t)return[];var e=[],i=t.pathParser;for(i.reset();!i.isEnd();){var r=i.current,n=r?r.x:0,a=r?r.y:0,o=i.next(),l=o.type,c=[];switch(o.type){case qt.MOVE_TO:this.pathM(i,c);break;case qt.LINE_TO:l=this.pathL(i,c);break;case qt.HORIZ_LINE_TO:l=this.pathH(i,c);break;case qt.VERT_LINE_TO:l=this.pathV(i,c);break;case qt.CURVE_TO:this.pathC(i,c);break;case qt.SMOOTH_CURVE_TO:l=this.pathS(i,c);break;case qt.QUAD_TO:this.pathQ(i,c);break;case qt.SMOOTH_QUAD_TO:l=this.pathT(i,c);break;case qt.ARC:c=this.pathA(i);break;case qt.CLOSE_PATH:Gt.pathZ(i)}o.type!==qt.CLOSE_PATH?e.push({type:l,points:c,start:{x:n,y:a},pathLength:this.calcLength(n,a,l,c)}):e.push({type:qt.CLOSE_PATH,points:[],pathLength:0})}return e}},{key:"pathM",value:function(t,e){var i=Gt.pathM(t).point,r=i.x,n=i.y;e.push(r,n)}},{key:"pathL",value:function(t,e){var i=Gt.pathL(t).point,r=i.x,n=i.y;return e.push(r,n),qt.LINE_TO}},{key:"pathH",value:function(t,e){var i=Gt.pathH(t).point,r=i.x,n=i.y;return e.push(r,n),qt.LINE_TO}},{key:"pathV",value:function(t,e){var i=Gt.pathV(t).point,r=i.x,n=i.y;return e.push(r,n),qt.LINE_TO}},{key:"pathC",value:function(t,e){var i=Gt.pathC(t),r=i.point,n=i.controlPoint,a=i.currentPoint;e.push(r.x,r.y,n.x,n.y,a.x,a.y)}},{key:"pathS",value:function(t,e){var i=Gt.pathS(t),r=i.point,n=i.controlPoint,a=i.currentPoint;return e.push(r.x,r.y,n.x,n.y,a.x,a.y),qt.CURVE_TO}},{key:"pathQ",value:function(t,e){var i=Gt.pathQ(t),r=i.controlPoint,n=i.currentPoint;e.push(r.x,r.y,n.x,n.y)}},{key:"pathT",value:function(t,e){var i=Gt.pathT(t),r=i.controlPoint,n=i.currentPoint;return e.push(r.x,r.y,n.x,n.y),qt.QUAD_TO}},{key:"pathA",value:function(t){var e=Gt.pathA(t),i=e.rX,r=e.rY,n=e.sweepFlag,a=e.xAxisRotation,o=e.centp,l=e.a1,c=e.ad;return 0===n&&c>0&&(c-=2*Math.PI),1===n&&c<0&&(c+=2*Math.PI),[o.x,o.y,i,r,l,c,a,n]}},{key:"calcLength",value:function(t,e,i,r){var n=0,a=null,o=null,l=0;switch(i){case qt.LINE_TO:return this.getLineLength(t,e,r[0],r[1]);case qt.CURVE_TO:for(n=0,a=this.getPointOnCubicBezier(0,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),l=.01;l<=1;l+=.01)o=this.getPointOnCubicBezier(l,t,e,r[0],r[1],r[2],r[3],r[4],r[5]),n+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return n;case qt.QUAD_TO:for(n=0,a=this.getPointOnQuadraticBezier(0,t,e,r[0],r[1],r[2],r[3]),l=.01;l<=1;l+=.01)o=this.getPointOnQuadraticBezier(l,t,e,r[0],r[1],r[2],r[3]),n+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return n;case qt.ARC:n=0;var c=r[4],u=r[5],h=r[4]+u,p=Math.PI/180;if(Math.abs(c-h)<p&&(p=Math.abs(c-h)),a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),u<0)for(l=c-p;l>h;l-=p)o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),n+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(l=c+p;l<h;l+=p)o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),n+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],h,0),n+this.getLineLength(a.x,a.y,o.x,o.y)}return 0}},{key:"getPointOnLine",value:function(t,e,i,r,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i,l=(n-i)/(r-e+it),c=Math.sqrt(t*t/(1+l*l));r<e&&(c*=-1);var u=l*c,h=null;if(r===e)h={x:a,y:o+u};else if((o-i)/(a-e+it)===l)h={x:a+c,y:o+u};else{var p,d,f=this.getLineLength(e,i,r,n);if(f<it)return null;var m=(a-e)*(r-e)+(o-i)*(n-i);p=e+(m/=f*f)*(r-e),d=i+m*(n-i);var g=this.getLineLength(a,o,p,d),y=Math.sqrt(t*t-g*g);c=Math.sqrt(y*y/(1+l*l)),r<e&&(c*=-1),h={x:p+c,y:d+(u=l*c)}}return h}},{key:"getPointOnPath",value:function(t){var e=this.getPathLength(),i=0,r=null;if(t<-5e-5||t-5e-5>e)return null;var n,a=function(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return De(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?De(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw a}}}}(this.dataArray);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!o||!(o.pathLength<5e-5||i+o.pathLength+5e-5<t)){var l=t-i,c=0;switch(o.type){case qt.LINE_TO:r=this.getPointOnLine(l,o.start.x,o.start.y,o.points[0],o.points[1],o.start.x,o.start.y);break;case qt.ARC:var u=o.points[4],h=o.points[5],p=o.points[4]+h;if(c=u+l/o.pathLength*h,h<0&&c<p||h>=0&&c>p)break;r=this.getPointOnEllipticalArc(o.points[0],o.points[1],o.points[2],o.points[3],c,o.points[6]);break;case qt.CURVE_TO:(c=l/o.pathLength)>1&&(c=1),r=this.getPointOnCubicBezier(c,o.start.x,o.start.y,o.points[0],o.points[1],o.points[2],o.points[3],o.points[4],o.points[5]);break;case qt.QUAD_TO:(c=l/o.pathLength)>1&&(c=1),r=this.getPointOnQuadraticBezier(c,o.start.x,o.start.y,o.points[0],o.points[1],o.points[2],o.points[3])}if(r)return r;break}i+=o.pathLength}}catch(t){a.e(t)}finally{a.f()}return null}},{key:"getLineLength",value:function(t,e,i,r){return Math.sqrt((i-t)*(i-t)+(r-e)*(r-e))}},{key:"getPathLength",value:function(){return-1===this.pathLength&&(this.pathLength=this.dataArray.reduce((function(t,e){return e.pathLength>0?t+e.pathLength:t}),0)),this.pathLength}},{key:"getPointOnCubicBezier",value:function(t,e,i,r,n,a,o,l,c){return{x:l*ct(t)+a*ut(t)+r*ht(t)+e*pt(t),y:c*ct(t)+o*ut(t)+n*ht(t)+i*pt(t)}}},{key:"getPointOnQuadraticBezier",value:function(t,e,i,r,n,a,o){return{x:a*dt(t)+r*ft(t)+e*mt(t),y:o*dt(t)+n*ft(t)+i*mt(t)}}},{key:"getPointOnEllipticalArc",value:function(t,e,i,r,n,a){var o=Math.cos(a),l=Math.sin(a),c=i*Math.cos(n),u=r*Math.sin(n);return{x:t+(c*o-u*l),y:e+(c*l+u*o)}}},{key:"buildEquidistantCache",value:function(t,e){var i=this.getPathLength(),r=e||.25,n=t||i/100;if(!this.equidistantCache||this.equidistantCache.step!==n||this.equidistantCache.precision!==r){this.equidistantCache={step:n,precision:r,points:[]};for(var a=0,o=0;o<=i;o+=r){var l=this.getPointOnPath(o),c=this.getPointOnPath(o+r);l&&c&&(a+=this.getLineLength(l.x,l.y,c.x,c.y))>=n&&(this.equidistantCache.points.push({x:l.x,y:l.y,distance:o}),a-=n)}}}},{key:"getEquidistantPointOnPath",value:function(t,e,i){if(this.buildEquidistantCache(e,i),t<0||t-this.getPathLength()>5e-5)return null;var r=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[r]||null}}]),n}(Wt);var Ne=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i,Be=function(t){I.default(o,t);var e,i,r,n,a=(r=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O.default(r);if(n){var i=O.default(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return P.default(this,t)});function o(t,e,i){var r;M.default(this,o),(r=a.call(this,t,e,i)).type="image",r.loaded=!1;var n=r.getHrefAttribute().getString();if(!n)return P.default(r);var l=n.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(n);return t.images.push(F.default(r)),l?r.loadSvg(n):r.loadImage(n),r.isSvg=l,r}return T.default(o,[{key:"loadImage",value:(i=w.default(b.default.mark((function t(e){var i;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.document.createImage(e);case 3:i=t.sent,this.image=i,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error('Error while loading image "'.concat(e,'":'),t.t0);case 10:this.loaded=!0;case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return i.apply(this,arguments)})},{key:"loadSvg",value:(e=w.default(b.default.mark((function t(e){var i,r,n,a;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=Ne.exec(e))){t.next=6;break}r=i[5],"base64"===i[4]?this.image=atob(r):this.image=decodeURIComponent(r),t.next=19;break;case 6:return t.prev=6,t.next=9,this.document.fetch(e);case 9:return n=t.sent,t.next=12,n.text();case 12:a=t.sent,this.image=a,t.next=19;break;case 16:t.prev=16,t.t0=t.catch(6),console.error('Error while loading image "'.concat(e,'":'),t.t0);case 19:this.loaded=!0;case 20:case"end":return t.stop()}}),t,this,[[6,16]])}))),function(t){return e.apply(this,arguments)})},{key:"renderChildren",value:function(t){var e=this.document,i=this.image,r=this.loaded,n=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(r&&i&&o&&l){if(t.save(),t.translate(n,a),this.isSvg){var c=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:l});c.document.documentElement.parent=this,c.render()}else{var u=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:u.width,height:l,desiredHeight:u.height}),this.loaded&&(void 0===u.complete||u.complete)&&t.drawImage(u,0,0)}t.restore()}}},{key:"getBoundingBox",value:function(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),i=this.getStyle("width").getPixels("x"),r=this.getStyle("height").getPixels("y");return new Ht(t,e,t+i,e+r)}}]),o}(Zt);var Ve=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="symbol",t}return T.default(n,[{key:"render",value:function(t){}}]),n}(Zt),Ue=function(){function t(e){M.default(this,t),this.document=e,this.loaded=!1,e.fonts.push(this)}var e;return T.default(t,[{key:"load",value:(e=w.default(b.default.mark((function t(e,i){var r,n,a;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=this.document,t.next=4,r.canvg.parser.load(i);case 4:n=t.sent,a=n.getElementsByTagName("font"),Array.from(a).forEach((function(t){var i=r.createElement(t);r.definitions[e]=i})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error('Error while loading font "'.concat(i,'":'),t.t0);case 12:this.loaded=!0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t,i){return e.apply(this,arguments)})}]),t}();var He=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="style",j(Array.from(e.childNodes).map((function(t){return t.textContent})).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")).split("}").forEach((function(e){var i=e.trim();if(i){var r=i.split("{"),n=r[0].split(","),a=r[1].split(";");n.forEach((function(e){var i=e.trim();if(i){var r=t.styles[i]||{};if(a.forEach((function(e){var i=e.indexOf(":"),n=e.substr(0,i).trim(),a=e.substr(i+1,e.length-i).trim();n&&a&&(r[n]=new gt(t,n,a))})),t.styles[i]=r,t.stylesSpecificity[i]=et(i),"@font-face"===i){var n=r["font-family"].getString().replace(/"|'/g,"");r.src.getString().split(",").forEach((function(e){if(e.indexOf('format("svg")')>0){var i=q(e);i&&new Ue(t).load(n,i)}}))}}}))}})),a}return n}(Rt);He.parseExternalUrl=q;var Ge=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="use",t}return T.default(n,[{key:"setContext",value:function(t){D.default(O.default(n.prototype),"setContext",this).call(this,t);var e=this.getAttribute("x"),i=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),i.hasValue()&&t.translate(0,i.getPixels("y"))}},{key:"path",value:function(t){var e=this.element;e&&e.path(t)}},{key:"renderChildren",value:function(t){var e=this.document,i=this.element;if(i){var r=i;if("symbol"===i.type&&((r=new Kt(e,null)).attributes.viewBox=new gt(e,"viewBox",i.getAttribute("viewBox").getString()),r.attributes.preserveAspectRatio=new gt(e,"preserveAspectRatio",i.getAttribute("preserveAspectRatio").getString()),r.attributes.overflow=new gt(e,"overflow",i.getAttribute("overflow").getString()),r.children=i.children,i.styles.opacity=new gt(e,"opacity",this.calculateOpacity())),"svg"===r.type){var n=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);n.hasValue()&&(r.attributes.width=new gt(e,"width",n.getString())),a.hasValue()&&(r.attributes.height=new gt(e,"height",a.getString()))}var o=r.parent;r.parent=this,r.render(t),r.parent=o}}},{key:"getBoundingBox",value:function(t){var e=this.element;return e?e.getBoundingBox(t):null}},{key:"elementTransform",value:function(){var t=this.document,e=this.element;return zt.fromElement(t,e)}},{key:"element",get:function(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}}]),n}(Zt);function $e(t,e,i,r,n,a){return t[i*r*4+4*e+a]}function We(t,e,i,r,n,a,o){t[i*r*4+4*e+a]=o}function Xe(t,e,i){return t[e]*i}function Ke(t,e,i,r){return e+Math.cos(t)*i+Math.sin(t)*r}var Je=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;M.default(this,n),(a=r.call(this,t,e,i)).type="feColorMatrix";var o=V(a.getAttribute("values").getString());switch(a.getAttribute("type").getString("matrix")){case"saturate":var l=o[0];o=[.213+.787*l,.715-.715*l,.072-.072*l,0,0,.213-.213*l,.715+.285*l,.072-.072*l,0,0,.213-.213*l,.715-.715*l,.072+.928*l,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var c=o[0]*Math.PI/180;o=[Ke(c,.213,.787,-.213),Ke(c,.715,-.715,-.715),Ke(c,.072,-.072,.928),0,0,Ke(c,.213,-.213,.143),Ke(c,.715,.285,.14),Ke(c,.072,-.072,-.283),0,0,Ke(c,.213,-.213,-.787),Ke(c,.715,-.715,.715),Ke(c,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}return a.matrix=o,a.includeOpacity=a.getAttribute("includeOpacity").hasValue(),a}return T.default(n,[{key:"apply",value:function(t,e,i,r,n){for(var a=this.includeOpacity,o=this.matrix,l=t.getImageData(0,0,r,n),c=0;c<n;c++)for(var u=0;u<r;u++){var h=$e(l.data,u,c,r,0,0),p=$e(l.data,u,c,r,0,1),d=$e(l.data,u,c,r,0,2),f=$e(l.data,u,c,r,0,3),m=Xe(o,0,h)+Xe(o,1,p)+Xe(o,2,d)+Xe(o,3,f)+Xe(o,4,1),g=Xe(o,5,h)+Xe(o,6,p)+Xe(o,7,d)+Xe(o,8,f)+Xe(o,9,1),y=Xe(o,10,h)+Xe(o,11,p)+Xe(o,12,d)+Xe(o,13,f)+Xe(o,14,1),_=Xe(o,15,h)+Xe(o,16,p)+Xe(o,17,d)+Xe(o,18,f)+Xe(o,19,1);a&&(m=0,g=0,y=0,_*=f/255),We(l.data,u,c,r,0,0,m),We(l.data,u,c,r,0,1,g),We(l.data,u,c,r,0,2,y),We(l.data,u,c,r,0,3,_)}t.clearRect(0,0,r,n),t.putImageData(l,0,0)}}]),n}(Rt);var Qe=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="mask",t}return T.default(n,[{key:"apply",value:function(t,e){var i=this.document,r=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(!o&&!l){var c=new Ht;this.children.forEach((function(e){c.addBoundingBox(e.getBoundingBox(t))})),r=Math.floor(c.x1),a=Math.floor(c.y1),o=Math.floor(c.width),l=Math.floor(c.height)}var u=this.removeStyles(e,n.ignoreStyles),h=i.createCanvas(r+o,a+l),p=h.getContext("2d");i.screen.setDefaults(p),this.renderChildren(p),new Je(i,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(p,0,0,r+o,a+l);var d=i.createCanvas(r+o,a+l),f=d.getContext("2d");i.screen.setDefaults(f),e.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=p.createPattern(h,"no-repeat"),f.fillRect(0,0,r+o,a+l),t.fillStyle=f.createPattern(d,"no-repeat"),t.fillRect(0,0,r+o,a+l),this.restoreStyles(e,u)}},{key:"render",value:function(t){}}]),n}(Rt);Qe.ignoreStyles=["mask","transform","clip-path"];var ti=function(){},ii=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="clipPath",t}return T.default(n,[{key:"apply",value:function(t){var e=this.document,i=Reflect.getPrototypeOf(t),r=t.beginPath,n=t.closePath;i&&(i.beginPath=ti,i.closePath=ti),Reflect.apply(r,t,[]),this.children.forEach((function(r){if(void 0!==r.path){var a=void 0!==r.elementTransform?r.elementTransform():null;a||(a=zt.fromElement(e,r)),a&&a.apply(t),r.path(t),i&&(i.closePath=n),a&&a.unapply(t)}})),Reflect.apply(n,t,[]),t.clip(),i&&(i.beginPath=r,i.closePath=n)}},{key:"render",value:function(t){}}]),n}(Rt);var ui=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="filter",t}return T.default(n,[{key:"apply",value:function(t,e){var i=this.document,r=this.children,a=e.getBoundingBox(t);if(a){var o=0,l=0;r.forEach((function(t){var e=t.extraFilterDistance||0;o=Math.max(o,e),l=Math.max(l,e)}));var c=Math.floor(a.width),u=Math.floor(a.height),h=c+2*o,p=u+2*l;if(!(h<1||p<1)){var d=Math.floor(a.x),f=Math.floor(a.y),m=this.removeStyles(e,n.ignoreStyles),g=i.createCanvas(h,p),y=g.getContext("2d");i.screen.setDefaults(y),y.translate(-d+o,-f+l),e.render(y),r.forEach((function(t){"function"==typeof t.apply&&t.apply(y,0,0,h,p)})),t.drawImage(g,0,0,h,p,d-o,f-l,h,p),this.restoreStyles(e,m)}}}},{key:"render",value:function(t){}}]),n}(Rt);ui.ignoreStyles=["filter","transform","clip-path"];var pi=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="feDropShadow",a.addStylesFromStyleDefinition(),a}return T.default(n,[{key:"apply",value:function(t,e,i,r,n){}}]),n}(Rt);var di=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="feMorphology",t}return T.default(n,[{key:"apply",value:function(t,e,i,r,n){}}]),n}(Rt);var fi=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="feComposite",t}return T.default(n,[{key:"apply",value:function(t,e,i,r,n){}}]),n}(Rt);var mi=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(t,e,i){var a;return M.default(this,n),(a=r.call(this,t,e,i)).type="feGaussianBlur",a.blurRadius=Math.floor(a.getAttribute("stdDeviation").getNumber()),a.extraFilterDistance=a.blurRadius,a}return T.default(n,[{key:"apply",value:function(t,e,i,r,n){var a=this.document,o=this.blurRadius,l=a.window?a.window.document.body:null,c=t.canvas;c.id=a.getUniqueId(),l&&(c.style.display="none",l.appendChild(c)),v.canvasRGBA(c,e,i,r,n,o),l&&l.removeChild(c)}}]),n}(Rt);var gi=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="title",t}return n}(Rt);var yi=function(t){I.default(n,t);var e,i,r=(e=n,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=O.default(e);if(i){var n=O.default(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return P.default(this,t)});function n(){var t;return M.default(this,n),(t=r.apply(this,arguments)).type="desc",t}return n}(Rt),_i={svg:Kt,rect:Jt,circle:Qt,ellipse:te,line:ee,polyline:ie,polygon:re,path:Gt,pattern:ne,marker:se,defs:ae,linearGradient:me,radialGradient:_e,stop:xe,animate:be,animateColor:Ce,animateTransform:Me,font:Ee,"font-face":Le,"missing-glyph":Pe,glyph:$t,text:Wt,tspan:Xt,tref:Oe,a:ke,textPath:Re,image:Be,g:de,symbol:Ve,style:He,use:Ge,mask:Qe,clipPath:ii,filter:ui,feDropShadow:pi,feMorphology:di,feComposite:fi,feColorMatrix:Je,feGaussianBlur:mi,title:gi,desc:yi};function xi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function Ci(){return Ci=w.default(b.default.mark((function t(e){var i,r,n=arguments;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.length>1&&void 0!==n[1]&&n[1],r=document.createElement("img"),i&&(r.crossOrigin="Anonymous"),t.abrupt("return",new Promise((function(t,i){r.onload=function(){t(r)},r.onerror=function(t,e,r,n,a){i(a)},r.src=e})));case 4:case"end":return t.stop()}}),t)}))),Ci.apply(this,arguments)}var Si=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.rootEmSize,n=void 0===r?12:r,a=i.emSize,o=void 0===a?12:a,l=i.createCanvas,c=void 0===l?t.createCanvas:l,u=i.createImage,h=void 0===u?t.createImage:u,p=i.anonymousCrossOrigin;M.default(this,t),this.canvg=e,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=e.screen,this.rootEmSize=n,this.emSize=o,this.createCanvas=c,this.createImage=this.bindCreateImage(h,p),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}return T.default(t,[{key:"bindCreateImage",value:function(t,e){return"boolean"==typeof e?function(i,r){return t(i,"boolean"==typeof r?r:e)}:t}},{key:"popEmSize",value:function(){this.emSizeStack.pop()}},{key:"getUniqueId",value:function(){return"canvg".concat(++this.uniqueId)}},{key:"isImagesLoaded",value:function(){return this.images.every((function(t){return t.loaded}))}},{key:"isFontsLoaded",value:function(){return this.fonts.every((function(t){return t.loaded}))}},{key:"createDocumentElement",value:function(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}},{key:"createElement",value:function(e){var i=e.nodeName.replace(/^[^:]+:/,""),r=t.elementTypes[i];return void 0!==r?new r(this,e):new jt(this,e)}},{key:"createTextNode",value:function(t){return new Yt(this,t)}},{key:"setViewBox",value:function(t){this.screen.setViewBox(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?xi(Object(i),!0).forEach((function(e){S.default(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):xi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({document:this},t))}},{key:"window",get:function(){return this.screen.window}},{key:"fetch",get:function(){return this.screen.fetch}},{key:"ctx",get:function(){return this.screen.ctx}},{key:"emSize",get:function(){var t=this.emSizeStack;return t[t.length-1]},set:function(t){this.emSizeStack.push(t)}}]),t}();function Mi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function Ei(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Mi(Object(i),!0).forEach((function(e){S.default(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Mi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}Si.createCanvas=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i},Si.createImage=function(t){return Ci.apply(this,arguments)},Si.elementTypes=_i;var Ai=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};M.default(this,t),this.parser=new At(r),this.screen=new Mt(e,r),this.options=r;var n=new Si(this,r),a=n.createDocumentElement(i);this.document=n,this.documentElement=a}var e,i;return T.default(t,[{key:"fork",value:function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.from(e,i,Ei(Ei({},this.options),r))}},{key:"forkString",value:function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.fromString(e,i,Ei(Ei({},this.options),r))}},{key:"ready",value:function(){return this.screen.ready()}},{key:"isReady",value:function(){return this.screen.isReady()}},{key:"render",value:(i=w.default(b.default.mark((function t(){var e,i=arguments;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},this.start(Ei({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},e)),t.next=4,this.ready();case 4:this.stop();case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.documentElement,i=this.screen,r=this.options;i.start(e,Ei(Ei({enableRedraw:!0},r),t))}},{key:"stop",value:function(){this.screen.stop()}},{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.documentElement.resize(t,e,i)}}],[{key:"from",value:(e=w.default(b.default.mark((function e(i,r){var n,a,o,l=arguments;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new At(n=l.length>2&&void 0!==l[2]?l[2]:{}),e.next=4,a.parse(r);case 4:return o=e.sent,e.abrupt("return",new t(i,o,n));case 6:case"end":return e.stop()}}),e)}))),function(t,i){return e.apply(this,arguments)})},{key:"fromString",value:function(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new t(e,new At(r).parseFromString(i),r)}}]),t}();e.AElement=ke,e.AnimateColorElement=Ce,e.AnimateElement=be,e.AnimateTransformElement=Me,e.BoundingBox=Ht,e.CB1=ct,e.CB2=ut,e.CB3=ht,e.CB4=pt,e.Canvg=Ai,e.CircleElement=Qt,e.ClipPathElement=ii,e.DefsElement=ae,e.DescElement=yi,e.Document=Si,e.Element=Rt,e.EllipseElement=te,e.FeColorMatrixElement=Je,e.FeCompositeElement=fi,e.FeDropShadowElement=pi,e.FeGaussianBlurElement=mi,e.FeMorphologyElement=di,e.FilterElement=ui,e.Font=Ut,e.FontElement=Ee,e.FontFaceElement=Le,e.GElement=de,e.GlyphElement=$t,e.GradientElement=fe,e.ImageElement=Be,e.LineElement=ee,e.LinearGradientElement=me,e.MarkerElement=se,e.MaskElement=Qe,e.Matrix=Ot,e.MissingGlyphElement=Pe,e.Mouse=vt,e.PSEUDO_ZERO=it,e.Parser=At,e.PathElement=Gt,e.PathParser=qt,e.PatternElement=ne,e.Point=_t,e.PolygonElement=re,e.PolylineElement=ie,e.Property=gt,e.QB1=dt,e.QB2=ft,e.QB3=mt,e.RadialGradientElement=_e,e.RectElement=Jt,e.RenderedElement=Zt,e.Rotate=Lt,e.SVGElement=Kt,e.SVGFontLoader=Ue,e.Scale=Pt,e.Screen=Mt,e.Skew=kt,e.SkewX=Dt,e.SkewY=Ft,e.StopElement=xe,e.StyleElement=He,e.SymbolElement=Ve,e.TRefElement=Oe,e.TSpanElement=Xt,e.TextElement=Wt,e.TextPathElement=Re,e.TitleElement=gi,e.Transform=zt,e.Translate=It,e.UnknownElement=jt,e.UseElement=Ge,e.ViewPort=yt,e.compressSpaces=j,e.default=Ai,e.getSelectorSpecificity=et,e.normalizeAttributeName=H,e.normalizeColor=Z,e.parseExternalUrl=q,e.presets=z,e.toNumbers=V,e.trimLeft=N,e.trimRight=B,e.vectorMagnitude=at,e.vectorsAngle=lt,e.vectorsRatio=ot}).call(this,i(127))},function(t,e,i){t.exports=i(27)(2914)},function(t,e,i){t.exports=i(27)(2919)},function(t,e,i){t.exports=i(27)(2936)},function(t,e,i){t.exports=i(27)(381)},function(t,e,i){t.exports=i(27)(608)},function(t,e,i){t.exports=i(27)(2808)},function(t,e,i){t.exports=i(27)(2917)},function(t,e,i){t.exports=i(27)(1119)},function(t,e,i){t.exports=i(27)(2976)},function(t,e,i){t.exports=i(27)(2982)},function(t,e,i){t.exports=i(27)(2986)},function(t,e,i){t.exports=i(27)(2806)},function(t,e,i){t.exports=i(27)(10)},function(t,e,i){t.exports=i(27)(16)},function(t,e,i){t.exports=i(27)(17)},function(t,e,i){t.exports=i(27)(2789)},function(t,e,i){t.exports=i(27)(2791)},function(t,e,i){t.exports=i(27)(2811)},function(t,e,i){t.exports=i(27)(2972)},function(t,e,i){t.exports=i(27)(2985)},function(t,e,i){(function(e){for(var r=i(552),n="undefined"==typeof window?e:window,a=["moz","webkit"],o="AnimationFrame",l=n["request"+o],c=n["cancel"+o]||n["cancelRequest"+o],u=0;!l&&u<a.length;u++)l=n[a[u]+"Request"+o],c=n[a[u]+"Cancel"+o]||n[a[u]+"CancelRequest"+o];if(!l||!c){var h=0,p=0,d=[],f=1e3/60;l=function(t){if(0===d.length){var e=r(),i=Math.max(0,f-(e-h));h=i+e,setTimeout((function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(h)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(i))}return d.push({handle:++p,callback:t,cancelled:!1}),p},c=function(t){for(var e=0;e<d.length;e++)d[e].handle===t&&(d[e].cancelled=!0)}}t.exports=function(t){return l.call(n,t)},t.exports.cancel=function(){c.apply(n,arguments)},t.exports.polyfill=function(t){t||(t=n),t.requestAnimationFrame=l,t.cancelAnimationFrame=c}}).call(this,i(118))},function(t,e,i){(function(e){(function(){var i,r,n,a,o,l;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:null!=e&&e.hrtime?(t.exports=function(){return(i()-o)/1e6},r=e.hrtime,a=(i=function(){var t;return 1e9*(t=r())[0]+t[1]})(),l=1e9*e.uptime(),o=a-l):Date.now?(t.exports=function(){return Date.now()-n},n=Date.now()):(t.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}).call(this,i(127))},function(t,e,i){t.exports=i(27)(2850)},function(t,e,i){t.exports=i(27)(2989)},function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var i=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<i.length;r++){var n=i[r].re,a=i[r].process,o=n.exec(t);if(o){var l=a(o);this.r=l[0],this.g=l[1],this.b=l[2],l.length>3&&(this.alpha=l[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),"#"+t+e+i},this.getHelpXML=function(){for(var t=new Array,r=0;r<i.length;r++)for(var n=i[r].example,a=0;a<n.length;a++)t[t.length]=n[a];for(var o in e)t[t.length]=o;var l=document.createElement("ul");for(l.setAttribute("id","rgbcolor-examples"),r=0;r<t.length;r++)try{var c=document.createElement("li"),u=new RGBColor(t[r]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex(),h.appendChild(document.createTextNode("test"));var p=document.createTextNode(" "+t[r]+" -> "+u.toRGB()+" -> "+u.toHex());c.appendChild(h),c.appendChild(p),l.appendChild(c)}catch(t){}return l}}},function(t,e,i){t.exports=i(27)(2800)},function(t,e,i){t.exports=i(27)(3057)},function(t,e,i){t.exports=i(27)(22)},function(t,e,i){t.exports=i(27)(24)},function(t,e,i){t.exports=i(27)(12)},function(t,e,i){t.exports=i(27)(2801)},function(t,e,i){t.exports=i(27)(2803)},function(t,e,i){t.exports=i(27)(2815)},function(t,e,i){t.exports=i(27)(2974)},function(t,e,i){t.exports=i(27)(1439)},function(t,e,i){t.exports=i(27)(20)},function(t,e,i){t.exports=i(27)(2804)},function(t,e,i){t.exports=i(27)(2813)},function(t,e,i){t.exports=i(27)(739)},function(t,e,i){t.exports=i(27)(2874)},function(t,e,i){t.exports=i(27)(2792)},function(t,e,i){!function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}var r=" ";function n(t){var e="";Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];if(n.type===b.CLOSE_PATH)e+="z";else if(n.type===b.HORIZ_LINE_TO)e+=(n.relative?"h":"H")+n.x;else if(n.type===b.VERT_LINE_TO)e+=(n.relative?"v":"V")+n.y;else if(n.type===b.MOVE_TO)e+=(n.relative?"m":"M")+n.x+r+n.y;else if(n.type===b.LINE_TO)e+=(n.relative?"l":"L")+n.x+r+n.y;else if(n.type===b.CURVE_TO)e+=(n.relative?"c":"C")+n.x1+r+n.y1+r+n.x2+r+n.y2+r+n.x+r+n.y;else if(n.type===b.SMOOTH_CURVE_TO)e+=(n.relative?"s":"S")+n.x2+r+n.y2+r+n.x+r+n.y;else if(n.type===b.QUAD_TO)e+=(n.relative?"q":"Q")+n.x1+r+n.y1+r+n.x+r+n.y;else if(n.type===b.SMOOTH_QUAD_TO)e+=(n.relative?"t":"T")+n.x+r+n.y;else{if(n.type!==b.ARC)throw new Error('Unexpected command type "'+n.type+'" at index '+i+".");e+=(n.relative?"a":"A")+n.rX+r+n.rY+r+n.xRot+r+ +n.lArcFlag+r+ +n.sweepFlag+r+n.x+r+n.y}}return e}function a(t,e){var i=t[0],r=t[1];return[i*Math.cos(e)-r*Math.sin(e),i*Math.sin(e)+r*Math.cos(e)]}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)if("number"!=typeof t[i])throw new Error("assertNumbers arguments["+i+"] is not a number. "+typeof t[i]+" == typeof "+t[i]);return!0}var l=Math.PI;function c(t,e,i){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var r=t.rX,n=t.rY,o=t.x,c=t.y;r=Math.abs(t.rX),n=Math.abs(t.rY);var u=a([(e-o)/2,(i-c)/2],-t.xRot/180*l),h=u[0],p=u[1],d=Math.pow(h,2)/Math.pow(r,2)+Math.pow(p,2)/Math.pow(n,2);1<d&&(r*=Math.sqrt(d),n*=Math.sqrt(d)),t.rX=r,t.rY=n;var f=Math.pow(r,2)*Math.pow(p,2)+Math.pow(n,2)*Math.pow(h,2),m=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(r,2)*Math.pow(n,2)-f)/f)),g=r*p/n*m,y=-n*h/r*m,_=a([g,y],t.xRot/180*l);t.cX=_[0]+(e+o)/2,t.cY=_[1]+(i+c)/2,t.phi1=Math.atan2((p-y)/n,(h-g)/r),t.phi2=Math.atan2((-p-y)/n,(-h-g)/r),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*l),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*l),t.phi1*=180/l,t.phi2*=180/l}function u(t,e,i){o(t,e,i);var r=t*t+e*e-i*i;if(0>r)return[];if(0===r)return[[t*i/(t*t+e*e),e*i/(t*t+e*e)]];var n=Math.sqrt(r);return[[(t*i+e*n)/(t*t+e*e),(e*i-t*n)/(t*t+e*e)],[(t*i-e*n)/(t*t+e*e),(e*i+t*n)/(t*t+e*e)]]}var h=Math.PI/180;function p(t,e,i){return(1-i)*t+i*e}function d(t,e,i,r){return t+Math.cos(r/180*l)*e+Math.sin(r/180*l)*i}function f(t,e,i,r){var n=1e-6,a=e-t,o=i-e,l=3*a+3*(r-i)-6*o,c=6*(o-a),u=3*a;return Math.abs(l)<n?[-u/c]:function(t,e,i){void 0===i&&(i=1e-6);var r=t*t/4-e;if(r<-i)return[];if(r<=i)return[-t/2];var n=Math.sqrt(r);return[-t/2-n,-t/2+n]}(c/l,u/l,n)}function m(t,e,i,r,n){var a=1-n;return t*(a*a*a)+e*(3*a*a*n)+i*(3*a*n*n)+r*(n*n*n)}t.SVGPathDataTransformer=void 0,function(t){function e(){return n((function(t,e,i){return t.relative&&(void 0!==t.x1&&(t.x1+=e),void 0!==t.y1&&(t.y1+=i),void 0!==t.x2&&(t.x2+=e),void 0!==t.y2&&(t.y2+=i),void 0!==t.x&&(t.x+=e),void 0!==t.y&&(t.y+=i),t.relative=!1),t}))}function i(){var t=NaN,e=NaN,i=NaN,r=NaN;return n((function(n,a,o){return n.type&b.SMOOTH_CURVE_TO&&(n.type=b.CURVE_TO,t=isNaN(t)?a:t,e=isNaN(e)?o:e,n.x1=n.relative?a-t:2*a-t,n.y1=n.relative?o-e:2*o-e),n.type&b.CURVE_TO?(t=n.relative?a+n.x2:n.x2,e=n.relative?o+n.y2:n.y2):(t=NaN,e=NaN),n.type&b.SMOOTH_QUAD_TO&&(n.type=b.QUAD_TO,i=isNaN(i)?a:i,r=isNaN(r)?o:r,n.x1=n.relative?a-i:2*a-i,n.y1=n.relative?o-r:2*o-r),n.type&b.QUAD_TO?(i=n.relative?a+n.x1:n.x1,r=n.relative?o+n.y1:n.y1):(i=NaN,r=NaN),n}))}function r(){var t=NaN,e=NaN;return n((function(i,r,n){if(i.type&b.SMOOTH_QUAD_TO&&(i.type=b.QUAD_TO,t=isNaN(t)?r:t,e=isNaN(e)?n:e,i.x1=i.relative?r-t:2*r-t,i.y1=i.relative?n-e:2*n-e),i.type&b.QUAD_TO){t=i.relative?r+i.x1:i.x1,e=i.relative?n+i.y1:i.y1;var a=i.x1,o=i.y1;i.type=b.CURVE_TO,i.x1=((i.relative?0:r)+2*a)/3,i.y1=((i.relative?0:n)+2*o)/3,i.x2=(i.x+2*a)/3,i.y2=(i.y+2*o)/3}else t=NaN,e=NaN;return i}))}function n(t){var e=0,i=0,r=NaN,n=NaN;return function(a){if(isNaN(r)&&!(a.type&b.MOVE_TO))throw new Error("path must start with moveto");var o=t(a,e,i,r,n);return a.type&b.CLOSE_PATH&&(e=r,i=n),void 0!==a.x&&(e=a.relative?e+a.x:a.x),void 0!==a.y&&(i=a.relative?i+a.y:a.y),a.type&b.MOVE_TO&&(r=e,n=i),o}}function l(t,e,i,r,a,l){return o(t,e,i,r,a,l),n((function(n,o,c,u){var h=n.x1,p=n.x2,d=n.relative&&!isNaN(u),f=void 0!==n.x?n.x:d?0:o,m=void 0!==n.y?n.y:d?0:c;function g(t){return t*t}n.type&b.HORIZ_LINE_TO&&0!==e&&(n.type=b.LINE_TO,n.y=n.relative?0:c),n.type&b.VERT_LINE_TO&&0!==i&&(n.type=b.LINE_TO,n.x=n.relative?0:o),void 0!==n.x&&(n.x=n.x*t+m*i+(d?0:a)),void 0!==n.y&&(n.y=f*e+n.y*r+(d?0:l)),void 0!==n.x1&&(n.x1=n.x1*t+n.y1*i+(d?0:a)),void 0!==n.y1&&(n.y1=h*e+n.y1*r+(d?0:l)),void 0!==n.x2&&(n.x2=n.x2*t+n.y2*i+(d?0:a)),void 0!==n.y2&&(n.y2=p*e+n.y2*r+(d?0:l));var y=t*r-e*i;if(void 0!==n.xRot&&(1!==t||0!==e||0!==i||1!==r))if(0===y)delete n.rX,delete n.rY,delete n.xRot,delete n.lArcFlag,delete n.sweepFlag,n.type=b.LINE_TO;else{var _=n.xRot*Math.PI/180,v=Math.sin(_),x=Math.cos(_),w=1/g(n.rX),C=1/g(n.rY),S=g(x)*w+g(v)*C,M=2*v*x*(w-C),T=g(v)*w+g(x)*C,E=S*r*r-M*e*r+T*e*e,A=M*(t*r+e*i)-2*(S*i*r+T*t*e),I=S*i*i-M*t*i+T*t*t,P=(Math.atan2(A,E-I)+Math.PI)%Math.PI/2,O=Math.sin(P),k=Math.cos(P);n.rX=Math.abs(y)/Math.sqrt(E*g(k)+A*O*k+I*g(O)),n.rY=Math.abs(y)/Math.sqrt(E*g(O)-A*O*k+I*g(k)),n.xRot=180*P/Math.PI}return void 0!==n.sweepFlag&&0>y&&(n.sweepFlag=+!n.sweepFlag),n}))}t.ROUND=function(t){function e(e){return Math.round(e*t)/t}return void 0===t&&(t=1e13),o(t),function(t){return void 0!==t.x1&&(t.x1=e(t.x1)),void 0!==t.y1&&(t.y1=e(t.y1)),void 0!==t.x2&&(t.x2=e(t.x2)),void 0!==t.y2&&(t.y2=e(t.y2)),void 0!==t.x&&(t.x=e(t.x)),void 0!==t.y&&(t.y=e(t.y)),void 0!==t.rX&&(t.rX=e(t.rX)),void 0!==t.rY&&(t.rY=e(t.rY)),t}},t.TO_ABS=e,t.TO_REL=function(){return n((function(t,e,i){return t.relative||(void 0!==t.x1&&(t.x1-=e),void 0!==t.y1&&(t.y1-=i),void 0!==t.x2&&(t.x2-=e),void 0!==t.y2&&(t.y2-=i),void 0!==t.x&&(t.x-=e),void 0!==t.y&&(t.y-=i),t.relative=!0),t}))},t.NORMALIZE_HVZ=function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),n((function(r,n,a,o,l){if(isNaN(o)&&!(r.type&b.MOVE_TO))throw new Error("path must start with moveto");return e&&r.type&b.HORIZ_LINE_TO&&(r.type=b.LINE_TO,r.y=r.relative?0:a),i&&r.type&b.VERT_LINE_TO&&(r.type=b.LINE_TO,r.x=r.relative?0:n),t&&r.type&b.CLOSE_PATH&&(r.type=b.LINE_TO,r.x=r.relative?o-n:o,r.y=r.relative?l-a:l),r.type&b.ARC&&(0===r.rX||0===r.rY)&&(r.type=b.LINE_TO,delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag),r}))},t.NORMALIZE_ST=i,t.QT_TO_C=r,t.INFO=n,t.SANITIZE=function(t){void 0===t&&(t=0),o(t);var e=NaN,i=NaN,r=NaN,a=NaN;return n((function(n,o,l,c,u){var h=Math.abs,p=!1,d=0,f=0;if(n.type&b.SMOOTH_CURVE_TO&&(d=isNaN(e)?0:o-e,f=isNaN(i)?0:l-i),n.type&(b.CURVE_TO|b.SMOOTH_CURVE_TO)?(e=n.relative?o+n.x2:n.x2,i=n.relative?l+n.y2:n.y2):(e=NaN,i=NaN),n.type&b.SMOOTH_QUAD_TO?(r=isNaN(r)?o:2*o-r,a=isNaN(a)?l:2*l-a):n.type&b.QUAD_TO?(r=n.relative?o+n.x1:n.x1,a=n.relative?l+n.y1:n.y2):(r=NaN,a=NaN),n.type&b.LINE_COMMANDS||n.type&b.ARC&&(0===n.rX||0===n.rY||!n.lArcFlag)||n.type&b.CURVE_TO||n.type&b.SMOOTH_CURVE_TO||n.type&b.QUAD_TO||n.type&b.SMOOTH_QUAD_TO){var m=void 0===n.x?0:n.relative?n.x:n.x-o,g=void 0===n.y?0:n.relative?n.y:n.y-l;d=isNaN(r)?void 0===n.x1?d:n.relative?n.x:n.x1-o:r-o,f=isNaN(a)?void 0===n.y1?f:n.relative?n.y:n.y1-l:a-l;var y=void 0===n.x2?0:n.relative?n.x:n.x2-o,_=void 0===n.y2?0:n.relative?n.y:n.y2-l;h(m)<=t&&h(g)<=t&&h(d)<=t&&h(f)<=t&&h(y)<=t&&h(_)<=t&&(p=!0)}return n.type&b.CLOSE_PATH&&h(o-c)<=t&&h(l-u)<=t&&(p=!0),p?[]:n}))},t.MATRIX=l,t.ROTATE=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),o(t,e,i);var r=Math.sin(t),n=Math.cos(t);return l(n,r,-r,n,e-e*n+i*r,i-e*r-i*n)},t.TRANSLATE=function(t,e){return void 0===e&&(e=0),o(t,e),l(1,0,0,1,t,e)},t.SCALE=function(t,e){return void 0===e&&(e=t),o(t,e),l(t,0,0,e,0,0)},t.SKEW_X=function(t){return o(t),l(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return o(t),l(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),o(t),l(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),o(t),l(1,0,0,-1,0,t)},t.A_TO_C=function(){return n((function(t,e,i){return b.ARC===t.type?function(t,e,i){var r,n,o,l;t.cX||c(t,e,i);for(var u=Math.min(t.phi1,t.phi2),d=Math.max(t.phi1,t.phi2)-u,f=Math.ceil(d/90),m=new Array(f),g=e,y=i,_=0;_<f;_++){var v=p(t.phi1,t.phi2,_/f),x=p(t.phi1,t.phi2,(_+1)/f),w=x-v,C=4/3*Math.tan(w*h/4),S=[Math.cos(v*h)-C*Math.sin(v*h),Math.sin(v*h)+C*Math.cos(v*h)],M=S[0],T=S[1],E=[Math.cos(x*h),Math.sin(x*h)],A=E[0],I=E[1],P=[A+C*Math.sin(x*h),I-C*Math.cos(x*h)],O=P[0],k=P[1];m[_]={relative:t.relative,type:b.CURVE_TO};var D=function(e,i){var r=a([e*t.rX,i*t.rY],t.xRot),n=r[0],o=r[1];return[t.cX+n,t.cY+o]};r=D(M,T),m[_].x1=r[0],m[_].y1=r[1],n=D(O,k),m[_].x2=n[0],m[_].y2=n[1],o=D(A,I),m[_].x=o[0],m[_].y=o[1],t.relative&&(m[_].x1-=g,m[_].y1-=y,m[_].x2-=g,m[_].y2-=y,m[_].x-=g,m[_].y-=y),g=(l=[m[_].x,m[_].y])[0],y=l[1]}return m}(t,t.relative?0:e,t.relative?0:i):t}))},t.ANNOTATE_ARCS=function(){return n((function(t,e,i){return t.relative&&(e=0,i=0),b.ARC===t.type&&c(t,e,i),t}))},t.CLONE=function(){return function(t){var e={};for(var i in t)e[i]=t[i];return e}},t.CALCULATE_BOUNDS=function(){var t=e(),a=r(),o=i(),l=n((function(e,i,r){var n=o(a(t(function(t){var e={};for(var i in t)e[i]=t[i];return e}(e))));function h(t){t>l.maxX&&(l.maxX=t),t<l.minX&&(l.minX=t)}function p(t){t>l.maxY&&(l.maxY=t),t<l.minY&&(l.minY=t)}if(n.type&b.DRAWING_COMMANDS&&(h(i),p(r)),n.type&b.HORIZ_LINE_TO&&h(n.x),n.type&b.VERT_LINE_TO&&p(n.y),n.type&b.LINE_TO&&(h(n.x),p(n.y)),n.type&b.CURVE_TO){h(n.x),p(n.y);for(var g=0,y=f(i,n.x1,n.x2,n.x);g<y.length;g++)0<(F=y[g])&&1>F&&h(m(i,n.x1,n.x2,n.x,F));for(var _=0,v=f(r,n.y1,n.y2,n.y);_<v.length;_++)0<(F=v[_])&&1>F&&p(m(r,n.y1,n.y2,n.y,F))}if(n.type&b.ARC){h(n.x),p(n.y),c(n,i,r);for(var x=n.xRot/180*Math.PI,w=Math.cos(x)*n.rX,C=Math.sin(x)*n.rX,S=-Math.sin(x)*n.rY,M=Math.cos(x)*n.rY,T=n.phi1<n.phi2?[n.phi1,n.phi2]:-180>n.phi2?[n.phi2+360,n.phi1+360]:[n.phi2,n.phi1],E=T[0],A=T[1],I=function(t){var e=t[0],i=t[1],r=180*Math.atan2(i,e)/Math.PI;return r<E?r+360:r},P=0,O=u(S,-w,0).map(I);P<O.length;P++)(F=O[P])>E&&F<A&&h(d(n.cX,w,S,F));for(var k=0,D=u(M,-C,0).map(I);k<D.length;k++){var F;(F=D[k])>E&&F<A&&p(d(n.cY,C,M,F))}}return e}));return l.minX=1/0,l.maxX=-1/0,l.minY=1/0,l.maxY=-1/0,l}}(t.SVGPathDataTransformer||(t.SVGPathDataTransformer={}));var g,y=function(){function e(){}return e.prototype.round=function(e){return this.transform(t.SVGPathDataTransformer.ROUND(e))},e.prototype.toAbs=function(){return this.transform(t.SVGPathDataTransformer.TO_ABS())},e.prototype.toRel=function(){return this.transform(t.SVGPathDataTransformer.TO_REL())},e.prototype.normalizeHVZ=function(e,i,r){return this.transform(t.SVGPathDataTransformer.NORMALIZE_HVZ(e,i,r))},e.prototype.normalizeST=function(){return this.transform(t.SVGPathDataTransformer.NORMALIZE_ST())},e.prototype.qtToC=function(){return this.transform(t.SVGPathDataTransformer.QT_TO_C())},e.prototype.aToC=function(){return this.transform(t.SVGPathDataTransformer.A_TO_C())},e.prototype.sanitize=function(e){return this.transform(t.SVGPathDataTransformer.SANITIZE(e))},e.prototype.translate=function(e,i){return this.transform(t.SVGPathDataTransformer.TRANSLATE(e,i))},e.prototype.scale=function(e,i){return this.transform(t.SVGPathDataTransformer.SCALE(e,i))},e.prototype.rotate=function(e,i,r){return this.transform(t.SVGPathDataTransformer.ROTATE(e,i,r))},e.prototype.matrix=function(e,i,r,n,a,o){return this.transform(t.SVGPathDataTransformer.MATRIX(e,i,r,n,a,o))},e.prototype.skewX=function(e){return this.transform(t.SVGPathDataTransformer.SKEW_X(e))},e.prototype.skewY=function(e){return this.transform(t.SVGPathDataTransformer.SKEW_Y(e))},e.prototype.xSymmetry=function(e){return this.transform(t.SVGPathDataTransformer.X_AXIS_SYMMETRY(e))},e.prototype.ySymmetry=function(e){return this.transform(t.SVGPathDataTransformer.Y_AXIS_SYMMETRY(e))},e.prototype.annotateArcs=function(){return this.transform(t.SVGPathDataTransformer.ANNOTATE_ARCS())},e}(),_=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},v=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},x=function(t){function e(){var e=t.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return i(e,t),e.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,e){var i=this;void 0===e&&(e=[]);for(var r=function(t){e.push(t),i.curArgs.length=0,i.canParseCommandOrComma=!0},n=0;n<t.length;n++){var a=t[n],o=!(this.curCommandType!==b.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),l=v(a)&&("0"===this.curNumber&&"0"===a||o);if(!v(a)||l)if("e"!==a&&"E"!==a)if("-"!==a&&"+"!==a||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==a||this.curNumberHasExp||this.curNumberHasDecimal||o){if(this.curNumber&&-1!==this.curCommandType){var c=Number(this.curNumber);if(isNaN(c))throw new SyntaxError("Invalid number ending at "+n);if(this.curCommandType===b.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>c)throw new SyntaxError('Expected positive number, got "'+c+'" at index "'+n+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+n+'"');this.curArgs.push(c),this.curArgs.length===w[this.curCommandType]&&(b.HORIZ_LINE_TO===this.curCommandType?r({type:b.HORIZ_LINE_TO,relative:this.curCommandRelative,x:c}):b.VERT_LINE_TO===this.curCommandType?r({type:b.VERT_LINE_TO,relative:this.curCommandRelative,y:c}):this.curCommandType===b.MOVE_TO||this.curCommandType===b.LINE_TO||this.curCommandType===b.SMOOTH_QUAD_TO?(r({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),b.MOVE_TO===this.curCommandType&&(this.curCommandType=b.LINE_TO)):this.curCommandType===b.CURVE_TO?r({type:b.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===b.SMOOTH_CURVE_TO?r({type:b.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===b.QUAD_TO?r({type:b.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===b.ARC&&r({type:b.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!_(a))if(","===a&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==a&&"-"!==a&&"."!==a)if(l)this.curNumber=a,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+n+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+a+'" at index '+n+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==a&&"Z"!==a)if("h"===a||"H"===a)this.curCommandType=b.HORIZ_LINE_TO,this.curCommandRelative="h"===a;else if("v"===a||"V"===a)this.curCommandType=b.VERT_LINE_TO,this.curCommandRelative="v"===a;else if("m"===a||"M"===a)this.curCommandType=b.MOVE_TO,this.curCommandRelative="m"===a;else if("l"===a||"L"===a)this.curCommandType=b.LINE_TO,this.curCommandRelative="l"===a;else if("c"===a||"C"===a)this.curCommandType=b.CURVE_TO,this.curCommandRelative="c"===a;else if("s"===a||"S"===a)this.curCommandType=b.SMOOTH_CURVE_TO,this.curCommandRelative="s"===a;else if("q"===a||"Q"===a)this.curCommandType=b.QUAD_TO,this.curCommandRelative="q"===a;else if("t"===a||"T"===a)this.curCommandType=b.SMOOTH_QUAD_TO,this.curCommandRelative="t"===a;else{if("a"!==a&&"A"!==a)throw new SyntaxError('Unexpected character "'+a+'" at index '+n+".");this.curCommandType=b.ARC,this.curCommandRelative="a"===a}else e.push({type:b.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=a,this.curNumberHasDecimal="."===a}else this.curNumber+=a,this.curNumberHasDecimal=!0;else this.curNumber+=a;else this.curNumber+=a,this.curNumberHasExp=!0;else this.curNumber+=a,this.curNumberHasExpDigits=this.curNumberHasExp}return e},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(e,i){void 0===i&&(i=[]);for(var r=0,n=Object.getPrototypeOf(this).parse.call(this,e);r<n.length;r++){var a=n[r],o=t(a);Array.isArray(o)?i.push.apply(i,o):i.push(o)}return i}}})},e}(y),b=function(e){function r(t){var i=e.call(this)||this;return i.commands="string"==typeof t?r.parse(t):t,i}return i(r,e),r.prototype.encode=function(){return r.encode(this.commands)},r.prototype.getBounds=function(){var e=t.SVGPathDataTransformer.CALCULATE_BOUNDS();return this.transform(e),e},r.prototype.transform=function(t){for(var e=[],i=0,r=this.commands;i<r.length;i++){var n=t(r[i]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return this.commands=e,this},r.encode=function(t){return n(t)},r.parse=function(t){var e=new x,i=[];return e.parse(t,i),e.finish(i),i},r.CLOSE_PATH=1,r.MOVE_TO=2,r.HORIZ_LINE_TO=4,r.VERT_LINE_TO=8,r.LINE_TO=16,r.CURVE_TO=32,r.SMOOTH_CURVE_TO=64,r.QUAD_TO=128,r.SMOOTH_QUAD_TO=256,r.ARC=512,r.LINE_COMMANDS=r.LINE_TO|r.HORIZ_LINE_TO|r.VERT_LINE_TO,r.DRAWING_COMMANDS=r.HORIZ_LINE_TO|r.VERT_LINE_TO|r.LINE_TO|r.CURVE_TO|r.SMOOTH_CURVE_TO|r.QUAD_TO|r.SMOOTH_QUAD_TO|r.ARC,r}(y),w=((g={})[b.MOVE_TO]=2,g[b.LINE_TO]=2,g[b.HORIZ_LINE_TO]=1,g[b.VERT_LINE_TO]=1,g[b.CLOSE_PATH]=0,g[b.QUAD_TO]=4,g[b.SMOOTH_QUAD_TO]=2,g[b.CURVE_TO]=6,g[b.SMOOTH_CURVE_TO]=4,g[b.ARC]=7,g);t.COMMAND_ARG_COUNTS=w,t.SVGPathData=b,t.SVGPathDataParser=x,t.encodeSVGPath=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){t.exports=i(27)(2952)},function(t,e,i){t.exports=i(27)(1453)},function(t,e,i){t.exports=i(27)(775)},function(t,e,i){t.exports=i(27)(3058)},function(t,e,i){t.exports=i(27)(2853)},function(t,e,i){t.exports=i(27)(2933)},function(t,e,i){t.exports=i(27)(2939)},function(t,e,i){!function(t){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function n(t,i,r,n,a){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==e(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=t.getContext("2d");try{return o.getImageData(i,r,n,a)}catch(t){throw new Error("unable to access image data: "+t)}}function a(t,e,i,r,a,l){if(!(isNaN(l)||l<1)){l|=0;var c=n(t,e,i,r,a);c=o(c,0,0,r,a,l),t.getContext("2d").putImageData(c,e,i)}}function o(t,e,n,a,o,l){for(var c,h=t.data,p=2*l+1,d=a-1,f=o-1,m=l+1,g=m*(m+1)/2,y=new u,_=y,v=1;v<p;v++)_=_.next=new u,v===m&&(c=_);_.next=y;for(var x=null,b=null,w=0,C=0,S=i[l],M=r[l],T=0;T<o;T++){_=y;for(var E=h[C],A=h[C+1],I=h[C+2],P=h[C+3],O=0;O<m;O++)_.r=E,_.g=A,_.b=I,_.a=P,_=_.next;for(var k=0,D=0,F=0,z=0,j=m*E,N=m*A,B=m*I,V=m*P,U=g*E,H=g*A,q=g*I,Z=g*P,G=1;G<m;G++){var $=C+((d<G?d:G)<<2),W=h[$],X=h[$+1],Y=h[$+2],K=h[$+3],J=m-G;U+=(_.r=W)*J,H+=(_.g=X)*J,q+=(_.b=Y)*J,Z+=(_.a=K)*J,k+=W,D+=X,F+=Y,z+=K,_=_.next}x=y,b=c;for(var tt=0;tt<a;tt++){var et=Z*S>>M;if(h[C+3]=et,0!==et){var it=255/et;h[C]=(U*S>>M)*it,h[C+1]=(H*S>>M)*it,h[C+2]=(q*S>>M)*it}else h[C]=h[C+1]=h[C+2]=0;U-=j,H-=N,q-=B,Z-=V,j-=x.r,N-=x.g,B-=x.b,V-=x.a;var at=tt+l+1;at=w+(at<d?at:d)<<2,U+=k+=x.r=h[at],H+=D+=x.g=h[at+1],q+=F+=x.b=h[at+2],Z+=z+=x.a=h[at+3],x=x.next;var ot=b,lt=ot.r,ct=ot.g,ut=ot.b,ht=ot.a;j+=lt,N+=ct,B+=ut,V+=ht,k-=lt,D-=ct,F-=ut,z-=ht,b=b.next,C+=4}w+=a}for(var pt=0;pt<a;pt++){var dt=h[C=pt<<2],ft=h[C+1],mt=h[C+2],gt=h[C+3],yt=m*dt,_t=m*ft,vt=m*mt,Ct=m*gt,St=g*dt,Mt=g*ft,Tt=g*mt,Et=g*gt;_=y;for(var At=0;At<m;At++)_.r=dt,_.g=ft,_.b=mt,_.a=gt,_=_.next;for(var It=a,Lt=0,Pt=0,Ot=0,kt=0,Dt=1;Dt<=l;Dt++){C=It+pt<<2;var Ft=m-Dt;St+=(_.r=dt=h[C])*Ft,Mt+=(_.g=ft=h[C+1])*Ft,Tt+=(_.b=mt=h[C+2])*Ft,Et+=(_.a=gt=h[C+3])*Ft,kt+=dt,Lt+=ft,Pt+=mt,Ot+=gt,_=_.next,Dt<f&&(It+=a)}C=pt,x=y,b=c;for(var zt=0;zt<o;zt++){var Rt=C<<2;h[Rt+3]=gt=Et*S>>M,gt>0?(gt=255/gt,h[Rt]=(St*S>>M)*gt,h[Rt+1]=(Mt*S>>M)*gt,h[Rt+2]=(Tt*S>>M)*gt):h[Rt]=h[Rt+1]=h[Rt+2]=0,St-=yt,Mt-=_t,Tt-=vt,Et-=Ct,yt-=x.r,_t-=x.g,vt-=x.b,Ct-=x.a,Rt=pt+((Rt=zt+m)<f?Rt:f)*a<<2,St+=kt+=x.r=h[Rt],Mt+=Lt+=x.g=h[Rt+1],Tt+=Pt+=x.b=h[Rt+2],Et+=Ot+=x.a=h[Rt+3],x=x.next,yt+=dt=b.r,_t+=ft=b.g,vt+=mt=b.b,Ct+=gt=b.a,kt-=dt,Lt-=ft,Pt-=mt,Ot-=gt,b=b.next,C+=a}}return t}function l(t,e,i,r,a,o){if(!(isNaN(o)||o<1)){o|=0;var l=n(t,e,i,r,a);l=c(l,0,0,r,a,o),t.getContext("2d").putImageData(l,e,i)}}function c(t,e,n,a,o,l){for(var c,h=t.data,p=2*l+1,d=a-1,f=o-1,m=l+1,g=m*(m+1)/2,y=new u,_=y,v=1;v<p;v++)_=_.next=new u,v===m&&(c=_);_.next=y;for(var x,b,w=null,C=null,S=i[l],M=r[l],T=0,E=0,A=0;A<o;A++){var I=h[E],P=h[E+1],O=h[E+2],k=m*I,D=m*P,F=m*O,z=g*I,j=g*P,N=g*O;_=y;for(var B=0;B<m;B++)_.r=I,_.g=P,_.b=O,_=_.next;for(var V=0,U=0,H=0,q=1;q<m;q++)x=E+((d<q?d:q)<<2),z+=(_.r=I=h[x])*(b=m-q),j+=(_.g=P=h[x+1])*b,N+=(_.b=O=h[x+2])*b,V+=I,U+=P,H+=O,_=_.next;w=y,C=c;for(var Z=0;Z<a;Z++)h[E]=z*S>>M,h[E+1]=j*S>>M,h[E+2]=N*S>>M,z-=k,j-=D,N-=F,k-=w.r,D-=w.g,F-=w.b,x=T+((x=Z+l+1)<d?x:d)<<2,z+=V+=w.r=h[x],j+=U+=w.g=h[x+1],N+=H+=w.b=h[x+2],w=w.next,k+=I=C.r,D+=P=C.g,F+=O=C.b,V-=I,U-=P,H-=O,C=C.next,E+=4;T+=a}for(var G=0;G<a;G++){var $=h[E=G<<2],W=h[E+1],X=h[E+2],Y=m*$,K=m*W,J=m*X,tt=g*$,et=g*W,it=g*X;_=y;for(var at=0;at<m;at++)_.r=$,_.g=W,_.b=X,_=_.next;for(var ot=0,lt=0,ct=0,ut=1,ht=a;ut<=l;ut++)E=ht+G<<2,tt+=(_.r=$=h[E])*(b=m-ut),et+=(_.g=W=h[E+1])*b,it+=(_.b=X=h[E+2])*b,ot+=$,lt+=W,ct+=X,_=_.next,ut<f&&(ht+=a);E=G,w=y,C=c;for(var pt=0;pt<o;pt++)h[x=E<<2]=tt*S>>M,h[x+1]=et*S>>M,h[x+2]=it*S>>M,tt-=Y,et-=K,it-=J,Y-=w.r,K-=w.g,J-=w.b,x=G+((x=pt+m)<f?x:f)*a<<2,tt+=ot+=w.r=h[x],et+=lt+=w.g=h[x+1],it+=ct+=w.b=h[x+2],w=w.next,Y+=$=C.r,K+=W=C.g,J+=X=C.b,ot-=$,lt-=W,ct-=X,C=C.next,E+=a}return t}var u=function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};t.BlurStack=u,t.canvasRGB=l,t.canvasRGBA=a,t.image=function(t,e,i,r,n,o){if("string"==typeof t&&(t=document.getElementById(t)),t&&"naturalWidth"in t){var c=n?"offset":"natural",u=t[c+"Width"],h=t[c+"Height"];if("string"==typeof e&&(e=document.getElementById(e)),e&&"getContext"in e){o||(e.style.width=u+"px",e.style.height=h+"px"),e.width=u,e.height=h;var p=e.getContext("2d");p.clearRect(0,0,u,h),p.drawImage(t,0,0,t.naturalWidth,t.naturalHeight,0,0,u,h),isNaN(i)||i<1||(r?a(e,0,0,u,h,i):l(e,0,0,u,h,i))}}},t.imageDataRGB=c,t.imageDataRGBA=o,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){t.exports=function(){"use strict";var t="3.1.0";function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i=r;function r(t,e){this.x=t,this.y=e}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-r*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t};var n=e(i),a=o;function o(t,e,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=r}o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,r=0;r<8;r++){var n=this.sampleCurveX(i)-t;if(Math.abs(n)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=n/a}var o=0,l=1;for(i=t,r=0;r<20&&(n=this.sampleCurveX(i),!(Math.abs(n-t)<e));r++)t>n?o=i:l=i,i=.5*(l-o)+o;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var l=e(a);function c(t,e,i,r){const n=new l(t,e,i,r);return function(t){return n.solve(t)}}const u=c(.25,.1,.25,1);function h(t,e,i){return Math.min(i,Math.max(e,t))}function p(t,e,i){const r=i-e,n=((t-e)%r+r)%r+e;return n===e?i:n}function d(t,e,i){if(!t.length)return i(null,[]);let r=t.length;const n=new Array(t.length);let a=null;t.forEach(((t,o)=>{e(t,((t,e)=>{t&&(a=t),n[o]=e,0==--r&&i(a,n)}))}))}function f(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}function m(t,e){const i={};for(let r=0;r<e.length;r++){const n=e[r];n in t&&(i[n]=t[n])}return i}let g=1;function y(){return g++}function _(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function v(t,e,i){const r={};for(const n in t)r[n]=e.call(i||this,t[n],n,t);return r}function x(t,e,i){const r={};for(const n in t)e.call(i||this,t[n],n,t)&&(r[n]=t[n]);return r}function b(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!b(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!b(t[i],e[i]))return!1;return!0}return t===e}function w(t){return Array.isArray(t)?t.map(w):"object"==typeof t&&t?v(t,w):t}const C={};function S(t){C[t]||("undefined"!=typeof console&&console.warn(t),C[t]=!0)}function M(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function T(t){let e=0;for(let i,r,n=0,a=t.length,o=a-1;n<a;o=n++)i=t[n],r=t[o],e+=(r.x-i.x)*(i.y+r.y);return e}function E(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}let A=null;function I(t){if(null==A){const e=t.navigator?t.navigator.userAgent:null;A=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return A}function P(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let k,D;const F={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height),i},resolveURL:t=>(k||(k=document.createElement("a")),k.href=t,k.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==D&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}};class L{static testProp(t){if(!L.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in L.docStyle)return t[e];return t[0]}static create(t,e,i){const r=window.document.createElement(t);return void 0!==e&&(r.className=e),i&&i.appendChild(r),r}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(t,e){t.style[L.transformProp]=e}static addEventListener(t,e,i,r={}){t.addEventListener(e,i,"passive"in r?r:r.capture)}static removeEventListener(t,e,i,r={}){t.removeEventListener(e,i,"passive"in r?r:r.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",L.suppressClickInternal,!0)}),0)}static mousePos(t,e){const i=t.getBoundingClientRect();return new n(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)}static touchPos(t,e){const i=t.getBoundingClientRect(),r=[];for(let a=0;a<e.length;a++)r.push(new n(e[a].clientX-i.left-t.clientLeft,e[a].clientY-i.top-t.clientTop));return r}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}L.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);const z={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class R extends Error{constructor(t,e,i,r){super(`AJAXError: ${e} (${t}): ${i}`),this.status=t,this.statusText=e,this.url=i,this.body=r}}const j=E()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,N=t=>z.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))];function B(t,e){const i=new AbortController,r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:j(),signal:i.signal});let n=!1,a=!1;return"json"===t.type&&r.headers.set("Accept","application/json"),a||fetch(r).then((i=>i.ok?(i=>{("arrayBuffer"===t.type||"image"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text()).then((t=>{a||(n=!0,e(null,t,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((t=>{a||e(new Error(t.message))}))})(i):i.blob().then((r=>e(new R(i.status,i.statusText,t.url,r)))))).catch((t=>{20!==t.code&&e(new Error(t.message))})),{cancel:()=>{a=!0,n||i.abort()}}}const V=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!E())return(N(t.url)||B)(t,e)}if(!(/^file:/.test(i=t.url)||/^file:/.test(j())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return B(t,e);if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(t,e){const i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(i.responseType="arraybuffer");for(const e in t.headers)i.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===t.credentials,i.onerror=()=>{e(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let r=i.response;if("json"===t.type)try{r=JSON.parse(i.response)}catch(t){return e(t)}e(null,r,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else{const r=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});e(new R(i.status,i.statusText,t.url,r))}},i.send(t.body),{cancel:()=>i.abort()}}(t,e)},U=function(t,e){return V(f(t,{type:"json"}),e)},H=function(t,e){return V(f(t,{type:"arrayBuffer"}),e)};function q(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),i=window.location;return e.protocol===i.protocol&&e.host===i.host}const Z={supported:!1,testSupport:function(t){!W&&$&&(X?Y(t):G=t)}};let G,$,W=!1,X=!1;function Y(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,$),t.isContextLost())return;Z.supported=!0}catch(t){}t.deleteTexture(e),W=!0}var K;"undefined"!=typeof document&&($=document.createElement("img"),$.onload=function(){G&&Y(G),G=null,X=!0},$.onerror=function(){W=!0,G=null},$.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let e,i,r,n;t.resetRequestQueue=()=>{e=[],i=0,r=0,n={}},t.addThrottleControl=t=>{const e=r++;return n[e]=t,e},t.removeThrottleControl=t=>{delete n[t],l()},t.getImage=(t,r,n=!0)=>{Z.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*");const a={requestParameters:t,supportImageRefresh:n,callback:r,cancelled:!1,completed:!1,cancel:()=>{a.completed||a.cancelled||(a.cancelled=!0,a.innerRequest&&(a.innerRequest.cancel(),i--),l())}};return e.push(a),l(),a};const a=t=>{const{requestParameters:e,supportImageRefresh:i,callback:r}=t;return f(e,{type:"image"}),(!1!==i||E()||N(e.url)||e.headers&&!Object.keys(e.headers).reduce(((t,e)=>t&&"accept"===e),!0)?V:c)(e,((e,i,n,a)=>{o(t,r,e,i,n,a)}))},o=(t,e,r,n,a,o)=>{r?e(r):n instanceof HTMLImageElement||n instanceof ImageBitmap?e(null,n):n&&((t,e)=>{"function"==typeof createImageBitmap?function(t,e){const i=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(i).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(t,e):function(t,e){const i=new Image;i.onload=()=>{e(null,i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=O}))},i.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(r):O}(t,e)})(n,((t,i)=>{null!=t?e(t):null!=i&&e(null,i,{cacheControl:a,expires:o})})),t.cancelled||(t.completed=!0,i--,l())},l=()=>{const t=(()=>{const t=Object.keys(n);let e=!1;if(t.length>0)for(const i of t)if(e=n[i](),e)break;return e})()?z.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:z.MAX_PARALLEL_IMAGE_REQUESTS;for(let r=i;r<t&&e.length>0;r++){const t=e.shift();if(t.cancelled){r--;continue}const n=a(t);i++,t.innerRequest=n}},c=(t,e)=>{const i=new Image,r=t.url;let n=!1;const a=t.credentials;return a&&"include"===a?i.crossOrigin="use-credentials":(a&&"same-origin"===a||!q(r))&&(i.crossOrigin="anonymous"),i.fetchPriority="high",i.onload=()=>{e(null,i),i.onerror=i.onload=null},i.onerror=()=>{n||e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),i.onerror=i.onload=null},i.src=r,{cancel:()=>{n=!0,i.src=""}}}}(K||(K={})),K.resetRequestQueue();var J,tt=K;!function(t){t.Glyphs="Glyphs",t.Image="Image",t.Source="Source",t.SpriteImage="SpriteImage",t.SpriteJSON="SpriteJSON",t.Style="Style",t.Tile="Tile",t.Unknown="Unknown"}(J||(J={}));class Q{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeSpriteURL(t,e,i){const r=function(t){const e=t.match(et);if(!e)throw new Error(`Unable to parse URL "${t}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}(t);return r.path+=`${e}${i}`,function(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}(r)}setTransformRequest(t){this._transformRequestFn=t}}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function it(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function at(t,e,i){if(i&&i[t]){const r=i[t].indexOf(e);-1!==r&&i[t].splice(r,1)}}class rt{constructor(t,e={}){f(this,e),this.type=t}}class st extends rt{constructor(t,e={}){super("error",f({error:t},e))}}class nt{on(t,e){return this._listeners=this._listeners||{},it(t,e,this._listeners),this}off(t,e){return at(t,e,this._listeners),at(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},it(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new rt(t,e||{}));const i=t.type;if(this.listens(i)){t.target=this;const e=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of e)i.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const e of r)at(i,e,this._oneTimeListeners),e.call(this,t);const n=this._eventedParent;n&&(f(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(t))}else t instanceof st&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var ot={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const lt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ct(t,e){const i={};for(const e in t)"ref"!==e&&(i[e]=t[e]);return lt.forEach((t=>{t in e&&(i[t]=e[t])})),i}function ut(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=ct(t[i],e[t[i].ref]));return t}function ht(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!ht(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!ht(t[i],e[i]))return!1;return!0}return t===e}const pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function dt(t,e,i){i.push({command:pt.addSource,args:[t,e[t]]})}function ft(t,e,i){e.push({command:pt.removeSource,args:[t]}),i[t]=!0}function mt(t,e,i,r){ft(t,i,r),dt(t,e,i)}function gt(t,e,i){let r;for(r in t[i])if(Object.prototype.hasOwnProperty.call(t[i],r)&&"data"!==r&&!ht(t[i][r],e[i][r]))return!1;for(r in e[i])if(Object.prototype.hasOwnProperty.call(e[i],r)&&"data"!==r&&!ht(t[i][r],e[i][r]))return!1;return!0}function yt(t,e,i,r,n,a){let o;for(o in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,o)&&(ht(t[o],e[o])||i.push({command:a,args:[r,o,e[o],n]}));for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&!Object.prototype.hasOwnProperty.call(t,o)&&(ht(t[o],e[o])||i.push({command:a,args:[r,o,e[o],n]}))}function _t(t){return t.id}function vt(t,e){return t[e.id]=e,t}class xt{constructor(t,e,i,r){this.message=(t?`${t}: `:"")+i,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function Ct(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}class bt extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class wt{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,i]of e)this.bindings[t]=i}concat(t){return new wt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const St={kind:"null"},Mt={kind:"number"},Tt={kind:"string"},Et={kind:"boolean"},At={kind:"color"},It={kind:"object"},Lt={kind:"value"},Pt={kind:"collator"},Ot={kind:"formatted"},kt={kind:"padding"},Dt={kind:"resolvedImage"};function Ft(t,e){return{kind:"array",itemType:t,N:e}}function zt(t){if("array"===t.kind){const e=zt(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Rt=[St,Mt,Tt,Et,At,Ot,It,Ft(Lt),kt,Dt];function jt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!jt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Rt)if(!jt(t,e))return null}return`Expected ${zt(t)} but found ${zt(e)} instead.`}function Nt(t,e){return e.some((e=>e.kind===t.kind))}function Bt(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function Vt(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const Ut=.96422,Ht=.82521,qt=4/29,Zt=6/29,Gt=3*Zt*Zt,$t=Zt*Zt*Zt,Wt=Math.PI/180,Xt=180/Math.PI;function Yt(t){return(t%=360)<0&&(t+=360),t}function Kt([t,e,i,r]){let n,a;const o=Qt((.2225045*(t=Jt(t))+.7168786*(e=Jt(e))+.0606169*(i=Jt(i)))/1);t===e&&e===i?n=a=o:(n=Qt((.4360747*t+.3850649*e+.1430804*i)/Ut),a=Qt((.0139322*t+.0971045*e+.7141733*i)/Ht));const l=116*o-16;return[l<0?0:l,500*(n-o),200*(o-a),r]}function Jt(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Qt(t){return t>$t?Math.pow(t,1/3):t/Gt+qt}function te([t,e,i,r]){let n=(t+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(i)?n:n-i/200;return n=1*ie(n),a=Ut*ie(a),o=Ht*ie(o),[ee(3.1338561*a-1.6168667*n-.4906146*o),ee(-.9787684*a+1.9161415*n+.033454*o),ee(.0719453*a-.2289914*n+1.4052427*o),r]}function ee(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function ie(t){return t>Zt?t*t*t:Gt*(t-qt)}function re(t){return parseInt(t.padEnd(2,t),16)/255}function ne(t,e){return se(e?t/100:t,0,1)}function se(t,e,i){return Math.min(Math.max(e,t),i)}function ae(t){return!t.some(Number.isNaN)}const de={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class oe{constructor(t,e,i,r=1,n=!0){this.r=t,this.g=e,this.b=i,this.a=r,n||(this.r*=r,this.g*=r,this.b*=r,r||this.overwriteGetter("rgb",[t,e,i,r]))}static parse(t){if(t instanceof oe)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase()))return[0,0,0,0];const e=de[t];if(e){const[t,i,r]=e;return[t/255,i/255,r/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let i=1;return[re(t.slice(i,i+=e)),re(t.slice(i,i+=e)),re(t.slice(i,i+=e)),re(t.slice(i,i+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,i,r,n,a,o,l,c,u,h,p,d]=e,f=[n||" ",l||" ",h].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f){const t=[r,o,u].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[se(+i/e,0,1),se(+a/e,0,1),se(+c/e,0,1),p?ne(+p,d):1];if(ae(t))return t}}return}}const i=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(i){const[t,e,r,n,a,o,l,c,u]=i,h=[r||" ",a||" ",l].join("");if("  "===h||"  /"===h||",,"===h||",,,"===h){const t=[+e,se(+n,0,100),se(+o,0,100),c?ne(+c,u):1];if(ae(t))return function([t,e,i,r]){function n(r){const n=(r+t/30)%12,a=e*Math.min(i,1-i);return i-a*Math.max(-1,Math.min(n-3,9-n,1))}return t=Yt(t),e/=100,i/=100,[n(0),n(8),n(4),r]}(t)}}}(t);return e?new oe(...e,!1):void 0}get rgb(){const{r:t,g:e,b:i,a:r}=this,n=r||1/0;return this.overwriteGetter("rgb",[t/n,e/n,i/n,r])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,i,r,n]=Kt(t),a=Math.sqrt(i*i+r*r);return[Math.round(1e4*a)?Yt(Math.atan2(r,i)*Xt):NaN,a,e,n]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Kt(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,i,r]=this.rgb;return`rgba(${[t,e,i].map((t=>Math.round(255*t))).join(",")},${r})`}}oe.black=new oe(0,0,0,1),oe.white=new oe(1,1,1,1),oe.transparent=new oe(0,0,0,0),oe.red=new oe(1,0,0,1);class le{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ce{constructor(t,e,i,r,n){this.text=t,this.image=e,this.scale=i,this.fontStack=r,this.textColor=n}}class he{constructor(t){this.sections=t}static fromString(t){return new he([new ce(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof he?t:he.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class ue{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ue)return t;if("number"==typeof t)return new ue([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ue(t)}}toString(){return JSON.stringify(this.values)}}class pe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new pe({name:t,available:!1}):null}}function fe(t,e,i,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[t,e,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[t,e,i,r]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function me(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof oe)return!0;if(t instanceof le)return!0;if(t instanceof he)return!0;if(t instanceof ue)return!0;if(t instanceof pe)return!0;if(Array.isArray(t)){for(const e of t)if(!me(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!me(t[e]))return!1;return!0}return!1}function _e(t){if(null===t)return St;if("string"==typeof t)return Tt;if("boolean"==typeof t)return Et;if("number"==typeof t)return Mt;if(t instanceof oe)return At;if(t instanceof le)return Pt;if(t instanceof he)return Ot;if(t instanceof ue)return kt;if(t instanceof pe)return Dt;if(Array.isArray(t)){const e=t.length;let i;for(const e of t){const t=_e(e);if(i){if(i===t)continue;i=Lt;break}i=t}return Ft(i||Lt,e)}return It}function xe(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof oe||t instanceof he||t instanceof ue||t instanceof pe?t.toString():JSON.stringify(t)}class ge{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!me(t[1]))return e.error("invalid value");const i=t[1];let r=_e(i);const n=e.expectedType;return"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new ge(r,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ye{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const be={string:Tt,number:Mt,boolean:Et,object:It};class ve{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,r=1;const n=t[0];if("array"===n){let n,a;if(t.length>2){const i=t[1];if("string"!=typeof i||!(i in be)||"object"===i)return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=be[i],r++}else n=Lt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}i=Ft(n,a)}else{if(!be[n])throw new Error(`Types doesn't contain name = ${n}`);i=be[n]}const a=[];for(;r<t.length;r++){const i=e.parse(t[r],r,Lt);if(!i)return null;a.push(i)}return new ve(i,a)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!jt(this.type,_e(i)))return i;if(e===this.args.length-1)throw new ye(`Expected value to be of type ${zt(this.type)}, but found ${zt(_e(i))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Ce={"to-boolean":Et,"to-color":At,"to-number":Mt,"to-string":Tt};class we{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(!Ce[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const r=Ce[i],n=[];for(let i=1;i<t.length;i++){const r=e.parse(t[i],i,Lt);if(!r)return null;n.push(r)}return new we(r,n)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,i;for(const r of this.args){if(e=r.evaluate(t),i=null,e instanceof oe)return e;if("string"==typeof e){const i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:fe(e[0],e[1],e[2],e[3]),!i))return new oe(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ye(i||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}if("padding"===this.type.kind){let e;for(const i of this.args){e=i.evaluate(t);const r=ue.parse(e);if(r)return r}throw new ye(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}if("number"===this.type.kind){let e=null;for(const i of this.args){if(e=i.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new ye(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?he.fromString(xe(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?pe.fromString(xe(this.args[0].evaluate(t))):xe(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Me=["Unknown","Point","LineString","Polygon"];class Se{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Me[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=oe.parse(t)),e}}class Ie{constructor(t,e,i=[],r,n=new wt,a=[]){this.registry=t,this.path=i,this.key=i.map((t=>`[${t}]`)).join(""),this.scope=n,this.errors=a,this.expectedType=r,this._isConstant=e}parse(t,e,i,r,n={}){return e?this.concat(e,i,r)._parse(t,n):this._parse(t,n)}_parse(t,e){function i(t,e,i){return"assert"===i?new ve(e,[t]):"coerce"===i?new we(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const n=this.registry[r];if(n){let r=n.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,n=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==n.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==n.kind&&"string"!==n.kind)if("padding"!==t.kind||"value"!==n.kind&&"number"!==n.kind&&"array"!==n.kind){if(this.checkSubtype(t,n))return null}else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"assert")}if(!(r instanceof ge)&&"resolvedImage"!==r.type.kind&&this._isConstant(r)){const e=new Se;try{r=new ge(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const r="number"==typeof t?this.path.concat(t):this.path,n=i?this.scope.concat(i):this.scope;return new Ie(this.registry,this._isConstant,r,e||null,n,this.errors)}error(t,...e){const i=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new bt(i,t))}checkSubtype(t,e){const i=jt(t,e);return i&&this.error(i),i}}class Ae{constructor(t,e,i){this.type=Pt,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Et);if(!r)return null;const n=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Et);if(!n)return null;let a=null;return i.locale&&(a=e.parse(i.locale,1,Tt),!a)?null:new Ae(r,n,a)}evaluate(t){return new le(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const Te=8192;function Ee(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Le(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Pe(t,e){const i=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,n=Math.pow(2,e.z);return[Math.round(i*n*Te),Math.round(r*n*Te)]}function Oe(t,e,i){const r=t[0]-e[0],n=t[1]-e[1],a=t[0]-i[0],o=t[1]-i[1];return r*o-a*n==0&&r*a<=0&&n*o<=0}function ke(t,e){let i=!1;for(let o=0,l=e.length;o<l;o++){const l=e[o];for(let e=0,o=l.length;e<o-1;e++){if(Oe(t,l[e],l[e+1]))return!1;(n=l[e])[1]>(r=t)[1]!=(a=l[e+1])[1]>r[1]&&r[0]<(a[0]-n[0])*(r[1]-n[1])/(a[1]-n[1])+n[0]&&(i=!i)}}var r,n,a;return i}function De(t,e){for(let i=0;i<e.length;i++)if(ke(t,e[i]))return!0;return!1}function Fe(t,e,i,r){const n=r[0]-i[0],a=r[1]-i[1],o=(t[0]-i[0])*a-n*(t[1]-i[1]),l=(e[0]-i[0])*a-n*(e[1]-i[1]);return o>0&&l<0||o<0&&l>0}function ze(t,e,i){for(const u of i)for(let i=0;i<u.length-1;++i)if(0!=(l=[(o=u[i+1])[0]-(a=u[i])[0],o[1]-a[1]])[0]*(c=[(n=e)[0]-(r=t)[0],n[1]-r[1]])[1]-l[1]*c[0]&&Fe(r,n,a,o)&&Fe(a,o,r,n))return!0;var r,n,a,o,l,c;return!1}function Re(t,e){for(let i=0;i<t.length;++i)if(!ke(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(ze(t[i],t[i+1],e))return!1;return!0}function Ne(t,e){for(let i=0;i<e.length;i++)if(Re(t,e[i]))return!0;return!1}function Be(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=[];for(let r=0;r<t[n].length;r++){const o=Pe(t[n][r],i);Ee(e,o),a.push(o)}r.push(a)}return r}function Ve(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=Be(t[n],e,i);r.push(a)}return r}function Ue(t,e,i,r){if(t[0]<i[0]||t[0]>i[2]){const e=.5*r;let n=t[0]-i[0]>e?-r:i[0]-t[0]>e?r:0;0===n&&(n=t[0]-i[2]>e?-r:i[2]-t[0]>e?r:0),t[0]+=n}Ee(e,t)}function He(t,e,i,r){const n=Math.pow(2,r.z)*Te,a=[r.x*Te,r.y*Te],o=[];for(const r of t)for(const t of r){const r=[t.x+a[0],t.y+a[1]];Ue(r,e,i,n),o.push(r)}return o}function Ge(t,e,i,r){const n=Math.pow(2,r.z)*Te,a=[r.x*Te,r.y*Te],o=[];for(const i of t){const t=[];for(const r of i){const i=[r.x+a[0],r.y+a[1]];Ee(e,i),t.push(i)}o.push(t)}if(e[2]-e[0]<=n/2){(l=e)[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(const t of o)for(const r of t)Ue(r,e,i,n)}var l;return o}class qe{constructor(t,e){this.type=Et,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(me(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const i=e.features[t].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new qe(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new qe(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new qe(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=Be(e.coordinates,r,n),o=He(t.geometry(),i,r,n);if(!Le(i,r))return!1;for(const t of o)if(!ke(t,a))return!1}if("MultiPolygon"===e.type){const a=Ve(e.coordinates,r,n),o=He(t.geometry(),i,r,n);if(!Le(i,r))return!1;for(const t of o)if(!De(t,a))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=Be(e.coordinates,r,n),o=Ge(t.geometry(),i,r,n);if(!Le(i,r))return!1;for(const t of o)if(!Re(t,a))return!1}if("MultiPolygon"===e.type){const a=Ve(e.coordinates,r,n),o=Ge(t.geometry(),i,r,n);if(!Le(i,r))return!1;for(const t of o)if(!Ne(t,a))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class je{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new je(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Ze{constructor(t,e,i,r){this.name=t,this.type=e,this._evaluate=i,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const i=t[0],r=Ze.definitions[i];if(!r)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const n=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,o=a.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let l=null;for(const[r,a]of o){l=new Ie(e.registry,$e,e.path,null,e.scope);const o=[];let c=!1;for(let e=1;e<t.length;e++){const i=t[e],n=Array.isArray(r)?r[e-1]:r.type,a=l.parse(i,1+o.length,n);if(!a){c=!0;break}o.push(a)}if(!c)if(Array.isArray(r)&&r.length!==o.length)l.error(`Expected ${r.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(r)?r[t]:r.type,i=o[t];l.concat(t+1).checkSubtype(e,i.type)}if(0===l.errors.length)return new Ze(i,n,a,o)}}if(1===o.length)e.errors.push(...l.errors);else{const i=(o.length?o:a).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(zt).join(", ")})`:`(${zt(e.type)}...)`;var e})).join(" | "),r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],1+r.length);if(!n)return null;r.push(zt(n.type))}e.error(`Expected arguments of type ${i}, but found (${r.join(", ")}) instead.`)}return null}static register(t,e){Ze.definitions=e;for(const i in e)t[i]=Ze}}function $e(t){if(t instanceof je)return $e(t.boundExpression);if(t instanceof Ze&&"error"===t.name)return!1;if(t instanceof Ae)return!1;if(t instanceof qe)return!1;const e=t instanceof we||t instanceof ve;let i=!0;return t.eachChild((t=>{i=e?i&&$e(t):i&&t instanceof ge})),!!i&&We(t)&&Ke(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function We(t){if(t instanceof Ze){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof qe)return!1;let e=!0;return t.eachChild((t=>{e&&!We(t)&&(e=!1)})),e}function Xe(t){if(t instanceof Ze&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!Xe(t)&&(e=!1)})),e}function Ke(t,e){if(t instanceof Ze&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild((t=>{i&&!Ke(t,e)&&(i=!1)})),i}function Je(t,e){const i=t.length-1;let r,n,a=0,o=i,l=0;for(;a<=o;)if(l=Math.floor((a+o)/2),r=t[l],n=t[l+1],r<=e){if(l===i||e<n)return l;a=l+1}else{if(!(r>e))throw new ye("Input is not a number.");o=l-1}return 0}class Ye{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,Mt);if(!i)return null;const r=[];let n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(let i=1;i<t.length;i+=2){const a=1===i?-1/0:t[i],o=t[i+1],l=i,c=i+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);const u=e.parse(o,c,n);if(!u)return null;n=n||u.type,r.push([a,u])}return new Ye(n,i,r)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;return r>=e[n-1]?i[n-1].evaluate(t):i[Je(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Qe(t,e,i){return t+i*(e-t)}function ti(t,e,i){return t.map(((t,r)=>Qe(t,e[r],i)))}const ii={number:Qe,color:function(t,e,i,r="rgb"){switch(r){case"rgb":{const[r,n,a,o]=ti(t.rgb,e.rgb,i);return new oe(r,n,a,o,!1)}case"hcl":{const[r,n,a,o]=t.hcl,[l,c,u,h]=e.hcl;let p,d;if(isNaN(r)||isNaN(l))isNaN(r)?isNaN(l)?p=NaN:(p=l,1!==a&&0!==a||(d=c)):(p=r,1!==u&&0!==u||(d=n));else{let t=l-r;l>r&&t>180?t-=360:l<r&&r-l>180&&(t+=360),p=r+i*t}const[f,m,g,y]=function([t,e,i,r]){return t=isNaN(t)?0:t*Wt,te([i,Math.cos(t)*e,Math.sin(t)*e,r])}([p,null!=d?d:Qe(n,c,i),Qe(a,u,i),Qe(o,h,i)]);return new oe(f,m,g,y,!1)}case"lab":{const[r,n,a,o]=te(ti(t.lab,e.lab,i));return new oe(r,n,a,o,!1)}}},array:ti,padding:function(t,e,i){return new ue(ti(t.values,e.values,i))}};class ei{constructor(t,e,i,r,n){this.type=t,this.operator=e,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,i,r){let n=0;if("exponential"===t.name)n=ui(e,t.base,i,r);else if("linear"===t.name)n=ui(e,1,i,r);else if("cubic-bezier"===t.name){const a=t.controlPoints;n=new l(a[0],a[1],a[2],a[3]).solve(ui(e,1,i,r))}return n}static parse(t,e){let[i,r,n,...a]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const t=r.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(n=e.parse(n,2,Mt),!n)return null;const o=[];let l=null;"interpolate-hcl"===i||"interpolate-lab"===i?l=At:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(let t=0;t<a.length;t+=2){const i=a[t],r=a[t+1],n=t+3,c=t+4;if("number"!=typeof i)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(o.length&&o[o.length-1][0]>=i)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const u=e.parse(r,c,l);if(!u)return null;l=l||u.type,o.push([i,u])}return Vt(l,Mt)||Vt(l,At)||Vt(l,kt)||Vt(l,Ft(Mt))?new ei(l,i,r,n,o):e.error(`Type ${zt(l)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;if(r>=e[n-1])return i[n-1].evaluate(t);const a=Je(e,r),o=ei.interpolationFactor(this.interpolation,r,e[a],e[a+1]),l=i[a].evaluate(t),c=i[a+1].evaluate(t);switch(this.operator){case"interpolate":return ii[this.type.kind](l,c,o);case"interpolate-hcl":return ii.color(l,c,o,"hcl");case"interpolate-lab":return ii.color(l,c,o,"lab")}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ui(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}class ri{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const r=e.expectedType;r&&"value"!==r.kind&&(i=r);const n=[];for(const r of t.slice(1)){const t=e.parse(r,1+n.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,n.push(t)}if(!i)throw new Error("No output type");const a=r&&n.some((t=>jt(r,t.type)));return new ri(a?Lt:i,n)}evaluate(t){let e,i=null,r=0;for(const n of this.args)if(r++,i=n.evaluate(t),i&&i instanceof pe&&!i.available&&(e||(e=i.name),i=null,r===this.args.length&&(i=e)),null!==i)break;return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}class si{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let r=1;r<t.length-1;r+=2){const n=t[r];if("string"!=typeof n)return e.error(`Expected string, but found ${typeof n} instead.`,r);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=e.parse(t[r+1],r+1);if(!a)return null;i.push([n,a])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return r?new si(i,r):null}outputDefined(){return this.result.outputDefined()}}class ni{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Mt),r=e.parse(t[2],2,Ft(e.expectedType||Lt));return i&&r?new ni(r.type.itemType,i,r):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new ye(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new ye(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new ye(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class ai{constructor(t,e){this.type=Et,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Lt),r=e.parse(t[2],2,Lt);return i&&r?Nt(i.type,[Et,Tt,Mt,St,Lt])?new ai(i,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${zt(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!Bt(e,["boolean","string","number","null"]))throw new ye(`Expected first argument to be of type boolean, string, number or null, but found ${zt(_e(e))} instead.`);if(!Bt(i,["string","array"]))throw new ye(`Expected second argument to be of type array or string, but found ${zt(_e(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class oi{constructor(t,e,i){this.type=Mt,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Lt),r=e.parse(t[2],2,Lt);if(!i||!r)return null;if(!Nt(i.type,[Et,Tt,Mt,St,Lt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${zt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,Mt);return n?new oi(i,r,n):null}return new oi(i,r)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!Bt(e,["boolean","string","number","null"]))throw new ye(`Expected first argument to be of type boolean, string, number or null, but found ${zt(_e(e))} instead.`);if(!Bt(i,["string","array"]))throw new ye(`Expected second argument to be of type array or string, but found ${zt(_e(i))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return i.indexOf(e,r)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class li{constructor(t,e,i,r,n,a){this.inputType=t,this.type=e,this.input=i,this.cases=r,this.outputs=n,this.otherwise=a}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const n={},a=[];for(let o=2;o<t.length-1;o+=2){let l=t[o];const c=t[o+1];Array.isArray(l)||(l=[l]);const u=e.concat(o);if(0===l.length)return u.error("Expected at least one branch label.");for(const t of l){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(i){if(u.checkSubtype(i,_e(t)))return null}else i=_e(t);if(void 0!==n[String(t)])return u.error("Branch labels must be unique.");n[String(t)]=a.length}const h=e.parse(c,o,r);if(!h)return null;r=r||h.type,a.push(h)}const o=e.parse(t[1],1,Lt);if(!o)return null;const l=e.parse(t[t.length-1],t.length-1,r);return l?"value"!==o.type.kind&&e.concat(1).checkSubtype(i,o.type)?null:new li(i,r,o,n,a,l):null}evaluate(t){const e=this.input.evaluate(t);return(_e(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class ci{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r=[];for(let n=1;n<t.length-1;n+=2){const a=e.parse(t[n],n,Et);if(!a)return null;const o=e.parse(t[n+1],n+1,i);if(!o)return null;r.push([a,o]),i=i||o.type}const n=e.parse(t[t.length-1],t.length-1,i);if(!n)return null;if(!i)throw new Error("Can't infer output type");return new ci(i,r,n)}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class hi{constructor(t,e,i,r){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Lt),r=e.parse(t[2],2,Mt);if(!i||!r)return null;if(!Nt(i.type,[Ft(Lt),Tt,Lt]))return e.error(`Expected first argument to be of type array or string, but found ${zt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,Mt);return n?new hi(i.type,i,r,n):null}return new hi(i.type,i,r)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!Bt(e,["string","array"]))throw new ye(`Expected first argument to be of type array or string, but found ${zt(_e(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(i,r)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function pi(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function di(t,e,i,r){return 0===r.compare(e,i)}function fi(t,e,i){const r="=="!==t&&"!="!==t;return class s{constructor(t,e,i){this.type=Et,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const i=t[0];let n=e.parse(t[1],1,Lt);if(!n)return null;if(!pi(i,n.type))return e.concat(1).error(`"${i}" comparisons are not supported for type '${zt(n.type)}'.`);let a=e.parse(t[2],2,Lt);if(!a)return null;if(!pi(i,a.type))return e.concat(2).error(`"${i}" comparisons are not supported for type '${zt(a.type)}'.`);if(n.type.kind!==a.type.kind&&"value"!==n.type.kind&&"value"!==a.type.kind)return e.error(`Cannot compare types '${zt(n.type)}' and '${zt(a.type)}'.`);r&&("value"===n.type.kind&&"value"!==a.type.kind?n=new ve(a.type,[n]):"value"!==n.type.kind&&"value"===a.type.kind&&(a=new ve(n.type,[a])));let o=null;if(4===t.length){if("string"!==n.type.kind&&"string"!==a.type.kind&&"value"!==n.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(o=e.parse(t[3],3,Pt),!o)return null}return new s(n,a,o)}evaluate(n){const a=this.lhs.evaluate(n),o=this.rhs.evaluate(n);if(r&&this.hasUntypedArgument){const e=_e(a),i=_e(o);if(e.kind!==i.kind||"string"!==e.kind&&"number"!==e.kind)throw new ye(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${i.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const t=_e(a),i=_e(o);if("string"!==t.kind||"string"!==i.kind)return e(n,a,o)}return this.collator?i(n,a,o,this.collator.evaluate(n)):e(n,a,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const mi=fi("==",(function(t,e,i){return e===i}),di),gi=fi("!=",(function(t,e,i){return e!==i}),(function(t,e,i,r){return!di(0,e,i,r)})),yi=fi("<",(function(t,e,i){return e<i}),(function(t,e,i,r){return r.compare(e,i)<0})),_i=fi(">",(function(t,e,i){return e>i}),(function(t,e,i,r){return r.compare(e,i)>0})),xi=fi("<=",(function(t,e,i){return e<=i}),(function(t,e,i,r){return r.compare(e,i)<=0})),Ci=fi(">=",(function(t,e,i){return e>=i}),(function(t,e,i,r){return r.compare(e,i)>=0}));class vi{constructor(t,e,i,r,n){this.type=Tt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=r,this.maxFractionDigits=n}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,Mt);if(!i)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let n=null;if(r.locale&&(n=e.parse(r.locale,1,Tt),!n))return null;let a=null;if(r.currency&&(a=e.parse(r.currency,1,Tt),!a))return null;let o=null;if(r["min-fraction-digits"]&&(o=e.parse(r["min-fraction-digits"],1,Mt),!o))return null;let l=null;return r["max-fraction-digits"]&&(l=e.parse(r["max-fraction-digits"],1,Mt),!l)?null:new vi(i,n,a,o,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class bi{constructor(t){this.type=Ot,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const r=[];let n=!1;for(let i=1;i<=t.length-1;++i){const a=t[i];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;let t=null;if(a["font-scale"]&&(t=e.parse(a["font-scale"],1,Mt),!t))return null;let i=null;if(a["text-font"]&&(i=e.parse(a["text-font"],1,Ft(Tt)),!i))return null;let o=null;if(a["text-color"]&&(o=e.parse(a["text-color"],1,At),!o))return null;const l=r[r.length-1];l.scale=t,l.font=i,l.textColor=o}else{const a=e.parse(t[i],1,Lt);if(!a)return null;const o=a.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:a,scale:null,font:null,textColor:null})}}return new bi(r)}evaluate(t){return new he(this.sections.map((e=>{const i=e.content.evaluate(t);return _e(i)===Dt?new ce("",i,null,null,null):new ce(xe(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class wi{constructor(t){this.type=Dt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,Tt);return i?new wi(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=pe.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ti{constructor(t){this.type=Mt,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${zt(i.type)} instead.`):new Ti(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ye(`Expected value to be of type string or array, but found ${zt(_e(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Si={"==":mi,"!=":gi,">":_i,"<":yi,">=":Ci,"<=":xi,array:ve,at:ni,boolean:ve,case:ci,coalesce:ri,collator:Ae,format:bi,image:wi,in:ai,"index-of":oi,interpolate:ei,"interpolate-hcl":ei,"interpolate-lab":ei,length:Ti,let:si,literal:ge,match:li,number:ve,"number-format":vi,object:ve,slice:hi,step:Ye,string:ve,"to-boolean":we,"to-color":we,"to-number":we,"to-string":we,var:je,within:qe};function Mi(t,[e,i,r,n]){e=e.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);const a=n?n.evaluate(t):1,o=fe(e,i,r,a);if(o)throw new ye(o);return new oe(e/255,i/255,r/255,a,!1)}function Ei(t,e){return t in e}function Ai(t,e){const i=e[t];return void 0===i?null:i}function Ii(t){return{type:t}}function Li(t){return{result:"success",value:t}}function Pi(t){return{result:"error",value:t}}function Oi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function ki(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Di(t){return!!t.expression&&t.expression.interpolated}function Fi(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function zi(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Ri(t){return t}function ji(t,e){const i="color"===e.type,r=t.stops&&"object"==typeof t.stops[0][0],n=r||!(r||void 0!==t.property),a=t.type||(Di(e)?"exponential":"interval");if(i||"padding"===e.type){const r=i?oe.parse:ue.parse;(t=Ct({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],r(t[1])]))),t.default=r(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==(o=t.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${t.colorSpace}"`);var o;let l,c,u;if("exponential"===a)l=Ui;else if("interval"===a)l=Vi;else if("categorical"===a){l=Bi,c=Object.create(null);for(const e of t.stops)c[e[0]]=e[1];u=typeof t.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);l=Zi}if(r){const i={},r=[];for(let e=0;e<t.stops.length;e++){const n=t.stops[e],a=n[0].zoom;void 0===i[a]&&(i[a]={zoom:a,type:t.type,property:t.property,default:t.default,stops:[]},r.push(a)),i[a].stops.push([n[0].value,n[1]])}const n=[];for(const t of r)n.push([i[t].zoom,ji(i[t],e)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:ei.interpolationFactor.bind(void 0,a),zoomStops:n.map((t=>t[0])),evaluate:({zoom:i},r)=>Ui({stops:n,base:t.base},e,i).evaluate(i,r)}}if(n){const i="exponential"===a?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:ei.interpolationFactor.bind(void 0,i),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:i})=>l(t,e,i,c,u)}}return{kind:"source",evaluate(i,r){const n=r&&r.properties?r.properties[t.property]:void 0;return void 0===n?Ni(t.default,e.default):l(t,e,n,c,u)}}}function Ni(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function Bi(t,e,i,r,n){return Ni(typeof i===n?r[i]:void 0,t.default,e.default)}function Vi(t,e,i){if("number"!==Fi(i))return Ni(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];const n=Je(t.stops.map((t=>t[0])),i);return t.stops[n][1]}function Ui(t,e,i){const r=void 0!==t.base?t.base:1;if("number"!==Fi(i))return Ni(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const a=Je(t.stops.map((t=>t[0])),i),o=function(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}(i,r,t.stops[a][0],t.stops[a+1][0]),l=t.stops[a][1],c=t.stops[a+1][1],u=ii[e.type]||Ri;return"function"==typeof l.evaluate?{evaluate(...e){const i=l.evaluate.apply(void 0,e),r=c.evaluate.apply(void 0,e);if(void 0!==i&&void 0!==r)return u(i,r,o,t.colorSpace)}}:u(l,c,o,t.colorSpace)}function Zi(t,e,i){switch(e.type){case"color":i=oe.parse(i);break;case"formatted":i=he.fromString(i.toString());break;case"resolvedImage":i=pe.fromString(i.toString());break;case"padding":i=ue.parse(i);break;default:Fi(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0)}return Ni(i,t.default,e.default)}Ze.register(Si,{error:[{kind:"error"},[Tt],(t,[e])=>{throw new ye(e.evaluate(t))}],typeof:[Tt,[Lt],(t,[e])=>zt(_e(e.evaluate(t)))],"to-rgba":[Ft(Mt,4),[At],(t,[e])=>{const[i,r,n,a]=e.evaluate(t).rgb;return[255*i,255*r,255*n,a]}],rgb:[At,[Mt,Mt,Mt],Mi],rgba:[At,[Mt,Mt,Mt,Mt],Mi],has:{type:Et,overloads:[[[Tt],(t,[e])=>Ei(e.evaluate(t),t.properties())],[[Tt,It],(t,[e,i])=>Ei(e.evaluate(t),i.evaluate(t))]]},get:{type:Lt,overloads:[[[Tt],(t,[e])=>Ai(e.evaluate(t),t.properties())],[[Tt,It],(t,[e,i])=>Ai(e.evaluate(t),i.evaluate(t))]]},"feature-state":[Lt,[Tt],(t,[e])=>Ai(e.evaluate(t),t.featureState||{})],properties:[It,[],t=>t.properties()],"geometry-type":[Tt,[],t=>t.geometryType()],id:[Lt,[],t=>t.id()],zoom:[Mt,[],t=>t.globals.zoom],"heatmap-density":[Mt,[],t=>t.globals.heatmapDensity||0],"line-progress":[Mt,[],t=>t.globals.lineProgress||0],accumulated:[Lt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Mt,Ii(Mt),(t,e)=>{let i=0;for(const r of e)i+=r.evaluate(t);return i}],"*":[Mt,Ii(Mt),(t,e)=>{let i=1;for(const r of e)i*=r.evaluate(t);return i}],"-":{type:Mt,overloads:[[[Mt,Mt],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[Mt],(t,[e])=>-e.evaluate(t)]]},"/":[Mt,[Mt,Mt],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[Mt,[Mt,Mt],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[Mt,[Mt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Mt,[Mt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Mt,[Mt],(t,[e])=>Math.log(e.evaluate(t))],log2:[Mt,[Mt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Mt,[Mt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Mt,[Mt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Mt,[Mt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Mt,[Mt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Mt,[Mt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Mt,[Mt],(t,[e])=>Math.atan(e.evaluate(t))],min:[Mt,Ii(Mt),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[Mt,Ii(Mt),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[Mt,[Mt],(t,[e])=>Math.abs(e.evaluate(t))],round:[Mt,[Mt],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Mt,[Mt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Mt,[Mt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Et,[Tt,Lt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[Et,[Lt],(t,[e])=>t.id()===e.value],"filter-type-==":[Et,[Tt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Et,[Tt,Lt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<n}],"filter-id-<":[Et,[Lt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<r}],"filter->":[Et,[Tt,Lt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>n}],"filter-id->":[Et,[Lt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>r}],"filter-<=":[Et,[Tt,Lt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<=n}],"filter-id-<=":[Et,[Lt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<=r}],"filter->=":[Et,[Tt,Lt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>=n}],"filter-id->=":[Et,[Lt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>=r}],"filter-has":[Et,[Lt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Et,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Et,[Ft(Tt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Et,[Ft(Lt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Et,[Tt,Ft(Lt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Et,[Tt,Ft(Lt)],(t,[e,i])=>function(t,e,i,r){for(;i<=r;){const n=i+r>>1;if(e[n]===t)return!0;e[n]>t?r=n-1:i=n+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Et,overloads:[[[Et,Et],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[Ii(Et),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:Et,overloads:[[[Et,Et],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[Ii(Et),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[Et,[Et],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Et,[Tt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Tt,[Tt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Tt,[Tt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Tt,Ii(Lt),(t,e)=>e.map((e=>xe(e.evaluate(t)))).join("")],"resolved-locale":[Tt,[Pt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class qi{constructor(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new Se,this._defaultValue=e?"color"===(i=e).type&&zi(i.default)?new oe(0,0,0,0):"color"===i.type?oe.parse(i.default)||null:"padding"===i.type?ue.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,r,n,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new ye(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function $i(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Si}function Wi(t,e){const i=new Ie(Si,$e,[],e?function(t){const e={color:At,string:Tt,number:Mt,enum:Tt,boolean:Et,formatted:Ot,padding:kt,resolvedImage:Dt};return"array"===t.type?Ft(e[t.value]||Lt,t.length):e[t.type]}(e):void 0),r=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Li(new qi(r,e)):Pi(i.errors)}class Gi{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Xe(e.expression)}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}}class Hi{constructor(t,e,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Xe(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}interpolationFactor(t,e,i){return this.interpolationType?ei.interpolationFactor(this.interpolationType,t,e,i):0}}function Yi(t,e){const i=Wi(t,e);if("error"===i.result)return i;const r=i.value.expression,n=We(r);if(!n&&!Oi(e))return Pi([new bt("","data expressions not supported")]);const a=Ke(r,["zoom"]);if(!a&&!ki(e))return Pi([new bt("","zoom expressions not supported")]);const o=Ki(r);return o||a?o instanceof bt?Pi([o]):o instanceof ei&&!Di(e)?Pi([new bt("",'"interpolate" expressions cannot be used with this property')]):Li(o?new Hi(n?"camera":"composite",i.value,o.labels,o instanceof ei?o.interpolation:void 0):new Gi(n?"constant":"source",i.value)):Pi([new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xi{constructor(t,e){this._parameters=t,this._specification=e,Ct(this,ji(this._parameters,this._specification))}static deserialize(t){return new Xi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ki(t){let e=null;if(t instanceof si)e=Ki(t.result);else if(t instanceof ri){for(const i of t.args)if(e=Ki(i),e)break}else(t instanceof Ye||t instanceof ei)&&t.input instanceof Ze&&"zoom"===t.input.name&&(e=t);return e instanceof bt||t.eachChild((t=>{const i=Ki(t);i instanceof bt?e=i:!e&&i?e=new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new bt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Ji(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Ji(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Qi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tr(t){if(null==t)return{filter:()=>!0,needGeometry:!1};Ji(t)||(t=rr(t));const e=Wi(t,Qi);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,i,r)=>e.value.evaluate(t,i,{},r),needGeometry:ir(t)}}function er(t,e){return t<e?-1:t>e?1:0}function ir(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(ir(t[e]))return!0;return!1}function rr(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?nr(t[1],t[2],"=="):"!="===e?or(nr(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?nr(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(rr))):"all"===e?["all"].concat(t.slice(1).map(rr)):"none"===e?["all"].concat(t.slice(1).map(rr).map(or)):"in"===e?sr(t[1],t.slice(2)):"!in"===e?or(sr(t[1],t.slice(2))):"has"===e?ar(t[1]):"!has"===e?or(ar(t[1])):"within"!==e||t;var i}function nr(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function sr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(er)]]:["filter-in-small",t,["literal",e]]}}function ar(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function or(t){return["!",t]}function lr(t){const e=t.value;return e?[new xt(t.key,e,"constants have been deprecated as of v8")]:[]}function cr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function ur(t){if(Array.isArray(t))return t.map(ur);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=ur(t[i]);return e}return cr(t)}function hr(t){const e=t.key,i=t.value,r=t.valueSpec||{},n=t.objectElementValidators||{},a=t.style,o=t.styleSpec,l=t.validateSpec;let c=[];const u=Fi(i);if("object"!==u)return[new xt(e,i,`object expected, ${u} found`)];for(const t in i){const u=t.split(".")[0],h=r[u]||r["*"];let p;if(n[u])p=n[u];else if(r[u])p=l;else if(n["*"])p=n["*"];else{if(!r["*"]){c.push(new xt(e,i[t],`unknown property "${t}"`));continue}p=l}c=c.concat(p({key:(e?`${e}.`:e)+t,value:i[t],valueSpec:h,style:a,styleSpec:o,object:i,objectKey:t,validateSpec:l},i))}for(const t in r)n[t]||r[t].required&&void 0===r[t].default&&void 0===i[t]&&c.push(new xt(e,i,`missing required property "${t}"`));return c}function pr(t){const e=t.value,i=t.valueSpec,r=t.style,n=t.styleSpec,a=t.key,o=t.arrayElementValidator||t.validateSpec;if("array"!==Fi(e))return[new xt(a,e,`array expected, ${Fi(e)} found`)];if(i.length&&e.length!==i.length)return[new xt(a,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new xt(a,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let l={type:i.value,values:i.values};n.$version<7&&(l.function=i.function),"object"===Fi(i.value)&&(l=i.value);let c=[];for(let i=0;i<e.length;i++)c=c.concat(o({array:e,arrayIndex:i,value:e[i],valueSpec:l,validateSpec:t.validateSpec,style:r,styleSpec:n,key:`${a}[${i}]`}));return c}function dr(t){const e=t.key,i=t.value,r=t.valueSpec;let n=Fi(i);return"number"===n&&i!=i&&(n="NaN"),"number"!==n?[new xt(e,i,`number expected, ${n} found`)]:"minimum"in r&&i<r.minimum?[new xt(e,i,`${i} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&i>r.maximum?[new xt(e,i,`${i} is greater than the maximum value ${r.maximum}`)]:[]}function fr(t){const e=t.valueSpec,i=cr(t.value.type);let r,n,a,o={};const l="categorical"!==i&&void 0===t.value.property,c=!l,u="array"===Fi(t.value.stops)&&"array"===Fi(t.value.stops[0])&&"object"===Fi(t.value.stops[0][0]),h=hr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new xt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(pr({key:t.key,value:r,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===Fi(r)&&0===r.length&&e.push(new xt(t.key,r,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&l&&h.push(new xt(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||h.push(new xt(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Di(t.valueSpec)&&h.push(new xt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(c&&!Oi(t.valueSpec)?h.push(new xt(t.key,t.value,"property functions not supported")):l&&!ki(t.valueSpec)&&h.push(new xt(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==t.value.property||h.push(new xt(t.key,t.value,'"property" property is required')),h;function p(t){let i=[];const r=t.value,l=t.key;if("array"!==Fi(r))return[new xt(l,r,`array expected, ${Fi(r)} found`)];if(2!==r.length)return[new xt(l,r,`array length 2 expected, length ${r.length} found`)];if(u){if("object"!==Fi(r[0]))return[new xt(l,r,`object expected, ${Fi(r[0])} found`)];if(void 0===r[0].zoom)return[new xt(l,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new xt(l,r,"object stop key must have value")];if(a&&a>cr(r[0].zoom))return[new xt(l,r[0].zoom,"stop zoom values must appear in ascending order")];cr(r[0].zoom)!==a&&(a=cr(r[0].zoom),n=void 0,o={}),i=i.concat(hr({key:`${l}[0]`,value:r[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:dr,value:d}}))}else i=i.concat(d({key:`${l}[0]`,value:r[0],valueSpec:{},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},r));return $i(ur(r[1]))?i.concat([new xt(`${l}[1]`,r[1],"expressions are not allowed in function stops.")]):i.concat(t.validateSpec({key:`${l}[1]`,value:r[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function d(t,a){const l=Fi(t.value),c=cr(t.value),u=null!==t.value?t.value:a;if(r){if(l!==r)return[new xt(t.key,u,`${l} stop domain type must match previous stop domain type ${r}`)]}else r=l;if("number"!==l&&"string"!==l&&"boolean"!==l)return[new xt(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==i){let r=`number expected, ${l} found`;return Oi(e)&&void 0===i&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new xt(t.key,u,r)]}return"categorical"!==i||"number"!==l||isFinite(c)&&Math.floor(c)===c?"categorical"!==i&&"number"===l&&void 0!==n&&c<n?[new xt(t.key,u,"stop domain values must appear in ascending order")]:(n=c,"categorical"===i&&c in o?[new xt(t.key,u,"stop domain values must be unique")]:(o[c]=!0,[])):[new xt(t.key,u,`integer expected, found ${c}`)]}}function mr(t){const e=("property"===t.expressionContext?Yi:Wi)(ur(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new xt(`${t.key}${e.key}`,t.value,e.message)));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new xt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Xe(i))return[new xt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Xe(i))return[new xt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ke(i,["zoom","feature-state"]))return[new xt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!We(i))return[new xt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gr(t){const e=t.key,i=t.value,r=t.valueSpec,n=[];return Array.isArray(r.values)?-1===r.values.indexOf(cr(i))&&n.push(new xt(e,i,`expected one of [${r.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(r.values).indexOf(cr(i))&&n.push(new xt(e,i,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(i)} found`)),n}function yr(t){return Ji(ur(t.value))?mr(Ct({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_r(t)}function _r(t){const e=t.value,i=t.key;if("array"!==Fi(e))return[new xt(i,e,`array expected, ${Fi(e)} found`)];const r=t.styleSpec;let n,a=[];if(e.length<1)return[new xt(i,e,"filter array must have at least 1 element")];switch(a=a.concat(gr({key:`${i}[0]`,value:e[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),cr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===cr(e[1])&&a.push(new xt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&a.push(new xt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(n=Fi(e[1]),"string"!==n&&a.push(new xt(`${i}[1]`,e[1],`string expected, ${n} found`)));for(let o=2;o<e.length;o++)n=Fi(e[o]),"$type"===cr(e[1])?a=a.concat(gr({key:`${i}[${o}]`,value:e[o],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new xt(`${i}[${o}]`,e[o],`string, number, or boolean expected, ${n} found`));break;case"any":case"all":case"none":for(let r=1;r<e.length;r++)a=a.concat(_r({key:`${i}[${r}]`,value:e[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=Fi(e[1]),2!==e.length?a.push(new xt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==n&&a.push(new xt(`${i}[1]`,e[1],`string expected, ${n} found`));break;case"within":n=Fi(e[1]),2!==e.length?a.push(new xt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==n&&a.push(new xt(`${i}[1]`,e[1],`object expected, ${n} found`))}return a}function vr(t,e){const i=t.key,r=t.validateSpec,n=t.style,a=t.styleSpec,o=t.value,l=t.objectKey,c=a[`${e}_${t.layerType}`];if(!c)return[];const u=l.match(/^(.*)-transition$/);if("paint"===e&&u&&c[u[1]]&&c[u[1]].transition)return r({key:i,value:o,valueSpec:a.transition,style:n,styleSpec:a});const h=t.valueSpec||c[l];if(!h)return[new xt(i,o,`unknown property "${l}"`)];let p;if("string"===Fi(o)&&Oi(h)&&!h.tokens&&(p=/^{([^}]+)}$/.exec(o)))return[new xt(i,o,`"${l}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\`.`)];const d=[];return"symbol"===t.layerType&&("text-field"===l&&n&&!n.glyphs&&d.push(new xt(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&zi(ur(o))&&"identity"===cr(o.type)&&d.push(new xt(i,o,'"text-font" does not support identity functions'))),d.concat(r({key:t.key,value:o,valueSpec:h,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:l}))}function xr(t){return vr(t,"paint")}function br(t){return vr(t,"layout")}function wr(t){let e=[];const i=t.value,r=t.key,n=t.style,a=t.styleSpec;i.type||i.ref||e.push(new xt(r,i,'either "type" or "ref" is required'));let o=cr(i.type);const l=cr(i.ref);if(i.id){const a=cr(i.id);for(let o=0;o<t.arrayIndex;o++){const t=n.layers[o];cr(t.id)===a&&e.push(new xt(r,i.id,`duplicate layer id "${i.id}", previously used at line ${t.id.__line__}`))}}if("ref"in i){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in i&&e.push(new xt(r,i[t],`"${t}" is prohibited for ref layers`))})),n.layers.forEach((e=>{cr(e.id)===l&&(t=e)})),t?t.ref?e.push(new xt(r,i.ref,"ref cannot reference another ref layer")):o=cr(t.type):e.push(new xt(r,i.ref,`ref layer "${l}" not found`))}else if("background"!==o)if(i.source){const t=n.sources&&n.sources[i.source],a=t&&cr(t.type);t?"vector"===a&&"raster"===o?e.push(new xt(r,i.source,`layer "${i.id}" requires a raster source`)):"raster"===a&&"raster"!==o?e.push(new xt(r,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==a||i["source-layer"]?"raster-dem"===a&&"hillshade"!==o?e.push(new xt(r,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!i.paint||!i.paint["line-gradient"]||"geojson"===a&&t.lineMetrics||e.push(new xt(r,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new xt(r,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new xt(r,i.source,`source "${i.source}" not found`))}else e.push(new xt(r,i,'missing required property "source"'));return e=e.concat(hr({key:r,value:i,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:`${r}.type`,value:i.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:i,objectKey:"type"}),filter:yr,layout:t=>hr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>br(Ct({layerType:o},t))}}),paint:t=>hr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>xr(Ct({layerType:o},t))}})}})),e}function Cr(t){const e=t.value,i=t.key,r=Fi(e);return"string"!==r?[new xt(i,e,`string expected, ${r} found`)]:[]}const Sr={promoteId:function({key:t,value:e}){if("string"===Fi(e))return Cr({key:t,value:e});{const i=[];for(const r in e)i.push(...Cr({key:`${t}.${r}`,value:e[r]}));return i}}};function Mr(t){const e=t.value,i=t.key,r=t.styleSpec,n=t.style,a=t.validateSpec;if(!e.type)return[new xt(i,e,'"type" is required')];const o=cr(e.type);let l;switch(o){case"vector":case"raster":case"raster-dem":return l=hr({key:i,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:t.style,styleSpec:r,objectElementValidators:Sr,validateSpec:a}),l;case"geojson":if(l=hr({key:i,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,validateSpec:a,objectElementValidators:Sr}),e.cluster)for(const t in e.clusterProperties){const[r,n]=e.clusterProperties[t],o="string"==typeof r?[r,["accumulated"],["get",t]]:r;l.push(...mr({key:`${i}.${t}.map`,value:n,validateSpec:a,expressionContext:"cluster-map"})),l.push(...mr({key:`${i}.${t}.reduce`,value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return l;case"video":return hr({key:i,value:e,valueSpec:r.source_video,style:n,validateSpec:a,styleSpec:r});case"image":return hr({key:i,value:e,valueSpec:r.source_image,style:n,validateSpec:a,styleSpec:r});case"canvas":return[new xt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gr({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:r})}}function Tr(t){const e=t.value,i=t.styleSpec,r=i.light,n=t.style;let a=[];const o=Fi(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new xt("light",e,`object expected, ${o} found`)]),a;for(const o in e){const l=o.match(/^(.*)-transition$/);a=a.concat(l&&r[l[1]]&&r[l[1]].transition?t.validateSpec({key:o,value:e[o],valueSpec:i.transition,validateSpec:t.validateSpec,style:n,styleSpec:i}):r[o]?t.validateSpec({key:o,value:e[o],valueSpec:r[o],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new xt(o,e[o],`unknown property "${o}"`)])}return a}function Er(t){const e=t.value,i=t.styleSpec,r=i.terrain,n=t.style;let a=[];const o=Fi(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new xt("terrain",e,`object expected, ${o} found`)]),a;for(const o in e)a=a.concat(r[o]?t.validateSpec({key:o,value:e[o],valueSpec:r[o],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new xt(o,e[o],`unknown property "${o}"`)]);return a}function Ar(t){let e=[];const i=t.value,r=t.key;if(Array.isArray(i)){const n=[],a=[];for(const o in i)i[o].id&&n.includes(i[o].id)&&e.push(new xt(r,i,`all the sprites' ids must be unique, but ${i[o].id} is duplicated`)),n.push(i[o].id),i[o].url&&a.includes(i[o].url)&&e.push(new xt(r,i,`all the sprites' URLs must be unique, but ${i[o].url} is duplicated`)),a.push(i[o].url),e=e.concat(hr({key:`${r}[${o}]`,value:i[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return Cr({key:r,value:i})}const Ir={"*":()=>[],array:pr,boolean:function(t){const e=t.value,i=t.key,r=Fi(e);return"boolean"!==r?[new xt(i,e,`boolean expected, ${r} found`)]:[]},number:dr,color:function(t){const e=t.key,i=t.value,r=Fi(i);return"string"!==r?[new xt(e,i,`color expected, ${r} found`)]:oe.parse(String(i))?[]:[new xt(e,i,`color expected, "${i}" found`)]},constants:lr,enum:gr,filter:yr,function:fr,layer:wr,object:hr,source:Mr,light:Tr,terrain:Er,string:Cr,formatted:function(t){return 0===Cr(t).length?[]:mr(t)},resolvedImage:function(t){return 0===Cr(t).length?[]:mr(t)},padding:function(t){const e=t.key,i=t.value;if("array"===Fi(i)){if(i.length<1||i.length>4)return[new xt(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const r={type:"number"};let n=[];for(let a=0;a<i.length;a++)n=n.concat(t.validateSpec({key:`${e}[${a}]`,value:i[a],validateSpec:t.validateSpec,valueSpec:r}));return n}return dr({key:e,value:i,valueSpec:{}})},sprite:Ar};function Lr(t){const e=t.value,i=t.valueSpec,r=t.styleSpec;return t.validateSpec=Lr,i.expression&&zi(cr(e))?fr(t):i.expression&&$i(ur(e))?mr(t):i.type&&Ir[i.type]?Ir[i.type](t):hr(Ct({},t,{valueSpec:i.type?r[i.type]:i}))}function Pr(t){const e=t.value,i=t.key,r=Cr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new xt(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new xt(i,e,'"glyphs" url must include a "{range}" token'))),r}function Or(t,e=ot){let i=[];return i=i.concat(Lr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Lr,objectElementValidators:{glyphs:Pr,"*":()=>[]}})),t.constants&&(i=i.concat(lr({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:Lr}))),Dr(i)}function kr(t){return function(e){return t({...e,validateSpec:Lr})}}function Dr(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function Fr(t){return function(...e){return Dr(t.apply(this,e))}}Or.source=Fr(kr(Mr)),Or.sprite=Fr(kr(Ar)),Or.glyphs=Fr(kr(Pr)),Or.light=Fr(kr(Tr)),Or.terrain=Fr(kr(Er)),Or.layer=Fr(kr(wr)),Or.filter=Fr(kr(yr)),Or.paintProperty=Fr(kr(xr)),Or.layoutProperty=Fr(kr(br));const zr=Or,Rr=zr.light,jr=zr.paintProperty,Nr=zr.layoutProperty;function Br(t,e){let i=!1;if(e&&e.length)for(const r of e)t.fire(new st(new Error(r.message))),i=!0;return i}class Ur{constructor(t,e,i){const r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(i=n[2]);for(let t=0;t<this.d*this.d;t++){const e=n[3+t],i=n[3+t+1];r.push(e===i?null:n.subarray(e,i))}const a=n[3+r.length+1];this.keys=n.subarray(n[3+r.length],a),this.bboxes=n.subarray(a),this.insert=this._insertReadonly}else{this.d=e+2*i;for(let t=0;t<this.d*this.d;t++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;const n=i/e*t;this.min=-n,this.max=t+n}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,i,r,n,a){this.cells[n].push(a)}query(t,e,i,r,n){const a=this.min,o=this.max;if(t<=a&&e<=a&&o<=i&&o<=r&&!n)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(t,e,i,r,this._queryCell,a,{},n),a}}_queryCell(t,e,i,r,n,a,o,l){const c=this.cells[n];if(null!==c){const n=this.keys,u=this.bboxes;for(let h=0;h<c.length;h++){const p=c[h];if(void 0===o[p]){const c=4*p;(l?l(u[c+0],u[c+1],u[c+2],u[c+3]):t<=u[c+2]&&e<=u[c+3]&&i>=u[c+0]&&r>=u[c+1])?(o[p]=!0,a.push(n[p])):o[p]=!1}}}}_forEachCell(t,e,i,r,n,a,o,l){const c=this._convertToCellCoord(t),u=this._convertToCellCoord(e),h=this._convertToCellCoord(i),p=this._convertToCellCoord(r);for(let d=c;d<=h;d++)for(let c=u;c<=p;c++){const u=this.d*c+d;if((!l||l(this._convertFromCellCoord(d),this._convertFromCellCoord(c),this._convertFromCellCoord(d+1),this._convertFromCellCoord(c+1)))&&n.call(this,t,e,i,r,u,a,o,l))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let i=0;for(let t=0;t<this.cells.length;t++)i+=this.cells[t].length;const r=new Int32Array(e+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let n=e;for(let e=0;e<t.length;e++){const i=t[e];r[3+e]=n,r.set(i,n),n+=i.length}return r[3+t.length]=n,r.set(this.keys,n),n+=this.keys.length,r[3+t.length+1]=n,r.set(this.bboxes,n),n+=this.bboxes.length,r.buffer}static serialize(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}}static deserialize(t){return new Ur(t.buffer)}}const Vr={};function Hr(t,e,i={}){if(Vr[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Vr[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Hr("Object",Object),Hr("TransferableGridIndex",Ur),Hr("Color",oe),Hr("Error",Error),Hr("AJAXError",R),Hr("ResolvedImage",pe),Hr("StylePropertyFunction",Xi),Hr("StyleExpression",qi,{omit:["_evaluator"]}),Hr("ZoomDependentExpression",Hi),Hr("ZoomConstantExpression",Gi),Hr("CompoundExpression",Ze,{omit:["_evaluate"]});for(const t in Si)Si[t]._classRegistryKey||Hr(`Expression_${t}`,Si[t]);function qr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Zr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob)return t;if(qr(t))return e&&e.push(t),t;if(P(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const r of t)i.push(Zr(r,e));return i}if("object"==typeof t){const i=t.constructor,r=i._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class");if(!Vr[r])throw new Error(`${r} is not registered.`);const n=i.serialize?i.serialize(t,e):{};if(i.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in t){if(!t.hasOwnProperty(i))continue;if(Vr[r].omit.indexOf(i)>=0)continue;const a=t[i];n[i]=Vr[r].shallow.indexOf(i)>=0?a:Zr(a,e)}t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(n.$name=r),n}throw new Error("can't serialize object of type "+typeof t)}function $r(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||qr(t)||P(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map($r);if("object"==typeof t){const e=t.$name||"Object";if(!Vr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Vr[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const r=Object.create(i.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const n=t[i];r[i]=Vr[e].shallow.indexOf(i)>=0?n:$r(n)}return r}throw new Error("can't deserialize object of type "+typeof t)}class Gr{constructor(){this.first=!0}update(t,e){const i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))}}const Wr={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Xr(t){for(const e of t)if(Yr(e.charCodeAt(0)))return!0;return!1}function Yr(t){return!(746!==t&&747!==t&&(t<4352||!(Wr["Bopomofo Extended"](t)||Wr.Bopomofo(t)||Wr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Wr["CJK Compatibility Ideographs"](t)||Wr["CJK Compatibility"](t)||Wr["CJK Radicals Supplement"](t)||Wr["CJK Strokes"](t)||!(!Wr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Wr["CJK Unified Ideographs Extension A"](t)||Wr["CJK Unified Ideographs"](t)||Wr["Enclosed CJK Letters and Months"](t)||Wr["Hangul Compatibility Jamo"](t)||Wr["Hangul Jamo Extended-A"](t)||Wr["Hangul Jamo Extended-B"](t)||Wr["Hangul Jamo"](t)||Wr["Hangul Syllables"](t)||Wr.Hiragana(t)||Wr["Ideographic Description Characters"](t)||Wr.Kanbun(t)||Wr["Kangxi Radicals"](t)||Wr["Katakana Phonetic Extensions"](t)||Wr.Katakana(t)&&12540!==t||!(!Wr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Wr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Wr["Unified Canadian Aboriginal Syllabics"](t)||Wr["Unified Canadian Aboriginal Syllabics Extended"](t)||Wr["Vertical Forms"](t)||Wr["Yijing Hexagram Symbols"](t)||Wr["Yi Syllables"](t)||Wr["Yi Radicals"](t))))}function Kr(t){return t>=1424&&t<=2303||Wr["Arabic Presentation Forms-A"](t)||Wr["Arabic Presentation Forms-B"](t)}function Jr(t,e){return!(!e&&Kr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Wr.Khmer(t))}function Qr(t){for(const e of t)if(Kr(e.charCodeAt(0)))return!0;return!1}const Ln="deferred",Pn="loading",On="loaded";let kn=null,Fn="unavailable",Rn=null;const jn=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Fn="error"),kn&&kn(t)};function Nn(){Bn.fire(new rt("pluginStateChange",{pluginStatus:Fn,pluginURL:Rn}))}const Bn=new nt,Vn=function(){return Fn},Un=function(){if(Fn!==Ln||!Rn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Fn=Pn,Nn(),Rn&&H({url:Rn},(t=>{t?jn(t):(Fn=On,Nn())}))},Zn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Fn===On||null!=Zn.applyArabicShaping,isLoading:()=>Fn===Pn,setState(t){if(!E())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Fn=t.pluginStatus,Rn=t.pluginURL},isParsed(){if(!E())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Zn.applyArabicShaping},getPluginURL(){if(!E())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Rn}};class us{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gr,this.transition={})}isSupportedScript(t){return function(t,e){for(const i of t)if(!Jr(i.charCodeAt(0),e))return!1;return!0}(t,Zn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}}}class ps{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(zi(t))return new Xi(t,e);if($i(t)){const i=Yi(t,e);if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return i.value}{let i=t;return"color"===e.type&&"string"==typeof t?i=oe.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)||(i=ue.parse(t)),{kind:"constant",evaluate:()=>i}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)}}class ds{constructor(t){this.property=t,this.value=new ps(t,void 0)}transitioned(t,e){return new fs(this.property,this.value,e,f({},t.transition,this.transition),t.now)}untransitioned(){return new fs(this.property,this.value,null,{},0)}}class ms{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return w(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ds(this._values[t].property)),this._values[t].value=new ps(this._values[t].property,null===e?void 0:w(e))}getTransition(t){return w(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ds(this._values[t].property)),this._values[t].transition=w(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i);const r=this.getTransition(e);void 0!==r&&(t[`${e}-transition`]=r)}return t}transitioned(t,e){const i=new _s(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].transitioned(t,e._values[r]);return i}untransitioned(){const t=new _s(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class fs{constructor(t,e,i,r,n){this.property=t,this.value=e,this.begin=n+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=i)}possiblyEvaluate(t,e,i){const r=t.now||0,n=this.value.possiblyEvaluate(t,e,i),a=this.prior;if(a){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return a.possiblyEvaluate(t,e,i);{const o=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,i),n,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}(o))}}return n}}class _s{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,i){const r=new xs(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class gs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return w(this._values[t].value)}setValue(t,e){this._values[t]=new ps(this._values[t].property,null===e?void 0:w(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i)}return t}possiblyEvaluate(t,e,i){const r=new xs(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}}class ys{constructor(t,e,i){this.property=t,this.value=e,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,i,r){return this.property.evaluate(this.value,this.parameters,t,e,i,r)}}class xs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class vs{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,i){const r=ii[this.specification.type];return r?r(t,e,i):t}}class bs{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,i,r){return new ys(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,r)}:t.expression,e)}interpolate(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new ys(this,{kind:"constant",value:void 0},t.parameters);const r=ii[this.specification.type];if(r){const n=r(t.value.value,e.value.value,i);return new ys(this,{kind:"constant",value:n},t.parameters)}return t}evaluate(t,e,i,r,n,a){return"constant"===t.kind?t.value:t.evaluate(e,i,r,n,a)}}class ws extends bs{possiblyEvaluate(t,e,i,r){if(void 0===t.value)return new ys(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r),a="resolvedImage"===t.property.specification.type&&"string"!=typeof n?n.name:n,o=this._calculate(a,a,a,e);return new ys(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){const i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new ys(this,{kind:"constant",value:i},e)}return new ys(this,t.expression,e)}evaluate(t,e,i,r,n,a){if("source"===t.kind){const o=t.evaluate(e,i,r,n,a);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,r),t.evaluate({zoom:Math.floor(e.zoom)},i,r),t.evaluate({zoom:Math.floor(e.zoom)+1},i,r),e):t.value}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class Ts{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){if(void 0!==t.value){if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new us(Math.floor(e.zoom-1),e)),t.expression.evaluate(new us(Math.floor(e.zoom),e)),t.expression.evaluate(new us(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class Ss{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){return!!t.expression.evaluate(e,null,{},i,r)}interpolate(){return!1}}class Is{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const i=t[e];i.specification.overridable&&this.overridableProperties.push(e);const r=this.defaultPropertyValues[e]=new ps(i,void 0),n=this.defaultTransitionablePropertyValues[e]=new ds(i);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}}Hr("DataDrivenProperty",bs),Hr("DataConstantProperty",vs),Hr("CrossFadedDataDrivenProperty",ws),Hr("CrossFadedProperty",Ts),Hr("ColorRampProperty",Ss);const Gn="-transition";class Es extends nt{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new gs(e.layout)),e.paint)){this._transitionablePaint=new ms(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xs(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,i={}){null!=e&&this._validate(Nr,`layers.${this.id}.layout.${t}`,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(Gn)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,i={}){if(null!=e&&this._validate(jr,`layers.${this.id}.paint.${t}`,t,e,i))return!1;if(t.endsWith(Gn))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const i=this._transitionablePaint._values[t],r="cross-faded-data-driven"===i.property.specification["property-type"],n=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const o=this._transitionablePaint._values[t].value;return o.isDataDriven()||n||r||this._handleOverridablePaintPropertyUpdate(t,a,o)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,i){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),x(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,i,r,n={}){return(!n||!1!==n.validate)&&Br(this,t.call(zr,{key:e,layerType:this.type,objectKey:i,value:r,styleSpec:ot,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof ys&&Oi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const $n={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Cs{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ms{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ts(t,e=1){let i=0,r=0;return{members:t.map((t=>{const n=$n[t.type].BYTES_PER_ELEMENT,a=i=es(i,Math.max(e,n)),o=t.components||1;return r=Math.max(r,n),i+=n*o,{name:t.name,type:t.type,components:o,offset:a}})),size:es(i,Math.max(r,e)),alignment:e}}function es(t,e){return Math.ceil(t/e)*e}class Ds extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=i,t}}Ds.prototype.bytesPerElement=4,Hr("StructArrayLayout2i4",Ds);class Ls extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.int16[n+0]=e,this.int16[n+1]=i,this.int16[n+2]=r,t}}Ls.prototype.bytesPerElement=6,Hr("StructArrayLayout3i6",Ls);class Bs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.int16[a+2]=r,this.int16[a+3]=n,t}}Bs.prototype.bytesPerElement=8,Hr("StructArrayLayout4i8",Bs);class Rs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const l=6*t;return this.int16[l+0]=e,this.int16[l+1]=i,this.int16[l+2]=r,this.int16[l+3]=n,this.int16[l+4]=a,this.int16[l+5]=o,t}}Rs.prototype.bytesPerElement=12,Hr("StructArrayLayout2i4i12",Rs);class Fs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const l=4*t,c=8*t;return this.int16[l+0]=e,this.int16[l+1]=i,this.uint8[c+4]=r,this.uint8[c+5]=n,this.uint8[c+6]=a,this.uint8[c+7]=o,t}}Fs.prototype.bytesPerElement=8,Hr("StructArrayLayout2i4ub8",Fs);class Os extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=i,t}}Os.prototype.bytesPerElement=8,Hr("StructArrayLayout2f8",Os);class Vs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,l,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,e,i,r,n,a,o,l,c,u)}emplace(t,e,i,r,n,a,o,l,c,u,h){const p=10*t;return this.uint16[p+0]=e,this.uint16[p+1]=i,this.uint16[p+2]=r,this.uint16[p+3]=n,this.uint16[p+4]=a,this.uint16[p+5]=o,this.uint16[p+6]=l,this.uint16[p+7]=c,this.uint16[p+8]=u,this.uint16[p+9]=h,t}}Vs.prototype.bytesPerElement=20,Hr("StructArrayLayout10ui20",Vs);class Us extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,l,c,u,h,p){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,i,r,n,a,o,l,c,u,h,p)}emplace(t,e,i,r,n,a,o,l,c,u,h,p,d){const f=12*t;return this.int16[f+0]=e,this.int16[f+1]=i,this.int16[f+2]=r,this.int16[f+3]=n,this.uint16[f+4]=a,this.uint16[f+5]=o,this.uint16[f+6]=l,this.uint16[f+7]=c,this.int16[f+8]=u,this.int16[f+9]=h,this.int16[f+10]=p,this.int16[f+11]=d,t}}Us.prototype.bytesPerElement=24,Hr("StructArrayLayout4i4ui4i24",Us);class Ns extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.float32[n+0]=e,this.float32[n+1]=i,this.float32[n+2]=r,t}}Ns.prototype.bytesPerElement=12,Hr("StructArrayLayout3f12",Ns);class $s extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}$s.prototype.bytesPerElement=4,Hr("StructArrayLayout1ul4",$s);class qs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,i,r,n,a,o,l,c)}emplace(t,e,i,r,n,a,o,l,c,u){const h=10*t,p=5*t;return this.int16[h+0]=e,this.int16[h+1]=i,this.int16[h+2]=r,this.int16[h+3]=n,this.int16[h+4]=a,this.int16[h+5]=o,this.uint32[p+3]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}qs.prototype.bytesPerElement=20,Hr("StructArrayLayout6i1ul2ui20",qs);class js extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const l=6*t;return this.int16[l+0]=e,this.int16[l+1]=i,this.int16[l+2]=r,this.int16[l+3]=n,this.int16[l+4]=a,this.int16[l+5]=o,t}}js.prototype.bytesPerElement=12,Hr("StructArrayLayout2i2i2i12",js);class Zs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n)}emplace(t,e,i,r,n,a){const o=4*t,l=8*t;return this.float32[o+0]=e,this.float32[o+1]=i,this.float32[o+2]=r,this.int16[l+6]=n,this.int16[l+7]=a,t}}Zs.prototype.bytesPerElement=16,Hr("StructArrayLayout2f1f2i16",Zs);class Gs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=12*t,o=3*t;return this.uint8[a+0]=e,this.uint8[a+1]=i,this.float32[o+1]=r,this.float32[o+2]=n,t}}Gs.prototype.bytesPerElement=12,Hr("StructArrayLayout2ub2f12",Gs);class Hs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.uint16[n+0]=e,this.uint16[n+1]=i,this.uint16[n+2]=r,t}}Hs.prototype.bytesPerElement=6,Hr("StructArrayLayout3ui6",Hs);class Ws extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y)}emplace(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_){const v=24*t,x=12*t,b=48*t;return this.int16[v+0]=e,this.int16[v+1]=i,this.uint16[v+2]=r,this.uint16[v+3]=n,this.uint32[x+2]=a,this.uint32[x+3]=o,this.uint32[x+4]=l,this.uint16[v+10]=c,this.uint16[v+11]=u,this.uint16[v+12]=h,this.float32[x+7]=p,this.float32[x+8]=d,this.uint8[b+36]=f,this.uint8[b+37]=m,this.uint8[b+38]=g,this.uint32[x+10]=y,this.int16[v+22]=_,t}}Ws.prototype.bytesPerElement=48,Hr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ws);class Xs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_,v,x,b,w,C,S,M,T,E,A){const I=this.length;return this.resize(I+1),this.emplace(I,t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_,v,x,b,w,C,S,M,T,E,A)}emplace(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_,v,x,b,w,C,S,M,T,E,A,I){const P=34*t,O=17*t;return this.int16[P+0]=e,this.int16[P+1]=i,this.int16[P+2]=r,this.int16[P+3]=n,this.int16[P+4]=a,this.int16[P+5]=o,this.int16[P+6]=l,this.int16[P+7]=c,this.uint16[P+8]=u,this.uint16[P+9]=h,this.uint16[P+10]=p,this.uint16[P+11]=d,this.uint16[P+12]=f,this.uint16[P+13]=m,this.uint16[P+14]=g,this.uint16[P+15]=y,this.uint16[P+16]=_,this.uint16[P+17]=v,this.uint16[P+18]=x,this.uint16[P+19]=b,this.uint16[P+20]=w,this.uint16[P+21]=C,this.uint16[P+22]=S,this.uint32[O+12]=M,this.float32[O+13]=T,this.float32[O+14]=E,this.float32[O+15]=A,this.float32[O+16]=I,t}}Xs.prototype.bytesPerElement=68,Hr("StructArrayLayout8i15ui1ul4f68",Xs);class Ks extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Ks.prototype.bytesPerElement=4,Hr("StructArrayLayout1f4",Ks);class Ys extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=4*t;return this.uint32[2*t+0]=e,this.uint16[n+2]=i,this.uint16[n+3]=r,t}}Ys.prototype.bytesPerElement=8,Hr("StructArrayLayout1ul2ui8",Ys);class Js extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=i,t}}Js.prototype.bytesPerElement=4,Hr("StructArrayLayout2ui4",Js);class Qs extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Qs.prototype.bytesPerElement=2,Hr("StructArrayLayout1ui2",Qs);class tn extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.float32[a+0]=e,this.float32[a+1]=i,this.float32[a+2]=r,this.float32[a+3]=n,t}}tn.prototype.bytesPerElement=16,Hr("StructArrayLayout4f16",tn);class en extends Cs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new n(this.anchorPointX,this.anchorPointY)}}en.prototype.size=20;class rn extends qs{get(t){return new en(this,t)}}Hr("CollisionBoxArray",rn);class sn extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}sn.prototype.size=48;class nn extends Ws{get(t){return new sn(this,t)}}Hr("PlacedSymbolArray",nn);class an extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}an.prototype.size=68;class on extends Xs{get(t){return new an(this,t)}}Hr("SymbolInstanceArray",on);class ln extends Ks{getoffsetX(t){return this.float32[1*t+0]}}Hr("GlyphOffsetArray",ln);class cn extends Ls{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Hr("SymbolLineVertexArray",cn);class hn extends Cs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}hn.prototype.size=8;class un extends Ys{get(t){return new hn(this,t)}}Hr("FeatureIndexArray",un);class pn extends Ds{}class dn extends Ls{}class mn extends Bs{}class fn extends Ds{}class _n extends Ds{}class gn extends Rs{}class yn extends Fs{}class xn extends Os{}class vn extends Vs{}class bn extends Us{}class wn extends Ns{}class Tn extends $s{}class Sn extends js{}class In extends Zs{}class An extends Gs{}class En extends Hs{}class zn extends Hs{}class Cn extends Js{}class Mn extends Qs{}const is=ts([{name:"a_pos",components:2,type:"Int16"}],4),{members:rs}=is;class Dn{constructor(t=[]){this.segments=t}prepareSegment(t,e,i,r){let n=this.segments[this.segments.length-1];return t>Dn.MAX_VERTEX_ARRAY_LENGTH&&S(`Max vertices per segment is ${Dn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!n||n.vertexLength+t>Dn.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==r)&&(n={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==r&&(n.sortKey=r),this.segments.push(n)),n}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,i,r){return new Dn([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])}}function ns(t,e){return 256*(t=h(Math.floor(t),0,255))+h(Math.floor(e),0,255)}Dn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hr("SegmentVector",Dn);const ss=ts([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var as={exports:{}},os={exports:{}};!function(t){t.exports=function(t,e){var i,r,n,a,o,l,c,u;for(r=t.length-(i=3&t.length),n=e,o=3432918353,l=461845907,u=0;u<r;)c=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,n=27492+(65535&(a=5*(65535&(n=(n^=c=(65535&(c=(c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*l+(((c>>>16)*l&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(c=0,i){case 3:c^=(255&t.charCodeAt(u+2))<<16;case 2:c^=(255&t.charCodeAt(u+1))<<8;case 1:n^=c=(65535&(c=(c=(65535&(c^=255&t.charCodeAt(u)))*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*l+(((c>>>16)*l&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}}(os);var ls=os.exports,cs={exports:{}};!function(t){t.exports=function(t,e){for(var i,r=t.length,n=e^r,a=0;r>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),r-=4,++a;switch(r){case 3:n^=(255&t.charCodeAt(a+2))<<16;case 2:n^=(255&t.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(a)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}}(cs);var hs=ls,As=cs.exports;as.exports=hs,as.exports.murmur3=hs,as.exports.murmur2=As;var Ps=e(as.exports);class qn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,i,r){this.ids.push(ks(t)),this.positions.push(e,i,r)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=ks(t);let i=0,r=this.ids.length-1;for(;i<r;){const t=i+r>>1;this.ids[t]>=e?r=t:i=t+1}const n=[];for(;this.ids[i]===e;)n.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return n}static serialize(t,e){const i=new Float64Array(t.ids),r=new Uint32Array(t.positions);return zs(i,r,0,i.length-1),e&&e.push(i.buffer,r.buffer),{ids:i,positions:r}}static deserialize(t){const e=new qn;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ks(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ps(String(t))}function zs(t,e,i,r){for(;i<r;){const n=t[i+r>>1];let a=i-1,o=r+1;for(;;){do{a++}while(t[a]<n);do{o--}while(t[o]>n);if(a>=o)break;ta(t,a,o),ta(e,3*a,3*o),ta(e,3*a+1,3*o+1),ta(e,3*a+2,3*o+2)}o-i<r-o?(zs(t,e,i,o),i=o+1):(zs(t,e,o+1,r),r=o)}}function ta(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}Hr("FeaturePositionMap",qn);class Hn{constructor(t,e){this.gl=t.gl,this.location=e}}class Wn extends Hn{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}}class Xn extends Hn{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Kn extends Hn{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}}class Yn extends Hn{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}}class Jn extends Hn{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Qn extends Hn{constructor(t,e){super(t,e),this.current=oe.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const ia=new Float32Array(16);class ea extends Hn{constructor(t,e){super(t,e),this.current=ia}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}}function ua(t){return[ns(255*t.r,255*t.g),ns(255*t.b,255*t.a)]}class ra{constructor(t,e,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=i}setUniform(t,e,i){t.set(i.constantOr(this.value))}getBinding(t,e,i){return"color"===this.type?new Qn(t,e):new Xn(t,e)}}class sa{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,i,r){const n="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;n&&t.set(n)}getBinding(t,e,i){return"u_pattern"===i.substr(0,9)?new Jn(t,e):new Xn(t,e)}}class na{constructor(t,e,i,r){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,i,r,n){const a=this.paintVertexArray.length,o=this.expression.evaluate(new us(0),e,{},r,[],n);this.paintVertexArray.resize(t),this._setPaintValue(a,t,o)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:0},i,r);this._setPaintValue(t,e,n)}_setPaintValue(t,e,i){if("color"===this.type){const r=ua(i);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class aa{constructor(t,e,i,r,n,a){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=i,this.useIntegerZoom=r,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(t,e,i,r,n){const a=this.expression.evaluate(new us(this.zoom),e,{},r,[],n),o=this.expression.evaluate(new us(this.zoom+1),e,{},r,[],n),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,a,o)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:this.zoom},i,r),a=this.expression.evaluate({zoom:this.zoom+1},i,r);this._setPaintValue(t,e,n,a)}_setPaintValue(t,e,i,r){if("color"===this.type){const n=ua(i),a=ua(r);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n[0],n[1],a[0],a[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i,r);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=h(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(r)}getBinding(t,e,i){return new Xn(t,e)}}class oa{constructor(t,e,i,r,n,a){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=r,this.layerId=a,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}populatePaintArray(t,e,i){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],i)}updatePaintArray(t,e,i,r,n){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],n)}_setPaintValues(t,e,i,r){if(!r||!i)return;const{min:n,mid:a,max:o}=i,l=r[n],c=r[a],u=r[o];if(l&&c&&u)for(let i=t;i<e;i++)this.zoomInPaintVertexArray.emplace(i,c.tl[0],c.tl[1],c.br[0],c.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],c.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(i,c.tl[0],c.tl[1],c.br[0],c.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],c.pixelRatio,u.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ss.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ss.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class la{constructor(t,e,i){this.binders={},this._buffers=[];const r=[];for(const n in t.paint._values){if(!i(n))continue;const a=t.paint.get(n);if(!(a instanceof ys&&Oi(a.property.specification)))continue;const o=ha(n,t.type),l=a.value,c=a.property.specification.type,u=a.property.useIntegerZoom,h=a.property.specification["property-type"],p="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===l.kind)this.binders[n]=p?new sa(l.value,o):new ra(l.value,o,c),r.push(`/u_${n}`);else if("source"===l.kind||p){const i=pa(n,c,"source");this.binders[n]=p?new oa(l,c,u,e,i,t.id):new na(l,o,c,i),r.push(`/a_${n}`)}else{const t=pa(n,c,"composite");this.binders[n]=new aa(l,o,c,u,e,t),r.push(`/z_${n}`)}}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof na||e instanceof aa?e.maxValue:0}populatePaintArrays(t,e,i,r,n){for(const a in this.binders){const o=this.binders[a];(o instanceof na||o instanceof aa||o instanceof oa)&&o.populatePaintArray(t,e,i,r,n)}}setConstantPatternPositions(t,e){for(const i in this.binders){const r=this.binders[i];r instanceof sa&&r.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,i,r,n){let a=!1;for(const o in t){const l=e.getPositions(o);for(const e of l){const l=i.feature(e.index);for(const i in this.binders){const c=this.binders[i];if((c instanceof na||c instanceof aa||c instanceof oa)&&!0===c.expression.isStateDependent){const u=r.paint.get(i);c.expression=u.value,c.updatePaintArray(e.start,e.end,l,t[o],n),a=!0}}}}return a}defines(){const t=[];for(const e in this.binders){const i=this.binders[e];(i instanceof ra||i instanceof sa)&&t.push(...i.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof na||i instanceof aa)for(let e=0;e<i.paintVertexAttributes.length;e++)t.push(i.paintVertexAttributes[e].name);else if(i instanceof oa)for(let e=0;e<ss.members.length;e++)t.push(ss.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof ra||i instanceof sa||i instanceof aa)for(const e of i.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const i=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof ra||n instanceof sa||n instanceof aa)for(const a of n.uniformNames)if(e[a]){const o=n.getBinding(t,e[a],a);i.push({name:a,property:r,binding:o})}}return i}setUniforms(t,e,i,r){for(const{name:t,property:n,binding:a}of e)this.binders[n].setUniform(a,r,i.get(n),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const i=this.binders[e];if(t&&i instanceof oa){const e=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(i instanceof na||i instanceof aa)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const e in this.binders){const i=this.binders[e];(i instanceof na||i instanceof aa||i instanceof oa)&&i.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof na||e instanceof aa||e instanceof oa)&&e.destroy()}}}class ca{constructor(t,e,i=(()=>!0)){this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new la(r,e,i);this.needsUpload=!1,this._featureMap=new qn,this._bufferOffset=0}populatePaintArrays(t,e,i,r,n,a){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,r,n,a);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,i,r){for(const n of i)this.needsUpload=this.programConfigurations[n.id].updatePaintArrays(t,this._featureMap,e,n,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function ha(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function pa(t,e,i){const r={color:{source:Os,composite:tn},number:{source:Ks,composite:Os}},n=function(t){return{"line-pattern":{source:vn,composite:vn},"fill-pattern":{source:vn,composite:vn},"fill-extrusion-pattern":{source:vn,composite:vn}}[t]}(t);return n&&n[i]||r[e][i]}Hr("ConstantBinder",ra),Hr("CrossFadedConstantBinder",sa),Hr("SourceExpressionBinder",na),Hr("CrossFadedCompositeBinder",oa),Hr("CompositeExpressionBinder",aa),Hr("ProgramConfiguration",la,{omit:["_buffers"]}),Hr("ProgramConfigurationSet",ca);var da=8192;const fa=Math.pow(2,14)-1,ma=-fa-1;function ga(t){const e=da/t.extent,i=t.loadGeometry();for(let t=0;t<i.length;t++){const r=i[t];for(let t=0;t<r.length;t++){const i=r[t],n=Math.round(i.x*e),a=Math.round(i.y*e);i.x=h(n,ma,fa),i.y=h(a,ma,fa),(n<i.x||n>i.x+1||a<i.y||a>i.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function _a(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ga(t):[]}}function va(t,e,i,r,n){t.emplaceBack(2*e+(r+1)/2,2*i+(n+1)/2)}class ya{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new fn,this.indexArray=new zn,this.segments=new Dn,this.programConfigurations=new ca(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){const r=this.layers[0],n=[];let a=null,o=!1;"circle"===r.type&&(a=r.layout.get("circle-sort-key"),o=!a.isConstant());for(const{feature:e,id:r,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=_a(e,t);if(!this.layers[0]._featureFilter.filter(new us(this.zoom),u,i))continue;const h=o?a.evaluate(u,{},i):void 0,p={id:r,properties:e.properties,type:e.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:ga(e),patterns:{},sortKey:h};n.push(p)}o&&n.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of n){const{geometry:n,index:a,sourceLayerIndex:o}=r,l=t[a].feature;this.addFeature(r,n,a,i),e.featureIndex.insert(l,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,r){for(const i of e)for(const e of i){const i=e.x,r=e.y;if(i<0||i>=da||r<0||r>=da)continue;const n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=n.vertexLength;va(this.layoutVertexArray,i,r,-1,-1),va(this.layoutVertexArray,i,r,1,-1),va(this.layoutVertexArray,i,r,1,1),va(this.layoutVertexArray,i,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),n.vertexLength+=4,n.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},r)}}function xa(t,e){for(let i=0;i<t.length;i++)if(Ia(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Ia(t,e[i]))return!0;return!!Sa(t,e)}function ba(t,e,i){return!!Ia(t,e)||!!Ta(e,t,i)}function wa(t,e){if(1===t.length)return Aa(e,t[0]);for(let i=0;i<e.length;i++){const r=e[i];for(let e=0;e<r.length;e++)if(Ia(t,r[e]))return!0}for(let i=0;i<t.length;i++)if(Aa(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Sa(t,e[i]))return!0;return!1}function Ca(t,e,i){if(t.length>1){if(Sa(t,e))return!0;for(let r=0;r<e.length;r++)if(Ta(e[r],t,i))return!0}for(let r=0;r<t.length;r++)if(Ta(t[r],e,i))return!0;return!1}function Sa(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const r=t[i],n=t[i+1];for(let t=0;t<e.length-1;t++)if(Ma(r,n,e[t],e[t+1]))return!0}return!1}function Ma(t,e,i,r){return M(t,i,r)!==M(e,i,r)&&M(t,e,i)!==M(t,e,r)}function Ta(t,e,i){const r=i*i;if(1===e.length)return t.distSqr(e[0])<r;for(let i=1;i<e.length;i++)if(Ea(t,e[i-1],e[i])<r)return!0;return!1}function Ea(t,e,i){const r=e.distSqr(i);if(0===r)return t.distSqr(e);const n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;return t.distSqr(n<0?e:n>1?i:i.sub(e)._mult(n)._add(e))}function Aa(t,e){let i,r,n,a=!1;for(let o=0;o<t.length;o++){i=t[o];for(let t=0,o=i.length-1;t<i.length;o=t++)r=i[t],n=i[o],r.y>e.y!=n.y>e.y&&e.x<(n.x-r.x)*(e.y-r.y)/(n.y-r.y)+r.x&&(a=!a)}return a}function Ia(t,e){let i=!1;for(let r=0,n=t.length-1;r<t.length;n=r++){const a=t[r],o=t[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(i=!i)}return i}function La(t,e,i){const r=i[0],n=i[2];if(t.x<r.x&&e.x<r.x||t.x>n.x&&e.x>n.x||t.y<r.y&&e.y<r.y||t.y>n.y&&e.y>n.y)return!1;const a=M(t,e,i[0]);return a!==M(t,e,i[1])||a!==M(t,e,i[2])||a!==M(t,e,i[3])}function Pa(t,e,i){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Oa(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ka(t,e,i,r,a){if(!e[0]&&!e[1])return t;const o=n.convert(e)._mult(a);"viewport"===i&&o._rotate(-r);const l=[];for(let e=0;e<t.length;e++)l.push(t[e].sub(o));return l}let Da,Fa;Hr("CircleBucket",ya,{omit:["layers"]});var za={get paint(){return Fa=Fa||new Is({"circle-radius":new bs(ot.paint_circle["circle-radius"]),"circle-color":new bs(ot.paint_circle["circle-color"]),"circle-blur":new bs(ot.paint_circle["circle-blur"]),"circle-opacity":new bs(ot.paint_circle["circle-opacity"]),"circle-translate":new vs(ot.paint_circle["circle-translate"]),"circle-translate-anchor":new vs(ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vs(ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vs(ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bs(ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bs(ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bs(ot.paint_circle["circle-stroke-opacity"])})},get layout(){return Da=Da||new Is({"circle-sort-key":new bs(ot.layout_circle["circle-sort-key"])})}},Ra=1e-6,ja="undefined"!=typeof Float32Array?Float32Array:Array;function Na(){var t=new ja(16);return ja!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ba(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Va(t,e){var i=e[0],r=e[1],n=e[2],a=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],_=e[15],v=i*l-r*o,x=i*c-n*o,b=i*u-a*o,w=r*c-n*l,C=r*u-a*l,S=n*u-a*c,M=h*g-p*m,T=h*y-d*m,E=h*_-f*m,A=p*y-d*g,I=p*_-f*g,P=d*_-f*y,O=v*P-x*I+b*A+w*E-C*T+S*M;return O?(t[0]=(l*P-c*I+u*A)*(O=1/O),t[1]=(n*I-r*P-a*A)*O,t[2]=(g*S-y*C+_*w)*O,t[3]=(d*C-p*S-f*w)*O,t[4]=(c*E-o*P-u*T)*O,t[5]=(i*P-n*E+a*T)*O,t[6]=(y*b-m*S-_*x)*O,t[7]=(h*S-d*b+f*x)*O,t[8]=(o*I-l*E+u*M)*O,t[9]=(r*E-i*I-a*M)*O,t[10]=(m*C-g*b+_*v)*O,t[11]=(p*b-h*C-f*v)*O,t[12]=(l*T-o*A-c*M)*O,t[13]=(i*A-r*T+n*M)*O,t[14]=(g*x-m*w-y*v)*O,t[15]=(h*w-p*x+d*v)*O,t):null}function Ua(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],p=e[8],d=e[9],f=e[10],m=e[11],g=e[12],y=e[13],_=e[14],v=e[15],x=i[0],b=i[1],w=i[2],C=i[3];return t[0]=x*r+b*l+w*p+C*g,t[1]=x*n+b*c+w*d+C*y,t[2]=x*a+b*u+w*f+C*_,t[3]=x*o+b*h+w*m+C*v,t[4]=(x=i[4])*r+(b=i[5])*l+(w=i[6])*p+(C=i[7])*g,t[5]=x*n+b*c+w*d+C*y,t[6]=x*a+b*u+w*f+C*_,t[7]=x*o+b*h+w*m+C*v,t[8]=(x=i[8])*r+(b=i[9])*l+(w=i[10])*p+(C=i[11])*g,t[9]=x*n+b*c+w*d+C*y,t[10]=x*a+b*u+w*f+C*_,t[11]=x*o+b*h+w*m+C*v,t[12]=(x=i[12])*r+(b=i[13])*l+(w=i[14])*p+(C=i[15])*g,t[13]=x*n+b*c+w*d+C*y,t[14]=x*a+b*u+w*f+C*_,t[15]=x*o+b*h+w*m+C*v,t}function Ha(t,e,i){var r,n,a,o,l,c,u,h,p,d,f,m,g=i[0],y=i[1],_=i[2];return e===t?(t[12]=e[0]*g+e[4]*y+e[8]*_+e[12],t[13]=e[1]*g+e[5]*y+e[9]*_+e[13],t[14]=e[2]*g+e[6]*y+e[10]*_+e[14],t[15]=e[3]*g+e[7]*y+e[11]*_+e[15]):(n=e[1],a=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],p=e[8],d=e[9],f=e[10],m=e[11],t[0]=r=e[0],t[1]=n,t[2]=a,t[3]=o,t[4]=l,t[5]=c,t[6]=u,t[7]=h,t[8]=p,t[9]=d,t[10]=f,t[11]=m,t[12]=r*g+l*y+p*_+e[12],t[13]=n*g+c*y+d*_+e[13],t[14]=a*g+u*y+f*_+e[14],t[15]=o*g+h*y+m*_+e[15]),t}function qa(t,e,i){var r=i[0],n=i[1],a=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Za(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[0],o=e[1],l=e[2],c=e[3],u=e[4],h=e[5],p=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+u*r,t[1]=o*n+h*r,t[2]=l*n+p*r,t[3]=c*n+d*r,t[4]=u*n-a*r,t[5]=h*n-o*r,t[6]=p*n-l*r,t[7]=d*n-c*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ga=function(t,e,i,r,n,a,o){var l=1/(e-i),c=1/(r-n),u=1/(a-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*l,t[13]=(n+r)*c,t[14]=(o+a)*u,t[15]=1,t},$a=Ua;function Wa(t){var e=new ja(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}var Xa,Ya=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t};function Ka(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*a+i[12]*o,t[1]=i[1]*r+i[5]*n+i[9]*a+i[13]*o,t[2]=i[2]*r+i[6]*n+i[10]*a+i[14]*o,t[3]=i[3]*r+i[7]*n+i[11]*a+i[15]*o,t}Xa=new ja(3),ja!=Float32Array&&(Xa[0]=0,Xa[1]=0,Xa[2]=0),function(){var t=new ja(4);ja!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Ja=function(t){var e=t[0],i=t[1];return e*e+i*i};function to(t,e){const i=Ka([],[t.x,t.y,0,1],e);return new n(i[0]/i[3],i[1]/i[3])}!function(){var t=new ja(2);ja!=Float32Array&&(t[0]=0,t[1]=0)}();class Qa extends ya{}let eo;Hr("HeatmapBucket",Qa,{omit:["layers"]});var io={get paint(){return eo=eo||new Is({"heatmap-radius":new bs(ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bs(ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vs(ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ss(ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vs(ot.paint_heatmap["heatmap-opacity"])})}};function ro(t,{width:e,height:i},r,n){if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*i*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${e*i*r}`)}else n=new Uint8Array(e*i*r);return t.width=e,t.height=i,t.data=n,t}function so(t,{width:e,height:i},r){if(e===t.width&&i===t.height)return;const n=ro({},{width:e,height:i},r);oo(t,n,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},r),t.width=e,t.height=i,t.data=n.data}function oo(t,e,i,r,n,a){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");const o=t.data,l=e.data;if(o===l)throw new Error("srcData equals dstData, so image is already copied");for(let c=0;c<n.height;c++){const u=((i.y+c)*t.width+i.x)*a,h=((r.y+c)*e.width+r.x)*a;for(let t=0;t<n.width*a;t++)l[h+t]=o[u+t]}return e}class no{constructor(t,e){ro(this,t,1,e)}resize(t){so(this,t,1)}clone(){return new no({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){oo(t,e,i,r,n,1)}}class ao{constructor(t,e){ro(this,t,4,e)}resize(t){so(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){oo(t,e,i,r,n,4)}}function lo(t){const e={},i=t.resolution||256,r=t.clips?t.clips.length:1,n=t.image||new ao({width:i,height:r});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const a=(i,r,a)=>{e[t.evaluationKey]=a;const o=t.expression.evaluate(e);n.data[i+r+0]=Math.floor(255*o.r/o.a),n.data[i+r+1]=Math.floor(255*o.g/o.a),n.data[i+r+2]=Math.floor(255*o.b/o.a),n.data[i+r+3]=Math.floor(255*o.a)};if(t.clips)for(let e=0,n=0;e<r;++e,n+=4*i)for(let r=0,o=0;r<i;r++,o+=4){const l=r/(i-1),{start:c,end:u}=t.clips[e];a(n,o,c*(1-l)+u*l)}else for(let t=0,e=0;t<i;t++,e+=4)a(0,e,t/(i-1));return n}let co;Hr("AlphaImage",no),Hr("RGBAImage",ao);var uo={get paint(){return co=co||new Is({"hillshade-illumination-direction":new vs(ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vs(ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vs(ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vs(ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vs(ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vs(ot.paint_hillshade["hillshade-accent-color"])})}};const ho=ts([{name:"a_pos",components:2,type:"Int16"}],4),{members:po}=ho;var fo={exports:{}};function mo(t,e,i){i=i||2;var r,n,a,o,l,c,u,h=e&&e.length,p=h?e[0]*i:t.length,d=go(t,0,p,i,!0),f=[];if(!d||d.next===d.prev)return f;if(h&&(d=function(t,e,i,r){var n,a,o,l=[];for(n=0,a=e.length;n<a;n++)(o=go(t,e[n]*r,n<a-1?e[n+1]*r:t.length,r,!1))===o.next&&(o.steiner=!0),l.push(Eo(o));for(l.sort(Co),n=0;n<l.length;n++)i=So(l[n],i);return i}(t,e,d,i)),t.length>80*i){r=a=t[0],n=o=t[1];for(var m=i;m<p;m+=i)(l=t[m])<r&&(r=l),(c=t[m+1])<n&&(n=c),l>a&&(a=l),c>o&&(o=c);u=0!==(u=Math.max(a-r,o-n))?32767/u:0}return _o(d,f,i,r,n,u,0),f}function go(t,e,i,r,n){var a,o;if(n===Bo(t,e,i,r)>0)for(a=e;a<i;a+=r)o=Ro(a,t[a],t[a+1],o);else for(a=i-r;a>=e;a-=r)o=Ro(a,t[a],t[a+1],o);return o&&Po(o,o.next)&&(jo(o),o=o.next),o}function yo(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!Po(r,r.next)&&0!==Lo(r.prev,r,r.next))r=r.next;else{if(jo(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function _o(t,e,i,r,n,a,o){if(t){!o&&a&&function(t,e,i,r){var n=t;do{0===n.z&&(n.z=To(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,a,o,l,c,u=1;do{for(i=t,t=null,a=null,o=0;i;){for(o++,r=i,l=0,e=0;e<u&&(l++,r=r.nextZ);e++);for(c=u;l>0||c>0&&r;)0!==l&&(0===c||!r||i.z<=r.z)?(n=i,i=i.nextZ,l--):(n=r,r=r.nextZ,c--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;i=r}a.nextZ=null,u*=2}while(o>1)}(n)}(t,r,n,a);for(var l,c,u=t;t.prev!==t.next;)if(l=t.prev,c=t.next,a?xo(t,r,n,a):vo(t))e.push(l.i/i|0),e.push(t.i/i|0),e.push(c.i/i|0),jo(t),t=c.next,u=c.next;else if((t=c)===u){o?1===o?_o(t=bo(yo(t),e,i),e,i,r,n,a,2):2===o&&wo(t,e,i,r,n,a):_o(yo(t),e,i,r,n,a,1);break}}}function vo(t){var e=t.prev,i=t,r=t.next;if(Lo(e,i,r)>=0)return!1;for(var n=e.x,a=i.x,o=r.x,l=e.y,c=i.y,u=r.y,h=n<a?n<o?n:o:a<o?a:o,p=l<c?l<u?l:u:c<u?c:u,d=n>a?n>o?n:o:a>o?a:o,f=l>c?l>u?l:u:c>u?c:u,m=r.next;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=p&&m.y<=f&&Ao(n,l,a,c,o,u,m.x,m.y)&&Lo(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function xo(t,e,i,r){var n=t.prev,a=t,o=t.next;if(Lo(n,a,o)>=0)return!1;for(var l=n.x,c=a.x,u=o.x,h=n.y,p=a.y,d=o.y,f=l<c?l<u?l:u:c<u?c:u,m=h<p?h<d?h:d:p<d?p:d,g=l>c?l>u?l:u:c>u?c:u,y=h>p?h>d?h:d:p>d?p:d,_=To(f,m,e,i,r),v=To(g,y,e,i,r),x=t.prevZ,b=t.nextZ;x&&x.z>=_&&b&&b.z<=v;){if(x.x>=f&&x.x<=g&&x.y>=m&&x.y<=y&&x!==n&&x!==o&&Ao(l,h,c,p,u,d,x.x,x.y)&&Lo(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=f&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==o&&Ao(l,h,c,p,u,d,b.x,b.y)&&Lo(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=_;){if(x.x>=f&&x.x<=g&&x.y>=m&&x.y<=y&&x!==n&&x!==o&&Ao(l,h,c,p,u,d,x.x,x.y)&&Lo(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=v;){if(b.x>=f&&b.x<=g&&b.y>=m&&b.y<=y&&b!==n&&b!==o&&Ao(l,h,c,p,u,d,b.x,b.y)&&Lo(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function bo(t,e,i){var r=t;do{var n=r.prev,a=r.next.next;!Po(n,a)&&Oo(n,r,r.next,a)&&Fo(n,a)&&Fo(a,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(a.i/i|0),jo(r),jo(r.next),r=t=a),r=r.next}while(r!==t);return yo(r)}function wo(t,e,i,r,n,a){var o=t;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&Io(o,l)){var c=zo(o,l);return o=yo(o,o.next),c=yo(c,c.next),_o(o,e,i,r,n,a,0),void _o(c,e,i,r,n,a,0)}l=l.next}o=o.next}while(o!==t)}function Co(t,e){return t.x-e.x}function So(t,e){var i=function(t,e){var i,r=e,n=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var l=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=n&&l>o&&(o=l,i=r.x<r.next.x?r:r.next,l===n))return i}r=r.next}while(r!==e);if(!i)return null;var c,u=i,h=i.x,p=i.y,d=1/0;r=i;do{n>=r.x&&r.x>=h&&n!==r.x&&Ao(a<p?n:o,a,h,p,a<p?o:n,a,r.x,r.y)&&(c=Math.abs(a-r.y)/(n-r.x),Fo(r,t)&&(c<d||c===d&&(r.x>i.x||r.x===i.x&&Mo(i,r)))&&(i=r,d=c)),r=r.next}while(r!==u);return i}(t,e);if(!i)return e;var r=zo(i,t);return yo(r,r.next),yo(i,i.next)}function Mo(t,e){return Lo(t.prev,t,e.prev)<0&&Lo(e.next,t,t.next)<0}function To(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Eo(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Ao(t,e,i,r,n,a,o,l){return(n-o)*(e-l)>=(t-o)*(a-l)&&(t-o)*(r-l)>=(i-o)*(e-l)&&(i-o)*(a-l)>=(n-o)*(r-l)}function Io(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Oo(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(Fo(t,e)&&Fo(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(Lo(t.prev,t,e.prev)||Lo(t,e.prev,e))||Po(t,e)&&Lo(t.prev,t,t.next)>0&&Lo(e.prev,e,e.next)>0)}function Lo(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Po(t,e){return t.x===e.x&&t.y===e.y}function Oo(t,e,i,r){var n=Do(Lo(t,e,i)),a=Do(Lo(t,e,r)),o=Do(Lo(i,r,t)),l=Do(Lo(i,r,e));return n!==a&&o!==l||!(0!==n||!ko(t,i,e))||!(0!==a||!ko(t,r,e))||!(0!==o||!ko(i,t,r))||!(0!==l||!ko(i,e,r))}function ko(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Do(t){return t>0?1:t<0?-1:0}function Fo(t,e){return Lo(t.prev,t,t.next)<0?Lo(t,e,t.next)>=0&&Lo(t,t.prev,e)>=0:Lo(t,e,t.prev)<0||Lo(t,t.next,e)<0}function zo(t,e){var i=new No(t.i,t.x,t.y),r=new No(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function Ro(t,e,i,r){var n=new No(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function jo(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function No(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bo(t,e,i,r){for(var n=0,a=e,o=i-r;a<i;a+=r)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}fo.exports=mo,fo.exports.default=mo,mo.deviation=function(t,e,i,r){var n=e&&e.length,a=Math.abs(Bo(t,0,n?e[0]*i:t.length,i));if(n)for(var o=0,l=e.length;o<l;o++)a-=Math.abs(Bo(t,e[o]*i,o<l-1?e[o+1]*i:t.length,i));var c=0;for(o=0;o<r.length;o+=3){var u=r[o]*i,h=r[o+1]*i,p=r[o+2]*i;c+=Math.abs((t[u]-t[p])*(t[h+1]-t[u+1])-(t[u]-t[h])*(t[p+1]-t[u+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},mo.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var o=0;o<e;o++)i.vertices.push(t[n][a][o]);n>0&&i.holes.push(r+=t[n-1].length)}return i};var Vo=e(fo.exports);function Uo(t,e,i,r,n){Ho(t,e,i||0,r||t.length-1,n||Zo)}function Ho(t,e,i,r,n){for(;r>i;){if(r-i>600){var a=r-i+1,o=e-i+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(o-a/2<0?-1:1);Ho(t,e,Math.max(i,Math.floor(e-o*c/a+u)),Math.min(r,Math.floor(e+(a-o)*c/a+u)),n)}var h=t[e],p=i,d=r;for(qo(t,i,e),n(t[r],h)>0&&qo(t,i,r);p<d;){for(qo(t,p,d),p++,d--;n(t[p],h)<0;)p++;for(;n(t[d],h)>0;)d--}0===n(t[i],h)?qo(t,i,d):qo(t,++d,r),d<=e&&(i=d+1),e<=d&&(r=d-1)}}function qo(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function Zo(t,e){return t<e?-1:t>e?1:0}function Go(t,e){const i=t.length;if(i<=1)return[t];const r=[];let n,a;for(let e=0;e<i;e++){const i=T(t[e]);0!==i&&(t[e].area=Math.abs(i),void 0===a&&(a=i<0),a===i<0?(n&&r.push(n),n=[t[e]]):n.push(t[e]))}if(n&&r.push(n),e>1)for(let t=0;t<r.length;t++)r[t].length<=e||(Uo(r[t],e,1,r[t].length-1,$o),r[t]=r[t].slice(0,e));return r}function $o(t,e){return e.area-t.area}function Wo(t,e,i){const r=i.patternDependencies;let n=!1;for(const i of e){const e=i.paint.get(`${t}-pattern`);e.isConstant()||(n=!0);const a=e.constantOr(null);a&&(n=!0,r[a.to]=!0,r[a.from]=!0)}return n}function Yo(t,e,i,r,n){const a=n.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r-1},i,{},n.availableImages),l=e.evaluate({zoom:r},i,{},n.availableImages),c=e.evaluate({zoom:r+1},i,{},n.availableImages);t=t&&t.name?t.name:t,l=l&&l.name?l.name:l,c=c&&c.name?c.name:c,a[t]=!0,a[l]=!0,a[c]=!0,i.patterns[o.id]={min:t,mid:l,max:c}}}return i}class Xo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _n,this.indexArray=new zn,this.indexArray2=new Cn,this.programConfigurations=new ca(t.layers,t.zoom),this.segments=new Dn,this.segments2=new Dn,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Wo("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),n=!r.isConstant(),a=[];for(const{feature:o,id:l,index:c,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,h=_a(o,t);if(!this.layers[0]._featureFilter.filter(new us(this.zoom),h,i))continue;const p=n?r.evaluate(h,{},i,e.availableImages):void 0,d={id:l,properties:o.properties,type:o.type,sourceLayerIndex:u,index:c,geometry:t?h.geometry:ga(o),patterns:{},sortKey:p};a.push(d)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:o}=r;if(this.hasPattern){const t=Yo("fill",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,po),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,i,r,n){for(const t of Go(e,500)){let e=0;for(const i of t)e+=i.length;const i=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),r=i.vertexLength,n=[],a=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&a.push(n.length/2);const i=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),r=i.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(r+e.length-1,r),n.push(e[0].x),n.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(r+t-1,r+t),n.push(e[t].x),n.push(e[t].y);i.vertexLength+=e.length,i.primitiveLength+=e.length}const o=Vo(n,a);for(let t=0;t<o.length;t+=3)this.indexArray.emplaceBack(r+o[t],r+o[t+1],r+o[t+2]);i.vertexLength+=e,i.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}let Ko,Jo;Hr("FillBucket",Xo,{omit:["layers","patternFeatures"]});var Qo={get paint(){return Jo=Jo||new Is({"fill-antialias":new vs(ot.paint_fill["fill-antialias"]),"fill-opacity":new bs(ot.paint_fill["fill-opacity"]),"fill-color":new bs(ot.paint_fill["fill-color"]),"fill-outline-color":new bs(ot.paint_fill["fill-outline-color"]),"fill-translate":new vs(ot.paint_fill["fill-translate"]),"fill-translate-anchor":new vs(ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new ws(ot.paint_fill["fill-pattern"])})},get layout(){return Ko=Ko||new Is({"fill-sort-key":new bs(ot.layout_fill["fill-sort-key"])})}};const tl=ts([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),el=ts([{name:"a_centroid",components:2,type:"Int16"}],4),{members:il}=tl;var rl={},nl=i,sl=al;function al(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(ol,this,e)}function ol(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function ll(t){for(var e,i,r=0,n=0,a=t.length,o=a-1;n<a;o=n++)r+=((i=t[o]).x-(e=t[n]).x)*(e.y+i.y);return r}al.types=["Unknown","Point","LineString","Polygon"],al.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,a=0,o=0,l=[];t.pos<i;){if(n<=0){var c=t.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)a+=t.readSVarint(),o+=t.readSVarint(),1===r&&(e&&l.push(e),e=[]),e.push(new nl(a,o));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&l.push(e),l},al.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,a=0,o=1/0,l=-1/0,c=1/0,u=-1/0;t.pos<e;){if(r<=0){var h=t.readVarint();i=7&h,r=h>>3}if(r--,1===i||2===i)(n+=t.readSVarint())<o&&(o=n),n>l&&(l=n),(a+=t.readSVarint())<c&&(c=a),a>u&&(u=a);else if(7!==i)throw new Error("unknown command "+i)}return[o,c,l,u]},al.prototype.toGeoJSON=function(t,e,i){var r,n,a=this.extent*Math.pow(2,i),o=this.extent*t,l=this.extent*e,c=this.loadGeometry(),u=al.types[this.type];function h(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+l)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(r=0;r<c.length;r++)p[r]=c[r][0];h(c=p);break;case 2:for(r=0;r<c.length;r++)h(c[r]);break;case 3:for(c=function(t){var e=t.length;if(e<=1)return[t];for(var i,r,n=[],a=0;a<e;a++){var o=ll(t[a]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}return i&&n.push(i),n}(c),r=0;r<c.length;r++)for(n=0;n<c[r].length;n++)h(c[r][n])}1===c.length?c=c[0]:u="Multi"+u;var d={type:"Feature",geometry:{type:u,coordinates:c},properties:this.properties};return"id"in this&&(d.id=this.id),d};var cl=sl,ul=hl;function hl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(pl,this,e),this.length=this._features.length}function pl(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(i))}hl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new cl(this._pbf,e,this.extent,this._keys,this._values)};var dl=ul;function fl(t,e,i){if(3===t){var r=new dl(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}rl.VectorTile=function(t,e){this.layers=t.readFields(fl,{},e)},rl.VectorTileFeature=sl,rl.VectorTileLayer=ul;const ml=rl.VectorTileFeature.types,yl=Math.pow(2,13);function _l(t,e,i,r,n,a,o,l){t.emplaceBack(e,i,2*Math.floor(r*yl)+o,n*yl*2,a*yl*2,Math.round(l))}class gl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gn,this.centroidVertexArray=new pn,this.indexArray=new zn,this.programConfigurations=new ca(t.layers,t.zoom),this.segments=new Dn,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.features=[],this.hasPattern=Wo("fill-extrusion",this.layers,e);for(const{feature:r,id:n,index:a,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,l=_a(r,t);if(!this.layers[0]._featureFilter.filter(new us(this.zoom),l,i))continue;const c={id:n,sourceLayerIndex:o,index:a,geometry:t?l.geometry:ga(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(Yo("fill-extrusion",this.layers,c,this.zoom,e)):this.addFeature(c,c.geometry,a,i,{}),e.featureIndex.insert(r,c.geometry,a,o,this.index,!0)}}addFeatures(t,e,i){for(const t of this.features){const{geometry:r}=t;this.addFeature(t,r,t.index,e,i)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,il),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,el.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,i,r,n){const a={x:0,y:0,vertexCount:0};for(const i of Go(e,500)){let e=0;for(const t of i)e+=t.length;let r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of i){if(0===t.length)continue;if(xl(t))continue;let e=0;for(let i=0;i<t.length;i++){const n=t[i];if(i>=1){const o=t[i-1];if(!vl(n,o)){r.vertexLength+4>Dn.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=n.sub(o)._perp()._unit(),i=o.dist(n);e+i>32768&&(e=0),_l(this.layoutVertexArray,n.x,n.y,t.x,t.y,0,0,e),_l(this.layoutVertexArray,n.x,n.y,t.x,t.y,0,1,e),a.x+=2*n.x,a.y+=2*n.y,a.vertexCount+=2,e+=i,_l(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,0,e),_l(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,1,e),a.x+=2*o.x,a.y+=2*o.y,a.vertexCount+=2;const l=r.vertexLength;this.indexArray.emplaceBack(l,l+2,l+1),this.indexArray.emplaceBack(l+1,l+2,l+3),r.vertexLength+=4,r.primitiveLength+=2}}}}if(r.vertexLength+e>Dn.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==ml[t.type])continue;const n=[],o=[],l=r.vertexLength;for(const t of i)if(0!==t.length){t!==i[0]&&o.push(n.length/2);for(let e=0;e<t.length;e++){const i=t[e];_l(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),a.x+=i.x,a.y+=i.y,a.vertexCount+=1,n.push(i.x),n.push(i.y)}}const c=Vo(n,o);for(let t=0;t<c.length;t+=3)this.indexArray.emplaceBack(l+c[t],l+c[t+2],l+c[t+1]);r.primitiveLength+=c.length/3,r.vertexLength+=e}for(let t=0;t<a.vertexCount;t++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}function vl(t,e){return t.x===e.x&&(t.x<0||t.x>da)||t.y===e.y&&(t.y<0||t.y>da)}function xl(t){return t.every((t=>t.x<0))||t.every((t=>t.x>da))||t.every((t=>t.y<0))||t.every((t=>t.y>da))}let bl;Hr("FillExtrusionBucket",gl,{omit:["layers","features"]});var wl={get paint(){return bl=bl||new Is({"fill-extrusion-opacity":new vs(ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bs(ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vs(ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vs(ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ws(ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bs(ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bs(ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vs(ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function Cl(t,e){return t.x*e.x+t.y*e.y}function Sl(t,e){if(1===t.length){let i=0;const r=e[i++];let n;for(;!n||r.equals(n);)if(n=e[i++],!n)return 1/0;for(;i<e.length;i++){const a=e[i],o=t[0],l=n.sub(r),c=a.sub(r),u=o.sub(r),h=Cl(l,l),p=Cl(l,c),d=Cl(c,c),f=Cl(u,l),m=Cl(u,c),g=h*d-p*p,y=(d*f-p*m)/g,_=(h*m-p*f)/g,v=r.z*(1-y-_)+n.z*y+a.z*_;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const i of e)t=Math.min(t,i.z);return t}}const Ml=ts([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Tl}=Ml,El=ts([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Al}=El,Il=rl.VectorTileFeature.types,Ll=Math.cos(Math.PI/180*37.5),Pl=Math.pow(2,14)/.5;class kl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new yn,this.layoutVertexArray2=new xn,this.indexArray=new zn,this.programConfigurations=new ca(t.layers,t.zoom),this.segments=new Dn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Wo("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),n=!r.isConstant(),a=[];for(const{feature:e,id:o,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=_a(e,t);if(!this.layers[0]._featureFilter.filter(new us(this.zoom),u,i))continue;const h=n?r.evaluate(u,{},i):void 0,p={id:o,properties:e.properties,type:e.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:ga(e),patterns:{},sortKey:h};a.push(p)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:o}=r;if(this.hasPattern){const t=Yo("line",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Al)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,i,r,n){const a=this.layers[0].layout,o=a.get("line-join").evaluate(t,{}),l=a.get("line-cap"),c=a.get("line-miter-limit"),u=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const i of e)this.addLine(i,t,o,l,c,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}addLine(t,e,i,r,n,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Il[e.type];let l=t.length;for(;l>=2&&t[l-1].equals(t[l-2]);)l--;let c=0;for(;c<l-1&&t[c].equals(t[c+1]);)c++;if(l<(o?3:2))return;"bevel"===i&&(n=1.05);const u=this.overscaling<=16?15*da/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);let p,d,f,m,g;this.e1=this.e2=-1,o&&(p=t[l-2],g=t[c].sub(p)._unit()._perp());for(let e=c;e<l;e++){if(f=e===l-1?o?t[c+1]:void 0:t[e+1],f&&t[e].equals(f))continue;g&&(m=g),p&&(d=p),p=t[e],g=f?f.sub(p)._unit()._perp():m,m=m||g;let y=m.add(g);0===y.x&&0===y.y||y._unit();const _=m.x*g.x+m.y*g.y,v=y.x*g.x+y.y*g.y,x=0!==v?1/v:1/0,b=2*Math.sqrt(2-2*v),w=v<Ll&&d&&f,C=m.x*g.y-m.y*g.x>0;if(w&&e>c){const t=p.dist(d);if(t>2*u){const e=p.sub(p.sub(d)._mult(u/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,m,0,0,h),d=e}}const S=d&&f;let M=S?i:o?"butt":r;if(S&&"round"===M&&(x<a?M="miter":x<=2&&(M="fakeround")),"miter"===M&&x>n&&(M="bevel"),"bevel"===M&&(x>2&&(M="flipbevel"),x<n&&(M="miter")),d&&this.updateDistance(d,p),"miter"===M)y._mult(x),this.addCurrentVertex(p,y,0,0,h);else if("flipbevel"===M){if(x>100)y=g.mult(-1);else{const t=x*m.add(g).mag()/m.sub(g).mag();y._perp()._mult(t*(C?-1:1))}this.addCurrentVertex(p,y,0,0,h),this.addCurrentVertex(p,y.mult(-1),0,0,h)}else if("bevel"===M||"fakeround"===M){const t=-Math.sqrt(x*x-1),e=C?t:0,i=C?0:t;if(d&&this.addCurrentVertex(p,m,e,i,h),"fakeround"===M){const t=Math.round(180*b/Math.PI/20);for(let e=1;e<t;e++){let i=e/t;if(.5!==i){const t=i-.5;i+=i*t*(i-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*t*t+(.848013+_*(.215638*_-1.06021)))}const r=g.sub(m)._mult(i)._add(m)._unit()._mult(C?-1:1);this.addHalfVertex(p,r.x,r.y,!1,C,0,h)}}f&&this.addCurrentVertex(p,g,-e,-i,h)}else if("butt"===M)this.addCurrentVertex(p,y,0,0,h);else if("square"===M){const t=d?1:-1;this.addCurrentVertex(p,y,t,t,h)}else"round"===M&&(d&&(this.addCurrentVertex(p,m,0,0,h),this.addCurrentVertex(p,m,1,1,h,!0)),f&&(this.addCurrentVertex(p,g,-1,-1,h,!0),this.addCurrentVertex(p,g,0,0,h)));if(w&&e<l-1){const t=p.dist(f);if(t>2*u){const e=p.add(f.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,g,0,0,h),p=e}}}}addCurrentVertex(t,e,i,r,n,a=!1){const o=e.y*r-e.x,l=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,a,!1,i,n),this.addHalfVertex(t,o,l,a,!0,-r,n),this.distance>Pl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,i,r,n,a))}addHalfVertex({x:t,y:e},i,r,n,a,o,l){const c=.5*(this.lineClips?this.scaledDistance*(Pl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(n?1:0),(e<<1)+(a?1:0),Math.round(63*i)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&c)<<2,c>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),l.primitiveLength++),a?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let Ol,Dl;Hr("LineBucket",kl,{omit:["layers","patternFeatures"]});var Fl={get paint(){return Dl=Dl||new Is({"line-opacity":new bs(ot.paint_line["line-opacity"]),"line-color":new bs(ot.paint_line["line-color"]),"line-translate":new vs(ot.paint_line["line-translate"]),"line-translate-anchor":new vs(ot.paint_line["line-translate-anchor"]),"line-width":new bs(ot.paint_line["line-width"]),"line-gap-width":new bs(ot.paint_line["line-gap-width"]),"line-offset":new bs(ot.paint_line["line-offset"]),"line-blur":new bs(ot.paint_line["line-blur"]),"line-dasharray":new Ts(ot.paint_line["line-dasharray"]),"line-pattern":new ws(ot.paint_line["line-pattern"]),"line-gradient":new Ss(ot.paint_line["line-gradient"])})},get layout(){return Ol=Ol||new Is({"line-cap":new vs(ot.layout_line["line-cap"]),"line-join":new bs(ot.layout_line["line-join"]),"line-miter-limit":new vs(ot.layout_line["line-miter-limit"]),"line-round-limit":new vs(ot.layout_line["line-round-limit"]),"line-sort-key":new bs(ot.layout_line["line-sort-key"])})}};class Bl extends bs{possiblyEvaluate(t,e){return e=new us(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,r){return e=f({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,r)}}let zl;function Rl(t,e){return e>0?e+2*t:t}const jl=ts([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Nl=ts([{name:"a_projected_pos",components:3,type:"Float32"}],4);ts([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vl=ts([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ts([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ul=ts([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Hl=ts([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ql(t,e,i){return t.sections.forEach((t=>{t.text=function(t,e,i){const r=e.layout.get("text-transform").evaluate(i,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),t}(t.text,e,i)})),t}ts([{name:"triangle",components:3,type:"Uint16"}]),ts([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ts([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ts([{type:"Float32",name:"offsetX"}]),ts([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Zl={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Gl=Xl,$l=function(t,e,i,r,n){var a,o,l=8*n-r-1,c=(1<<l)-1,u=c>>1,h=-7,p=i?n-1:0,d=i?-1:1,f=t[e+p];for(p+=d,a=f&(1<<-h)-1,f>>=-h,h+=l;h>0;a=256*a+t[e+p],p+=d,h-=8);for(o=a&(1<<-h)-1,a>>=-h,h+=r;h>0;o=256*o+t[e+p],p+=d,h-=8);if(0===a)a=1-u;else{if(a===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=u}return(f?-1:1)*o*Math.pow(2,a-r)},Wl=function(t,e,i,r,n,a){var o,l,c,u=8*a-n-1,h=(1<<u)-1,p=h>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,m=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(o++,c/=2),o+p>=h?(l=0,o=h):o+p>=1?(l=(e*c-1)*Math.pow(2,n),o+=p):(l=e*Math.pow(2,p-1)*Math.pow(2,n),o=0));n>=8;t[i+f]=255&l,f+=m,l/=256,n-=8);for(o=o<<n|l,u+=n;u>0;t[i+f]=255&o,f+=m,o/=256,u-=8);t[i+f-m]|=128*g};function Xl(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Xl.Varint=0,Xl.Fixed64=1,Xl.Bytes=2,Xl.Fixed32=5;var Yl=4294967296,Kl=1/Yl,Jl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ql(t){return t.type===Xl.Bytes?t.readVarint()+t.pos:t.pos+1}function tc(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function ec(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n]}function ic(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function rc(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function nc(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function sc(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function ac(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function oc(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function lc(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function cc(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function uc(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function hc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function pc(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function dc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Xl.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,a=this.pos;this.type=7&r,t(n,e,this),this.pos===a&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=hc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=dc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=hc(this.buf,this.pos)+hc(this.buf,this.pos+4)*Yl;return this.pos+=8,t},readSFixed64:function(){var t=hc(this.buf,this.pos)+dc(this.buf,this.pos+4)*Yl;return this.pos+=8,t},readFloat:function(){var t=$l(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=$l(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,a=i.buf;if(r=(112&(n=a[i.pos++]))>>4,n<128)return tc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<3,n<128)return tc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<10,n<128)return tc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<17,n<128)return tc(t,r,e);if(r|=(127&(n=a[i.pos++]))<<24,n<128)return tc(t,r,e);if(r|=(1&(n=a[i.pos++]))<<31,n<128)return tc(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Jl?function(t,e,i){return Jl.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){for(var r="",n=e;n<i;){var a,o,l,c=t[n],u=null,h=c>239?4:c>223?3:c>191?2:1;if(n+h>i)break;1===h?c<128&&(u=c):2===h?128==(192&(a=t[n+1]))&&(u=(31&c)<<6|63&a)<=127&&(u=null):3===h?(o=t[n+2],128==(192&(a=t[n+1]))&&128==(192&o)&&((u=(15&c)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===h&&(o=t[n+2],l=t[n+3],128==(192&(a=t[n+1]))&&128==(192&o)&&128==(192&l)&&((u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&l)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,h=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),n+=h}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Xl.Bytes)return t.push(this.readVarint(e));var i=Ql(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Xl.Bytes)return t.push(this.readSVarint());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Xl.Bytes)return t.push(this.readBoolean());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Xl.Bytes)return t.push(this.readFloat());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Xl.Bytes)return t.push(this.readDouble());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Xl.Bytes)return t.push(this.readFixed32());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Xl.Bytes)return t.push(this.readSFixed32());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Xl.Bytes)return t.push(this.readFixed64());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Xl.Bytes)return t.push(this.readSFixed64());var e=Ql(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Xl.Varint)for(;this.buf[this.pos++]>127;);else if(e===Xl.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Xl.Fixed32)this.pos+=4;else{if(e!==Xl.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),pc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),pc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),pc(this.buf,-1&t,this.pos),pc(this.buf,Math.floor(t*Kl),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),pc(this.buf,-1&t,this.pos),pc(this.buf,Math.floor(t*Kl),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;if(t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,i.buf[i.pos]=127&(t>>>=7)}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,a=0;a<e.length;a++){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){r>56319||a+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&ec(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Wl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Wl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&ec(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,Xl.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,ic,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,rc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ac,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,nc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,sc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,oc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,lc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,cc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,uc,e)},writeBytesField:function(t,e){this.writeTag(t,Xl.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Xl.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Xl.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Xl.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Xl.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Xl.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Xl.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Xl.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Xl.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Xl.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var fc=e(Gl);const mc=3;function gc(t,e,i){1===t&&i.readMessage(yc,e)}function yc(t,e,i){if(3===t){const{id:t,bitmap:r,width:n,height:a,left:o,top:l,advance:c}=i.readMessage(_c,{});e.push({id:t,bitmap:new no({width:n+2*mc,height:a+2*mc},r),metrics:{width:n,height:a,left:o,top:l,advance:c}})}}function _c(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function vc(t){let e=0,i=0;for(const r of t)e+=r.w*r.h,i=Math.max(i,r.w);t.sort(((t,e)=>e.h-t.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let n=0,a=0;for(const e of t)for(let t=r.length-1;t>=0;t--){const i=r[t];if(!(e.w>i.w||e.h>i.h)){if(e.x=i.x,e.y=i.y,a=Math.max(a,e.y+e.h),n=Math.max(n,e.x+e.w),e.w===i.w&&e.h===i.h){const e=r.pop();t<r.length&&(r[t]=e)}else e.h===i.h?(i.x+=e.w,i.w-=e.w):e.w===i.w?(i.y+=e.h,i.h-=e.h):(r.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h}),i.y+=e.h,i.h-=e.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}class xc{constructor(t,{pixelRatio:e,version:i,stretchX:r,stretchY:n,content:a}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=r,this.stretchY=n,this.content=a,this.version=i}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}var bc;function wc(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}Hr("ImagePosition",xc),Hr("ImageAtlas",class{constructor(t,e){const i={},r={};this.haveRenderCallbacks=[];const n=[];this.addImages(t,i,n),this.addImages(e,r,n);const{w:a,h:o}=vc(n),l=new ao({width:a||1,height:o||1});for(const e in t){const r=t[e],n=i[e].paddedRect;ao.copy(r.data,l,{x:0,y:0},{x:n.x+1,y:n.y+1},r.data)}for(const t in e){const i=e[t],n=r[t].paddedRect,a=n.x+1,o=n.y+1,c=i.data.width,u=i.data.height;ao.copy(i.data,l,{x:0,y:0},{x:a,y:o},i.data),ao.copy(i.data,l,{x:0,y:u-1},{x:a,y:o-1},{width:c,height:1}),ao.copy(i.data,l,{x:0,y:0},{x:a,y:o+u},{width:c,height:1}),ao.copy(i.data,l,{x:c-1,y:0},{x:a-1,y:o},{width:1,height:u}),ao.copy(i.data,l,{x:0,y:0},{x:a+c,y:o},{width:1,height:u})}this.image=l,this.iconPositions=i,this.patternPositions=r}addImages(t,e,i){for(const r in t){const n=t[r],a={x:0,y:0,w:n.data.width+2,h:n.data.height+2};i.push(a),e[r]=new xc(a,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)}patchUpdatedImage(t,e,i){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,n]=t.tl;i.update(e.data,void 0,{x:r,y:n})}}),function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.horizontalOnly=3]="horizontalOnly"}(bc||(bc={}));const Cc=128,Sc=255*Cc;function Mc(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new us(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=i;let n=0;for(;n<e.length&&e[n]<=t;)n++;n=Math.max(0,n-1);let a=n;for(;a<e.length&&e[a]<t+1;)a++;a=Math.min(e.length-1,a);const o=e[n],l=e[a];return"composite"===i.kind?{kind:"composite",minZoom:o,maxZoom:l,interpolationType:r}:{kind:"camera",minZoom:o,maxZoom:l,minSize:i.evaluate(new us(o)),maxSize:i.evaluate(new us(l)),interpolationType:r}}}function Tc(t,{uSize:e,uSizeT:i},{lowerSize:r,upperSize:n}){return"source"===t.kind?r/Cc:"composite"===t.kind?ii.number(r/Cc,n/Cc,i):e}function Ec(t,e){let i=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:n,minZoom:a,maxZoom:o}=t,l=n?h(ei.interpolationFactor(n,e,a,o),0,1):0;"camera"===t.kind?r=ii.number(t.minSize,t.maxSize,l):i=l}return{uSizeT:i,uSize:r}}function Ac(t,e,i){let r="never";const n=t.get(e);return n?r=n:t.get(i)&&(r="always"),r}const Ic=rl.VectorTileFeature.types,Pc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Oc(t,e,i,r,n,a,o,l,c,u,h,p,d){const f=l?Math.min(Sc,Math.round(l[0])):0,m=l?Math.min(Sc,Math.round(l[1])):0;t.emplaceBack(e,i,Math.round(32*r),Math.round(32*n),a,o,(f<<1)+(c?1:0),m,16*u,16*h,256*p,256*d)}function kc(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function Fc(t){for(const e of t.sections)if(Qr(e.text))return!0;return!1}class Dc{constructor(t){this.layoutVertexArray=new bn,this.indexArray=new zn,this.programConfigurations=t,this.segments=new Dn,this.dynamicLayoutVertexArray=new wn,this.opacityVertexArray=new Tn,this.hasVisibleVertices=!1,this.placedSymbolArray=new nn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,i,r){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Nl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Pc,!0),this.opacityVertexBuffer.itemSize=1),(i||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Hr("SymbolBuffers",Dc);class Lc{constructor(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new Dn,this.collisionVertexArray=new An}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Vl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Hr("CollisionBuffers",Lc);class Bc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ba([]),this.placementViewportMatrix=Ba([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mc(this.zoom,e["text-size"]),this.iconSizeData=Mc(this.zoom,e["icon-size"]);const i=this.layers[0].layout,r=i.get("symbol-sort-key"),n=i.get("symbol-z-order");this.canOverlap="never"!==Ac(i,"text-overlap","text-allow-overlap")||"never"!==Ac(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==n&&!r.isConstant(),this.sortFeaturesByY=("viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map((t=>bc[t]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Dc(new ca(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Dc(new ca(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new ln,this.lineVertexArray=new cn,this.symbolInstances=new on}calculateGlyphDependencies(t,e,i,r,n){for(let a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(i||r)&&n){const i=Zl[t.charAt(a)];i&&(e[i.charCodeAt(0)]=!0)}}populate(t,e,i){const r=this.layers[0],n=r.layout,a=n.get("text-font"),o=n.get("text-field"),l=n.get("icon-image"),c=("constant"!==o.value.kind||o.value.value instanceof he&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=n.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const p=e.iconDependencies,d=e.glyphDependencies,f=e.availableImages,m=new us(this.zoom);for(const{feature:e,id:o,index:l,sourceLayerIndex:g}of t){const t=r._featureFilter.needGeometry,y=_a(e,t);if(!r._featureFilter.filter(m,y,i))continue;let _,v;if(t||(y.geometry=ga(e)),c){const t=r.getValueAndResolveTokens("text-field",y,i,f),e=he.factory(t);Fc(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Vn()||this.hasRTLText&&Zn.isParsed())&&(_=ql(e,r,y))}if(u){const t=r.getValueAndResolveTokens("icon-image",y,i,f);v=t instanceof pe?t:pe.fromString(t)}if(!_&&!v)continue;const x=this.sortFeaturesByKey?h.evaluate(y,{},i):void 0;if(this.features.push({id:o,text:_,icon:v,index:l,sourceLayerIndex:g,geometry:y.geometry,properties:e.properties,type:Ic[e.type],sortKey:x}),v&&(p[v.name]=!0),_){const t=a.evaluate(y,{},i).join(","),e="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(bc.vertical)>=0;for(const i of _.sections)if(i.image)p[i.image.name]=!0;else{const r=Xr(_.toString()),n=i.fontStack||t,a=d[n]=d[n]||{};this.calculateGlyphDependencies(i.text,a,e,this.allowVerticalPlacement,r)}}}"line"===n.get("symbol-placement")&&(this.features=function(t){const e={},i={},r=[];let n=0;function a(e){r.push(t[e]),n++}function o(t,e,n){const a=i[t];return delete i[t],i[e]=a,r[a].geometry[0].pop(),r[a].geometry[0]=r[a].geometry[0].concat(n[0]),a}function l(t,i,n){const a=e[i];return delete e[i],e[t]=a,r[a].geometry[0].shift(),r[a].geometry[0]=n[0].concat(r[a].geometry[0]),a}function c(t,e,i){const r=i?e[0][e[0].length-1]:e[0][0];return`${t}:${r.x}:${r.y}`}for(let u=0;u<t.length;u++){const h=t[u],p=h.geometry,d=h.text?h.text.toString():null;if(!d){a(u);continue}const f=c(d,p),m=c(d,p,!0);if(f in i&&m in e&&i[f]!==e[m]){const t=l(f,m,p),n=o(f,m,r[t].geometry);delete e[f],delete i[m],i[c(d,r[n].geometry,!0)]=n,r[t].geometry=null}else f in i?o(f,m,p):m in e?l(f,m,p):(a(u),e[f]=n-1,i[m]=n-1)}return r.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const i=this.lineVertexArray.length;if(void 0!==t.segment){let i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]);const n={};for(let r=t.segment+1;r<e.length;r++)n[r]={x:e[r].x,y:e[r].y,tileUnitDistanceFromAnchor:i},r<e.length-1&&(i+=e[r+1].dist(e[r]));for(let i=t.segment||0;i>=0;i--)n[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:r},i>0&&(r+=e[i-1].dist(e[i]));for(let t=0;t<e.length;t++){const e=n[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(t,e,i,r,n,a,o,l,c,u,h,p){const d=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*e.length,f,d,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,_=this.allowVerticalPlacement&&o===bc.vertical?Math.PI/2:0,v=a.text&&a.text.sections;for(let r=0;r<e.length;r++){const{tl:n,tr:o,bl:c,br:u,tex:h,pixelOffsetTL:g,pixelOffsetBR:y,minFontScaleX:x,minFontScaleY:b,glyphOffset:w,isSDF:C,sectionIndex:S}=e[r],M=m.vertexLength,T=w[1];Oc(f,l.x,l.y,n.x,T+n.y,h.x,h.y,i,C,g.x,g.y,x,b),Oc(f,l.x,l.y,o.x,T+o.y,h.x+h.w,h.y,i,C,y.x,g.y,x,b),Oc(f,l.x,l.y,c.x,T+c.y,h.x,h.y+h.h,i,C,g.x,y.y,x,b),Oc(f,l.x,l.y,u.x,T+u.y,h.x+h.w,h.y+h.h,i,C,y.x,y.y,x,b),kc(t.dynamicLayoutVertexArray,l,_),d.emplaceBack(M,M+1,M+2),d.emplaceBack(M+1,M+2,M+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(w[0]),r!==e.length-1&&S===e[r+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,a,a.index,{},p,v&&v[S])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,u,l.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],o,0,!1,0,h)}_addCollisionDebugVertex(t,e,i,r,n,a){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,r,n,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,e,i,r,a,o,l){const c=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),u=c.vertexLength,h=a.layoutVertexArray,p=a.collisionVertexArray,d=l.anchorX,f=l.anchorY;this._addCollisionDebugVertex(h,p,o,d,f,new n(t,e)),this._addCollisionDebugVertex(h,p,o,d,f,new n(i,e)),this._addCollisionDebugVertex(h,p,o,d,f,new n(i,r)),this._addCollisionDebugVertex(h,p,o,d,f,new n(t,r)),c.vertexLength+=4;const m=a.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),c.primitiveLength+=4}addDebugCollisionBoxes(t,e,i,r){for(let n=t;n<e;n++){const t=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,r?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lc(Sn,Ul.members,Cn),this.iconCollisionBox=new Lc(Sn,Ul.members,Cn);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,i,r,n,a,o,l,c){const u={};for(let r=e;r<i;r++){const e=t.get(r);u.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.textFeatureIndex=e.featureIndex;break}for(let e=r;e<n;e++){const i=t.get(e);u.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.verticalTextFeatureIndex=i.featureIndex;break}for(let e=a;e<o;e++){const i=t.get(e);u.iconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.iconFeatureIndex=i.featureIndex;break}for(let e=l;e<c;e++){const i=t.get(e);u.verticalIconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.verticalIconFeatureIndex=i.featureIndex;break}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const i=t.placedSymbolArray.get(e),r=i.vertexStartIndex+4*i.numGlyphs;for(let e=i.vertexStartIndex;e<r;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),i=Math.cos(t),r=[],n=[],a=[];for(let t=0;t<this.symbolInstances.length;++t){a.push(t);const o=this.symbolInstances.get(t);r.push(0|Math.round(e*o.anchorX+i*o.anchorY)),n.push(o.featureIndex)}return a.sort(((t,e)=>r[t]-r[e]||n[e]-n[t])),a}addToSortKeyRanges(t,e){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,i)=>{t>=0&&i.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let zc,Rc;Hr("SymbolBucket",Bc,{omit:["layers","collisionBoxArray","features","compareText"]}),Bc.MAX_GLYPHS=65535,Bc.addDynamicAttributes=kc;var jc={get paint(){return Rc=Rc||new Is({"icon-opacity":new bs(ot.paint_symbol["icon-opacity"]),"icon-color":new bs(ot.paint_symbol["icon-color"]),"icon-halo-color":new bs(ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new bs(ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bs(ot.paint_symbol["icon-halo-blur"]),"icon-translate":new vs(ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new vs(ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new bs(ot.paint_symbol["text-opacity"]),"text-color":new bs(ot.paint_symbol["text-color"],{runtimeType:At,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new bs(ot.paint_symbol["text-halo-color"]),"text-halo-width":new bs(ot.paint_symbol["text-halo-width"]),"text-halo-blur":new bs(ot.paint_symbol["text-halo-blur"]),"text-translate":new vs(ot.paint_symbol["text-translate"]),"text-translate-anchor":new vs(ot.paint_symbol["text-translate-anchor"])})},get layout(){return zc=zc||new Is({"symbol-placement":new vs(ot.layout_symbol["symbol-placement"]),"symbol-spacing":new vs(ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vs(ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bs(ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vs(ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vs(ot.layout_symbol["icon-allow-overlap"]),"icon-overlap":new vs(ot.layout_symbol["icon-overlap"]),"icon-ignore-placement":new vs(ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new vs(ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vs(ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new bs(ot.layout_symbol["icon-size"]),"icon-text-fit":new vs(ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vs(ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new bs(ot.layout_symbol["icon-image"]),"icon-rotate":new bs(ot.layout_symbol["icon-rotate"]),"icon-padding":new bs(ot.layout_symbol["icon-padding"]),"icon-keep-upright":new vs(ot.layout_symbol["icon-keep-upright"]),"icon-offset":new bs(ot.layout_symbol["icon-offset"]),"icon-anchor":new bs(ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vs(ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vs(ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vs(ot.layout_symbol["text-rotation-alignment"]),"text-field":new bs(ot.layout_symbol["text-field"]),"text-font":new bs(ot.layout_symbol["text-font"]),"text-size":new bs(ot.layout_symbol["text-size"]),"text-max-width":new bs(ot.layout_symbol["text-max-width"]),"text-line-height":new vs(ot.layout_symbol["text-line-height"]),"text-letter-spacing":new bs(ot.layout_symbol["text-letter-spacing"]),"text-justify":new bs(ot.layout_symbol["text-justify"]),"text-radial-offset":new bs(ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vs(ot.layout_symbol["text-variable-anchor"]),"text-anchor":new bs(ot.layout_symbol["text-anchor"]),"text-max-angle":new vs(ot.layout_symbol["text-max-angle"]),"text-writing-mode":new vs(ot.layout_symbol["text-writing-mode"]),"text-rotate":new bs(ot.layout_symbol["text-rotate"]),"text-padding":new vs(ot.layout_symbol["text-padding"]),"text-keep-upright":new vs(ot.layout_symbol["text-keep-upright"]),"text-transform":new bs(ot.layout_symbol["text-transform"]),"text-offset":new bs(ot.layout_symbol["text-offset"]),"text-allow-overlap":new vs(ot.layout_symbol["text-allow-overlap"]),"text-overlap":new vs(ot.layout_symbol["text-overlap"]),"text-ignore-placement":new vs(ot.layout_symbol["text-ignore-placement"]),"text-optional":new vs(ot.layout_symbol["text-optional"])})}};class Vc{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:St,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Hr("FormatSectionOverride",Vc,{omit:["defaultValue"]});class Uc extends Es{constructor(t){super(t,jc)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const i of t)e.indexOf(i)<0&&e.push(i);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,i,r){const n=this.layout.get(t).evaluate(e,{},i,r),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||$i(a.value)||!n?n:function(t,e){return e.replace(/{([^{}]+)}/g,((e,i)=>i in t?String(t[i]):""))}(e.properties,n)}createBucket(t){return new Bc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of jc.paint.overridableProperties){if(!Uc.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),i=new Vc(e),r=new qi(i,e.property.specification);let n=null;n="constant"===e.value.kind||"source"===e.value.kind?new Gi("source",r):new Hi("composite",r,e.value.zoomStops),this.paint._values[t]=new ys(e.property,n,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&Uc.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const i=t.get("text-field"),r=jc.paint.properties[e];let n=!1;const a=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(n=!0)};if("constant"===i.value.kind&&i.value.value instanceof he)a(i.value.value.sections);else if("source"===i.value.kind){const t=e=>{n||(e instanceof ge&&_e(e.value)===Ot?a(e.value.sections):e instanceof bi?a(e.sections):e.eachChild(t))},e=i.value;e._styleExpression&&t(e._styleExpression.expression)}return n}}let Nc;var Hc={get paint(){return Nc=Nc||new Is({"background-color":new vs(ot.paint_background["background-color"]),"background-pattern":new Ts(ot.paint_background["background-pattern"]),"background-opacity":new vs(ot.paint_background["background-opacity"])})}};let qc;var Gc={get paint(){return qc=qc||new Is({"raster-opacity":new vs(ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new vs(ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vs(ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vs(ot.paint_raster["raster-brightness-max"]),"raster-saturation":new vs(ot.paint_raster["raster-saturation"]),"raster-contrast":new vs(ot.paint_raster["raster-contrast"]),"raster-resampling":new vs(ot.paint_raster["raster-resampling"]),"raster-fade-duration":new vs(ot.paint_raster["raster-fade-duration"])})}};class Zc extends Es{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const $c={circle:class extends Es{constructor(t){super(t,za)}createBucket(t){return new ya(t)}queryRadius(t){const e=t;return Pa("circle-radius",this,e)+Pa("circle-stroke-width",this,e)+Oa(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,r,n,a,o,l){const c=ka(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,o),u=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),h="map"===this.paint.get("circle-pitch-alignment"),p=h?c:function(t,e){return t.map((t=>to(t,e)))}(c,l),d=h?u*o:u;for(const t of r)for(const e of t){const t=h?e:to(e,l);let i=d;const r=Ka([],[e.x,e.y,0,1],l);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?i*=r[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(i*=a.cameraToCenterDistance/r[3]),ba(p,t,i))return!0}return!1}},heatmap:class extends Es{createBucket(t){return new Qa(t)}constructor(t){super(t,io),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=lo({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends Es{constructor(t){super(t,uo)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends Es{constructor(t){super(t,Qo)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Xo(t)}queryRadius(){return Oa(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,r,n,a,o){return wa(ka(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,o),r)}isTileClipped(){return!0}},"fill-extrusion":class extends Es{constructor(t){super(t,wl)}createBucket(t){return new gl(t)}queryRadius(){return Oa(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,i,r,a,o,l,c){const u=ka(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,l),h=this.paint.get("fill-extrusion-height").evaluate(e,i),p=this.paint.get("fill-extrusion-base").evaluate(e,i),d=function(t,e,i,r){const a=[];for(const i of t){const t=[i.x,i.y,0,1];Ka(t,t,e),a.push(new n(t[0]/t[3],t[1]/t[3]))}return a}(u,c),f=function(t,e,i,r){const a=[],o=[],l=r[8]*e,c=r[9]*e,u=r[10]*e,h=r[11]*e,p=r[8]*i,d=r[9]*i,f=r[10]*i,m=r[11]*i;for(const e of t){const t=[],i=[];for(const a of e){const e=a.x,o=a.y,g=r[0]*e+r[4]*o+r[12],y=r[1]*e+r[5]*o+r[13],_=r[2]*e+r[6]*o+r[14],v=r[3]*e+r[7]*o+r[15],x=_+u,b=v+h,w=g+p,C=y+d,S=_+f,M=v+m,T=new n((g+l)/b,(y+c)/b);T.z=x/b,t.push(T);const E=new n(w/M,C/M);E.z=S/M,i.push(E)}a.push(t),o.push(i)}return[a,o]}(r,p,h,c);return function(t,e,i){let r=1/0;wa(i,e)&&(r=Sl(i,e[0]));for(let n=0;n<e.length;n++){const a=e[n],o=t[n];for(let t=0;t<a.length-1;t++){const e=a[t],n=[e,a[t+1],o[t+1],o[t],e];xa(i,n)&&(r=Math.min(r,Sl(i,n)))}}return r!==1/0&&r}(f[0],f[1],d)}},line:class extends Es{constructor(t){super(t,Fl),this.gradientVersion=0,zl||(zl=new Bl(Fl.paint.properties["line-width"].specification),zl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ye,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=zl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new kl(t)}queryRadius(t){const e=t,i=Rl(Pa("line-width",this,e),Pa("line-gap-width",this,e)),r=Pa("line-offset",this,e);return i/2+Math.abs(r)+Oa(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,r,a,o,l){const c=ka(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,l),u=l/2*Rl(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),h=this.paint.get("line-offset").evaluate(e,i);return h&&(r=function(t,e){const i=[];for(let r=0;r<t.length;r++){const a=t[r],o=[];for(let t=0;t<a.length;t++){const i=a[t-1],r=a[t],l=a[t+1],c=0===t?new n(0,0):r.sub(i)._unit()._perp(),u=t===a.length-1?new n(0,0):l.sub(r)._unit()._perp(),h=c._add(u)._unit(),p=h.x*u.x+h.y*u.y;0!==p&&h._mult(1/p),o.push(h._mult(e)._add(r))}i.push(o)}return i}(r,h*l)),function(t,e,i){for(let r=0;r<e.length;r++){const n=e[r];if(t.length>=3)for(let e=0;e<n.length;e++)if(Ia(t,n[e]))return!0;if(Ca(t,n,i))return!0}return!1}(c,r,u)}isTileClipped(){return!0}},symbol:Uc,background:class extends Es{constructor(t){super(t,Hc)}},raster:class extends Es{constructor(t){super(t,Gc)}}};function Wc(t){return"custom"===t.type?new Zc(t):new $c[t.type](t)}function Xc(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const i=[];for(const{id:r,url:n}of t){const t=`${r}${n}`;-1===i.indexOf(t)&&(i.push(t),e.push({id:r,url:n}))}}return e}function Yc(t,e,i,r,n){if(r)return void t(r);if(n!==Object.values(e).length||n!==Object.values(i).length)return;const a={};for(const t in e){a[t]={};const r=F.getImageCanvasContext(i[t]),n=e[t];for(const e in n){const{width:i,height:o,x:l,y:c,sdf:u,pixelRatio:h,stretchX:p,stretchY:d,content:f}=n[e];a[t][e]={data:null,pixelRatio:h,sdf:u,stretchX:p,stretchY:d,content:f,spriteData:{width:i,height:o,x:l,y:c,context:r}}}}t(null,a)}class Kc{constructor(t,e,i,r){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,r)}update(t,e,i){const{width:r,height:n}=t,a=!(this.size&&this.size[0]===r&&this.size[1]===n||i),{context:o}=this,{gl:l}=o;if(this.useMipmap=Boolean(e&&e.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!e||!1!==e.premultiply)),a)this.size=[r,n],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||P(t)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t):l.texImage2D(l.TEXTURE_2D,0,this.format,r,n,0,this.format,l.UNSIGNED_BYTE,t.data);else{const{x:e,y:a}=i||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||P(t)?l.texSubImage2D(l.TEXTURE_2D,0,e,a,l.RGBA,l.UNSIGNED_BYTE,t):l.texSubImage2D(l.TEXTURE_2D,0,e,a,r,n,l.RGBA,l.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(t,e,i){const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),i!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Qc(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class Jc extends nt{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new ao({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){const e=this.images[t];if(e&&!e.data&&e.spriteData){const t=e.spriteData;e.data=new ao({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),e.spriteData=null}return e}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(t,e){let i=!0;const r=e.data||e.spriteData;return this._validateStretch(e.stretchX,r&&r.width)||(this.fire(new st(new Error(`Image "${t}" has invalid "stretchX" value`))),i=!1),this._validateStretch(e.stretchY,r&&r.height)||(this.fire(new st(new Error(`Image "${t}" has invalid "stretchY" value`))),i=!1),this._validateContent(e.content,e)||(this.fire(new st(new Error(`Image "${t}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let i=0;for(const r of t){if(r[0]<i||r[1]<r[0]||e<r[1])return!1;i=r[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const i=e.spriteData,r=i&&i.width||e.data.width,n=i&&i.height||e.data.height;return!(t[0]<0||r<t[0]||t[1]<0||n<t[1]||t[2]<0||r<t[2]||t[3]<0||n<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e,i=!0){const r=this.getImage(t);if(i&&(r.data.width!==e.data.width||r.data.height!==e.data.height))throw new Error(`size mismatch between old image (${r.data.width}x${r.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=r.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(t,e){const i={};for(const e of t){let t=this.getImage(e);t||(this.fire(new rt("styleimagemissing",{id:e})),t=this.getImage(e)),t?i[e]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:S(`Image "${e}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}e(null,i)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(t){const e=this.patterns[t],i=this.getImage(t);if(!i)return null;if(e&&e.position.version===i.version)return e.position;if(e)e.position.version=i.version;else{const e={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new xc(e,i);this.patterns[t]={bin:e,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Kc(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:e,h:i}=vc(t),r=this.atlasImage;r.resize({width:e||1,height:i||1});for(const t in this.patterns){const{bin:e}=this.patterns[t],i=e.x+1,n=e.y+1,a=this.getImage(t).data,o=a.width,l=a.height;ao.copy(a,r,{x:0,y:0},{x:i,y:n},{width:o,height:l}),ao.copy(a,r,{x:0,y:l-1},{x:i,y:n-1},{width:o,height:1}),ao.copy(a,r,{x:0,y:0},{x:i,y:n+l},{width:o,height:1}),ao.copy(a,r,{x:o-1,y:0},{x:i-1,y:n},{width:1,height:l}),ao.copy(a,r,{x:0,y:0},{x:i+o,y:n},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.getImage(e);t||S(`Image with ID: "${e}" was not found`),Qc(t)&&this.updateImage(e,t)}}}const tu=1e20;function iu(t,e,i,r,n,a,o,l,c){for(let u=e;u<e+r;u++)nu(t,i*a+u,a,n,o,l,c);for(let u=i;u<i+n;u++)nu(t,u*a+e,1,r,o,l,c)}function nu(t,e,i,r,n,a,o){a[0]=0,o[0]=-tu,o[1]=tu,n[0]=t[e];for(let l=1,c=0,u=0;l<r;l++){n[l]=t[e+l*i];const r=l*l;do{const t=a[c];u=(n[l]-n[t]+r-t*t)/(l-t)/2}while(u<=o[c]&&--c>-1);c++,a[c]=l,o[c]=u,o[c+1]=tu}for(let l=0,c=0;l<r;l++){for(;o[c+1]<l;)c++;const r=a[c],u=l-r;t[e+l*i]=n[r]+u*u}}class ih{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(t,e){const i=[];for(const e in t)for(const r of t[e])i.push({stack:e,id:r});d(i,(({stack:t,id:e},i)=>{let r=this.entries[t];r||(r=this.entries[t]={glyphs:{},requests:{},ranges:{}});let n=r.glyphs[e];if(void 0!==n)return void i(null,{stack:t,id:e,glyph:n});if(n=this._tinySDF(r,t,e),n)return r.glyphs[e]=n,void i(null,{stack:t,id:e,glyph:n});const a=Math.floor(e/256);if(256*a>65535)return void i(new Error("glyphs > 65535 not supported"));if(r.ranges[a])return void i(null,{stack:t,id:e,glyph:n});if(!this.url)return void i(new Error("glyphsUrl is not set"));let o=r.requests[a];o||(o=r.requests[a]=[],ih.loadGlyphRange(t,a,this.url,this.requestManager,((t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(r.glyphs[+t]=e[+t]);r.ranges[a]=!0}for(const i of o)i(t,e);delete r.requests[a]}))),o.push(((r,n)=>{r?i(r):n&&i(null,{stack:t,id:e,glyph:n[e]||null})}))}),((t,i)=>{if(t)e(t);else if(i){const t={};for(const{stack:e,id:r,glyph:n}of i)(t[e]||(t[e]={}))[r]=n&&{id:n.id,bitmap:n.bitmap.clone(),metrics:n.metrics};e(null,t)}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(Wr["CJK Unified Ideographs"](t)||Wr["Hangul Syllables"](t)||Wr.Hiragana(t)||Wr.Katakana(t))}_tinySDF(t,e,i){const r=this.localIdeographFontFamily;if(!r)return;if(!this._doesCharSupportLocalGlyph(i))return;let n=t.tinySDF;if(!n){let i="400";/bold/i.test(e)?i="900":/medium/i.test(e)?i="500":/light/i.test(e)&&(i="200"),n=t.tinySDF=new ih.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:r,fontWeight:i})}const a=n.draw(String.fromCharCode(i));return{id:i,bitmap:new no({width:a.width||30,height:a.height||30},a.data),metrics:{width:a.glyphWidth||24,height:a.glyphHeight||24,left:a.glyphLeft||0,top:a.glyphTop-27||-8,advance:a.glyphAdvance||24}}}}ih.loadGlyphRange=function(t,e,i,r,n){const a=256*e,o=a+255,l=r.transformRequest(i.replace("{fontstack}",t).replace("{range}",`${a}-${o}`),J.Glyphs);H(l,((t,e)=>{if(t)n(t);else if(e){const t={};for(const i of function(t){return new fc(t).readFields(gc,[])}(e))t[i.id]=i;n(null,t)}}))},ih.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:r=.25,fontFamily:n="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=i;const l=this.size=t+4*e,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${o} ${a} ${t}px ${n}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:n,actualBoundingBoxRight:a}=this.ctx.measureText(t),o=Math.ceil(i),l=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-n))),c=Math.min(this.size-this.buffer,o+Math.ceil(r)),u=l+2*this.buffer,h=c+2*this.buffer,p=Math.max(u*h,0),d=new Uint8ClampedArray(p),f={data:d,width:u,height:h,glyphWidth:l,glyphHeight:c,glyphTop:o,glyphLeft:0,glyphAdvance:e};if(0===l||0===c)return f;const{ctx:m,buffer:g,gridInner:y,gridOuter:_}=this;m.clearRect(g,g,l,c),m.fillText(t,g,g+o);const v=m.getImageData(g,g,l,c);_.fill(tu,0,p),y.fill(0,0,p);for(let t=0;t<c;t++)for(let e=0;e<l;e++){const i=v.data[4*(t*l+e)+3]/255;if(0===i)continue;const r=(t+g)*u+e+g;if(1===i)_[r]=0,y[r]=tu;else{const t=.5-i;_[r]=t>0?t*t:0,y[r]=t<0?t*t:0}}iu(_,0,0,u,h,u,this.f,this.v,this.z),iu(y,g,g,l,c,u,this.f,this.v,this.z);for(let t=0;t<p;t++){const e=Math.sqrt(_[t])-Math.sqrt(y[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}};class rh{constructor(){this.specification=ot.light.position}possiblyEvaluate(t,e){return function([t,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(i),y:t*Math.sin(e)*Math.sin(i),z:t*Math.cos(i)}}(t.expression.evaluate(e))}interpolate(t,e,i){return{x:ii.number(t.x,e.x,i),y:ii.number(t.y,e.y,i),z:ii.number(t.z,e.z,i)}}}let su;class nh extends nt{constructor(t){super(),su=su||new Is({anchor:new vs(ot.light.anchor),position:new rh,color:new vs(ot.light.color),intensity:new vs(ot.light.intensity)}),this._transitionable=new ms(su),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,e={}){if(!this._validate(Rr,t,e))for(const e in t){const i=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),i):this._transitionable.setValue(e,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,e,i){return(!i||!1!==i.validate)&&Br(this,t.call(zr,f({value:e,style:{glyphs:!0,sprite:!0},styleSpec:ot})))}}class ah{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]}getDashRanges(t,e,i){const r=[];let n=t.length%2==1?-t[t.length-1]*i:0,a=t[0]*i,o=!0;r.push({left:n,right:a,isDash:o,zeroLength:0===t[0]});let l=t[0];for(let e=1;e<t.length;e++){o=!o;const c=t[e];n=l*i,l+=c,a=l*i,r.push({left:n,right:a,isDash:o,zeroLength:0===c})}return r}addRoundDash(t,e,i){const r=e/2;for(let e=-i;e<=i;e++){const n=this.width*(this.nextRow+i+e);let a=0,o=t[a];for(let l=0;l<this.width;l++){l/o.right>1&&(o=t[++a]);const c=Math.abs(l-o.left),u=Math.abs(l-o.right),h=Math.min(c,u);let p;const d=e/i*(r+1);if(o.isDash){const t=r-Math.abs(d);p=Math.sqrt(h*h+t*t)}else p=r-Math.sqrt(h*h+d*d);this.data[n+l]=Math.max(0,Math.min(255,p+128))}}}addRegularDash(t){for(let e=t.length-1;e>=0;--e){const i=t[e],r=t[e+1];i.zeroLength?t.splice(e,1):r&&r.isDash===i.isDash&&(r.left=i.left,t.splice(e,1))}const e=t[0],i=t[t.length-1];e.isDash===i.isDash&&(e.left=i.left-this.width,i.right=e.right+this.width);const r=this.width*this.nextRow;let n=0,a=t[n];for(let e=0;e<this.width;e++){e/a.right>1&&(a=t[++n]);const i=Math.abs(e-a.left),o=Math.abs(e-a.right),l=Math.min(i,o);this.data[r+e]=Math.max(0,Math.min(255,(a.isDash?l:-l)+128))}}addDash(t,e){const i=e?7:0,r=2*i+1;if(this.nextRow+r>this.height)return S("LineAtlas out of space"),null;let n=0;for(let e=0;e<t.length;e++)n+=t[e];if(0!==n){const r=this.width/n,a=this.getDashRanges(t,this.width,r);e?this.addRoundDash(a,r,i):this.addRegularDash(a)}const a={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:n};return this.nextRow+=r,this.dirty=!0,a}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}class oh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}class lh{constructor(t,e,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=i;const r=this.workerPool.acquire(i);for(let t=0;t<r.length;t++){const n=new lh.Actor(r[t],e,i);n.name=`Worker ${t}`,this.actors.push(n)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,e,i){d(this.actors,((i,r)=>{i.send(t,e,r)}),i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((t=>{t.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}}function au(t,e,i){const r=function(e,r){if(e)return i(e);if(r){const e=m(f(r,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(e.vectorLayers=r.vector_layers,e.vectorLayerIds=e.vectorLayers.map((t=>t.id))),i(null,e)}};return t.url?U(e.transformRequest(t.url,J.Source),r):F.frame((()=>r(null,t)))}lh.Actor=class{constructor(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},_(["receive","process"],this),this.invoker=new oh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=E()?t:window}send(t,e,i,r,n=!1){const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[a]=i);const o=I(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!i,targetMapId:r,mustQueue:n,sourceMapId:this.mapId,data:Zr(e,o)},o),{cancel:()=>{i&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(t){const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];const t=this.cancelCallbacks[i];delete this.cancelCallbacks[i],t&&t()}else E()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)}process(){if(!this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i($r(e.error)):i(null,$r(e.data)))}else{let i=!1;const r=I(this.globalScope)?void 0:[],n=e.hasCallback?(e,n)=>{i=!0,delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?Zr(e):null,data:Zr(n,r)},r)}:t=>{i=!0};let a=null;const o=$r(e.data);if(this.parent[e.type])a=this.parent[e.type](e.sourceMapId,o,n);else if(this.parent.getWorkerSource){const t=e.type.split(".");a=this.parent.getWorkerSource(e.sourceMapId,t[0],o.source)[t[1]](o,n)}else n(new Error(`Could not find function ${e.type}`));!i&&a&&a.cancel&&(this.cancelCallbacks[t]=a.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}};const ou=6371008.8;class uh{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new uh(p(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,i=this.lat*e,r=t.lat*e,n=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return ou*Math.acos(Math.min(n,1))}static convert(t){if(t instanceof uh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new uh(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new uh(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ph{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof uh?new uh(t.lng,t.lat):uh.convert(t),this}setSouthWest(t){return this._sw=t instanceof uh?new uh(t.lng,t.lat):uh.convert(t),this}extend(t){const e=this._sw,i=this._ne;let r,n;if(t instanceof uh)r=t,n=t;else{if(!(t instanceof ph))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(ph.convert(t)):this.extend(uh.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(uh.convert(t)):this;if(r=t._sw,n=t._ne,!r||!n)return this}return e||i?(e.lng=Math.min(r.lng,e.lng),e.lat=Math.min(r.lat,e.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new uh(r.lng,r.lat),this._ne=new uh(n.lng,n.lat)),this}getCenter(){return new uh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new uh(this.getWest(),this.getNorth())}getSouthEast(){return new uh(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:i}=uh.convert(t);let r=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}static convert(t){return t instanceof ph?t:t?new ph(t):t}static fromLngLat(t,e=0){const i=360*e/40075017,r=i/Math.cos(Math.PI/180*t.lat);return new ph(new uh(t.lng-r,t.lat-i),new uh(t.lng+r,t.lat+i))}}const lu=2*Math.PI*ou;function cu(t){return lu*Math.cos(t*Math.PI/180)}function uu(t){return(180+t)/360}function hu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function pu(t,e){return t/cu(e)}function du(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class xh{constructor(t,e,i=0){this.x=+t,this.y=+e,this.z=+i}static fromLngLat(t,e=0){const i=uh.convert(t);return new xh(uu(i.lng),hu(i.lat),pu(e,i.lat))}toLngLat(){return new uh(360*this.x-180,du(this.y))}toAltitude(){return this.z*cu(du(this.y))}meterInMercatorCoordinateUnits(){return 1/lu*(t=du(this.y),1/Math.cos(t*Math.PI/180));var t}}class vh{constructor(t,e,i){this.bounds=ph.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const e=Math.pow(2,t.z),i=Math.floor(uu(this.bounds.getWest())*e),r=Math.floor(hu(this.bounds.getNorth())*e),n=Math.ceil(uu(this.bounds.getEast())*e),a=Math.ceil(hu(this.bounds.getSouth())*e);return t.x>=i&&t.x<n&&t.y>=r&&t.y<a}}class bh extends nt{constructor(t,e,i,r){if(super(),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f(this,m(e,["url","scheme","tileSize","promoteId"])),this._options=f({type:"vector"},e),this._collectResourceTiming=e.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}load(){this._loaded=!1,this.fire(new rt("dataloading",{dataType:"source"})),this._tileJSONRequest=au(this._options,this.map._requestManager,((t,e)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new st(t)):e&&(f(this,e),e.bounds&&(this.tileBounds=new vh(e.bounds,this.minzoom,this.maxzoom)),this.fire(new rt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new rt("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return f({},this._options)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,J.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function n(i,r){return delete t.request,t.aborted?e(null):i&&404!==i.status?e(i):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}r.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:t.request=t.actor.send("reloadTile",r,n.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",r,n.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class wh extends nt{constructor(t,e,i,r){super(),this.id=t,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f({type:"raster"},e),f(this,m(e,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new rt("dataloading",{dataType:"source"})),this._tileJSONRequest=au(this._options,this.map._requestManager,((t,e)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new st(t)):e&&(f(this,e),e.bounds&&(this.tileBounds=new vh(e.bounds,this.minzoom,this.maxzoom)),this.fire(new rt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new rt("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return f({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=tt.getImage(this.map._requestManager.transformRequest(i,J.Tile),((i,r,n)=>{if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(i)t.state="errored",e(i);else if(r){this.map._refreshExpiredTiles&&n&&t.setExpiryData(n);const i=this.map.painter.context,a=i.gl;t.texture=this.map.painter.getTileTexture(r.width),t.texture?t.texture.update(r,{useMipmap:!0}):(t.texture=new Kc(i,r,a.RGBA,{useMipmap:!0}),t.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),t.state="loaded",e(null)}}),this.map._refreshExpiredTiles)}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}let fu;function mu(t,e,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class Ih{constructor(t,e,i){if(t<0||t>25||i<0||i>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${i}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=i,this.key=gu(0,t,t,e,i)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,i){const r=(a=this.y,o=this.z,l=mu(256*(n=this.x),256*(a=Math.pow(2,o)-a-1),o),c=mu(256*(n+1),256*(a+1),o),l[0]+","+l[1]+","+c[0]+","+c[1]);var n,a,o,l,c;const u=function(t,e,i){let r,n="";for(let a=t;a>0;a--)r=1<<a-1,n+=(e&r?1:0)+(i&r?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,r)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new n((t.x*e-this.x)*da,(t.y*e-this.y)*da)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ah{constructor(t,e){this.wrap=t,this.canonical=e,this.key=gu(t,e.z,e.z,e.x,e.y)}}class Eh{constructor(t,e,i,r,n){if(t<i)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${i}`);this.overscaledZ=t,this.wrap=e,this.canonical=new Ih(i,+r,+n),this.key=gu(e,t,i,r,n)}clone(){return new Eh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new Eh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Eh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?gu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):gu(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Eh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new Eh(e,this.wrap,e,i,r),new Eh(e,this.wrap,e,i+1,r),new Eh(e,this.wrap,e,i,r+1),new Eh(e,this.wrap,e,i+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Eh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Eh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ah(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new xh(t.x-this.wrap,t.y))}}function gu(t,e,i,r,n){(t*=2)<0&&(t=-1*t-1);const a=1<<i;return(a*a*t+a*n+r).toString(36)+i.toString(36)+e.toString(36)}Hr("CanonicalTileID",Ih),Hr("OverscaledTileID",Eh,{omit:["posMatrix"]}),Hr("DEMData",class{constructor(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return void S(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const r=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(let t=0;t<r;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(r,t)]=this.data[this._idx(r-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,r)]=this.data[this._idx(t,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let t=0;t<r;t++)for(let e=0;e<r;e++){const i=this.get(t,e);i>this.max&&(this.max=i),i<this.min&&(this.min=i)}}get(t,e){const i=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[r],i[r+1],i[r+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,i){return(256*t*256+256*e+i)/10-1e4}_unpackTerrarium(t,e,i){return 256*t+e+i/256-32768}getPixels(){return new ao({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,n=e*this.dim+this.dim,a=i*this.dim,o=i*this.dim+this.dim;switch(e){case-1:r=n-1;break;case 1:n=r+1}switch(i){case-1:a=o-1;break;case 1:o=a+1}const l=-e*this.dim,c=-i*this.dim;for(let e=a;e<o;e++)for(let i=r;i<n;i++)this.data[this._idx(i,e)]=t.data[this._idx(i+l,e+c)]}});class Ch extends wh{constructor(t,e,i,r){super(t,e,i,r),this.type="raster-dem",this.maxzoom=22,this._options=f({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function r(i,r){i&&(t.state="errored",e(i)),r&&(t.dem=r,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",e(null))}t.request=tt.getImage(this.map._requestManager.transformRequest(i,J.Tile),function(i,n){if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(i)t.state="errored",e(i);else if(n){this.map._refreshExpiredTiles&&t.setExpiryData(n),delete n.cacheControl,delete n.expires;const e=P(n)&&(null==fu&&(fu="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),fu)?n:F.getImageData(n,1),i={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:e,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",i,r.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const e=t.canonical,i=Math.pow(2,e.z),r=(e.x-1+i)%i,n=0===e.x?t.wrap-1:t.wrap,a=(e.x+1+i)%i,o=e.x+1===i?t.wrap+1:t.wrap,l={};return l[new Eh(t.overscaledZ,n,e.z,r,e.y).key]={backfilled:!1},l[new Eh(t.overscaledZ,o,e.z,a,e.y).key]={backfilled:!1},e.y>0&&(l[new Eh(t.overscaledZ,n,e.z,r,e.y-1).key]={backfilled:!1},l[new Eh(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},l[new Eh(t.overscaledZ,o,e.z,a,e.y-1).key]={backfilled:!1}),e.y+1<i&&(l[new Eh(t.overscaledZ,n,e.z,r,e.y+1).key]={backfilled:!1},l[new Eh(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},l[new Eh(t.overscaledZ,o,e.z,a,e.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class Mh extends nt{constructor(t,e,i,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(r),this._data=e.data,this._options=f({},e),this._collectResourceTiming=e.collectResourceTiming,void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;const n=da/this.tileSize;this.workerOptions=f({source:this.id,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*n,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*n,extent:da,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:void 0!==e.clusterMaxZoom?e.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:da,radius:(e.clusterRadius||50)*n,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties,filter:e.filter},e.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,i,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},r),this}_updateWorkerData(t){const e=f({},this.workerOptions);t?e.dataDiff=t:"string"==typeof this._data?(e.request=this.map._requestManager.transformRequest(F.resolveURL(this._data),J.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new rt("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,e,((t,e)=>{if(this._pendingLoads--,this._removed||e&&e.abandoned)return void this.fire(new rt("dataabort",{dataType:"source"}));let i=null;if(e&&e.resourceTiming&&e.resourceTiming[this.id]&&(i=e.resourceTiming[this.id].slice(0)),t)return void this.fire(new st(t));const r={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&f(r,{resourceTiming:i}),this.fire(new rt("data",{...r,sourceDataType:"metadata"})),this.fire(new rt("data",{...r,sourceDataType:"content"}))}))}loaded(){return 0===this._pendingLoads}loadTile(t,e){const i=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const r={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(i,r,((r,n)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):r?e(r):(t.loadVectorData(n,this.map.painter,"reloadTile"===i),e(null)))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return f({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yu=ts([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ph extends nt{constructor(t,e,i,r){super(),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e}load(t,e){this._loaded=!1,this.fire(new rt("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=tt.getImage(this.map._requestManager.transformRequest(this.url,J.Image),((i,r)=>{this._request=null,this._loaded=!0,i?this.fire(new st(i)):r&&(this.image=r,t&&(this.coordinates=t),e&&e(),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new rt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const e=t.map(xh.fromLngLat);this.tileID=function(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(const a of t)e=Math.min(e,a.x),i=Math.min(i,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);const a=Math.max(r-e,n-i),o=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),l=Math.pow(2,o);return new Ih(o,Math.floor((e+r)/2*l),Math.floor((i+n)/2*l))}(e),this.minzoom=this.maxzoom=this.tileID.z;const i=e.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new mn,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,da,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,da),this._boundsArray.emplaceBack(i[2].x,i[2].y,da,da),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new rt("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,e=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yu.members)),this.boundsSegments||(this.boundsSegments=Dn.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Kc(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new rt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Dh extends Ph{constructor(t,e,i,r){super(t,e,i,r),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,J.Source).url);!function(t,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let e=0;e<t.length;e++){const r=window.document.createElement("source");q(t[e])||(i.crossOrigin="Anonymous"),r.src=t[e],i.appendChild(r)}}(this.urls,((t,e)=>{this._loaded=!0,t?this.fire(new st(t)):e&&(this.video=e,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new st(new xt(`sources.${this.id}`,null,`Playback for this video can be set only between the ${e.start(0)} and ${e.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,e=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yu.members)),this.boundsSegments||(this.boundsSegments=Dn.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new Kc(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new rt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Lh extends Ph{constructor(t,e,i,r){super(t,e,i,r),e.coordinates?Array.isArray(e.coordinates)&&4===e.coordinates.length&&!e.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new st(new xt(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new st(new xt(`sources.${t}`,null,'missing required property "coordinates"'))),e.animate&&"boolean"!=typeof e.animate&&this.fire(new st(new xt(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),e.canvas?"string"==typeof e.canvas||e.canvas instanceof HTMLCanvasElement||this.fire(new st(new xt(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new st(new xt(`sources.${t}`,null,'missing required property "canvas"'))),this.options=e,this.animate=void 0===e.animate||e.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new st(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,yu.members)),this.boundsSegments||(this.boundsSegments=Dn.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Kc(e,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new rt("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const _u={vector:bh,raster:wh,"raster-dem":Ch,geojson:Mh,video:Dh,image:Ph,canvas:Lh};function vu(t,e){const i=Na();return Ha(i,i,[1,1,0]),qa(i,i,[.5*t.width,.5*t.height,1]),Ua(i,i,t.calculatePosMatrix(e.toUnwrapped()))}function xu(t,e,i,r,n,a){const o=function(t,e,i){if(t)for(const r of t){const t=e[r];if(t&&t.source===i&&"fill-extrusion"===t.type)return!0}else for(const t in e){const r=e[t];if(r.source===i&&"fill-extrusion"===r.type)return!0}return!1}(n&&n.layers,e,t.id),l=a.maxPitchScaleFactor(),c=t.tilesIn(r,l,o);c.sort(bu);const u=[];for(const r of c)u.push({wrappedTileID:r.tileID.wrapped().key,queryResults:r.tile.queryRenderedFeatures(e,i,t._state,r.queryGeometry,r.cameraQueryGeometry,r.scale,n,a,l,vu(t.transform,r.tileID))});const h=function(t){const e={},i={};for(const r of t){const t=r.queryResults,n=r.wrappedTileID,a=i[n]=i[n]||{};for(const i in t){const r=t[i],n=a[i]=a[i]||{},o=e[i]=e[i]||[];for(const t of r)n[t.featureIndex]||(n[t.featureIndex]=!0,o.push(t))}}return e}(u);for(const e in h)h[e].forEach((e=>{const i=e.feature,r=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r}));return h}function bu(t,e){const i=t.tileID,r=e.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}class Vh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Uh{constructor(t,e,i,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=r,this.properties=t.properties,this.id=n}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}function Su(t,e,i,r,n){return v(t,((t,a)=>{const o=e instanceof xs?e.get(a):null;return o&&o.evaluate?o.evaluate(i,r,n):o}))}function Eu(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(const a of t)e=Math.min(e,a.x),i=Math.min(i,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return{minX:e,minY:i,maxX:r,maxY:n}}function Au(t,e){return e-t}Hr("FeatureIndex",class{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ur(da,16,0),this.grid3D=new Ur(da,16,0),this.featureIndexArray=new un,this.promoteId=e}insert(t,e,i,r,n,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,r,n);const l=a?this.grid3D:this.grid;for(let t=0;t<e.length;t++){const i=e[t],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<i.length;t++){const e=i[t];r[0]=Math.min(r[0],e.x),r[1]=Math.min(r[1],e.y),r[2]=Math.max(r[2],e.x),r[3]=Math.max(r[3],e.y)}r[0]<da&&r[1]<da&&r[2]>=0&&r[3]>=0&&l.insert(o,r[0],r[1],r[2],r[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rl.VectorTile(new fc(this.rawTileData)).layers,this.sourceLayerCoder=new Vh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,r){this.loadVTLayers();const a=t.params||{},o=da/t.tileSize/t.scale,l=tr(a.filter),c=t.queryGeometry,u=t.queryPadding*o,h=Eu(c),p=this.grid.query(h.minX-u,h.minY-u,h.maxX+u,h.maxY+u),d=Eu(t.cameraQueryGeometry),f=this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,((e,i,r,a)=>function(t,e,i,r,a){for(const n of t)if(e<=n.x&&i<=n.y&&r>=n.x&&a>=n.y)return!0;const o=[new n(e,i),new n(e,a),new n(r,a),new n(r,i)];if(t.length>2)for(const e of o)if(Ia(t,e))return!0;for(let e=0;e<t.length-1;e++)if(La(t[e],t[e+1],o))return!0;return!1}(t.cameraQueryGeometry,e-u,i-u,r+u,a+u)));for(const t of f)p.push(t);p.sort(Au);const m={};let g;for(let n=0;n<p.length;n++){const u=p[n];if(u===g)continue;g=u;const h=this.featureIndexArray.get(u);let d=null;this.loadMatchingFeature(m,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,l,a.layers,a.availableImages,e,i,r,((e,i,r)=>(d||(d=ga(e)),i.queryIntersectsFeature(c,e,r,d,this.z,t.transform,o,t.pixelPosMatrix))))}return m}loadMatchingFeature(t,e,i,r,n,a,o,l,c,u,h){const p=this.bucketLayerIDs[e];if(a&&!function(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1}(a,p))return;const d=this.sourceLayerCoder.decode(i),m=this.vtLayers[d].feature(r);if(n.needGeometry){const t=_a(m,!0);if(!n.filter(new us(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new us(this.tileID.overscaledZ),m))return;const g=this.getId(m,d);for(let e=0;e<p.length;e++){const i=p[e];if(a&&a.indexOf(i)<0)continue;const n=l[i];if(!n)continue;let d={};g&&u&&(d=u.getState(n.sourceLayer||"_geojsonTileLayer",g));const y=f({},c[i]);y.paint=Su(y.paint,n.paint,m,d,o),y.layout=Su(y.layout,n.layout,m,d,o);const _=!h||h(m,n,d);if(!_)continue;const v=new Uh(m,this.z,this.x,this.y,g);v.layer=y;let x=t[i];void 0===x&&(x=t[i]=[]),x.push({featureIndex:r,feature:v,intersectionZ:_})}}lookupSymbolFeatures(t,e,i,r,n,a,o,l){const c={};this.loadVTLayers();const u=tr(n);for(const n of t)this.loadMatchingFeature(c,i,r,n,u,a,o,l,e);return c}hasLayer(t){for(const e of this.bucketLayerIDs)for(const i of e)if(t===i)return!0;return!1}getId(t,e){let i=t.id;return this.promoteId&&(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof i&&(i=Number(i))),i}},{omit:["rawTileData","sourceLayerCoder"]});class jh{constructor(t,e){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=y(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const i={};if(!e)return i;for(const r of t){const t=r.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)i[e.id]=r}}return i}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Bc){if(this.hasSymbolBuckets=!0,!i)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Bc&&e.hasRTLText){this.hasRTLText=!0,Zn.isLoading()||Zn.isLoaded()||"deferred"!==Vn()||Un();break}}this.queryPadding=0;for(const t in this.buckets){const i=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(i))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new rn}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Kc(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Kc(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,i,r,n,a,o,l,c,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:n,scale:a,tileSize:this.tileSize,pixelPosMatrix:u,transform:l,params:o,queryPadding:this.queryPadding*c},t,e,i):{}}querySourceFeatures(t,e){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const r=i.loadVTLayers(),n=e&&e.sourceLayer?e.sourceLayer:"",a=r._geojsonTileLayer||r[n];if(!a)return;const o=tr(e&&e.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let e=0;e<a.length;e++){const r=a.feature(e);if(o.needGeometry){const t=_a(r,!0);if(!o.filter(new us(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new us(this.tileID.overscaledZ),r))continue;const p=i.getId(r,n),d=new Uh(r,l,c,u,p);d.tile=h,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,i,r,n)=>{const a=r||n;return e[i]=!a||a.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let i=!1;if(this.expirationTime>t)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{const r=this.expirationTime-e;r?this.expirationTime=t+Math.max(r,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const n=this.buckets[r],a=n.layers[0].sourceLayer||"_geojsonTileLayer",o=i[a],l=t[a];if(!o||!l||0===Object.keys(l).length)continue;n.update(l,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const c=e&&e.style&&e.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(n)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=F.now()+t}setDependencies(t,e){const i={};for(const t of e)i[t]=!0;this.dependencies[t]=i}hasDependency(t,e){for(const i of t){const t=this.dependencies[i];if(t)for(const i of e)if(t[i])return!0}return!1}}class Zh{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,i){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const n={value:e,timeout:void 0};if(void 0!==i&&(n.timeout=setTimeout((()=>{this.remove(t,n)}),i)),this.data[r].push(n),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const i=t.wrapped().key,r=void 0===e?0:this.data[i].indexOf(e),n=this.data[i][r];return this.data[i].splice(r,1),n.timeout&&clearTimeout(n.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(n.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const i in this.data)for(const r of this.data[i])t(r.value)||e.push(r);for(const t of e)this.remove(t.value.tileID,t)}}class Gh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,i){const r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},f(this.stateChanges[t][r],i),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])i[e]||(this.deletedStates[t][r][e]=null)}else for(const e in i)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][e]&&delete this.deletedStates[t][r][e]}removeFeatureState(t,e,i){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(i in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][i]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(t,e){const i=String(e),r=f({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const i=this.deletedStates[t][e];if(null===i)return{};for(const t in i)delete r[t]}return r}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const i={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const i in this.stateChanges[t])this.state[t][i]||(this.state[t][i]={}),f(this.state[t][i],this.stateChanges[t][i]),e[i]=this.state[t][i];i[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const i in this.state[t])e[i]={},this.state[t][i]={};else for(const i in this.deletedStates[t]){if(null===this.deletedStates[t][i])this.state[t][i]={};else for(const e of Object.keys(this.deletedStates[t][i]))delete this.state[t][i][e];e[i]=this.state[t][i]}i[t]=i[t]||{},f(i[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const r in t)t[r].setFeatureState(i,e)}}class Hh extends nt{constructor(t,e,i){super(),this.id=t,this.dispatcher=i,this.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=function(t,e,i,r){const n=new _u[e.type](t,e,i,r);if(n.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${n.id}`);return _(["load","abort","unload","serialize","prepare"],n),n}(t,e,i,this),this._tiles={},this._cache=new Zh(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gh,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,e){return this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,(()=>{})),this._source.fire(new rt("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(Iu).map((t=>t.key))}getRenderableIds(t){const e=[];for(const i in this._tiles)this._isIdRenderable(i,t)&&e.push(this._tiles[i]);return t?e.sort(((t,e)=>{const i=t.tileID,r=e.tileID,a=new n(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),o=new n(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-r.overscaledZ||o.y-a.y||o.x-a.x})).map((t=>t.tileID.key)):e.map((t=>t.tileID)).sort(Iu).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,e){const i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))}_tileLoaded(t,e,i,r){if(r)return t.state="errored",void(404!==r.status?this._source.fire(new st(r,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=F.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new rt("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){const e=this.getTileByID(n);i(t,e),i(e,t)}}function i(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let i=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+n)?i+=n:1===Math.abs(i-n)&&(i-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,r),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,i,r){for(const n in this._tiles){let a=this._tiles[n];if(r[n]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>i)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>e+1;){const t=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[t.key],a&&a.hasData()&&(o=t)}let l=o;for(;l.overscaledZ>e;)if(l=l.scaledTo(l.overscaledZ-1),t[l.key]){r[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(let i=t.overscaledZ-1;i>=e;i--){const e=t.scaledTo(i),r=this._getLoadedTile(e);if(r)return r}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const e=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*i*(null===this._maxTileCacheZoomLevels?z.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const i in this._tiles){const r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}update(t,e){if(this.transform=t,this.terrain=e,!this._sourceLoaded||this._paused)return;let i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new Eh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(i=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:e}),this._source.hasTile&&(i=i.filter((t=>this._source.hasTile(t))))):i=[];const r=t.coveringZoomLevel(this._source),n=Math.max(r-Hh.maxOverzooming,this._source.minzoom),a=Math.max(r+Hh.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of i)if(e.canonical.z>this._source.minzoom){const i=e.scaledTo(e.canonical.z-1);t[i.key]=i;const r=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[r.key]=r}i=i.concat(Object.values(t))}const o=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,o&&this.fire(new rt("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(i,r);if(Lu(this._source.type)){const t={},o={},c=Object.keys(l),u=F.now();for(const e of c){const i=l[e],r=this._tiles[e];if(!r||0!==r.fadeEndTime&&r.fadeEndTime<=u)continue;const a=this.findLoadedParent(i,n);a&&(this._addTile(a.tileID),t[a.tileID.key]=a.tileID),o[e]=i}this._retainLoadedChildren(o,r,a,l);for(const e in t)l[e]||(this._coveredTiles[e]=!0,l[e]=t[e]);if(e){const t={},e={};for(const r of i)this._tiles[r.key].hasData()?t[r.key]=r:e[r.key]=r;for(const i in e){const r=e[i].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(t[r[0].key]=l[r[0].key]=r[0],t[r[1].key]=l[r[1].key]=r[1],t[r[2].key]=l[r[2].key]=r[2],t[r[3].key]=l[r[3].key]=r[3],delete e[i])}for(const i in e){const r=this.findLoadedParent(e[i],this._source.minzoom);if(r){t[r.tileID.key]=l[r.tileID.key]=r.tileID;for(const e in t)t[e].isChildOf(r.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}for(const t in l)this._tiles[t].clearFadeHold();const c=function(t,e){const i=[];for(const r in t)r in e||i.push(r);return i}(this._tiles,l);for(const t of c){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){const i={},r={},n=Math.max(e-Hh.maxOverzooming,this._source.minzoom),a=Math.max(e+Hh.maxUnderzooming,this._source.minzoom),o={};for(const r of t){const t=this._addTile(r);i[r.key]=r,t.hasData()||e<this._source.maxzoom&&(o[r.key]=r)}this._retainLoadedChildren(o,e,a,i);for(const a of t){let t=this._tiles[a.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=a.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){i[t.key]=t;continue}}else{const t=a.children(this._source.maxzoom);if(i[t[0].key]&&i[t[1].key]&&i[t[2].key]&&i[t[3].key])continue}let o=t.wasRequested();for(let e=a.overscaledZ-1;e>=n;--e){const n=a.scaledTo(e);if(r[n.key])break;if(r[n.key]=!0,t=this.getTile(n),!t&&o&&(t=this._addTile(n)),t){const e=t.hasData();if((o||e)&&(i[n.key]=n),o=t.wasRequested(),e)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let i,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(t),i)break;r=t}for(const t of e)this._loadedParentTiles[t]=i}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const i=e;return e||(e=new jh(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e.uses++,this._tiles[t.key]=e,i||this._source.fire(new rt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),i))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,e,i){const r=[],n=this.transform;if(!n)return r;const a=i?n.getCameraQueryGeometry(t):t,o=t.map((t=>n.pointCoordinate(t,this.terrain))),l=a.map((t=>n.pointCoordinate(t,this.terrain))),c=this.getIds();let u=1/0,h=1/0,p=-1/0,d=-1/0;for(const t of l)u=Math.min(u,t.x),h=Math.min(h,t.y),p=Math.max(p,t.x),d=Math.max(d,t.y);for(let t=0;t<c.length;t++){const i=this._tiles[c[t]];if(i.holdingForFade())continue;const a=i.tileID,f=Math.pow(2,n.zoom-i.tileID.overscaledZ),m=e*i.queryPadding*da/i.tileSize/f,g=[a.getTilePoint(new xh(u,h)),a.getTilePoint(new xh(p,d))];if(g[0].x-m<da&&g[0].y-m<da&&g[1].x+m>=0&&g[1].y+m>=0){const t=o.map((t=>a.getTilePoint(t))),e=l.map((t=>a.getTilePoint(t)));r.push({tile:i,tileID:a,queryGeometry:t,cameraQueryGeometry:e,scale:f})}}return r}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(Lu(this._source.type)){const t=F.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)}removeFeatureState(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,i){const r=this._tiles[t];r&&r.setDependencies(e,i)}reloadTilesForDependencies(t,e){for(const i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(i,"reloading");this._cache.filter((i=>!i.hasDependency(t,e)))}}function Iu(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Lu(t){return"raster"===t||"image"===t||"video"===t}Hh.maxOverzooming=10,Hh.maxUnderzooming=3;const Ou="mapboxgl_preloaded_worker_pool";class Yh{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Yh.workerCount;)this.workers.push(new Worker(z.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ou]}numActive(){return Object.keys(this.active).length}}const Fu=Math.floor(F.hardwareConcurrency/2);let ju;function Nu(){return ju||(ju=new Yh),ju}Yh.workerCount=I(globalThis)?Math.max(Math.min(Fu,3),1):1;class eu{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=h(t,0,1);let e=1,i=this._distances[e];const r=t*this.paddedLength+this.padding;for(;i<r&&e<this._distances.length;)i=this._distances[++e];const n=e-1,a=this._distances[n],o=i-a,l=o>0?(r-a)/o:0;return this.points[n].mult(1-l).add(this.points[e].mult(l))}}function Bu(t,e){let i=!0;return"always"===t||"never"!==t&&"never"!==e||(i=!1),i}class ru{constructor(t,e,i){const r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}insertCircle(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)}_insertBoxCell(t,e,i,r,n,a){this.boxCells[n].push(a)}_insertCircleCell(t,e,i,r,n,a){this.circleCells[n].push(a)}_query(t,e,i,r,n,a,o){if(i<0||t>this.width||r<0||e>this.height)return[];const l=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(n)return[{key:null,x1:t,y1:e,x2:i,y2:r}];for(let t=0;t<this.boxKeys.length;t++)l.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],r=this.circles[3*t+2];l.push({key:this.circleKeys[t],x1:e-r,y1:i-r,x2:e+r,y2:i+r})}}else this._forEachCell(t,e,i,r,this._queryCell,l,{hitTest:n,overlapMode:a,seenUids:{box:{},circle:{}}},o);return l}query(t,e,i,r){return this._query(t,e,i,r,!1,null)}hitTest(t,e,i,r,n,a){return this._query(t,e,i,r,!0,n,a).length>0}hitTestCircle(t,e,i,r,n){const a=t-i,o=t+i,l=e-i,c=e+i;if(o<0||a>this.width||c<0||l>this.height)return!1;const u=[];return this._forEachCell(a,l,o,c,this._queryCellCircle,u,{hitTest:!0,overlapMode:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},n),u.length>0}_queryCell(t,e,i,r,n,a,o,l){const{seenUids:c,hitTest:u,overlapMode:h}=o,p=this.boxCells[n];if(null!==p){const n=this.bboxes;for(const o of p)if(!c.box[o]){c.box[o]=!0;const p=4*o,d=this.boxKeys[o];if(t<=n[p+2]&&e<=n[p+3]&&i>=n[p+0]&&r>=n[p+1]&&(!l||l(d))&&(!u||!Bu(h,d.overlapMode))&&(a.push({key:d,x1:n[p],y1:n[p+1],x2:n[p+2],y2:n[p+3]}),u))return!0}}const d=this.circleCells[n];if(null!==d){const n=this.circles;for(const o of d)if(!c.circle[o]){c.circle[o]=!0;const p=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(n[p],n[p+1],n[p+2],t,e,i,r)&&(!l||l(d))&&(!u||!Bu(h,d.overlapMode))){const t=n[p],e=n[p+1],i=n[p+2];if(a.push({key:d,x1:t-i,y1:e-i,x2:t+i,y2:e+i}),u)return!0}}}return!1}_queryCellCircle(t,e,i,r,n,a,o,l){const{circle:c,seenUids:u,overlapMode:h}=o,p=this.boxCells[n];if(null!==p){const t=this.bboxes;for(const e of p)if(!u.box[e]){u.box[e]=!0;const i=4*e,r=this.boxKeys[e];if(this._circleAndRectCollide(c.x,c.y,c.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!l||l(r))&&!Bu(h,r.overlapMode))return a.push(!0),!0}}const d=this.circleCells[n];if(null!==d){const t=this.circles;for(const e of d)if(!u.circle[e]){u.circle[e]=!0;const i=3*e,r=this.circleKeys[e];if(this._circlesCollide(t[i],t[i+1],t[i+2],c.x,c.y,c.radius)&&(!l||l(r))&&!Bu(h,r.overlapMode))return a.push(!0),!0}}}_forEachCell(t,e,i,r,n,a,o,l){const c=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),h=this._convertToXCellCoord(i),p=this._convertToYCellCoord(r);for(let d=c;d<=h;d++)for(let c=u;c<=p;c++)if(n.call(this,t,e,i,r,this.xCellCount*c+d,a,o,l))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,r,n,a){const o=r-t,l=n-e,c=i+a;return c*c>o*o+l*l}_circleAndRectCollide(t,e,i,r,n,a,o){const l=(a-r)/2,c=Math.abs(t-(r+l));if(c>l+i)return!1;const u=(o-n)/2,h=Math.abs(e-(n+u));if(h>u+i)return!1;if(c<=l||h<=u)return!0;const p=c-l,d=h-u;return p*p+d*d<=i*i}}function Vu(t,e,i,r,n){const a=Na();return e?(qa(a,a,[1/n,1/n,1]),i||Za(a,a,r.angle)):Ua(a,r.labelPlaneMatrix,t),a}function Uu(t,e,i,r,n){if(e){const e=function(t){var e=new ja(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}(t);return qa(e,e,[n,n,1]),i||Za(e,e,-r.angle),e}return r.glCoordMatrix}function qu(t,e,i){let r;i?(r=[t.x,t.y,i(t.x,t.y),1],Ka(r,r,e)):(r=[t.x,t.y,0,1],fh(r,r,e));const a=r[3];return{point:new n(r[0]/a,r[1]/a),signedDistanceFromCamera:a}}function Zu(t,e){return.5+t/e*.5}function Gu(t,e){const i=t[0]/t[3],r=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&r>=-e[1]&&r<=e[1]}function $u(t,e,i,r,a,o,l,c,u,h){const p=r?t.textSizeData:t.iconSizeData,d=Ec(p,i.transform.zoom),f=[256/i.width*2+1,256/i.height*2+1],m=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;m.clear();const g=t.lineVertexArray,y=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,_=i.transform.width/i.transform.height;let v=!1;for(let r=0;r<y.length;r++){const x=y.get(r);if(x.hidden||x.writingMode===bc.vertical&&!v){dh(x.numGlyphs,m);continue}let b;if(v=!1,h?(b=[x.anchorX,x.anchorY,h(x.anchorX,x.anchorY),1],Ka(b,b,e)):(b=[x.anchorX,x.anchorY,0,1],fh(b,b,e)),!Gu(b,f)){dh(x.numGlyphs,m);continue}const w=Zu(i.transform.cameraToCenterDistance,b[3]),C=Tc(p,d,x),S=l?C/w:C*w,M=new n(x.anchorX,x.anchorY),T=qu(M,a,h).point,E={projections:{},offsets:{}},A=Ju(x,S,!1,c,e,a,o,t.glyphOffsetArray,g,m,T,M,E,_,u,h);v=A.useVertical,(A.notEnoughRoom||v||A.needsFlipping&&Ju(x,S,!0,c,e,a,o,t.glyphOffsetArray,g,m,T,M,E,_,u,h).notEnoughRoom)&&dh(x.numGlyphs,m)}r?t.text.dynamicLayoutVertexBuffer.updateData(m):t.icon.dynamicLayoutVertexBuffer.updateData(m)}function Xu(t,e,i,r,n,a,o,l,c,u,h,p,d){const f=l.glyphStartIndex+l.numGlyphs,m=l.lineStartIndex,g=l.lineStartIndex+l.lineLength,y=e.getoffsetX(l.glyphStartIndex),_=e.getoffsetX(f-1),v=ch(t*y,i,r,n,a,o,l.segment,m,g,c,u,h,p,d);if(!v)return null;const x=ch(t*_,i,r,n,a,o,l.segment,m,g,c,u,h,p,d);return x?{first:v,last:x}:null}function Yu(t,e,i,r){return t===bc.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*r?{useVertical:!0}:(t===bc.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function Ju(t,e,i,r,a,o,l,c,u,h,p,d,f,m,g,y){const _=e/24,v=t.lineOffsetX*_,x=t.lineOffsetY*_;let b;if(t.numGlyphs>1){const e=t.glyphStartIndex+t.numGlyphs,n=t.lineStartIndex,a=t.lineStartIndex+t.lineLength,h=Xu(_,c,v,x,i,p,d,t,u,o,f,g,y);if(!h)return{notEnoughRoom:!0};const w=qu(h.first.point,l,y).point,C=qu(h.last.point,l,y).point;if(r&&!i){const e=Yu(t.writingMode,w,C,m);if(e)return e}b=[h.first];for(let r=t.glyphStartIndex+1;r<e-1;r++)b.push(ch(_*c.getoffsetX(r),v,x,i,p,d,t.segment,n,a,u,o,f,g,y));b.push(h.last)}else{if(r&&!i){const e=qu(d,a,y).point,i=t.lineStartIndex+t.segment+1,r=new n(u.getx(i),u.gety(i)),o=qu(r,a,y),l=o.signedDistanceFromCamera>0?o.point:Qu(d,r,e,1,a,y),c=Yu(t.writingMode,e,l,m);if(c)return c}const e=ch(_*c.getoffsetX(t.glyphStartIndex),v,x,i,p,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,f,g,y);if(!e)return{notEnoughRoom:!0};b=[e]}for(const t of b)kc(h,t.point,t.angle);return{}}function Qu(t,e,i,r,n,a){const o=qu(t.add(t.sub(e)._unit()),n,a).point,l=i.sub(o);return i.add(l._mult(r/l.mag()))}function th(t,e){const{projectionCache:i,lineVertexArray:r,labelPlaneMatrix:a,tileAnchorPoint:o,distanceFromAnchor:l,getElevation:c,previousVertex:u,direction:h,absOffsetX:p}=e;if(i.projections[t])return i.projections[t];const d=new n(r.getx(t),r.gety(t)),f=qu(d,a,c);if(f.signedDistanceFromCamera>0)return i.projections[t]=f.point,f.point;const m=t-h;return Qu(0===l?o:new n(r.getx(m),r.gety(m)),d,u,p-l+1,a,c)}function eh(t,e,i){return t._unit()._perp()._mult(e*i)}function sh(t,e,i,r,a,o,l,c){const{projectionCache:u,direction:h}=c;if(u.offsets[t])return u.offsets[t];const p=i.add(e);if(t+h<r||t+h>=a)return u.offsets[t]=p,p;const d=th(t+h,c),f=eh(d.sub(i),l,h),m=i.add(f),g=d.add(f);return u.offsets[t]=function(t,e,i,r){const a=e.y-t.y,o=e.x-t.x,l=r.y-i.y,c=r.x-i.x,u=l*o-c*a;if(0===u)return null;const h=(c*(t.y-i.y)-l*(t.x-i.x))/u;return new n(t.x+h*o,t.y+h*a)}(o,p,m,g)||p,u.offsets[t]}function ch(t,e,i,r,n,a,o,l,c,u,h,p,d,f){const m=r?t-e:t+e;let g=m>0?1:-1,y=0;r&&(g*=-1,y=Math.PI),g<0&&(y+=Math.PI);let _,v,x=g>0?l+o:l+o+1,b=n,w=n,C=0,S=0;const M=Math.abs(m),T=[];let E;for(;C+S<=M;){if(x+=g,x<l||x>=c)return null;C+=S,w=b,v=_;const t={projectionCache:p,lineVertexArray:u,labelPlaneMatrix:h,tileAnchorPoint:a,distanceFromAnchor:C,getElevation:f,previousVertex:w,direction:g,absOffsetX:M};if(b=th(x,t),0===i)T.push(w),E=b.sub(w);else{let e;const r=b.sub(w);e=0===r.mag()?eh(th(x+g,t).sub(b),i,g):eh(r,i,g),v||(v=w.add(e)),_=sh(x,e,b,l,c,v,i,t),T.push(v),E=_.sub(v)}S=E.mag()}const A=E._mult((M-C)/S)._add(v||w),I=y+Math.atan2(b.y-w.y,b.x-w.x);return T.push(A),{point:A,angle:d?I:0,path:T}}const hh=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function dh(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(hh,3*t)}}function fh(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t[3]=i[3]*r+i[7]*n+i[15],t}const mh=100;class wu{constructor(t,e=new ru(t.width+200,t.height+200,25),i=new ru(t.width+200,t.height+200,25)){this.transform=t,this.grid=e,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+mh,this.screenBottomBoundary=t.height+mh,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,i,r,n,a){const o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY,a),l=i*o.perspectiveRatio,c=t.x1*l+o.point.x,u=t.y1*l+o.point.y,h=t.x2*l+o.point.x,p=t.y2*l+o.point.y;return!this.isInsideGrid(c,u,h,p)||"always"!==e&&this.grid.hitTest(c,u,h,p,e,n)||o.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[c,u,h,p],offscreen:this.isOffscreen(c,u,h,p)}}placeCollisionCircles(t,e,i,r,a,o,l,c,u,h,p,d,f,m){const g=[],y=new n(e.anchorX,e.anchorY),_=qu(y,o,m),v=Zu(this.transform.cameraToCenterDistance,_.signedDistanceFromCamera),x=(h?a/v:a*v)/24,b=qu(y,l,m).point,w=Xu(x,r,e.lineOffsetX*x,e.lineOffsetY*x,!1,b,y,e,i,l,{projections:{},offsets:{}},!1,m);let C=!1,S=!1,M=!0;if(w){const e=.5*d*v+f,i=new n(-100,-100),r=new n(this.screenRightBoundary,this.screenBottomBoundary),a=new eu,o=w.first,l=w.last;let h=[];for(let t=o.path.length-1;t>=1;t--)h.push(o.path[t]);for(let t=1;t<l.path.length;t++)h.push(l.path[t]);const y=2.5*e;if(c){const t=h.map((t=>qu(t,c,m)));h=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let _=[];if(h.length>0){const t=h[0].clone(),e=h[0].clone();for(let i=1;i<h.length;i++)t.x=Math.min(t.x,h[i].x),t.y=Math.min(t.y,h[i].y),e.x=Math.max(e.x,h[i].x),e.y=Math.max(e.y,h[i].y);_=t.x>=i.x&&e.x<=r.x&&t.y>=i.y&&e.y<=r.y?[h]:e.x<i.x||t.x>r.x||e.y<i.y||t.y>r.y?[]:function(t,e,i,r,a){const o=[];for(let l=0;l<t.length;l++){const c=t[l];let u;for(let t=0;t<c.length-1;t++){let l=c[t],h=c[t+1];l.x<e&&h.x<e||(l.x<e?l=new n(e,l.y+(e-l.x)/(h.x-l.x)*(h.y-l.y))._round():h.x<e&&(h=new n(e,l.y+(e-l.x)/(h.x-l.x)*(h.y-l.y))._round()),l.y<i&&h.y<i||(l.y<i?l=new n(l.x+(i-l.y)/(h.y-l.y)*(h.x-l.x),i)._round():h.y<i&&(h=new n(l.x+(i-l.y)/(h.y-l.y)*(h.x-l.x),i)._round()),l.x>=r&&h.x>=r||(l.x>=r?l=new n(r,l.y+(r-l.x)/(h.x-l.x)*(h.y-l.y))._round():h.x>=r&&(h=new n(r,l.y+(r-l.x)/(h.x-l.x)*(h.y-l.y))._round()),l.y>=a&&h.y>=a||(l.y>=a?l=new n(l.x+(a-l.y)/(h.y-l.y)*(h.x-l.x),a)._round():h.y>=a&&(h=new n(l.x+(a-l.y)/(h.y-l.y)*(h.x-l.x),a)._round()),u&&l.equals(u[u.length-1])||(u=[l],o.push(u)),u.push(h)))))}}return o}([h],i.x,i.y,r.x,r.y)}for(const i of _){a.reset(i,.25*e);let r=0;r=a.length<=.5*e?1:Math.ceil(a.paddedLength/y)+1;for(let i=0;i<r;i++){const n=i/Math.max(r-1,1),o=a.lerp(n),l=o.x+mh,c=o.y+mh;g.push(l,c,e,0);const h=l-e,d=c-e,f=l+e,m=c+e;if(M=M&&this.isOffscreen(h,d,f,m),S=S||this.isInsideGrid(h,d,f,m),"always"!==t&&this.grid.hitTestCircle(l,c,e,t,p)&&(C=!0,!u))return{circles:[],offscreen:!1,collisionDetected:C}}}}return{circles:!u&&C||!S||v<this.perspectiveRatioCutoff?[]:g,offscreen:M,collisionDetected:C}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const e=[];let i=1/0,r=1/0,a=-1/0,o=-1/0;for(const l of t){const t=new n(l.x+mh,l.y+mh);i=Math.min(i,t.x),r=Math.min(r,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y),e.push(t)}const l=this.grid.query(i,r,a,o).concat(this.ignoredGrid.query(i,r,a,o)),c={},u={};for(const t of l){const i=t.key;void 0===c[i.bucketInstanceId]&&(c[i.bucketInstanceId]={}),c[i.bucketInstanceId][i.featureIndex]||xa(e,[new n(t.x1,t.y1),new n(t.x2,t.y1),new n(t.x2,t.y2),new n(t.x1,t.y2)])&&(c[i.bucketInstanceId][i.featureIndex]=!0,void 0===u[i.bucketInstanceId]&&(u[i.bucketInstanceId]=[]),u[i.bucketInstanceId].push(i.featureIndex))}return u}insertCollisionBox(t,e,i,r,n,a){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,i,r,n,a){const o=i?this.ignoredGrid:this.grid,l={bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e};for(let e=0;e<t.length;e+=4)o.insertCircle(l,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(t,e,i,r){let a;return r?(a=[e,i,r(e,i),1],Ka(a,a,t)):(a=[e,i,0,1],fh(a,a,t)),{point:new n((a[0]/a[3]+1)/2*this.transform.width+mh,(-a[1]/a[3]+1)/2*this.transform.height+mh),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}}isOffscreen(t,e,i,r){return i<mh||t>=this.screenRightBoundary||r<mh||e>this.screenBottomBoundary}isInsideGrid(t,e,i,r){return i>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const t=Ba([]);return Ha(t,t,[-100,-100,0]),t}}class Tu extends n{constructor(t,e,i,r){super(t,e),this.angle=i,void 0!==r&&(this.segment=r)}clone(){return new Tu(this.x,this.y,this.angle,this.segment)}}Hr("Anchor",Tu);const gh=7,yh=Number.POSITIVE_INFINITY;function _h(t,e){return e[1]!==yh?function(t,e,i){let r=0,n=0;switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":n=i-gh;break;case"bottom-right":case"bottom-left":case"bottom":n=-i+gh}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,n]}(t,e[0],e[1]):function(t,e){let i=0,r=0;e<0&&(e=0);const n=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":r=n-gh;break;case"bottom-right":case"bottom-left":r=-n+gh;break;case"bottom":r=-e+gh;break;case"top":r=e-gh}switch(t){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=e;break;case"right":i=-e}return[i,r]}(t,e[0])}function Sh(t,e,i){return e*(da/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}class zu{constructor(t,e,i,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class Cu{constructor(t,e,i,r,n){this.text=new zu(t?t.text:null,e,i,n),this.icon=new zu(t?t.icon:null,e,r,n)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mu{constructor(t,e,i){this.text=t,this.icon=e,this.skipFade=i}}class ku{constructor(){this.invProjMatrix=Na(),this.viewportMatrix=Na(),this.circles=[]}}class Pu{constructor(t,e,i,r,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=n}}class Du{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Th(t,e,i,r,a){const{horizontalAlign:o,verticalAlign:l}=wc(t),c=-(o-.5)*e,u=-(l-.5)*i,h=_h(t,r);return new n(c+h[0]*a,u+h[1]*a)}function Oh(t,e,i,r,a,o){const{x1:l,x2:c,y1:u,y2:h,anchorPointX:p,anchorPointY:d}=t,f=new n(e,i);return r&&f._rotate(a?o:-o),{x1:l+f.x,y1:u+f.y,x2:c+f.x,y2:h+f.y,anchorPointX:p,anchorPointY:d}}class Ru{constructor(t,e,i,r,n){this.transform=t.clone(),this.terrain=e,this.collisionIndex=new wu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Du(r),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,e,i,r){const n=i.getBucket(e),a=i.latestFeatureIndex;if(!n||!a||e.id!==n.layerIds[0])return;const o=i.collisionBoxArray,l=n.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/da,h=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),f=Sh(i,1,this.transform.zoom),m=Vu(h,p,d,this.transform,f);let g=null;if(p){const t=Uu(h,p,d,this.transform,f);g=Ua([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[n.bucketInstanceId]=new Pu(n.bucketInstanceId,a,n.sourceLayerIndex,n.index,i.tileID);const y={bucket:n,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:Ec(n.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(n.sourceID)};if(r)for(const e of n.sortKeyRanges){const{sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n}=e;t.push({sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n,parameters:y})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:n.symbolInstances.length,parameters:y})}attemptAnchorPlacement(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g){const y=[p.textOffset0,p.textOffset1],_=Th(t,i,r,y,n),v=this.collisionIndex.placeCollisionBox(Oh(e,_.x,_.y,a,o,this.transform.angle),h,l,c,u.predicate,g);if((!m||0!==this.collisionIndex.placeCollisionBox(Oh(m,_.x,_.y,a,o,this.transform.angle),h,l,c,u.predicate,g).box.length)&&v.box.length>0){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(e=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:y,width:i,height:r,anchor:t,textBoxScale:n,prevAnchor:e},this.markUsedJustification(d,t,p,f),d.allowVerticalPlacement&&(this.markUsedOrientation(d,f,p),this.placedOrientations[p.crossTileID]=f),{shift:_,placedGlyphBoxes:v}}}placeLayerBucketPart(t,e,i){const{bucket:r,layout:n,posMatrix:a,textLabelPlaneMatrix:o,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:u,collisionBoxArray:h,partiallyEvaluatedTextSize:p,collisionGroup:d}=t.parameters,f=n.get("text-optional"),m=n.get("icon-optional"),g=Ac(n,"text-overlap","text-allow-overlap"),y="always"===g,_=Ac(n,"icon-overlap","icon-allow-overlap"),v="always"===_,x="map"===n.get("text-rotation-alignment"),b="map"===n.get("text-pitch-alignment"),w="none"!==n.get("icon-text-fit"),C="viewport-y"===n.get("symbol-z-order"),M=y&&(v||!r.hasIconData()||m),T=v&&(y||!r.hasTextData()||f);!r.collisionArrays&&h&&r.deserializeCollisionBoxes(h);const E=this.retainedQueryData[r.bucketInstanceId].tileID,A=this.terrain?(t,e)=>this.terrain.getElevation(E,t,e):null,I=(t,h)=>{if(e[t.crossTileID])return;if(u)return void(this.placements[t.crossTileID]=new Mu(!1,!1,!1));let v=!1,C=!1,E=!0,I=null,P={box:null,offscreen:null},O={box:null,offscreen:null},k=null,D=null,F=null,z=0,j=0,N=0;h.textFeatureIndex?z=h.textFeatureIndex:t.useRuntimeCollisionCircles&&(z=t.featureIndex),h.verticalTextFeatureIndex&&(j=h.verticalTextFeatureIndex);const B=h.textBox;if(B){const e=e=>{let i=bc.horizontal;if(r.allowVerticalPlacement&&!e&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,i=e,this.markUsedOrientation(r,i,t))}return i},i=(e,i)=>{if(r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&h.verticalTextBox){for(const t of r.writingModes)if(t===bc.vertical?(P=i(),O=P):P=e(),P&&P.box&&P.box.length)break}else P=e()};if(n.get("text-variable-anchor")){let o=n.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[t.crossTileID]){const e=this.prevPlacement.variableOffsets[t.crossTileID];o.indexOf(e.anchor)>0&&(o=o.filter((t=>t!==e.anchor)),o.unshift(e.anchor))}const l=(e,i,n)=>{const l=e.x2-e.x1,u=e.y2-e.y1,h=t.textBoxScale,p=w&&"never"===_?i:null;let f={box:[],offscreen:!1};const m="never"!==g?2*o.length:o.length;for(let i=0;i<m;++i){const m=this.attemptAnchorPlacement(o[i%o.length],e,l,u,h,x,b,c,a,d,i>=o.length?g:"never",t,r,n,p,A);if(m&&(f=m.placedGlyphBoxes,f&&f.box&&f.box.length)){v=!0,I=m.shift;break}}return f};i((()=>l(B,h.iconBox,bc.horizontal)),(()=>{const e=h.verticalTextBox;return r.allowVerticalPlacement&&!(P&&P.box&&P.box.length)&&t.numVerticalGlyphVertices>0&&e?l(e,h.verticalIconBox,bc.vertical):{box:null,offscreen:null}})),P&&(v=P.box,E=P.offscreen);const u=e(P&&P.box);if(!v&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(r,e.anchor,t,u))}}else{const n=(e,i)=>{const n=this.collisionIndex.placeCollisionBox(e,g,c,a,d.predicate,A);return n&&n.box&&n.box.length&&(this.markUsedOrientation(r,i,t),this.placedOrientations[t.crossTileID]=i),n};i((()=>n(B,bc.horizontal)),(()=>{const e=h.verticalTextBox;return r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&e?n(e,bc.vertical):{box:null,offscreen:null}})),e(P&&P.box&&P.box.length)}}if(k=P,v=k&&k.box&&k.box.length>0,E=k&&k.offscreen,t.useRuntimeCollisionCircles){const e=r.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),c=Tc(r.textSizeData,p,e),u=n.get("text-padding");D=this.collisionIndex.placeCollisionCircles(g,e,r.lineVertexArray,r.glyphOffsetArray,c,a,o,l,i,b,d.predicate,t.collisionCircleDiameter,u,A),D.circles.length&&D.collisionDetected&&!i&&S("Collisions detected, but collision boxes are not shown"),v=y||D.circles.length>0&&!D.collisionDetected,E=E&&D.offscreen}if(h.iconFeatureIndex&&(N=h.iconFeatureIndex),h.iconBox){const t=t=>{const e=w&&I?Oh(t,I.x,I.y,x,b,this.transform.angle):t;return this.collisionIndex.placeCollisionBox(e,_,c,a,d.predicate,A)};O&&O.box&&O.box.length&&h.verticalIconBox?(F=t(h.verticalIconBox),C=F.box.length>0):(F=t(h.iconBox),C=F.box.length>0),E=E&&F.offscreen}const V=f||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,U=m||0===t.numIconVertices;if(V||U?U?V||(C=C&&v):v=C&&v:C=v=C&&v,v&&k&&k.box&&this.collisionIndex.insertCollisionBox(k.box,g,n.get("text-ignore-placement"),r.bucketInstanceId,O&&O.box&&j?j:z,d.ID),C&&F&&this.collisionIndex.insertCollisionBox(F.box,_,n.get("icon-ignore-placement"),r.bucketInstanceId,N,d.ID),D&&(v&&this.collisionIndex.insertCollisionCircles(D.circles,g,n.get("text-ignore-placement"),r.bucketInstanceId,z,d.ID),i)){const t=r.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new ku);for(let t=0;t<D.circles.length;t+=4)e.circles.push(D.circles[t+0]),e.circles.push(D.circles[t+1]),e.circles.push(D.circles[t+2]),e.circles.push(D.collisionDetected?1:0)}if(0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===r.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new Mu(v||M,C||T,E||r.justReloaded),e[t.crossTileID]=!0};if(C){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=r.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];I(r.symbolInstances.get(i),r.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)I(r.symbolInstances.get(e),r.collisionArrays[e]);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[r.bucketInstanceId];Va(t.invProjMatrix,a),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(t,e,i,r){let n;n=r===bc.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[function(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}(e)];const a=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const e of a)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=n>=0&&e!==n?0:i.crossTileID)}markUsedOrientation(t,e,i){const r=e===bc.horizontal||e===bc.horizontalOnly?e:0,n=e===bc.vertical?e:0,a=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const e of a)t.text.placedSymbolArray.get(e).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=n)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},a=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],a=n[t];a?(this.opacities[t]=new Cu(a,r,e.text,e.icon),i=i||e.text!==a.text.placed||e.icon!==a.icon.placed):(this.opacities[t]=new Cu(null,r,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const t in n){const e=n[t];if(!this.opacities[t]){const n=new Cu(e,r,!1,!1);n.isHidden()||(this.opacities[t]=n,i=i||e.text.placed||e.icon.placed)}}for(const t in a)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=a[t]);for(const t in o)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=o[t]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const i={};for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i,r.collisionBoxArray)}}updateBucketOpacities(t,e,i){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const r=t.layers[0].layout,a=new Cu(null,0,!1,!1,!0),o=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=r.get("text-variable-anchor"),u="map"===r.get("text-rotation-alignment"),h="map"===r.get("text-pitch-alignment"),p="none"!==r.get("icon-text-fit"),d=new Cu(null,0,o&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(o||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);const f=(t,e,i)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(i);t.hasVisibleVertices=t.hasVisibleVertices||i!==Xh};for(let i=0;i<t.symbolInstances.length;i++){const r=t.symbolInstances.get(i),{numHorizontalGlyphVertices:o,numVerticalGlyphVertices:l,crossTileID:m}=r;let g=this.opacities[m];e[m]?g=a:g||(g=d,this.opacities[m]=g),e[m]=!0;const y=r.numIconVertices>0,_=this.placedOrientations[r.crossTileID],v=_===bc.vertical,x=_===bc.horizontal||_===bc.horizontalOnly;if(o>0||l>0){const e=Wh(g.text);f(t.text,o,v?Xh:e),f(t.text,l,x?Xh:e);const i=g.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=i||v?1:0)})),r.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=i||x?1:0);const n=this.variableOffsets[r.crossTileID];n&&this.markUsedJustification(t,n.anchor,r,_);const a=this.placedOrientations[r.crossTileID];a&&(this.markUsedJustification(t,"left",r,a),this.markUsedOrientation(t,a,r))}if(y){const e=Wh(g.icon),i=!(p&&r.verticalPlacedIconSymbolIndex&&v);r.placedIconSymbolIndex>=0&&(f(t.icon,r.numIconVertices,i?e:Xh),t.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=g.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,r.numVerticalIconVertices,i?Xh:e),t.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const e=t.collisionArrays[i];if(e){let i=new n(0,0);if(e.textBox||e.verticalTextBox){let r=!0;if(c){const t=this.variableOffsets[m];t?(i=Th(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),u&&i._rotate(h?this.transform.angle:-this.transform.angle)):r=!1}e.textBox&&kh(t.textCollisionBox.collisionVertexArray,g.text.placed,!r||v,i.x,i.y),e.verticalTextBox&&kh(t.textCollisionBox.collisionVertexArray,g.text.placed,!r||x,i.x,i.y)}const r=Boolean(!x&&e.verticalIconBox);e.iconBox&&kh(t.iconCollisionBox.collisionVertexArray,g.icon.placed,r,p?i.x:0,p?i.y:0),e.verticalIconBox&&kh(t.iconCollisionBox.collisionVertexArray,g.icon.placed,!r,p?i.x:0,p?i.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0}}function kh(t,e,i,r,n){t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0)}const Fh=Math.pow(2,25),zh=Math.pow(2,24),Rh=Math.pow(2,17),Nh=Math.pow(2,16),Bh=Math.pow(2,9),qh=Math.pow(2,8),$h=Math.pow(2,1);function Wh(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*Fh+e*zh+i*Rh+e*Nh+i*Bh+e*qh+i*$h+e}const Xh=0;class Hu{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,i,r,n){const a=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(a,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,n())return!0;return!1}}class Wu{constructor(t,e,i,r,n,a,o,l){this.placement=new Ru(t,e,a,o,l),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(t,e,i){const r=F.now(),n=()=>!this._forceFullPlacement&&F.now()-r>2;for(;this._currentPlacementIndex>=0;){const r=e[t[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===r.type&&(!r.minzoom||r.minzoom<=a)&&(!r.maxzoom||r.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new Hu(r)),this._inProgressLayer.continuePlacement(i[r.source],this.placement,this._showCollisionBoxes,r,n))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Kh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ku{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,i]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=i>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const n=Kh[15&i];if(!n)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new Ku(o,a,n,t)}constructor(t,e=64,i=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const n=Kh.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,o=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-o%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${i}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+l,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+l),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+l,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=e,i}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Jh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,i,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:a,nodeSize:o}=this,l=[0,n.length-1,0],c=[];for(;l.length;){const u=l.pop()||0,h=l.pop()||0,p=l.pop()||0;if(h-p<=o){for(let o=p;o<=h;o++){const l=a[2*o],u=a[2*o+1];l>=t&&l<=i&&u>=e&&u<=r&&c.push(n[o])}continue}const d=p+h>>1,f=a[2*d],m=a[2*d+1];f>=t&&f<=i&&m>=e&&m<=r&&c.push(n[d]),(0===u?t<=f:e<=m)&&(l.push(p),l.push(d-1),l.push(1-u)),(0===u?i>=f:r>=m)&&(l.push(d+1),l.push(h),l.push(1-u))}return c}within(t,e,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:n,nodeSize:a}=this,o=[0,r.length-1,0],l=[],c=i*i;for(;o.length;){const u=o.pop()||0,h=o.pop()||0,p=o.pop()||0;if(h-p<=a){for(let i=p;i<=h;i++)ip(n[2*i],n[2*i+1],t,e)<=c&&l.push(r[i]);continue}const d=p+h>>1,f=n[2*d],m=n[2*d+1];ip(f,m,t,e)<=c&&l.push(r[d]),(0===u?t-i<=f:e-i<=m)&&(o.push(p),o.push(d-1),o.push(1-u)),(0===u?t+i>=f:e+i>=m)&&(o.push(d+1),o.push(h),o.push(1-u))}return l}}function Jh(t,e,i,r,n,a){if(n-r<=i)return;const o=r+n>>1;Qh(t,e,o,r,n,a),Jh(t,e,i,r,o-1,1-a),Jh(t,e,i,o+1,n,1-a)}function Qh(t,e,i,r,n,a){for(;n>r;){if(n-r>600){const o=n-r+1,l=i-r+1,c=Math.log(o),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(o-u)/o)*(l-o/2<0?-1:1);Qh(t,e,i,Math.max(r,Math.floor(i-l*u/o+h)),Math.min(n,Math.floor(i+(o-l)*u/o+h)),a)}const o=e[2*i+a];let l=r,c=n;for(tp(t,e,r,i),e[2*n+a]>o&&tp(t,e,r,n);l<c;){for(tp(t,e,l,c),l++,c--;e[2*l+a]<o;)l++;for(;e[2*c+a]>o;)c--}e[2*r+a]===o?tp(t,e,r,c):(c++,tp(t,e,c,n)),c<=i&&(r=c+1),i<=c&&(n=c-1)}}function tp(t,e,i,r){ep(t,i,r),ep(e,2*i,2*r),ep(e,2*i+1,2*r+1)}function ep(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function ip(t,e,i,r){const n=t-i,a=e-r;return n*n+a*a}const op=512/da/2;class rp{constructor(t,e,i){this.tileID=t,this.bucketInstanceId=i,this._symbolsByKey={};const r=new Map;for(let t=0;t<e.length;t++){const i=e.get(t),n=i.key,a=r.get(n);a?a.push(i):r.set(n,[i])}for(const[t,e]of r){const i={positions:e.map((t=>({x:Math.floor(t.anchorX*op),y:Math.floor(t.anchorY*op)}))),crossTileIDs:e.map((t=>t.crossTileID))};if(i.positions.length>128){const t=new Ku(i.positions.length,16,Uint16Array);for(const{x:e,y:r}of i.positions)t.add(e,r);t.finish(),delete i.positions,i.index=t}this._symbolsByKey[t]=i}}getScaledCoordinates(t,e){const{x:i,y:r,z:n}=this.tileID.canonical,{x:a,y:o,z:l}=e.canonical,c=op/Math.pow(2,l-n),u=(o*da+t.anchorY)*c,h=r*da*op;return{x:Math.floor((a*da+t.anchorX)*c-i*da*op),y:Math.floor(u-h)}}findMatches(t,e,i){const r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let n=0;n<t.length;n++){const a=t.get(n);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const l=this.getScaledCoordinates(a,e);if(o.index){const t=o.index.range(l.x-r,l.y-r,l.x+r,l.y+r).sort();for(const e of t){const t=o.crossTileIDs[e];if(!i[t]){i[t]=!0,a.crossTileID=t;break}}}else if(o.positions)for(let t=0;t<o.positions.length;t++){const e=o.positions[t],n=o.crossTileIDs[t];if(Math.abs(e.x-l.x)<=r&&Math.abs(e.y-l.y)<=r&&!i[n]){i[n]=!0,a.crossTileID=n;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class sp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class np{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],r={};for(const t in i){const n=i[t];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),r[n.tileID.key]=n}this.indexes[t]=r}this.lng=t}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const r=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in n){const a=n[i];a.tileID.isChildOf(t)&&a.findMatches(e.symbolInstances,t,r)}else{const a=n[t.scaledTo(Number(i)).key];a&&a.findMatches(e.symbolInstances,t,r)}}for(let t=0;t<e.symbolInstances.length;t++){const n=e.symbolInstances.get(t);n.crossTileID||(n.crossTileID=i.generate(),r[n.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new rp(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i of e.getCrossTileIDsLists())for(const e of i)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const r=this.indexes[i];for(const n in r)t[r[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[n]),delete r[n],e=!0)}return e}}class ap{constructor(){this.layerIndexes={},this.crossTileIDs=new sp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,i){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new np);let n=!1;const a={};r.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(i.tileID,e,this.crossTileIDs)&&(n=!0),a[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(n=!0),n}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const lp=(t,e)=>Br(t,e&&e.filter((t=>"source.canvas"!==t.identifier))),cp=m(pt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),hp=m(pt,["setCenter","setZoom","setBearing","setPitch"]),pp=function(){const t={},e=ot.$version;for(const i in ot.$root){const r=ot.$root[i];if(r.required){let n=null;n="version"===i?e:"array"===r.type?[]:{},null!=n&&(t[i]=n)}}return t}();class up extends nt{constructor(t,e={}){super(),this.map=t,this.dispatcher=new lh(Nu(),this,t._getMapId()),this.imageManager=new Jc,this.imageManager.setEventedParent(this),this.glyphManager=new ih(t._requestManager,e.localIdeographFontFamily),this.lineAtlas=new ah(256,512),this.crossTileSymbolIndex=new ap,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new Gr,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",j());const i=this;this._rtlTextPluginCallback=up.registerForPluginStateChange((t=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,e)=>{if(jn(t),e&&e.every((t=>t)))for(const t in i.sourceCaches){const e=i.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||i.sourceCaches[t].reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const i=e.getSource();if(i&&i.vectorLayerIds)for(const t in this._layers){const e=this._layers[t];e.source===i.id&&this._validateLayer(e)}}))}loadURL(t,e={},i){this.fire(new rt("dataloading",{dataType:"style"})),e.validate="boolean"!=typeof e.validate||e.validate;const r=this.map._requestManager.transformRequest(t,J.Style);this._request=U(r,((t,r)=>{this._request=null,t?this.fire(new st(t)):r&&this._load(r,e,i)}))}loadJSON(t,e={},i){this.fire(new rt("dataloading",{dataType:"style"})),this._request=F.frame((()=>{this._request=null,e.validate=!1!==e.validate,this._load(t,e,i)}))}loadEmpty(){this.fire(new rt("dataloading",{dataType:"style"})),this._load(pp,{validate:!1})}_load(t,e,i){const r=e.transformStyle?e.transformStyle(i,t):t;if(!e.validate||!lp(this,zr(r))){this._loaded=!0,this.stylesheet=r;for(const t in r.sources)this.addSource(t,r.sources[t],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs),this._createLayers(),this.light=new nh(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new rt("data",{dataType:"style"})),this.fire(new rt("style.load"))}}_createLayers(){const t=ut(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map((t=>t.id)),this._layers={},this._serializedLayers=null;for(const e of t){const t=Wc(e);t.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=t}}_loadSprite(t,e=!1,i=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(t,e,i,r){const n=Xc(t),a=n.length,o=i>1?"@2x":"",l={},c={},u={};for(const{id:t,url:i}of n){const n=e.transformRequest(e.normalizeSpriteURL(i,o,".json"),J.SpriteJSON),h=`${t}_${n.url}`;l[h]=U(n,((e,i)=>{delete l[h],c[t]=i,Yc(r,c,u,e,a)}));const p=e.transformRequest(e.normalizeSpriteURL(i,o,".png"),J.SpriteImage),d=`${t}_${p.url}`;l[d]=tt.getImage(p,((e,i)=>{delete l[d],u[t]=i,Yc(r,c,u,e,a)}))}return{cancel(){for(const t of Object.values(l))t.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),((t,r)=>{if(this._spriteRequest=null,t)this.fire(new st(t));else if(r)for(const t in r){this._spritesImagesIds[t]=[];const i=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in r))):[];for(const t of i)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const i in r[t]){const n="default"===t?i:`${t}:${i}`;this._spritesImagesIds[t].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,r[t][i],!1):this.imageManager.addImage(n,r[t][i]),e&&(this._changedImages[n]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),e&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new rt("data",{dataType:"style"})),i&&i(t)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new rt("data",{dataType:"style"}))}_validateLayer(t){const e=this.sourceCaches[t.source];if(!e)return;const i=t.sourceLayer;if(!i)return;const r=e.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new st(new Error(`Source layer "${i}" does not exist on source "${r.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const e=this._serializedAllLayers();if(!t||0===t.length)return Object.values(e);const i=[];for(const r of t)e[r]&&i.push(e[r]);return i}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const i of e){const e=this._layers[i];"custom"!==e.type&&(t[i]=e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const e=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const e in this._updatedPaintProps)this._layers[e].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const i={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];i[t]=e.used,e.used=!1}for(const e of this._order){const i=this._layers[e];i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}for(const t in i){const e=this.sourceCaches[t];i[t]!==e.used&&e.fire(new rt("data",{sourceDataType:"visibility",dataType:"source",sourceId:t}))}this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new rt("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,e={}){this._checkLoaded();const i=this.serialize();if(t=e.transformStyle?e.transformStyle(i,t):t,lp(this,zr(t)))return!1;(t=w(t)).layers=ut(t.layers);const r=function(t,e){if(!t)return[{command:pt.setStyle,args:[e]}];let i=[];try{if(!ht(t.version,e.version))return[{command:pt.setStyle,args:[e]}];ht(t.center,e.center)||i.push({command:pt.setCenter,args:[e.center]}),ht(t.zoom,e.zoom)||i.push({command:pt.setZoom,args:[e.zoom]}),ht(t.bearing,e.bearing)||i.push({command:pt.setBearing,args:[e.bearing]}),ht(t.pitch,e.pitch)||i.push({command:pt.setPitch,args:[e.pitch]}),ht(t.sprite,e.sprite)||i.push({command:pt.setSprite,args:[e.sprite]}),ht(t.glyphs,e.glyphs)||i.push({command:pt.setGlyphs,args:[e.glyphs]}),ht(t.transition,e.transition)||i.push({command:pt.setTransition,args:[e.transition]}),ht(t.light,e.light)||i.push({command:pt.setLight,args:[e.light]});const r={},n=[];!function(t,e,i,r){let n;for(n in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)||ft(n,i,r));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(t,n)?ht(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&gt(t,e,n)?i.push({command:pt.setGeoJSONSourceData,args:[n,e[n].data]}):mt(n,e,i,r)):dt(n,e,i))}(t.sources,e.sources,n,r);const a=[];t.layers&&t.layers.forEach((t=>{r[t.source]?i.push({command:pt.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(n),function(t,e,i){e=e||[];const r=(t=t||[]).map(_t),n=e.map(_t),a=t.reduce(vt,{}),o=e.reduce(vt,{}),l=r.slice(),c=Object.create(null);let u,h,p,d,f,m,g;for(u=0,h=0;u<r.length;u++)p=r[u],Object.prototype.hasOwnProperty.call(o,p)?h++:(i.push({command:pt.removeLayer,args:[p]}),l.splice(l.indexOf(p,h),1));for(u=0,h=0;u<n.length;u++)p=n[n.length-1-u],l[l.length-1-u]!==p&&(Object.prototype.hasOwnProperty.call(a,p)?(i.push({command:pt.removeLayer,args:[p]}),l.splice(l.lastIndexOf(p,l.length-h),1)):h++,m=l[l.length-u],i.push({command:pt.addLayer,args:[o[p],m]}),l.splice(l.length-u,0,p),c[p]=!0);for(u=0;u<n.length;u++)if(p=n[u],d=a[p],f=o[p],!c[p]&&!ht(d,f))if(ht(d.source,f.source)&&ht(d["source-layer"],f["source-layer"])&&ht(d.type,f.type)){for(g in yt(d.layout,f.layout,i,p,null,pt.setLayoutProperty),yt(d.paint,f.paint,i,p,null,pt.setPaintProperty),ht(d.filter,f.filter)||i.push({command:pt.setFilter,args:[p,f.filter]}),ht(d.minzoom,f.minzoom)&&ht(d.maxzoom,f.maxzoom)||i.push({command:pt.setLayerZoomRange,args:[p,f.minzoom,f.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?yt(d[g],f[g],i,p,g.slice(6),pt.setPaintProperty):ht(d[g],f[g])||i.push({command:pt.setLayerProperty,args:[p,g,f[g]]}));for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&!Object.prototype.hasOwnProperty.call(d,g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?yt(d[g],f[g],i,p,g.slice(6),pt.setPaintProperty):ht(d[g],f[g])||i.push({command:pt.setLayerProperty,args:[p,g,f[g]]}))}else i.push({command:pt.removeLayer,args:[p]}),m=l[l.lastIndexOf(p)+1],i.push({command:pt.addLayer,args:[f,m]})}(a,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:pt.setStyle,args:[e]}]}return i}(i,t).filter((t=>!(t.command in hp)));if(0===r.length)return!1;const n=r.filter((t=>!(t.command in cp)));if(n.length>0)throw new Error(`Unimplemented: ${n.map((t=>t.command)).join(", ")}.`);for(const t of r)"setTransition"!==t.command&&this[t.command].apply(this,t.args);return this.stylesheet=t,!0}addImage(t,e){if(this.getImage(t))return this.fire(new st(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,e),this._afterImageUpdated(t)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new st(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new rt("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,e,i={}){if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!e.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(e).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(e.type)>=0&&this._validate(zr.source,`sources.${t}`,e,null,i))return;this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);const r=this.sourceCaches[t]=new Hh(t,e,this.dispatcher);r.style=this,r.setEventedParent(this,(()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:t}))),r.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const e in this._layers)if(this._layers[e].source===t)return this.fire(new st(new Error(`Source "${t}" cannot be removed while layer "${e}" is using it.`)));const e=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],e.fire(new rt("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),e.setEventedParent(null),e.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const i=this.sourceCaches[t].getSource();if("geojson"!==i.type)throw new Error(`geojsonSource.type is ${i.type}, which is !== 'geojson`);i.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,e,i={}){this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new st(new Error(`Layer "${r}" already exists on this map.`)));let n;if("custom"===t.type){if(lp(this,function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e}(t)))return;n=Wc(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=f(t=w(t),{source:r})),this._validate(zr.layer,`layers.${r}`,t,{arrayIndex:-1},i))return;n=Wc(t),this._validateLayer(n),n.setEventedParent(this,{layer:{id:r}})}const a=e?this._order.indexOf(e):this._order.length;if(e&&-1===a)this.fire(new st(new Error(`Cannot add layer "${r}" before non-existing layer "${e}".`)));else{if(this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=n,this._removedLayers[r]&&n.source&&"custom"!==n.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==n.type?this._updatedSources[n.source]="clear":(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause())}this._updateLayer(n),n.onAdd&&n.onAdd(this.map)}}moveLayer(t,e){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new st(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===e)return;const i=this._order.indexOf(t);this._order.splice(i,1);const r=e?this._order.indexOf(e):this._order.length;e&&-1===r?this.fire(new st(new Error(`Cannot move layer "${t}" before non-existing layer "${e}".`))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const e=this._layers[t];if(!e)return void this.fire(new st(new Error(`Cannot remove non-existing layer "${t}".`)));e.setEventedParent(null);const i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,e,i){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===e&&r.maxzoom===i||(null!=e&&(r.minzoom=e),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new st(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,e,i={}){this._checkLoaded();const r=this.getLayer(t);if(r){if(!b(r.filter,e))return null==e?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(zr.filter,`layers.${r.id}.filter`,e,null,i)||(r.filter=w(e),this._updateLayer(r)))}else this.fire(new st(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return w(this.getLayer(t).filter)}setLayoutProperty(t,e,i,r={}){this._checkLoaded();const n=this.getLayer(t);n?b(n.getLayoutProperty(e),i)||(n.setLayoutProperty(e,i,r),this._updateLayer(n)):this.fire(new st(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,e){const i=this.getLayer(t);if(i)return i.getLayoutProperty(e);this.fire(new st(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,e,i,r={}){this._checkLoaded();const n=this.getLayer(t);n?b(n.getPaintProperty(e),i)||(n.setPaintProperty(e,i,r)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new st(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(t,e){this._checkLoaded();const i=t.source,r=t.sourceLayer,n=this.sourceCaches[i];if(void 0===n)return void this.fire(new st(new Error(`The source '${i}' does not exist in the map's style.`)));const a=n.getSource().type;"geojson"===a&&r?this.fire(new st(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||r?(void 0===t.id&&this.fire(new st(new Error("The feature id parameter must be provided."))),n.setFeatureState(r,t.id,e)):this.fire(new st(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,e){this._checkLoaded();const i=t.source,r=this.sourceCaches[i];if(void 0===r)return void this.fire(new st(new Error(`The source '${i}' does not exist in the map's style.`)));const n=r.getSource().type,a="vector"===n?t.sourceLayer:void 0;"vector"!==n||a?e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new st(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(a,t.id,e):this.fire(new st(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const e=t.source,i=t.sourceLayer,r=this.sourceCaches[e];if(void 0!==r)return"vector"!==r.getSource().type||i?(void 0===t.id&&this.fire(new st(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,t.id)):void this.fire(new st(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new st(new Error(`The source '${e}' does not exist in the map's style.`)))}getTransition(){return f({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t=v(this.sourceCaches,(t=>t.serialize())),e=this._serializeByIds(this._order),i=this.stylesheet;return x({version:i.version,name:i.name,metadata:i.metadata,light:i.light,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,sources:t,layers:e},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},r=[];for(let n=this._order.length-1;n>=0;n--){const a=this._order[n];if(e(a)){i[a]=n;for(const e of t){const t=e[a];if(t)for(const e of t)r.push(e)}}}r.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const n=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(e(o))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(i[e.layer.id]<a)break;n.push(e),r.pop()}else for(const e of t){const t=e[o];if(t)for(const e of t)n.push(e.feature)}}return n}queryRenderedFeatures(t,e,i){e&&e.filter&&this._validate(zr.filter,"queryRenderedFeatures.filter",e.filter,null,e);const r={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new st(new Error("parameters.layers must be an Array."))),[];for(const t of e.layers){const e=this._layers[t];if(!e)return this.fire(new st(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];r[e.source]=!0}}const n=[];e.availableImages=this._availableImages;const a=this._serializedAllLayers();for(const o in this.sourceCaches)e.layers&&!r[o]||n.push(xu(this.sourceCaches[o],this._layers,a,t,e,i));return this.placement&&n.push(function(t,e,i,r,n,a,o){const l={},c=a.queryRenderedSymbols(r),u=[];for(const t of Object.keys(c).map(Number))u.push(o[t]);u.sort(bu);for(const i of u){const r=i.featureIndex.lookupSymbolFeatures(c[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(const t in r){const e=l[t]=l[t]||[],n=r[t];n.sort(((t,e)=>{const r=i.featureSortOrder;if(r){const i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(const t of n)e.push(t)}}for(const e in l)l[e].forEach((r=>{const n=r.feature,a=i[t[e].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=a}));return l}(this._layers,a,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(n)}querySourceFeatures(t,e){e&&e.filter&&this._validate(zr.filter,"querySourceFeatures.filter",e.filter,null,e);const i=this.sourceCaches[t];return i?function(t,e){const i=t.getRenderableIds().map((e=>t.getTileByID(e))),r=[],n={};for(let t=0;t<i.length;t++){const a=i[t],o=a.tileID.canonical.key;n[o]||(n[o]=!0,a.querySourceFeatures(r,e))}return r}(i,e):[]}addSourceType(t,e,i){return up.getSourceType(t)?i(new Error(`A source type called "${t}" already exists.`)):(up.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(t,e={}){this._checkLoaded();const i=this.light.getLight();let r=!1;for(const e in t)if(!b(t[e],i[e])){r=!0;break}if(!r)return;const n={now:F.now(),transition:f({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(n)}_validate(t,e,i,r,n={}){return(!n||!1!==n.validate)&&lp(this,t.call(zr,f({key:e,style:this.serialize(),value:i,styleSpec:ot},r)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Bn.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,e,i,r,n=!1){let a=!1,o=!1;const l={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!l[i.source]){const t=this.sourceCaches[i.source];l[i.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(i,l[i.source],t.center.lng);a=a||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((n=n||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(F.now(),t.zoom))&&(this.pauseablePlacement=new Wu(t,this.map.terrain,this._order,n,e,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(F.now()),o=!0),a&&this.pauseablePlacement.placement.setStale()),o||a)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(F.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();const r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)}getGlyphs(t,e,i){this.glyphManager.getGlyphs(e.stacks,i);const r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,[""])}getResource(t,e,i){return V(e,i)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,e={}){this._checkLoaded(),t&&this._validate(zr.glyphs,"glyphs",t,null,e)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,e,i={},r){this._checkLoaded();const n=[{id:t,url:e}],a=[...Xc(this.stylesheet.sprite),...n];this._validate(zr.sprite,"sprite",a,null,i)||(this.stylesheet.sprite=a,this._loadSprite(n,!0,r))}removeSprite(t){this._checkLoaded();const e=Xc(this.stylesheet.sprite);if(e.find((e=>e.id===t))){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;e.splice(e.findIndex((e=>e.id===t)),1),this.stylesheet.sprite=e.length>0?e:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new rt("data",{dataType:"style"}))}else this.fire(new st(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Xc(this.stylesheet.sprite)}setSprite(t,e={},i){this._checkLoaded(),t&&this._validate(zr.sprite,"sprite",t,null,e)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,i):(this._unloadSprite(),i&&i(null)))}}up.getSourceType=function(t){return _u[t]},up.setSourceType=function(t,e){_u[t]=e},up.registerForPluginStateChange=function(t){return t({pluginStatus:Fn,pluginURL:Rn}),Bn.on("pluginStateChange",t),t};var dp=ts([{name:"a_pos",type:"Int16",components:2}]),fp="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const mp={prelude:gp("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:gp("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:gp("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:gp("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:gp("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gp("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:gp("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:gp("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:gp("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:gp("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:gp("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:gp("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:gp("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:gp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:gp("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:gp("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:gp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gp("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:gp("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:gp("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:gp("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:gp("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:gp("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:gp("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:gp("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:gp("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:gp("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",fp),terrainDepth:gp("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",fp),terrainCoords:gp("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",fp)};function gp(t,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,l={};return{fragmentSource:t=t.replace(i,((t,e,i,r,n)=>(l[n]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = u_${n};\n#endif\n`))),vertexSource:e=e.replace(i,((t,e,i,r,n)=>{const a="float"===r?"vec2":"vec4",o=n.match(/color/)?"color":a;return l[n]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = unpack_mix_${o}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = unpack_mix_${o}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`})),staticAttributes:r,staticUniforms:o}}class _p{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,i,r,n,a,o,l,c){this.context=t;let u=this.boundPaintVertexBuffers.length!==r.length;for(let t=0;!u&&t<r.length;t++)this.boundPaintVertexBuffers[t]!==r[t]&&(u=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==i||u||this.boundIndexBuffer!==n||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==l||this.boundDynamicVertexBuffer3!==c?this.freshBind(e,i,r,n,a,o,l,c):(t.bindVertexArray.set(this.vao),o&&o.bind(),n&&n.dynamicDraw&&n.bind(),l&&l.bind(),c&&c.bind())}freshBind(t,e,i,r,n,a,o,l){const c=t.numAttributes,u=this.context,h=u.gl;this.vao&&this.destroy(),this.vao=u.createVertexArray(),u.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=l,e.enableAttributes(h,t);for(const e of i)e.enableAttributes(h,t);a&&a.enableAttributes(h,t),o&&o.enableAttributes(h,t),l&&l.enableAttributes(h,t),e.bind(),e.setVertexAttribPointers(h,t,n);for(const e of i)e.bind(),e.setVertexAttribPointers(h,t,n);a&&(a.bind(),a.setVertexAttribPointers(h,t,n)),r&&r.bind(),o&&(o.bind(),o.setVertexAttribPointers(h,t,n)),l&&(l.bind(),l.setVertexAttribPointers(h,t,n)),u.currentNumAttributes=c}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function vp(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const r=t[i].split(" ");e.push(r.pop())}return e}class yp{constructor(t,e,i,r,n,a,o){const l=t.gl;this.program=l.createProgram();const c=vp(i.staticAttributes),u=r?r.getBinderAttributes():[],h=c.concat(u),p=mp.prelude.staticUniforms?vp(mp.prelude.staticUniforms):[],d=i.staticUniforms?vp(i.staticUniforms):[],f=r?r.getBinderUniforms():[],m=p.concat(d).concat(f),g=[];for(const t of m)g.indexOf(t)<0&&g.push(t);const y=r?r.defines():[];a&&y.push("#define OVERDRAW_INSPECTOR;"),o&&y.push("#define TERRAIN3D;");const _=y.concat(mp.prelude.fragmentSource,i.fragmentSource).join("\n"),v=y.concat(mp.prelude.vertexSource,i.vertexSource).join("\n"),x=l.createShader(l.FRAGMENT_SHADER);if(l.isContextLost())return void(this.failedToCreate=!0);l.shaderSource(x,_),l.compileShader(x),l.attachShader(this.program,x);const b=l.createShader(l.VERTEX_SHADER);if(l.isContextLost())return void(this.failedToCreate=!0);l.shaderSource(b,v),l.compileShader(b),l.attachShader(this.program,b),this.attributes={};const w={};this.numAttributes=h.length;for(let t=0;t<this.numAttributes;t++)h[t]&&(l.bindAttribLocation(this.program,t,h[t]),this.attributes[h[t]]=t);l.linkProgram(this.program),l.deleteShader(b),l.deleteShader(x);for(let t=0;t<g.length;t++){const e=g[t];if(e&&!w[e]){const t=l.getUniformLocation(this.program,e);t&&(w[e]=t)}}this.fixedUniforms=n(t,w),this.terrainUniforms=((t,e)=>({u_depth:new Wn(t,e.u_depth),u_terrain:new Wn(t,e.u_terrain),u_terrain_dim:new Xn(t,e.u_terrain_dim),u_terrain_matrix:new ea(t,e.u_terrain_matrix),u_terrain_unpack:new Jn(t,e.u_terrain_unpack),u_terrain_exaggeration:new Xn(t,e.u_terrain_exaggeration)}))(t,w),this.binderUniforms=r?r.getUniforms(t,w):[]}draw(t,e,i,r,n,a,o,l,c,u,h,p,d,f,m,g,y,_){const v=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(r),t.setColorMode(n),t.setCullFace(a),l){t.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,l.depthTexture),t.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,l.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(l[t])}for(const t in this.fixedUniforms)this.fixedUniforms[t].set(o[t]);m&&m.setUniforms(t,this.binderUniforms,d,{zoom:f});let x=0;switch(e){case v.LINES:x=2;break;case v.TRIANGLES:x=3;break;case v.LINE_STRIP:x=1}for(const i of p.get()){const r=i.vaos||(i.vaos={});(r[c]||(r[c]=new _p)).bind(t,this,u,m?m.getPaintVertexBuffers():[],h,i.vertexOffset,g,y,_),v.drawElements(e,i.primitiveLength*x,v.UNSIGNED_SHORT,i.primitiveOffset*x*2)}}}function xp(t,e,i){const r=1/Sh(i,1,e.transform.tileZoom),n=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(i.tileID.canonical.x+i.tileID.wrap*n),l=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,l>>16],u_pixel_coord_lower:[65535&o,65535&l]}}const bp=(t,e,i,r)=>{const n=e.style.light,a=n.properties.get("position"),o=[a.x,a.y,a.z],l=function(){var t=new ja(9);return ja!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();"viewport"===n.properties.get("anchor")&&function(t,e){var i=Math.sin(e),r=Math.cos(e);t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1}(l,-e.transform.angle),function(t,e,i){var r=e[0],n=e[1],a=e[2];t[0]=r*i[0]+n*i[3]+a*i[6],t[1]=r*i[1]+n*i[4]+a*i[7],t[2]=r*i[2]+n*i[5]+a*i[8]}(o,o,l);const c=n.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},wp=(t,e,i,r,n,a,o)=>f(bp(t,e,i,r),xp(a,e,o),{u_height_factor:-Math.pow(2,n.overscaledZ)/o.tileSize/8}),Cp=t=>({u_matrix:t}),Sp=(t,e,i,r)=>f(Cp(t),xp(i,e,r)),Mp=(t,e)=>({u_matrix:t,u_world:e}),Tp=(t,e,i,r,n)=>f(Sp(t,e,i,r),{u_world:n}),Ep=(t,e,i,r)=>{const n=t.transform;let a,o;if("map"===r.paint.get("circle-pitch-alignment")){const t=Sh(i,1,n.zoom);a=!0,o=[t,t]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},Ap=(t,e,i)=>{const r=Sh(i,1,e.zoom),n=Math.pow(2,e.zoom-i.tileID.overscaledZ),a=i.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*n),e.pixelsToGLUnits[1]/(r*n)],u_overscale_factor:a}},Ip=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),Lp=t=>({u_matrix:t}),Pp=(t,e,i,r)=>({u_matrix:t,u_extrude_scale:Sh(e,1,i),u_intensity:r});function Op(t,e){const i=Math.pow(2,e.canonical.z),r=e.canonical.y;return[new xh(0,r/i).toLngLat().lat,new xh(0,(r+1)/i).toLngLat().lat]}const kp=(t,e,i,r)=>{const n=t.transform;return{u_matrix:jp(t,e,i,r),u_ratio:1/Sh(e,1,n.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},Dp=(t,e,i,r,n)=>f(kp(t,e,i,n),{u_image:0,u_image_height:r}),Fp=(t,e,i,r,n)=>{const a=t.transform,o=Rp(e,a);return{u_matrix:jp(t,e,i,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Sh(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},zp=(t,e,i,r,n,a)=>{const o=t.lineAtlas,l=Rp(e,t.transform),c="round"===i.layout.get("line-cap"),u=o.getDash(r.from,c),h=o.getDash(r.to,c),p=u.width*n.fromScale,d=h.width*n.toScale;return f(kp(t,e,i,a),{u_patternscale_a:[l/p,-u.height/2],u_patternscale_b:[l/d,-h.height/2],u_sdfgamma:o.width/(256*Math.min(p,d)*t.pixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:n.t})};function Rp(t,e){return 1/Sh(t,1,e.tileZoom)}function jp(t,e,i,r){return t.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Np=(t,e,i,r,n)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(o=n.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=n.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Bp(n.paint.get("raster-hue-rotate"))};var a,o};function Bp(t){t*=Math.PI/180;const e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Vp=(t,e,i,r,n,a,o,l,c,u)=>{const h=n.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:h.cameraToCenterDistance,u_pitch:h.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:h.width/h.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},Up=(t,e,i,r,n,a,o,l,c,u,h)=>{const p=n.transform;return f(Vp(t,e,i,r,n,a,o,l,c,u),{u_gamma_scale:r?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:n.pixelRatio,u_is_halo:+h})},Hp=(t,e,i,r,n,a,o,l,c,u)=>f(Up(t,e,i,r,n,a,o,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1}),qp=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),Zp=(t,e,i,r,n,a)=>f(function(t,e,i,r){const n=i.imageManager.getPattern(t.from.toString()),a=i.imageManager.getPattern(t.to.toString()),{width:o,height:l}=i.imageManager.getPixelSize(),c=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,i.transform.tileZoom)/c,h=u*(r.tileID.canonical.x+r.tileID.wrap*c),p=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,l],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/Sh(r,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(r,a,i,n),{u_matrix:t,u_opacity:e}),$p={fillExtrusion:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_lightpos:new Yn(t,e.u_lightpos),u_lightintensity:new Xn(t,e.u_lightintensity),u_lightcolor:new Yn(t,e.u_lightcolor),u_vertical_gradient:new Xn(t,e.u_vertical_gradient),u_opacity:new Xn(t,e.u_opacity)}),fillExtrusionPattern:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_lightpos:new Yn(t,e.u_lightpos),u_lightintensity:new Xn(t,e.u_lightintensity),u_lightcolor:new Yn(t,e.u_lightcolor),u_vertical_gradient:new Xn(t,e.u_vertical_gradient),u_height_factor:new Xn(t,e.u_height_factor),u_image:new Wn(t,e.u_image),u_texsize:new Kn(t,e.u_texsize),u_pixel_coord_upper:new Kn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Kn(t,e.u_pixel_coord_lower),u_scale:new Yn(t,e.u_scale),u_fade:new Xn(t,e.u_fade),u_opacity:new Xn(t,e.u_opacity)}),fill:(t,e)=>({u_matrix:new ea(t,e.u_matrix)}),fillPattern:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_image:new Wn(t,e.u_image),u_texsize:new Kn(t,e.u_texsize),u_pixel_coord_upper:new Kn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Kn(t,e.u_pixel_coord_lower),u_scale:new Yn(t,e.u_scale),u_fade:new Xn(t,e.u_fade)}),fillOutline:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_world:new Kn(t,e.u_world)}),fillOutlinePattern:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_world:new Kn(t,e.u_world),u_image:new Wn(t,e.u_image),u_texsize:new Kn(t,e.u_texsize),u_pixel_coord_upper:new Kn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Kn(t,e.u_pixel_coord_lower),u_scale:new Yn(t,e.u_scale),u_fade:new Xn(t,e.u_fade)}),circle:(t,e)=>({u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_scale_with_map:new Wn(t,e.u_scale_with_map),u_pitch_with_map:new Wn(t,e.u_pitch_with_map),u_extrude_scale:new Kn(t,e.u_extrude_scale),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_matrix:new ea(t,e.u_matrix)}),collisionBox:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new Xn(t,e.u_pixels_to_tile_units),u_extrude_scale:new Kn(t,e.u_extrude_scale),u_overscale_factor:new Xn(t,e.u_overscale_factor)}),collisionCircle:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_inv_matrix:new ea(t,e.u_inv_matrix),u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_viewport_size:new Kn(t,e.u_viewport_size)}),debug:(t,e)=>({u_color:new Qn(t,e.u_color),u_matrix:new ea(t,e.u_matrix),u_overlay:new Wn(t,e.u_overlay),u_overlay_scale:new Xn(t,e.u_overlay_scale)}),clippingMask:(t,e)=>({u_matrix:new ea(t,e.u_matrix)}),heatmap:(t,e)=>({u_extrude_scale:new Xn(t,e.u_extrude_scale),u_intensity:new Xn(t,e.u_intensity),u_matrix:new ea(t,e.u_matrix)}),heatmapTexture:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_world:new Kn(t,e.u_world),u_image:new Wn(t,e.u_image),u_color_ramp:new Wn(t,e.u_color_ramp),u_opacity:new Xn(t,e.u_opacity)}),hillshade:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_image:new Wn(t,e.u_image),u_latrange:new Kn(t,e.u_latrange),u_light:new Kn(t,e.u_light),u_shadow:new Qn(t,e.u_shadow),u_highlight:new Qn(t,e.u_highlight),u_accent:new Qn(t,e.u_accent)}),hillshadePrepare:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_image:new Wn(t,e.u_image),u_dimension:new Kn(t,e.u_dimension),u_zoom:new Xn(t,e.u_zoom),u_unpack:new Jn(t,e.u_unpack)}),line:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_ratio:new Xn(t,e.u_ratio),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_units_to_pixels:new Kn(t,e.u_units_to_pixels)}),lineGradient:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_ratio:new Xn(t,e.u_ratio),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_units_to_pixels:new Kn(t,e.u_units_to_pixels),u_image:new Wn(t,e.u_image),u_image_height:new Xn(t,e.u_image_height)}),linePattern:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_texsize:new Kn(t,e.u_texsize),u_ratio:new Xn(t,e.u_ratio),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_image:new Wn(t,e.u_image),u_units_to_pixels:new Kn(t,e.u_units_to_pixels),u_scale:new Yn(t,e.u_scale),u_fade:new Xn(t,e.u_fade)}),lineSDF:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_ratio:new Xn(t,e.u_ratio),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_units_to_pixels:new Kn(t,e.u_units_to_pixels),u_patternscale_a:new Kn(t,e.u_patternscale_a),u_patternscale_b:new Kn(t,e.u_patternscale_b),u_sdfgamma:new Xn(t,e.u_sdfgamma),u_image:new Wn(t,e.u_image),u_tex_y_a:new Xn(t,e.u_tex_y_a),u_tex_y_b:new Xn(t,e.u_tex_y_b),u_mix:new Xn(t,e.u_mix)}),raster:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_tl_parent:new Kn(t,e.u_tl_parent),u_scale_parent:new Xn(t,e.u_scale_parent),u_buffer_scale:new Xn(t,e.u_buffer_scale),u_fade_t:new Xn(t,e.u_fade_t),u_opacity:new Xn(t,e.u_opacity),u_image0:new Wn(t,e.u_image0),u_image1:new Wn(t,e.u_image1),u_brightness_low:new Xn(t,e.u_brightness_low),u_brightness_high:new Xn(t,e.u_brightness_high),u_saturation_factor:new Xn(t,e.u_saturation_factor),u_contrast_factor:new Xn(t,e.u_contrast_factor),u_spin_weights:new Yn(t,e.u_spin_weights)}),symbolIcon:(t,e)=>({u_is_size_zoom_constant:new Wn(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wn(t,e.u_is_size_feature_constant),u_size_t:new Xn(t,e.u_size_t),u_size:new Xn(t,e.u_size),u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_pitch:new Xn(t,e.u_pitch),u_rotate_symbol:new Wn(t,e.u_rotate_symbol),u_aspect_ratio:new Xn(t,e.u_aspect_ratio),u_fade_change:new Xn(t,e.u_fade_change),u_matrix:new ea(t,e.u_matrix),u_label_plane_matrix:new ea(t,e.u_label_plane_matrix),u_coord_matrix:new ea(t,e.u_coord_matrix),u_is_text:new Wn(t,e.u_is_text),u_pitch_with_map:new Wn(t,e.u_pitch_with_map),u_texsize:new Kn(t,e.u_texsize),u_texture:new Wn(t,e.u_texture)}),symbolSDF:(t,e)=>({u_is_size_zoom_constant:new Wn(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wn(t,e.u_is_size_feature_constant),u_size_t:new Xn(t,e.u_size_t),u_size:new Xn(t,e.u_size),u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_pitch:new Xn(t,e.u_pitch),u_rotate_symbol:new Wn(t,e.u_rotate_symbol),u_aspect_ratio:new Xn(t,e.u_aspect_ratio),u_fade_change:new Xn(t,e.u_fade_change),u_matrix:new ea(t,e.u_matrix),u_label_plane_matrix:new ea(t,e.u_label_plane_matrix),u_coord_matrix:new ea(t,e.u_coord_matrix),u_is_text:new Wn(t,e.u_is_text),u_pitch_with_map:new Wn(t,e.u_pitch_with_map),u_texsize:new Kn(t,e.u_texsize),u_texture:new Wn(t,e.u_texture),u_gamma_scale:new Xn(t,e.u_gamma_scale),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_is_halo:new Wn(t,e.u_is_halo)}),symbolTextAndIcon:(t,e)=>({u_is_size_zoom_constant:new Wn(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Wn(t,e.u_is_size_feature_constant),u_size_t:new Xn(t,e.u_size_t),u_size:new Xn(t,e.u_size),u_camera_to_center_distance:new Xn(t,e.u_camera_to_center_distance),u_pitch:new Xn(t,e.u_pitch),u_rotate_symbol:new Wn(t,e.u_rotate_symbol),u_aspect_ratio:new Xn(t,e.u_aspect_ratio),u_fade_change:new Xn(t,e.u_fade_change),u_matrix:new ea(t,e.u_matrix),u_label_plane_matrix:new ea(t,e.u_label_plane_matrix),u_coord_matrix:new ea(t,e.u_coord_matrix),u_is_text:new Wn(t,e.u_is_text),u_pitch_with_map:new Wn(t,e.u_pitch_with_map),u_texsize:new Kn(t,e.u_texsize),u_texsize_icon:new Kn(t,e.u_texsize_icon),u_texture:new Wn(t,e.u_texture),u_texture_icon:new Wn(t,e.u_texture_icon),u_gamma_scale:new Xn(t,e.u_gamma_scale),u_device_pixel_ratio:new Xn(t,e.u_device_pixel_ratio),u_is_halo:new Wn(t,e.u_is_halo)}),background:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_opacity:new Xn(t,e.u_opacity),u_color:new Qn(t,e.u_color)}),backgroundPattern:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_opacity:new Xn(t,e.u_opacity),u_image:new Wn(t,e.u_image),u_pattern_tl_a:new Kn(t,e.u_pattern_tl_a),u_pattern_br_a:new Kn(t,e.u_pattern_br_a),u_pattern_tl_b:new Kn(t,e.u_pattern_tl_b),u_pattern_br_b:new Kn(t,e.u_pattern_br_b),u_texsize:new Kn(t,e.u_texsize),u_mix:new Xn(t,e.u_mix),u_pattern_size_a:new Kn(t,e.u_pattern_size_a),u_pattern_size_b:new Kn(t,e.u_pattern_size_b),u_scale_a:new Xn(t,e.u_scale_a),u_scale_b:new Xn(t,e.u_scale_b),u_pixel_coord_upper:new Kn(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new Kn(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new Xn(t,e.u_tile_units_to_pixels)}),terrain:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_texture:new Wn(t,e.u_texture),u_ele_delta:new Xn(t,e.u_ele_delta)}),terrainDepth:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_ele_delta:new Xn(t,e.u_ele_delta)}),terrainCoords:(t,e)=>({u_matrix:new ea(t,e.u_matrix),u_texture:new Wn(t,e.u_texture),u_terrain_coords_id:new Xn(t,e.u_terrain_coords_id),u_ele_delta:new Xn(t,e.u_ele_delta)})};class Gp{constructor(t,e,i){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xp={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wp{constructor(t,e,i,r){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const n=t.gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const r=e.attributes[this.attributes[i].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,i){for(let r=0;r<this.attributes.length;r++){const n=this.attributes[r],a=e.attributes[n.name];void 0!==a&&t.vertexAttribPointer(a,n.components,t[Xp[n.type]],!1,this.itemSize,n.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Kp=new WeakMap;function Fd(t){if(Kp.has(t))return Kp.get(t);{const e=t.getParameter(t.VERSION).startsWith("WebGL 2.0");return Kp.set(t,e),e}}class Yp{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Jp extends Yp{getDefault(){return oe.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Qp extends Yp{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class td extends Yp{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class ed extends Yp{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class id extends Yp{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class rd extends Yp{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class sd extends Yp{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class nd extends Yp{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ad extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class od extends Yp{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class ld extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class cd extends Yp{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class hd extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class ud extends Yp{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class pd extends Yp{getDefault(){return oe.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class dd extends Yp{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class md extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class fd extends Yp{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class _d extends Yp{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class gd extends Yp{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class yd extends Yp{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class xd extends Yp{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class vd extends Yp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class bd extends Yp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class wd extends Yp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Td extends Yp{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Sd extends Yp{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Id extends Yp{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const i=this.gl;Fd(i)?i.bindVertexArray(t):null===(e=i.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Ad extends Yp{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ed extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class zd extends Yp{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Cd extends Yp{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class Md extends Cd{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class kd extends Cd{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Pd extends Cd{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Dd{constructor(t,e,i,r,n){this.context=t,this.width=e,this.height=i;const a=t.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new Md(t,o),r)this.depthAttachment=n?new Pd(t,o):new kd(t,o);else if(n)throw new Error("Stencil cannot be setted without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Ld{constructor(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i}}Ld.Replace=[1,0],Ld.disabled=new Ld(Ld.Replace,oe.transparent,[!1,!1,!1,!1]),Ld.unblended=new Ld(Ld.Replace,oe.transparent,[!0,!0,!0,!0]),Ld.alphaBlended=new Ld([1,771],oe.transparent,[!0,!0,!0,!0]);class Bd{constructor(t){var e,i;if(this.gl=t,this.clearColor=new Jp(this),this.clearDepth=new Qp(this),this.clearStencil=new td(this),this.colorMask=new ed(this),this.depthMask=new id(this),this.stencilMask=new rd(this),this.stencilFunc=new sd(this),this.stencilOp=new nd(this),this.stencilTest=new ad(this),this.depthRange=new od(this),this.depthTest=new ld(this),this.depthFunc=new cd(this),this.blend=new hd(this),this.blendFunc=new ud(this),this.blendColor=new pd(this),this.blendEquation=new dd(this),this.cullFace=new md(this),this.cullFaceSide=new fd(this),this.frontFace=new _d(this),this.program=new gd(this),this.activeTexture=new yd(this),this.viewport=new xd(this),this.bindFramebuffer=new vd(this),this.bindRenderbuffer=new bd(this),this.bindTexture=new wd(this),this.bindVertexBuffer=new Td(this),this.bindElementBuffer=new Sd(this),this.bindVertexArray=new Id(this),this.pixelStoreUnpack=new Ad(this),this.pixelStoreUnpackPremultiplyAlpha=new Ed(this),this.pixelStoreUnpackFlipY=new zd(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Fd(t)){this.HALF_FLOAT=t.HALF_FLOAT;const r=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==r?void 0:r.RGBA16F_EXT,this.RGB16F=null!==(i=t.RGB16F)&&void 0!==i?i:null==r?void 0:r.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new Gp(this,t,e)}createVertexBuffer(t,e,i){return new Wp(this,t,e,i)}createRenderbuffer(t,e,i){const r=this.gl,n=r.createRenderbuffer();return this.bindRenderbuffer.set(n),r.renderbufferStorage(r.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),n}createFramebuffer(t,e,i,r){return new Dd(this,t,e,i,r)}clear({color:t,depth:e,stencil:i}){const r=this.gl;let n=0;t&&(n|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(n|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(n|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(n)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){b(t.blendFunction,Ld.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Fd(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return Fd(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Rd{constructor(t,e,i){this.func=t,this.mask=e,this.range=i}}Rd.ReadOnly=!1,Rd.ReadWrite=!0,Rd.disabled=new Rd(519,Rd.ReadOnly,[0,1]);const jd=7680;class Od{constructor(t,e,i,r,n,a){this.test=t,this.ref=e,this.mask=i,this.fail=r,this.depthFail=n,this.pass=a}}Od.disabled=new Od({func:519,mask:0},0,0,jd,jd,jd);class Vd{constructor(t,e,i){this.enable=t,this.mode=e,this.frontFace=i}}let Nd;function Ud(t,e,i,r,n,a,o){const l=t.context,c=l.gl,u=t.useProgram("collisionBox"),h=[];let p=0,d=0;for(let f=0;f<r.length;f++){const m=r[f],g=e.getTile(m),y=g.getBucket(i);if(!y)continue;let _=m.posMatrix;0===n[0]&&0===n[1]||(_=t.translatePosMatrix(m.posMatrix,g,n,a));const v=o?y.textCollisionBox:y.iconCollisionBox,x=y.collisionCircleArray;if(x.length>0){const e=Na(),i=_;$a(e,y.placementInvProjMatrix,t.transform.glCoordMatrix),$a(e,e,y.placementViewportMatrix),h.push({circleArray:x,circleOffset:d,transform:i,invTransform:e,coord:m}),p+=x.length/4,d=p}v&&u.draw(l,c.LINES,Rd.disabled,Od.disabled,t.colorModeForRenderPass(),Vd.disabled,Ap(_,t.transform,g),t.style.map.terrain&&t.style.map.terrain.getTerrainData(m),i.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,t.transform.zoom,null,null,v.collisionVertexBuffer)}if(!o||!h.length)return;const f=t.useProgram("collisionCircle"),m=new In;m.resize(4*p),m._trim();let g=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,r=t.circleArray[i+0],n=t.circleArray[i+1],a=t.circleArray[i+2],o=t.circleArray[i+3];m.emplace(g++,r,n,a,o,0),m.emplace(g++,r,n,a,o,1),m.emplace(g++,r,n,a,o,2),m.emplace(g++,r,n,a,o,3)}(!Nd||Nd.length<2*p)&&(Nd=function(t){const e=2*t,i=new En;i.resize(e),i._trim();for(let t=0;t<e;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(p));const y=l.createIndexBuffer(Nd,!0),_=l.createVertexBuffer(m,Hl.members,!0);for(const e of h){const r={u_matrix:e.transform,u_inv_matrix:e.invTransform,u_camera_to_center_distance:(v=t.transform).cameraToCenterDistance,u_viewport_size:[v.width,v.height]};f.draw(l,c.TRIANGLES,Rd.disabled,Od.disabled,t.colorModeForRenderPass(),Vd.disabled,r,t.style.map.terrain&&t.style.map.terrain.getTerrainData(e.coord),i.id,_,y,Dn.simpleSegment(0,2*e.circleOffset,e.circleArray.length,e.circleArray.length/2),null,t.transform.zoom,null,null,null)}var v;_.destroy(),y.destroy()}Vd.disabled=new Vd(!1,1029,2305),Vd.backCCW=new Vd(!0,1029,2305);const Hd=Ba(new Float32Array(16));function qd(t,e,i,r,a,o){const{horizontalAlign:l,verticalAlign:c}=wc(t),u=-(l-.5)*e,h=-(c-.5)*i,p=_h(t,r);return new n((u/a+p[0])*o,(h/a+p[1])*o)}function Zd(t,e,i,r,a,o,l,c,u,h,p){const d=t.text.placedSymbolArray,f=t.text.dynamicLayoutVertexArray,m=t.icon.dynamicLayoutVertexArray,g={};f.clear();for(let m=0;m<d.length;m++){const y=d.get(m),_=y.hidden||!y.crossTileID||t.allowVerticalPlacement&&!y.placedOrientation?null:r[y.crossTileID];if(_){const r=new n(y.anchorX,y.anchorY),d=qu(r,i?l:o,p),m=Zu(a.cameraToCenterDistance,d.signedDistanceFromCamera);let v=Tc(t.textSizeData,u,y)*m/24;i&&(v*=t.tilePixelRatio/c);const{width:x,height:b,anchor:w,textOffset:C,textBoxScale:S}=_,M=qd(w,x,b,C,S,v),T=i?qu(r.add(M),o,p).point:d.point.add(e?M.rotate(-a.angle):M),E=t.allowVerticalPlacement&&y.placedOrientation===bc.vertical?Math.PI/2:0;for(let t=0;t<y.numGlyphs;t++)kc(f,T,E);h&&y.associatedIconIndex>=0&&(g[y.associatedIconIndex]={shiftedAnchor:T,angle:E})}else dh(y.numGlyphs,f)}if(h){m.clear();const e=t.icon.placedSymbolArray;for(let t=0;t<e.length;t++){const i=e.get(t);if(i.hidden)dh(i.numGlyphs,m);else{const e=g[t];if(e)for(let t=0;t<i.numGlyphs;t++)kc(m,e.shiftedAnchor,e.angle);else dh(i.numGlyphs,m)}}t.icon.dynamicLayoutVertexBuffer.updateData(m)}t.text.dynamicLayoutVertexBuffer.updateData(f)}function Gd(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function $d(t,e,i,r,n,a,o,l,c,u,h,p){const d=t.context,f=d.gl,m=t.transform,g="map"===l,y="map"===c,_="viewport"!==l&&"point"!==i.layout.get("symbol-placement"),v=g&&!y&&!_,x=!i.layout.get("symbol-sort-key").isConstant();let b=!1;const w=t.depthModeForSublayer(0,Rd.ReadOnly),C=i.layout.get("text-variable-anchor"),S=[];for(const l of r){const r=e.getTile(l),c=r.getBucket(i);if(!c)continue;const h=n?c.text:c.icon;if(!h||!h.segments.get().length||!h.hasVisibleVertices)continue;const p=h.programConfigurations.get(i.id),d=n||c.sdfIcons,w=n?c.textSizeData:c.iconSizeData,M=y||0!==m.pitch,T=t.useProgram(Gd(d,n,c),p),E=Ec(w,m.zoom),A=t.style.map.terrain&&t.style.map.terrain.getTerrainData(l);let I,P,O,k,D=[0,0],F=null;if(n)P=r.glyphAtlasTexture,O=f.LINEAR,I=r.glyphAtlasTexture.size,c.iconsInText&&(D=r.imageAtlasTexture.size,F=r.imageAtlasTexture,k=M||t.options.rotating||t.options.zooming||"composite"===w.kind||"camera"===w.kind?f.LINEAR:f.NEAREST);else{const e=1!==i.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;P=r.imageAtlasTexture,O=d||t.options.rotating||t.options.zooming||e||M?f.LINEAR:f.NEAREST,I=r.imageAtlasTexture.size}const z=Sh(r,1,t.transform.zoom),j=Vu(l.posMatrix,y,g,t.transform,z),N=Uu(l.posMatrix,y,g,t.transform,z),B=C&&c.hasTextData(),V="none"!==i.layout.get("icon-text-fit")&&B&&c.hasIconData();if(_){const e=t.style.map.terrain?(e,i)=>t.style.map.terrain.getElevation(l,e,i):null,r="map"===i.layout.get("text-rotation-alignment");$u(c,l.posMatrix,t,n,j,N,y,u,r,e)}const U=t.translatePosMatrix(l.posMatrix,r,a,o),H=_||n&&C||V?Hd:j,q=t.translatePosMatrix(N,r,a,o,!0),Z=d&&0!==i.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1);let G;G=d?c.iconsInText?Hp(w.kind,E,v,y,t,U,H,q,I,D):Up(w.kind,E,v,y,t,U,H,q,n,I,!0):Vp(w.kind,E,v,y,t,U,H,q,n,I);const $={program:T,buffers:h,uniformValues:G,atlasTexture:P,atlasTextureIcon:F,atlasInterpolation:O,atlasInterpolationIcon:k,isSDF:d,hasHalo:Z};if(x&&c.canOverlap){b=!0;const t=h.segments.get();for(const e of t)S.push({segments:new Dn([e]),sortKey:e.sortKey,state:$,terrainData:A})}else S.push({segments:h.segments,sortKey:0,state:$,terrainData:A})}b&&S.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of S){const r=e.state;if(d.activeTexture.set(f.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,f.CLAMP_TO_EDGE),r.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),r.isSDF){const n=r.uniformValues;r.hasHalo&&(n.u_is_halo=1,Wd(r.buffers,e.segments,i,t,r.program,w,h,p,n,e.terrainData)),n.u_is_halo=0}Wd(r.buffers,e.segments,i,t,r.program,w,h,p,r.uniformValues,e.terrainData)}}function Wd(t,e,i,r,n,a,o,l,c,u){const h=r.context;n.draw(h,h.gl.TRIANGLES,a,o,l,Vd.disabled,c,u,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Xd(t,e,i,r,n){if(!i||!r||!r.imageAtlas)return;const a=r.imageAtlas.patternPositions;let o=a[i.to.toString()],l=a[i.from.toString()];if(!o||!l){const t=n.getPaintProperty(e);o=a[t],l=a[t]}o&&l&&t.setConstantPatternPositions(o,l)}function Yd(t,e,i,r,n,a,o){const l=t.context.gl,c="fill-pattern",u=i.paint.get(c),h=u&&u.constantOr(1),p=i.getCrossfadeParameters();let d,f,m,g,y;o?(f=h&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=l.LINES):(f=h?"fillPattern":"fill",d=l.TRIANGLES);const _=u.constantOr(null);for(const u of r){const r=e.getTile(u);if(h&&!r.patternsLoaded())continue;const v=r.getBucket(i);if(!v)continue;const x=v.programConfigurations.get(i.id),b=t.useProgram(f,x),w=t.style.map.terrain&&t.style.map.terrain.getTerrainData(u);h&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),x.updatePaintBuffers(p)),Xd(x,c,_,r,i);const C=w?u:null,S=t.translatePosMatrix(C?C.posMatrix:u.posMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(o){g=v.indexBuffer2,y=v.segments2;const e=[l.drawingBufferWidth,l.drawingBufferHeight];m="fillOutlinePattern"===f&&h?Tp(S,t,p,r,e):Mp(S,e)}else g=v.indexBuffer,y=v.segments,m=h?Sp(S,t,p,r):Cp(S);b.draw(t.context,d,n,t.stencilModeForClipping(u),a,Vd.disabled,m,w,i.id,v.layoutVertexBuffer,g,y,i.paint,t.transform.zoom,x)}}function Kd(t,e,i,r,n,a,o){const l=t.context,c=l.gl,u="fill-extrusion-pattern",h=i.paint.get(u),p=h.constantOr(1),d=i.getCrossfadeParameters(),f=i.paint.get("fill-extrusion-opacity"),m=h.constantOr(null);for(const h of r){const r=e.getTile(h),g=r.getBucket(i);if(!g)continue;const y=t.style.map.terrain&&t.style.map.terrain.getTerrainData(h),_=g.programConfigurations.get(i.id),v=t.useProgram(p?"fillExtrusionPattern":"fillExtrusion",_);p&&(t.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),_.updatePaintBuffers(d)),Xd(_,u,m,r,i);const x=t.translatePosMatrix(h.posMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),b=i.paint.get("fill-extrusion-vertical-gradient"),w=p?wp(x,t,b,f,h,d,r):bp(x,t,b,f);v.draw(l,l.gl.TRIANGLES,n,a,o,Vd.backCCW,w,y,i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,i.paint,t.transform.zoom,_,t.style.map.terrain&&g.centroidVertexBuffer)}}function Jd(t,e,i,r,n,a,o){const l=t.context,c=l.gl,u=i.fbo;if(!u)return;const h=t.useProgram("hillshade"),p=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get()),h.draw(l,c.TRIANGLES,n,a,o,Vd.disabled,((t,e,i,r)=>{const n=i.paint.get("hillshade-shadow-color"),a=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color");let l=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(l-=t.transform.angle);const c=!t.options.moving;return{u_matrix:r?r.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),c),u_image:0,u_latrange:Op(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),l],u_shadow:n,u_highlight:a,u_accent:o}})(t,i,r,p?e:null),p,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function Qd(t,e,i,r,n,a){const o=t.context,l=o.gl,c=e.dem;if(c&&c.data){const u=c.dim,h=c.stride,p=c.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(h),e.demTexture){const t=e.demTexture;t.update(p,{premultiply:!1}),t.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new Kc(o,p,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let d=e.fbo;if(!d){const t=new Kc(o,{width:u,height:u,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),d=e.fbo=o.createFramebuffer(u,u,!0,!1),d.colorAttachment.set(t.texture)}o.bindFramebuffer.set(d.framebuffer),o.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,r,n,a,Vd.disabled,((t,e)=>{const i=e.stride,r=Na();return Ga(r,0,da,-da,0,0,1),Ha(r,r,[0,-da,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:e.getUnpackVector()}})(e.tileID,c),null,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function tf(t,e,i,r,n,a){const o=r.paint.get("raster-fade-duration");if(!a&&o>0){const r=F.now(),a=(r-t.timeAdded)/o,l=e?(r-e.timeAdded)/o:-1,c=i.getSource(),u=n.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!e||Math.abs(e.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),d=p&&t.refreshedUponExpiration?1:h(p?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}const ef=new oe(1,0,0,1),hf=new oe(0,1,0,1),pf=new oe(0,0,1,1),mf=new oe(1,0,1,1),vf=new oe(0,1,1,1);function xf(t,e,i,r){wf(t,0,e+i/2,t.transform.width,i,r)}function bf(t,e,i,r){wf(t,e-i/2,0,i,t.transform.height,r)}function wf(t,e,i,r,n,a){const o=t.context,l=o.gl;l.enable(l.SCISSOR_TEST),l.scissor(e*t.pixelRatio,i*t.pixelRatio,r*t.pixelRatio,n*t.pixelRatio),o.clear({color:a}),l.disable(l.SCISSOR_TEST)}function Sf(t,e,i){const r=t.context,n=r.gl,a=i.posMatrix,o=t.useProgram("debug"),l=Rd.disabled,c=Od.disabled,u=t.colorModeForRenderPass(),h="$debug",p=t.style.map.terrain&&t.style.map.terrain.getTerrainData(i);r.activeTexture.set(n.TEXTURE0);const d=e.getTileByID(i.key).latestRawTileData,f=Math.floor((d&&d.byteLength||0)/1024),m=e.getTile(i).tileSize,g=512/Math.min(m,512)*(i.overscaledZ/t.transform.zoom)*.5;let y=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(y+=` => ${i.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,r=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,i.width,i.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,`${y} ${f}kB`),o.draw(r,n.TRIANGLES,l,c,Ld.alphaBlended,Vd.disabled,Ip(a,oe.transparent,g),null,h,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(r,n.LINE_STRIP,l,c,u,Vd.disabled,Ip(a,oe.red),p,h,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function Tf(t,e,i){const r=t.context,n=r.gl,a=t.colorModeForRenderPass(),o=new Rd(n.LEQUAL,Rd.ReadWrite,t.depthRangeFor3D),l=t.useProgram("terrain"),c=e.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height]);for(const u of i){const i=t.renderToTexture.getTexture(u),h=e.getTerrainData(u.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.texture);const p={u_matrix:t.transform.calculatePosMatrix(u.tileID.toUnwrapped()),u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};l.draw(r,n.TRIANGLES,o,Od.disabled,a,Vd.backCCW,p,h,"terrain",c.vertexBuffer,c.indexBuffer,c.segments)}}const Ef={symbol:function(t,e,i,r,n){if("translucent"!==t.renderPass)return;const a=Od.disabled,o=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,e,i,r,n,a,o){const l=e.transform,c="map"===n,u="map"===a;for(const n of t){const t=r.getTile(n),a=t.getBucket(i);if(!a||!a.text||!a.text.segments.get().length)continue;const h=Ec(a.textSizeData,l.zoom),p=Sh(t,1,e.transform.zoom),d=Vu(n.posMatrix,u,c,e.transform,p),f="none"!==i.layout.get("icon-text-fit")&&a.hasIconData();if(h){const i=Math.pow(2,l.zoom-t.tileID.overscaledZ);Zd(a,c,u,o,l,d,n.posMatrix,i,h,f,e.style.map.terrain?(t,i)=>e.style.map.terrain.getElevation(n,t,i):null)}}}(r,t,i,e,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),n),0!==i.paint.get("icon-opacity").constantOr(1)&&$d(t,e,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,o),0!==i.paint.get("text-opacity").constantOr(1)&&$d(t,e,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(Ud(t,e,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Ud(t,e,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(t,e,i,r){if("translucent"!==t.renderPass)return;const n=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),o=i.paint.get("circle-stroke-opacity"),l=!i.layout.get("circle-sort-key").isConstant();if(0===n.constantOr(1)&&(0===a.constantOr(1)||0===o.constantOr(1)))return;const c=t.context,u=c.gl,h=t.depthModeForSublayer(0,Rd.ReadOnly),p=Od.disabled,d=t.colorModeForRenderPass(),f=[];for(let n=0;n<r.length;n++){const a=r[n],o=e.getTile(a),c=o.getBucket(i);if(!c)continue;const u=c.programConfigurations.get(i.id),h=t.useProgram("circle",u),p=c.layoutVertexBuffer,d=c.indexBuffer,m=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a),g={programConfiguration:u,program:h,layoutVertexBuffer:p,indexBuffer:d,uniformValues:Ep(t,a,o,i),terrainData:m};if(l){const t=c.segments.get();for(const e of t)f.push({segments:new Dn([e]),sortKey:e.sortKey,state:g})}else f.push({segments:c.segments,sortKey:0,state:g})}l&&f.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of f){const{programConfiguration:r,program:n,layoutVertexBuffer:a,indexBuffer:o,uniformValues:l,terrainData:f}=e.state;n.draw(c,u.TRIANGLES,h,p,d,Vd.disabled,l,f,i.id,a,o,e.segments,i.paint,t.transform.zoom,r)}},heatmap:function(t,e,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const n=t.context,a=n.gl,o=Od.disabled,l=new Ld([a.ONE,a.ONE],oe.transparent,[!0,!0,!0,!0]);!function(t,e,i){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let n=i.heatmapFbo;if(n)r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{const a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),n=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),function(t,e,i,r){var n,a;const o=t.gl,l=null!==(n=t.HALF_FLOAT)&&void 0!==n?n:o.UNSIGNED_BYTE,c=null!==(a=t.RGBA16F)&&void 0!==a?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,c,e.width/4,e.height/4,0,o.RGBA,l,null),r.colorAttachment.set(i)}(t,e,a,n)}}(n,t,i),n.clear({color:oe.transparent});for(let c=0;c<r.length;c++){const u=r[c];if(e.hasRenderableParent(u))continue;const h=e.getTile(u),p=h.getBucket(i);if(!p)continue;const d=p.programConfigurations.get(i.id),f=t.useProgram("heatmap",d),{zoom:m}=t.transform;f.draw(n,a.TRIANGLES,Rd.disabled,o,l,Vd.disabled,Pp(u.posMatrix,h,m,i.paint.get("heatmap-intensity")),null,i.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,i.paint,t.transform.zoom,d)}n.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){const i=t.context,r=i.gl,n=e.heatmapFbo;if(!n)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new Kc(i,e.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,Rd.disabled,Od.disabled,t.colorModeForRenderPass(),Vd.disabled,((t,e,i,r)=>{const n=Na();Ga(n,0,t.width,t.height,0,0,1);const a=t.context.gl;return{u_matrix:n,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}})(t,e),null,e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}(t,i))},line:function(t,e,i,r){if("translucent"!==t.renderPass)return;const n=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0===n.constantOr(1)||0===a.constantOr(1))return;const o=t.depthModeForSublayer(0,Rd.ReadOnly),l=t.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),p=u.constantOr(1),d=i.paint.get("line-gradient"),f=i.getCrossfadeParameters(),m=p?"linePattern":c?"lineSDF":d?"lineGradient":"line",g=t.context,y=g.gl;let _=!0;for(const n of r){const r=e.getTile(n);if(p&&!r.patternsLoaded())continue;const a=r.getBucket(i);if(!a)continue;const x=a.programConfigurations.get(i.id),b=t.context.program.get(),w=t.useProgram(m,x),C=_||w.program!==b,S=t.style.map.terrain&&t.style.map.terrain.getTerrainData(n),M=u.constantOr(null);if(M&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[M.to.toString()],i=t.patternPositions[M.from.toString()];e&&i&&x.setConstantPatternPositions(e,i)}const T=S?n:null,E=p?Fp(t,r,i,f,T):c?zp(t,r,i,c,f,T):d?Dp(t,r,i,a.lineClipsArray.length,T):kp(t,r,i,T);if(p)g.activeTexture.set(y.TEXTURE0),r.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),x.updatePaintBuffers(f);else if(c&&(C||t.lineAtlas.dirty))g.activeTexture.set(y.TEXTURE0),t.lineAtlas.bind(g);else if(d){const r=a.gradients[i.id];let o=r.texture;if(i.gradientVersion!==r.version){let l=256;if(i.stepInterpolant){const i=e.getSource().maxzoom,r=n.canonical.z===i?Math.ceil(1<<t.transform.maxZoom-n.canonical.z):1;l=h((v=a.maxLineLength/da*1024*r)<=1?1:Math.pow(2,Math.ceil(Math.log(v)/Math.LN2)),256,g.maxTextureSize)}r.gradient=lo({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new Kc(g,r.gradient,y.RGBA),r.version=i.gradientVersion,o=r.texture}g.activeTexture.set(y.TEXTURE0),o.bind(i.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}w.draw(g,y.TRIANGLES,o,t.stencilModeForClipping(n),l,Vd.disabled,E,S,i.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,i.paint,t.transform.zoom,x,a.layoutVertexBuffer2),_=!1}var v},fill:function(t,e,i,r){const n=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0===a.constantOr(1))return;const o=t.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===n.constantOr(oe.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const n=t.depthModeForSublayer(1,"opaque"===t.renderPass?Rd.ReadWrite:Rd.ReadOnly);Yd(t,e,i,r,n,o,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){const n=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Rd.ReadOnly);Yd(t,e,i,r,n,o,!0)}},"fill-extrusion":function(t,e,i,r){const n=i.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){const a=new Rd(t.context.gl.LEQUAL,Rd.ReadWrite,t.depthRangeFor3D);if(1!==n||i.paint.get("fill-extrusion-pattern").constantOr(1))Kd(t,e,i,r,a,Od.disabled,Ld.disabled),Kd(t,e,i,r,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const n=t.colorModeForRenderPass();Kd(t,e,i,r,a,Od.disabled,n)}}},hillshade:function(t,e,i,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const n=t.context,a=t.depthModeForSublayer(0,Rd.ReadOnly),o=t.colorModeForRenderPass(),[l,c]="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r];for(const r of c){const n=e.getTile(r);void 0!==n.needsHillshadePrepare&&n.needsHillshadePrepare&&"offscreen"===t.renderPass?Qd(t,n,i,a,Od.disabled,o):"translucent"===t.renderPass&&Jd(t,r,n,i,a,l[r.overscaledZ],o)}n.viewport.set([0,0,t.width,t.height])},raster:function(t,e,i,r){if("translucent"!==t.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const n=t.context,a=n.gl,o=e.getSource(),l=t.useProgram("raster"),c=t.colorModeForRenderPass(),[u,h]=o instanceof Ph?[{},r]:t.stencilConfigForOverlap(r),p=h[h.length-1].overscaledZ,d=!t.options.moving;for(const r of h){const h=t.depthModeForSublayer(r.overscaledZ-p,1===i.paint.get("raster-opacity")?Rd.ReadWrite:Rd.ReadOnly,a.LESS),f=e.getTile(r);f.registerFadeDuration(i.paint.get("raster-fade-duration"));const m=e.findLoadedParent(r,0),g=tf(f,m,e,i,t.transform,t.style.map.terrain);let y,_;const v="nearest"===i.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),f.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),m?(m.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,m.tileID.overscaledZ-f.tileID.overscaledZ),_=[f.tileID.canonical.x*y%1,f.tileID.canonical.y*y%1]):f.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r),b=x?r:null,w=b?b.posMatrix:t.transform.calculatePosMatrix(r.toUnwrapped(),d),C=Np(w,_||[0,0],y||1,g,i);o instanceof Ph?l.draw(n,a.TRIANGLES,h,Od.disabled,c,Vd.disabled,C,x,i.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):l.draw(n,a.TRIANGLES,h,u[r.overscaledZ],c,Vd.disabled,C,x,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,i,r){const n=i.paint.get("background-color"),a=i.paint.get("background-opacity");if(0===a)return;const o=t.context,l=o.gl,c=t.transform,u=c.tileSize,h=i.paint.get("background-pattern");if(t.isPatternMissing(h))return;const p=!h&&1===n.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==p)return;const d=Od.disabled,f=t.depthModeForSublayer(0,"opaque"===p?Rd.ReadWrite:Rd.ReadOnly),m=t.colorModeForRenderPass(),g=t.useProgram(h?"backgroundPattern":"background"),y=r||c.coveringTiles({tileSize:u,terrain:t.style.map.terrain});h&&(o.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));const _=i.getCrossfadeParameters();for(const e of y){const c=r?e.posMatrix:t.transform.calculatePosMatrix(e.toUnwrapped()),p=h?Zp(c,a,t,h,{tileID:e,tileSize:u},_):qp(c,a,n),y=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);g.draw(o,l.TRIANGLES,f,d,m,Vd.disabled,p,y,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}},debug:function(t,e,i){for(let r=0;r<i.length;r++)Sf(t,e,i[r])},custom:function(t,e,i){const r=t.context,n=i.implementation;if("offscreen"===t.renderPass){const e=n.prerender;e&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),e.call(n,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(Od.disabled);const e="3d"===n.renderingMode?new Rd(t.context.gl.LEQUAL,Rd.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Rd.ReadOnly);r.setDepthMode(e),n.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}};class um{constructor(t,e){this.context=new Bd(t),this.transform=e,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Na(),renderTime:0},this.setup(),this.numSublayers=Hh.maxUnderzooming+Hh.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ap}resize(t,e,i){if(this.width=t*i,this.height=e*i,this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style._order)this.style._layers[t].resize()}setup(){const t=this.context,e=new pn;e.emplaceBack(0,0),e.emplaceBack(da,0),e.emplaceBack(0,da),e.emplaceBack(da,da),this.tileExtentBuffer=t.createVertexBuffer(e,dp.members),this.tileExtentSegments=Dn.simpleSegment(0,0,4,2);const i=new pn;i.emplaceBack(0,0),i.emplaceBack(da,0),i.emplaceBack(0,da),i.emplaceBack(da,da),this.debugBuffer=t.createVertexBuffer(i,dp.members),this.debugSegments=Dn.simpleSegment(0,0,4,5);const r=new mn;r.emplaceBack(0,0,0,0),r.emplaceBack(da,0,da,0),r.emplaceBack(0,da,0,da),r.emplaceBack(da,da,da,da),this.rasterBoundsBuffer=t.createVertexBuffer(r,yu.members),this.rasterBoundsSegments=Dn.simpleSegment(0,0,4,2);const n=new pn;n.emplaceBack(0,0),n.emplaceBack(1,0),n.emplaceBack(0,1),n.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(n,dp.members),this.viewportSegments=Dn.simpleSegment(0,0,4,2);const a=new Mn;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);const o=new zn;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const l=this.context.gl;this.stencilClearMode=new Od({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=Na();Ga(i,0,this.width,this.height,0,0,1),qa(i,i,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,Rd.disabled,this.stencilClearMode,Ld.disabled,Vd.disabled,Lp(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const i=this.context,r=i.gl;this.nextStencilID+e.length>256&&this.clearStencil(),i.setColorMode(Ld.disabled),i.setDepthMode(Rd.disabled);const n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const t of e){const e=this._tileClippingMaskIDs[t.key]=this.nextStencilID++,a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(t);n.draw(i,r.TRIANGLES,Rd.disabled,new Od({func:r.ALWAYS,mask:0},e,255,r.KEEP,r.KEEP,r.REPLACE),Ld.disabled,Vd.disabled,Lp(t.posMatrix),a,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Od({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Od({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,i=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=i[i.length-1].overscaledZ,n=i[0].overscaledZ-r+1;if(n>1){this.currentStencilSource=void 0,this.nextStencilID+n>256&&this.clearStencil();const t={};for(let i=0;i<n;i++)t[i+r]=new Od({func:e.GEQUAL,mask:255},i+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=n,[t,i]}return[{[r]:Od.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const e=1/8;return new Ld([t.CONSTANT_COLOR,t.ONE],new oe(e,e,e,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ld.unblended:Ld.alphaBlended}depthModeForSublayer(t,e,i){if(!this.opaquePassEnabledForLayer())return Rd.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Rd(i||this.context.gl.LEQUAL,e,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(F.now()),this.imageManager.beginFrame();const i=this.style._order,r=this.style.sourceCaches,n={},a={},o={};for(const t in r){const e=r[t];e.used&&e.prepare(this.context),n[t]=e.getVisibleCoordinates(),a[t]=n[t].slice().reverse(),o[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const t=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);!this.terrainFacilitator.dirty&&(u=(l=this.terrainFacilitator.matrix)[0],h=l[1],p=l[2],d=l[3],f=l[4],m=l[5],g=l[6],y=l[7],_=l[8],v=l[9],x=l[10],b=l[11],w=l[12],C=l[13],S=l[14],M=l[15],T=(c=this.transform.projMatrix)[0],E=c[1],A=c[2],I=c[3],P=c[4],O=c[5],k=c[6],D=c[7],z=c[8],j=c[9],N=c[10],B=c[11],V=c[12],U=c[13],H=c[14],q=c[15],Math.abs(u-T)<=Ra*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-E)<=Ra*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(p-A)<=Ra*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(d-I)<=Ra*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-P)<=Ra*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(m-O)<=Ra*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(g-k)<=Ra*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-D)<=Ra*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(_-z)<=Ra*Math.max(1,Math.abs(_),Math.abs(z))&&Math.abs(v-j)<=Ra*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(x-N)<=Ra*Math.max(1,Math.abs(x),Math.abs(N))&&Math.abs(b-B)<=Ra*Math.max(1,Math.abs(b),Math.abs(B))&&Math.abs(w-V)<=Ra*Math.max(1,Math.abs(w),Math.abs(V))&&Math.abs(C-U)<=Ra*Math.max(1,Math.abs(C),Math.abs(U))&&Math.abs(S-H)<=Ra*Math.max(1,Math.abs(S),Math.abs(H))&&Math.abs(M-q)<=Ra*Math.max(1,Math.abs(M),Math.abs(q)))&&!t.length||(function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,e){const i=t.context,r=i.gl,n=Ld.unblended,a=new Rd(r.LEQUAL,Rd.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.sourceCache.getRenderableTiles(),c=t.useProgram("terrainDepth");i.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:oe.transparent,depth:1});for(const u of l){const l=e.getTerrainData(u.tileID),h={u_matrix:t.transform.calculatePosMatrix(u.tileID.toUnwrapped()),u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};c.draw(i,r.TRIANGLES,a,Od.disabled,n,Vd.backCCW,h,l,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,e){const i=t.context,r=i.gl,n=Ld.unblended,a=new Rd(r.LEQUAL,Rd.ReadWrite,[0,1]),o=e.getTerrainMesh(),l=e.getCoordsTexture(),c=e.sourceCache.getRenderableTiles(),u=t.useProgram("terrainCoords");i.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:oe.transparent,depth:1}),e.coordsIndex=[];for(const h of c){const c=e.getTerrainData(h.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture);const p={u_matrix:t.transform.calculatePosMatrix(h.tileID.toUnwrapped()),u_terrain_coords_id:(255-e.coordsIndex.length)/255,u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};u.draw(i,r.TRIANGLES,a,Od.disabled,n,Vd.backCCW,p,c,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(h.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}var l,c,u,h,p,d,f,m,g,y,_,v,x,b,w,C,S,M,T,E,A,I,P,O,k,D,z,j,N,B,V,U,H,q;this.renderPass="offscreen";for(const t of i){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const i=a[e.source];("custom"===e.type||i.length)&&this.renderLayer(this,r[e.source],e,i)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?oe.black:oe.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[i[this.currentLayer]],e=r[t.source],a=n[t.source];this._renderTileClippingMasks(t,a),this.renderLayer(this,e,t,a)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const t=this.style._layers[i[this.currentLayer]],e=r[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t))continue;const l=("symbol"===t.type?o:a)[t.source];this._renderTileClippingMasks(t,n[t.source]),this.renderLayer(this,e,t,l)}if(this.options.showTileBoundaries){const t=function(t,e){let i=null;const r=Object.values(t._layers).flatMap((i=>i.source&&!i.isHidden(e)?[t.sourceCaches[i.source]]:[])),n=r.filter((t=>"vector"===t.getSource().type)),a=r.filter((t=>"vector"!==t.getSource().type)),o=t=>{(!i||i.getSource().maxzoom<t.getSource().maxzoom)&&(i=t)};return n.forEach((t=>o(t))),i||a.forEach((t=>o(t))),i}(this.style,this.transform.zoom);t&&Ef.debug(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;xf(t,t.transform.height-(e.top||0),3,ef),xf(t,e.bottom||0,3,hf),bf(t,e.left||0,3,pf),bf(t,t.transform.width-(e.right||0),3,mf);const i=t.transform.centerPoint;!function(t,e,i,r){wf(t,e-1,i-10,2,20,r),wf(t,e-10,i-1,20,2,r)}(t,i.x,t.transform.height-i.y,vf)}(this),this.context.setDefault()}renderLayer(t,e,i,r){i.isHidden(this.transform.zoom)||("background"===i.type||"custom"===i.type||(r||[]).length)&&(this.id=i.id,Ef[i.type](t,e,i,r,this.style.placement.variableOffsets))}translatePosMatrix(t,e,i,r,n){if(!i[0]&&!i[1])return t;const a=n?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const o=[n?i[0]:Sh(e,i[0],this.transform.zoom),n?i[1]:Sh(e,i[1],this.transform.zoom),0],l=new Float32Array(16);return Ha(l,t,o),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i}useProgram(t,e){this.cache=this.cache||{};const i=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new yp(this.context,t,mp[t],e,$p[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Kc(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class pm{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,e,i){const r=Math.pow(2,i),n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const n=1/(i=Ka([],i,t))[3]/e*r;return function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}(i,i,[n,n,1/i[3],n])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=function(t,e){var i=e[0],r=e[1],n=e[2],a=i*i+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}([],function(t,e,i){var r=e[0],n=e[1],a=e[2],o=i[0],l=i[1],c=i[2];return t[0]=n*c-a*l,t[1]=a*o-r*c,t[2]=r*l-n*o,t}([],Ya([],n[t[0]],n[t[1]]),Ya([],n[t[2]],n[t[1]]))),i=-((r=e)[0]*(a=n[t[1]])[0]+r[1]*a[1]+r[2]*a[2]);var r,a;return e.concat(i)}));return new pm(n,a)}}class dm{constructor(t,e){this.min=t,this.max=e,this.center=function(t,e,i){return t[0]=.5*e[0],t[1]=.5*e[1],t[2]=.5*e[2],t}([],function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}([],this.min,this.max))}quadrant(t){const e=[t%2==0,t<2],i=Wa(this.min),r=Wa(this.max);for(let t=0;t<e.length;t++)i[t]=e[t]?this.min[t]:this.center[t],r[t]=e[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new dm(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const e=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let a=0;a<t.planes.length;a++){const o=t.planes[a];let l=0;for(let t=0;t<e.length;t++)(r=o)[0]*(n=e[t])[0]+r[1]*n[1]+r[2]*n[2]+r[3]*n[3]>=0&&l++;if(0===l)return 0;l!==e.length&&(i=!1)}var r,n;if(i)return 2;for(let e=0;e<3;e++){let i=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let n=0;n<t.points.length;n++){const a=t.points[n][e]-this.min[e];i=Math.min(i,a),r=Math.max(r,a)}if(r<0||i>this.max[e]-this.min[e])return 0}return 1}}class mm{constructor(t=0,e=0,i=0,r=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=r}interpolate(t,e,i){return null!=e.top&&null!=t.top&&(this.top=ii.number(t.top,e.top,i)),null!=e.bottom&&null!=t.bottom&&(this.bottom=ii.number(t.bottom,e.bottom,i)),null!=e.left&&null!=t.left&&(this.left=ii.number(t.left,e.left,i)),null!=e.right&&null!=t.right&&(this.right=ii.number(t.right,e.right,i)),this}getCenter(t,e){const i=h((this.left+t-this.right)/2,0,t),r=h((this.top+e-this.bottom)/2,0,e);return new n(i,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new mm(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class fm{constructor(t,e,i,r,n){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===n||!!n,this._minZoom=t||0,this._maxZoom=e||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new uh(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new mm,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new fm(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new n(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const e=-p(t,-180,180)*Math.PI/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=function(){var t=new ja(4);return ja!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}(),function(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3],l=Math.sin(i),c=Math.cos(i);t[0]=r*c+a*l,t[1]=n*c+o*l,t[2]=r*-l+a*c,t[3]=n*-l+o*c}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const e=h(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(t){const e=[new Ah(0,t)];if(this._renderWorldCopies){const i=this.pointCoordinate(new n(0,0)),r=this.pointCoordinate(new n(this.width,0)),a=this.pointCoordinate(new n(this.width,this.height)),o=this.pointCoordinate(new n(0,this.height)),l=Math.floor(Math.min(i.x,r.x,a.x,o.x)),c=Math.floor(Math.max(i.x,r.x,a.x,o.x)),u=1;for(let i=l-u;i<=c+u;i++)0!==i&&e.push(new Ah(i,t))}return e}coveringTiles(t){var e,i;let r=this.coveringZoomLevel(t);const n=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const a=this.pointCoordinate(this.getCameraPoint()),o=xh.fromLngLat(this.center),l=Math.pow(2,r),c=[l*a.x,l*a.y,0],u=[l*o.x,l*o.y,0],h=pm.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r);let p=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(p=r);const d=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,f=t=>({aabb:new dm([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),m=[],g=[],y=r,_=t.reparseOverscaled?n:r;if(this._renderWorldCopies)for(let t=1;t<=3;t++)m.push(f(-t)),m.push(f(t));for(m.push(f(0));m.length>0;){const r=m.pop(),n=r.x,a=r.y;let o=r.fullyVisible;if(!o){const t=r.aabb.intersects(h);if(0===t)continue;o=2===t}const l=t.terrain?c:u,f=r.aabb.distanceX(l),v=r.aabb.distanceY(l),x=Math.max(Math.abs(f),Math.abs(v));if(r.zoom===y||x>d+(1<<y-r.zoom)-2&&r.zoom>=p){const t=y-r.zoom,e=c[0]-.5-(n<<t),i=c[1]-.5-(a<<t);g.push({tileID:new Eh(r.zoom===y?_:r.zoom,r.wrap,r.zoom,n,a),distanceSq:Ja([u[0]-.5-n,u[1]-.5-a]),tileDistanceToCamera:Math.sqrt(e*e+i*i)})}else for(let l=0;l<4;l++){const c=(n<<1)+l%2,u=(a<<1)+(l>>1),h=r.zoom+1;let p=r.aabb.quadrant(l);if(t.terrain){const n=new Eh(h,r.wrap,h,c,u),a=t.terrain.getMinMaxElevation(n),o=null!==(e=a.minElevation)&&void 0!==e?e:this.elevation,l=null!==(i=a.maxElevation)&&void 0!==i?i:this.elevation;p=new dm([p.min[0],p.min[1],o],[p.max[0],p.max[1],l])}m.push({aabb:p,zoom:h,x:c,y:u,wrap:r.wrap,fullyVisible:o})}}return g.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const e=h(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new n(uu(t.lng)*this.worldSize,hu(e)*this.worldSize)}unproject(t){return new xh(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(t,e){const i=xh.fromLngLat(t.wrap()),r=(1<<this.tileZoom)*da,n=i.x*r,a=i.y*r,o=Math.floor(n/da),l=Math.floor(a/da),c=new Eh(this.tileZoom,0,this.tileZoom,o,l);return e.getElevation(c,n%da,a%da,da)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const e=this.pointLocation(this.centerPoint,t),i=this.getElevation(e,t);if(!(this.elevation-i))return;const r=this.getCameraPosition(),n=xh.fromLngLat(r.lngLat,r.altitude),a=xh.fromLngLat(e,i),o=n.x-a.x,l=n.y-a.y,c=n.z-a.z,u=Math.sqrt(o*o+l*l+c*c),h=this.scaleZoom(this.cameraToCenterDistance/u/this.tileSize);this._elevation=i,this._center=e,this.zoom=h}setLocationAtPoint(t,e){const i=this.pointCoordinate(e),r=this.pointCoordinate(this.centerPoint),n=this.locationCoordinate(t),a=new xh(n.x-(i.x-r.x),n.y-(i.y-r.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,e),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(t){return xh.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,e){if(e){const i=e.pointCoordinate(t);if(null!=i)return i}const i=[t.x,t.y,0,1],r=[t.x,t.y,1,1];Ka(i,i,this.pixelMatrixInverse),Ka(r,r,this.pixelMatrixInverse);const n=i[3],a=r[3],o=i[1]/n,l=r[1]/a,c=i[2]/n,u=r[2]/a,h=c===u?0:(0-c)/(u-c);return new xh(ii.number(i[0]/n,r[0]/a,h)/this.worldSize,ii.number(o,l,h)/this.worldSize)}coordinatePoint(t,e=0,i=this.pixelMatrix){const r=[t.x*this.worldSize,t.y*this.worldSize,e,1];return Ka(r,r,i),new n(r[0]/r[3],r[1]/r[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new ph).extend(this.pointLocation(new n(0,t))).extend(this.pointLocation(new n(this.width,t))).extend(this.pointLocation(new n(this.width,this.height))).extend(this.pointLocation(new n(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new ph([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,e=!1){const i=t.key,r=e?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];const n=t.canonical,a=this.worldSize/this.zoomScale(n.z),o=n.x+Math.pow(2,n.z)*t.wrap,l=Ba(new Float64Array(16));return Ha(l,l,[o*a,n.y*a,0]),qa(l,l,[a/da,a/da,1]),Ua(l,e?this.alignedProjMatrix:this.projMatrix,l),r[i]=new Float32Array(l),r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,e,i,r,a=-90,o=90,l=-180,c=180;const u=this.size,h=this._unmodified;if(this.latRange){const e=this.latRange;a=hu(e[1])*this.worldSize,o=hu(e[0])*this.worldSize,t=o-a<u.y?u.y/(o-a):0}if(this.lngRange){const t=this.lngRange;l=p(uu(t[0])*this.worldSize,0,this.worldSize),c=p(uu(t[1])*this.worldSize,0,this.worldSize),c<l&&(c+=this.worldSize),e=c-l<u.x?u.x/(c-l):0}const d=this.point,f=Math.max(e||0,t||0);if(f)return this.center=this.unproject(new n(e?(c+l)/2:d.x,t?(o+a)/2:d.y)),this.zoom+=this.scaleZoom(f),this._unmodified=h,void(this._constraining=!1);if(this.latRange){const t=d.y,e=u.y/2;t-e<a&&(r=a+e),t+e>o&&(r=o-e)}if(this.lngRange){const t=(l+c)/2,e=p(d.x,t-this.worldSize/2,t+this.worldSize/2),r=u.x/2;e-r<l&&(i=l+r),e+r>c&&(i=c-r)}void 0===i&&void 0===r||(this.center=this.unproject(new n(void 0!==i?i:d.x,void 0!==r?r:d.y)).wrap()),this._unmodified=h,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,e=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=pu(1,this.center.lat)*this.worldSize;let r=Ba(new Float64Array(16));qa(r,r,[this.width/2,-this.height/2,1]),Ha(r,r,[1,-1,0]),this.labelPlaneMatrix=r,r=Ba(new Float64Array(16)),qa(r,r,[1,-1,1]),Ha(r,r,[-1,-1,0]),qa(r,r,[2/this.width,2/this.height,1]),this.glCoordMatrix=r,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const n=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,a=Math.PI/2+this._pitch,o=this._fov*(.5+t.y/this.height),l=Math.sin(o)*n/Math.sin(h(Math.PI-a-o,.01,Math.PI-.01)),c=this.getHorizon(),u=2*Math.atan(c/this.cameraToCenterDistance)*(.5+t.y/(2*c)),p=Math.sin(u)*n/Math.sin(h(Math.PI-a-u,.01,Math.PI-.01)),d=Math.min(l,p),f=1.01*(Math.cos(Math.PI/2-this._pitch)*d+n),m=this.height/50;r=new Float64Array(16),function(t,e,i,r,n){var a,o=1/Math.tan(e/2);t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+r)*(a=1/(r-n)),t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r)}(r,this._fov,this.width/this.height,m,f),r[8]=2*-t.x/this.width,r[9]=2*t.y/this.height,qa(r,r,[1,-1,1]),Ha(r,r,[0,0,-this.cameraToCenterDistance]),function(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+u*r,t[5]=o*n+h*r,t[6]=l*n+p*r,t[7]=c*n+d*r,t[8]=u*n-a*r,t[9]=h*n-o*r,t[10]=p*n-l*r,t[11]=d*n-c*r}(r,r,this._pitch),Za(r,r,this.angle),Ha(r,r,[-e,-i,0]),this.mercatorMatrix=qa([],r,[this.worldSize,this.worldSize,this.worldSize]),qa(r,r,[1,1,this._pixelPerMeter]),this.pixelMatrix=Ua(new Float64Array(16),this.labelPlaneMatrix,r),Ha(r,r,[0,0,-this.elevation]),this.projMatrix=r,this.invProjMatrix=Va([],r),this.pixelMatrix3D=Ua(new Float64Array(16),this.labelPlaneMatrix,r);const g=this.width%2/2,y=this.height%2/2,_=Math.cos(this.angle),v=Math.sin(this.angle),x=e-Math.round(e)+_*g+v*y,b=i-Math.round(i)+_*y+v*g,w=new Float64Array(r);if(Ha(w,w,[x>.5?x-1:x,b>.5?b-1:b,0]),this.alignedProjMatrix=w,r=Va(new Float64Array(16),this.pixelMatrix),!r)throw new Error("failed to invert matrix");this.pixelMatrixInverse=r,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new n(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return Ka(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new n(0,t))}getCameraQueryGeometry(t){const e=this.getCameraPoint();if(1===t.length)return[t[0],e];{let i=e.x,r=e.y,a=e.x,o=e.y;for(const e of t)i=Math.min(i,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y);return[new n(i,r),new n(a,r),new n(a,o),new n(i,o),new n(i,r)]}}}class _m{constructor(t){this._hashName=t&&encodeURIComponent(t),_(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){let i=!1,r=null;const n=()=>{r=null,i&&(t(),r=setTimeout(n,300),i=!1)};return()=>(i=!0,r||n(),r)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,r),a=Math.round(e.lng*n)/n,o=Math.round(e.lat*n)/n,l=this._map.getBearing(),c=this._map.getPitch();let u="";if(u+=t?`/${a}/${o}/${i}`:`${i}/${o}/${a}`,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),this._hashName){const t=this._hashName;let e=!1;const i=window.location.hash.slice(1).split("&").map((i=>{const r=i.split("=")[0];return r===t?(e=!0,`${r}=${u}`):i})).filter((t=>t));return e||i.push(`${t}=${u}`),`#${i.join("&")}`}return`#${u}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}}}const Af={linearity:.3,easing:c(0,0,.3,1)},If=f({deceleration:2500,maxSpeed:1400},Af),Lf=f({deceleration:20,maxSpeed:1400},Af),Of=f({deceleration:1e3,maxSpeed:360},Af),kf=f({deceleration:1e3,maxSpeed:90},Af);class wm{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:F.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,e=F.now();for(;t.length>0&&e-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const e={zoom:0,bearing:0,pitch:0,pan:new n(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)e.zoom+=t.zoomDelta||0,e.bearing+=t.bearingDelta||0,e.pitch+=t.pitchDelta||0,t.panDelta&&e.pan._add(t.panDelta),t.around&&(e.around=t.around),t.pinchAround&&(e.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(e.pan.mag()){const n=Rf(e.pan.mag(),i,f({},If,t||{}));r.offset=e.pan.mult(n.amount/e.pan.mag()),r.center=this._map.transform.center,Df(r,n)}if(e.zoom){const t=Rf(e.zoom,i,Lf);r.zoom=this._map.transform.zoom+t.amount,Df(r,t)}if(e.bearing){const t=Rf(e.bearing,i,Of);r.bearing=this._map.transform.bearing+h(t.amount,-179,179),Df(r,t)}if(e.pitch){const t=Rf(e.pitch,i,kf);r.pitch=this._map.transform.pitch+t.amount,Df(r,t)}if(r.zoom||r.bearing){const t=void 0===e.pinchAround?e.around:e.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),f(r,{noMoveStart:!0})}}function Df(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Rf(t,e,i){const{maxSpeed:r,linearity:n,deceleration:a}=i,o=h(t*n/(e/1e3),-r,r),l=Math.abs(o)/(a*n);return{easing:i.easing,duration:1e3*l,amount:o*(l/2)}}class Im extends rt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i,r={}){const n=L.mousePos(e.getCanvasContainer(),i);super(t,f({point:n,lngLat:e.unproject(n),originalEvent:i},r)),this._defaultPrevented=!1,this.target=e}}class Am extends rt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){const r="touchend"===t?i.changedTouches:i.touches,a=L.touchPos(e.getCanvasContainer(),r),o=a.map((t=>e.unproject(t))),l=a.reduce(((t,e,i,r)=>t.add(e.div(r.length))),new n(0,0));super(t,{points:a,point:l,lngLats:o,lngLat:e.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Em extends rt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1}}class zm{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Em(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Im(t.type,this._map,t))}mouseup(t){this._map.fire(new Im(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Im(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Im(t.type,this._map,t))}mouseover(t){this._map.fire(new Im(t.type,this._map,t))}mouseout(t){this._map.fire(new Im(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Am(t.type,this._map,t))}touchmove(t){this._map.fire(new Am(t.type,this._map,t))}touchend(t){this._map.fire(new Am(t.type,this._map,t))}touchcancel(t){this._map.fire(new Am(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cm{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Im(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Im("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Im(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mm{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(n.convert(t),this._map.terrain)}}class km{constructor(t,e){this._map=t,this._tr=new Mm(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(L.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const i=e;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=i,this._box||(this._box=L.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const n=Math.min(r.x,i.x),a=Math.max(r.x,i.x),o=Math.min(r.y,i.y),l=Math.max(r.y,i.y);L.setTransform(this._box,`translate(${n}px,${o}px)`),this._box.style.width=a-n+"px",this._box.style.height=l-o+"px"}mouseupWindow(t,e){if(!this._active)return;if(0!==t.button)return;const i=this._startPos,r=e;if(this.reset(),L.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new rt("boxzoomend",{originalEvent:t})),{cameraAnimation:t=>t.fitScreenCoordinates(i,r,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,e){return this._map.fire(new rt(t,{originalEvent:e}))}}function jf(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const i={};for(let r=0;r<t.length;r++)i[t[r].identifier]=e[r];return i}class Dm{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,e,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){const e=new n(0,0);for(const i of t)e._add(i);return e.div(t.length)}(e),this.touches=jf(i,e)))}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const r=jf(i,e);for(const t in this.touches){const e=r[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Lm{constructor(t){this.singleTap=new Dm(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,i){this.singleTap.touchstart(t,e,i)}touchmove(t,e,i){this.singleTap.touchmove(t,e,i)}touchend(t,e,i){const r=this.singleTap.touchend(t,e,i);if(r){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(r)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class Bm{constructor(t){this._tr=new Mm(t),this._zoomIn=new Lm({numTouches:1,numTaps:2}),this._zoomOut=new Lm({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)}touchend(t,e,i){const r=this._zoomIn.touchend(t,e,i),n=this._zoomOut.touchend(t,e,i),a=this._tr;return r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(r)},{originalEvent:t})}):n?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(n)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rm{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=e.length?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const i=this._lastPoint;if(!i)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const r=e.length?e[0]:e;return!this._moved&&r.dist(i)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=r,this._move(i,r))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&L.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Nf={0:1,2:2};class Om{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=L.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const i=Nf[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton)}isValidEndEvent(t){return L.mouseButton(t)===this._eventButton}}class Vm{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Bf=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=function(t){t.preventDefault()}},Vf=({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Om({checkCorrectEvent:t=>0===L.mouseButton(t)&&t.ctrlKey||2===L.mouseButton(t)});return new Rm({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:r,enable:t,assignEvents:Bf})},Uf=({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Om({checkCorrectEvent:t=>0===L.mouseButton(t)&&t.ctrlKey||2===L.mouseButton(t)});return new Rm({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:t,assignEvents:Bf})};class qm{constructor(t,e){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new n(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._map._cooperativeGestures&&(2===this._minTouches&&i.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,i.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(i.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,i)}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,e,i){i.length>0&&(this._active=!0);const r=jf(i,e),a=new n(0,0),o=new n(0,0);let l=0;for(const t in r){const e=r[t],i=this._touches[t];i&&(a._add(e),o._add(e.sub(i)),l++,r[t]=e)}if(this._touches=r,l<this._minTouches||!o.mag())return;const c=o.div(l);return this._sum._add(c),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(l),panDelta:c}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jm{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,i){return{}}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[r,n]=this._firstTwoTouches,a=Hf(i,e,r),o=Hf(i,e,n);if(!a||!o)return;const l=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],l,t)}touchend(t,e,i){if(!this._firstTwoTouches)return;const[r,n]=this._firstTwoTouches,a=Hf(i,e,r),o=Hf(i,e,n);a&&o||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Hf(t,e,i){for(let r=0;r<t.length;r++)if(t[r].identifier===i)return e[r]}function qf(t,e){return Math.log(t/e)/Math.LN2}class Hm extends jm{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(qf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:qf(this._distance,i),pinchAround:e}}}function Zf(t,e){return 180*t.angleWith(e)/Math.PI}class Xm extends jm{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Zf(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=Zf(t,this._startVector);return Math.abs(i)<e}}function Gf(t){return Math.abs(t.y)>Math.abs(t.x)}class Ym extends jm{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,i){super.touchstart(t,e,i),this._currentTouchCount=i.length}_start(t){this._lastPoints=t,Gf(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,i){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const r=t[0].sub(this._lastPoints[0]),n=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,n,i.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+n.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,n=e.mag()>=2;if(!r&&!n)return;if(!r||!n)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const a=t.y>0==e.y>0;return Gf(t)&&Gf(e)&&a}}const Wf={panStep:100,bearingStep:15,pitchStep:10};class Qm{constructor(t){this._tr=new Mm(t);const e=Wf;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,r=0,n=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),n=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),n=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:o=>{const l=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:Xf,zoom:e?Math.round(l.zoom)+e*(t.shiftKey?2:1):l.zoom,bearing:l.bearing+i*this._bearingStep,pitch:l.pitch+r*this._pitchStep,offset:[-n*this._panStep,-a*this._panStep],center:l.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xf(t){return t*(2-t)}const Yf=4.000244140625;class rf{constructor(t,e){this._map=t,this._tr=new Mm(t),this._el=t.getCanvasContainer(),this._handler=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,_(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const i=F.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==e&&e%Yf==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=L.mousePos(this._el,t),i=this._tr;this._around=uh.convert(this._aroundCenter?i.center:i.unproject(e)),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Yf?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);const r="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(r*i))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const e="number"==typeof this._targetZoom?this._targetZoom:t.zoom,i=this._startZoom,r=this._easing;let n,a=!1;if("wheel"===this._type&&i&&r){const t=Math.min((F.now()-this._lastWheelEventTime)/200,1),o=r(t);n=ii.number(i,e,o),t<1?this._frameId||(this._frameId=!0):a=!0}else n=e,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:n-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let e=u;if(this._prevEase){const t=this._prevEase,i=(F.now()-t.start)/t.duration,r=t.easing(i+.01)-t.easing(i),n=.27/Math.sqrt(r*r+1e-4)*.01;e=c(n,Math.sqrt(.0729-n*n),.25,1)}return this._prevEase={start:F.now(),duration:t,easing:e},e}reset(){this._active=!1}}class sf{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nf{constructor(t){this._tr=new Mm(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class af{constructor(){this._tap=new Lm({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,i){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=e[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(t,e,i))}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const r=e[0],n=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,i)}touchend(t,e,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(t,e,i)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class of{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lf{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cf{constructor(t,e,i,r){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Kf=t=>t.zoom||t.drag||t.pitch||t.rotate;class uf extends rt{}function Jf(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class df{constructor(t,e){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wm(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e),_(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,i]of this._listeners)L.addEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}destroy(){for(const[t,e,i]of this._listeners)L.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(t){const e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new zm(e,t));const r=e.boxZoom=new km(e,t);this._add("boxZoom",r);const n=new Bm(e),a=new nf(e);e.doubleClickZoom=new sf(a,n),this._add("tapZoom",n),this._add("clickZoom",a);const o=new af;this._add("tapDragZoom",o);const l=e.touchPitch=new Ym(e);this._add("touchPitch",l);const c=Vf(t),u=Uf(t);e.dragRotate=new lf(t,c,u),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const h=(({enable:t,clickTolerance:e})=>{const i=new Om({checkCorrectEvent:t=>0===L.mouseButton(t)&&!t.ctrlKey});return new Rm({clickTolerance:e,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:i,enable:t,assignEvents:Bf})})(t),p=new qm(t,e);e.dragPan=new of(i,h,p),this._add("mousePan",h),this._add("touchPan",p,["touchZoom","touchRotate"]);const d=new Xm,f=new Hm;e.touchZoomRotate=new cf(i,f,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]);const m=e.scrollZoom=new rf(e,this);this._add("scrollZoom",m,["mousePan"]);const g=e.keyboard=new Qm(e);this._add("keyboard",g),this._add("blockableMapEvent",new Cm(e));for(const i of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[i]&&e[i].enable(t[i])}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Kf(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,i){for(const r in t)if(r!==i&&(!e||e.indexOf(r)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}handleEvent(t,e){if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},n={},a={},o=t.touches,l=o?this._getMapTouches(o):void 0,c=l?L.touchPos(this._el,l):L.mousePos(this._el,t);for(const{handlerName:o,handler:u,allowed:h}of this._handlers){if(!u.isEnabled())continue;let p;this._blockedByActive(a,h,o)?u.reset():u[e||t.type]&&(p=u[e||t.type](t,c,l),this.mergeHandlerResult(r,n,p,o,i),p&&p.needsRenderFrame&&this._triggerRenderFrame()),(p||u.isActive())&&(a[o]=u)}const u={};for(const t in this._previousActiveHandlers)a[t]||(u[t]=i);this._previousActiveHandlers=a,(Object.keys(u).length||Jf(r))&&(this._changes.push([r,n,u]),this._triggerRenderFrame()),(Object.keys(a).length||Jf(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(t,e,i,r,n){if(!i)return;f(t,i);const a={handlerName:r,originalEvent:i.originalEvent||n};void 0!==i.zoomDelta&&(e.zoom=a),void 0!==i.panDelta&&(e.drag=a),void 0!==i.pitchDelta&&(e.pitch=a),void 0!==i.bearingDelta&&(e.rotate=a)}_applyChanges(){const t={},e={},i={};for(const[r,a,o]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new n(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),f(e,a),f(i,o);this._updateMapTransform(t,e,i),this._changes=[]}_updateMapTransform(t,e,i){const r=this._map,n=r._getTransformForUpdate(),a=r.terrain;if(!(Jf(t)||a&&this._terrainMovement))return this._fireEvents(e,i,!0);let{panDelta:o,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,pinchAround:p}=t;void 0!==p&&(h=p),r._stop(!0),h=h||r.transform.centerPoint;const d=n.pointLocation(o?h.sub(o):h);c&&(n.bearing+=c),u&&(n.pitch+=u),l&&(n.zoom+=l),a?this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?n.center=n.pointLocation(n.centerPoint.sub(o)):n.setLocationAtPoint(d,h):(this._terrainMovement=!0,n.freezeElevation=!0,n.setLocationAtPoint(d,h),this._map.once("moveend",(()=>{n.freezeElevation=!1,this._terrainMovement=!1,n.recalculateZoom(r.terrain)}))):n.setLocationAtPoint(d,h),r._applyUpdatedTransform(n),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i,!0)}_fireEvents(t,e,i){const r=Kf(this._eventsInProgress),n=Kf(t),a={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(a[`${e}start`]=i),this._eventsInProgress[e]=t[e]}!r&&n&&this._fireEvent("movestart",n.originalEvent);for(const t in a)this._fireEvent(t,a[t]);n&&this._fireEvent("move",n.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const o={};let l;for(const t in this._eventsInProgress){const{handlerName:i,originalEvent:r}=this._eventsInProgress[t];this._handlersById[i].isActive()||(delete this._eventsInProgress[t],l=e[i]||r,o[`${t}end`]=l)}for(const t in o)this._fireEvent(t,o[t]);const c=Kf(this._eventsInProgress);if(i&&(r||n)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),e=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;t?(e(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new rt("moveend",{originalEvent:l})),e(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,e){this._map.fire(new rt(t,e?{originalEvent:e}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new uf("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Qf={extend:(t,...e)=>f(t,...e),run(t){t()},logToElement(t,e=!1,i="log"){const r=window.document.getElementById(i);r&&(e&&(r.innerHTML=""),r.innerHTML+=`<br>${t}`)}};class ff extends nt{constructor(t,e){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,_(["_renderFrameCallback"],this),this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new uh(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(t,e,i){return t=n.convert(t).mult(-1),this.panTo(this.transform.center,f({offset:t},e),i)}panTo(t,e,i){return this.easeTo(f({center:t},e),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(t,e,i){return this.easeTo(f({zoom:t},e),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(t,e,i){return this.easeTo(f({bearing:t},e),i)}resetNorth(t,e){return this.rotateTo(0,f({duration:1e3},t),e),this}resetNorthPitch(t,e){return this.easeTo(f({bearing:0,pitch:0,duration:1e3},t),e),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(t,e){t=ph.convert(t);const i=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),i,e)}_cameraForBoxAndBearing(t,e,i,r){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=f({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const t=r.padding;r.padding={top:t,bottom:t,right:t,left:t}}r.padding=f(a,r.padding);const o=this.transform,l=o.padding,c=o.project(uh.convert(t)),u=o.project(uh.convert(e)),h=c.rotate(-i*Math.PI/180),p=u.rotate(-i*Math.PI/180),d=new n(Math.max(h.x,p.x),Math.max(h.y,p.y)),m=new n(Math.min(h.x,p.x),Math.min(h.y,p.y)),g=d.sub(m),y=(o.width-(l.left+l.right+r.padding.left+r.padding.right))/g.x,_=(o.height-(l.top+l.bottom+r.padding.top+r.padding.bottom))/g.y;if(_<0||y<0)return void S("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const v=Math.min(o.scaleZoom(o.scale*Math.min(y,_)),r.maxZoom),x=n.convert(r.offset),b=new n((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(i*Math.PI/180),w=x.add(b).mult(o.scale/o.zoomScale(v));return{center:o.unproject(c.add(u).div(2).sub(w)),zoom:v,bearing:i}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}fitScreenCoordinates(t,e,i,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(n.convert(t)),this.transform.pointLocation(n.convert(e)),i,r),r,a)}_fitInternal(t,e,i){return t?(delete(e=f(t,e)).padding,e.linear?this.easeTo(e,i):this.flyTo(e,i)):this}jumpTo(t,e){this.stop();const i=this._getTransformForUpdate();let r=!1,n=!1,a=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(r=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=uh.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(n=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(a=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this._applyUpdatedTransform(i),this.fire(new rt("movestart",e)).fire(new rt("move",e)),r&&this.fire(new rt("zoomstart",e)).fire(new rt("zoom",e)).fire(new rt("zoomend",e)),n&&this.fire(new rt("rotatestart",e)).fire(new rt("rotate",e)).fire(new rt("rotateend",e)),a&&this.fire(new rt("pitchstart",e)).fire(new rt("pitch",e)).fire(new rt("pitchend",e)),this.fire(new rt("moveend",e))}calculateCameraOptionsFromTo(t,e,i,r=0){const n=xh.fromLngLat(t,e),a=xh.fromLngLat(i,r),o=a.x-n.x,l=a.y-n.y,c=a.z-n.z,u=Math.hypot(o,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(o,l),p=this.transform.scaleZoom(this.transform.cameraToCenterDistance/u/this.transform.tileSize),d=180*Math.atan2(o,-l)/Math.PI;let f=180*Math.acos(h/u)/Math.PI;return f=c<0?90-f:90+f,{center:a.toLngLat(),zoom:p,pitch:f,bearing:d}}easeTo(t,e){this._stop(!1,t.easeId),(!1===(t=f({offset:[0,0],duration:500,easing:u},t)).animate||!t.essential&&F.prefersReducedMotion)&&(t.duration=0);const i=this._getTransformForUpdate(),r=this.getZoom(),a=this.getBearing(),o=this.getPitch(),l=this.getPadding(),c="zoom"in t?+t.zoom:r,h="bearing"in t?this._normalizeBearing(t.bearing,a):a,p="pitch"in t?+t.pitch:o,d="padding"in t?t.padding:i.padding,m=n.convert(t.offset);let g=i.centerPoint.add(m);const y=i.pointLocation(g),_=uh.convert(t.center||y);this._normalizeCenter(_);const v=i.project(y),x=i.project(_).sub(v),b=i.zoomScale(c-r);let w,C;t.around&&(w=uh.convert(t.around),C=i.locationPoint(w));const S={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==r,this._rotating=this._rotating||a!==h,this._pitching=this._pitching||p!==o,this._padding=!i.isPaddingEqual(d),this._easeId=t.easeId,this._prepareEase(e,t.noMoveStart,S),this.terrain&&this._prepareElevation(_),this._ease((n=>{if(this._zooming&&(i.zoom=ii.number(r,c,n)),this._rotating&&(i.bearing=ii.number(a,h,n)),this._pitching&&(i.pitch=ii.number(o,p,n)),this._padding&&(i.interpolatePadding(l,d,n),g=i.centerPoint.add(m)),this.terrain&&!t.freezeElevation&&this._updateElevation(n),w)i.setLocationAtPoint(w,C);else{const t=i.zoomScale(i.zoom-r),e=c>r?Math.min(2,b):Math.max(.5,b),a=Math.pow(e,1-n),o=i.unproject(v.add(x.mult(n*a)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?o.wrap():o,g)}this._applyUpdatedTransform(i),this._fireMoveEvents(e)}),(t=>{this.terrain&&this._finalizeElevation(),this._afterEase(e,t)}),t),this}_prepareEase(t,e,i={}){this._moving=!0,e||i.moving||this.fire(new rt("movestart",t)),this._zooming&&!i.zooming&&this.fire(new rt("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new rt("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new rt("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(t,this.terrain),this.transform.freezeElevation=!0}_updateElevation(t){const e=this.transform.getElevation(this._elevationCenter,this.terrain);if(t<1&&e!==this._elevationTarget){const i=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(i-(e-(i*t+this._elevationStart))/(1-t)),this._elevationTarget=e}this.transform.elevation=ii.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const e=t.clone(),{center:i,zoom:r,pitch:n,bearing:a,elevation:o}=this.transformCameraUpdate(e);i&&(e.center=i),void 0!==r&&(e.zoom=r),void 0!==n&&(e.pitch=n),void 0!==a&&(e.bearing=a),void 0!==o&&(e.elevation=o),this.transform.apply(e)}_fireMoveEvents(t){this.fire(new rt("move",t)),this._zooming&&this.fire(new rt("zoom",t)),this._rotating&&this.fire(new rt("rotate",t)),this._pitching&&this.fire(new rt("pitch",t))}_afterEase(t,e){if(this._easeId&&e&&this._easeId===e)return;delete this._easeId;const i=this._zooming,r=this._rotating,n=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new rt("zoomend",t)),r&&this.fire(new rt("rotateend",t)),n&&this.fire(new rt("pitchend",t)),this.fire(new rt("moveend",t))}flyTo(t,e){if(!t.essential&&F.prefersReducedMotion){const i=m(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,e)}this.stop(),t=f({offset:[0,0],speed:1.2,curve:1.42,easing:u},t);const i=this._getTransformForUpdate(),r=this.getZoom(),a=this.getBearing(),o=this.getPitch(),l=this.getPadding(),c="zoom"in t?h(+t.zoom,i.minZoom,i.maxZoom):r,p="bearing"in t?this._normalizeBearing(t.bearing,a):a,d="pitch"in t?+t.pitch:o,g="padding"in t?t.padding:i.padding,y=i.zoomScale(c-r),_=n.convert(t.offset);let v=i.centerPoint.add(_);const x=i.pointLocation(v),b=uh.convert(t.center||x);this._normalizeCenter(b);const w=i.project(x),C=i.project(b).sub(w);let S=t.curve;const M=Math.max(i.width,i.height),T=M/y,E=C.mag();if("minZoom"in t){const e=h(Math.min(t.minZoom,r,c),i.minZoom,i.maxZoom),n=M/i.zoomScale(e-r);S=Math.sqrt(n/E*2)}const A=S*S;function I(t){const e=(T*T-M*M+(t?-1:1)*A*A*E*E)/(2*(t?T:M)*A*E);return Math.log(Math.sqrt(e*e+1)-e)}function P(t){return(Math.exp(t)-Math.exp(-t))/2}function O(t){return(Math.exp(t)+Math.exp(-t))/2}const k=I(0);let D=function(t){return O(k)/O(k+S*t)},z=function(t){return M*((O(k)*(P(e=k+S*t)/O(e))-P(k))/A)/E;var e},j=(I(1)-k)/S;if(Math.abs(E)<1e-6||!isFinite(j)){if(Math.abs(M-T)<1e-6)return this.easeTo(t,e);const i=T<M?-1:1;j=Math.abs(Math.log(T/M))/S,z=function(){return 0},D=function(t){return Math.exp(i*S*t)}}return t.duration="duration"in t?+t.duration:1e3*j/("screenSpeed"in t?+t.screenSpeed/S:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=a!==p,this._pitching=d!==o,this._padding=!i.isPaddingEqual(g),this._prepareEase(e,!1),this.terrain&&this._prepareElevation(b),this._ease((n=>{const u=n*j,h=1/D(u);i.zoom=1===n?c:r+i.scaleZoom(h),this._rotating&&(i.bearing=ii.number(a,p,n)),this._pitching&&(i.pitch=ii.number(o,d,n)),this._padding&&(i.interpolatePadding(l,g,n),v=i.centerPoint.add(_)),this.terrain&&!t.freezeElevation&&this._updateElevation(n);const f=1===n?b:i.unproject(w.add(C.mult(z(u))).mult(h));i.setLocationAtPoint(i.renderWorldCopies?f.wrap():f,v),this._applyUpdatedTransform(i),this._fireMoveEvents(e)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(e)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(t,e,i){!1===i.animate||0===i.duration?(t(1),e()):(this._easeStart=F.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((F.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,e){t=p(t,-180,180);const i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(t){return this.terrain?this.transform.getElevation(uh.convert(t),this.terrain)-this.transform.elevation:null}}class _f{constructor(t={}){this.options=t,_(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const i in e){const r=e[i];if(r.used||r.usedForTerrain){const e=r.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,i)=>{for(let r=i+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));const i=t.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class gf{constructor(t={}){this.options=t,_(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl");const e=L.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}}}class yf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var tm;!function(t){t.create="create",t.load="load",t.fullLoad="fullLoad"}(tm||(tm={}));let em=null,im=[];const rm=1e3/60,nm="loadTime",sm="fullLoadTime",am={mark(t){performance.mark(t)},frame(t){const e=t;null!=em&&im.push(e-em),em=e},clearMetrics(){em=null,im=[],performance.clearMeasures(nm),performance.clearMeasures(sm);for(const t in tm)performance.clearMarks(tm[t])},getPerformanceMetrics(){performance.measure(nm,tm.create,tm.load),performance.measure(sm,tm.create,tm.fullLoad);const t=performance.getEntriesByName(nm)[0].duration,e=performance.getEntriesByName(sm)[0].duration,i=im.length,r=1/(im.reduce(((t,e)=>t+e),0)/i/1e3),n=im.filter((t=>t>rm)).reduce(((t,e)=>t+(e-rm)/rm),0);return{loadTime:t,fullLoadTime:e,fps:r,percentDroppedFrames:n/(i+n)*100,totalFrames:i}}},om={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var lm=ts([{name:"a_pos3d",type:"Int16",components:3}]);class zf extends nt{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,e){this.sourceCache.update(t,e),this._renderableTilesKeys=[];const i={};for(const r of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:e}))i[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),Ga(r.posMatrix,0,da,0,da,0,1),this._tiles[r.key]=new jh(r,this.tileSize));for(const t in this._tiles)i[t]||delete this._tiles[t]}freeRtt(t){for(const e in this._tiles){const i=this._tiles[e];(!t||i.tileID.equals(t)||i.tileID.isChildOf(t)||t.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const e={};for(const i of this._renderableTilesKeys){const r=this._tiles[i].tileID;if(r.canonical.equals(t.canonical)){const r=t.clone();r.posMatrix=new Float64Array(16),Ga(r.posMatrix,0,da,0,da,0,1),e[i]=r}else if(r.canonical.isChildOf(t.canonical)){const n=t.clone();n.posMatrix=new Float64Array(16);const a=r.canonical.z-t.canonical.z,o=r.canonical.x-(r.canonical.x>>a<<a),l=r.canonical.y-(r.canonical.y>>a<<a),c=da>>a;Ga(n.posMatrix,0,c,0,c,0,1),Ha(n.posMatrix,n.posMatrix,[-o*c,-l*c,0]),e[i]=n}else if(t.canonical.isChildOf(r.canonical)){const n=t.clone();n.posMatrix=new Float64Array(16);const a=t.canonical.z-r.canonical.z,o=t.canonical.x-(t.canonical.x>>a<<a),l=t.canonical.y-(t.canonical.y>>a<<a),c=da>>a;Ga(n.posMatrix,0,da,0,da,0,1),Ha(n.posMatrix,n.posMatrix,[o*c,l*c,0]),qa(n.posMatrix,n.posMatrix,[1/2**a,1/2**a,0]),e[i]=n}}return e}getSourceTile(t,e){const i=this.sourceCache._source;let r=t.overscaledZ-this.deltaZoom;if(r>i.maxzoom&&(r=i.maxzoom),r<i.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(r).key);let n=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!n||!n.dem)&&e)for(;r>=i.minzoom&&(!n||!n.dem);)n=this.sourceCache.getTileByID(t.scaledTo(r--).key);return n}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeAdded>=t))}}class Cf{constructor(t,e,i){this.painter=t,this.sourceCache=new zf(e),this.options=i,this.exaggeration="number"==typeof i.exaggeration?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,e,i,r=da){if(!(e>=0&&e<r&&i>=0&&i<r))return 0;let n=0;const a=this.getTerrainData(t);if(a.tile&&a.tile.dem){const t=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}([],[e/r*da,i/r*da],a.u_terrain_matrix),o=[t[0]*a.tile.dem.dim,t[1]*a.tile.dem.dim],l=[Math.floor(o[0]),Math.floor(o[1])],c=a.tile.dem.get(l[0],l[1]),u=a.tile.dem.get(l[0],l[1]+1),h=a.tile.dem.get(l[0]+1,l[1]),p=a.tile.dem.get(l[0]+1,l[1]+1);n=ii.number(ii.number(c,u,o[0]-l[0]),ii.number(h,p,o[0]-l[0]),o[1]-l[1])}return n}getElevation(t,e,i,r=da){return this.getDEMElevation(t,e,i,r)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,e=new ao({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Kc(t,e,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Kc(t,new ao({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Ba([])}const e=this.sourceCache.getSourceTile(t,!0);if(e&&e.dem&&(!e.demTexture||e.needsTerrainPrepare)){const t=this.painter.context;e.demTexture=this.painter.getTileTexture(e.dem.stride),e.demTexture?e.demTexture.update(e.dem.getPixels(),{premultiply:!1}):e.demTexture=new Kc(t,e.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),e.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),e.needsTerrainPrepare=!1}const i=e&&e+e.tileID.key+t.key;if(i&&!this._demMatrixCache[i]){const i=this.sourceCache.sourceCache._source.maxzoom;let r=t.canonical.z-e.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=i?r=t.canonical.z-i:S("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const n=t.canonical.x-(t.canonical.x>>r<<r),a=t.canonical.y-(t.canonical.y>>r<<r),o=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(new Float64Array(16),[1/(da<<r),1/(da<<r),0]);Ha(o,o,[n*da,a*da,0]),this._demMatrixCache[t.key]={matrix:o,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:e&&e.dem&&e.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:e&&e.dem&&e.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(e&&e.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:e}}getFramebuffer(t){const e=this.painter,i=e.width/devicePixelRatio,r=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Kc(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Kc(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(i,r,!0,!1),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,i,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const e=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,i=0;t<this._coordsTextureSize;t++)for(let r=0;r<this._coordsTextureSize;r++,i+=4)e[i+0]=255&r,e[i+1]=255&t,e[i+2]=r>>8<<4|t>>8,e[i+3]=0;const i=new ao({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(e.buffer)),r=new Kc(t,i,t.gl.RGBA,{premultiply:!1});return r.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(t){const e=new Uint8Array(4),i=this.painter.context,r=i.gl;i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,r.RGBA,r.UNSIGNED_BYTE,e),i.bindFramebuffer.set(null);const n=e[0]+(e[2]>>4<<8),a=e[1]+((15&e[2])<<8),o=this.coordsIndex[255-e[3]],l=o&&this.sourceCache.getTileByID(o);if(!l)return null;const c=this._coordsTextureSize,u=(1<<l.tileID.canonical.z)*c;return new xh((l.tileID.canonical.x*c+n)/u,(l.tileID.canonical.y*c+a)/u,this.getElevation(l.tileID,n,a,c))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,e=new dn,i=new zn,r=this.meshSize,n=da/r,a=r*r;for(let t=0;t<=r;t++)for(let i=0;i<=r;i++)e.emplaceBack(i*n,t*n,0);for(let t=0;t<a;t+=r+1)for(let e=0;e<r;e++)i.emplaceBack(e+t,r+e+t+1,r+e+t+2),i.emplaceBack(e+t,r+e+t+2,e+t+1);const o=e.length,l=o+2*(r+1);for(const t of[0,1])for(let i=0;i<=r;i++)for(const r of[0,1])e.emplaceBack(i*n,t*da,r);for(let t=0;t<2*r;t+=2)i.emplaceBack(l+t,l+t+1,l+t+3),i.emplaceBack(l+t,l+t+3,l+t+2),i.emplaceBack(o+t,o+t+3,o+t+1),i.emplaceBack(o+t,o+t+2,o+t+3);const c=e.length,u=c+2*(r+1);for(const t of[0,1])for(let i=0;i<=r;i++)for(const r of[0,1])e.emplaceBack(t*da,i*n,r);for(let t=0;t<2*r;t+=2)i.emplaceBack(c+t,c+t+1,c+t+3),i.emplaceBack(c+t,c+t+3,c+t+2),i.emplaceBack(u+t,u+t+3,u+t+1),i.emplaceBack(u+t,u+t+2,u+t+3);return this._mesh={indexBuffer:t.createIndexBuffer(i),vertexBuffer:t.createVertexBuffer(e,lm.members),segments:Dn.simpleSegment(0,0,e.length,i.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*ou/Math.pow(2,t)/5}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,i={minElevation:null,maxElevation:null};return e&&e.dem&&(i.minElevation=e.dem.min*this.exaggeration,i.maxElevation=e.dem.max*this.exaggeration),i}}class Mf{constructor(t,e,i){this._context=t,this._size=e,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const e=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new Kc(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),e.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),e.colorAttachment.set(i.texture),{id:t,fbo:e,texture:i,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((e=>t.id!==e)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((t=>!t.inUse))}}const cm={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Pf{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new Mf(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((i=>!t._layers[i].isHidden(e))),this._coordsDescendingInv={};for(const e in t.sourceCaches){this._coordsDescendingInv[e]={};const i=t.sourceCaches[e].getVisibleCoordinates();for(const t of i){const i=this.terrain.sourceCache.getTerrainCoords(t);for(const t in i)this._coordsDescendingInv[e][t]||(this._coordsDescendingInv[e][t]=[]),this._coordsDescendingInv[e][t].push(i[t])}}this._coordsDescendingInvStr={};for(const e of t._order){const i=t._layers[e],r=i.source;if(cm[i.type]&&!this._coordsDescendingInvStr[r]){this._coordsDescendingInvStr[r]={};for(const t in this._coordsDescendingInv[r])this._coordsDescendingInvStr[r][t]=this._coordsDescendingInv[r][t].map((t=>t.key)).sort().join()}}for(const t of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const i=this._coordsDescendingInvStr[e][t.tileID.key];i&&i!==t.rttCoords[e]&&(t.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const e=t.type,i=this.painter,r=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(cm[e]&&(this._prevType&&cm[this._prevType]||this._stacks.push([]),this._prevType=e,this._stacks[this._stacks.length-1].push(t.id),!r))return!0;if(cm[this._prevType]||cm[e]&&r){this._prevType=e;const t=this._stacks.length-1,r=this._stacks[t]||[];for(const e of this._renderableTiles){if(this.pool.isFull()&&(Tf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(e),e.rtt[t]){const i=this.pool.getObjectForId(e.rtt[t].id);if(i.stamp===e.rtt[t].stamp){this.pool.useObject(i);continue}}const n=this.pool.getOrCreateFreeObject();this.pool.useObject(n),this.pool.stampObject(n),e.rtt[t]={id:n.id,stamp:n.stamp},i.context.bindFramebuffer.set(n.fbo.framebuffer),i.context.clear({color:oe.transparent,stencil:0}),i.currentStencilSource=void 0;for(let t=0;t<r.length;t++){const a=i.style._layers[r[t]],o=a.source?this._coordsDescendingInv[a.source][e.tileID.key]:[e.tileID];i.context.viewport.set([0,0,n.fbo.width,n.fbo.height]),i._renderTileClippingMasks(a,o),i.renderLayer(i,i.style.sourceCaches[a.source],a,o),a.source&&(e.rttCoords[a.source]=this._coordsDescendingInvStr[a.source][e.tileID.key])}}return Tf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),cm[e]}return!1}}const hm=t,gm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:z.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},ym=t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},vm={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ff{constructor(t,e,i=!1){this._clickTolerance=10;const r=t.dragRotate._mouseRotate.getClickTolerance(),n=t.dragRotate._mousePitch.getClickTolerance();this.element=e,this.mouseRotate=Vf({clickTolerance:r,enable:!0}),this.touchRotate=(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const r=new Vm;return new Rm({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:r,enable:t,assignEvents:ym})})({clickTolerance:r,enable:!0}),this.map=t,i&&(this.mousePitch=Uf({clickTolerance:n,enable:!0}),this.touchPitch=(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new Vm;return new Rm({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:t,assignEvents:ym})})({clickTolerance:n,enable:!0})),_(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(e,"mousedown",this.mousedown),L.addEventListener(e,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(e,"touchcancel",this.reset)}startMouse(t,e){this.mouseRotate.dragStart(t,e),this.mousePitch&&this.mousePitch.dragStart(t,e),L.disableDrag()}startTouch(t,e){this.touchRotate.dragStart(t,e),this.touchPitch&&this.touchPitch.dragStart(t,e),L.disableDrag()}moveMouse(t,e){const i=this.map,{bearingDelta:r}=this.mouseRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){const{pitchDelta:r}=this.mousePitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}moveTouch(t,e){const i=this.map,{bearingDelta:r}=this.touchRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.touchPitch){const{pitchDelta:r}=this.touchPitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}off(){const t=this.element;L.removeEventListener(t,"mousedown",this.mousedown),L.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend),L.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend)}mousedown(t){this.startMouse(f({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),L.mousePos(this.element,t)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.moveMouse(t,L.mousePos(this.element,t))}mouseup(t){this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),L.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.addEventListener(window,"touchend",this.touchend))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=L.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let xm;function bm(t,e,i){if(t=new uh(t.lng,t.lat),e){const r=new uh(t.lng-360,t.lat),n=new uh(t.lng+360,t.lat),a=i.locationPoint(t).distSqr(e);i.locationPoint(r).distSqr(e)<a?t=r:i.locationPoint(n).distSqr(e)<a&&(t=n)}for(;Math.abs(t.lng-i.center.lng)>180;){const e=i.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=i.width&&e.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}const Sm={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Tm(t,e,i){const r=t.classList;for(const t in Sm)r.remove(`maplibregl-${i}-anchor-${t}`);r.add(`maplibregl-${i}-anchor-${e}`)}class $f extends nt{constructor(t,e){if(super(),(t instanceof HTMLElement||e)&&(t=f({element:t},e)),_(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=n.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");const e=L.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;e.setAttributeNS(null,"display","block"),e.setAttributeNS(null,"height",`${i}px`),e.setAttributeNS(null,"width",`${r}px`),e.setAttributeNS(null,"viewBox",`0 0 ${r} ${i}`);const a=L.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const o=L.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const l=L.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=L.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const u=L.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=L.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const p=L.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");const d=L.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);const f=L.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=L.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=L.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=L.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),o.appendChild(l),o.appendChild(u),o.appendChild(p),o.appendChild(f),o.appendChild(m),e.appendChild(o),e.setAttributeNS(null,"height",i*this._scale+"px"),e.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(e),this._offset=n.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),Tm(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=uh.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,r=Math.sqrt(Math.pow(i,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-i+r)],"bottom-right":[-r,-1*(e-i+r)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=bm(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),L.setTransform(this._element,`${Sm[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${i} ${e}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const t=this._map.unproject(this._pos),e=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=t.distanceTo(this._lngLat)>20*e?"0.2":"1.0",this._opacityTimeout=null}),100))}getOffset(){return this._offset}setOffset(t){return this._offset=n.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new rt("dragstart"))),this.fire(new rt("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new rt("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Pm={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Fm=0,Nm=!1;const Um={maxWidth:100,unit:"metric"};function Zm(t,e,i){const r=i&&i.maxWidth||100,n=t._container.clientHeight/2,a=t.unproject([0,n]),o=t.unproject([r,n]),l=a.distanceTo(o);if(i&&"imperial"===i.unit){const i=3.2808*l;i>5280?Gm(e,r,i/5280,t._getUIString("ScaleControl.Miles")):Gm(e,r,i,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Gm(e,r,l/1852,t._getUIString("ScaleControl.NauticalMiles")):l>=1e3?Gm(e,r,l/1e3,t._getUIString("ScaleControl.Kilometers")):Gm(e,r,l,t._getUIString("ScaleControl.Meters"))}function Gm(t,e,i,r){const n=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i),e*i}(i);t.style.width=e*(n/i)+"px",t.innerHTML=`${n}&nbsp;${r}`}const $m={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Km(t){if(t){if("number"==typeof t){const e=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new n(0,0),top:new n(0,t),"top-left":new n(e,e),"top-right":new n(-e,e),bottom:new n(0,-t),"bottom-left":new n(e,-e),"bottom-right":new n(-e,-e),left:new n(t,0),right:new n(-t,0)}}if(t instanceof n||Array.isArray(t)){const e=n.convert(t);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:n.convert(t.center||[0,0]),top:n.convert(t.top||[0,0]),"top-left":n.convert(t["top-left"]||[0,0]),"top-right":n.convert(t["top-right"]||[0,0]),bottom:n.convert(t.bottom||[0,0]),"bottom-left":n.convert(t["bottom-left"]||[0,0]),"bottom-right":n.convert(t["bottom-right"]||[0,0]),left:n.convert(t.left||[0,0]),right:n.convert(t.right||[0,0])}}return Km(new n(0,0))}const Jm=t,tg={setRTLTextPlugin:function(t,e,i=!1){if(Fn===Ln||Fn===Pn||Fn===On)throw new Error("setRTLTextPlugin cannot be called multiple times.");Rn=F.resolveURL(t),Fn=Ln,kn=e,Nn(),i||Un()},getRTLTextPluginStatus:Vn,Map:class extends ff{constructor(t){var e;if(am.mark(tm.create),null!=(t=f({},gm,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new fm(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._interactive=t.interactive,this._cooperativeGestures=t.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new yf,this._controls=[],this._mapId=y(),this._locale=f({},om,t.locale),this._clickTolerance=t.clickTolerance,this._pixelRatio=null!==(e=t.pixelRatio)&&void 0!==e?e:devicePixelRatio,this.transformCameraUpdate=t.transformCameraUpdate,this._imageQueueHandle=tt.addThrottleControl((()=>this.isMoving())),this._requestManager=new Q(t.transformRequest),"string"==typeof t.container){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),_(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;this._resizeObserver=new ResizeObserver((e=>{t?this._trackResize&&this.resize(e)._update():t=!0})),this._resizeObserver.observe(this._container)}this.handlers=new df(this,t),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=t.hash&&new _m("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,f({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new _f({customAttribution:t.customAttribution})),t.maplibreLogo&&this.addControl(new gf,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new rt(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new rt(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new rt("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,e){if(void 0===e&&(e=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new st(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[e];return-1!==e.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new st(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(t);return e>-1&&this._controls.splice(e,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,i,r){return null==r&&this.terrain&&(r=this.transform.getElevation(i,this.terrain)),super.calculateCameraOptionsFromTo(t,e,i,r)}resize(t){var e;const i=this._containerDimensions(),r=i[0],n=i[1];this._resizeCanvas(r,n,this.getPixelRatio()),this.transform.resize(r,n),null===(e=this._requestedCameraState)||void 0===e||e.resize(r,n),this.painter.resize(r,n,this.getPixelRatio());const a=!this._moving;return a&&(this.stop(),this.fire(new rt("movestart",t)).fire(new rt("move",t))),this.fire(new rt("resize",t)),a&&this.fire(new rt("moveend",t)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){const[e,i]=this._containerDimensions();this._pixelRatio=t,this._resizeCanvas(e,i,t),this.painter.resize(e,i,t)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(ph.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(t){return this._cooperativeGestures=t,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(t){return this.transform.locationPoint(uh.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.pointLocation(n.convert(t),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let r=!1;const n=n=>{const a=this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[];a.length?r||(r=!0,i.call(this,new Im(t,this,n.originalEvent,{features:a}))):r=!1};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:()=>{r=!1}}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const n=n=>{(this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?r=!0:r&&(r=!1,i.call(this,new Im(t,this,n.originalEvent)))},a=e=>{r&&(r=!1,i.call(this,new Im(t,this,e.originalEvent)))};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:a}}}{const r=t=>{const r=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,i.call(this,t),delete t.features)};return{layer:e,listener:i,delegates:{[t]:r}}}}on(t,e,i){if(void 0===i)return super.on(t,e);const r=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const t in r.delegates)this.on(t,r.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);const r=this._createDelegatedListener(t,e,i);for(const t in r.delegates)this.once(t,r.delegates[t]);return this}off(t,e,i){return void 0===i?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(r=>{const n=this._delegatedListeners[t];for(let t=0;t<n.length;t++){const r=n[t];if(r.layer===e&&r.listener===i){for(const t in r.delegates)this.off(t,r.delegates[t]);return n.splice(t,1),this}}})(),this)}queryRenderedFeatures(t,e){if(!this.style)return[];let i;const r=t instanceof n||Array.isArray(t),a=r?t:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(r?{}:t)||{},a instanceof n||"number"==typeof a[0])i=[n.convert(a)];else{const t=n.convert(a[0]),e=n.convert(a[1]);i=[t,new n(e.x,t.y),e,new n(t.x,e.y),t]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(t,e){return!1!==(e=f({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(t,e)));const i=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new up(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,i):this.style.loadJSON(t,e,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new up(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,e){if("string"==typeof t){const i=this._requestManager.transformRequest(t,J.Style);U(i,((t,i)=>{t?this.fire(new st(t)):i&&this._updateDiff(i,e)}))}else"object"==typeof t&&this._updateDiff(t,e)}_updateDiff(t,e){try{this.style.setState(t,e)&&this._update(!0)}catch(i){S(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(t,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():S("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){const e=this.style&&this.style.sourceCaches[t];if(void 0!==e)return e.loaded();this.fire(new st(new Error(`There is no source with ID '${t}'`)))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const e=this.style.sourceCaches[t.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);for(const e in this.style._layers){const i=this.style._layers[e];"hillshade"===i.type&&i.source===t.source&&S("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Cf(this.painter,e,t),this.painter.renderToTexture=new Pf(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=e=>{"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId===t.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new rt("terrain",{terrain:t})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(t,e,{pixelRatio:i=1,sdf:r=!1,stretchX:n,stretchY:a,content:o}={}){if(this._lazyInitEmptyStyle(),e instanceof HTMLImageElement||P(e)){const{width:l,height:c,data:u}=F.getImageData(e);this.style.addImage(t,{data:new ao({width:l,height:c},u),pixelRatio:i,stretchX:n,stretchY:a,content:o,sdf:r,version:0})}else{if(void 0===e.width||void 0===e.height)return this.fire(new st(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:c,data:u}=e,h=e;this.style.addImage(t,{data:new ao({width:l,height:c},new Uint8Array(u)),pixelRatio:i,stretchX:n,stretchY:a,content:o,sdf:r,version:0,userImage:h}),h.onAdd&&h.onAdd(this,t)}}}updateImage(t,e){const i=this.style.getImage(t);if(!i)return this.fire(new st(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=e instanceof HTMLImageElement||P(e)?F.getImageData(e):e,{width:n,height:a,data:o}=r;if(void 0===n||void 0===a)return this.fire(new st(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(n!==i.data.width||a!==i.data.height)return this.fire(new st(new Error("The width and height of the updated image must be that same as the previous version of the image")));const l=!(e instanceof HTMLImageElement||P(e));i.data.replace(o,l),this.style.updateImage(t,i)}getImage(t){return this.style.getImage(t)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new st(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t,e){tt.getImage(this._requestManager.transformRequest(t,J.Image),e)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,r={}){return this.style.setPaintProperty(t,e,i,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,r={}){return this.style.setLayoutProperty(t,e,i,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,i,(t=>{t||this._update(!0)})),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,(t=>{t||this._update(!0)})),this}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=L.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions();this._resizeCanvas(i[0],i[1],this.getPixelRatio());const r=this._controlContainer=L.create("div","maplibregl-control-container",t),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{n[t]=L.create("div",`maplibregl-ctrl-${t} `,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(t){this._onCooperativeGesture(t,t[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=L.create("div","maplibregl-cooperative-gesture-screen",this._container);let t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${t}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){L.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(t,e,i){this._canvas.width=i*t,this._canvas.height=i*e,this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const t={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(i=>{e={requestedAttributes:t},i&&(e.statusMessage=i.statusMessage,e.type=i.type)}),{once:!0});const i=this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t);if(!i){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new um(i,this.transform),Z.testSupport(i)}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new rt("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new rt("webglcontextrestored",{originalEvent:t}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(t,e,i){return!e&&i<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,r=F.now();this.style.zoomHistory.update(t,r);const n=new us(t,{now:r,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),a=n.crossFadingFactor();1===a&&a===this._crossFadingFactor||(i=!0,this._crossFadingFactor=a),this.style.update(n)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new rt("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,am.mark(tm.load),this.fire(new rt("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new rt("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,am.mark(tm.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),tt.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),am.clearMetrics(),this._removed=!0,this.fire(new rt("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=F.frame((t=>{am.frame(t),this._frame=null,this._render(t)})))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return hm}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(t){this.options=f({},vm,t),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(_(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),L.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),L.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(_(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=L.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ff(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const i=L.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i}_setButtonTitle(t,e){const i=this._map._getUIString(`NavigationControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}},GeolocateControl:class extends nt{constructor(t){super(),this.options=f({},Pm,t),_(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(t){return this._map=t,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,e=!1){void 0===xm||e?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((e=>{xm="denied"!==e.state,t(xm)})).catch((()=>{xm=!!window.navigator.geolocation,t(xm)})):(xm=!!window.navigator.geolocation,t(xm)):t(xm)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Fm=0,Nm=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new rt("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new rt("geolocate",t)),this._finish()}}_updateCamera(t){const e=new uh(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=f({bearing:this._map.getBearing()},this.options.fitBoundsOptions),n=ph.fromLngLat(e,i);this._map.fitBounds(n,r,{geolocateSource:!0})}_updateMarker(t){if(t){const e=new uh(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.getBounds(),e=t.getSouthEast(),i=t.getNorthEast(),r=e.distanceTo(i),n=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Nm)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new rt("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){S("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $f(this._dotElement),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $f({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new rt("trackuserlocationend")))}))}}trigger(){if(!this._setup)return S("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new rt("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Fm--,Nm=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new rt("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new rt("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Fm++,Fm>1?(t={maximumAge:6e5,timeout:0},Nm=!0):(t=this.options.positionOptions,Nm=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:_f,LogoControl:gf,ScaleControl:class{constructor(t){this.options=f({},Um,t),_(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Zm(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,Zm(this._map,this._container,this.options)}},FullscreenControl:class extends nt{constructor(t={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:S("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new rt("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new rt("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(t){this.options=t,_(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends nt{constructor(t){super(),this.options=f(Object.create($m),t),_(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new rt("open")),this}isOpen(){return!!this._map}remove(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new rt("close")),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=uh.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=t;r=i.firstChild,r;)e.appendChild(r);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_update(t){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=L.create("div","maplibregl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((t=>this._container.classList.add(t))),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bm(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let i=this.options.anchor;const r=Km(this.options.offset);if(!i){const t=this._container.offsetWidth,n=this._container.offsetHeight;let a;a=e.y+r.bottom.y<n?["top"]:e.y>this._map.transform.height-n?["bottom"]:[],e.x<t/2?a.push("left"):e.x>this._map.transform.width-t/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}const n=e.add(r[i]).round();L.setTransform(this._container,`${Sm[i]} translate(${n.x}px,${n.y}px)`),Tm(this._container,i,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Wm);t&&t.focus()}_onClose(){this.remove()}},Marker:$f,Style:up,LngLat:uh,LngLatBounds:ph,Point:n,MercatorCoordinate:xh,Evented:nt,AJAXError:R,config:z,CanvasSource:Lh,GeoJSONSource:Mh,ImageSource:Ph,RasterDEMTileSource:Ch,RasterTileSource:wh,VectorTileSource:bh,VideoSource:Dh,prewarm:function(){Nu().acquire(Ou)},clearPrewarmedResources:function(){const t=ju;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ou),ju=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return Jm},get workerCount(){return Yh.workerCount},set workerCount(t){Yh.workerCount=t},get maxParallelImageRequests(){return z.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){z.MAX_PARALLEL_IMAGE_REQUESTS=t},get workerUrl(){return z.WORKER_URL},set workerUrl(t){z.WORKER_URL=t},addProtocol(t,e){z.REGISTERED_PROTOCOLS[t]=e},removeProtocol(t){delete z.REGISTERED_PROTOCOLS[t]}};return Qf.extend(tg,{isSafari:I,getPerformanceMetrics:am.getPerformanceMetrics}),tg}()},function(t,e,i){t.exports=i.p+"e3b1bd3256c6e2785c1c7786bf60a1a7.js"},function(t,e,i){t.exports=i.p+"c86dfb7f678440f25f72f0dd4ba5dd0d.js"},function(t,e,i){var r=i(104),n=i(585);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);r(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},function(t,e,i){(e=i(105)(!1)).push([t.i,".maplibregl-map{-webkit-tap-highlight-color:rgb(0 0 0/0);font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px #0000001a}@media (-ms-high-contrast:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:initial;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.maplibregl-ctrl-icon{background-color:initial}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:#0000000d}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23999' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (-ms-high-contrast:active){a.maplibregl-ctrl-logo{background-color:initial;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:#ffffff80;margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:initial;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:#ffffff80;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:#0000000d}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:#000000bf;text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:#ffffffbf;border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid #0000;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:initial;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:#0000000d}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px #0000001a;padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px #00000059;box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:#0006;color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}",""]),t.exports=e},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(i(587)),a=r(i(267)),o=r(i(243)),l=i(101),c=i(124);e.default=function(t,e,i){void 0===i&&(i={});for(var r=c.getGeom(t).coordinates,u=0,h=0;h<r.length&&!(e>=u&&h===r.length-1);h++){if(u>=e){var p=e-u;if(p){var d=n.default(r[h],r[h-1])-180;return a.default(r[h],p,d,i)}return l.point(r[h])}u+=o.default(r[h],r[h+1],i)}return l.point(r[r.length-1])}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(101),n=i(124);e.default=function t(e,i,a){if(void 0===a&&(a={}),!0===a.final)return function(e,i){var r=t(i,e);return(r+180)%360}(e,i);var o=n.getCoord(e),l=n.getCoord(i),c=r.degreesToRadians(o[0]),u=r.degreesToRadians(l[0]),h=r.degreesToRadians(o[1]),p=r.degreesToRadians(l[1]),d=Math.sin(u-c)*Math.cos(p),f=Math.cos(h)*Math.sin(p)-Math.sin(h)*Math.cos(p)*Math.cos(u-c);return r.radiansToDegrees(Math.atan2(d,f))}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(144),n=6378137;function a(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(o(t[i]))}return e}function o(t){var e,i,r,a,o,c,u=0,h=t.length;if(h>2){for(c=0;c<h;c++)c===h-2?(r=h-2,a=h-1,o=0):c===h-1?(r=h-1,a=0,o=1):(r=c,a=c+1,o=c+2),e=t[r],i=t[a],u+=(l(t[o][0])-l(e[0]))*Math.sin(l(i[1]));u=u*n*n/2}return u}function l(t){return t*Math.PI/180}e.default=function(t){return r.geomReduce(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return a(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=a(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(i(243)),a=i(144);e.default=function(t,e){return void 0===e&&(e={}),a.segmentReduce(t,(function(t,i){var r=i.geometry.coordinates;return t+n.default(r[0],r[1],e)}),0)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var r=i(18),n=i.n(r),a=(i(2),i(57)),o=i.n(a),l=i(14),c=i(4);const u={iconType:"questionInCircle",color:"gray"},h={binary:{iconType:"tokenBinary"},boolean:{iconType:"tokenBoolean"},conflict:{iconType:"warning",color:"euiColorVis9",shape:"square"},date:{iconType:"tokenDate"},date_range:{iconType:"tokenDate"},dense_vector:{iconType:"tokenVectorDense"},geo_point:{iconType:"tokenGeo"},geo_shape:{iconType:"tokenGeo"},ip:{iconType:"tokenIP"},ip_range:{iconType:"tokenIP"},flattened:{iconType:"tokenFlattened"},match_only_text:{iconType:"tokenString"},murmur3:{iconType:"tokenSearchType"},number:{iconType:"tokenNumber"},number_range:{iconType:"tokenNumber"},rank_feature:{iconType:"tokenRankFeature"},rank_features:{iconType:"tokenRankFeatures"},histogram:{iconType:"tokenHistogram"},_source:{iconType:"editorCodeBlock",color:"gray"},point:{iconType:"tokenShape"},shape:{iconType:"tokenShape"},sparse_vector:{iconType:"tokenVectorSparse"},string:{iconType:"tokenString"},text:{iconType:"tokenString"},keyword:{iconType:"tokenKeyword"},gauge:{iconType:"tokenMetricGauge"},counter:{iconType:"tokenMetricCounter"},nested:{iconType:"tokenNested"},version:{iconType:"tokenTag"}};function p({type:t,label:e,size:i="s",scripted:r,className:a,...p}){const d=h[t]||u;return Object(c.jsx)(l.EuiToken,n()({},d,{className:o()("kbnFieldIcon",a),"aria-label":e||t,title:e||t,size:i,fill:r?"dark":void 0},p))}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(53);const n=Object(r.memoize)((function(t){const e=t.trim();let i=e.split(/[* ]+/).map(r.escapeRegExp).join(".*");return e.includes(" ")&&(i=".*"+i+".*"),new RegExp(i.includes("*")?`^${i}$`:i,"i")})),a=({option:{name:t,label:e},searchValue:i})=>((t,e)=>{if(null==e||!e.trim())return!1;const i=n(e);return!!t.displayName&&i.test(t.displayName)||i.test(t.name)})({name:t||e,displayName:e},i)},,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));const r={maxWidth:550,avCharWidth:7,paddingsWidth:116},n=(t,e)=>t.reduce(((t,i)=>{const r=e.find((t=>i[t]));if(!r)return t;const n=i[r].length;return t>n?t:n}),0),a=t=>t.reduce(((t,e)=>t>e.length?t:e.length),0);function o(t,e,i){return function(t,e){const{maxWidth:i,avCharWidth:n,paddingsWidth:a,minWidth:o}={...r,...e},l=a+t*n;return o&&l<o?o:Math.min(l,i)}(e?n(t,e):a(t),i)}}])]);