/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[]).push([[8],{547:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(548);case"v8light":return n(550)}},548:function(e,t,n){var a=n(81),i=n(549);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},549:function(e,t,n){(t=n(82)(!1)).push([e.i,".lnsRowCompressedMargin+.lnsRowCompressedMargin{margin-top:8px}.lnsConfigPanelNoPadding{padding:0}.lnsConfigPanelDate__label{min-width:56px}.lnsConfigPanelAnnotations__addButton{margin-top:4px}.lnsConfigPanelAnnotations__fieldPicker{cursor:pointer}",""]),e.exports=t},550:function(e,t,n){var a=n(81),i=n(551);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},551:function(e,t,n){(t=n(82)(!1)).push([e.i,".lnsRowCompressedMargin+.lnsRowCompressedMargin{margin-top:8px}.lnsConfigPanelNoPadding{padding:0}.lnsConfigPanelDate__label{min-width:56px}.lnsConfigPanelAnnotations__addButton{margin-top:4px}.lnsConfigPanelAnnotations__fieldPicker{cursor:pointer}",""]),e.exports=t},552:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(553);case"v8light":return n(555)}},553:function(e,t,n){var a=n(81),i=n(554);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},554:function(e,t,n){(t=n(82)(!1)).push([e.i,'.lnsDimensionEditorSection{padding-bottom:16px;padding-top:16px}.lnsDimensionEditorSection:first-child{padding-top:0}.lnsDimensionEditorSection:first-child .lnsDimensionEditorSection__border{display:none}.lnsDimensionEditorSection__border{position:relative}.lnsDimensionEditorSection__border:before{border-top:1px solid #343741;content:"";left:-16px;position:absolute;right:-16px;top:-16px}.lnsDimensionEditorSection__heading{padding-bottom:16px}',""]),e.exports=t},555:function(e,t,n){var a=n(81),i=n(556);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},556:function(e,t,n){(t=n(82)(!1)).push([e.i,'.lnsDimensionEditorSection{padding-bottom:16px;padding-top:16px}.lnsDimensionEditorSection:first-child{padding-top:0}.lnsDimensionEditorSection:first-child .lnsDimensionEditorSection__border{display:none}.lnsDimensionEditorSection__border{position:relative}.lnsDimensionEditorSection__border:before{border-top:1px solid #d3dae6;content:"";left:-16px;position:absolute;right:-16px;top:-16px}.lnsDimensionEditorSection__heading{padding-bottom:16px}',""]),e.exports=t},686:function(e,t,n){"use strict";n.r(t),n.d(t,"idPrefix",(function(){return $})),n(547);var a=n(656),i=n(3),o=n.n(i),l=n(0),s=n(6),d=(n(552),n(4));const r=({children:e,title:t})=>Object(d.jsx)("div",{className:"lnsDimensionEditorSection"},Object(d.jsx)("div",{className:"lnsDimensionEditorSection__border"}),t&&Object(d.jsx)(s.EuiTitle,{size:"xxs",className:"lnsDimensionEditorSection__heading"},Object(d.jsx)("h3",null,t)),e);var u=n(668),p=n(649),c=n(654),m=n(662),b=n(655),f=n(650),y=n(148),g=n(20),j=n.n(g),x=n(101),C=n(44),h=n(45),v=n(114),_=n.n(v);const O=h.euiLightVars.euiColorAccent,S="#F04E981A",A=l.i18n.translate("eventAnnotationComponents.xyChart.defaultAnnotationLabel",{defaultMessage:"Event"}),F=l.i18n.translate("eventAnnotationComponents.xyChart.defaultRangeAnnotationLabel",{defaultMessage:"Event range"}),k=(e=O)=>_()(Object(s.transparentize)(e,.1)).hex().toUpperCase(),w=(e=S)=>_()(Object(s.transparentize)(e,1)).hex().toUpperCase();var E=n(147),N=n(29),M=n.n(N),D=n(628),T=n(665),I=n(690),P=n(664);const R=new Set(["string","boolean","number","ip","date"]);function q(e){return""!==e}const Y=Object(s.htmlIdGenerator)();function B({currentConfig:e,setConfig:t,dataView:n}){var r;const{hasFieldData:u}=Object(y.b)(),[p,c]=Object(i.useState)((null!==(r=e.extraFields)&&void 0!==r?r:[]).map((e=>({name:e,id:Y()})))),b=Object(i.useCallback)((n=>{c(n);let a=n.map((({name:e})=>e)).filter(q);a=a.length?a:void 0,M()(a,e.extraFields)||t({...e,extraFields:a})}),[t,e]),f=Object(d.jsx)(T.a,{className:"lnsConfigPanelAnnotations__addButton","data-test-subj":"lnsXY-annotation-tooltip-add_field",onClick:()=>{b([...p,{name:"",id:Y()}])},label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.addField",{defaultMessage:"Add field"}),isDisabled:p.length>=3});if(0===p.length)return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(s.EuiFlexItem,{grow:!0},Object(d.jsx)(s.EuiPanel,{color:"subdued",paddingSize:"s",className:"lnsConfigPanelAnnotations__noFieldsPrompt"},Object(d.jsx)(s.EuiText,{color:"subdued",size:"s",textAlign:"center"},l.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.noFields",{defaultMessage:"None selected"})))),f);const g=n.fields.filter(a.a).filter((({displayName:t,type:n})=>{var a;return t&&!(null!==(a=e.extraFields)&&void 0!==a&&a.includes(t))&&R.has(n)})).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:Object(D.a)(e)},exists:!!n.id&&u(n.id,e.name),compatible:!0,"data-test-subj":`lnsXY-annotation-tooltip-fieldOption-${e.name}`}))).sort(((e,t)=>e.label.localeCompare(t.label)));return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(I.a,{onDragEnd:e=>{b(e)},droppableId:"ANNOTATION_TOOLTIP_DROPPABLE_AREA",items:p,bgColor:"subdued"},p.map(((e,t,a)=>{const i=""===e.name||Boolean(n.getFieldByName(e.name));return Object(d.jsx)(I.b,{id:e.id,key:e.id,idx:t,onRemoveClick:()=>{b(a.filter(((e,n)=>n!==t)))},removeTitle:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.deleteButtonLabel",{defaultMessage:"Delete"}),isNotDraggable:a.length<2,Container:P.a,isInsidePanel:!0,"data-test-subj":`lnsXY-annotation-tooltip-${t}`},Object(d.jsx)(m.a,{compressed:!0,activeField:e.name?{label:e.name,value:{type:"field",field:e.name}}:void 0,options:g,onChoose:e=>{if(e&&n.getFieldByName(e.field)){const n=[...p];n[t]={name:e.field,id:Y()},b(n)}},fieldIsInvalid:!i,className:"lnsConfigPanelAnnotations__fieldPicker","data-test-subj":`lnsXY-annotation-tooltip-field-picker--${t}`,autoFocus:""===e.name}))}))),f)}const W=({annotation:e,onChange:t,getDefaultRangeEnd:n})=>{const a=Object(x.g)(e);return Object(d.jsx)(s.EuiFormRow,{display:"columnCompressed",className:"lnsRowCompressedMargin"},Object(d.jsx)(s.EuiSwitch,{"data-test-subj":"lns-xyAnnotation-rangeSwitch",label:Object(d.jsx)(s.EuiText,{size:"xs"},l.i18n.translate("eventAnnotationComponents.xyChart.applyAsRange",{defaultMessage:"Apply as range"})),checked:a,onChange:()=>{if(a){const n={type:"manual",key:{type:"point_in_time",timestamp:e.key.timestamp},id:e.id,label:e.label===F?A:e.label,color:w(e.color),isHidden:e.isHidden};t(n)}else if(e){const a={type:"manual",key:{type:"range",timestamp:e.key.timestamp,endTimestamp:n(e.key.timestamp)},id:e.id,label:e.label===A?F:e.label,color:k(e.color),isHidden:e.isHidden};t(a)}},compressed:!0}))},H=({value:e,label:t,prependLabel:n,onChange:a,calendarClassName:i,dataTestSubj:o="lnsXY_annotation_date_picker"})=>Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:t,className:"lnsRowCompressedMargin"},n?Object(d.jsx)(s.EuiFormControlLayout,{fullWidth:!0,className:"lnsConfigPanelNoPadding",prepend:Object(d.jsx)(s.EuiFormLabel,{className:"lnsConfigPanelDate__label"},n)},Object(d.jsx)(s.EuiDatePicker,{calendarClassName:i,fullWidth:!0,showTimeSelect:!0,selected:e,onChange:a,dateFormat:"MMM D, YYYY @ HH:mm:ss.SSS","data-test-subj":o})):Object(d.jsx)(s.EuiDatePicker,{calendarClassName:i,fullWidth:!0,showTimeSelect:!0,selected:e,onChange:a,dateFormat:"MMM D, YYYY @ HH:mm:ss.SSS","data-test-subj":o})),L=({annotation:e,onChange:t,getDefaultRangeEnd:n,calendarClassName:a})=>{const i=Object(x.g)(e);return Object(d.jsx)(o.a.Fragment,null,i?Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(H,{dataTestSubj:"lns-xyAnnotation-fromTime",calendarClassName:a,prependLabel:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.from",{defaultMessage:"From"}),value:j()(null==e?void 0:e.key.timestamp),onChange:n=>{if(n){const a=j()(null==e?void 0:e.key.endTimestamp).valueOf();if(a<n.valueOf()){const i=a-j()(null==e?void 0:e.key.timestamp).valueOf();t({key:{...(null==e?void 0:e.key)||{type:"range"},timestamp:n.toISOString(),endTimestamp:j()(n.valueOf()+i).toISOString()}})}else t({key:{...(null==e?void 0:e.key)||{type:"range"},timestamp:n.toISOString()}})}},label:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate",{defaultMessage:"Annotation date"})}),Object(d.jsx)(H,{dataTestSubj:"lns-xyAnnotation-toTime",calendarClassName:a,prependLabel:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.to",{defaultMessage:"To"}),value:j()(null==e?void 0:e.key.endTimestamp),onChange:n=>{if(n){const a=j()(null==e?void 0:e.key.timestamp).valueOf();if(a>n.valueOf()){const i=j()(null==e?void 0:e.key.endTimestamp).valueOf()-a;t({key:{...(null==e?void 0:e.key)||{type:"range"},endTimestamp:n.toISOString(),timestamp:j()(n.valueOf()-i).toISOString()}})}else t({key:{...(null==e?void 0:e.key)||{type:"range"},endTimestamp:n.toISOString()}})}}})):Object(d.jsx)(H,{dataTestSubj:"lns-xyAnnotation-time",calendarClassName:a,label:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate",{defaultMessage:"Annotation date"}),value:j()(null==e?void 0:e.key.timestamp),onChange:n=>{n&&t({key:{...(null==e?void 0:e.key)||{type:"point_in_time"},timestamp:n.toISOString()}})}}),Object(d.jsx)(W,{annotation:e,onChange:t,getDefaultRangeEnd:n}))};var X=n(667);const V={query:"",language:"kuery"},z=({annotation:e,dataView:t,onChange:n,queryInputShouldOpen:i,queryInputServices:r,appName:u})=>{var p,c;const{hasFieldData:b}=Object(y.b)(),f=t.fields.filter(a.a).filter((e=>"date"===e.type&&e.displayName)).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:e.type},exists:!!t.id&&b(t.id,e.name),compatible:!0,"data-test-subj":`lns-fieldOption-${e.name}`}))),g=(null==e?void 0:e.timeField)||t.timeFieldName||(null===(p=f[0])||void 0===p?void 0:p.value.field),j=!g||Boolean(t.getFieldByName(g));return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(s.EuiFormRow,{hasChildLabel:!0,display:"rowCompressed",className:"lnsRowCompressedMargin",fullWidth:!0,label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.queryInput",{defaultMessage:"Annotation query"})},Object(d.jsx)(X.a,{"data-test-subj":"annotation-query-based-query-input",initiallyOpen:i,label:"",inputFilter:null!==(c=null==e?void 0:e.filter)&&void 0!==c?c:V,onChange:e=>{n({filter:{type:"kibana_query",...e}})},dataView:t,appName:u,queryInputServices:r})),Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.queryField",{defaultMessage:"Target date field"})},Object(d.jsx)(m.a,{compressed:!0,options:f,activeField:g?{label:g,value:{type:"field",field:g}}:void 0,onChoose:function(e){e&&n({timeField:e.field})},fieldIsInvalid:!j,"data-test-subj":"lnsXY-annotation-query-based-field-picker"})))},$=Object(s.htmlIdGenerator)()(),G=({label:e,"data-test-subj":t,value:n,onChange:a})=>Object(d.jsx)(s.EuiFormRow,{label:e,display:"columnCompressedSwitch",fullWidth:!0},Object(d.jsx)(s.EuiSwitch,{compressed:!0,label:e,showLabel:!1,"data-test-subj":t,checked:n,onChange:a}));t.default=({annotation:e,onAnnotationChange:t,dataView:n,getDefaultRangeEnd:g,calendarClassName:h,queryInputServices:v,appName:_})=>{const{hasFieldData:k}=Object(y.b)(),N=Object(x.f)(e),M=Object(x.g)(e),[D,T]=o.a.useState(!1);Object(i.useEffect)((()=>{T(!N)}),[N]);const I=Object(i.useCallback)((n=>{var a;n&&t((a={...e,...n},Object(x.g)(a)?Object(C.pick)(a,["type","label","key","id","isHidden","color","outside"]):Object(x.f)(a)?Object(C.pick)(a,["type","id","label","key","timeField","isHidden","lineStyle","lineWidth","color","icon","textVisibility","textField","filter","extraFields"]):Object(C.pick)(a,["type","id","label","key","isHidden","lineStyle","lineWidth","color","icon","textVisibility"])))}),[e,t]),P=Object(i.useMemo)((()=>{if(!M)return{lineStyle:e.lineStyle,lineWidth:e.lineWidth}}),[e,M]);return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(r,{title:l.i18n.translate("eventAnnotationComponents.xyChart.placement",{defaultMessage:"Placement"})},Object(d.jsx)(s.EuiFormRow,{label:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.placementType",{defaultMessage:"Placement type"}),display:"rowCompressed",fullWidth:!0},Object(d.jsx)(s.EuiButtonGroup,{legend:l.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.placementType",{defaultMessage:"Placement type"}),"data-test-subj":"lns-xyAnnotation-placementType",name:"placementType",buttonSize:"compressed",options:[{id:"lens_xyChart_annotation_manual",label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.manual",{defaultMessage:"Static date"}),"data-test-subj":"lnsXY_annotation_manual"},{id:"lens_xyChart_annotation_query",label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.query",{defaultMessage:"Custom query"}),"data-test-subj":"lnsXY_annotation_query"}],idSelected:`lens_xyChart_annotation_${null==e?void 0:e.type}`,onChange:t=>{const i=t.replace("lens_xyChart_annotation_","");if((null==e?void 0:e.type)!==i){if("query"===i){var o,l;const t=Object(x.g)(e)?{label:e.label===F?A:e.label,color:w(e.color)}:{};return I({type:i,timeField:null!==(o=n.timeFieldName||(null===(l=n.fields.filter(a.a).find((({type:e})=>"date"===e)))||void 0===l?void 0:l.displayName))&&void 0!==o?o:"",key:{type:"point_in_time"},...t})}return I({type:i,key:{type:"point_in_time",timestamp:j()().toISOString()}})}},isFullWidth:!0})),N?Object(d.jsx)(z,{annotation:e,onChange:I,dataView:n,queryInputShouldOpen:D,queryInputServices:v,appName:_}):Object(d.jsx)(L,{annotation:e,onChange:I,getDefaultRangeEnd:g,calendarClassName:h})),Object(d.jsx)(r,{title:l.i18n.translate("eventAnnotationComponents.xyChart.appearance",{defaultMessage:"Appearance"})},Object(d.jsx)(u.a,{value:(null==e?void 0:e.label)||A,defaultValue:A,onChange:e=>{I({label:e})}}),!M&&Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(p.b,{currentIcon:e.icon,setIcon:e=>I({icon:e}),defaultIcon:"triangle",customIconSet:E.a}),Object(d.jsx)(c.a,{idPrefix:$,setConfig:I,currentConfig:e,isQueryBased:N},(t=>{if("field"!==t)return null;const i=n.fields.filter(a.a).filter((({displayName:e,type:t})=>e&&"document"!==t)).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:e.type},exists:k(n.id,e.name),compatible:!0,"data-test-subj":`lnsXY-annotation-fieldOption-${e.name}`}))),l=e.textField,r=!l||Boolean(n.getFieldByName(l));return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(s.EuiSpacer,{size:"xs"}),Object(d.jsx)(m.a,{activeField:l?{label:l,value:{type:"field",field:l}}:void 0,options:i,onChoose:function(e){e&&I({textField:e.field,textVisibility:!0})},fieldIsInvalid:!r,"data-test-subj":"lnsXY-annotation-query-based-text-decoration-field-picker",autoFocus:!l}))})),Object(d.jsx)(b.a,{idPrefix:$,setConfig:I,currentConfig:P})),M&&Object(d.jsx)(s.EuiFormRow,{label:l.i18n.translate("eventAnnotationComponents.xyChart.fillStyle",{defaultMessage:"Fill"}),display:"columnCompressed",fullWidth:!0},Object(d.jsx)(s.EuiButtonGroup,{legend:l.i18n.translate("eventAnnotationComponents.xyChart.fillStyle",{defaultMessage:"Fill"}),"data-test-subj":"lns-xyAnnotation-fillStyle",name:"fillStyle",buttonSize:"compressed",options:[{id:"lens_xyChart_fillStyle_inside",label:l.i18n.translate("eventAnnotationComponents.xyChart.fillStyle.inside",{defaultMessage:"Inside"}),"data-test-subj":"lnsXY_fillStyle_inside"},{id:"lens_xyChart_fillStyle_outside",label:l.i18n.translate("eventAnnotationComponents.xyChart.fillStyle.outside",{defaultMessage:"Outside"}),"data-test-subj":"lnsXY_fillStyle_inside"}],idSelected:"lens_xyChart_fillStyle_"+(Boolean(null==e?void 0:e.outside)?"outside":"inside"),onChange:e=>{I({outside:"lens_xyChart_fillStyle_outside"===e})},isFullWidth:!0})),Object(d.jsx)(f.a,{overwriteColor:e.color,isClearable:!1,defaultColor:M?S:O,showAlpha:M,setConfig:I,disableHelpTooltip:!0,label:l.i18n.translate("eventAnnotationComponents.xyChart.lineColor.label",{defaultMessage:"Color"})}),Object(d.jsx)(G,{label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.hide",{defaultMessage:"Hide annotation"}),"data-test-subj":"lns-annotations-hide-annotation",value:Boolean(e.isHidden),onChange:e=>I({isHidden:e.target.checked})})),N&&e&&Object(d.jsx)(r,{title:l.i18n.translate("eventAnnotationComponents.xyChart.tooltip",{defaultMessage:"Tooltip"})},Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",className:"lnsRowCompressedMargin",fullWidth:!0,label:l.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip",{defaultMessage:"Show additional fields"})},Object(d.jsx)(B,{currentConfig:e,setConfig:I,dataView:n}))))}}}]);