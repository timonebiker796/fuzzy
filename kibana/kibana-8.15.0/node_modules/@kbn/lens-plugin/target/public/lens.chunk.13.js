/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[]).push([[13],{545:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(3),n=a(546);t.default=function(e,t){var a=n.useFirstMountState();o.useEffect((function(){if(!a)return e()}),t)}},546:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var o=a(3);t.useFirstMountState=function(){var e=o.useRef(!0);return e.current?(e.current=!1,!0):e.current}},684:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a(3),l=a.n(n),s=a(135),i=a.n(s),r=a(4),c=a(6),u=a(15),d=a.n(u),p=a(265);function g({palettes:e,activePalette:t,setPalette:a,showCustomPalette:o,showDynamicColorOnly:n,...l}){const s=e.getAll().filter((({internal:e,canDynamicColoring:t})=>n?t:!e)).map((({id:e,title:a,getCategoricalColors:o})=>{var n;const l=o((null==t||null===(n=t.params)||void 0===n?void 0:n.steps)||p.c,e===(null==t?void 0:t.name)?null==t?void 0:t.params:void 0);return{value:e,title:a,type:p.j,palette:l,"data-test-subj":`${e}-palette`}}));return o&&s.push(function(e,t){var a;const{id:o,title:n}=e.get(p.b);if(t&&t.name!==p.b){const a=e.get(t.name);if(a){var l,s;const e=a.getCategoricalColors((null==t||null===(l=t.params)||void 0===l?void 0:l.steps)||p.c,null==t?void 0:t.params),i=null!==(s=t.params)&&void 0!==s&&s.reverse?e.reverse():e;return{value:o,title:n,type:p.j,palette:i,"data-test-subj":"custom-palette"}}}return null!=t&&null!==(a=t.params)&&void 0!==a&&a.stops?{value:o,title:n,type:p.j,"data-test-subj":"custom-palette",palette:(t.params.colorStops||t.params.stops).map((e=>e.color))}:{value:o,title:n,type:"text","data-test-subj":"custom-palette"}}(e,t)),Object(r.jsx)(c.EuiColorPalettePicker,d()({fullWidth:!0,"data-test-subj":"lns-palettePicker",compressed:!0,palettes:s,onChange:e=>{a({type:"palette",name:e})},valueOfSelected:(null==t?void 0:t.name)||p.h,selectionDisplay:"palette"},l))}var m=a(647);const b=e=>Object(r.jsx)("svg",d()({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},e),Object(r.jsx)("path",{d:"M2.586 9.414a2 2 0 0 1 2.809-2.847l.601.679 1.336-1.508-.462-.522a4 4 0 1 0 0 5.569l-1.5-1.328a2 2 0 0 1-2.784-.043Z"}),Object(r.jsx)("path",{d:"m5.373 9.458 1.497 1.326 3.757-4.242.002.001a2 2 0 1 1-.024 2.89l-.601-.679-1.336 1.508.462.522a4 4 0 1 0 0-5.569L5.373 9.459Z"})),v=e=>Object(r.jsx)("svg",d()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(r.jsx)("path",{d:"M8 0a.5.5 0 0 1 .384.18l2.5 3A.5.5 0 0 1 10.5 4h-5a.5.5 0 0 1-.384-.82l2.5-3A.5.5 0 0 1 8 0ZM.916 5.223A.5.5 0 0 0 0 5.5v5a.5.5 0 0 0 1 0V7.151l1.084 1.626a.5.5 0 0 0 .832 0L4 7.151V10.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 7.599.916 5.223Z"}),Object(r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 5h-.545l-.098.006a3.572 3.572 0 0 0-1.33.36 2.693 2.693 0 0 0-1.052.911C6.18 6.72 6 7.287 6 8v2.5a.5.5 0 0 0 1 0V9h2v1.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Zm-.5.5V5v.5ZM7 8h2V6h-.011a2.57 2.57 0 0 0-.297.032c-.202.034-.463.1-.718.228a1.695 1.695 0 0 0-.667.572C7.133 7.092 7 7.462 7 8Z"}),Object(r.jsx)("path",{d:"M11.188 5.11a.5.5 0 0 1 .702.078L13.5 7.2l1.61-2.012a.5.5 0 1 1 .78.624L14.14 8l1.75 2.188a.5.5 0 1 1-.78.624L13.5 8.8l-1.61 2.012a.5.5 0 0 1-.78-.624L12.86 8l-1.75-2.188a.5.5 0 0 1 .078-.702Z"})),j=e=>Object(r.jsx)("svg",d()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(r.jsx)("path",{d:"M10.367.018a.5.5 0 0 1 .562.225L13 3.695V.5a.5.5 0 0 1 1 0v5a.5.5 0 0 1-.929.257L11 2.305V5.5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .367-.482ZM.916.223A.5.5 0 0 0 0 .5v5a.5.5 0 0 0 1 0V2.151l1.084 1.626a.5.5 0 0 0 .832 0L4 2.151V5.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 2.599.916.223ZM7 11a.5.5 0 0 0 .384-.18l2.5-3A.5.5 0 0 0 9.5 7h-5a.5.5 0 0 0-.384.82l2.5 3A.5.5 0 0 0 7 11ZM6.5 0a.5.5 0 0 0 0 1H7v4h-.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H8V1h.5a.5.5 0 0 0 0-1h-2Z"})),y=e=>"end"===e,h=e=>{const t=e[e.length-1];return[...e,{start:t.end,color:t.color,end:void 0}].sort((({start:e},{start:t})=>Number(e)-Number(t))).reduce(((e,a,o,n)=>{let l=a.color;return o===n.length-2&&n[o+1].start!==t.end&&(l=n[o+1].color),o!==n.length-1&&e.push({color:l,start:a.start,end:n[o+1].start}),e}),[])},x=({isPercentage:e,isUpper:t,isAuto:a})=>({representation:t?e?o.i18n.translate("coloring.dynamicColoring.customPalette.maxValuePlaceholderPercentage",{defaultMessage:"100"}):o.i18n.translate("coloring.dynamicColoring.customPalette.maxValuePlaceholder",{defaultMessage:"No max."}):e?o.i18n.translate("coloring.dynamicColoring.customPalette.minValuePlaceholderPercentage",{defaultMessage:"0"}):o.i18n.translate("coloring.dynamicColoring.customPalette.minValuePlaceholder",{defaultMessage:"No min."}),actionDescription:t?e?o.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMaxValuePercentage",{defaultMessage:"Use maximum percentage"}):o.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMaxValue",{defaultMessage:"No maximum value"}):e?o.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMinValuePercentage",{defaultMessage:"Use minimum percentage"}):o.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMinValue",{defaultMessage:"No minimum value"}),icon:e?t?v:j:b});function O(e,t,a,o,n){var l,s,i,r,c;const u=null!==(l=null!=n?n:null===(s=t.params)||void 0===s?void 0:s.continuity)&&void 0!==l?l:p.d;let d=a;a.some(((e,t)=>t!==a.length-1&&e.start>a[t+1].start))&&(d=h(a));const{max:g,colorStops:b}=((e,t)=>{const a=Object(m.c)(t)?Number.NEGATIVE_INFINITY:e[0].start,o=Object(m.b)(t)?Number.POSITIVE_INFINITY:e[e.length-1].end;return{min:a,max:o,colorStops:e.map(((e,t)=>({color:e.color,stop:0===t?a:e.start})))}})(d,u),v=function(e,t,a,o){var n;if((null==t||null===(n=t.params)||void 0===n?void 0:n.name)===p.b){const n=Object(m.g)(e,{steps:p.c,...t.params,...a},{dataBounds:o});return P(t,{...a,stops:n})}const l={steps:p.c,...t.params,...a,name:p.b},s=Object(m.g)(e,l,{prevPalette:l.colorStops?void 0:t.name,dataBounds:o});return P({name:p.b,type:"palette"},{...l,stops:s})}(e,t,{continuity:u,colorStops:b,steps:(null===(i=t.params)||void 0===i?void 0:i.steps)||p.c,reverse:null===(r=t.params)||void 0===r?void 0:r.reverse,rangeMin:null===(c=b[0])||void 0===c?void 0:c.stop,rangeMax:g},o);return{activePalette:v,colorRanges:a}}function C(e,t,a){var o;return{colorRanges:I(e,(null===(o=t.params)||void 0===o?void 0:o.colorStops)||[],t,a),activePalette:t}}function P(e,t){return{...e,params:{...e.params,...t}}}function f(e,t,a,o){var n;if((null==a?void 0:a.name)===p.b&&null!=t&&t.length)return t;let l=Object(m.g)(e,{...null==a?void 0:a.params},{dataBounds:o,mapFromMinValue:!0,defaultPaletteName:a.name});return null!=a&&null!==(n=a.params)&&void 0!==n&&n.reverse&&(l=Object(m.h)(l)),l}function I(e,t,a,o){var n;const{continuity:l=p.d,rangeType:s=p.i}=null!==(n=a.params)&&void 0!==n?n:{},{min:i,max:r}=Object(m.e)(s,o);return f(e,t||[],a,o).map(((e,t,o)=>{var n,s,c,u,d,p,g;const b=0===t,v=t===o.length-1;return{color:e.color,start:b&&Object(m.c)(l)?Number.NEGATIVE_INFINITY:null!==(n=null!==(s=e.stop)&&void 0!==s?s:null===(c=a.params)||void 0===c?void 0:c.rangeMin)&&void 0!==n?n:i,end:v&&Object(m.b)(l)?Number.POSITIVE_INFINITY:null!==(u=null!==(d=null===(p=o[t+1])||void 0===p?void 0:p.stop)&&void 0!==d?d:null===(g=a.params)||void 0===g?void 0:g.rangeMax)&&void 0!==u?u:r}}))}const M=l.a.createContext({});var w=a(44),N=a(11),T=a(648);const E=e=>Object(r.jsx)("svg",d()({width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(r.jsx)("path",{d:"M4 .5a.5.5 0 0 1 1 0v11a.5.5 0 0 1-1 0V.5ZM0 3a1 1 0 0 1 1-1h2v8H1a1 1 0 0 1-1-1V3ZM10.5 0a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 1 0V.5a.5.5 0 0 0-.5-.5ZM6 2h3v8H6V2ZM14 2h-2v8h2a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Z"}));function V({dispatch:e,shouldDisableAdd:t=!1,shouldDisableReverse:a=!1,shouldDisableDistribute:l=!1}){const{dataBounds:s,palettes:i}=Object(n.useContext)(M),u=Object(n.useCallback)((()=>{e({type:"addColorRange",payload:{dataBounds:s,palettes:i}})}),[s,e,i]),d=Object(n.useCallback)((()=>{e({type:"reversePalette",payload:{dataBounds:s,palettes:i}})}),[e,s,i]),p=Object(n.useCallback)((()=>{e({type:"distributeEqually",payload:{dataBounds:s,palettes:i}})}),[s,e,i]),g=o.i18n.translate("coloring.dynamicColoring.customPalette.oneColorRange",{defaultMessage:"Requires more than one color"});return Object(r.jsx)(c.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"m",wrap:!0},Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(T.a,{tooltipContent:o.i18n.translate("coloring.dynamicColoring.customPalette.maximumStepsApplied",{defaultMessage:"You've applied the maximum number of steps"}),condition:t,position:"top",delay:"regular"},Object(r.jsx)(c.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_addColor",iconType:"plusInCircle",color:"primary","aria-label":o.i18n.translate("coloring.dynamicColoring.customPalette.addColorAriaLabel",{defaultMessage:"Add color"}),size:"xs",flush:"left",disabled:t,onClick:u},Object(r.jsx)(N.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.addColor",defaultMessage:"Add color"})))),Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(T.a,{tooltipContent:g,condition:a,position:"top",delay:"regular"},Object(r.jsx)(c.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_reverseColors",iconType:"sortable",color:"primary","aria-label":o.i18n.translate("coloring.dynamicColoring.customPaletteAriaLabel",{defaultMessage:"Reverse colors"}),size:"xs",flush:"left",onClick:d,disabled:a},Object(r.jsx)(N.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.reverseColors",defaultMessage:"Reverse colors"})))),Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(T.a,{tooltipContent:g,condition:l,position:"top",delay:"regular"},Object(r.jsx)(c.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_distributeValues",iconType:E,color:"primary","aria-label":o.i18n.translate("coloring.dynamicColoring.customPalette.distributeValuesAriaLabel",{defaultMessage:"Distribute values"}),size:"xs",flush:"left",disabled:l,onClick:p},Object(r.jsx)(N.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.distributeValues",defaultMessage:"Distribute values"})))))}var _=a(545),B=a.n(_),R=a(186);const S=e=>Object(r.jsx)("svg",d()({width:"24",height:"24",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),Object(r.jsx)("path",{d:"M6 .5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5V8h4V6.5a.5.5 0 0 1 .82-.384l3 2.5a.5.5 0 0 1 0 .768l-3 2.5A.5.5 0 0 1 12 11.5V10H6.5a.5.5 0 0 1-.5-.5v-9Z"})),F=(e,t)=>{switch(t){case"none":return e?"above":"below";case"above":return e?"none":"all";case"below":return e?"all":"none";case"all":return e?"below":"above"}};function A({index:e,dispatch:t}){const{dataBounds:a,palettes:l}=Object(n.useContext)(M),s=Object(n.useCallback)((()=>{t({type:"deleteColorRange",payload:{index:e,dataBounds:a,palettes:l}})}),[t,e,a,l]),i=o.i18n.translate("coloring.dynamicColoring.customPalette.deleteButtonAriaLabel",{defaultMessage:"Delete"});return Object(r.jsx)(c.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":i,title:i,onClick:s,"data-test-subj":`lnsPalettePanel_dynamicColoring_removeColorRange_${e}`})}function k({index:e,continuity:t,dispatch:a,accessor:l}){const{dataBounds:s,palettes:i,disableSwitchingContinuity:u}=Object(n.useContext)(M),d=y(l),p=Object(n.useCallback)((()=>{const e=F(d,t);a({type:"updateContinuity",payload:{isLast:d,continuity:e,dataBounds:s,palettes:i}})}),[d,a,t,s,i]);let g=d?o.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMinValue",{defaultMessage:"Set custom maximum value"}):o.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMaxValue",{defaultMessage:"Set custom minimum value"});return u&&(g=o.i18n.translate("coloring.dynamicColoring.customPalette.disallowedEditMinMaxValues",{defaultMessage:"You cannot set custom value for current configuration"})),Object(r.jsx)(T.a,{tooltipContent:g,condition:!0,position:"top",delay:"regular"},Object(r.jsx)(c.EuiButtonIcon,{iconType:"pencil","aria-label":g,disabled:u,onClick:p,"data-test-subj":`lnsPalettePanel_dynamicColoring_editValue_${e}`}))}function L({continuity:e,dispatch:t,accessor:a,tooltipContent:o,iconFactory:l}){const{dataBounds:s,palettes:i}=Object(n.useContext)(M),u=y(a),d=Object(n.useCallback)((()=>{const a=F(u,e);t({type:"updateContinuity",payload:{isLast:u,continuity:a,dataBounds:s,palettes:i}})}),[e,s,t,u,i]);return Object(r.jsx)(T.a,{tooltipContent:o,condition:!0,position:"top",delay:"regular"},Object(r.jsx)(c.EuiButtonIcon,{iconType:l,"aria-label":o,onClick:d,"data-test-subj":"lnsPalettePanel_dynamicColoring_autoDetect_"+(u?"maximum":"minimum")}))}const D=(e,t,a)=>!t&&e>0?"value":(t?m.b:m.c)(a)?"auto":"edit",Y=e=>"value"===e?A:"edit"===e?L:k,Z=(e,t)=>{const a=[];return"percent"===e&&a.push("%"),a};function z({accessor:e,index:t,colorRange:a,rangeType:l,colorRanges:s,validation:i,continuity:u,dispatch:d}){var p;const{dataBounds:g,palettes:m}=Object(n.useContext)(M),[b,v]=Object(n.useState)(!1),[j,h]=Object(n.useState)(a[e]),O=y(e),C=D(t,O,u),P="auto"===C,f=Object(R.c)(a.color),I=Y(C),w=null===(p=null==i?void 0:i.isValid)||void 0===p||p,{euiTheme:N}=Object(c.useEuiTheme)(),T=Object(n.useCallback)((e=>{var o,n,l,i,r,c,u;const p=null!==(o=null===(n=s[t-1])||void 0===n?void 0:n.start)&&void 0!==o?o:Number.NEGATIVE_INFINITY,v=null!==(l=null===(i=s[t+1])||void 0===i?void 0:i.start)&&void 0!==l?l:Number.POSITIVE_INFINITY,j=null!==(r=null===(c=s[s.length-1])||void 0===c?void 0:c.end)&&void 0!==r?r:Number.POSITIVE_INFINITY,y=a.start>v||p>a.start||!O&&a.start>j,h=(null===(u=e.currentTarget)||void 0===u?void 0:u.contains(e.relatedTarget))||b;y&&!h&&d({type:"sortColorRanges",payload:{dataBounds:g,palettes:m}})}),[a.start,s,d,t,b,g,m,O]),E=Object(n.useCallback)((({target:{value:a}})=>{h(a),d({type:"updateValue",payload:{index:t,value:a,accessor:e,dataBounds:g,palettes:m}})}),[d,t,e,g,m]),V=Object(n.useCallback)((e=>{d({type:"updateColor",payload:{index:t,color:e,dataBounds:g,palettes:m}})}),[d,t,g,m]);B()((()=>{Number.isNaN(a[e])||a[e]===j||h(a[e])}),[j,a,e]);const _=o.i18n.translate("coloring.dynamicColoring.customPalette.selectNewColor",{defaultMessage:"Select a new color"}),F=Object(n.useMemo)((()=>Object(r.css)("display:block;min-width:",N.size.xl,";text-align:center;","")),[N.size.xl]),A=x({isPercentage:"percent"===l,isUpper:O,isAuto:"auto"===C});return Object(r.jsx)(c.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},Object(r.jsx)(c.EuiFlexItem,{grow:!1,css:O?F:null},O?Object(r.jsx)(c.EuiIcon,{type:S,size:"m",color:N.colors.disabled}):Object(r.jsx)(c.EuiColorPicker,{onChange:V,button:f?Object(r.jsx)(c.EuiColorPickerSwatch,{color:a.color,"aria-label":_,style:{width:N.size.xl,height:N.size.xl}}):Object(r.jsx)(c.EuiButtonIcon,{color:"danger",iconType:"stopSlash",iconSize:"l","aria-label":_}),secondaryInputDisplay:"top",color:a.color,showAlpha:!0,onFocus:()=>v(!0),onBlur:()=>{v(!1)},isInvalid:!f})),Object(r.jsx)(c.EuiFlexItem,{grow:!0},Object(r.jsx)(c.EuiFieldNumber,{compressed:!0,fullWidth:!0,isInvalid:!w,value:"auto"!==C&&void 0!==j&&isFinite(j)?j:"",disabled:P,onChange:E,placeholder:"auto"===C?A.representation:"",append:Z(l,C),onBlur:T,"data-test-subj":`lnsPalettePanel_dynamicColoring_range_value_${t}`,prepend:Object(r.jsx)("span",{className:"euiFormLabel"},O?"≤":"≥"),"aria-label":o.i18n.translate("coloring.dynamicColoring.customPalette.rangeAriaLabel",{defaultMessage:"Range {index}",values:{index:t+1}}),step:"any"})),I?Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(I,{index:t,continuity:u,rangeType:l,colorRanges:s,dispatch:d,tooltipContent:A.actionDescription,iconFactory:A.icon,accessor:e})):null)}const G=(e,t,a)=>{const o=[],n=e[t];return Number.isNaN(n)&&o.push("invalidValue"),"end"===t?e.start>e.end&&o.push("greaterThanMaxValue"):Object(R.c)(e.color)||o.push("invalidColor"),a&&![-1/0,1/0].includes(n)&&(n<0||n>100)&&o.push("percentOutOfBounds"),{isValid:!o.length,errors:o}},$=(e,t)=>({...e.reduce(((e,a,o)=>({...e,[o]:G(a,"start",t)})),{}),last:G(e[e.length-1],"end",t)});function H({colorRanges:e,paletteConfiguration:t,showExtraActions:a,dispatch:l}){var s,i;const[u,d]=Object(n.useState)({}),g=e[e.length-1],m=(e=>Array.from(new Set(Object.values(e).map((e=>e.errors)).flat().map((e=>{switch(e){case"invalidColor":case"invalidValue":return o.i18n.translate("coloring.dynamicColoring.customPalette.invalidValueOrColor",{defaultMessage:"At least one color range contains the wrong value or color"});case"greaterThanMaxValue":return o.i18n.translate("coloring.dynamicColoring.customPalette.invalidMaxValue",{defaultMessage:"Maximum value must be greater than preceding values"});case"percentOutOfBounds":return o.i18n.translate("coloring.dynamicColoring.customPalette.invalidPercentValue",{defaultMessage:"Percent values must be between 0 and 100"});default:return""}})))))(u),b=null!==(s=null==t?void 0:t.continuity)&&void 0!==s?s:p.d,v=null!==(i=null==t?void 0:t.rangeType)&&void 0!==i?i:p.i;return Object(n.useEffect)((()=>{d($(e,"percent"===v))}),[e,v]),Object(r.jsx)(c.EuiFlexGroup,{"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_color_ranges",direction:"column",gutterSize:"s"},e.map(((t,a)=>{var o,n;return Object(r.jsx)(c.EuiFlexItem,{grow:!1,key:`${null!==(o=null!==(n=t.end)&&void 0!==n?n:0+t.start)&&void 0!==o?o:0}${a}`},Object(r.jsx)(z,{colorRange:t,dispatch:l,colorRanges:e,continuity:b,rangeType:v,index:a,validation:u[a],accessor:"start"}))})),g?Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(z,{colorRange:g,dispatch:l,colorRanges:e,continuity:b,rangeType:v,index:e.length-1,validation:u.last,accessor:"end"})):null,Object(r.jsx)(c.EuiFlexItem,{grow:!1},m.map((e=>Object(r.jsx)(c.EuiTextColor,{color:"danger",key:`${Object(w.camelCase)(e)}`},e)))),a?Object(r.jsx)(c.EuiFlexItem,{grow:!1},Object(r.jsx)(V,{dispatch:l,shouldDisableAdd:Boolean((null==t?void 0:t.maxSteps)&&e.length>=(null==t?void 0:t.maxSteps)||m.length),shouldDisableDistribute:Boolean(1===e.length),shouldDisableReverse:Boolean(1===e.length)})):null)}const W=(e,t,a)=>{const o=[...e];return o[t]={...o[t],...a},o},U=(e,t,a,o)=>{const n=t?parseFloat(t):Number.NaN;let l=o;return"end"===a?l=W(l,e,{end:n}):(l=W(l,e,{start:n}),e>0&&(l=W(l,e-1,{end:n}))),l},q=(e,t)=>{switch(t.type){case"updateContinuity":{var a,o;const{continuity:n,isLast:l,dataBounds:s,palettes:i}=t.payload,r=null!==(a=null===(o=e.activePalette.params)||void 0===o?void 0:o.rangeType)&&void 0!==a?a:p.i,c=((e,t,a,o,n)=>{const{max:l,min:s}=Object(m.e)(o,n);let i;return i=a?Object(m.b)(t)?Number.POSITIVE_INFINITY:Object(m.i)(e[e.length-1].start>l?e[e.length-1].start+1:l):Object(m.c)(t)?Number.NEGATIVE_INFINITY:Object(m.i)(e[0].end<s?e[0].end-1:s),i})(e.colorRanges,n,l,r,s);return O(i,e.activePalette,U(l?e.colorRanges.length-1:0,`${c}`,l?"end":"start",e.colorRanges),s,n)}case"addColorRange":{var n,l;const{dataBounds:a,palettes:o}=t.payload;return O(o,e.activePalette,((e,t,a)=>{let o=[...e];const n=o.length-1,l=o[n].start,s=o[n].end,i=o[n].color,{max:r}=Object(m.e)(t,a),c=Math.max(r,s);let u=Object(m.i)(Math.min(l+1,c));return u===Number.NEGATIVE_INFINITY&&(u=1),o=W(o,n,{end:u}),o.push({color:i,start:u,end:s===u?s+1:s}),o})(e.colorRanges,null!==(n=null===(l=e.activePalette.params)||void 0===l?void 0:l.rangeType)&&void 0!==n?n:p.i,a),a)}case"reversePalette":{const{dataBounds:a,palettes:o}=t.payload;return O(o,e.activePalette,(c=e.colorRanges).map((({color:e},t)=>({color:e,start:c[c.length-t-1].start,end:c[c.length-t-1].end}))).reverse(),a)}case"distributeEqually":{var s,i,r;const{dataBounds:a,palettes:o}=t.payload;return O(o,e.activePalette,((e,t,a,o)=>{const n=e.length,l=e.length-1,{min:s,max:i}=Object(m.e)(t,o),r=Object(m.i)((i-s)/n),c=e=>Object(m.i)(s+r*e),u=e=>0===e?Object(m.c)(a)?Number.NEGATIVE_INFINITY:Object(m.i)(s):c(e),d=e=>e===l?Object(m.b)(a)?Number.POSITIVE_INFINITY:Object(m.i)(i):c(e+1);return e.map(((e,t)=>({color:e.color,start:u(t),end:d(t)})))})(e.colorRanges,null===(s=e.activePalette.params)||void 0===s?void 0:s.rangeType,null!==(i=null===(r=e.activePalette.params)||void 0===r?void 0:r.continuity)&&void 0!==i?i:p.d,a),a)}case"updateColor":{const{index:a,color:o,palettes:n,dataBounds:l}=t.payload;return O(n,e.activePalette,((e,t,a)=>W(a,e,{color:t}))(a,o,e.colorRanges),l)}case"sortColorRanges":{const{dataBounds:a,palettes:o}=t.payload;return O(o,e.activePalette,h(e.colorRanges),a)}case"updateValue":{const{index:a,value:o,accessor:n,dataBounds:l,palettes:s}=t.payload;return O(s,e.activePalette,U(a,o,n,e.colorRanges),l)}case"deleteColorRange":{const{index:a,dataBounds:o,palettes:n}=t.payload;return O(n,e.activePalette,((e,t)=>{const a=t.length-1;let o=t;return 0!==e&&(e!==a&&(o=W(o,e-1,{end:o[e+1].start})),e===a&&(o=W(o,e-1,{end:t[e].end}))),o.filter(((t,a)=>a!==e))})(a,e.colorRanges),o)}case"updateRangeType":{const{dataBounds:a,palettes:o,rangeType:n}=t.payload,l=function(e,t,a,o,n){var l,s,i,r;const c=null!==(l=null===(s=t.params)||void 0===s?void 0:s.continuity)&&void 0!==l?l:p.d,u={rangeType:e},{min:d,max:g}=Object(m.e)(e,a),{min:b,max:v}=Object(m.e)(null===(i=t.params)||void 0===i?void 0:i.rangeType,a),j=function(e,{newInterval:t,oldInterval:a,newMin:o,oldMin:n}){return(e||[]).map((({color:e,start:l})=>{let s=Object(m.a)(l,o,n,a,t);return 0===a&&(s=t+o),{color:e,stop:Object(m.i)(s)}}))}(n,{oldInterval:v-b,newInterval:g-d,newMin:d,oldMin:b});if(t.name===p.b){const e=Object(m.g)(o,{...t.params,colorStops:j,...u},{dataBounds:a});u.colorStops=j,u.stops=e}else u.stops=Object(m.g)(o,{...t.params,...u},{prevPalette:t.name,dataBounds:a});const y=t.name===p.b?j[j.length-1].stop:u.stops[u.stops.length-1].stop;return u.rangeMin=Object(m.c)(c)?Number.NEGATIVE_INFINITY:t.name===p.b?j[0].stop:u.stops[0].stop,u.rangeMax=Object(m.b)(c)?Number.POSITIVE_INFINITY:null!==(r=t.params)&&void 0!==r&&r.rangeMax?Object(m.a)(t.params.rangeMax,d,b,v-b,g-d):y>g?y+1:g,u}(n,e.activePalette,a,o,e.colorRanges);return C(o,P(e.activePalette,l),a)}case"changeColorPalette":{const{dataBounds:a,palettes:o,palette:n,disableSwitchingContinuity:l}=t.payload,s=function(e,t,a,o,n){var l,s,i;const r=e.name===p.b,c={...t.params,name:e.name,colorStops:void 0,continuity:n&&null!==(l=null===(s=t.params)||void 0===s?void 0:s.continuity)&&void 0!==l?l:p.d,reverse:!1},u=f(a,(null===(i=t.params)||void 0===i?void 0:i.colorStops)||[],t,o);return r&&(c.colorStops=u),{...e,params:{...c,stops:Object(m.g)(a,c,{prevPalette:r||t.name===p.b?void 0:e.name,dataBounds:o,mapFromMinValue:!0}),rangeMin:Object(m.c)(c.continuity)?Number.NEGATIVE_INFINITY:Math.min(o.min,u[0].stop),rangeMax:Object(m.b)(c.continuity)?Number.POSITIVE_INFINITY:Math.min(o.max,u[u.length-1].stop)}}}(n,e.activePalette,o,a,l);return C(o,s,a)}default:throw new Error("wrong action")}var c};t.default=({palettes:e,activePalette:t,setPalette:a,dataBounds:s=Object(m.f)((e=>null===(e=t.params)||void 0===e?void 0:e.rangeType)()),showExtraActions:u=!0,showRangeTypeSelector:d=!0,disableSwitchingContinuity:p=!1})=>{var b,v,j,y;const h=Object(n.useMemo)((()=>Object(c.htmlIdGenerator)()()),[]),x=I(e,(null===(b=t.params)||void 0===b?void 0:b.colorStops)||[],t,s),[O,C]=Object(n.useReducer)(q,{activePalette:t,colorRanges:x});i()((()=>{var e,o,n;O.activePalette===t&&x===O.colorRanges||(o=O.colorRanges,n="percent"===(null===(e=O.activePalette.params)||void 0===e?void 0:e.rangeType),!Object.values($(o,n)).every((e=>e.isValid)))||a(O.activePalette)}),250,[O]);const{euiTheme:P}=Object(c.useEuiTheme)(),f=Object(n.useMemo)((()=>Object(r.css)("padding:",P.size.base,";","")),[P.size.base]);return Object(r.jsx)("div",{css:f,className:"lnsPalettePanel__section"},Object(r.jsx)(c.EuiFormRow,{display:"rowCompressed",label:o.i18n.translate("coloring.dynamicColoring.palettePicker.label",{defaultMessage:"Color palette"}),fullWidth:!0},Object(r.jsx)(g,{"data-test-subj":"lnsPalettePanel_dynamicColoring_palette_picker",palettes:e,activePalette:O.activePalette,setPalette:a=>{a.name!==t.name&&C({type:"changeColorPalette",payload:{palette:a,dataBounds:s,palettes:e,disableSwitchingContinuity:p}})},showCustomPalette:!0,showDynamicColorOnly:!0})),d&&Object(r.jsx)(c.EuiFormRow,{fullWidth:!0,label:Object(r.jsx)(l.a.Fragment,null,o.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"})," ",Object(r.jsx)(c.EuiIconTip,{content:o.i18n.translate("coloring.dynamicColoring.customPalette.colorStopsHelpPercentage",{defaultMessage:"Percent value types are relative to the full range of available data values."}),position:"top",size:"s"})),display:"rowCompressed"},Object(r.jsx)(c.EuiButtonGroup,{isFullWidth:!0,legend:o.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_range_groups",name:"dynamicColoringRangeType",buttonSize:"compressed",options:[{id:`${h}percent`,label:o.i18n.translate("coloring.dynamicColoring.rangeType.percent",{defaultMessage:"Percent"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_percent"},{id:`${h}number`,label:o.i18n.translate("coloring.dynamicColoring.rangeType.number",{defaultMessage:"Number"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_number"}],idSelected:null!==(v=O.activePalette.params)&&void 0!==v&&v.rangeType?`${h}${null===(j=O.activePalette.params)||void 0===j?void 0:j.rangeType}`:`${h}percent`,onChange:t=>{const a=t.replace(h,"");C({type:"updateRangeType",payload:{rangeType:a,dataBounds:s,palettes:e}})}})),Object(r.jsx)(c.EuiFormRow,{label:o.i18n.translate("coloring.dynamicColoring.palettePicker.colorRangesLabel",{defaultMessage:"Color Ranges"}),display:"rowCompressed",fullWidth:!0},Object(r.jsx)(M.Provider,{value:{dataBounds:s,palettes:e,disableSwitchingContinuity:p}},Object(r.jsx)(H,{showExtraActions:u,paletteConfiguration:null===(y=O.activePalette)||void 0===y?void 0:y.params,colorRanges:O.colorRanges,dispatch:C}))))}}}]);