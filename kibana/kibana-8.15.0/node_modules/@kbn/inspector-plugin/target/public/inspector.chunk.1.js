(window.inspector_bundle_jsonpfunction=window.inspector_bundle_jsonpfunction||[]).push([[1],{42:function(e,s,t){var r,a=function(){var e=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function a(e,s){if(!r[e]){r[e]={};for(var t=0;t<e.length;t++)r[e][e.charAt(t)]=t}return r[e][s]}var n={compressToBase64:function(e){if(null==e)return"";var t=n._compress(e,6,(function(e){return s.charAt(e)}));switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:n._decompress(e.length,32,(function(t){return a(s,e.charAt(t))}))},compressToUTF16:function(s){return null==s?"":n._compress(s,15,(function(s){return e(s+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:n._decompress(e.length,16384,(function(s){return e.charCodeAt(s)-32}))},compressToUint8Array:function(e){for(var s=n.compress(e),t=new Uint8Array(2*s.length),r=0,a=s.length;r<a;r++){var o=s.charCodeAt(r);t[2*r]=o>>>8,t[2*r+1]=o%256}return t},decompressFromUint8Array:function(s){if(null==s)return n.decompress(s);for(var t=new Array(s.length/2),r=0,a=t.length;r<a;r++)t[r]=256*s[2*r]+s[2*r+1];var o=[];return t.forEach((function(s){o.push(e(s))})),n.decompress(o.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":n._compress(e,6,(function(e){return t.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),n._decompress(e.length,32,(function(s){return a(t,e.charAt(s))})))},compress:function(s){return n._compress(s,16,(function(s){return e(s)}))},_compress:function(e,s,t){if(null==e)return"";var r,a,n,o={},i={},u="",l="",c="",d=2,p=3,j=2,h=[],b=0,f=0;for(n=0;n<e.length;n+=1)if(u=e.charAt(n),Object.prototype.hasOwnProperty.call(o,u)||(o[u]=p++,i[u]=!0),l=c+u,Object.prototype.hasOwnProperty.call(o,l))c=l;else{if(Object.prototype.hasOwnProperty.call(i,c)){if(c.charCodeAt(0)<256){for(r=0;r<j;r++)b<<=1,f==s-1?(f=0,h.push(t(b)),b=0):f++;for(a=c.charCodeAt(0),r=0;r<8;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1}else{for(a=1,r=0;r<j;r++)b=b<<1|a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a=0;for(a=c.charCodeAt(0),r=0;r<16;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1}0==--d&&(d=Math.pow(2,j),j++),delete i[c]}else for(a=o[c],r=0;r<j;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1;0==--d&&(d=Math.pow(2,j),j++),o[l]=p++,c=String(u)}if(""!==c){if(Object.prototype.hasOwnProperty.call(i,c)){if(c.charCodeAt(0)<256){for(r=0;r<j;r++)b<<=1,f==s-1?(f=0,h.push(t(b)),b=0):f++;for(a=c.charCodeAt(0),r=0;r<8;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1}else{for(a=1,r=0;r<j;r++)b=b<<1|a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a=0;for(a=c.charCodeAt(0),r=0;r<16;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1}0==--d&&(d=Math.pow(2,j),j++),delete i[c]}else for(a=o[c],r=0;r<j;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1;0==--d&&(d=Math.pow(2,j),j++)}for(a=2,r=0;r<j;r++)b=b<<1|1&a,f==s-1?(f=0,h.push(t(b)),b=0):f++,a>>=1;for(;;){if(b<<=1,f==s-1){h.push(t(b));break}f++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:n._decompress(e.length,32768,(function(s){return e.charCodeAt(s)}))},_decompress:function(s,t,r){var a,n,o,i,u,l,c,d=[],p=4,j=4,h=3,b="",f=[],x={val:r(0),position:t,index:1};for(a=0;a<3;a+=1)d[a]=a;for(o=0,u=Math.pow(2,2),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;switch(o){case 0:for(o=0,u=Math.pow(2,8),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;c=e(o);break;case 1:for(o=0,u=Math.pow(2,16),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;c=e(o);break;case 2:return""}for(d[3]=c,n=c,f.push(c);;){if(x.index>s)return"";for(o=0,u=Math.pow(2,h),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;switch(c=o){case 0:for(o=0,u=Math.pow(2,8),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;d[j++]=e(o),c=j-1,p--;break;case 1:for(o=0,u=Math.pow(2,16),l=1;l!=u;)i=x.val&x.position,x.position>>=1,0==x.position&&(x.position=t,x.val=r(x.index++)),o|=(i>0?1:0)*l,l<<=1;d[j++]=e(o),c=j-1,p--;break;case 2:return f.join("")}if(0==p&&(p=Math.pow(2,h),h++),d[c])b=d[c];else{if(c!==j)return null;b=n+n.charAt(0)}f.push(b),d[j++]=n+b.charAt(0),n=b,0==--p&&(p=Math.pow(2,h),h++)}}};return n}();void 0===(r=function(){return a}.call(s,t,s,e))||(e.exports=r)},43:function(e,s,t){"use strict";t.r(s),t.d(s,"RequestsViewComponent",(function(){return requests_view_RequestsViewComponent})),t.d(s,"default",(function(){return requests_view_RequestsViewComponent}));var r=t(3),a=t.n(r),n=t(1),o=t.n(n),i=t(12),u=t(2),l=t(7),c=t(4),d=t(0);class request_selector_RequestSelector extends n.Component{constructor(...e){super(...e),a()(this,"handleSelected",(e=>{const s=this.props.requests.find((s=>s.id===e[0].value));s&&this.props.onRequestChanged(s)}))}renderRequestCombobox(){const e=this.props.requests.map((e=>{const s=e.status===l.c.ERROR;return{"data-test-subj":`inspectorRequestChooser${e.name.replace(/\s+/,"_")}`,label:s?`${e.name} ${c.i18n.translate("inspector.requests.failedLabel",{defaultMessage:" (failed)"})}`:e.name,value:e.id}}));return Object(d.jsx)(u.EuiComboBox,{"data-test-subj":"inspectorRequestChooser",fullWidth:!0,id:"inspectorRequestChooser",isClearable:!1,onChange:this.handleSelected,options:e,prepend:"Request",selectedOptions:[{label:this.props.selectedRequest.name,value:this.props.selectedRequest.id}],singleSelection:{asPlainText:!0}})}render(){const{selectedRequest:e,requests:s}=this.props;return Object(d.jsx)(u.EuiFlexGroup,{alignItems:"center"},Object(d.jsx)(u.EuiFlexItem,{grow:!0},s.length&&this.renderRequestCombobox()),Object(d.jsx)(u.EuiFlexItem,{grow:!1},e.status!==l.c.PENDING&&Object(d.jsx)(u.EuiToolTip,{position:"left",title:e.status===l.c.OK?Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestSucceededTooltipTitle",defaultMessage:"Request succeeded"}):Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestFailedTooltipTitle",defaultMessage:"Request failed"}),content:Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestTooltipDescription",defaultMessage:"The total time the request took."})},Object(d.jsx)(u.EuiBadge,{color:e.status===l.c.OK?"success":"danger",iconType:e.status===l.c.OK?"check":"cross"},Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestTimeLabel",defaultMessage:"{requestTime}ms",values:{requestTime:e.time}}))),e.status===l.c.PENDING&&Object(d.jsx)(u.EuiLoadingSpinner,{size:"m","aria-label":c.i18n.translate("inspector.requests.requestInProgressAriaLabel",{defaultMessage:"Request in progress"})})))}}var p=t(42),j=t(16),h=t(38),b=t(39);const f=c.i18n.translate("inspector.requests.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),x=({value:e,actions:s})=>Object(d.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"s",wrap:!1,responsive:!1,className:"insRequestCodeViewer"},Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(u.EuiSpacer,{size:"s"}),Object(d.jsx)(u.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"m",wrap:!0},Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)("div",null,Object(d.jsx)(u.EuiCopy,{textToCopy:e},(e=>Object(d.jsx)(u.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e,"data-test-subj":"inspectorRequestCopyClipboardButton"},f))))),!!s&&s.map((e=>Object(d.jsx)(u.EuiFlexItem,{grow:!1,key:e.name},Object(d.jsx)("div",null,e.action)))))),Object(d.jsx)(u.EuiFlexItem,{grow:!0,"data-test-subj":"inspectorRequestCodeViewerContainer"},Object(d.jsx)(b.CodeEditor,{languageId:h.XJsonLang.ID,value:e,options:{readOnly:!0,lineNumbers:"off",fontSize:12,minimap:{enabled:!1},folding:!0,scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}}))),m=c.i18n.translate("inspector.requests.openInConsoleLabel",{defaultMessage:"Open in Console"}),q=c.i18n.translate("inspector.requests.openInSearchProfilerLabel",{defaultMessage:"Open in Search Profiler"}),g=({requestParams:e,indexPattern:s,json:t})=>{var r,a,o,i,l,c,h;const{services:b}=Object(j.useKibana)(),f=function(){if(!e)return t;const s=e.querystring?`${e.path}?${e.querystring}`:e.path;return`${e.method} ${s}\n${t}`}(),g=null===(r=b.application)||void 0===r?void 0:r.navigateToUrl,O=Object(p.compressToEncodedURIComponent)(f),v=null===(a=b.share.url.locators.get("CONSOLE_APP_LOCATOR"))||void 0===a?void 0:a.useUrl({loadFrom:`data:text/plain,${O}`}),w=(null===(o=b.application)||void 0===o||null===(i=o.capabilities)||void 0===i?void 0:i.dev_tools.show)&&void 0!==v,C=!(!e||!w),R=Object(n.useCallback)((()=>v&&g&&g(v)),[v,g]),E=Object(p.compressToEncodedURIComponent)(t),y=null===(l=b.share.url.locators.get("SEARCH_PROFILER_LOCATOR"))||void 0===l?void 0:l.useUrl({index:s,loadFrom:`data:text/plain,${E}`}),_=(null===(c=b.application)||void 0===c||null===(h=c.capabilities)||void 0===h?void 0:h.dev_tools.show)&&void 0!==y,S=!(!s||!_),T=Object(n.useCallback)((()=>y&&g&&g(y)),[y,g]),M=[];return C&&M.push({name:"openInConsole",action:Object(d.jsx)(u.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"wrench",href:v,onClick:R,"data-test-subj":"inspectorRequestOpenInConsoleButton"},m)}),S&&M.push({name:"openInSearchProfiler",action:Object(d.jsx)(u.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"visBarHorizontal",href:y,onClick:T,"data-test-subj":"inspectorRequestOpenInSearchProfilerButton"},q)}),Object(d.jsx)(x,{value:f,actions:M})};class req_details_request_RequestDetailsRequest extends n.Component{render(){var e,s,t;const{json:r}=this.props.request;return r?Object(d.jsx)(g,{indexPattern:null===(e=this.props.request.stats)||void 0===e||null===(s=e.indexPattern)||void 0===s?void 0:s.value,requestParams:null===(t=this.props.request.response)||void 0===t?void 0:t.requestParams,json:JSON.stringify(r,null,2)}):null}}var O;a()(req_details_request_RequestDetailsRequest,"shouldShow",(e=>Boolean(e&&e.json)));class req_details_response_RequestDetailsResponse extends n.Component{render(){const e=req_details_response_RequestDetailsResponse.getResponseJson(this.props.request);return e?Object(d.jsx)(x,{value:JSON.stringify(e,null,2)}):null}}O=req_details_response_RequestDetailsResponse,a()(req_details_response_RequestDetailsResponse,"shouldShow",(e=>Boolean(O.getResponseJson(e)))),a()(req_details_response_RequestDetailsResponse,"getResponseJson",(e=>e.response?e.response.json:null));class req_details_stats_RequestDetailsStats extends n.Component{constructor(...e){super(...e),a()(this,"renderStatRow",(e=>[Object(d.jsx)(u.EuiTableRow,{key:e.id},Object(d.jsx)(u.EuiTableRowCell,null,e.label,Object(d.jsx)("span",{className:"insRequestDetailsStats__icon"},e.description?Object(d.jsx)(u.EuiIconTip,{"aria-label":c.i18n.translate("inspector.requests.descriptionRowIconAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",content:e.description}):Object(d.jsx)(u.EuiIcon,{type:"empty"}))),Object(d.jsx)(u.EuiTableRowCell,null,e.value))]))}render(){const{stats:e}=this.props.request;if(!e)return null;const s=Object.keys(e).sort().map((s=>({id:s,...e[s]})));return Object(d.jsx)(u.EuiTable,{responsiveBreakpoint:!1},Object(d.jsx)(u.EuiTableBody,null,s.map(this.renderStatRow)))}}a()(req_details_stats_RequestDetailsStats,"shouldShow",(e=>Boolean(e.stats&&Object.keys(e.stats).length)));var v=t(37);const w={successful:v.euiThemeVars.euiColorSuccess,partial:v.euiThemeVars.euiColorWarning,skipped:"#DA8B45",failed:v.euiThemeVars.euiColorDanger};function C(e,s,t,r){const a=e+s+t+r,n=[];let o=0;function i(e,s){if(e<=0)return;const t=Math.round(e/a*100),r=o+t;n.push(`${s} ${o}% ${r}%`),o=r}return i(e,w.successful),i(s,w.partial),i(t,w.skipped),i(r,w.failed),`linear-gradient(to right, ${n.map(((e,s)=>s===n.length-1?e:e+", ")).join("")})`}const R={size:"xs",color:"subdued"};function E({count:e,status:s,textProps:t=R}){if("number"==typeof e&&0===e)return null;let r="subdued",a=s;"successful"===s?(r=w.successful,a=c.i18n.translate("inspector.requests.clusters.successfulLabel",{defaultMessage:"successful"})):"partial"===s?(r=w.partial,a=c.i18n.translate("inspector.requests.clusters.partialLabel",{defaultMessage:"partial"})):"skipped"===s?(r=w.skipped,a=c.i18n.translate("inspector.requests.clusters.skippedLabel",{defaultMessage:"skipped"})):"failed"===s&&(r=w.failed,a=c.i18n.translate("inspector.requests.clusters.failedLabel",{defaultMessage:"failed"}));const n="number"==typeof e?`${e} ${a}`:a;return Object(d.jsx)(u.EuiHealth,{color:r},Object(d.jsx)(u.EuiText,t,n))}function y({clusters:e}){let s=0,t=0,r=0,a=0;return Object.values(e).forEach((e=>{"successful"===e.status?s++:"partial"===e.status?t++:"skipped"===e.status?r++:"failed"===e.status&&a++})),Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiFlexGroup,null,Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},c.i18n.translate("inspector.requests.clusters.totalClustersLabel",{defaultMessage:"{total} {total, plural, one {cluster} other {clusters}}",values:{total:Object.keys(e).length}}))),s>0?Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(E,{count:s,status:"successful"})):null,t>0?Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(E,{count:t,status:"partial"})):null,r>0?Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(E,{count:r,status:"skipped"})):null,a>0?Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(E,{count:a,status:"failed"})):null),Object(d.jsx)("div",{css:Object(d.css)("background:",C(s,t,r,a),";border-radius:",v.euiThemeVars.euiBorderRadiusSmall,";height:",v.euiThemeVars.euiSizeS,";margin-top:",v.euiThemeVars.euiSizeXS,";margin-bottom:",v.euiThemeVars.euiSizeS,";","")}))}var _=t(40);function S(e){return(e.charAt(0).toUpperCase()+e.slice(1)).replace(/[\._]/g," ")}function T(e,s){if("script"===s||"script_stack"===s){const s=Array.isArray(e)?e.join("\n"):String(e);return Object(d.jsx)(u.EuiCodeBlock,{language:"java",paddingSize:"s",isCopyable:!0},s)}return Object(d.jsx)(u.EuiText,{size:"xs"},String(e))}function M({failure:e}){const s=Object(_.getFlattenedObject)(e.reason),t=Object.entries(s).filter((([e])=>"type"!==e)).map((([e,s])=>({title:S(e),description:T(s,e)}))),r=[{title:c.i18n.translate("inspector.requests.clusters.shards.details.nodeLabel",{defaultMessage:"Node"}),description:T(e.node,"node")},...t];return Object(d.jsx)(u.EuiText,{size:"xs"},Object(d.jsx)(u.EuiDescriptionList,{type:"responsiveColumn",columnWidths:["30%","70%"],listItems:r,compressed:!0}))}function F(e){return`${e.shard}${e.index}`}function I({failures:e}){const[s,t]=Object(n.useState)({}),r=[{field:"shard",name:c.i18n.translate("inspector.requests.clusters.shards.table.shardLabel",{defaultMessage:"Shard"}),render:(r,a)=>Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiButtonIcon,{onClick:()=>(r=>{const a={...s};if(r in a)delete a[r];else{const s=e.find((e=>r===F(e)));a[r]=s?Object(d.jsx)(M,{failure:s}):null}t(a)})(a.rowId),"aria-label":a.rowId in s?c.i18n.translate("inspector.requests.clusters.shards.table.collapseRow",{defaultMessage:"Collapse table row to hide shard details"}):c.i18n.translate("inspector.requests.clusters.shards.table.expandRow",{defaultMessage:"Expand table row to view shard details"}),iconType:a.rowId in s?"arrowDown":"arrowRight"}),Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},r)),width:"20%"},{field:"index",name:c.i18n.translate("inspector.requests.clusters.shards.table.indexLabel",{defaultMessage:"Index"}),render:e=>e?Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},e):null},{field:"failureType",name:c.i18n.translate("inspector.requests.clusters.shards.table.failureTypeLabel",{defaultMessage:"Failure type"}),render:e=>Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},e)}];return Object(d.jsx)(u.EuiBasicTable,{items:e.map((e=>({rowId:F(e),shard:e.shard,index:e.index,failureType:e.reason.type}))),itemIdToExpandedRowMap:s,itemId:"rowId",columns:r})}function L({failures:e,onClose:s}){return Object(d.jsx)(u.EuiFlyout,{onClose:s,ownFocus:!1,hideCloseButton:!0},Object(d.jsx)(u.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(u.EuiTitle,{size:"s"},Object(d.jsx)("h1",null,Object(d.jsx)(u.EuiButtonIcon,{iconType:"sortLeft",onClick:s}),c.i18n.translate("inspector.requests.clusters.shards.flyoutTitle",{defaultMessage:"{failedShardCount} failed {failedShardCount, plural, one {shard} other {shards}}",values:{failedShardCount:e.length}})))),Object(d.jsx)(u.EuiFlyoutBody,null,Object(d.jsx)(I,{failures:e})),Object(d.jsx)(u.EuiFlyoutFooter,null,Object(d.jsx)(u.EuiButtonEmpty,{iconType:"sortLeft",onClick:s,flush:"left"},c.i18n.translate("inspector.requests.clusters.shards.backButtonLabel",{defaultMessage:"Back"}))))}function k({failures:e}){const[s,t]=Object(n.useState)(!1);return Object(d.jsx)(o.a.Fragment,null,e.length?Object(d.jsx)(u.EuiButtonEmpty,{flush:"both",onClick:()=>{t(!s)},size:"xs"},c.i18n.translate("inspector.requests.clusters.shards.openShardFailureFlyoutButtonLabel",{defaultMessage:"View {failedShardCount} failed {failedShardCount, plural, one {shard} other {shards}}",values:{failedShardCount:e.length}})):null,s?Object(d.jsx)(L,{failures:e,onClose:()=>{t(!1)}}):null)}function z({failures:e,shardStats:s}){return s||0!==e.length?Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(u.EuiTitle,{size:"xxxs"},Object(d.jsx)("h4",null,c.i18n.translate("inspector.requests.clusters.shards.shardsTitle",{defaultMessage:"Shards"})))),Object(d.jsx)(u.EuiFlexItem,{grow:!1},Object(d.jsx)(k,{failures:e}))),s?Object(d.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(u.EuiFlexItem,{grow:!1},c.i18n.translate("inspector.requests.clusters.shards.totalShardsLabel",{defaultMessage:"{total} total shards",values:{total:s.total}})),Object(d.jsx)(u.EuiFlexItem,{grow:!1},c.i18n.translate("inspector.requests.clusters.shards.successfulShardsLabel",{defaultMessage:"{successful} of {total} successful",values:{successful:s.successful,total:s.total}}))):null):null}function B({clusterDetails:e}){var s,t;const r=(null!==(s=e.failures)&&void 0!==s?s:[]).find((e=>e.shard<0)),a=(null!==(t=e.failures)&&void 0!==t?t:[]).filter((e=>e.shard>=0));return Object(d.jsx)(u.EuiText,{style:{width:"100%"},size:"xs","data-test-subj":"inspectorRequestClustersDetails"},e.timed_out?Object(d.jsx)(u.EuiCallOut,{size:"s",color:"warning",title:c.i18n.translate("inspector.requests.clusters.timedOutMessage",{defaultMessage:"Request timed out before completion. Results may be incomplete or empty."}),iconType:"warning"}):null,r?Object(d.jsx)(u.EuiCallOut,{size:"s",color:"warning",title:c.i18n.translate("inspector.requests.clusters.failedClusterMessage",{defaultMessage:"Search failed"}),iconType:"warning"},Object(d.jsx)("p",null,r.reason.reason?`${r.reason.type}: "${r.reason.reason}"`:r.reason.type),r.reason.failed_shards?Object(d.jsx)(k,{failures:r.reason.failed_shards}):null):null,Object(d.jsx)(z,{failures:a,shardStats:e._shards}))}const D="(local)";function A(e){var s;return 0===(null===(s=e._shards)||void 0===s?void 0:s.successful)?"failed":e.timed_out||e._shards.failed?"partial":"successful"}function P(e){const s={...e._shards};return delete s.failures,{status:A(e),indices:"",took:e.took,timed_out:e.timed_out,_shards:s,failures:e._shards.failures}}function $({clusters:e}){const[s,t]=Object(n.useState)(function(e){const s=Object.keys(e);return 1===s.length?{[s[0]]:Object(d.jsx)(B,{clusterDetails:e[s[0]]})}:{}}(e)),[r,a]=Object(n.useState)(),[i,l]=Object(n.useState)("asc"),p=Object(n.useMemo)((()=>Object.keys(e).map((s=>({name:s,status:e[s].status,responseTime:e[s].took})))),[e]),j=[{field:"name",name:c.i18n.translate("inspector.requests.clusters.table.nameLabel",{defaultMessage:"Name"}),render:r=>Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiButtonIcon,{"data-test-subj":`inspectorRequestToggleClusterDetails${r}`,onClick:()=>(r=>{const a={...s};r in a?delete a[r]:a[r]=Object(d.jsx)(B,{clusterDetails:e[r]}),t(a)})(r),"aria-label":r in s?c.i18n.translate("inspector.requests.clusters.table.collapseRow",{defaultMessage:"Collapse table row to hide cluster details"}):c.i18n.translate("inspector.requests.clusters.table.expandRow",{defaultMessage:"Expand table row to view cluster details"}),iconType:r in s?"arrowDown":"arrowRight"}),Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},r===D?c.i18n.translate("inspector.requests.clusters.table.localClusterDisplayName",{defaultMessage:"Local cluster"}):r)),sortable:p.length>1,width:"60%"},{field:"status",name:c.i18n.translate("inspector.requests.clusters.table.statusLabel",{defaultMessage:"Status"}),render:e=>Object(d.jsx)(E,{status:e}),sortable:p.length>1},{align:"right",field:"responseTime",name:c.i18n.translate("inspector.requests.clusters.table.responseTimeLabel",{defaultMessage:"Response time"}),render:e=>Object(d.jsx)(u.EuiText,{size:"xs",color:"subdued"},e?c.i18n.translate("inspector.requests.clusters.table.responseTimeInMilliseconds",{defaultMessage:"{responseTime}ms",values:{responseTime:e}}):null),sortable:p.length>1}];return Object(d.jsx)(u.EuiBasicTable,{items:r?p.sort(u.Comparators.property(r,u.Comparators.default(i))):p,itemIdToExpandedRowMap:s,itemId:"name",columns:j,sorting:{sort:r?{field:r,direction:i}:void 0},onChange:({sort:e})=>{e&&(a(e.field),l(e.direction))},noItemsMessage:c.i18n.translate("inspector.requests.clusters.table.noItemsFound",{defaultMessage:"No clusters found"})})}function V(e,s){var t,r;const a=null===(t=e.response)||void 0===t||null===(r=t.json)||void 0===r?void 0:r.rawResponse;if(!a)return{};const n=a._clusters?a._clusters.details:{[D]:P(a)};if(!s)return n;const o=Object.keys(n).map((e=>({name:e,status:n[e].status}))),i=u.EuiSearchBar.Query.execute(s,o,{defaultFields:["name"]}),l={};return i.forEach((({name:e})=>{l[e]=n[e]})),l}class clusters_view_ClustersView extends n.Component{constructor(e){super(e),a()(this,"_onSearchChange",(({query:e,error:s})=>{s||this.setState({clusters:V(this.props.request,e)})}));const s=V(this.props.request);this.state={clusters:s,showSearchAndStatusBar:Object.keys(s).length>1}}render(){return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiSpacer,{size:"m"}),this.state.showSearchAndStatusBar?Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiSearchBar,{box:{placeholder:"Search by cluster name",incremental:!0},filters:[{type:"field_value_selection",field:"status",name:c.i18n.translate("inspector.requests.clusters.view.statusFilterLabel",{defaultMessage:"Status"}),multiSelect:"or",options:[{value:"successful",view:Object(d.jsx)(E,{status:"successful",textProps:{size:"m",color:"text"}})},{value:"partial",view:Object(d.jsx)(E,{status:"partial",textProps:{size:"m",color:"text"}})},{value:"skipped",view:Object(d.jsx)(E,{status:"skipped",textProps:{size:"m",color:"text"}})},{value:"failed",view:Object(d.jsx)(E,{status:"failed",textProps:{size:"m",color:"text"}})}]}],onChange:this._onSearchChange}),Object(d.jsx)(u.EuiSpacer,{size:"m"}),Object(d.jsx)(y,{clusters:this.state.clusters})):null,Object(d.jsx)($,{clusters:this.state.clusters}))}}a()(clusters_view_ClustersView,"shouldShow",(e=>{var s,t,r,a,n,o;return Boolean((null===(s=e.response)||void 0===s||null===(t=s.json)||void 0===t||null===(r=t.rawResponse)||void 0===r?void 0:r._shards)||(null===(a=e.response)||void 0===a||null===(n=a.json)||void 0===n||null===(o=n.rawResponse)||void 0===o?void 0:o._clusters))}));const N=[{name:"Statistics",label:c.i18n.translate("inspector.requests.statisticsTabLabel",{defaultMessage:"Statistics"}),component:req_details_stats_RequestDetailsStats},{name:"Clusters",label:c.i18n.translate("inspector.requests.clustersTabLabel",{defaultMessage:"Clusters and shards"}),component:clusters_view_ClustersView},{name:"Request",label:c.i18n.translate("inspector.requests.requestTabLabel",{defaultMessage:"Request"}),component:req_details_request_RequestDetailsRequest},{name:"Response",label:c.i18n.translate("inspector.requests.responseTabLabel",{defaultMessage:"Response"}),component:req_details_response_RequestDetailsResponse}];function U(e){const[s,t]=Object(n.useState)([]),[r,a]=Object(n.useState)(null);return Object(n.useEffect)((()=>{const s=N.filter((s=>{var t,r;return null===(t=(r=s.component).shouldShow)||void 0===t?void 0:t.call(r,e.request)}));t(s),r&&s.find((({name:e})=>e===r.name))||a(function(e,s,t){const r=s.length?s[0]:null;if(e||!t)return r;const a=t.find((e=>s.some((({name:s})=>e.toLowerCase()===s.toLowerCase()))));return(a?s.find((({name:e})=>a.toLowerCase()===e.toLowerCase())):void 0)||r}(r,s,e.initialTabs))}),[e.initialTabs,e.request]),r?Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiTabs,{size:"s"},s.map((e=>Object(d.jsx)(u.EuiTab,{key:e.name,isSelected:e.name===r.name,onClick:()=>{e.name!==r.name&&a(e)},"data-test-subj":`inspectorRequestDetail${e.name}`},e.label)))),Object(d.jsx)(r.component,{key:e.request.id,request:e.request})):null}var G=t(41);class requests_view_RequestsViewComponent extends n.Component{constructor(e){var s;super(e),a()(this,"_onRequestsChange",(()=>{const e=this.getRequests(),s={requests:e};this.state.request&&e.includes(this.state.request)||(s.request=e.length?e[0]:null),this.setState(s)})),a()(this,"selectRequest",(e=>{e!==this.state.request&&this.setState({request:e})})),e.adapters.requests.on("change",this._onRequestsChange);const t=this.getRequests();var r,n;this.state={requests:t,request:(r=t,n=null===(s=this.props.options)||void 0===s?void 0:s.initialRequestId,(n?r.find((({id:e})=>e===n)):void 0)||(r.length?r[0]:null))}}getRequests(){return function(e){const s=Object(G.groupBy)(e,(e=>e.name)),t=Object.entries(s).reduce(((e,[s,t])=>{const r=t.length>1;return t.forEach(((t,a)=>{const n=t.id;e[n]=r?`${s} (${a+1})`:s})),e}),{});return e.map((e=>({...e,name:t[e.id]})))}(this.props.adapters.requests.getRequests())}componentWillUnmount(){this.props.adapters.requests.removeListener("change",this._onRequestsChange)}static renderEmptyRequests(){return Object(d.jsx)(u.EuiEmptyPrompt,{"data-test-subj":"inspectorNoRequestsMessage",title:Object(d.jsx)("h2",null,Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.noRequestsLoggedTitle",defaultMessage:"No requests logged"})),body:Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)("p",null,Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.noRequestsLoggedDescription.elementHasNotLoggedAnyRequestsText",defaultMessage:"The element hasn't logged any requests (yet)."})),Object(d.jsx)("p",null,Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.noRequestsLoggedDescription.whatDoesItUsuallyMeanText",defaultMessage:"This usually means that there was no need to fetch any data or that the element has not yet started fetching data."})))})}render(){var e;if(!this.state.requests||!this.state.requests.length)return requests_view_RequestsViewComponent.renderEmptyRequests();const s=this.state.requests.filter((e=>e.status===l.c.ERROR)).length;return Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(u.EuiText,{size:"xs"},Object(d.jsx)("p",{role:"status","aria-live":"polite","aria-atomic":"true"},Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestWasMadeDescription",defaultMessage:"{requestsCount, plural, one {# request was} other {# requests were} } made{failedRequests}",values:{requestsCount:this.state.requests.length,failedRequests:s>0?Object(d.jsx)(u.EuiTextColor,{color:"danger"},Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.requestWasMadeDescription.requestHadFailureText",defaultMessage:", {failedCount} had a failure",values:{failedCount:s}})):""}}))),Object(d.jsx)(u.EuiSpacer,{size:"xs"}),this.state.request&&Object(d.jsx)(o.a.Fragment,null,Object(d.jsx)(request_selector_RequestSelector,{requests:this.state.requests,selectedRequest:this.state.request,onRequestChanged:this.selectRequest}),Object(d.jsx)(u.EuiSpacer,{size:"xs"})),this.state.request&&this.state.request.description&&Object(d.jsx)(u.EuiText,{size:"xs"},Object(d.jsx)("p",null,this.state.request.description)),this.state.request&&this.state.request.searchSessionId&&Object(d.jsx)(u.EuiText,{size:"xs"},Object(d.jsx)("p",{"data-test-subj":"inspectorRequestSearchSessionId","data-search-session-id":this.state.request.searchSessionId},Object(d.jsx)(i.FormattedMessage,{id:"inspector.requests.searchSessionId",defaultMessage:"Search session id: {searchSessionId}",values:{searchSessionId:this.state.request.searchSessionId}}))),Object(d.jsx)(u.EuiSpacer,{size:"m"}),this.state.request&&Object(d.jsx)(U,{initialTabs:null===(e=this.props.options)||void 0===e?void 0:e.initialTabs,request:this.state.request}))}}}}]);