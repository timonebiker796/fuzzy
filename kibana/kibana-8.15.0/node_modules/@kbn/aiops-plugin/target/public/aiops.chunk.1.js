/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[1],{158:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n(1);var r=n(0),o=n(26),i=n(2),a=n(170),u=n(14),s=n(12),c=n(43),l=n(68),f={name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"};const d=({chartData:e,isLoading:t,label:n,barColorOverride:d,barHighlightColorOverride:b})=>{const{charts:h}=Object(c.b)(),m=Object(l.a)(),p=h.theme.useChartsBaseTheme(),y=Object(r.css)({width:"80px",height:m.euiSizeL,margin:"0px"},"",""),g=f;if(t)return Object(r.jsx)("div",{css:[y,g,"",""]},Object(r.jsx)(i.EuiLoadingChart,{mono:!0}));if(!e)return Object(r.jsx)("div",{css:[y,g,"",""]},Object(r.jsx)(i.EuiTextColor,{color:"subdued"},Object(r.jsx)(u.FormattedMessage,{id:"xpack.aiops.miniHistogram.noDataLabel",defaultMessage:"N/A"})));const v=d?[d]:void 0,j=b?[b]:[a.a];return Object(r.jsx)("div",{css:y},Object(r.jsx)(o.Chart,null,Object(r.jsx)(o.Tooltip,{type:o.TooltipType.None}),Object(r.jsx)(o.Settings,{theme:[{chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1},background:{color:"transparent"}}],baseTheme:p,showLegend:!1,locale:s.i18n.getLocale()}),Object(r.jsx)(o.BarSeries,{id:"doc_count_overall",xScaleType:o.ScaleType.Time,yScaleType:o.ScaleType.Linear,xAccessor:"key",yAccessors:["doc_count_overall"],data:e,stackAccessors:[0],color:v}),Object(r.jsx)(o.BarSeries,{id:n,xScaleType:o.ScaleType.Time,yScaleType:o.ScaleType.Linear,xAccessor:"key",yAccessors:["doc_count_significant_item"],data:e,stackAccessors:[0],color:j})))}},168:function(e,t,n){"use strict";function r(e){return null!=e}n.d(t,"a",(function(){return r}))},169:function(e,t,n){"use strict";function r(e){let t=0,n=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)n=e.charCodeAt(r),t=(t<<5)-t+n,t|=0;return t<0?-2*t:t}n.d(t,"a",(function(){return r}))},170:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=3867412,o="orange"},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={KEYWORD:"keyword",LOG_PATTERN:"log_pattern"}},280:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(13),o=n(167);function i(e){return"number"==typeof e&&e>0&&e<=.5}const a=e=>{var t;const n=(a=e,Object(o.a)(a,["probability"])?e.probability:function(e){let t=1;return e>5e4&&(t=Math.min(.5,5e4/e)),+(n=t).toFixed(Math.max(1-Math.log10(n),1));var n}(e.totalNumDocs));var a;const u=null!==(t=e.aggName)&&void 0!==t?t:"sample";return{wrap:t=>i(n)?{[u]:{random_sampler:{probability:n,...e.seed?{seed:e.seed}:{}},aggs:t}}:t,unwrap:e=>i(n)?Object(r.get)(e,[u]):e,probability:n}}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(1),i=r.__importDefault(n(78));t.default=function(e,t){var n=o.useState(t),r=n[0],a=n[1];return i.default((function(){var t=e.subscribe(a);return function(){return t.unsubscribe()}}),[e]),r}},54:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a}));const r="aiops",o={LOG_RATE_ANALYSIS:"/internal/aiops/log_rate_analysis",CATEGORIZATION_FIELD_VALIDATION:"/internal/aiops/categorization_field_validation"},i={AIOPS_DEFAULT_SOURCE:"ml_aiops_labs",AIOPS_ANALYSIS_RUN_ORIGIN:"aiops-analysis-run-origin"},a="embeddable"},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u}));const r="aiops.frozenDataTierPreference",o="aiops.randomSamplingModePreference",i="aiops.randomSamplingProbabilityPreference",a="aiops.patternAnalysisMinimumTimeRangePreference",u=[r,o,i,a]},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(1),o=n.n(r),i=n(13),a=n(168),u=n(0);const s=o.a.createContext({value:null,setValue(){throw new Error("MlStorageContext set method is not implemented")},removeValue(){throw new Error("MlStorageContext remove method is not implemented")}});function c({children:e,storage:t,storageKeys:n}){const o=Object(r.useMemo)((()=>n.reduce(((e,n)=>(e[n]=t.get(n),e)),{})),[t,n]),[c,l]=Object(r.useState)(o),f=Object(r.useCallback)(((e,n)=>{t.set(e,n),l((t=>({...t,[e]:n})))}),[t]),d=Object(r.useCallback)((e=>{t.remove(e),l((t=>Object(i.omit)(t,e)))}),[t]);Object(r.useEffect)((function(){const e=e=>{(function(e,t){return t.includes(e)})(e.key,n)&&(Object(a.a)(e.newValue)?l((t=>({...t,[e.key]:"string"==typeof e.newValue?JSON.parse(e.newValue):e.newValue}))):l((t=>Object(i.omit)(t,e.key))))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}),[n]);const b=Object(r.useMemo)((()=>({value:c,setValue:f,removeValue:d})),[c,f,d]);return Object(u.jsx)(s.Provider,{value:b},e)}function l(e,t){const{value:n,setValue:o,removeValue:i}=Object(r.useContext)(s);return[Object(r.useMemo)((()=>{var r;return null!==(r=null==n?void 0:n[e])&&void 0!==r?r:t}),[n,e,t]),Object(r.useCallback)((t=>{Object(a.a)(t)?o(e,t):i(e)}),[o,i,e])]}},68:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d}));var r=n(1),o=n(3),i=n(51),a=n.n(i),u=n(36);const s={darkMode:!1};function c(e){const t=Object(r.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.theme$)&&void 0!==t?t:Object(o.of)(s)}),[e]),{darkMode:n}=a()(t,s);return n}var l=n(43);function f(){const{theme:e}=Object(l.b)();return function(e){const t=c(e);return Object(r.useMemo)((()=>({euiTheme:t?u.euiDarkVars:u.euiLightVars})),[t])}(e).euiTheme}function d(){const{theme:e}=Object(l.b)();return c(e)}},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r={INCLUDE:"should",EXCLUDE:"must_not"},o=(e,t,n=r.INCLUDE)=>({bool:{[n]:t.map((({key:t})=>({match:{[e]:{auto_generate_synonyms_phrase_query:!1,fuzziness:0,operator:"and",query:t}}})))}})},78:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=o},84:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(1),o=n(3),i=n(30),a=n(171),u=n(127),s=n(259),c=n(54),l=n(43),f=n(12),d=n(169),b=n(280),h=n(167);var m=n(170),p=n(13),y=n(21),g=n.n(y),v=n(87);const j=(e,t)=>{var n;const r=Object.keys(e),o=Object.values(e),i=Math.round(null!==(n=Object(v.mean)(o))&&void 0!==n?n:0),a=r.findIndex((e=>+e===t)),u=e[t];let s=a-1,c=a+1;for(;s>=0&&Math.abs(o[s]-i)>Math.abs(o[s]-u);)s--;for(;c<o.length&&Math.abs(o[c]-i)>Math.abs(o[c]-u);)c++;return{startTs:+r[s],endTs:+r[c]}};var O=n(258);function _(e){return Object(h.a)(e,["query_string"])}function M(e){return Object(h.a)(e,["match_all"])&&"object"==typeof e.match_all&&null!==e.match_all&&0===Object.keys(e.match_all).length}function w(e){return M(e)||_(t=e)&&"*"===t.query_string.query||function(e){return Object(h.a)(e,["bool"])&&Object(h.a)(e.bool,["filter"])&&Array.isArray(e.bool.filter)&&1===e.bool.filter.length&&_(e.bool.filter[0])}(e)&&("*"===e.bool.filter[0].query_string.query||M(e.bool.filter[0]));var t}const x=["filter","must","must_not"];var S=n(70);const A=(e,t,n=!1,r=!1)=>{const{index:o,timeFieldName:i,earliest:a,latest:u,runtimeFieldMap:s,searchQuery:c,intervalMs:l,fieldsToFetch:f,selectedSignificantItem:d,includeSelectedSignificantItem:b,selectedGroup:m,trackTotalHits:p}=e,y=function(e,t,n,r,o,i=!0,a){const u=function(e,t,n,r,o="epoch_millis"){const i=[];var a;return e&&t&&n&&i.push({range:{[e]:{gte:t,lte:n,format:o}}}),!r||"object"!=typeof r||w(r)||(a=r,Object(h.a)(a,["bool"])&&Object(h.a)(a.bool,x)&&Object.values(a.bool).every((e=>Array.isArray(e)&&(0===e.length||1===e.length&&w(e[0])))))||i.push(r),i}(e,t,n,r),s=[];if(a){const e=a.groupItemsSortedByUniqueness;for(const t of e){const{fieldName:e,fieldValue:n,key:r,type:o,docCount:i}=t;o===O.a.KEYWORD?s.push({term:{[e]:n}}):s.push(Object(S.b)(e,[{key:r,count:i,examples:[],regex:""}]))}}return i?o?"keyword"===o.type?u.push({term:{[o.fieldName]:o.fieldValue}}):u.push(Object(S.b)(o.fieldName,[{key:`${o.key}`,count:o.doc_count,examples:[],regex:""}])):a&&u.push(...s):o&&!i?"keyword"===o.type?u.push({bool:{must_not:[{term:{[o.fieldName]:o.fieldValue}}]}}):u.push({bool:{must_not:[Object(S.b)(o.fieldName,[{key:`${o.key}`,count:o.doc_count,examples:[],regex:""}])]}}):a&&!i&&u.push({bool:{must_not:[{bool:{filter:[...s]}}]}}),u}(i,a,u,c,d,b,m),g={eventRate:{date_histogram:{field:i,fixed_interval:`${l}ms`,min_doc_count:0,...void 0!==a&&void 0!==u?{extended_bounds:{min:a,max:u}}:{}}},...r?{change_point_request:{change_point:{buckets_path:"eventRate>_count"}}}:{}},v=t?t.wrap(g):g,j={query:{bool:{filter:y}},track_total_hits:!0===p,size:0};return Object(h.a)(s)&&(j.runtime_mappings=s),!f&&!n&&void 0!==i&&void 0!==l&&l>0&&(j.aggs=v,j.sort={[i]:"desc"},j.fields=[i],j.size=1),{index:o,body:j}},k=(e,t,n)=>{var r,o,i,a,u;if(!e)return;const s=null!==(r=null!==(o=e.hits.total.value)&&void 0!==o?o:e.hits.total)&&void 0!==r?r:0;if(void 0===t.intervalMs||void 0===t.earliest||void 0===t.latest)return{totalCount:s};const c=Object(p.get)(n&&void 0!==e.aggregations?n.unwrap(e.aggregations):e.aggregations,["eventRate","buckets"],[]),l=Object(p.get)(n&&void 0!==e.aggregations?n.unwrap(e.aggregations):e.aggregations,["change_point_request"]),f=l&&l.bucket&&Object.keys(l.type).length>0?{key:Date.parse(l.bucket.key),type:Object.keys(l.type)[0]}:void 0,d=c.reduce(((e,t)=>(e[t.key]=t.doc_count,e)),{}),b=Object.values(null!==(i=null===(a=e.hits.hits[0])||void 0===a?void 0:a.fields)&&void 0!==i?i:[[]])[0][0],h=void 0===b||null===(u=g.a.parse(b))||void 0===u?void 0:u.valueOf();return{interval:t.intervalMs,buckets:d,timeRangeEarliest:t.earliest,timeRangeLatest:t.latest,totalCount:s,lastDocTimeStampMs:h,...f?{changePoint:{...f,...j(d,null==f?void 0:f.key)}}:{}}};function T(e,t,n,i=!0){const{data:a,notifications:{toasts:u}}=Object(l.b)(),s=Object(r.useRef)(new AbortController),[c,p]=Object(r.useState)({sampleProbability:1,totalCount:0}),[y,g]=Object(r.useState)({}),v=Object(d.a)(`${JSON.stringify(e)}_${JSON.stringify(t)}`),j=Object(r.useCallback)((async()=>{var n,r,c,l,d;if(e)if(y[v])p(y[v]);else try{var j;s.current=new AbortController;const n={...e,selectedSignificantItem:void 0,trackTotalHits:!0},r=await Object(o.lastValueFrom)(a.search.search({params:A(n,void 0,i)},{abortSignal:s.current.signal})),u=k(null==r?void 0:r.rawResponse,e),c=null!==(j=null==u?void 0:u.totalCount)&&void 0!==j?j:0,l=Object(b.a)({totalNumDocs:c,seed:m.b}),f=await Object(o.lastValueFrom)(a.search.search({params:A({...e,trackTotalHits:!1},l,!1,void 0===t&&i)},{abortSignal:s.current.signal})),d=k(null==f?void 0:f.rawResponse,e,l),h={sampleProbability:l.probability,documentCountStats:d,totalCount:c};if(t){const e=await Object(o.lastValueFrom)(a.search.search({params:A({...t,trackTotalHits:!1},l)},{abortSignal:s.current.signal})),n=k(null==e?void 0:e.rawResponse,t,l);h.documentCountStatsCompare=n,h.totalCount=c}p(h),g({...y,[v]:h})}catch(t){"AbortError"!==t.name&&(n=u,r=e.index,500===(c=(e=>{var t;if(function(e){var t;return e&&void 0!==(null===(t=e.error)||void 0===t?void 0:t.reason)}(e))return{message:null!==(t=e.error.reason)&&void 0!==t?t:"",statusCode:e.status,fullError:e};if(function(e){return"string"==typeof e}(e))return{message:e};if(function(e){return!0===(null==e?void 0:e.isBoom)}(e))return{message:e.output.payload.message,statusCode:e.output.payload.statusCode};if(void 0===(null==e?void 0:e.body)&&(null==e||!e.message))return{message:""};if("string"==typeof e.body)return{message:e.body};if(function(e){return"object"==typeof e.body&&"message"in e.body}(e)){var n,r;if("object"==typeof e.body.attributes&&"string"==typeof(null===(n=e.body.attributes.body)||void 0===n||null===(r=n.error)||void 0===r?void 0:r.reason)){var o,i,a;const t={message:e.body.attributes.body.error.reason,statusCode:e.body.statusCode,fullError:e.body.attributes.body};var u,s,c;return"object"!=typeof e.body.attributes.body.error.caused_by||"string"!=typeof(null===(o=e.body.attributes.body.error.caused_by)||void 0===o?void 0:o.reason)&&"string"!=typeof(null===(i=e.body.attributes.body.error.caused_by)||void 0===i||null===(a=i.caused_by)||void 0===a?void 0:a.reason)||(t.causedBy=(null===(u=e.body.attributes.body.error.caused_by)||void 0===u||null===(s=u.caused_by)||void 0===s?void 0:s.reason)||(null===(c=e.body.attributes.body.error.caused_by)||void 0===c?void 0:c.reason)),Array.isArray(e.body.attributes.body.error.root_cause)&&"object"==typeof e.body.attributes.body.error.root_cause[0]&&Object(h.a)(e.body.attributes.body.error.root_cause[0],["script"])&&(t.causedBy=e.body.attributes.body.error.root_cause[0].script,t.message+=`: '${e.body.attributes.body.error.root_cause[0].script}'`),t}return{message:e.body.message,statusCode:e.body.statusCode}}return function(e){return e&&void 0!==e.message&&"string"==typeof e.message}(e)?{message:e.message}:{message:""}})(t)).statusCode?n.addError(c,{title:f.i18n.translate("xpack.aiops.index.dataLoader.internalServerErrorMessage",{defaultMessage:"Error loading data in index {index}. {message}. The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:r,message:null!==(l=c.error)&&void 0!==l?l:c.message}})}):n.addError(c,{title:f.i18n.translate("xpack.aiops.index.errorLoadingDataMessage",{defaultMessage:"Error loading data in index {index}. {message}.",values:{index:r,message:null!==(d=c.error)&&void 0!==d?d:c.message}})}))}}),[null==a?void 0:a.search,y,v]);return Object(r.useEffect)((function(){return j(),()=>s.current.abort()}),[j,n]),Object(r.useEffect)((()=>{g({})}),[n]),c}const E=(e,t,n,f,d,b=null,h=75,m=!0,p)=>{const{executionContext:y,uiSettings:g}=Object(l.b)();Object(i.useExecutionContext)(y,{name:c.b,type:"application",id:t});const[v,j]=Object(r.useState)(0),O=Object(s.a)(g),_=Object(a.c)({timeRangeSelector:void 0!==(null==e?void 0:e.timeFieldName),autoRefreshSelector:!0}),M=Object(r.useMemo)((()=>_.getActiveBounds()),[v,JSON.stringify(_.getTime())]),w=Object(r.useMemo)((()=>{const t=null!=p?p:M;var r,o,i;if(void 0!==t)return O.setInterval("auto"),O.setBounds(t),O.setBarTarget(h),{earliest:null===(r=t.min)||void 0===r?void 0:r.valueOf(),latest:null===(o=t.max)||void 0===o?void 0:o.valueOf(),intervalMs:null===(i=O.getInterval())||void 0===i?void 0:i.asMilliseconds(),index:e.getIndexPattern(),searchQuery:n,timeFieldName:e.timeFieldName,runtimeFieldMap:e.getRuntimeMappings()}}),[v,n,p,M]),x=T(Object(r.useMemo)((()=>w?{...w,selectedSignificantItem:d,selectedGroup:b,includeSelectedSignificantItem:!1}:void 0),[w,d,b]),Object(r.useMemo)((()=>w&&(d||b)?{...w,selectedSignificantItem:d,selectedGroup:b,includeSelectedSignificantItem:!0}:void 0),[w,d,b]),v,m);return Object(r.useEffect)((()=>{const e=Object(o.merge)(_.getAutoRefreshFetch$(),_.getTimeUpdate$(),u.a).subscribe((e=>{f&&(f({time:_.getTime(),refreshInterval:_.getRefreshInterval()}),"function"==typeof e&&e()),j(Date.now())})),t=_.getEnabledUpdated$().subscribe((()=>{void 0===w&&j(Date.now())}));return()=>{e.unsubscribe(),t.unsubscribe()}}),[]),{documentStats:x,timefilter:_,earliest:null==w?void 0:w.earliest,latest:null==w?void 0:w.latest,intervalMs:null==w?void 0:w.intervalMs,forceRefresh:()=>j(Date.now())}}},87:function(e,t,n){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){let n=e,r=e;function o(e,t,n,o){for(null==n&&(n=0),null==o&&(o=e.length);n<o;){const i=n+o>>>1;r(e[i],t)<0?n=i+1:o=i}return n}return 1===e.length&&(n=(t,n)=>e(t)-n,r=function(e){return(n,r)=>t(e(n),r)}(e)),{left:o,center:function(e,t,r,i){null==r&&(r=0),null==i&&(i=e.length);const a=o(e,t,r,i-1);return a>r&&n(e[a-1],t)>-n(e[a],t)?a-1:a},right:function(e,t,n,o){for(null==n&&(n=0),null==o&&(o=e.length);n<o;){const i=n+o>>>1;r(e[i],t)>0?o=i:n=i+1}return n}}}function r(e){return null===e?NaN:+e}const o=n(t),i=o.right,a=o.left,u=n(r).center;function s(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(o=+o)>=o&&++n}return n}function c(e){return 0|e.length}function l(e){return!(e>0)}function f(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function d(e,t){let n,r=0,o=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-o,o+=n/++r,i+=n*(t-o));else{let a=-1;for(let u of e)null!=(u=t(u,++a,e))&&(u=+u)>=u&&(n=u-o,o+=n/++r,i+=n*(u-o))}if(r>1)return i/(r-1)}function b(e,t){const n=d(e,t);return n?Math.sqrt(n):n}function h(e,t){let n,r;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let o=-1;for(let i of e)null!=(i=t(i,++o,e))&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const o=t[r],i=e+o,a=Math.abs(e)<Math.abs(o)?e-(i-o):o-(i-e);a&&(t[n++]=a),e=i}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,o=this._n,i=0;if(o>0){for(i=e[--o];o>0&&(t=i,n=e[--o],i=t+n,r=n-(i-t),!r););o>0&&(r<0&&e[o-1]<0||r>0&&e[o-1]>0)&&(n=2*r,t=i+n,n==t-i&&(i=t))}return i}}class InternMap extends Map{constructor(e,t=g){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(m(this,e))}has(e){return super.has(m(this,e))}set(e,t){return super.set(p(this,e),t)}delete(e){return super.delete(y(this,e))}}class InternSet extends Set{constructor(e,t=g){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(m(this,e))}add(e){return super.add(p(this,e))}delete(e){return super.delete(y(this,e))}}function m({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function p({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function y({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function g(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function j(e,...t){return M(e,v,v,t)}function O(e,t,...n){return M(e,v,t,n)}function _(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function M(e,t,n,r){return function e(o,i){if(i>=r.length)return n(o);const a=new InternMap,u=r[i++];let s=-1;for(const e of o){const t=u(e,++s,o),n=a.get(t);n?n.push(e):a.set(t,[e])}for(const[t,n]of a)a.set(t,e(n,i));return t(a)}(e,0)}function w(e,t){return Array.from(t,(t=>e[t]))}function x(e,...n){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[r=t]=n;if(1===r.length||n.length>1){const o=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),o.sort(((e,r)=>{for(const o of n){const n=t(o[e],o[r]);if(n)return n}}))):(r=e.map(r),o.sort(((e,n)=>t(r[e],r[n])))),w(e,o)}return e.sort(r)}var S=Array.prototype.slice;function A(e){return function(){return e}}var k=Math.sqrt(50),T=Math.sqrt(10),E=Math.sqrt(2);function C(e,t,n){var r,o,i,a,u=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),0===(a=I(e,t,n))||!isFinite(a))return[];if(a>0){let n=Math.round(e/a),r=Math.round(t/a);for(n*a<e&&++n,r*a>t&&--r,i=new Array(o=r-n+1);++u<o;)i[u]=(n+u)*a}else{a=-a;let n=Math.round(e*a),r=Math.round(t*a);for(n/a<e&&++n,r/a>t&&--r,i=new Array(o=r-n+1);++u<o;)i[u]=(n+u)/a}return r&&i.reverse(),i}function I(e,t,n){var r=(t-e)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=k?10:i>=T?5:i>=E?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=k?10:i>=T?5:i>=E?2:1)}function N(e,t,n){let r;for(;;){const o=I(e,t,n);if(o===r||0===o||!isFinite(o))return[e,t];o>0?(e=Math.floor(e/o)*o,t=Math.ceil(t/o)*o):o<0&&(e=Math.ceil(e*o)/o,t=Math.floor(t*o)/o),r=o}}function L(e){return Math.ceil(Math.log(s(e))/Math.LN2)+1}function R(){var e=v,t=h,n=L;function r(r){Array.isArray(r)||(r=Array.from(r));var o,a,u=r.length,s=new Array(u);for(o=0;o<u;++o)s[o]=e(r[o],o,r);var c=t(s),l=c[0],f=c[1],d=n(s,l,f);if(!Array.isArray(d)){const e=f,n=+d;if(t===h&&([l,f]=N(l,f,n)),(d=C(l,f,n))[d.length-1]>=f)if(e>=f&&t===h){const e=I(l,f,n);isFinite(e)&&(e>0?f=(Math.floor(f/e)+1)*e:e<0&&(f=(Math.ceil(f*-e)+1)/-e))}else d.pop()}for(var b=d.length;d[0]<=l;)d.shift(),--b;for(;d[b-1]>f;)d.pop(),--b;var m,p=new Array(b+1);for(o=0;o<=b;++o)(m=p[o]=[]).x0=o>0?d[o-1]:l,m.x1=o<b?d[o]:f;for(o=0;o<u;++o)l<=(a=s[o])&&a<=f&&p[i(d,a,0,b)].push(r[o]);return p}return r.value=function(t){return arguments.length?(e="function"==typeof t?t:A(t),r):e},r.domain=function(e){return arguments.length?(t="function"==typeof e?e:A([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?A(S.call(e)):A(e),r):n},r}function F(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(n<o||void 0===n&&o>=o)&&(n=o)}return n}function D(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(n>o||void 0===n&&o>=o)&&(n=o)}return n}function q(e,n,r=0,o=e.length-1,i=t){for(;o>r;){if(o-r>600){const t=o-r+1,a=n-r+1,u=Math.log(t),s=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*s*(t-s)/t)*(a-t/2<0?-1:1);q(e,n,Math.max(r,Math.floor(n-a*s/t+c)),Math.min(o,Math.floor(n+(t-a)*s/t+c)),i)}const t=e[n];let a=r,u=o;for(P(e,r,n),i(e[o],t)>0&&P(e,r,o);a<u;){for(P(e,a,u),++a,--u;i(e[a],t)<0;)++a;for(;i(e[u],t)>0;)--u}0===i(e[r],t)?P(e,r,u):(++u,P(e,u,o)),u<=n&&(r=u+1),n<=u&&(o=u-1)}return e}function P(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function V(e,t,n){if(r=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n))).length){if((t=+t)<=0||r<2)return D(e);if(t>=1)return F(e);var r,o=(r-1)*t,i=Math.floor(o),a=F(q(e,i).subarray(0,i+1));return a+(D(e.subarray(i+1))-a)*(o-i)}}function B(e,t){let n,r=-1,o=-1;if(void 0===t)for(const t of e)++o,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,r=o);else for(let i of e)null!=(i=t(i,++o,e))&&(n<i||void 0===n&&i>=i)&&(n=i,r=o);return r}function U(e,t){let n,r=-1,o=-1;if(void 0===t)for(const t of e)++o,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,r=o);else for(let i of e)null!=(i=t(i,++o,e))&&(n>i||void 0===n&&i>=i)&&(n=i,r=o);return r}function $(e,t){return[e,t]}function z(e,n=t){if(1===n.length)return U(e,n);let r,o=-1,i=-1;for(const t of e)++i,(o<0?0===n(t,t):n(t,r)<0)&&(r=t,o=i);return o}var G=H(Math.random);function H(e){return function(t,n=0,r=t.length){let o=r-(n=+n);for(;o;){const r=e()*o--|0,i=t[o+n];t[o+n]=t[r+n],t[r+n]=i}return t}}function J(e){if(!(o=e.length))return[];for(var t=-1,n=D(e,Y),r=new Array(n);++t<n;)for(var o,i=-1,a=r[t]=new Array(o);++i<o;)a[i]=e[i][t];return r}function Y(e){return e.length}function K(e){return e instanceof Set?e:new Set(e)}function Q(e,t){const n=e[Symbol.iterator](),r=new Set;for(const e of t){if(r.has(e))continue;let t,o;for(;({value:t,done:o}=n.next());){if(o)return!1;if(r.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=R,e.bisect=i,e.bisectCenter=u,e.bisectLeft=a,e.bisectRight=i,e.bisector=n,e.count=s,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),n=(e=e.map(f)).map(c),r=e.length-1,o=new Array(r+1).fill(0),i=[];if(r<0||n.some(l))return i;for(;;){i.push(o.map(((t,n)=>e[n][t])));let a=r;for(;++o[a]===n[a];){if(0===a)return t?i.map(t):i;o[a--]=0}}},e.cumsum=function(e,t){var n=0,r=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:o=>n+=+t(o,r++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=b,e.difference=function(e,...t){e=new Set(e);for(const n of t)for(const t of n)e.delete(t);return e},e.disjoint=function(e,t){const n=t[Symbol.iterator](),r=new Set;for(const t of e){if(r.has(t))return!1;let e,o;for(;({value:e,done:o}=n.next())&&!o;){if(Object.is(t,e))return!1;r.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(!t(r,++n,e))return!1;return!0},e.extent=h,e.fcumsum=function(e,t){const n=new Adder;let r=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):o=>n.add(+t(o,++r,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const n=[];let r=-1;for(const o of e)t(o,++r,e)&&n.push(o);return n},e.fsum=function(e,t){const n=new Adder;if(void 0===t)for(let t of e)(t=+t)&&n.add(t);else{let r=-1;for(let o of e)(o=+t(o,++r,e))&&n.add(o)}return+n},e.greatest=function(e,n=t){let r,o=!1;if(1===n.length){let i;for(const a of e){const e=n(a);(o?t(e,i)>0:0===t(e,e))&&(r=a,i=e,o=!0)}}else for(const t of e)(o?n(t,r)>0:0===n(t,t))&&(r=t,o=!0);return r},e.greatestIndex=function(e,n=t){if(1===n.length)return B(e,n);let r,o=-1,i=-1;for(const t of e)++i,(o<0?0===n(t,t):n(t,r)>0)&&(r=t,o=i);return o},e.group=j,e.groupSort=function(e,n,r){return(1===n.length?x(O(e,n,r),(([e,n],[r,o])=>t(n,o)||t(e,r))):x(j(e,r),(([e,r],[o,i])=>n(r,i)||t(e,o)))).map((([e])=>e))},e.groups=function(e,...t){return M(e,Array.from,v,t)},e.histogram=R,e.index=function(e,...t){return M(e,v,_,t)},e.indexes=function(e,...t){return M(e,Array.from,_,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(K);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e},e.least=function(e,n=t){let r,o=!1;if(1===n.length){let i;for(const a of e){const e=n(a);(o?t(e,i)<0:0===t(e,e))&&(r=a,i=e,o=!0)}}else for(const t of e)(o?n(t,r)<0:0===n(t,t))&&(r=t,o=!0);return r},e.leastIndex=z,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,r)=>t(n,r,e)))},e.max=F,e.maxIndex=B,e.mean=function(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let o=-1;for(let i of e)null!=(i=t(i,++o,e))&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n},e.median=function(e,t){return V(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=D,e.minIndex=U,e.nice=N,e.pairs=function(e,t=$){const n=[];let r,o=!1;for(const i of e)o&&n.push(t(r,i)),r=i,o=!0;return n},e.permute=w,e.quantile=V,e.quantileSorted=function(e,t,n=r){if(o=e.length){if((t=+t)<=0||o<2)return+n(e[0],0,e);if(t>=1)return+n(e[o-1],o-1,e);var o,i=(o-1)*t,a=Math.floor(i),u=+n(e[a],a,e);return u+(+n(e[a+1],a+1,e)-u)*(i-a)}},e.quickselect=q,e.range=function(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(o);++r<o;)i[r]=e+r*n;return i},e.reduce=function(e,t,n){if("function"!=typeof t)throw new TypeError("reducer is not a function");const r=e[Symbol.iterator]();let o,i,a=-1;if(arguments.length<3){if(({done:o,value:n}=r.next()),o)return;++a}for(;({done:o,value:i}=r.next()),!o;)n=t(n,i,++a,e);return n},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=O,e.rollups=function(e,t,...n){return M(e,Array.from,t,n)},e.scan=function(e,t){const n=z(e,t);return n<0?void 0:n},e.shuffle=G,e.shuffler=H,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(t(r,++n,e))return!0;return!1},e.sort=x,e.subset=function(e,t){return Q(t,e)},e.sum=function(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let o of e)(o=+t(o,++r,e))&&(n+=o)}return n},e.superset=Q,e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(V(e,.75)-V(e,.25))*Math.pow(s(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*b(e)*Math.pow(s(e),-1/3)))},e.thresholdSturges=L,e.tickIncrement=I,e.tickStep=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/o;return i>=k?o*=10:i>=T?o*=5:i>=E&&(o*=2),t<e?-o:o},e.ticks=C,e.transpose=J,e.union=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t},e.variance=d,e.zip=function(){return J(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);