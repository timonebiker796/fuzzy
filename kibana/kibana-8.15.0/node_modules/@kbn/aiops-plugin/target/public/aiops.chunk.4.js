/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[4],{101:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(80);const o=e=>({field:void 0,...Object(n.a)(e)})},103:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a(1);var n=a(14),o=a(2),s=a(0);const i=({eventRateLength:e,fields:t,categoriesLength:a,loading:i})=>!0===i?null:0===(null==t?void 0:t.length)?Object(s.jsx)(o.EuiEmptyPrompt,{title:Object(s.jsx)("h2",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noTextFieldsTitle",defaultMessage:"No text fields found"})),titleSize:"xs",body:Object(s.jsx)("p",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noTextFieldsBody",defaultMessage:"Pattern analysis can only be run on text fields."})),"data-test-subj":"aiopsNoTextFieldsEmptyPrompt"}):0===e?Object(s.jsx)(o.EuiEmptyPrompt,{title:Object(s.jsx)("h2",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noDocsTitle",defaultMessage:"No documents found"})),titleSize:"xs",body:Object(s.jsx)("p",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noDocsBody",defaultMessage:"Ensure the selected time range contains documents."})),"data-test-subj":"aiopsNoDocsEmptyPrompt"}):e>0&&null===a?Object(s.jsx)(o.EuiEmptyPrompt,{title:Object(s.jsx)("h2",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.emptyPromptTitle",defaultMessage:"Select a text field and click run pattern analysis to start analysis"})),titleSize:"xs",body:Object(s.jsx)("p",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.emptyPromptBody",defaultMessage:"Log pattern analysis groups messages into common patterns."})),"data-test-subj":"aiopsNoWindowParametersEmptyPrompt"}):e>0&&null!==a&&0===a?Object(s.jsx)(o.EuiEmptyPrompt,{title:Object(s.jsx)("h2",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noCategoriesTitle",defaultMessage:"No patterns found"})),titleSize:"xs",body:Object(s.jsx)("p",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.aiops.logCategorization.noCategoriesBody",defaultMessage:"Ensure the selected field is populated in the selected time range."})),"data-test-subj":"aiopsNoCategoriesEmptyPrompt"}):null},104:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),o=a(54),s=a(129),i=a(43);function l(){const{http:e}=Object(i.b)(),t=Object(n.useRef)(new AbortController);return{runValidateFieldRequest:Object(n.useCallback)((async(a,n,i,l,r,u,c)=>{const d=Object(s.a)(r,i,l);return await e.post(o.a.CATEGORIZATION_FIELD_VALIDATION,{body:JSON.stringify({indexPatternTitle:a,query:d,size:5,field:n,timeField:i,start:l.from,end:l.to,runtimeMappings:u,indicesOptions:void 0,includeExamples:!1}),headers:c,version:"1",signal:t.current.signal})}),[e]),cancelRequest:Object(n.useCallback)((()=>{t.current.abort(),t.current=new AbortController}),[])}}},119:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(1),o=a.n(n),s=a(2),i=a(12),l=a(0),r=a(70),u=a(68),c=a(158);const d={name:"2781ka",styles:"color:#765b96"},p={name:"gy0jfs",styles:"color:#357160"},g={name:"ufewaa",styles:"color:#a68ac5"},b={name:"c5blr9",styles:"color:#54b399"},m=()=>{const e=Object(u.b)();return Object(n.useMemo)((()=>e?{tokenStyle:g,wildcardStyle:b}:{tokenStyle:d,wildcardStyle:p}),[e])},O=({category:e,count:t})=>{const a=(()=>{const{tokenStyle:e,wildcardStyle:t}=m();return Object(n.useCallback)(((a,n)=>{const o=a.split(" ");let s=` ${n} `;const i=o.map((e=>({id:e,start:0,end:0})));let r=0;for(let e=0;e<o.length;e++){const t=o[e];let a=0;const n=new RegExp(`(\\W)(${t})(\\W)`).exec(s);if(!n)continue;a=n.index;const l=a+t.length+1;i[e].start=r+a+1,i[e].end=r+l,s=s.slice(l),r+=l}s=` ${n} `;const u=[];let c=0;for(let n=0;n<i.length;n++){const o=`${a}-token-${n}`;u.push(Object(l.jsx)("span",{css:t,key:o},s.substring(c,i[n].start))),u.push(Object(l.jsx)("span",{css:e,key:`${o}-2`},s.substring(i[n].start,i[n].end))),c=i[n].end}return u.push(Object(l.jsx)("span",{css:t,key:a},s.substring(i[i.length-1].end))),u}),[e,t])})(),i=Object(n.useMemo)((()=>{const{key:n,examples:i}=e,r=void 0===t||t>i.length?i.length:t,u=new Array(r).fill(0).map(((e,t)=>a(n,i[t])));return u.map(((e,t)=>Object(l.jsx)(o.a.Fragment,{key:`example-${t}`},Object(l.jsx)("code",null,e),t<u.length-1?Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}):null)))}),[e,t,a]);return Object(l.jsx)(x,null,i)},f=({category:e})=>{const{tokenStyle:t,wildcardStyle:a}=m(),{regex:o}=e,s=Object(n.useMemo)((()=>{const e=o.split(/(\.\*\?)|(\.\+\?)/).filter((e=>void 0!==e)),n=[];for(let o=0;o<e.length;o++){const s=e[o],i=`regex-${o}`;s.match(/\.\*\?|\.\+\?/)?n.push(Object(l.jsx)("span",{css:a,key:i},s)):n.push(Object(l.jsx)("span",{css:t,key:i},s))}return n}),[o,t,a]);return Object(l.jsx)(x,null,Object(l.jsx)("code",null,s))},j=({category:e})=>{const{tokenStyle:t}=m();return Object(l.jsx)(x,null,Object(l.jsx)("code",{css:t},e.key))};var y={name:"1efi8gv",styles:"font-weight:bold"};const x=({children:e})=>Object(l.jsx)(s.EuiText,{css:y,size:"s"},e),_=({category:e,displayExamples:t=!0})=>{const{euiTheme:a}=Object(s.useEuiTheme)(),n=Object(l.css)({marginRight:a.size.xxl,width:"100%"},"","");return Object(l.jsx)("div",{css:n},Object(l.jsx)(s.EuiSpacer,null),Object(l.jsx)(E,{title:i.i18n.translate("xpack.aiops.logCategorization.expandedRow.title.tokens",{defaultMessage:"Tokens"})},Object(l.jsx)(j,{category:e})),Object(l.jsx)(E,{title:i.i18n.translate("xpack.aiops.logCategorization.expandedRow.title.regex",{defaultMessage:"Regex"})},Object(l.jsx)(f,{category:e})),t?Object(l.jsx)(E,{title:i.i18n.translate("xpack.aiops.logCategorization.expandedRow.title.examples",{defaultMessage:"Examples"})},Object(l.jsx)(O,{category:e})):null)},E=({title:e,children:t})=>Object(l.jsx)(o.a.Fragment,null,Object(l.jsx)(s.EuiText,{size:"s"},Object(l.jsx)("strong",null,e)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),t,Object(l.jsx)(s.EuiSpacer,null)),h=({categories:e,eventRate:t,pinnedCategory:a,setPinnedCategory:d,highlightedCategory:p,setHighlightedCategory:g,setSelectedCategories:b,openInDiscover:m,tableState:f,enableRowActions:y=!0,displayExamples:x=!0})=>{const E=Object(u.a)(),h=Object(s.useEuiBackgroundColor)("primary"),{onTableChange:T,pagination:S,sorting:v}=f,[C,k]=Object(n.useState)({}),M=Object(n.useMemo)((()=>e.some((e=>void 0!==e.sparkline))),[e]),{labels:N,openFunction:A}=m,I=Object(n.useCallback)((e=>{const t={...C};t[e.key]?delete t[e.key]:t[e.key]=Object(l.jsx)(_,{category:e,displayExamples:x}),k(t)}),[x,C]),R=[{align:"left",width:"40px",isExpander:!0,render:e=>Object(l.jsx)(s.EuiButtonIcon,{"data-test-subj":"aiopsLogPatternsColumnsButton",onClick:()=>I(e),"aria-label":C[e.key]?i.i18n.translate("xpack.aiops.logCategorization.column.collapseRow",{defaultMessage:"Collapse"}):i.i18n.translate("xpack.aiops.logCategorization.column.expandRow",{defaultMessage:"Expand"}),iconType:C[e.key]?"arrowDown":"arrowRight"}),"data-test-subj":"aiopsLogPatternsExpandRowToggle"},{field:"count",name:i.i18n.translate("xpack.aiops.logCategorization.column.count",{defaultMessage:"Count"}),sortable:!0,width:"80px"},{name:i.i18n.translate("xpack.aiops.logCategorization.column.examples",{defaultMessage:"Examples"}),sortable:!0,render:e=>Object(l.jsx)(O,{category:e,count:1})},{name:i.i18n.translate("xpack.aiops.logCategorization.column.actions",{defaultMessage:"Actions"}),sortable:!1,width:"65px",actions:[{name:N.singleSelect.in,description:N.singleSelect.in,icon:"plusInCircle",type:"icon","data-test-subj":"aiopsLogPatternsActionFilterInButton",onClick:e=>A(r.a.INCLUDE,e)},{name:N.singleSelect.out,description:N.singleSelect.out,icon:"minusInCircle",type:"icon","data-test-subj":"aiopsLogPatternsActionFilterOutButton",onClick:e=>A(r.a.EXCLUDE,e)}]}];!1===x&&R.splice(2,1,{name:Object(l.jsx)(s.EuiToolTip,{position:"top",content:i.i18n.translate("xpack.aiops.logCategorization.column.tokens.tooltip",{defaultMessage:"If the selected field is an alias, example documents cannot be displayed. Showing pattern tokens instead."})},Object(l.jsx)(o.a.Fragment,null,i.i18n.translate("xpack.aiops.logCategorization.column.tokens",{defaultMessage:"Tokens"}),Object(l.jsx)(s.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:e=>Object(l.jsx)(j,{category:e,count:1})}),!0===M&&R.splice(2,0,{field:"sparkline",name:i.i18n.translate("xpack.aiops.logCategorization.column.logRate",{defaultMessage:"Log rate"}),sortable:!1,width:"100px",render:a=>{if(void 0===a)return null;const n=t.map((({key:e,docCount:t})=>{var n;const o=null!==(n=a[e])&&void 0!==n?n:0,s=o>t?t:o;return{doc_count_overall:t-s,doc_count_significant_item:s,key:e,key_as_string:`${e}`}}));return Object(l.jsx)(c.a,{chartData:n,isLoading:null===e&&void 0===n,label:""})}});const F={selectable:()=>!0,onSelectionChange:e=>b(e)},L=e=>a&&a.key===e.key&&a.key===e.key?{backgroundColor:h}:p&&p.key===e.key?{backgroundColor:E.euiColorLightestShade}:{backgroundColor:E.euiColorEmptyShade},w=Object(l.css)({thead:{position:"sticky",insetBlockStart:0,zIndex:1,backgroundColor:E.euiColorEmptyShade,boxShadow:`inset 0 0px 0, inset 0 -1px 0 ${E.euiBorderColor}`}},"","");return Object(l.jsx)(s.EuiInMemoryTable,{compressed:!0,items:e,columns:R,selection:F,itemId:"key",onTableChange:T,pagination:S,sorting:v,"data-test-subj":"aiopsLogPatternsTable",itemIdToExpandedRowMap:C,css:w,rowProps:e=>y?{onClick:()=>{e.key===(null==a?void 0:a.key)?d(null):d(e)},onMouseEnter:()=>{g(e)},onMouseLeave:()=>{g(null)},style:L(e)}:void 0})}},120:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(1),o=a(18),s=a(61),i=a(167),l=a(129);const r=1e3,u=4,c={char_filter:["first_line_with_letters"],tokenizer:"standard",filter:[{type:"stop",stopwords:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Mon","Tue","Wed","Thu","Fri","Sat","Sun","January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","GMT","UTC"]},{type:"limit",max_token_count:"100"}]};var d=a(13);function p(e){return void 0===e?{}:e.buckets.reduce(((e,t)=>(e[t.key]=t.doc_count,e)),{})}var g=a(43),b=a(58),m=a(124),O=a(66);function f(){const[e,t]=Object(s.b)(b.c,O.c.ON_AUTOMATIC),[a,f]=Object(s.b)(b.d,O.a),{data:j}=Object(g.b)(),y=Object(n.useRef)(new AbortController),x=Object(n.useMemo)((()=>new m.a(e,t,a,f)),[]);return{runCategorizeRequest:Object(n.useCallback)(((e,t,a,n,s,g,b,m)=>{const{wrap:O,unwrap:f}=x.createRandomSamplerWrapper();return new Promise(((x,_)=>{j.search.search(function(e,t,a,n,o,s,d,p,g,b=!0,m=!0){return{params:{index:e,size:0,body:{query:Object(l.a)(o,a,n),aggs:d({categories:{categorize_text:{field:t,size:r,...b?{categorization_analyzer:c}:{}},aggs:{examples:{top_hits:{size:u,sort:[a],_source:t}},...p&&m?{sparkline:{date_histogram:{field:a,fixed_interval:`${p}ms`}}}:{},...g?{sub_time_range:{date_range:{field:a,format:"epoch_millis",ranges:[{from:g.from,to:g.to}]},aggs:{examples:{top_hits:{size:u,sort:[a],_source:t}},...p?{sparkline:{date_histogram:{field:a,fixed_interval:`${p}ms`}}}:{},...g.field?{sub_field:{filter:{term:{[g.field.name]:g.field.value}}}}:{}}}}:{}}}}),...Object(i.a)(s)?{runtime_mappings:s}:{}}}}}(e,t,a,n,s,g,O,b,m,!0,void 0===m),{abortSignal:y.current.signal}).subscribe({next:e=>{Object(o.isRunningResponse)(e)||x(function(e,t,a){var n;const{aggregations:o}=e.rawResponse;if(void 0===o)throw new Error("processCategoryResults failed, did not return aggregations.");const{categories:{buckets:s}}=a(o),i=s.map((e=>{var a,n,o,s,i,l,r,u;return{key:e.key,count:e.doc_count,examples:e.examples.hits.hits.map((e=>Object(d.get)(e._source,t))),sparkline:p(e.sparkline),subTimeRangeCount:null!==(a=null===(n=e.sub_time_range)||void 0===n?void 0:n.buckets[0].doc_count)&&void 0!==a?a:void 0,subFieldCount:null!==(o=null===(s=e.sub_time_range)||void 0===s||null===(i=s.buckets[0].sub_field)||void 0===i?void 0:i.doc_count)&&void 0!==o?o:void 0,subFieldExamples:null!==(l=null===(r=e.sub_time_range)||void 0===r?void 0:r.buckets[0].examples.hits.hits.map((e=>Object(d.get)(e._source,t))))&&void 0!==l?l:void 0,subFieldSparkline:p(null===(u=e.sub_time_range)||void 0===u?void 0:u.buckets[0].sparkline),regex:e.regex}}));return{categories:i,hasExamples:null===(n=i[0])||void 0===n?void 0:n.examples.some((e=>void 0!==e))}}(e,t,f))},error:e=>{if("AbortError"===e.name)return x({categories:[],hasExamples:!1});_(e)}})}))}),[j.search,x]),cancelRequest:Object(n.useCallback)((()=>{y.current.abort(),y.current=new AbortController}),[]),randomSampler:x}}},121:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(1),o=a(17),s=a.n(o),i=a(33),l=a.n(i),r=a(12),u=a(70),c=a(43);function d(e,t,a,n,o,s){const i=void 0===o?a:[o],l=Object(u.b)(t,i,n);return void 0!==s&&(l.bool.must=[{term:{[s.name]:s.value}}]),{query:l,meta:{alias:r.i18n.translate("xpack.aiops.logCategorization.filterAliasLabel",{defaultMessage:"Categorization - {field}",values:{field:t}}),index:e,disabled:!1}}}function p(e,t,a,o,i,u,p,g,b=(()=>{})){const{openInDiscoverWithFilter:m}=function(){const{http:{basePath:e}}=Object(c.b)();return{openInDiscoverWithFilter:(t,a,n,o,i,r,u,c)=>{var p,g;const b=l.a.encode({time:{from:s()(null===(p=i.min)||void 0===p?void 0:p.valueOf()).toISOString(),to:s()(null===(g=i.max)||void 0===g?void 0:g.valueOf()).toISOString()}}),m=l.a.encode({filters:[...o.filters,d(t,a,n,r,u,c)],index:t,interval:"auto",query:{language:o.searchQueryLanguage,query:o.searchString}}),O=`${e.get()}/app/discover#/?_g=${b}&_a=${encodeURIComponent(m)}`;window.open(O,"_blank")}}}();return{openFunction:Object(n.useCallback)(((n,l)=>{if(void 0!==p&&void 0!==t&&"string"!=typeof t&&!1===u)return p(d("",t.name,a,n,l),`Patterns - ${t.name}`),void b();const r=void 0!==g?{min:s()(g.from),max:s()(g.to)}:i.getActiveBounds();void 0!==r&&void 0!==t&&m(e,"string"==typeof t?t:t.name,a,o,r,n,l,null==g?void 0:g.field)}),[p,t,u,g,i,m,e,a,o,b]),labels:Object(n.useMemo)((()=>function(e){const t=e=>r.i18n.translate("xpack.aiops.logCategorization.flyout.filterIn",{defaultMessage:"Filter for {values, plural, one {pattern} other {patterns}}",values:{values:e?1:2}}),a=e=>r.i18n.translate("xpack.aiops.logCategorization.flyout.filterOut",{defaultMessage:"Filter out {values, plural, one {pattern} other {patterns}}",values:{values:e?1:2}}),n=e=>r.i18n.translate("xpack.aiops.logCategorization.filterIn",{defaultMessage:"Filter for {values, plural, one {pattern} other {patterns}} in Discover",values:{values:e?1:2}}),o=e=>r.i18n.translate("xpack.aiops.logCategorization.filterOut",{defaultMessage:"Filter out {values, plural, one {pattern} other {patterns}} in Discover",values:{values:e?1:2}});return e?{multiSelect:{in:t(!1),out:a(!1)},singleSelect:{in:t(!0),out:a(!0)}}:{multiSelect:{in:n(!1),out:o(!1)},singleSelect:{in:n(!0),out:o(!0)}}}(void 0!==p&&void 0!==b&&!1===u)),[u,p,b]),count:a.length}}},122:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a(1);var n=a(12);let o=function(e){return e.VALID="valid",e.PARTIALLY_VALID="partially_valid",e.INVALID="invalid",e}({}),s=function(e){return e[e.NO_EXAMPLES=0]="NO_EXAMPLES",e[e.FAILED_TO_TOKENIZE=1]="FAILED_TO_TOKENIZE",e[e.TOO_MANY_TOKENS=2]="TOO_MANY_TOKENS",e[e.TOKEN_COUNT=3]="TOKEN_COUNT",e[e.MEDIAN_LINE_LENGTH=4]="MEDIAN_LINE_LENGTH",e[e.NULL_VALUES=5]="NULL_VALUES",e[e.INSUFFICIENT_PRIVILEGES=6]="INSUFFICIENT_PRIVILEGES",e}({});s.NO_EXAMPLES,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNoDataFound",{defaultMessage:"Examples were successfully loaded."}),s.FAILED_TO_TOKENIZE,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validFailureToGetTokens",{defaultMessage:"The loaded examples were tokenized successfully."}),s.TOKEN_COUNT,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTokenLength",{defaultMessage:"More than {tokenCount} tokens per example were found in over {percentage}% of the loaded examples.",values:{percentage:Math.floor(75),tokenCount:3}}),s.MEDIAN_LINE_LENGTH,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validMedianLineLength",{defaultMessage:"The median line length of the loaded examples was less than {medianCharCount} characters.",values:{medianCharCount:400}}),s.NULL_VALUES,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNullValues",{defaultMessage:"Less than {percentage}% of the loaded examples were null.",values:{percentage:Math.floor(25)}}),s.TOO_MANY_TOKENS,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTooManyTokens",{defaultMessage:"Less than 10000 tokens were found in total in the loaded examples."}),s.INSUFFICIENT_PRIVILEGES,n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validUserPrivileges",{defaultMessage:"The user has sufficient privileges to perform the checks."});var i=a(2),l=a(0);const r=({validationResults:e})=>null===e||e.overallValidStatus===o.VALID?null:Object(l.jsx)(i.EuiCallOut,{color:"warning",title:n.i18n.translate("xpack.aiops.logCategorization.fieldValidationTitle",{defaultMessage:"The selected field is possibly not suitable for pattern analysis"})},e.validationChecks.filter((e=>e.valid!==o.VALID)).map((e=>Object(l.jsx)("div",{key:e.id},e.message))))},124:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l.g}));var n=a(1),o=a(2),s=a(51),i=a.n(s),l=a(66),r=a(155),u=a(0);const c=({randomSampler:e,reload:t})=>{const[a,s]=Object(n.useState)(!1),c=i()(e.getMode$(),e.getMode()),{buttonText:d}=Object(n.useMemo)((()=>Object(l.h)(c)),[c]);return Object(u.jsx)(o.EuiPopover,{"data-test-subj":"aiopsRandomSamplerOptionsPopover",id:"aiopsSamplingOptions",button:Object(u.jsx)(o.EuiButtonEmpty,{"data-test-subj":"aiopsLogPatternAnalysisShowSamplingOptionsButton",onClick:()=>s(!a),iconSide:"right",iconType:"arrowDown"},d),isOpen:a,closePopover:()=>s(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(u.jsx)(o.EuiPanel,{style:{maxWidth:400}},Object(u.jsx)(r.a,{randomSampler:e,reload:t})))}},129:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(13);function o(e,t,a){const o=Object(n.cloneDeep)(null!=e?e:{match_all:{}});return void 0===o.bool&&(o.bool={}),void 0===o.bool.must&&(o.bool.must=[],void 0!==o.match_all&&(o.bool.must.push({match_all:o.match_all}),delete o.match_all)),void 0!==o.multi_match&&(o.bool.should={multi_match:o.multi_match},delete o.multi_match),void 0!==a&&o.bool.must.push({range:{[t]:{gte:a.from,lte:a.to,format:"epoch_millis"}}}),o}},132:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return l}));var n=a(169),o=a(55);function s(e){var t,a,o,s;const i=null===(t=e.documentCountStats)||void 0===t?void 0:t.lastDocTimeStampMs,l=null===(a=e.documentCountStats)||void 0===a?void 0:a.totalCount,r=Object.keys(null!==(o=null===(s=e.documentCountStats)||void 0===s?void 0:s.buckets)&&void 0!==o?o:{}),u=r.length?r[0]:void 0,c=r.length?r[r.length-1]:void 0;return Object(n.a)(`${i}${l}${u}${c}`)}function i(e=[]){return Object(n.a)(`${e.join("")}`)}function l(e){const t=e.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes(o.a.TEXT)}));let a=t.find((e=>"message"===e.name));return void 0===a&&(a=t.find((e=>"error.message"===e.name))),void 0===a&&(a=t.find((e=>"event.original"===e.name))),void 0===a&&(a=t.length>0?t[0]:null),{messageField:a,dataViewFields:t}}},133:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(1),o=a.n(n),s=a(2),i=a(14),l=a(0),r={name:"1azakc",styles:"text-align:center"},u={name:"1azakc",styles:"text-align:center"};const c=({onCancel:e})=>Object(l.jsx)(o.a.Fragment,null,Object(l.jsx)(s.EuiSpacer,{size:"l"}),Object(l.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround"},Object(l.jsx)(s.EuiFlexItem,{grow:!1,css:r},Object(l.jsx)(s.EuiFlexGrid,{columns:1},Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiLoadingElastic,{size:"xl"})),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiText,null,Object(l.jsx)("h4",null,Object(l.jsx)(i.FormattedMessage,{id:"xpack.aiops.categorizeFlyout.loading.title",defaultMessage:"Loading pattern analysis"})))),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround"},Object(l.jsx)(s.EuiFlexItem,{grow:!1,css:u},Object(l.jsx)(s.EuiButton,{"data-test-subj":"aiopsLoadingCategorizationCancelButton",onClick:()=>e()},"Cancel"))))))))},155:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(1),o=a.n(n),s=a(2),i=a(12),l=a(14),r=a(51),u=a.n(r),c=a(168);function d(e,t=2){if(void 0===e)return"";if(e%1==0)return e;if(Math.abs(e)<Math.pow(10,-t))return Number.parseFloat(String(e)).toExponential(2);const a=Math.pow(10,t);return Math.round(e*a)/a}var p=a(66),g=a(0);const b=({samplingProbability:e,setSamplingProbability:t})=>{const[a,o]=Object(n.useState)(e),r=!Object(c.a)(a)||isNaN(a)||a<p.b||a>.5,u=100*(null!=a?a:p.b);return Object(g.jsx)(s.EuiFlexItem,{grow:!0},Object(g.jsx)(s.EuiSpacer,{size:"m"}),Object(g.jsx)(s.EuiFormRow,{fullWidth:!0,label:i.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.randomSamplerPercentageRowLabel",{defaultMessage:"Sampling percentage"}),helpText:i.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.randomSamplerPercentageRowHelpText",{defaultMessage:"Choose a value between 0.001% and 50% to randomly sample data."})},Object(g.jsx)(s.EuiRange,{fullWidth:!0,showValue:!0,showRange:!0,showLabels:!0,showInput:"inputWithPopover",min:p.f,max:50,value:d(u,u>=1?0:3),ticks:p.d.map((e=>({value:e,label:.001===e||e>=5?`${e}`:""}))),isInvalid:r,onChange:e=>{const t=parseFloat(e.target.value),n=a?100*a:t;if(t>0&&t<=1)o(t/100);else{const e=t>n?Math.ceil(t):Math.floor(t);o(e/100)}},step:p.f,"data-test-subj":"dvRandomSamplerProbabilityRange",append:Object(g.jsx)(s.EuiButton,{"data-test-subj":"aiopsRandomSamplerRangeSliderApplyButton",disabled:r,onClick:()=>{t&&Object(c.a)(a)&&t(a)}},Object(g.jsx)(l.FormattedMessage,{id:"xpack.aiops.logCategorization.randomSamplerSettingsPopUp.randomSamplerPercentageApply",defaultMessage:"Apply"}))})))},m=({randomSampler:e,reload:t,calloutPosition:a="top"})=>{const l=u()(e.getProbability$(),e.getProbability()),r=Object(n.useCallback)((a=>{e.setProbability(a),t()}),[t,e]),c=u()(e.getMode$(),e.getMode()),d=Object(n.useCallback)((a=>{e.setMode(a),t()}),[e,t]),{calloutInfoMessage:m}=Object(n.useMemo)((()=>Object(p.h)(c)),[c]);return Object(g.jsx)(o.a.Fragment,null,"top"===a?Object(g.jsx)(f,{calloutInfoMessage:m,calloutPosition:a}):null,Object(g.jsx)(s.EuiFormRow,{"data-test-subj":"aiopsRandomSamplerOptionsFormRow",label:i.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.randomSamplerRowLabel",{defaultMessage:"Random sampling"}),helpText:c===p.c.ON_AUTOMATIC?Object(g.jsx)(O,{samplingProbability:l}):null},Object(g.jsx)(s.EuiSuperSelect,{"data-test-subj":"aiopsRandomSamplerOptionsSelect",options:p.e,valueOfSelected:c,onChange:d})),c===p.c.ON_MANUAL?Object(g.jsx)(b,{samplingProbability:l,setSamplingProbability:r}):null,"bottom"===a?Object(g.jsx)(f,{calloutInfoMessage:m,calloutPosition:a}):null)},O=({samplingProbability:e})=>null!==e?Object(g.jsx)("div",{"data-test-subj":"aiopsRandomSamplerProbabilityUsedMsg"},Object(g.jsx)(l.FormattedMessage,{id:"xpack.aiops.logCategorization.randomSamplerSettingsPopUp.probabilityLabel",defaultMessage:"Probability used: {samplingProbability}%",values:{samplingProbability:Number((100*e).toPrecision(3))}})):null,f=({calloutInfoMessage:e,calloutPosition:t})=>Object(g.jsx)(o.a.Fragment,null,"bottom"===t?Object(g.jsx)(s.EuiSpacer,{size:"s"}):null,Object(g.jsx)(s.EuiCallOut,{size:"s",color:"primary",title:e}),"top"===t?Object(g.jsx)(s.EuiSpacer,{size:"s"}):null)},156:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a(1);var n=a(17),o=a.n(n),s=a(2),i=a(14),l=a(12),r=a(43),u=a(0);const c=({dataView:e,field:t,query:a,earliest:n,latest:c,iconOnly:d=!1})=>{const{uiActions:p,application:{capabilities:g}}=Object(r.b)(),b=()=>{if(void 0===p)return;const s={dataView:e,field:t,query:a,timeRange:{from:o()(n).toISOString(),to:o()(c).toISOString()}};p.getTrigger("CREATE_PATTERN_ANALYSIS_TO_ML_AD_JOB_TRIGGER").exec(s)};return void 0===p||!1===g.ml.canCreateJob?null:d?Object(u.jsx)(s.EuiToolTip,{content:l.i18n.translate("xpack.aiops.categorizeFlyout.findAnomalies.tooltip",{defaultMessage:"Create anomaly detection job to find anomalies in patterns"})},Object(u.jsx)(s.EuiButtonIcon,{"data-test-subj":"aiopsEmbeddableMenuOptionsButton",size:"s",iconType:"machineLearningApp",onClick:b,color:"subdued","aria-label":l.i18n.translate("xpack.aiops.categorizeFlyout.findAnomalies.tooltip",{defaultMessage:"Create anomaly detection job to find anomalies in patterns"})})):Object(u.jsx)(s.EuiButtonEmpty,{"data-test-subj":"aiopsLogCategorizationFlyoutAdJobButton",onClick:b,flush:"left",iconSide:"left",iconType:"machineLearningApp"},Object(u.jsx)(i.FormattedMessage,{id:"xpack.aiops.categorizeFlyout.findAnomalies",defaultMessage:"Find anomalies in patterns"}))}},55:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(59),o=a.n(n);let s=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),i=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){o()(this,"name",void 0),o()(this,"sortable",void 0),o()(this,"filterable",void 0),o()(this,"esTypes",void 0),this.name=e.name||i.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}const l=new kbn_field_type_KbnFieldType({name:i.UNKNOWN}),r=[new kbn_field_type_KbnFieldType({name:i.STRING,sortable:!0,filterable:!0,esTypes:[s.STRING,s.TEXT,s.MATCH_ONLY_TEXT,s.KEYWORD,s.VERSION,s._TYPE,s._ID]}),new kbn_field_type_KbnFieldType({name:i.NUMBER,sortable:!0,filterable:!0,esTypes:[s.FLOAT,s.HALF_FLOAT,s.SCALED_FLOAT,s.DOUBLE,s.INTEGER,s.LONG,s.UNSIGNED_LONG,s.SHORT,s.BYTE,s.TOKEN_COUNT,s.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:i.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[s.FLOAT_RANGE,s.DOUBLE_RANGE,s.INTEGER_RANGE,s.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:i.DATE,sortable:!0,filterable:!0,esTypes:[s.DATE,s.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:i.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[s.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:i.IP,sortable:!0,filterable:!0,esTypes:[s.IP]}),new kbn_field_type_KbnFieldType({name:i.IP_RANGE,sortable:!0,filterable:!0,esTypes:[s.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:i.BOOLEAN,sortable:!0,filterable:!0,esTypes:[s.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:i.OBJECT,esTypes:[s.OBJECT]}),new kbn_field_type_KbnFieldType({name:i.NESTED,esTypes:[s.NESTED]}),new kbn_field_type_KbnFieldType({name:i.GEO_POINT,esTypes:[s.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:i.GEO_SHAPE,esTypes:[s.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:i.ATTACHMENT,esTypes:[s.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:i.MURMUR3,esTypes:[s.MURMUR3]}),new kbn_field_type_KbnFieldType({name:i._SOURCE,esTypes:[s._SOURCE]}),new kbn_field_type_KbnFieldType({name:i.HISTOGRAM,filterable:!0,esTypes:[s.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:i.CONFLICT}),l],u=e=>{const t=r.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:i.UNKNOWN};function c(e){switch(e){case s._INDEX:return i.STRING;case"_version":return i.NUMBER;case"datetime":return i.DATE;default:return u(e)}}},66:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return u})),a.d(t,"f",(function(){return c})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"e",(function(){return g})),a.d(t,"g",(function(){return RandomSampler})),a.d(t,"h",(function(){return b}));var n=a(59),o=a.n(n),s=a(3),i=a(280),l=a(12);const r=[1e-5,5e-5,1e-4,5e-4,.001,.005,.01,.05,.1,.2,.3,.4,.5].map((e=>100*e)),u=1e-5,c=100*u,d=.001,p={ON_AUTOMATIC:"on_automatic",ON_MANUAL:"on_manual",OFF:"off"},g=[{"data-test-subj":"aiopsRandomSamplerOptionOnAutomatic",value:p.ON_AUTOMATIC,inputDisplay:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerPreference.onAutomaticLabel",{defaultMessage:"On - automatic"})},{"data-test-subj":"aiopsRandomSamplerOptionOnManual",value:p.ON_MANUAL,inputDisplay:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerPreference.onManualLabel",{defaultMessage:"On - manual"})},{"data-test-subj":"aiopsRandomSamplerOptionOff",value:p.OFF,inputDisplay:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerPreference.offLabel",{defaultMessage:"Off"})}];class RandomSampler{constructor(e,t,a,n){o()(this,"docCount$",new s.BehaviorSubject(0)),o()(this,"mode$",new s.BehaviorSubject(p.ON_AUTOMATIC)),o()(this,"probability$",new s.BehaviorSubject(d)),o()(this,"setRandomSamplerModeInStorage",void 0),o()(this,"setRandomSamplerProbabilityInStorage",void 0),this.mode$.next(e),this.setRandomSamplerModeInStorage=t,this.probability$.next(a),this.setRandomSamplerProbabilityInStorage=n}setDocCount(e){return this.docCount$.next(e)}getDocCount(){return this.docCount$.getValue()}setMode(e){return this.setRandomSamplerModeInStorage(e),this.mode$.next(e)}getMode$(){return this.mode$.asObservable()}getMode(){return this.mode$.getValue()}setProbability(e){return this.setRandomSamplerProbabilityInStorage(e),this.probability$.next(e)}getProbability$(){return this.probability$.asObservable()}getProbability(){return this.probability$.getValue()}createRandomSamplerWrapper(){const e=this.getMode(),t=this.getProbability();let a={};e===p.ON_MANUAL?a={probability:t}:e===p.OFF&&(a={probability:1});const n=Object(i.a)({...a,totalNumDocs:this.getDocCount()});return this.setProbability(n.probability),n}}const b=e=>{switch(e){case p.OFF:return{calloutInfoMessage:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.offCallout.message",{defaultMessage:"Random sampling can be turned on to increase analysis speed. Accuracy will slightly decrease."}),buttonText:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.offCallout.button",{defaultMessage:"No sampling"})};case p.ON_AUTOMATIC:return{calloutInfoMessage:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.onAutomaticCallout.message",{defaultMessage:"The pattern analysis will use random sampler aggregations. The probability is automatically set to balance accuracy and speed."}),buttonText:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.onAutomaticCallout.button",{defaultMessage:"Auto sampling"})};case p.ON_MANUAL:default:return{calloutInfoMessage:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.onManualCallout.message",{defaultMessage:"The pattern analysis will use random sampler aggregations. A lower percentage probability increases performance, but some accuracy is lost."}),buttonText:l.i18n.translate("xpack.aiops.logCategorization.randomSamplerSettingsPopUp.onManualCallout.button",{defaultMessage:"Manual sampling"})}}}},79:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1),o=a(18),s=a(50),i=a(80),l=a(43);const r=({dataView:e,savedSearch:t},a,r=!1)=>{const{uiSettings:u,data:{query:{filterManager:c}}}=Object(l.b)(),d=Object(n.useMemo)((()=>Object(s.b)({dataView:e,uiSettings:u,savedSearch:t,filterManager:c})),[e,u,t,c]);return Object(n.useMemo)((()=>{if(void 0===d||a&&""!==a.searchString){if(null!=a&&a.filters&&!1===r){const e=null==c?void 0:c.getGlobalFilters();c&&c.setFilters(a.filters),e&&(null==c||c.addFilters(e))}let t=null==a?void 0:a.searchQuery;const n={language:null==a?void 0:a.searchQueryLanguage,query:null==a?void 0:a.searchString};return(""!==a.searchString||Array.isArray(a.filters)&&a.filters.length>0)&&(Object(i.b)(t)||void 0===t)&&Object(o.isQuery)(n)&&(t=Object(s.a)(n,a.filters,e,u)),{...Object(i.b)(t)?{}:{searchQuery:t},searchString:null==a?void 0:a.searchString,searchQueryLanguage:null==a?void 0:a.searchQueryLanguage}}return{searchQuery:d.searchQuery,searchString:d.searchString,searchQueryLanguage:d.queryLanguage}}),[JSON.stringify([d,a])])}},80:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l}));var n=a(167),o=a(260);const s={match_all:{}},i=e=>Object(n.a)(e,["match_all"]),l=e=>({searchString:"",searchQuery:s,searchQueryLanguage:o.a.KUERY,filters:[],...e})},90:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(1);function o(e,t,a="asc",o){var s,i,l;const[r,u]=Object(n.useState)(null!==(s=null==o?void 0:o.pageIndex)&&void 0!==s?s:0),[c,d]=Object(n.useState)(null!==(i=null==o?void 0:o.pageSize)&&void 0!==i?i:10),[p,g]=Object(n.useState)(t),[b,m]=Object(n.useState)(a);return{onTableChange:({page:e={index:0,size:10},sort:t={field:p,direction:b}})=>{const{index:a,size:n}=e;u(a),d(n);const{field:o,direction:s}=t;g(o),m(s)},pagination:{pageIndex:r,pageSize:c,totalItemCount:(null!=e?e:[]).length,pageSizeOptions:null!==(l=null==o?void 0:o.pageSizeOptions)&&void 0!==l?l:[10,20,50],showPerPageOptions:!0},sorting:{sort:{field:p,direction:b}},setPageIndex:u}}}}]);