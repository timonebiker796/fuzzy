/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[5],{105:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(1);const i=Object(s.createContext)(void 0)},106:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));const s={startPageChange:"start::pageChange",endPageReady:"end::pageReady"}},117:function(e,t,a){"use strict";a.d(t,"a",(function(){return Xe})),a.d(t,"b",(function(){return st}));var s=a(13),i=a(1),l=a.n(i),n=a(2),o=a(14),r=a(170),u=a(279),c=a(261),d=a(263),p=a(102),b=a(139),g=a(188),j=a(194),m=a(4),f=a.n(m),y=a(12),x=a(266),O=a(267),h=a(240),v=a(0);const T=Object(i.memo)((e=>{var t,a;const s=Object(b.a)(),i=Object(x.a)(),l=Object(O.a)(),{documentStats:n,initialAnalysisStart:o,isBrushCleared:r}=Object(b.b)((e=>e.logRateAnalysis)),{documentCountStats:u,documentCountStatsCompare:c}=n,d=Object.keys(null!==(t=null==u?void 0:u.buckets)&&void 0!==t?t:{}).map((e=>+e)),p=Object.keys(null!==(a=null==c?void 0:c.buckets)&&void 0!==a?a:{}).map((e=>+e)),j=Math.min(...d,...p),m=Math.max(...d,...p);if(void 0===u||void 0===u.buckets||void 0===u.interval||void 0===j||void 0===m)return null;const T=(k=i,(R=l)?`${null==R?void 0:R.fieldName}:${null==R?void 0:R.fieldValue}`:k?y.i18n.translate("xpack.aiops.logRateAnalysis.page.documentCountStatsSplitGroupLabel",{defaultMessage:"Selected group"}):"");var R,k;const S=Object.entries(u.buckets).map((([e,t])=>({time:+e,value:t})));let C;return void 0!==(null==c?void 0:c.buckets)&&(C=Object.entries(null==c?void 0:c.buckets).map((([e,t])=>({time:+e,value:t})))),Object(v.jsx)(h.a,f()({},e,{chartPointsSplitLabel:T,timeRangeEarliest:j,timeRangeLatest:m,interval:u.interval,chartPoints:S,chartPointsSplit:C,autoAnalysisStart:o,brushSelectionUpdateHandler:e=>s(Object(g.a)(e)),isBrushCleared:r,setAutoRunAnalysisFn:e=>s(Object(g.d)(e))}))}));var R=a(43),k=a(159);const S=({barColorOverride:e,barHighlightColorOverride:t,...a})=>{const{data:s,uiSettings:i,fieldFormats:l,charts:o}=Object(R.b)(),{documentStats:r}=Object(b.b)((e=>e.logRateAnalysis)),{sampleProbability:u,totalCount:c,documentCountStats:d}=r;return void 0===d?void 0!==c?Object(v.jsx)(k.a,{totalCount:c,sampleProbability:u}):null:Object(v.jsx)(n.EuiFlexGroup,{gutterSize:"m",direction:"column"},Object(v.jsx)(n.EuiFlexItem,null,Object(v.jsx)(k.a,{totalCount:c,sampleProbability:u})),Object(v.jsx)(n.EuiFlexItem,null,Object(v.jsx)(T,f()({dependencies:{data:s,uiSettings:i,fieldFormats:l,charts:o},barColorOverride:e,barHighlightColorOverride:t,changePoint:d.changePoint},a))))};a(105),a(106);const C=e=>{const{children:t,progress:a,progressMessage:s,onRefresh:r,onCancel:u,onReset:c,isBrushCleared:d,isRunning:p,shouldRerunAnalysis:b,runAnalysisDisabled:g=!1}=e,j=Math.round(100*a),{euiTheme:m}=Object(n.useEuiTheme)(),f=(x=m.colors.success,Object(i.useMemo)((()=>{const e={background:`repeating-linear-gradient(\n            -45deg,\n            transparent 0 6px,\n            rgba(0, 0, 0, 0.1) 6px 12px\n          ),\n          ${x}`,backgroundSize:"calc(12px / 0.707) 100%,  100% 800%",backgroundPosition:"inherit"};return Object(v.css)({"progress[value]":{animation:"aiopsAnimatedProgress 4s infinite linear","::-webkit-progress-inner-element":{overflow:"hidden",backgroundPosition:"inherit"},"::-webkit-progress-bar":{backgroundColor:"transparent",backgroundPosition:"inherit"},"::-webkit-progress-value":e,"::-moz-progress-bar":e,"@keyframes aiopsAnimatedProgress":{"0%":{backgroundPosition:"0 0"},"100%":{backgroundPosition:"calc(10 * (12px / 0.707)) 100%"}}}},"","")}),[x]));var x;return Object(v.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(v.jsx)(n.EuiFlexItem,{grow:!1},!p&&Object(v.jsx)(n.EuiButton,{disabled:g,"data-test-subj":"aiopsRerunAnalysisButton"+(b?" shouldRerun":""),size:"s",onClick:r,color:b?"warning":"primary"},Object(v.jsx)(n.EuiFlexGroup,null,Object(v.jsx)(n.EuiFlexItem,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.rerunAnalysisButtonTitle",defaultMessage:"Run analysis"})),b&&Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiFlexItem,null,Object(v.jsx)(n.EuiIconTip,{"aria-label":"Warning",type:"warning",color:"warning",content:y.i18n.translate("xpack.aiops.rerunAnalysisTooltipContent",{defaultMessage:"Analysis data may be out of date due to selection update. Rerun analysis."})}))))),p&&Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsCancelAnalysisButton",size:"s",onClick:u},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.cancelAnalysisButtonTitle",defaultMessage:"Cancel"}))),1!==a&&!1!==p||d?null:Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsClearSelectionBadge",size:"s",onClick:c,color:"text"},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.resetLabel",defaultMessage:"Reset"}))),Object(v.jsx)(n.EuiFlexItem,null,1===a?Object(v.jsx)(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiIcon,{type:"checkInCircleFilled",color:m.colors.success})),Object(v.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"aiopsAnalysisComplete"},Object(v.jsx)("small",null,y.i18n.translate("xpack.aiops.analysisCompleteLabel",{defaultMessage:"Analysis complete"})))):null,Object(v.jsx)(n.EuiFlexGroup,{direction:"column",gutterSize:"none",css:1===a?{display:"none"}:void 0},Object(v.jsx)(n.EuiFlexItem,{"data-test-subj":"aiopProgressTitle"},Object(v.jsx)(n.EuiText,{size:"xs",color:"subdued"},Object(v.jsx)(o.FormattedMessage,{"data-test-subj":"aiopsProgressTitleMessage",id:"xpack.aiops.progressTitle",defaultMessage:"Progress: {progress}% â€” {progressMessage}",values:{progress:j,progressMessage:s}}))),Object(v.jsx)(n.EuiFlexItem,{css:p?f:void 0},Object(v.jsx)(n.EuiProgress,{"aria-label":y.i18n.translate("xpack.aiops.progressAriaLabel",{defaultMessage:"Progress"}),value:j,max:100,size:"m"})))),t)};var A=a(276),M=a(54),E=a(45),I=a(258),w=a(70);const F={HIGH:y.i18n.translate("xpack.aiops.correlations.highImpactText",{defaultMessage:"High"}),MEDIUM:y.i18n.translate("xpack.aiops.correlations.mediumImpactText",{defaultMessage:"Medium"}),LOW:y.i18n.translate("xpack.aiops.correlations.lowImpactText",{defaultMessage:"Low"}),VERY_LOW:y.i18n.translate("xpack.aiops.correlations.veryLowImpactText",{defaultMessage:"Very low"})};var P=a(168);a(189);const L=({isOpen:e,closePopover:t,renderHeader:a,renderContent:s,...i})=>{let o=null,r=null;if(e){try{o=(null==a?void 0:a())||null}catch(e){console.error(e)}try{r=(null==s?void 0:s())||null}catch(e){console.error(e)}}return Object(v.jsx)(n.EuiPopover,f()({ownFocus:!0,isOpen:e,closePopover:t,display:"block",anchorPosition:"rightUp","data-test-subj":"fieldPopover",panelClassName:"unifiedFieldList__fieldPopover__fieldPopoverPanel"},i),e&&Object(v.jsx)(l.a.Fragment,null,r&&o?Object(v.jsx)(n.EuiPopoverTitle,null,o):o,r))},B=({field:e,color:t,truncate:a=!0})=>{const{euiTheme:s}=Object(n.useEuiTheme)(),o=((null==e?void 0:e.customDescription)||"").trim(),r=Boolean(a&&o.length>110),[u,c]=Object(i.useState)(r);return o?Object(v.jsx)("div",{"data-test-subj":`fieldDescription-${e.name}`},u?Object(v.jsx)(n.EuiText,{color:t,size:"xs",className:"eui-textBreakWord eui-textLeft"},Object(v.jsx)("button",{"data-test-subj":`toggleFieldDescription-${e.name}`,title:y.i18n.translate("fieldUtils.fieldDescription.viewMoreButton",{defaultMessage:"View full field description"}),className:"eui-textBreakWord eui-textLeft",onClick:()=>c(!1),css:Object(v.css)("padding:0;margin:0;color:","subdued"===t?s.colors.subduedText:s.colors.text,";line-height:inherit;font-size:inherit;&:hover,&:active,&:focus{color:",s.colors.link,";}","")},Object(v.jsx)(n.EuiTextBlockTruncate,{lines:2},o))):Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiText,{color:t,size:"xs",className:"eui-textBreakWord eui-textLeft"},o),r&&Object(v.jsx)(n.EuiButtonEmpty,{size:"xs",flush:"both","data-test-subj":`toggleFieldDescription-${e.name}`,onClick:()=>c(!0)},y.i18n.translate("fieldUtils.fieldDescription.viewLessButton",{defaultMessage:"View less"})))):null},D=({field:e,closePopover:t,buttonAddFieldToWorkspaceProps:a,buttonAddFilterProps:s,buttonEditFieldProps:i,buttonDeleteFieldProps:o,onAddFieldToWorkspace:r,onAddFilter:u,onEditField:c,onDeleteField:d})=>{var p,b,g,j;if(!e)return null;const m=y.i18n.translate("unifiedFieldList.fieldPopover.addFieldToWorkspaceLabel",{defaultMessage:'Add "{field}" field',values:{field:e.displayName}}),x=y.i18n.translate("unifiedFieldList.fieldPopover.addExistsFilterLabel",{defaultMessage:"Filter for field present"}),O=y.i18n.translate("unifiedFieldList.fieldPopover.editFieldLabel",{defaultMessage:"Edit data view field"}),h=y.i18n.translate("unifiedFieldList.fieldPopover.deleteFieldLabel",{defaultMessage:"Delete data view field"});return Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(v.jsx)(n.EuiFlexItem,{grow:!0},Object(v.jsx)(n.EuiTitle,{size:"xxs","data-test-subj":"fieldPopoverHeader_fieldDisplayName"},Object(v.jsx)("h5",{className:"eui-textBreakWord"},e.displayName))),r&&Object(v.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"fieldPopoverHeader_addField"},Object(v.jsx)(n.EuiToolTip,{content:null!==(p=null==a?void 0:a["aria-label"])&&void 0!==p?p:m},Object(v.jsx)(n.EuiButtonIcon,f()({"data-test-subj":`fieldPopoverHeader_addField-${e.name}`,"aria-label":m},a||{},{iconType:"plusInCircle",onClick:()=>{t(),r(e)}})))),u&&e.filterable&&!e.scripted&&Object(v.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"fieldPopoverHeader_addExistsFilter"},Object(v.jsx)(n.EuiToolTip,{content:null!==(b=null==s?void 0:s["aria-label"])&&void 0!==b?b:x},Object(v.jsx)(n.EuiButtonIcon,f()({"data-test-subj":`fieldPopoverHeader_addExistsFilter-${e.name}`,"aria-label":x},s||{},{iconType:"filter",onClick:()=>{t(),u("_exists_",e.name,"+")}})))),c&&(e.isRuntimeField||!["unknown","unknown_selected"].includes(e.type))&&Object(v.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"fieldPopoverHeader_editField"},Object(v.jsx)(n.EuiToolTip,{content:null!==(g=null==i?void 0:i["aria-label"])&&void 0!==g?g:O},Object(v.jsx)(n.EuiButtonIcon,f()({"data-test-subj":`fieldPopoverHeader_editField-${e.name}`,"aria-label":O},i||{},{iconType:"pencil",onClick:()=>{t(),c(e.name)}})))),d&&e.isRuntimeField&&Object(v.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"fieldPopoverHeader_deleteField"},Object(v.jsx)(n.EuiToolTip,{content:null!==(j=null==o?void 0:o["aria-label"])&&void 0!==j?j:h},Object(v.jsx)(n.EuiButtonIcon,f()({"data-test-subj":`fieldPopoverHeader_deleteField-${e.name}`,"aria-label":h},o||{},{color:"danger",iconType:"trash",onClick:()=>{t(),d(e.name)}}))))),e.customDescription?Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiSpacer,{size:"xs"}),Object(v.jsx)(B,{field:e})):null)};var z=a(68);const N=()=>Object(v.jsx)(i.Fragment,null),_=l.a.lazy((()=>a.e(10).then(a.bind(null,239)))),G=l.a.lazy((()=>Promise.all([a.e(10),a.e(16)]).then(a.bind(null,269)))),V=e=>Object(v.jsx)(l.a.Suspense,{fallback:Object(v.jsx)(N,null)},Object(v.jsx)(G,e)),H=e=>Object(v.jsx)(l.a.Suspense,{fallback:Object(v.jsx)(N,null)},Object(v.jsx)(_,e));var q=a(17),$=a.n(q);const U=Object(n.euiPaletteColorBlind)()[0],W={color:"accent",textProps:{color:"accent"}},Q=({dataView:e,field:t,fieldName:a,fieldValue:s,fieldStatsServices:r,timeRangeMs:u,dslQuery:c})=>{const[d,p]=Object(i.useState)(),b=Object(i.useMemo)((()=>{if(u)return{from:$()(u.from).toISOString(),to:$()(u.to).toISOString()};const e=$()();return{from:e.toISOString(),to:e.toISOString()}}),[u]),g=Object(i.useCallback)((e=>{p(e)}),[]),j=Object(i.useMemo)((()=>{const e={needToDisplayIndividualStat:!1,percentage:"< 1%"};if(void 0===d)return e;const{topValues:t,sampledValues:i}=d;if(-1===(null!=t&&t.buckets&&Array.isArray(t.buckets)?t.buckets.findIndex((e=>e.key===s)):null)&&void 0!==a&&void 0!==s){var l;e.needToDisplayIndividualStat=!0;const a=null!=t&&t.buckets&&Array.isArray(t.buckets)?t.buckets:[];let s;const n=a.some((e=>!Number.isInteger(e.count/(null!=i?i:5e3))));a.forEach((e=>{const t=function(e,t,a){const s=t>0?`${(Math.round(e/t*1e3)/10).toFixed(a?1:0)}`:"";return Number(s)}(e.count,null!=i?i:5e3,n);(void 0===s||t<s)&&(s=t)})),e.percentage=`< ${null!==(l=s)&&void 0!==l?l:1}%`}return e}),[d,a,s]),m=Object(i.useCallback)((e=>"other"===e.type?{color:"primary"}:s===e.fieldValue?W:{}),[s]);if(!(b&&Object(P.a)(e)&&t))return null;const y=e.getFormatterForField(t);return Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(V,{key:t.name,services:r,dslQuery:null!=c?c:{match_all:{}},fromDate:b.from,toDate:b.to,dataViewOrDataViewId:e,field:t,"data-test-subj":`mlAiOpsFieldStatsPopoverContent ${t.name}`,color:U,onStateChange:g,overrideFieldTopValueBar:m}),j.needToDisplayIndividualStat?Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiHorizontalRule,{margin:"s"}),Object(v.jsx)(n.EuiText,{size:"xs",color:"subdued"},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.fieldContextPopover.notTopTenValueMessage",defaultMessage:"Selected term is not in the top 10"})),Object(v.jsx)(n.EuiSpacer,{size:"s"}),Object(v.jsx)(H,f()({field:t,fieldValue:s,formattedPercentage:j.percentage,formattedFieldValue:y.convert(s),progressValue:100,count:0,overrideFieldTopValueBar:m,"data-test-subj":"aiopsNotInTopTenFieldTopValueBucket"},W))):null)};function K({dataView:e,dslQuery:t,fieldName:a,fieldValue:s,fieldStatsServices:l,timeRangeMs:o}){const[r,u]=Object(i.useState)(!1),c=Object(z.a)(),d=Object(i.useCallback)((()=>u(!1)),[]),p=Object(i.useMemo)((()=>Object(P.a)(a)?e.getFieldByName(a):void 0),[a,e]),b=Object(v.jsx)(n.EuiToolTip,{content:y.i18n.translate("xpack.aiops.fieldContextPopover.descriptionTooltipContent",{defaultMessage:"Show top field values"})},Object(v.jsx)(n.EuiButtonIcon,{iconType:"inspect",onClick:e=>{u(!r)},"aria-label":y.i18n.translate("xpack.aiops.fieldContextPopover.topFieldValuesAriaLabel",{defaultMessage:"Show top field values"}),"data-test-subj":"aiopsContextPopoverButton",css:Object(v.css)({marginLeft:c.euiSizeXS},"","")}));return p?Object(v.jsx)(L,{isOpen:r,closePopover:d,button:b,renderHeader:()=>Object(v.jsx)(D,{field:p,closePopover:d}),renderContent:()=>Object(v.jsx)(Q,{field:p,fieldName:a,fieldValue:s,dataView:e,fieldStatsServices:l,timeRangeMs:o,dslQuery:t})}):null}var Y=a(260),J={name:"1oaeivz",styles:"margin-right:8px"},X={name:"f3vz0n",styles:"font-weight:500"};const Z=({iconType:e,dataTestSubjPostfix:t,isDisabled:a,label:s,tooltipText:i,onClick:o})=>{const r=Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiIcon,{type:e,css:J}),s),u=a?Object(v.jsx)(n.EuiText,{"data-test-subj":`aiopsTableActionButton${t} disabled`,size:"s",color:"subdued","aria-label":i,css:X},r):Object(v.jsx)(n.EuiLink,{"data-test-subj":`aiopsTableActionButton${t} enabled`,onClick:o,color:"text","aria-label":i},r);return i?Object(v.jsx)(n.EuiToolTip,{content:i},u):u};var ee=a(15),te=a(167);function ae(e){return Object(te.a)(e,["key","type","fieldName","fieldValue","doc_count","bg_count","total_doc_count","total_bg_count","score","pValue","normalizedScore"])}const se=e=>ae(e)?`${Object(ee.escapeKuery)(e.fieldName)}:"${Object(ee.escapeQuotes)(String(e.fieldValue))}"`:[...e.groupItemsSortedByUniqueness.map((({fieldName:e,fieldValue:t})=>`${Object(ee.escapeKuery)(e)}:"${Object(ee.escapeQuotes)(String(t))}"`))].join(" AND "),ie=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.linksMenu.viewInDiscover",{defaultMessage:"View in Discover"}),le=e=>ae(e)&&e.type===I.a.LOG_PATTERN,ne=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.linksMenu.viewInLogPatternAnalysis",{defaultMessage:"View in Log Pattern Analysis"}),oe=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.linksMenu.copyToClipboardButtonLabel",{defaultMessage:"Copy to clipboard"}),re=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.linksMenu.copyToClipboardSignificantItemMessage",{defaultMessage:"Copy field/value pair as KQL syntax to clipboard"}),ue=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.linksMenu.copyToClipboardGroupMessage",{defaultMessage:"Copy group items as KQL syntax to clipboard"});var ce=a(158);function de(e,t,a,s,i){let l,n;return e===p.a.SPIKE?(void 0!==i&&(l=Math.round(i/t)),void 0!==s&&(n=Math.round(s/a))):(void 0!==s&&(l=Math.round(s/t)),void 0!==i&&(n=Math.round(i/a))),{baselineBucketRate:l,deviationBucketRate:n}}const pe="--",be={"Log rate":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.logRateColumnTitle",{defaultMessage:"Log rate"}),"Doc count":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.docCountColumnTitle",{defaultMessage:"Doc count"}),"p-value":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.pValueColumnTitle",{defaultMessage:"p-value"}),Impact:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.impactColumnTitle",{defaultMessage:"Impact"}),"Baseline rate":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.baselineRateColumnTitle",{defaultMessage:"Baseline rate"}),"Deviation rate":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.deviationRateColumnTitle",{defaultMessage:"Deviation rate"}),"Log rate change":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.logRateChangeColumnTitle",{defaultMessage:"Log rate change"}),Actions:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.actionsColumnTitle",{defaultMessage:"Actions"})},ge={"Field name":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.fieldNameColumnTitle",{defaultMessage:"Field name"}),"Field value":y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.fieldValueColumnTitle",{defaultMessage:"Field value"}),...be},je="groups",me=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.logRateColumnTooltip",{defaultMessage:"A visual representation of the impact of the field on the message rate difference"}),fe=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateColumnTooltip",{defaultMessage:"A visual representation of the impact of the group on the message rate difference."}),ye=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.impactLabelColumnTooltip",{defaultMessage:"The level of impact of the group on the message rate difference"}),xe=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.impactLabelColumnTooltip",{defaultMessage:"The level of impact of the field on the message rate difference."}),Oe=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateChangeLabelColumnTooltip",{defaultMessage:"The factor by which the log rate changed. This value is normalized to account for differing lengths in baseline and deviation time ranges."}),he=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.baselineRateLabelColumnTooltip",{defaultMessage:"The average number of documents per baseline bucket."}),ve=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.deviationRateLabelColumnTooltip",{defaultMessage:"The average number of documents per deviation bucket."});var Te={name:"fa61i",styles:"padding-inline:0px"};const Re=(e,t,a,s,r,u=!1)=>{var c;const{data:d,uiSettings:g,fieldFormats:j,charts:m}=Object(R.b)(),{dataView:f}=Object(E.c)(),x=Object(z.a)(),O=(e=>{var t;const{application:a,share:s,data:l}=Object(R.b)(),n=Object(i.useMemo)((()=>s.url.locators.get("DISCOVER_APP_LOCATOR")),[s.url.locators]),o=Object(i.useMemo)((()=>{var t;return null!==(t=a.capabilities.discover)&&void 0!==t&&t.show?n?e?void 0:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.autoGeneratedDiscoverLinkErrorMessage",{defaultMessage:"Unable to link to Discover; no data view exists for this index"}):y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.discoverLocatorMissingErrorMessage",{defaultMessage:"No locator for Discover detected"}):y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.discoverNotEnabledErrorMessage",{defaultMessage:"Discover is not enabled"})}),[null===(t=a.capabilities.discover)||void 0===t?void 0:t.show,e,n]);return{render:t=>{const s=o||ie;return Object(v.jsx)(Z,{dataTestSubjPostfix:"Discover",iconType:"discoverApp",isDisabled:void 0!==o,label:ie,tooltipText:s,onClick:async()=>{const s=await(async t=>{if(void 0!==n)return await n.getRedirectUrl({indexPatternId:e,timeRange:l.query.timefilter.timefilter.getTime(),filters:l.query.filterManager.getFilters(),query:{language:Y.a.KUERY,query:se(t)}})})(t);"string"==typeof s&&await a.navigateToUrl(s)}})}}})(f.id),h=(e=>{const{application:t,share:a,data:s}=Object(R.b)(),l=Object(i.useMemo)((()=>a.url.locators.get("ML_APP_LOCATOR")),[a.url.locators]),n=Object(i.useMemo)((()=>l?e?void 0:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.autoGeneratedLogPatternAnalysisLinkErrorMessage",{defaultMessage:"Unable to link to Log Pattern Analysis; no data view exists for this index"}):y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.mlLocatorMissingErrorMessage",{defaultMessage:"No locator for Log Pattern Analysis detected"})),[e,l]);return{render:a=>{const i=n||ne,o=void 0!==n||le(a);return Object(v.jsx)(Z,{dataTestSubjPostfix:"LogPatternAnalysis",iconType:"logstashQueue",isDisabled:o,label:ne,tooltipText:le(a)?y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.logPatternLinkNotAvailableTooltipMessage",{defaultMessage:"This link is not available if the table item is a log pattern itself."}):i,onClick:async()=>{if(!le(a)){const i=await(async t=>{if(void 0!==l){const a=se(t),i=Object(ee.fromKueryExpression)(a),n=Object(ee.toElasticsearchQuery)(i),o={logCategorization:{filters:s.query.filterManager.getFilters(),searchQuery:n,searchQueryLanguage:Y.a.KUERY,searchString:se(t)}};return await l.getUrl({page:"aiops/log_categorization",pageState:{index:e,timeRange:s.query.timefilter.timefilter.getTime(),appState:o}})}})(a);"string"==typeof i&&await t.navigateToUrl(i)}}})}}})(f.id),T={render:e=>{const t=ae(e)?re:ue;return Object(v.jsx)(n.EuiToolTip,{content:t},Object(v.jsx)(n.EuiCopy,{textToCopy:se(e)},(e=>Object(v.jsx)(Z,{dataTestSubjPostfix:"CopyToClipboard",iconType:"copyClipboard",isDisabled:!1,label:oe,onClick:e}))))}},{earliest:k,latest:S}=Object(b.b)((e=>e.logRateAnalysis)),C={from:null!=k?k:0,to:null!=S?S:0},A=Object(b.b)((e=>e.logRateAnalysisStream.isRunning)),M=Object(b.b)((e=>e.logRateAnalysisResults.zeroDocsFallback)),{analysisType:P,windowParameters:L,documentStats:{documentCountStats:B}}=Object(b.b)((e=>e.logRateAnalysis)),D=e===je,N=null!==(c=null==B?void 0:B.interval)&&void 0!==c?c:0,_=Object(i.useMemo)((()=>({uiSettings:g,dataViews:d.dataViews,data:d,fieldFormats:j,charts:m})),[g,d,j,m]),G=Object(i.useMemo)((()=>{if(void 0===L)return;const{baselineMin:e,baselineMax:t,deviationMin:a,deviationMax:s}=L;return{baselineBuckets:(t-e)/N,deviationBuckets:(s-a)/N}}),[L,N]),V=Object(i.useMemo)((()=>({"Field name":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnFieldName",field:"fieldName",width:t.length<3?"17%":"25%",name:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.fieldNameLabel",{defaultMessage:"Field name"}),render:(e,{fieldName:t,fieldValue:s,key:i,type:o,doc_count:r})=>{const u=o===I.a.KEYWORD?a:Object(w.b)(t,[{key:i,count:r,examples:[],regex:""}]);return Object(v.jsx)(l.a.Fragment,null,o===I.a.KEYWORD&&Object(v.jsx)(K,{dataView:f,fieldName:t,fieldValue:o===I.a.KEYWORD?s:i,fieldStatsServices:_,dslQuery:u,timeRangeMs:C}),o===I.a.LOG_PATTERN&&Object(v.jsx)("span",{css:Object(v.css)({marginLeft:x.euiSizeS,marginRight:x.euiSizeXS},"","")},Object(v.jsx)(n.EuiIconTip,{type:"aggregate","data-test-subj":"aiopsLogPatternIcon",size:"m",content:y.i18n.translate("xpack.aiops.fieldContextPopover.descriptionTooltipLogPattern",{defaultMessage:"The field value for this field shows an example of the identified significant text field pattern."})})),Object(v.jsx)("span",{title:t,className:"eui-textTruncate"},t))},sortable:!0,valign:"middle"},"Field value":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnFieldValue",field:"fieldValue",width:t.length<3?"17%":"25%",name:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.fieldValueLabel",{defaultMessage:"Field value"}),render:(e,{fieldValue:t,type:a})=>Object(v.jsx)("span",{title:String(t)},"keyword"===a?String(t):Object(v.jsx)(n.EuiText,{size:"xs"},Object(v.jsx)(n.EuiCode,{language:"log",transparentBackground:!0,css:Te},String(t)))),sortable:!0,textOnly:!0,truncateText:{lines:3},valign:"middle"},"Log rate":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnLogRate",width:"8%",field:"pValue",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.logRateLabel",defaultMessage:"Log rate"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:D?fe:me})),render:(e,{histogram:t,fieldName:a,fieldValue:i})=>Object(v.jsx)(ce.a,{chartData:t,isLoading:A&&void 0===t,label:`${a}:${i}`,barColorOverride:s,barHighlightColorOverride:r}),sortable:!1,valign:"middle"},Impact:{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnImpact",width:"8%",field:"pValue",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.impactLabel",defaultMessage:"Impact"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:D?ye:xe})),render:(e,{pValue:t})=>{if("number"!=typeof t)return pe;const a=function(e,t){return null===e?null:e>=0&&e<1e-6?{impact:F.HIGH,color:"danger"}:e>=1e-6&&e<.001?{impact:F.MEDIUM,color:"warning"}:e>=.001&&e<.02?{impact:F.LOW,color:"default"}:null}(t);return a?Object(v.jsx)(n.EuiBadge,{color:a.color},a.impact):null},sortable:!0,valign:"middle"},"Baseline rate":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnBaselineRateChange",field:"bg_count",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.baselineRateLabel",defaultMessage:"Baseline rate"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:he})),render:(e,{bg_count:t,doc_count:a})=>{if(0===N||void 0===L||void 0===G||D)return pe;const{baselineBucketRate:s}=de(P,G.baselineBuckets,G.deviationBuckets,a,t);return Object(v.jsx)(l.a.Fragment,null,s)},sortable:!0,valign:"middle"},"Deviation rate":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnDeviationRateChange",field:"doc_count",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.deviationRateLabel",defaultMessage:"Deviation rate"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:ve})),render:(e,{doc_count:t,bg_count:a})=>{if(0===N||void 0===L||void 0===G||D)return pe;const{deviationBucketRate:s}=de(P,G.baselineBuckets,G.deviationBuckets,t,a);return Object(v.jsx)(l.a.Fragment,null,s)},sortable:!0,valign:"middle"},"Log rate change":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnLogRateChange",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.logRateChangeLabel",defaultMessage:"Log rate change"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:Oe})),render:({doc_count:e,bg_count:t})=>{if(0===N||void 0===L||void 0===G||D)return pe;const{baselineBucketRate:a,deviationBucketRate:s}=de(P,G.baselineBuckets,G.deviationBuckets,e,t),i=function(e,t,a){let s,i;return e===p.a.SPIKE?t>0?(i=Math.round(a/t*100/100),s=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateFactorIncreaseLabel",{defaultMessage:"{factor}x higher",values:{factor:i}})):s=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateDocIncreaseLabel",{defaultMessage:"{deviationBucketRate} {deviationBucketRate, plural, one {doc} other {docs}} rate up from 0 in baseline",values:{deviationBucketRate:a}}):a>0?(i=Math.round(t/a*100/100),s=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateFactorDecreaseLabel",{defaultMessage:"{factor}x lower",values:{factor:i}})):s=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.logRateDocDecreaseLabel",{defaultMessage:"docs rate down to 0 from {baselineBucketRate} in baseline",values:{baselineBucketRate:t}}),{message:s,factor:i}}(P,a,s);return Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiIcon,{size:"s",color:"subdued",type:P===p.a.SPIKE?"sortUp":"sortDown",className:"eui-alignTop"}),"Â ",i.message)},valign:"middle"},"p-value":{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnPValue",field:"pValue",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTable.pValueLabel",defaultMessage:"p-value"}),"Â ",Object(v.jsx)(n.EuiIconTip,{size:"s",position:"top",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.pValueColumnTooltip",{defaultMessage:"The significance of changes in the frequency of values; lower values indicate greater change; sorting this column will automatically do a secondary sort on the doc count column."})})),render:e=>{var t;return null!==(t=null==e?void 0:e.toPrecision(3))&&void 0!==t?t:pe},sortable:!0,valign:"middle"},"Doc count":{"data-test-subj":D?"aiopsLogRateAnalysisResultsGroupsTableColumnDocCount":"aiopsLogRateAnalysisResultsTableColumnDocCount",width:"8%",field:D?"docCount":"doc_count",name:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.docCountLabel",{defaultMessage:"Doc count"}),sortable:!0,valign:"middle"},Actions:{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnAction",name:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.actionsColumnName",{defaultMessage:"Actions"}),actions:[...O?[O]:[],...h?[h]:[],T],width:"4%",valign:"middle"},unique:{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnUnique",width:"40px",field:"unique",name:"",render:(e,{unique:t})=>t?Object(v.jsx)(n.EuiIconTip,{content:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.uniqueColumnTooltip",{defaultMessage:"This field/value pair only appears in this group"}),position:"top",type:"asterisk"}):"",sortable:!1,valign:"middle"}})),[s,r,T,null==f?void 0:f.id,x,_,A,a,C,O,h]);return Object(i.useMemo)((()=>{const e=D?be:ge,a=[];for(const s in e)!1===e.hasOwnProperty(s)||t.includes(e[s])||("p-value"===s||"Impact"===s)&&M||a.push(V[s]);return!0===u&&a.unshift(V.unique),a}),[D,t,M,u,V])},ke=[5,10,20,50],Se=({groupFilter:e,searchQuery:t,barColorOverride:a,barHighlightColorOverride:l,skippedColumns:o})=>{const r=Object(z.a)(),u=Object(n.useEuiBackgroundColor)("primary"),c=Object(b.b)((e=>e.logRateAnalysisResults.significantItems)),d=Object(i.useMemo)((()=>e?e.reduce(((e,t)=>{const a=c.find((e=>e.fieldName===t.fieldName&&e.fieldValue===t.fieldValue));var s;return void 0!==a&&e.push({...a,unique:(null!==(s=t.duplicate)&&void 0!==s?s:0)<=1}),e}),[]):c),[c,e]),p=Object(b.b)((e=>e.logRateAnalysisResults.zeroDocsFallback)),g=Object(b.b)((e=>e.logRateAnalysisTableRow.pinnedGroup)),m=Object(b.b)((e=>e.logRateAnalysisTableRow.selectedGroup)),f=Object(b.b)((e=>e.logRateAnalysisTableRow.pinnedSignificantItem)),y=Object(b.b)((e=>e.logRateAnalysisTableRow.selectedSignificantItem)),x=Object(b.a)(),[O,h]=Object(i.useState)(0),[T,R]=Object(i.useState)(10),[k,S]=Object(i.useState)(p?"doc_count":"pValue"),[C,A]=Object(i.useState)(p?"desc":"asc"),M=Re("significantItems",o,t,a,l,void 0!==e),E=Object(i.useCallback)((e=>{if(e.page){const{index:t,size:a}=e.page;h(t),R(a)}if(e.sort){const{field:t,direction:a}=e.sort;S(t),A(a)}}),[]),{pagination:I,pageOfItems:w,sorting:F}=Object(i.useMemo)((()=>{var e;const t=O*T,a=null!==(e=null==d?void 0:d.length)&&void 0!==e?e:0;let i=null!=d?d:[];const l=[e=>e&&"string"==typeof e[k]?e[k].toLowerCase():e[k]],n=[C];return"pValue"===k&&(l.push((e=>e.doc_count)),n.push(C)),i=Object(s.orderBy)(d,l,n),{pageOfItems:i.slice(t,t+T),pagination:{pageIndex:O,pageSize:T,totalItemCount:a,pageSizeOptions:ke},sorting:{sort:{field:k,direction:C}}}}),[O,T,k,C,d]);Object(i.useEffect)((()=>{(null===y||!w.some((e=>Object(s.isEqual)(e,y))))&&null===f&&w.length>0&&null===m&&null===g&&x(Object(j.f)(w[0])),null===f||w.some((e=>Object(s.isEqual)(e,f)))||null!==m||null!==g||x(Object(j.d)(null))}),[x,m,y,w,g,f]),Object(i.useEffect)((()=>()=>{x(Object(j.f)(null)),x(Object(j.d)(null))}),[]);const P=e=>f&&f.fieldName===e.fieldName&&f.fieldValue===e.fieldValue?{backgroundColor:u}:y&&y.fieldName===e.fieldName&&y.fieldValue===e.fieldValue?{backgroundColor:r.euiColorLightestShade}:{backgroundColor:r.euiColorEmptyShade};return Object(v.jsx)(n.EuiBasicTable,{"data-test-subj":"aiopsLogRateAnalysisResultsTable",compressed:!0,columns:M,items:w,onChange:E,pagination:I.totalItemCount>I.pageSize?I:void 0,loading:!1,sorting:F,rowProps:e=>({"data-test-subj":`aiopsLogRateAnalysisResultsTableRow row-${e.fieldName}-${e.fieldValue}`,onClick:()=>{e.fieldName===(null==f?void 0:f.fieldName)&&e.fieldValue===(null==f?void 0:f.fieldValue)?x(Object(j.d)(null)):x(Object(j.d)(e))},onMouseEnter:()=>{null===f&&x(Object(j.f)(e))},onMouseLeave:()=>{x(Object(j.f)(null))},style:P(e)})})};var Ce=a(169),Ae=a(73),Me=a.n(Ae),Ee=a(195),Ie=a.n(Ee);const we=[5,10,20,50],Fe=({skippedColumns:e,significantItems:t,groupTableItems:a,searchQuery:r,barColorOverride:u,barHighlightColorOverride:c})=>{const d=Me()(e),p=Object(b.b)((e=>e.logRateAnalysisResults.zeroDocsFallback)),[g,m]=Object(i.useState)(0),[x,O]=Object(i.useState)(10),[h,T]=Object(i.useState)(p?"docCount":"pValue"),[R,k]=Object(i.useState)(p?"desc":"asc"),[S,C]=Object(i.useState)({}),{euiTheme:A}=Object(n.useEuiTheme)(),M=Object(n.euiPaletteColorBlind)(),E=Object(n.useEuiBackgroundColor)("primary"),I=Object(b.b)((e=>e.logRateAnalysisTableRow.pinnedGroup)),w=Object(b.b)((e=>e.logRateAnalysisTableRow.selectedGroup)),F=Object(b.a)(),P=Ie()(),L=[{align:n.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:Object(v.jsx)(n.EuiScreenReaderOnly,null,Object(v.jsx)("span",null,y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.expandRowsLabel",{defaultMessage:"Expand rows"}))),render:t=>Object(v.jsx)(n.EuiButtonIcon,{"data-test-subj":"aiopsLogRateAnalysisResultsGroupsTableRowExpansionButton",onClick:()=>(t=>{const a={...S};a[t.id]?delete a[t.id]:a[t.id]=Object(v.jsx)(Se,{skippedColumns:e,groupFilter:t.groupItemsSortedByUniqueness,searchQuery:r,barColorOverride:u,barHighlightColorOverride:c}),C(a)})(t),"aria-label":S[t.id]?y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.collapseAriaLabel",{defaultMessage:"Collapse"}):y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.expandAriaLabel",{defaultMessage:"Expand"}),iconType:S[t.id]?"arrowDown":"arrowRight"}),valign:"top"},{"data-test-subj":"aiopsLogRateAnalysisResultsGroupsTableColumnGroup",field:"group",width:e.length<3?"34%":"50%",name:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTableGroups.groupLabel",defaultMessage:"Group"}),"Â ",Object(v.jsx)(n.EuiIconTip,{position:"top",size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop",content:y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTableGroups.groupColumnTooltip",{defaultMessage:"Displays up to {maxItemCount} group items sorted by uniqueness and document count. Expand row to see all field/value pairs.",values:{maxItemCount:5}})})),render:(e,{uniqueItemsCount:t,groupItemsSortedByUniqueness:a})=>{const s=[];for(const e of a){const{fieldName:t,fieldValue:a,duplicate:i}=e;if(s.length>=5)break;s.push(Object(v.jsx)("span",{key:`${Object(Ce.a)(`${t}:${a}`)}-id`},Object(v.jsx)(n.EuiBadge,{"data-test-subj":"aiopsLogRateAnalysisResultsTableColumnGroupBadge",color:"hollow"},Object(v.jsx)("span",null,(null!=i?i:0)<=1?"* ":"",`${t}: `),Object(v.jsx)("span",{style:{color:M[2]}},`${a}`)),Object(v.jsx)(n.EuiSpacer,{size:"xs"})))}return a.length>5&&s.push(Object(v.jsx)(n.EuiText,{key:"group-info-id","data-test-subj":"aiopsLogRateAnalysisResultsGroupsTableColumnGroupInfo",color:"subdued",size:"xs"},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTableGroups.groupItemsInfo",defaultMessage:"Showing {valuesBadges} out of {count} items.",values:{count:a.length,valuesBadges:s.length}}),t>5?Object(v.jsx)(l.a.Fragment,null," ",Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.resultsTableGroups.groupUniqueItemsInfo",defaultMessage:"{count, plural, one {# item} other {# items}} unique to this group.",values:{count:t}})):null)),s},sortable:!1,truncateText:!0,valign:"top"}],B=Re(je,e,r,u,c);L.push(...B);const D=Object(i.useCallback)((e=>{if(e.page){const{index:t,size:a}=e.page;m(t),O(a)}if(e.sort){const{field:t,direction:a}=e.sort;T(t),k(a)}}),[]),{pagination:z,pageOfItems:N,sorting:_}=Object(i.useMemo)((()=>{var e;const t=g*x,i=null!==(e=null==a?void 0:a.length)&&void 0!==e?e:0;let l=null!=a?a:[];const n=[e=>e&&"string"==typeof e[h]?e[h].toLowerCase():e[h]],o=[R];return"pValue"===h&&(n.push((e=>e.docCount)),o.push(R)),l=Object(s.orderBy)(a,n,o),{pageOfItems:l.slice(t,t+x),pagination:{pageIndex:g,pageSize:x,totalItemCount:i,pageSizeOptions:we},sorting:{sort:{field:h,direction:R}}}}),[g,x,h,R,a]);Object(i.useEffect)((()=>{(null===w||!N.some((e=>Object(s.isEqual)(e,w))))&&null===I&&N.length>0&&F(Object(j.e)(N[0])),null===I||N.some((e=>Object(s.isEqual)(e,I)))||F(Object(j.c)(null))}),[F,w,N,I]),Object(i.useEffect)((()=>()=>{F(Object(j.e)(null)),F(Object(j.c)(null))}),[]),Object(i.useEffect)((function(){var t;if(P()&&d&&d!==e&&(null===(t=Object.keys(S))||void 0===t?void 0:t.length)>0){const t={...S};for(const a in t)if(t.hasOwnProperty(a)){const s=t[a];t[a]=Object(v.jsx)(Se,f()({},s.props,{skippedColumns:e}))}C(t)}}),[d,e,S]);const G=e=>I&&I.id===e.id?{backgroundColor:E}:w&&w.id===e.id?{backgroundColor:A.colors.lightestShade}:{backgroundColor:A.colors.emptyShade};return Object(v.jsx)(n.EuiBasicTable,{"data-test-subj":"aiopsLogRateAnalysisResultsGroupsTable",compressed:!0,columns:L,items:N,itemId:"id",itemIdToExpandedRowMap:S,onChange:D,pagination:z.totalItemCount>z.pageSize?z:void 0,loading:!1,sorting:_,rowProps:e=>({"data-test-subj":`aiopsLogRateAnalysisResultsGroupsTableRow row-${e.id}`,onClick:()=>{e.id===(null==I?void 0:I.id)?F(Object(j.c)(null)):F(Object(j.c)(e))},onMouseEnter:()=>{null===I&&F(Object(j.e)(e))},onMouseLeave:()=>{F(Object(j.e)(null))},style:G(e)})})},Pe=({disabled:e,onClick:t,tooltipContent:a})=>{const s=Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsFieldFilterApplyButton"+(e?" disabled":""),size:"s",onClick:t,disabled:e},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.fieldFilterApplyButtonLabel",defaultMessage:"Apply"}));return a?Object(v.jsx)(n.EuiToolTip,{position:"left",content:a},s):s};var Le={name:"1r962iv",styles:"padding:4px"};const Be=({dataTestSubj:e,disabled:t,disabledApplyButton:a,disabledApplyTooltipContent:s,helpText:r,itemSearchAriaLabel:u,initialSkippedItems:c=[],popoverButtonTitle:d,selectedItemLimit:p=2,uniqueItemNames:b,onChange:g})=>{const j=Object(n.useEuiTheme)(),m=Object(i.useMemo)((()=>Object(v.css)(Object(n.euiYScrollWithShadows)(j,{})," max-height:400px;","")),[j]),[f,x]=Object(i.useState)(!1),[O,h]=Object(i.useState)(""),[T,R]=Object(i.useState)(c),k=(e,t)=>{let a=[...T];t?a=T.filter((t=>!e.includes(t))):a.push(...e),R([...new Set(a)]),x(!0)},[S,C]=Object(i.useState)(!1),A=()=>C(!1),M=Object(i.useMemo)((()=>b.filter((e=>-1!==e.toLowerCase().indexOf(O.toLowerCase())))),[O,b]);Object(i.useEffect)((()=>{R((e=>e.filter((e=>b.includes(e)))))}),[b]);const E=b.length-T.length;return Object(v.jsx)(n.EuiPopover,{anchorPosition:"downLeft",panelPaddingSize:"s",panelStyle:{minWidth:"20%"},button:Object(v.jsx)(n.EuiButton,{"data-test-subj":e,onClick:()=>C((e=>!e)),disabled:t,size:"s",iconType:"arrowDown",iconSide:"right",iconSize:"s",color:"text"},d),isOpen:S,closePopover:A},Object(v.jsx)(n.EuiPopoverTitle,null,Object(v.jsx)(n.EuiText,{size:"xs",color:"subdued",style:{maxWidth:"400px"}},r),Object(v.jsx)(n.EuiSpacer,{size:"s"}),Object(v.jsx)(n.EuiFieldText,{compressed:!0,placeholder:y.i18n.translate("xpack.aiops.analysis.fieldSelectorPlaceholder",{defaultMessage:"Search"}),"aria-label":u,value:O,onChange:e=>h(e.currentTarget.value),"data-test-subj":"aiopsFieldSelectorSearch"})),Object(v.jsx)("div",{css:m,"data-test-subj":"aiopsFieldSelectorFieldNameList"},M.map((e=>Object(v.jsx)("div",{key:e,css:Le},Object(v.jsx)(n.EuiSwitch,{"data-test-subj":"aiopsFieldSelectorFieldNameListItem"+(T.includes(e)?"":" checked"),className:"euiSwitch--mini",compressed:!0,label:e,onChange:t=>k([e],t.target.checked),checked:!T.includes(e)}))))),Object(v.jsx)(n.EuiPopoverFooter,null,Object(v.jsx)(n.EuiFlexGroup,{gutterSize:"s",responsive:!1,justifyContent:"spaceBetween",alignItems:"center"},Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiButtonEmpty,{size:"xs",flush:"left",onClick:()=>k(M,!0),disabled:O.length>0&&0===M.length,"data-test-subj":"aiopsFieldSelectorSelectAllFieldsButton"},O.length>0?Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.fieldSelector.selectAllSearchedItems",defaultMessage:"Select filtered"}):Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.fieldSelector.selectAllItems",defaultMessage:"Select all"}))),Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>k(M,!1),disabled:O.length>0&&0===M.length,"data-test-subj":"aiopsFieldSelectorDeselectAllFieldsButton"},O.length>0?Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.fieldSelector.deselectAllSearchedItems",defaultMessage:"Deselect filtered"}):Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.fieldSelector.deselectAllItems",defaultMessage:"Deselect all"})))),Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(Pe,{onClick:()=>{g(T),h(""),C(!1),A()},disabled:a||E<p||!f,tooltipContent:E<p?s:void 0})))))},De=({analysisType:e})=>{const t=Object(b.b)((e=>e.logRateAnalysisResults.zeroDocsFallback));let a,s;if(t||e!==p.a.SPIKE)if(t||e!==p.a.DIP)if(t&&e===p.a.SPIKE)a=y.i18n.translate("xpack.aiops.analysis.analysisTypeSpikeFallbackCallOutTitle",{defaultMessage:"Analysis type: Top items for deviation time range"}),s=y.i18n.translate("xpack.aiops.analysis.analysisTypeSpikeCallOutContentFallback",{defaultMessage:"The baseline time range does not contain any documents. Therefore the results show top log message categories and field values for the deviation time range."});else{if(!t||e!==p.a.DIP)return null;a=y.i18n.translate("xpack.aiops.analysis.analysisTypeDipFallbackCallOutTitle",{defaultMessage:"Analysis type: Top items for baseline time range"}),s=y.i18n.translate("xpack.aiops.analysis.analysisTypeDipCallOutContentFallback",{defaultMessage:"The deviation time range does not contain any documents. Therefore the results show top log message categories and field values for the baseline time range."})}else a=y.i18n.translate("xpack.aiops.analysis.analysisTypeDipCallOutTitle",{defaultMessage:"Analysis type: Log rate dip"}),s=y.i18n.translate("xpack.aiops.analysis.analysisTypeDipCallOutContent",{defaultMessage:'The median log rate in the selected deviation time range is lower than the baseline. Therefore, the analysis results table shows statistically significant items within the baseline time range that are less in number or missing within the deviation time range. The "doc count" column refers to the amount of documents in the baseline time range.'});else a=y.i18n.translate("xpack.aiops.analysis.analysisTypeSpikeCallOutTitle",{defaultMessage:"Analysis type: Log rate spike"}),s=y.i18n.translate("xpack.aiops.analysis.analysisTypeSpikeCallOutContent",{defaultMessage:'The median log rate in the selected deviation time range is higher than the baseline. Therefore, the analysis results table shows statistically significant items within the deviation time range that are contributors to the spike. The "doc count" column refers to the amount of documents in the deviation time range.'});return Object(v.jsx)(n.EuiCallOut,{title:Object(v.jsx)("span",{"data-test-subj":"aiopsAnalysisTypeCalloutTitle"},a),color:"primary",iconType:"pin",size:"s"},Object(v.jsx)(n.EuiText,{size:"s"},s))},ze=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.groupedSwitchLabel.groupResults",{defaultMessage:"Smart grouping"}),Ne=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.groupedSwitchLabel.groupResultsHelpMessage",{defaultMessage:"Items which are unique to a group are marked by an asterisk (*)."}),_e=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.groupedSwitchLabel.groupResultsOff",{defaultMessage:"Off"}),Ge=y.i18n.translate("xpack.aiops.logRateAnalysis.resultsTable.groupedSwitchLabel.groupResultsOn",{defaultMessage:"On"}),Ve="aiopsLogRateAnalysisGroupingOff",He="aiopsLogRateAnalysisGroupingOn",qe=y.i18n.translate("xpack.aiops.logRateAnalysis.page.fieldFilterHelpText",{defaultMessage:"Deselect non-relevant fields to remove them from groups and click the Apply button to rerun the grouping.  Use the search bar to filter the list, then select/deselect multiple fields with the actions below."}),$e=y.i18n.translate("xpack.aiops.logRateAnalysis.page.columnsFilterHelpText",{defaultMessage:"Configure visible columns."}),Ue=y.i18n.translate("xpack.aiops.analysis.fieldSelectorNotEnoughFieldsSelected",{defaultMessage:"Grouping requires at least 2 fields to be selected."}),We=y.i18n.translate("xpack.aiops.analysis.columnSelectorNotEnoughColumnsSelected",{defaultMessage:"At least one column must be selected."}),Qe=y.i18n.translate("xpack.aiops.analysis.columnSelectorAriaLabel",{defaultMessage:"Filter columns"}),Ke=y.i18n.translate("xpack.aiops.logRateAnalysis.page.columnsFilterButtonLabel",{defaultMessage:"Columns"}),Ye=y.i18n.translate("xpack.aiops.analysis.fieldFilterButtonLabel",{defaultMessage:"Filter fields"}),Je=({onReset:e,searchQuery:t,barColorOverride:a,barHighlightColorOverride:r,embeddingOrigin:u})=>{var c;const{analytics:d,http:g}=Object(R.b)(),{dataView:m}=Object(E.c)(),f=Object(b.a)(),{analysisType:x,earliest:O,latest:h,windowParameters:T,documentStats:{sampleProbability:k},stickyHistogram:S,isBrushCleared:I}=Object(b.b)((e=>e.logRateAnalysis)),{isRunning:w,errors:F}=Object(b.b)((e=>e.logRateAnalysisStream)),P=Object(b.b)((e=>e.logRateAnalysisResults)),L=Object(i.useRef)(window.performance.now()),B=Object(i.useRef)(new AbortController),[D,z]=Object(i.useState)(),[N,_]=Object(i.useState)(),[G,V]=Object(i.useState)(!1),[H,q]=Object(i.useState)([]),[$,U]=Object(i.useState)([]),[W,Q]=Object(i.useState)(void 0),[K,Y]=Object(i.useState)(!1),[J,X]=Object(i.useState)(Ve),[Z,ee]=Object(i.useState)(["p-value","Baseline rate","Deviation rate"]),{significantItems:te}=P;Object(i.useEffect)((()=>U(Object(s.uniq)(te.map((e=>e.fieldName))).sort())),[te]),Object(i.useEffect)((()=>{if(!w){const{loaded:e,remainingFieldCandidates:t,groupsMissing:a}=P;if(e<1&&(Array.isArray(t)&&t.length>0||a))Q({loaded:e,remainingFieldCandidates:t,significantItems:P.significantItems});else if(e>0&&(Q(void 0),void 0!==L.current)){const e=window.performance.now()-L.current;L.current=void 0,function(e,t){e.reportEvent("performance_metric",t)}(d,{eventName:"aiopsLogRateAnalysisCompleted",duration:e})}}}),[w]);const ae=Object(i.useMemo)((()=>[...F,...P.errors]),[F,P.errors]);function se(e=!1,t=!0){e||(Q(void 0),U([])),t&&(V(!1),X(Ve),f(Object(j.a)())),z(x),_(T),Y(!0)}const ie=Object(i.useMemo)((()=>{var e;if(T)return{http:g,endpoint:"/internal/aiops/log_rate_analysis",apiVersion:"2",abortCtrl:B,body:{start:O,end:h,searchQuery:JSON.stringify(t),timeFieldName:null!==(e=m.timeFieldName)&&void 0!==e?e:"",index:m.getIndexPattern(),grouping:!0,flushFix:!0,...x===p.a.SPIKE?T:{baselineMin:T.deviationMin,baselineMax:T.deviationMax,deviationMin:T.baselineMin,deviationMax:T.baselineMax},overrides:W,sampleProbability:k},headers:{[M.c.AIOPS_ANALYSIS_RUN_ORIGIN]:u}}}),[x,O,h,g,t,m,T,k,W,u]);Object(i.useEffect)((()=>{K&&ie&&(f(Object(A.b)(ie)),Y(!1))}),[K]),Object(i.useEffect)((()=>{ie&&(z(x),_(T),f(Object(A.b)(ie)))}),[]);const le=Object(i.useMemo)((()=>P.significantItemsGroups.map((({id:e,group:t,docCount:a,histogram:i,pValue:l})=>{const n=Object(s.sortBy)(t,[e=>e.fieldName]),o=[];n.forEach((e=>{const{key:t,type:a,fieldName:s,fieldValue:i,docCount:l,pValue:n,duplicate:r}=e;(null!=r?r:0)<=1&&o.push({key:t,type:a,fieldName:s,fieldValue:i,docCount:l,pValue:n})}));const r=Object(s.sortBy)(t,["duplicate","docCount"]);return{id:e,docCount:a,pValue:l,uniqueItemsCount:Object(s.sortBy)(o,(e=>{var t;return[-1*(null!==(t=e.pValue)&&void 0!==t?t:0),e.docCount]})).length,groupItemsSortedByUniqueness:r,histogram:i}}))),[P.significantItemsGroups]),ne=Object(i.useMemo)((()=>void 0!==N&&!Object(s.isEqual)(N,T)),[N,T]),oe=(null==P?void 0:P.significantItems.length)>0,re=le.reduce(((e,t)=>e+t.groupItemsSortedByUniqueness.length),0),ue=le.length>0&&re>0,ce=!ue&&!G&&0===H.length,de=[{id:Ve,label:_e,"data-test-subj":"aiopsLogRateAnalysisGroupSwitchOff"},{id:He,label:Ge,"data-test-subj":"aiopsLogRateAnalysisGroupSwitchOn"}];return Object(v.jsx)("div",{"data-test-subj":"aiopsLogRateAnalysisResults"},Object(v.jsx)(C,{isBrushCleared:I,progress:P.loaded,progressMessage:null!==(c=P.loadingState)&&void 0!==c?c:"",isRunning:w,onRefresh:()=>se(!1),onCancel:function(){B.current.abort(),f(Object(A.a)())},onReset:e,shouldRerunAnalysis:ne},Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiFormRow,{display:"columnCompressedSwitch"},Object(v.jsx)(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiText,{size:"xs"},ze)),Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(n.EuiButtonGroup,{"data-test-subj":"aiopsLogRateAnalysisGroupSwitch"+(G?" checked":""),buttonSize:"s",isDisabled:ce,legend:"Smart grouping",options:de,idSelected:J,onChange:e=>{X(e),V(e===He),f(Object(j.a)())}}))))),Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(Be,{dataTestSubj:"aiopsFieldFilterButton",disabled:!G||w,disabledApplyButton:w,disabledApplyTooltipContent:Ue,helpText:qe,itemSearchAriaLabel:Ye,popoverButtonTitle:Ye,uniqueItemNames:$,onChange:e=>{q(e),Q({loaded:0,remainingFieldCandidates:[],significantItems:P.significantItems.filter((t=>!e.includes(t.fieldName))),regroupOnly:!0}),se(!0,!1)}})),Object(v.jsx)(n.EuiFlexItem,{grow:!1},Object(v.jsx)(Be,{dataTestSubj:"aiopsColumnFilterButton",disabled:w,disabledApplyButton:w,disabledApplyTooltipContent:We,helpText:$e,itemSearchAriaLabel:Qe,initialSkippedItems:Z,popoverButtonTitle:Ke,selectedItemLimit:1,uniqueItemNames:G?Object.values(be):Object.values(ge),onChange:e=>{ee(e)}}))),oe&&void 0!==D&&Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiSpacer,{size:"s"}),Object(v.jsx)(De,{analysisType:D}),Object(v.jsx)(n.EuiSpacer,{size:"xs"})),ae.length>0?Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiSpacer,{size:"xs"}),Object(v.jsx)(n.EuiCallOut,{title:y.i18n.translate("xpack.aiops.analysis.errorCallOutTitle",{defaultMessage:"The following {errorCount, plural, one {error} other {errors}} occurred running the analysis.",values:{errorCount:ae.length}}),color:"warning",iconType:"warning",size:"s"},Object(v.jsx)(n.EuiText,{size:"s"},1===ae.length?Object(v.jsx)("p",null,ae[0]):Object(v.jsx)("ul",null,ae.map(((e,t)=>Object(v.jsx)("li",{key:t},e)))),void 0!==W?Object(v.jsx)("p",null,Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsLogRateAnalysisResultsTryToContinueAnalysisButton",size:"s",onClick:()=>se(!0)},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.tryToContinueAnalysisButtonText",defaultMessage:"Try to continue analysis"}))):null)),Object(v.jsx)(n.EuiSpacer,{size:"xs"})):null,oe&&G&&ue&&Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(n.EuiSpacer,{size:"xs"}),Object(v.jsx)(n.EuiText,{size:"xs"},G?Ne:void 0)),Object(v.jsx)(n.EuiSpacer,{size:"xs"}),!w&&!oe&&Object(v.jsx)(n.EuiEmptyPrompt,{"data-test-subj":"aiopsNoResultsFoundEmptyPrompt",title:Object(v.jsx)("h2",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.noResultsPromptTitle",defaultMessage:"The analysis did not return any results."})),titleSize:"xs",body:Object(v.jsx)("p",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.noResultsPromptBody",defaultMessage:"Try to adjust the baseline and deviation time ranges and rerun the analysis. If you still get no results, there might be no statistically significant entities contributing to this deviation in log rate."}))}),Object(v.jsx)("div",{style:S?{height:"500px",overflowX:"hidden",overflowY:"auto",paddingTop:"20px"}:void 0},oe&&G?Object(v.jsx)(Fe,{skippedColumns:Z,significantItems:P.significantItems,groupTableItems:le,searchQuery:t,barColorOverride:a,barHighlightColorOverride:r}):null,oe&&!G?Object(v.jsx)(Se,{skippedColumns:Z,searchQuery:t,barColorOverride:a,barHighlightColorOverride:r}):null))},Xe={match_all:{}},Ze={bool:{filter:[],must:[{match_all:{}}],must_not:[]}};var et={name:"1bxycju",styles:"min-width:100%"},tt={name:"1bxycju",styles:"min-width:100%"},at={name:"1bxycju",styles:"min-width:100%"};const st=({esSearchQuery:e=Xe,barColorOverride:t,barHighlightColorOverride:a,onAnalysisCompleted:m,onWindowParametersChange:f,embeddingOrigin:y})=>{var x;const O=Object(b.a)(),h=Object(b.b)((e=>e.logRateAnalysisStream.isRunning)),T=Object(b.b)((e=>e.logRateAnalysisResults.significantItems)),R=Object(b.b)((e=>e.logRateAnalysisResults.significantItemsGroups)),k=Object(b.b)((e=>e.logRateAnalysisResults.loaded)),C=Object(b.b)((e=>e.logRateAnalysis.analysisType)),A=Object(b.b)((e=>e.logRateAnalysis.windowParameters)),M=Object(i.useRef)(!1);Object(i.useEffect)((()=>{(M.current||void 0!==A)&&(M.current=!0,f&&f(A,!0))}),[f,A]);const E=Object(i.useMemo)((()=>Object(s.isEqual)(e,Ze)?Xe:e),[e]),{autoRunAnalysis:I,documentStats:w,earliest:F,latest:P,isBrushCleared:L}=Object(b.b)((e=>e.logRateAnalysis)),{documentCountStats:B}=w;function D(){O(Object(g.b)()),O(Object(j.a)())}const z={rect:{opacity:1,fill:r.a}},N=L&&null!=B&&B.changePoint?(e,t)=>"document_count"===t.specId&&null!=B&&B.changePoint&&e.x>B.changePoint.startTs&&e.x<B.changePoint.endTs?z:null:void 0,_=Object(i.useCallback)((()=>{O(Object(g.d)(!0))}),[O]),G=Object(i.useCallback)((()=>{if(B){const{interval:e,timeRangeEarliest:t,timeRangeLatest:a,changePoint:s}=B;if(s&&e&&t&&a){const i=Object(u.a)(s.startTs,e,t,a,s),l=Object(c.a)(t,a,e),n=Object(d.a)(i,l);_(),O(Object(g.f)(n))}}}),[B,O,_]);Object(i.useEffect)((()=>{!h&&1===k&&m&&m({analysisType:C,significantItems:T,significantItemsGroups:R})}),[h,k]);const V=void 0!==B,H=I&&void 0!==F&&void 0!==P&&void 0!==A,q=!I&&void 0!==F&&void 0!==P&&void 0!==A,$=void 0===A&&(null==B?void 0:B.changePoint),U=void 0===A&&void 0===(null==B?void 0:B.changePoint),W=null==B||null===(x=B.changePoint)||void 0===x?void 0:x.type;return Object(v.jsx)(n.EuiPanel,{hasBorder:!1,hasShadow:!1},V&&Object(v.jsx)(S,{barColorOverride:t,barHighlightColorOverride:a,barStyleAccessor:N}),Object(v.jsx)(n.EuiHorizontalRule,null),H&&Object(v.jsx)(Je,{onReset:D,searchQuery:E,barColorOverride:t,barHighlightColorOverride:a,embeddingOrigin:y}),q&&Object(v.jsx)(n.EuiEmptyPrompt,{color:"subdued",hasShadow:!1,hasBorder:!1,css:et,title:void 0,titleSize:"xs",body:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)("p",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.noAutoRunPromptBody",defaultMessage:"Next you can fine tune the time ranges for baseline and deviation by dragging the handles of the brushes. Once you're ready, click the button 'Run analysis' below."})),Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsLogRateAnalysisNoAutoRunContentRunAnalysisButton",onClick:_},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.noAutoRunPromptRunAnalysisButton",defaultMessage:"Run analysis"}))," ",Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsClearSelectionBadge",onClick:()=>D(),color:"text"},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.clearSelectionLabel",defaultMessage:"Clear selection"}))),"data-test-subj":"aiopsChangePointDetectedPrompt"}),$&&Object(v.jsx)(n.EuiEmptyPrompt,{color:"subdued",hasShadow:!1,hasBorder:!1,css:tt,title:Object(v.jsx)("h2",null,W===p.a.SPIKE&&Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.changePointSpikePromptTitle",defaultMessage:"Log rate spike detected"}),W===p.a.DIP&&Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.changePointDipPromptTitle",defaultMessage:"Log rate dip detected"}),W!==p.a.SPIKE&&W!==p.a.DIP&&Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.changePointOtherPromptTitle",defaultMessage:"Log rate change point detected"})),titleSize:"xs",body:Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)("p",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.changePointPromptBody",defaultMessage:"The log rate analysis feature identifies statistically significant field/value combinations that contribute to a log rate spike or dip. To analyse the area highlighted in the chart, click the button below. For custom analysis of other areas, start by clicking on any of the non-highlighted bars in the histogram chart."})),Object(v.jsx)(n.EuiButton,{"data-test-subj":"aiopsLogRateAnalysisContentRunAnalysisButton",onClick:G},Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.changePointPromptRunAnalysisButton",defaultMessage:"Run analysis"}))),"data-test-subj":"aiopsChangePointDetectedPrompt"}),V&&U&&Object(v.jsx)(n.EuiEmptyPrompt,{color:"subdued",hasShadow:!1,hasBorder:!1,css:at,title:Object(v.jsx)("h2",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.emptyPromptTitle",defaultMessage:"Start by clicking a spike or dip in the histogram chart."})),titleSize:"xs",body:Object(v.jsx)("p",null,Object(v.jsx)(o.FormattedMessage,{id:"xpack.aiops.logRateAnalysis.page.emptyPromptBody",defaultMessage:"The log rate analysis feature identifies statistically significant field/value combinations that contribute to a log rate spike or dip."})),"data-test-subj":"aiopsNoWindowParametersEmptyPrompt"}))}},139:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));var s=a(29);const i=s.useDispatch,l=s.useSelector;s.useStore},188:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return d}));var s=a(19),i=a(102);const l=Object(s.createSlice)({name:"logRateAnalysis",initialState:{analysisType:i.a.SPIKE,autoRunAnalysis:!0,initialAnalysisStart:void 0,isBrushCleared:!0,documentStats:{sampleProbability:1,totalCount:0},stickyHistogram:!1},reducers:{brushSelectionUpdate:(e,t)=>{e.isBrushCleared&&!t.payload.force||(e.windowParameters=t.payload.windowParameters),t.payload.force&&(e.isBrushCleared=!1),e.analysisType=t.payload.analysisType},clearSelection:e=>{e.windowParameters=void 0,e.isBrushCleared=!0,e.initialAnalysisStart=void 0},setAnalysisType:(e,t)=>{e.analysisType=t.payload},setAutoRunAnalysis:(e,t)=>{e.autoRunAnalysis=t.payload},setDocumentCountChartData:(e,t)=>{e.earliest=t.payload.earliest,e.latest=t.payload.latest,e.intervalMs=t.payload.intervalMs,e.documentStats=t.payload.documentStats},setInitialAnalysisStart:(e,t)=>{e.initialAnalysisStart=t.payload},setIsBrushCleared:(e,t)=>{e.isBrushCleared=t.payload},setStickyHistogram:(e,t)=>{e.stickyHistogram=t.payload},setWindowParameters:(e,t)=>{e.windowParameters=t.payload,e.isBrushCleared=void 0===t.payload}}}),{brushSelectionUpdate:n,clearSelection:o,setAnalysisType:r,setAutoRunAnalysis:u,setDocumentCountChartData:c,setInitialAnalysisStart:d,setIsBrushCleared:p,setStickyHistogram:b,setWindowParameters:g}=l.actions},189:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(190);case"v8light":return a(192)}},190:function(e,t,a){var s=a(88),i=a(191);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},191:function(e,t,a){(t=a(89)(!1)).push([e.i,".unifiedFieldList__fieldPopover__fieldPopoverPanel{max-width:400px!important;min-width:260px!important}",""]),e.exports=t},192:function(e,t,a){var s=a(88),i=a(193);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},193:function(e,t,a){(t=a(89)(!1)).push([e.i,".unifiedFieldList__fieldPopover__fieldPopoverPanel{max-width:400px!important;min-width:260px!important}",""]),e.exports=t},194:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return u}));var s=a(19);const i=Object(s.createSlice)({name:"logRateAnalysisTableRow",initialState:{pinnedGroup:null,pinnedSignificantItem:null,selectedGroup:null,selectedSignificantItem:null},reducers:{clearAllRowState:e=>{e.pinnedGroup=null,e.pinnedSignificantItem=null,e.selectedGroup=null,e.selectedSignificantItem=null},setPinnedGroup:(e,t)=>{e.pinnedGroup=t.payload},setPinnedSignificantItem:(e,t)=>{e.pinnedSignificantItem=t.payload},setSelectedGroup:(e,t)=>{e.selectedGroup=t.payload},setSelectedSignificantItem:(e,t)=>{e.selectedSignificantItem=t.payload}}}),{clearAllRowState:l,setPinnedGroup:n,setPinnedSignificantItem:o,setSelectedGroup:r,setSelectedSignificantItem:u}=i.actions},195:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(){var e=s.useRef(!1),t=s.useCallback((function(){return e.current}),[]);return s.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},196:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(23).__importDefault(a(197));t.default=function(e){s.default((function(){e()}))}},197:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(e){s.useEffect(e,[])}},266:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(19),i=a(139);const l=Object(s.createSelector)((e=>e.logRateAnalysisTableRow.selectedGroup),(e=>e.logRateAnalysisTableRow.pinnedGroup),((e,t)=>e||t||void 0)),n=()=>Object(i.b)(l)},267:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(19),i=a(139);const l=Object(s.createSelector)((e=>e.logRateAnalysisTableRow.selectedSignificantItem),(e=>e.logRateAnalysisTableRow.pinnedSignificantItem),((e,t)=>e||t||void 0)),n=()=>Object(i.b)(l)},276:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return u}));var s=a(19),i=a(29),l=a(13);const n=Object(s.createAsyncThunk)("stream/start",(async(e,t)=>{const{http:a,endpoint:s,apiVersion:n,abortCtrl:o,body:u,headers:c}=e,d={isActive:!0},p=[];function b(e=!0){Object(i.batch)((()=>{for(const e of p)t.dispatch(e)})),p.length=0,e&&setTimeout((()=>{d.isActive&&b()}),100)}b();for await(const[e,t]of async function*(e,t,a,s,i,n=!0,o){let r;try{r=(await e.post(t,{signal:s.current.signal,version:a,asResponse:!0,rawResponse:!0,headers:o,...i&&Object.keys(i).length>0?{body:JSON.stringify(i)}:{}})).response}catch(e){return void(yield[e.toString(),void 0])}if(r)if(r.ok){if(null!==r.body){const e=r.body.getReader();let t="";for(;;)try{const{value:a,done:s}=await e.read();if(s)break;const i=`${t}${(new TextDecoder).decode(a)}`,o=n?i.split("\n"):[i],r=n?o.pop():"";t=null!=r?r:"";const u=n?o.map((e=>""===e||Object(l.startsWith)(e,"event: ")||"data: [DONE]"===e?"[IGNORE]":Object(l.startsWith)(e,"data: ")?JSON.parse(e.split("data: ")[1]):JSON.parse(e))).filter((e=>"[IGNORE]"!==e)):o;for(const e of u)yield[null,e]}catch(e){"AbortError"!==e.name&&(yield[e.toString(),void 0]);break}}}else yield[`Error ${r.status}: ${r.statusText}`,void 0];else yield["Error: Response was undefined",void 0]}(a,s,n,o,u,!0,c))null!==e?p.push(r(e)):t&&p.push(t);d.isActive=!1,b(!1)}),{condition:(e,{getState:t})=>{try{const e=t();if(void 0===e.stream)return!0;if(e.stream.isRunning&&e.stream.errors.length>0)return!1}catch(e){return!0}}}),o=Object(s.createSlice)({name:"stream",initialState:{errors:[],isCancelled:!1,isRunning:!1},reducers:{addError:(e,t)=>{e.errors.push(t.payload)},cancelStream:e=>{e.isCancelled=!0,e.isRunning=!1}},extraReducers:e=>{e.addCase(n.pending,(e=>{e.isRunning?e.errors.push("Instant restart while running not supported yet."):(e.errors=[],e.isCancelled=!1,e.isRunning=!0)})),e.addCase(n.fulfilled,(e=>{e.isRunning=!1}))}}),{addError:r,cancelStream:u}=o.actions},278:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var s=a(1),i=a(19),l=a(29),n=a(196),o=a.n(n),r=a(276);const u=Object(i.createSlice)({name:"logRateAnalysisResults",initialState:{ccsWarning:!1,significantItems:[],significantItemsGroups:[],errors:[],loaded:0,loadingState:"",zeroDocsFallback:!1},reducers:{addSignificantItems:(e,t)=>{e.significantItems.push(...t.payload)},addSignificantItemsHistogram:(e,t)=>{e.significantItems=e.significantItems.map((e=>{const a=t.payload.find((t=>t.fieldName===e.fieldName&&t.fieldValue===e.fieldValue));return{...e,...a?{histogram:a.histogram}:{}}}))},addSignificantItemsGroup:(e,t)=>{e.significantItemsGroups=t.payload},addSignificantItemsGroupHistogram:(e,t)=>{e.significantItemsGroups=e.significantItemsGroups.map((e=>{const a=t.payload.find((t=>t.id===e.id));return a&&(e.histogram=a.histogram),e}))},addError:(e,t)=>{e.errors.push(t.payload)},ping:()=>{},resetErrors:e=>{e.errors=[]},resetGroups:e=>{e.significantItemsGroups=[]},resetAll:()=>({ccsWarning:!1,significantItems:[],significantItemsGroups:[],errors:[],loaded:0,loadingState:"",zeroDocsFallback:!1}),updateLoadingState:(e,t)=>({...e,...t.payload}),setZeroDocsFallback:(e,t)=>{e.zeroDocsFallback=t.payload}}}),{addError:c,addSignificantItems:d,addSignificantItemsGroup:p,addSignificantItemsGroupHistogram:b,addSignificantItemsHistogram:g,ping:j,resetAll:m,resetErrors:f,resetGroups:y,setZeroDocsFallback:x,updateLoadingState:O}=(u.reducer,u.actions,u.actions);var h=a(188),v=a(194),T=a(0);const R=()=>Object(i.configureStore)({reducer:{logRateAnalysis:h.c.reducer,logRateAnalysisResults:u.reducer,logRateAnalysisStream:r.c.reducer,logRateAnalysisTableRow:v.b.reducer}}),k=({children:e,initialAnalysisStart:t})=>{const a=Object(s.useMemo)(R,[]);return o()((()=>{t&&a.dispatch(h.c.actions.setInitialAnalysisStart(t))})),Object(T.jsx)(l.Provider,{store:a},e)}},73:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(e){var t=s.useRef();return s.useEffect((function(){t.current=e})),t.current}}}]);