/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[20],{242:function(e,t,i){"use strict";i.r(t),i.d(t,"getChangePointChartEmbeddableFactory",(function(){return f}));var a=i(57),n=i(41),o=i(12),r=i(83),s=i(77),d=i.n(s),l=i(13),c=i(1),u=i(51),p=i.n(u),b=i(3),w=i(5),m=i(0);const f=e=>({type:a.d,deserializeState:e=>{var t;const i=Object(l.cloneDeep)(e.rawState),n=null===(t=e.references)||void 0===t?void 0:t.find((e=>e.name===a.b));return n&&i&&!i.dataViewId&&(i.dataViewId=null==n?void 0:n.id),i},buildEmbeddable:async(t,s,l,u)=>{const[f,g]=await e(),{http:h,uiSettings:v,notifications:j,...x}=f,{lens:S,data:P,usageCollection:V,fieldFormats:y}=g,C={http:h,uiSettings:v,data:P,notifications:j,lens:S,usageCollection:V,fieldFormats:y,...x},{api:O,comparators:T,serialize:F}=Object(r.g)(t),{titlesApi:I,titleComparators:E,serializeTitles:_}=Object(r.h)(t),{changePointControlsApi:B,changePointControlsComparators:D,serializeChangePointChartState:A}=(e=>{const t=new b.BehaviorSubject(e.viewType),i=new b.BehaviorSubject(e.dataViewId),a=new b.BehaviorSubject(e.fn),n=new b.BehaviorSubject(e.metricField),o=new b.BehaviorSubject(e.splitField),r=new b.BehaviorSubject(e.partitions),s=new b.BehaviorSubject(e.maxSeriesToPlot),l={viewType:[t,e=>t.next(e)],dataViewId:[i,e=>i.next(e)],fn:[a,e=>a.next(e)],metricField:[n,e=>n.next(e)],splitField:[o,e=>o.next(e)],partitions:[r,e=>r.next(e),d.a],maxSeriesToPlot:[s,e=>s.next(e)]};return{changePointControlsApi:{viewType:t,dataViewId:i,fn:a,metricField:n,splitField:o,partitions:r,maxSeriesToPlot:s,updateUserInput:e=>{t.next(e.viewType),i.next(e.dataViewId),a.next(e.fn),n.next(e.metricField),o.next(e.splitField),r.next(e.partitions),s.next(e.maxSeriesToPlot)}},serializeChangePointChartState:()=>({viewType:t.getValue(),dataViewId:i.getValue(),fn:a.getValue(),metricField:n.getValue(),splitField:o.getValue(),partitions:r.getValue(),maxSeriesToPlot:s.getValue()}),changePointControlsComparators:l}})(t),R=new b.BehaviorSubject(!0),z=new b.BehaviorSubject(void 0),M=new b.BehaviorSubject([await C.data.dataViews.get(t.dataViewId)]),U=s({...O,...I,...B,getTypeDisplayName:()=>o.i18n.translate("xpack.aiops.changePointDetection.typeDisplayName",{defaultMessage:"change point charts"}),isEditingEnabled:()=>!0,onEdit:async()=>{try{const{resolveEmbeddableChangePointUserInput:e}=await Promise.all([i.e(0),i.e(7),i.e(14)]).then(i.bind(null,275)),t=await e(f,g,u,l,A());B.updateUserInput(t)}catch(e){return Promise.reject()}},dataLoading:R,blockingError:z,dataViews:M,serializeState:()=>{const e=B.dataViewId.getValue(),t=e?[{type:n.DATA_VIEW_SAVED_OBJECT_TYPE,name:a.b,id:e}]:[];return{rawState:{timeRange:void 0,..._(),...F(),...A()},references:t}}},{...T,...E,...D}),k=Object(w.a)(f,g),L=e=>R.next(e),N=()=>R.next(!1),W=e=>z.next(e);return{api:U,Component:()=>{if(!Object(r.a)(u))throw new Error("Parent API does not have execution context");const[e,t,i,a,n,o,s]=Object(r.i)(U.dataViewId,U.viewType,U.fn,U.metricField,U.splitField,U.maxSeriesToPlot,U.partitions),l=Object(c.useMemo)((()=>Object(r.f)(U).pipe(Object(b.skipWhile)((e=>!e.isReload)),Object(b.map)((e=>Date.now())))),[]),w=Object(c.useMemo)((()=>Object(r.f)(U).pipe(Object(b.map)((e=>e.timeRange)),Object(b.distinctUntilChanged)(d.a))),[]),f=p()(l,Date.now()),g=p()(w,void 0);let h;return Object(r.a)(u)&&(h=u.executionContext.type),Object(m.jsx)(k,{viewType:t,timeRange:g,fn:i,metricField:a,splitField:n,maxSeriesToPlot:o,dataViewId:e,partitions:s,onLoading:L,onRenderComplete:N,onError:W,embeddingOrigin:h,lastReloadRequestTime:f})}}}})},51:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(23),n=i(1),o=a.__importDefault(i(78));t.default=function(e,t){var i=n.useState(t),a=i[0],r=i[1];return o.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),a}},78:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),n="undefined"!=typeof window?a.useLayoutEffect:a.useEffect;t.default=n}}]);