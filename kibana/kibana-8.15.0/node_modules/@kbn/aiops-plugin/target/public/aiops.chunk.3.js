/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[3],{118:function(e,t,r){"use strict";r.d(t,"a",(function(){return M}));var n=r(0),a=r(1),i=r.n(a),o=r(2),s=r(277),l=r(61);const u="exclude-frozen";var c=r(171),d=r(12),f=r(14),b=r(100),m=r(17),g=r.n(m),h=(r(21),r(167)),j=r(13);const v=e=>{const t={term:{_tier:{value:"data_frozen"}}};if(!e)return{bool:{must_not:[t]}};const r=Object(j.cloneDeep)(e);return delete r.match_all,Object(h.a)(r.bool)?Array.isArray(r.bool.must_not)?r.bool.must_not.push(t):(Object(h.a)(r.bool.must_not)&&(r.bool.must_not=[r.bool.must_not,t]),void 0===r.bool.must_not&&(r.bool.must_not=[t])):r.bool={must_not:[t]},r};var p=r(128);const O=e=>{const{frozenDataPreference:t,setFrozenDataPreference:r,timefilter:i,dataView:s,query:l,disabled:c,callback:m,apiPath:j}=e,{http:O,notifications:{toasts:y},showFrozenDataTierChoice:S}=Object(b.b)(),x=Object(a.useCallback)((async()=>{try{const e=await async function(e,t,r,n,a,i,o="/internal/file_upload/time_field_range"){try{const s=t.getRuntimeMappings(),l=await Object(p.a)({index:t.getIndexPattern(),timeFieldName:t.timeFieldName,query:i?v(a):a,...Object(h.a)(s)?{runtimeMappings:s}:{},http:n,path:o});if(l.start.epoch&&l.end.epoch)return e.setTime({from:g()(l.start.epoch).toISOString(),to:g()(l.end.epoch).toISOString()}),l;if("number"==typeof l.start&&"number"==typeof l.end)return e.setTime({from:g()(l.start).toISOString(),to:g()(l.end).toISOString()}),{success:!0,start:{epoch:l.start,string:g()(l.start).toISOString()},end:{epoch:l.end,string:g()(l.end).toISOString()}};r.addWarning({title:d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.noResults",{defaultMessage:"No results match your search criteria"})})}catch(e){r.addError(e,{title:d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range. Please set the desired start and end times."})})}}(i,s,y,O,l,!1!==S&&t===u,j);"function"==typeof m&&void 0!==e&&m(e)}catch(e){y.addError(e,{title:d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range. Please set the desired start and end times."})})}}),[i,s,y,O,l,S,t,j,m]),[P,k]=Object(a.useState)(!1),R=Object(a.useCallback)((e=>{r(e),E()}),[r]),E=()=>{k(!1)},F=Object(a.useMemo)((()=>[{id:u,label:d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.useFullDataExcludingFrozenMenuLabel",{defaultMessage:"Exclude frozen data tier"})},{id:"include-frozen",label:d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.useFullDataIncludingFrozenMenuLabel",{defaultMessage:"Include frozen data tier"})}]),[]),M=Object(a.useMemo)((()=>Object(n.jsx)(o.EuiPanel,null,Object(n.jsx)(o.EuiRadioGroup,{options:F,idSelected:t,onChange:R,compressed:!0}))),[F,t,R]),I=Object(a.useMemo)((()=>!1===S?Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.fullTimeRangeSelector.useFullData",defaultMessage:"Use full range of data."}):t===u?Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.fullTimeRangeSelector.useFullDataExcludingFrozenButtonTooltip",defaultMessage:"Use full range of data excluding frozen data tier."}):Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.fullTimeRangeSelector.useFullDataIncludingFrozenButtonTooltip",defaultMessage:"Use full range of data including frozen data tier, which might have slower search results."})),[t,S]);return Object(n.jsx)(o.EuiFlexGroup,{responsive:!1,gutterSize:"xs"},Object(n.jsx)(o.EuiToolTip,{content:I},Object(n.jsx)(o.EuiButton,{isDisabled:c,onClick:()=>x(),"data-test-subj":"mlDatePickerButtonUseFullData"},Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full data"}))),!1===S?null:Object(n.jsx)(o.EuiFlexItem,{grow:!1},Object(n.jsx)(o.EuiPopover,{id:"mlFullTimeRangeSelectorOption",button:Object(n.jsx)(o.EuiButtonIcon,{"data-test-subj":"mlDatePickerButtonDataTierOptions",display:"base",size:"m",iconType:"boxesVertical","aria-label":d.i18n.translate("xpack.ml.datePicker.fullTimeRangeSelector.moreOptionsButtonAriaLabel",{defaultMessage:"More options"}),onClick:()=>{k(!P)}}),isOpen:P,closePopover:E,panelPaddingSize:"none",anchorPosition:"downRight"},M)))};var y=r(3),S=r(96),x=r(127);const P=5e3,k=e=>{var t,r,l;const{isAutoRefreshOnly:u,isLoading:m=!1,showRefresh:g,width:h,flexGroup:v=!0,isDisabled:p=!1,needsUpdate:O,onRefresh:k}=e,{data:R,notifications:{toasts:E},uiSettings:F,uiSettingsKeys:M,theme:I,i18n:T}=Object(b.b)(),w=Object(o.useIsWithinMaxBreakpoint)("l"),{timefilter:_,history:D}=R.query.timefilter,[C,A]=Object(s.c)("_g"),z=(q=D,function(){var e,t;return null!==(e=null===(t=q.get())||void 0===t?void 0:t.map((({from:e,to:t})=>({start:e,end:t}))))&&void 0!==e?e:[]});var q;const B=Object(c.a)(),N=Object(c.b)();Object(a.useEffect)((function(){void 0!==(null==C?void 0:C.time)&&_.setTime({from:C.time.from,to:C.time.to})}),[null==C||null===(t=C.time)||void 0===t?void 0:t.from,null==C||null===(r=C.time)||void 0===r?void 0:r.to,null==C||null===(l=C.time)||void 0===l?void 0:l.ts]),Object(a.useEffect)((function(){var e,t;void 0!==(null==C?void 0:C.refreshInterval)&&_.setRefreshInterval({pause:!(null==C||null===(e=C.refreshInterval)||void 0===e||!e.pause),value:null==C||null===(t=C.refreshInterval)||void 0===t?void 0:t.value})}),[null==C?void 0:C.refreshInterval]);const U=Object(a.useCallback)(Object(j.debounce)((e=>{A("refreshInterval",e,!0)}),200),[A]),[L,W]=Object(a.useState)(z()),[K,Q]=Object(a.useState)(_.isAutoRefreshSelectorEnabled()),[G,V]=Object(a.useState)(_.isTimeRangeSelectorEnabled()),$=B;Object(a.useEffect)((function(){const e=!(null==C||!C.refreshInterval);$.value<P&&!$.pause&&E.addWarning({title:e?d.i18n.translate("xpack.ml.datePicker.shortRefreshIntervalURLWarningMessage",{defaultMessage:"The refresh interval in the URL is shorter than the minimum supported interval."}):d.i18n.translate("xpack.ml.datePicker.shortRefreshIntervalTimeFilterWarningMessage",{defaultMessage:"The refresh interval in Advanced Settings is shorter than the minimum supported interval."}),text:Object(S.a)(Object(n.jsx)(o.EuiButton,{onClick:U.bind(null,{pause:$.pause,value:P})},Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.pageRefreshResetButton",defaultMessage:"Set to {defaultInterval}",values:{defaultInterval:"5s"}})),{theme:I,i18n:T})},{toastLifeTimeMs:3e4})}),[JSON.stringify($),JSON.stringify(null==C?void 0:C.refreshInterval),U]);const J=F.get("dateFormat"),H=F.get(M.TIMEPICKER_QUICK_RANGES),Y=Object(a.useMemo)((()=>H.map((({from:e,to:t,display:r})=>({start:e,end:t,label:r})))),[H]);Object(a.useEffect)((()=>{const e=new y.Subscription,t=_.getEnabledUpdated$();return void 0!==t&&e.add(t.subscribe((e=>{Q(_.isAutoRefreshSelectorEnabled()),V(_.isTimeRangeSelectorEnabled())}))),function(){e.unsubscribe()}}),[]);const X=Object(a.useCallback)((({start:e,end:t})=>{W(z()),A("time",{from:e,to:t,..."now"===e||"now"===t?{ts:Date.now()}:{}})}),[A]),Z=Object(a.useCallback)((()=>{x.a.next({lastRefresh:Date.now()}),k&&k()}),[k]),ee=Object(n.jsx)(i.a.Fragment,null,Object(n.jsx)(o.EuiFlexItem,null,Object(n.jsx)(o.EuiSuperDatePicker,{isLoading:m,start:N.from,end:N.to,isPaused:$.pause,isAutoRefreshOnly:!G||u,refreshInterval:$.value||P,onTimeChange:X,onRefresh:Z,onRefreshChange:function({isPaused:e,refreshInterval:t}){!1===e&&t<=0&&U({pause:e,value:5e3}),U({pause:e,value:t})},recentlyUsedRanges:L,dateFormat:J,commonlyUsedRanges:Y,updateButtonProps:{iconOnly:w,fill:!1,...O?{needsUpdate:O}:{}},width:h,isDisabled:p})),!0!==g&&G?null:Object(n.jsx)(o.EuiFlexItem,{grow:!1},Object(n.jsx)(o.EuiButton,{fill:!1,color:O?"success":"primary",iconType:O?"kqlFunction":"refresh",onClick:Z,"data-test-subj":"mlDatePickerRefreshPageButton"+(m?" loading":" loaded"),isLoading:m},O?Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.pageUpdateButton",defaultMessage:"Update"}):Object(n.jsx)(f.FormattedMessage,{id:"xpack.ml.datePicker.pageRefreshButton",defaultMessage:"Refresh"})))),te=v?Object(n.jsx)(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},ee):ee;return K||G?te:null};var R=r(45),E=r(58);const F={name:"1v0pok0",styles:"min-width:300px"},M=()=>{const[,e]=Object(s.c)("_g"),{dataView:t}=Object(R.c)(),[r,i]=Object(l.b)(E.a,u),d=Object(c.c)({timeRangeSelector:void 0!==t.timeFieldName,autoRefreshSelector:!0}),f=Object(a.useCallback)((t=>{e({time:{from:g()(t.start.epoch).toISOString(),to:g()(t.end.epoch).toISOString()}})}),[e]),b=Object(a.useMemo)((()=>void 0!==t.timeFieldName&&""!==t.timeFieldName),[t.timeFieldName]);return Object(n.jsx)(o.EuiPageHeader,{pageTitle:Object(n.jsx)("div",{css:F},t.getName()),rightSideItems:[Object(n.jsx)(o.EuiFlexGroup,{gutterSize:"s","data-test-subj":"aiopsTimeRangeSelectorSection"},b?Object(n.jsx)(o.EuiFlexItem,{grow:!1},Object(n.jsx)(O,{frozenDataPreference:r,setFrozenDataPreference:i,dataView:t,query:void 0,disabled:!1,timefilter:d,callback:f})):null,Object(n.jsx)(k,{isAutoRefreshOnly:!b,showRefresh:!b,width:"full",flexGroup:!1}))]})}},128:function(e,t,r){"use strict";async function n(e){const{http:t,path:r,signal:n,...a}=e;return await t.fetch({path:r,method:"POST",body:JSON.stringify(a),version:"1",...n?{signal:n}:{}})}r.d(t,"a",(function(){return n}))},50:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return d}));var n=r(13),a=r(16),i=r(18),o=r(15);r(167);const s={bool:{must:[{match_all:{}}]}};function l(){return Object(n.cloneDeep)(s)}var u=r(260);function c(e,t,r,n){let s=l();if(Object(i.isQuery)(e)&&e.language===u.a.KUERY){const n=Object(o.fromKueryExpression)(e.query);if(""!==e.query&&(s=Object(o.toElasticsearchQuery)(n,r)),void 0!==s.bool){const e=Object(o.buildQueryFromFilters)(t,r);Array.isArray(s.bool.filter)||(s.bool.filter=void 0===s.bool.filter?[]:[s.bool.filter]),Array.isArray(s.bool.must_not)||(s.bool.must_not=void 0===s.bool.must_not?[]:[s.bool.must_not]),s.bool.filter=[...s.bool.filter,...e.filter],s.bool.must_not=[...s.bool.must_not,...e.must_not]}}else s=Object(o.buildEsQuery)(r,e?[e]:[],t||[],n?Object(a.getEsQueryConfig)(n):void 0);return s}function d({dataView:e,uiSettings:t,savedSearch:r,query:o,filters:s,filterManager:u}){if(!e||!r)return;const d=o,f=s,b=function(e){return e&&"searchSource"in e&&(null==e?void 0:e.searchSource)instanceof a.SearchSource?e.searchSource:void 0}(r);if(b&&void 0!==b.getParent()&&d){var m,g,h;const e=null!==(m=Object(n.cloneDeep)(null===(g=r.searchSource.getSearchRequestBody())||void 0===g?void 0:g.query))&&void 0!==m?m:l(),t=null===(h=r.searchSource.getField("index"))||void 0===h?void 0:h.timeFieldName;return Array.isArray(e.bool.filter)&&void 0!==t&&(e.bool.filter=e.bool.filter.filter((e=>{var r;return!(e.hasOwnProperty("range")&&null!==(r=e.range)&&void 0!==r&&r.hasOwnProperty(t))}))),{searchQuery:e,searchString:d.query,queryLanguage:d.language}}if(!r&&d)return u&&f&&u.addFilters(f),{searchQuery:c(d,Array.isArray(f)?f:[],e,t),searchString:d.query,queryLanguage:d.language};if(b){const r=null==u?void 0:u.getGlobalFilters(),n=null!=d?d:b.getField("query"),a=null!=f?f:Object(i.mapAndFlattenFilters)(b.getField("filter"));return u&&u.setFilters(a),r&&(null==u||u.addFilters(r)),{searchQuery:c(n,u?null==u?void 0:u.getFilters():a,e,t),searchString:n.query,queryLanguage:n.language}}}},64:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r(2);const a=e=>e.darkMode?n.COLOR_MODES_STANDARD.dark:n.COLOR_MODES_STANDARD.light,i={darkMode:!1}},71:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var n=void 0;t.setEuiDevProviderWarning=function(e){return n=e},t.getEuiDevProviderWarning=function(){return n},t.emitEuiProviderWarning=function(e){if("function"==typeof n)return n(e);switch(n){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},76:function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"a",(function(){return O}));var n=r(1),a=r(25),i=r(71),o=r(51),s=r.n(o),l=r(27),u=r.n(l),c=r(2);const d="eui-global",f="eui-utilities";var b=r(64),m=r(0);const g=[c.euiStylisPrefixer],h=u()({key:"css",stylisPlugins:g,container:document.querySelector('meta[name="emotion"]')}),j=u()({key:d,stylisPlugins:g,container:document.querySelector(`meta[name="${d}"]`)}),v=u()({key:f,stylisPlugins:g,container:document.querySelector(`meta[name="${f}"]`)});h.compat=!0,j.compat=!0,v.compat=!0;const p={default:h,global:j,utility:v},O=({theme:{theme$:e},globalStyles:t,colorMode:r,modify:a,children:i})=>{const o=s()(e,b.a),l=Object(n.useMemo)((()=>Object(b.b)(o)),[o]),u=r||l,d=!1!==t&&void 0;return Object(m.jsx)(c.EuiProvider,{cache:p,modify:a,colorMode:u,globalStyles:d,utilityClasses:d},i)},y=({children:e,i18n:t,...r})=>Object(a.useIsNestedEuiProvider)()?(Object(i.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(m.jsx)(t.Context,null,e)):Object(m.jsx)(O,r,Object(m.jsx)(t.Context,null,e))},85:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(4),a=r.n(n),i=(r(1),r(76)),o=r(28),s=r(0);const l=({children:e,...t})=>Object(s.jsx)(i.b,a()({globalStyles:!1},t),Object(s.jsx)(o.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(s.jsx)(o.KibanaErrorBoundary,null,e)))},96:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(1),a=r(24),i=r.n(a),o=r(85),s=r(0);const l=(e,t)=>r=>(i.a.render(Object(s.jsx)(o.a,t,e),r),()=>i.a.unmountComponentAtNode(r));r(59),r(12),n.Component}}]);