/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,i,a=t[0],o=t[1],c=0,l=[];c<a.length;c++)i=a[c],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&l.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(s&&s(t);l.length;)l.shift()()}var n={},r={1:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=a);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(e){return i.p+"threatIntelligence.chunk."+e+".js"}(e);var s=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,n[1](s)}r[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.threatIntelligence_bundle_jsonpfunction=window.threatIntelligence_bundle_jsonpfunction||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var s=o;i(i.s=19)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));let r=function(e){return e.Type="threat.indicator.type",e.Confidence="threat.indicator.confidence",e.FirstSeen="threat.indicator.first_seen",e.LastSeen="threat.indicator.last_seen",e.MarkingTLP="threat.indicator.marking.tlp",e.Feed="threat.feed.name",e.Ip="threat.indicator.ip",e.EmailAddress="threat.indicator.email.address",e.UrlFull="threat.indicator.url.full",e.UrlOriginal="threat.indicator.url.original",e.UrlDomain="threat.indicator.url.domain",e.FileSha256="threat.indicator.file.hash.sha256",e.FileMd5="threat.indicator.file.hash.md5",e.FileSha1="threat.indicator.file.hash.sha1",e.FileSha224="threat.indicator.file.hash.sha224",e.FileSha3224="threat.indicator.file.hash.sha3-224",e.FileSha3256="threat.indicator.file.hash.sha3-256",e.FileSha384="threat.indicator.file.hash.sha384",e.FileSha3384="threat.indicator.file.hash.sha3-384",e.FileSha512="threat.indicator.file.hash.sha512",e.FileSha3512="threat.indicator.file.hash.sha3-512",e.FileSha512224="threat.indicator.file.hash.sha512/224",e.FileSha512256="threat.indicator.file.hash.sha512/256",e.FileSSDeep="threat.indicator.file.hash.ssdeep",e.FileTlsh="threat.indicator.file.hash.tlsh",e.FileImpfuzzy="threat.indicator.file.hash.impfuzzy",e.FileImphash="threat.indicator.file.hash.imphash",e.FilePehash="threat.indicator.file.hash.pehash",e.FileVhash="threat.indicator.file.hash.vhash",e.X509Serial="threat.indicator.x509.serial_number",e.WindowsRegistryKey="threat.indicator.registry.key",e.WindowsRegistryPath="threat.indicator.registry.path",e.AutonomousSystemNumber="threat.indicator.as.number",e.MacAddress="threat.indicator.mac",e.TimeStamp="@timestamp",e.Id="_id",e.Name="threat.indicator.name",e.Description="threat.indicator.description",e.NameOrigin="threat.indicator.name_origin",e}({});const i={[r.FileSha256]:["file.hash.sha256"],[r.FileMd5]:["file.hash.md5"],[r.FileSha1]:["file.hash.sha1"],[r.FileSha224]:["file.hash.sha224"],[r.FileSha3224]:["file.hash.sha3-224"],[r.FileSha3256]:["file.hash.sha3-256"],[r.FileSha384]:["file.hash.sha384"],[r.FileSha3384]:["file.hash.sha3-384"],[r.FileSha512]:["file.hash.sha512"],[r.FileSha3512]:["file.hash.sha3-512"],[r.FileSha512224]:["file.hash.sha512/224"],[r.FileSha512256]:["file.hash.sha512/256"],[r.FileSSDeep]:["file.hash.ssdeep"],[r.FileTlsh]:["file.hash.tlsh"],[r.FileImpfuzzy]:["file.hash.impfuzzy"],[r.FileImphash]:["file.hash.imphash"],[r.FilePehash]:["file.hash.pehash"],[r.FileVhash]:["file.hash.vhash"],[r.Ip]:["source.ip","destination.ip"],[r.UrlFull]:["url.full"],[r.WindowsRegistryPath]:["registry.path"]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(9);n.d(t,"a",(function(){return r.KibanaContextProvider}));const i=()=>Object(r.useKibana)()},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o}));const r="-",i="dateFormat",a="dateFormat:tz",o="event.type: indicator and event.category : threat"},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(6),i=n(11),a=n(4);const o=(e,t)=>{const n=Object(i.a)(e,t);return{key:t===a.b.Name?Object(i.a)(e,a.b.NameOrigin):t,value:n}},c=(e,t)=>!!t&&t!==r.c&&!!e},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);const i=Object(r.createContext)(void 0)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{var n;if(!e)return null;const r=null===(n=e.fields)||void 0===n?void 0:n[t];if(!Array.isArray(r))return null;const i=r[0];return"object"==typeof i?null:i}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o}));const r="threatIntelligenceSearchStrategy",i="barchartAggregation";let a=function(e){return e.IndicatorGrid="indicatorGrid",e.Barchart="barchart",e}({});const o="indicator"},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/cases/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),i=n(10);const a=()=>{const e=Object(r.useContext)(i.a);if(!e)throw new Error("SecuritySolutionContext can only be used within SecuritySolutionContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n(1);var r=n(5),i=n(0);const a=({children:e,...t})=>{const{services:{securityLayout:{getPluginWrapper:n}}}=Object(r.b)(),a=n();return Object(i.jsx)(a,t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return g}));var r=n(13),i=n(1),a=n.n(i),o=n(2),c=n(3),s=n(12),l=n(6),u=n(4),h=n(8),d=n(0);const p=a.a.lazy((()=>Promise.all([n.e(0),n.e(3)]).then(n.bind(null,33)))),f=()=>({id:s.b,displayName:"indicator",getAttachmentViewObject:()=>({event:Object(d.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.eventDescription",defaultMessage:"added an indicator of compromise"}),timelineAvatar:Object(d.jsx)(o.EuiAvatar,{name:"indicator",color:"subdued",iconType:"crosshairs"}),children:p}),icon:"crosshairs"}),b=(e,t)=>e?[{type:r.AttachmentType.externalReference,externalReferenceId:e,externalReferenceStorage:{type:r.ExternalReferenceStorageType.elasticSearchDoc},externalReferenceAttachmentTypeId:s.b,externalReferenceMetadata:t}]:[],g=e=>{const t=Object(h.b)(e,u.b.Name).value,n=Object(h.b)(e,u.b.Type).value,r=Object(h.b)(e,u.b.Feed).value;return{indicatorName:t||l.c,indicatorType:n||l.c,indicatorFeedName:r||l.c}}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ReactRedux},function(e,t,n){n(20),__kbnBundles__.define("plugin/threatIntelligence/public",n,21)},function(e,t,n){n.p=window.__kbnPublicPath__.threatIntelligence},function(e,t,n){"use strict";n.r(t),n.d(t,"THREAT_INTELLIGENCE_BASE_PATH",(function(){return S})),n.d(t,"getSecuritySolutionLink",(function(){return F})),n.d(t,"plugin",(function(){return k}));var r=n(17),i=n(18),a=n(1),o=n.n(a),c=n(3),s=n(16),l=n(5),u=n(10),h=n(2),d=n(0);const p=()=>{const{services:{application:e}}=Object(l.b)();return Object(d.jsx)(h.EuiEmptyPrompt,{icon:Object(d.jsx)(h.EuiIcon,{type:"logoSecurity",size:"xl"}),color:"subdued","data-test-subj":"tiPaywall",title:Object(d.jsx)("h2",null,Object(d.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.paywall.title",defaultMessage:"Do more with Security!"})),body:Object(d.jsx)("p",null,Object(d.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.paywall.body",defaultMessage:"Start a free trial or upgrade your license to Enterprise to use threat intelligence."})),actions:Object(d.jsx)(h.EuiFlexGroup,{direction:"column"},Object(d.jsx)(h.EuiFlexItem,null,Object(d.jsx)("div",null,Object(d.jsx)(h.EuiButton,{color:"primary",fill:!0,href:"https://www.elastic.co/subscriptions"},Object(d.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.paywall.upgrade",defaultMessage:"Upgrade"})))),Object(d.jsx)(h.EuiFlexItem,null,Object(d.jsx)("div",null,Object(d.jsx)(h.EuiButtonEmpty,{onClick:()=>e.navigateToApp("management",{path:"stack/license_management/home"})},Object(d.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.paywall.trial",defaultMessage:"Start a free trial"})))))})};var f=n(14),b=n(15);const g=Object(a.memo)((({children:e})=>{const{licenseService:t}=Object(f.a)();return t.isEnterprise()?Object(d.jsx)(o.a.Fragment,null,e):Object(d.jsx)(b.a,{isEmptyState:!0,emptyPageBody:Object(d.jsx)(p,null)})})),_=o.a.lazy((()=>Promise.all([n.e(0),n.e(2)]).then(n.bind(null,77)))),m=e=>()=>({securitySolutionContext:t})=>Object(d.jsx)(c.__IntlProvider,null,Object(d.jsx)(i.Provider,{store:t.securitySolutionStore},Object(d.jsx)(u.a.Provider,{value:t},Object(d.jsx)(l.a,{services:e},Object(d.jsx)(g,null,Object(d.jsx)(a.Suspense,{fallback:Object(d.jsx)("div",null)},Object(d.jsx)(_,null)))))));class plugin_ThreatIntelligencePlugin{async setup(e,t){const n=Object(s.a)();return t.cases.attachmentFramework.registerExternalReference(n),{}}start(e,t){const n={storage:new r.Storage(localStorage),...e,...t};return{getComponent:m(n)}}stop(){}}var j=n(7);const y=j.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemLabel",{defaultMessage:"Indicators"}),v=j.i18n.translate("xpack.threatIntelligence.navigation.intelligenceNavItemLabel",{defaultMessage:"Intelligence"}),O=j.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemDescription",{defaultMessage:"Elastic threat intelligence helps you see if you are open to or have been subject to current or historical known threats."}),S=(j.i18n.translate("xpack.threatIntelligence.navigation.indicatorsNavItemKeywords",{defaultMessage:"Indicators"}),"/threat_intelligence"),x={indicators:{oldNavigationName:y,newNavigationName:v,path:`${S}/indicators`,id:"threat_intelligence",description:O,globalSearchKeywords:[v],keywords:[v],disabled:!1}},F=e=>({id:x[e].id,title:x[e].newNavigationName,path:x[e].path,description:x[e].description,globalSearchKeywords:x[e].globalSearchKeywords});function k(){return new plugin_ThreatIntelligencePlugin}},function(e,t){e.exports=__kbnSharedDeps__.ReactQuery},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/inspector/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnEsQuery}]);