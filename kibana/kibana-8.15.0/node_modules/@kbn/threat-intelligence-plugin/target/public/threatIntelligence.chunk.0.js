/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.threatIntelligence_bundle_jsonpfunction=window.threatIntelligence_bundle_jsonpfunction||[]).push([[0],Array(34).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1),a=n(4),s=n(14),r=n(49);const c={aggregatable:!0,name:a.b.Name,searchable:!0,type:"string",category:"threat",description:r.a,esTypes:["keyword"]},o=()=>{const{sourcererDataView:e}=Object(s.a)(),t=Object(i.useMemo)((()=>{const t=[...e.indexPattern.fields,c];return{...e.indexPattern,fields:t}}),[e.indexPattern]),n=Object(i.useMemo)((()=>[t]),[t]),a=Object(i.useMemo)((()=>{const{threat:t={fields:{}}}=e.browserFields;return{...e.browserFields,threat:{fields:{...t.fields,[c.name]:c}}}}),[e.browserFields]);return Object(i.useMemo)((()=>({...e,indexPatterns:n,indexPattern:t,browserFields:a})),[a,n,e,t])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b})),n(1);var i=n(2),a=n(48),s=n(41),r=n(50),c=n(0);const o="plusInCircle",u=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:u}=Object(a.a)({indicator:e,field:t,filterType:s.a});return u?Object(c.jsx)(i.EuiToolTip,{content:r.a},Object(c.jsx)(i.EuiButtonIcon,{"aria-label":r.a,iconType:o,iconSize:"s",size:"xs",color:"primary",onClick:u,"data-test-subj":n})):null},l=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:u}=Object(a.a)({indicator:e,field:t,filterType:s.a});return u?Object(c.jsx)(i.EuiToolTip,{content:r.a},Object(c.jsx)(i.EuiButtonEmpty,{"aria-label":r.a,iconType:o,iconSize:"s",color:"primary",onClick:u,"data-test-subj":n},r.a)):null},d=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:o}=Object(a.a)({indicator:e,field:t,filterType:s.a});return o?Object(c.jsx)(i.EuiContextMenuItem,{key:"filterIn",icon:"plusInCircle",size:"s",onClick:o,"data-test-subj":n},r.a):null},b=({data:e,field:t,Component:n,"data-test-subj":u})=>{const{filterFn:l}=Object(a.a)({indicator:e,field:t,filterType:s.a});return l?Object(c.jsx)(i.EuiToolTip,{content:r.a},Object(c.jsx)(i.EuiFlexItem,{"data-test-subj":u},Object(c.jsx)(n,{"aria-label":r.a,iconType:o,onClick:l},r.a))):null}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b})),n(1);var i=n(2),a=n(48),s=n(41),r=n(50),c=n(0);const o="minusInCircle",u=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:u}=Object(a.a)({indicator:e,field:t,filterType:s.b});return u?Object(c.jsx)(i.EuiToolTip,{content:r.b},Object(c.jsx)(i.EuiButtonIcon,{"aria-label":r.b,iconType:o,iconSize:"s",size:"xs",color:"primary",onClick:u,"data-test-subj":n})):null},l=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:u}=Object(a.a)({indicator:e,field:t,filterType:s.b});return u?Object(c.jsx)(i.EuiToolTip,{content:r.b},Object(c.jsx)(i.EuiButtonEmpty,{"aria-label":r.b,iconType:o,iconSize:"s",color:"primary",onClick:u,"data-test-subj":n},r.b)):null},d=({data:e,field:t,"data-test-subj":n})=>{const{filterFn:o}=Object(a.a)({indicator:e,field:t,filterType:s.b});return o?Object(c.jsx)(i.EuiContextMenuItem,{key:"filterOut",icon:"minusInCircle",size:"s",onClick:o,"data-test-subj":n},r.b):null},b=({data:e,field:t,Component:n,"data-test-subj":u})=>{const{filterFn:l}=Object(a.a)({indicator:e,field:t,filterType:s.b});return l?Object(c.jsx)(i.EuiToolTip,{content:r.b},Object(c.jsx)(i.EuiFlexItem,{"data-test-subj":u},Object(c.jsx)(n,{"aria-label":r.b,iconType:o,onClick:l},r.b))):null}},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return O}));var i=n(1),a=n.n(i),s=n(2),r=n(42),c=n(8),o=n(5);const u=({indicator:e,field:t})=>{const{analytics:n,i18n:i,theme:a}=Object(o.b)().services,s={analytics:n,i18n:i,theme:a},{key:u,value:l}="string"==typeof e?{key:t,value:e}:Object(c.b)(e,t);return Object(c.a)(u,l)?{addToTimelineProps:{dataProvider:[Object(r.a)(u,l)],field:u,ownFocus:!1,startServices:s}}:{}};var l=n(51),d=n(0);const b="timeline",j=({data:e,field:t,"data-test-subj":n})=>{const i=Object(o.b)().services.timelines.getHoverActions().getAddToTimelineButton,{addToTimelineProps:a}=u({indicator:e,field:t});return a?Object(d.jsx)(s.EuiToolTip,{content:l.b},Object(d.jsx)(s.EuiFlexItem,{"data-test-subj":n},i(a))):null},f=({data:e,field:t,"data-test-subj":n})=>{const u=Object(i.useRef)(null),{timelines:j,analytics:f,i18n:x,theme:O}=Object(o.b)().services,p={analytics:f,i18n:x,theme:O},m=j.getHoverActions().getAddToTimelineButton,{key:g,value:v}="string"==typeof e?{key:t,value:e}:Object(c.b)(e,t);if(!Object(c.a)(g,v))return null;const y={dataProvider:[Object(r.a)(g,v)],field:g,ownFocus:!1,startServices:p};return y.defaultFocusedButtonRef=u,Object(d.jsx)(a.a.Fragment,null,Object(d.jsx)("div",{css:{display:"none"}},m(y)),Object(d.jsx)(s.EuiToolTip,{content:l.b},Object(d.jsx)(s.EuiButtonEmpty,{"aria-label":l.b,iconType:b,iconSize:"s",color:"primary",onClick:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.click()},"data-test-subj":n},l.b)))},x=({data:e,field:t,"data-test-subj":n})=>{const u=Object(i.useRef)(null),{timelines:j,analytics:f,i18n:x,theme:O}=Object(o.b)().services,p={analytics:f,i18n:x,theme:O},m=j.getHoverActions().getAddToTimelineButton,{key:g,value:v}="string"==typeof e?{key:t,value:e}:Object(c.b)(e,t);if(!Object(c.a)(g,v))return null;const y={dataProvider:[Object(r.a)(g,v)],field:g,ownFocus:!1,startServices:p};return y.defaultFocusedButtonRef=u,Object(d.jsx)(a.a.Fragment,null,Object(d.jsx)("div",{css:{display:"none"}},m(y)),Object(d.jsx)(s.EuiContextMenuItem,{key:"addToTimeline",icon:b,size:"s",onClick:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.click()},"data-test-subj":n},l.b))},O=({data:e,field:t,Component:n,"data-test-subj":i})=>{const a=Object(o.b)().services.timelines.getHoverActions().getAddToTimelineButton,{addToTimelineProps:r}=u({indicator:e,field:t});return r?(r.Component=n,Object(d.jsx)(s.EuiToolTip,{content:l.b},Object(d.jsx)(s.EuiFlexItem,{"data-test-subj":i},a(r)))):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(1),a=n(46);const s=()=>{const e=Object(i.useContext)(a.a);if(!e)throw new Error("BlockListContext can only be used within BlockListContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u})),n(1);var i=n(2),a=n(47),s=n(0);const r="copyClipboard",c=({value:e,"data-test-subj":t})=>Object(s.jsx)(i.EuiCopy,{textToCopy:e},(e=>Object(s.jsx)(i.EuiButtonEmpty,{"aria-label":a.b,iconType:r,iconSize:"s",color:"primary",onClick:e,"data-test-subj":t},a.b))),o=({value:e,"data-test-subj":t})=>Object(s.jsx)(i.EuiCopy,{textToCopy:e},(e=>Object(s.jsx)(i.EuiContextMenuItem,{key:"copyToClipboard",icon:r,size:"s",onClick:e,"data-test-subj":t},a.b))),u=({value:e,"data-test-subj":t})=>Object(s.jsx)(i.EuiCopy,{textToCopy:e},(e=>Object(s.jsx)(i.EuiButtonIcon,{"aria-label":a.b,iconType:r,iconSize:"s",color:"primary",onClick:e,"data-test-subj":t},a.b)))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n(1);const a=Object(i.createContext)(void 0),s=()=>{const e=Object(i.useContext)(a);if(!e)throw new Error("IndicatorsFiltersContext can only be used within IndicatorsFiltersContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));const i=!0,a=!1,s=(e,t,n,i,a)=>{const s=(({key:e,value:t,negate:n,index:i})=>({meta:{alias:null,negate:n,disabled:!1,type:"phrase",key:e,params:{query:t},index:i},query:{match_phrase:{[e]:t}}}))({key:t,value:n,negate:!i,index:a}),r=((e,t,n)=>e.find((e=>{var i;return e.meta.key===t&&"object"==typeof e.meta.params&&"query"in e.meta.params&&(null===(i=e.meta.params)||void 0===i?void 0:i.query)===n})))(e,t,n);return((e,t)=>null!=e&&t===e.meta.negate)(r,i)?[...e.filter((e=>e!==r)),s]:[...e,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=(e,t)=>({and:[],enabled:!0,id:`timeline-indicator-${e}-${t}`,name:t,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:t,operator:":"}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var i=n(23),a=n.n(i),s=n(24),r=n(6);a.a.suppressDeprecationWarnings=!0;const c=(e,t,n)=>{const i="string"==typeof e?a.a.tz(e,t):e.tz(t);return i.isValid()?i.format(n):r.c},o=e=>{const t=((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(e.min,e.max),n=Object(s.niceTimeFormatByDay)(t);return Object(s.timeFormatter)(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(26),a=n(12);const s=async(e,t,{inspectorAdapter:n,requestName:s,signal:r,skipDefaultStrategy:c=!1})=>{const o=((e,{requestName:t})=>{const n=`${Date.now()}`,i=null==e?void 0:e.start(t,{id:n});return{recordRequestError(e){i&&i.error({json:e})},recordRequestCompletion(e,t){var n;i&&(i.stats({}).ok({json:t}),i.json((null===(n=e.params)||void 0===n?void 0:n.body)||{}))},resetRequest(){e&&e.resetRequest(n)}}})(n,{requestName:s});return new Promise(((n,s)=>{e.search(t,{abortSignal:r,...c?{}:{strategy:a.d}}).subscribe({next:e=>{Object(i.isRunningResponse)(e)||(o.recordRequestCompletion(t,e),n(e.rawResponse))},error:t=>{t instanceof Error&&t.name.includes("Abort")?o.resetRequest():o.recordRequestError(t),e.showError(t),s(t)}})}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var i=n(1),a=n.n(i),s=n(52),r=n(6),c=n(4),o=n(54),u=n(11),l=n(2),d=n(66),b=n.n(d),j=n(0);const f={red:"danger",amber:"warning","amber+strict":"warning",green:"success",white:"hollow",clear:"hollow"},x=({value:e})=>{const t=null==e?void 0:e.toLowerCase().trim(),n=f[t||""],s=Object(i.useMemo)((()=>null==t?void 0:t.replaceAll(/\W/g," ").split(" ").map(b.a).join(" ")),[t]);return n?Object(j.jsx)(l.EuiBadge,{color:n},s):Object(j.jsx)(a.a.Fragment,null,r.c)},O=({indicator:e,field:t})=>{const n=Object(s.a)()[t],i=Object(u.a)(e,t);return t===c.b.MarkingTLP?Object(j.jsx)(x,{value:i}):"date"===n?Object(j.jsx)(o.a,{date:i}):i?Object(j.jsx)(a.a.Fragment,null,i):Object(j.jsx)(a.a.Fragment,null,r.c)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var i=n(1),a=n(0);const s=Object(i.createContext)(void 0),r=({children:e})=>{const[t,n]=Object(i.useState)(""),r={blockListIndicatorValue:t,setBlockListIndicatorValue:n};return Object(a.jsx)(s.Provider,{value:r},e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return b}));var i=n(7);const a=i.i18n.translate("xpack.threatIntelligence.indicators.table.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),s=i.i18n.translate("xpack.threatIntelligence.field.@timestamp",{defaultMessage:"@timestamp"}),r=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.name",{defaultMessage:"Indicator"}),c=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.type",{defaultMessage:"Indicator type"}),o=i.i18n.translate("xpack.threatIntelligence.field.threat.feed.name",{defaultMessage:"Feed"}),u=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.first_seen",{defaultMessage:"First seen"}),l=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.last_seen",{defaultMessage:"Last seen"}),d=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.confidence",{defaultMessage:"Confidence"}),b=i.i18n.translate("xpack.threatIntelligence.field.threat.indicator.marking.tlp",{defaultMessage:"TLP Marking"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1),a=n(8),s=n(40),r=n(41),c=n(34);const o=({indicator:e,field:t,filterType:n})=>{const{filterManager:o}=Object(s.b)(),{sourcererDataView:u}=Object(c.a)(),{key:l,value:d}="string"==typeof e?{key:t,value:e}:Object(a.b)(e,t),b=Object(i.useCallback)((()=>{const e=o.getFilters(),t=Object(r.c)(e,l,d,n,null==u?void 0:u.id);o.setFilters(t)}),[o,n,l,null==u?void 0:u.id,d]);return Object(a.a)(l,d)?{filterFn:b}:{}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n(7);const a=i.i18n.translate("xpack.threatIntelligence.indicatorNameFieldDescription",{defaultMessage:"Indicator display name generated in the runtime "}),s=i.i18n.translate("xpack.threatIntelligence.inspectTitle",{defaultMessage:"Inspect"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n(7);const a=i.i18n.translate("xpack.threatIntelligence.queryBar.filterIn",{defaultMessage:"Filter In"}),s=i.i18n.translate("xpack.threatIntelligence.queryBar.filterOut",{defaultMessage:"Filter Out"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var i=n(7);const a=i.i18n.translate("xpack.threatIntelligence.timeline.addToTimeline",{defaultMessage:"Add to Timeline"}),s=i.i18n.translate("xpack.threatIntelligence.timeline.investigateInTimelineButtonIcon",{defaultMessage:"Investigate in Timeline"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(1),a=n(53);const s=()=>Object(i.useContext)(a.a)||{}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var i=n(1),a=n(34),s=n(0);const r=Object(i.createContext)({}),c=({children:e})=>{const{indexPattern:t}=Object(a.a)(),n=Object(i.useMemo)((()=>t.fields.reduce(((e,t)=>(e[t.name]=t.type,e)),{})),[t.fields]);return Object(s.jsx)(r.Provider,{value:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(23),a=n.n(i),s=n(1),r=n.n(s),c=n(6),o=n(43),u=n(55),l=n(0);a.a.suppressDeprecationWarnings=!0;const d=({date:e,dateFormat:t})=>{const n=Object(u.b)(),i=Object(u.a)();if(null===e)return Object(l.jsx)(r.a.Fragment,null,c.c);const s="string"==typeof e?a()(e):e;return Object(l.jsx)(r.a.Fragment,null,Object(o.b)(s,n,t||i))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var i=n(9),a=n(28),s=n.n(a),r=n(6);const c=()=>Object(i.useUiSetting)(r.a),o=()=>{const e=Object(i.useUiSetting)(r.b);return"Browser"===e?s.a.tz.guess():e}},function(e,t,n){e.exports=n(25)(1614)},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n(1);var i=n(2),a=n(3),s=n(59),r=n(16),c=n(5),o=n(0);const u=({indicator:e,onClick:t,"data-test-subj":n})=>{const{cases:u}=Object(c.b)().services,l=u.hooks.useCasesAddToNewCaseFlyout(),d=e._id,b=Object(r.b)(e),j=Object(r.c)(d,b),f=Object(s.a)(b.indicatorName);return Object(o.jsx)(i.EuiContextMenuItem,{key:"attachmentsNewCase",onClick:()=>(t(),void l.open({attachments:j})),"data-test-subj":n,disabled:f},Object(o.jsx)(a.FormattedMessage,{defaultMessage:"Add to new case",id:"xpack.threatIntelligence.addToNewCase"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(6),a=n(5);const s=e=>{const{cases:t}=Object(a.b)().services,n=t.helpers.canUseCases(),s=e===i.c,r=n.create&&n.update;return s||!r}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n(1);var i=n(2),a=n(3),s=n(59),r=n(16),c=n(5),o=n(0);const u=({indicator:e,onClick:t,"data-test-subj":n})=>{const{cases:u}=Object(c.b)().services,l=u.hooks.useCasesAddToExistingCaseModal(),d=e._id,b=Object(r.b)(e),j=Object(r.c)(d,b),f=Object(s.a)(b.indicatorName);return Object(o.jsx)(i.EuiContextMenuItem,{key:"attachmentsExistingCase",onClick:()=>(t(),void l.open({getAttachments:()=>j})),"data-test-subj":n,disabled:f},Object(o.jsx)(a.FormattedMessage,{defaultMessage:"Add to existing case",id:"xpack.threatIntelligence.addToExistingCase"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(4),a=n(8);const s=e=>{const t=Object(a.b)(e,i.b.FileSha256).value;if(null!=t)return t;const n=Object(a.b)(e,i.b.FileSha1).value;if(null!=n)return n;const s=Object(a.b)(e,i.b.FileMd5).value;return null!=s?s:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var i=n(1),a=n.n(i),s=n(4),r=n(47),c=n(0);const o=({field:e})=>Object(c.jsx)(a.a.Fragment,null,u(e)),u=e=>{switch(e){case s.b.TimeStamp:return r.g;case s.b.Name:return r.e;case s.b.Type:return r.i;case s.b.Feed:return r.c;case s.b.FirstSeen:return r.d;case s.b.LastSeen:return r.f;case s.b.Confidence:return r.a;case s.b.MarkingTLP:return r.h;default:return e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var i=n(1),a=n.n(i),s=n(2),r=n(3);const c=Object(i.createContext)(void 0),o=()=>{const e=Object(i.useContext)(c);if(!e)throw new Error("IndicatorsFlyoutContext can only be used within IndicatorsFlyoutContext provider");return e};var u=n(61),l=n(64),d=n(58),b=n(60),j=n(65);const f="tiFlyoutOverviewHighLevelBlocks";var x=n(0);const O=({indicator:e})=>{const[t,n]=Object(i.useState)(!1),a=Object(s.useGeneratedHtmlId)({prefix:"smallContextMenuPopover"}),c=()=>{n(!1)},o=Object(u.a)(e),f=[Object(x.jsx)(j.b,{data:e,onClick:c,"data-test-subj":"tiIndicatorFlyoutInvestigateInTimelineContextMenu"}),Object(x.jsx)(b.a,{indicator:e,onClick:c,"data-test-subj":"tiIndicatorFlyoutAddToExistingCaseContextMenu"}),Object(x.jsx)(d.a,{indicator:e,onClick:c,"data-test-subj":"tiIndicatorFlyoutAddToNewCaseContextMenu"}),Object(x.jsx)(l.a,{data:o,onClick:c,"data-test-subj":"tiIndicatorFlyoutAddToBlockListContextMenu"})],O=Object(x.jsx)(s.EuiButton,{iconType:"arrowDown",iconSide:"right",onClick:()=>n(!t)},Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicators.flyout.take-action.button",defaultMessage:"Take action"}));return Object(x.jsx)(s.EuiPopover,{id:a,button:O,isOpen:t,closePopover:c,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"tiIndicatorFlyoutTakeActionButton"},Object(x.jsx)(s.EuiContextMenuPanel,{size:"s",items:f}))};var p=n(54),m=n(4);const g=()=>Object(x.jsx)(s.EuiEmptyPrompt,{iconType:"warning",color:"danger",title:Object(x.jsx)("h2",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageTitle",defaultMessage:"Unable to display indicator information"})),body:Object(x.jsx)("p",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageBody",defaultMessage:"There was an error displaying the indicator fields and values."})),"data-test-subj":"indicatorEmptyPrompt"}),v=({indicator:e})=>0===Object.keys(e).length?Object(x.jsx)(g,null):Object(x.jsx)(s.EuiCodeBlock,{language:"json",lineNumbers:!0,"data-test-subj":"tiFlyoutJsonCodeBlock"},JSON.stringify(e,null,2));var y=n(45),T=n(35),h=n(36),k=n(37),I=n(8),F=n(39);const C=n(7).i18n.translate("xpack.threatIntelligence.more-actions.popover",{defaultMessage:"More actions"}),E=({indicator:e,field:t,"data-test-subj":n})=>{const{kqlBarIntegration:a}=o(),[r,c]=Object(i.useState)(!1),{key:u,value:l}=Object(I.b)(e,t);if(!Object(I.a)(u,l))return null;const d=`${n}FilterInButton`,b=`${n}FilterOutButton`,j=`${n}TimelineButton`,f=`${n}CopyToClipboardButton`,O=`${n}PopoverButton`;if(a)return Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"center",alignItems:"center",gutterSize:"none"},Object(x.jsx)(k.b,{data:e,field:t,"data-test-subj":j}),Object(x.jsx)(F.b,{value:l,"data-test-subj":f}));const p=[Object(x.jsx)(k.d,{data:e,field:t,"data-test-subj":j}),Object(x.jsx)(F.c,{value:l,"data-test-subj":f})];return Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"center",alignItems:"center",gutterSize:"none"},Object(x.jsx)(T.b,{data:e,field:t,"data-test-subj":d}),Object(x.jsx)(h.b,{data:e,field:t,"data-test-subj":b}),Object(x.jsx)(s.EuiPopover,{"data-test-subj":O,button:Object(x.jsx)(s.EuiToolTip,{content:C},Object(x.jsx)(s.EuiButtonIcon,{"aria-label":C,iconType:"boxesHorizontal",iconSize:"s",size:"xs",onClick:()=>c((e=>!e)),style:{height:"100%"}})),isOpen:r,closePopover:()=>c(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(x.jsx)(s.EuiContextMenuPanel,{size:"s",items:p})))},M=({fields:e,indicator:t,"data-test-subj":n})=>{const a=Object(i.useMemo)((()=>[{name:Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.fieldsTable.fieldColumnLabel",defaultMessage:"Field"}),render:e=>e},{name:Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.fieldsTable.valueColumnLabel",defaultMessage:"Value"}),render:e=>Object(x.jsx)(y.a,{indicator:t,field:e})},{actions:[{render:e=>Object(x.jsx)(E,{field:e,indicator:t,"data-test-subj":n}),width:"72px"}]}]),[t,n]);return Object(x.jsx)(s.EuiInMemoryTable,{items:e.sort(),columns:a,sorting:!0,"data-test-subj":n})},w={box:{incremental:!0,schema:!0}},S=({indicator:e})=>{const t=Object.keys(e.fields);return 0===t.length?Object(x.jsx)(g,null):Object(x.jsx)(M,{"data-test-subj":"tiFlyoutTable",search:w,fields:t,indicator:e})};var B=n(11),P=n(6),z=n(29),A=n(62);const L=z.euiStyled.div`
  ${({theme:e})=>z.css`
    & {
      height: 100%;
    }

    & .actionsWrapper {
      visibility: hidden;
      display: inline-block;
      margin-inline-start: ${e.eui.euiSizeS};
    }

    &:hover .actionsWrapper {
      visibility: visible;
    }
  `}
`,q={color:"subdued",hasShadow:!1,borderRadius:"none",paddingSize:"s"},N=({field:e,indicator:t,"data-test-subj":n})=>Object(x.jsx)(s.EuiPanel,q,Object(x.jsx)(L,{"data-test-subj":`${n}Item`},Object(x.jsx)(s.EuiText,null,Object(x.jsx)(A.a,{field:e})),Object(x.jsx)(s.EuiSpacer,{size:"s"}),Object(x.jsx)(s.EuiText,{size:"s"},Object(x.jsx)(y.a,{indicator:t,field:e}),Object(x.jsx)("span",{className:"actionsWrapper"},Object(x.jsx)(E,{indicator:t,field:e,"data-test-subj":n}))))),R=({indicator:e,"data-test-subj":t})=>{const n=Object(B.a)(e,m.b.Type),a=Object(i.useMemo)((()=>Object.keys(e.fields).filter((e=>t=>t.startsWith(`threat.indicator.${e}`)||["threat.indicator.reference","threat.indicator.description","threat.software.alias","threat.indicator.confidence","threat.tactic.name","threat.tactic.reference"].includes(t))(n||""))),[e.fields,n]);return Object(x.jsx)(M,{search:!1,indicator:e,fields:a,"data-test-subj":t})},$=[m.b.Feed,m.b.Type,m.b.MarkingTLP,m.b.Confidence],H=({indicator:e,onViewAllFieldsInTable:t})=>{const{indicatorName:n}=o(),c=Object(B.a)(e,m.b.Type),u=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{"data-test-subj":f},$.map((t=>Object(x.jsx)(s.EuiFlexItem,{key:t},Object(x.jsx)(N,{indicator:e,field:t,"data-test-subj":f})))))),[e]),l=Object(i.useMemo)((()=>{const t=Object(B.a)(e,m.b.Description);return t?Object(x.jsx)(s.EuiText,null,t):null}),[e]),d=null!=n?n:Object(B.a)(e,m.b.Name)||P.c;return c?Object(x.jsx)(a.a.Fragment,null,Object(x.jsx)(s.EuiTitle,null,Object(x.jsx)("h2",{"data-test-subj":"tiFlyoutOverviewTitle"},d)),l,Object(x.jsx)(s.EuiSpacer,null),u,Object(x.jsx)(s.EuiHorizontalRule,null),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiTitle,{size:"xxs"},Object(x.jsx)("h5",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutOverviewTable.highlightedFields",defaultMessage:"Highlighted fields"})))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButtonEmpty,{onClick:t},Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutOverviewTable.viewAllFieldsInTable",defaultMessage:"View all fields in table"})))),Object(x.jsx)(R,{indicator:e,"data-test-subj":"tiFlyoutOverviewTableRow"})):Object(x.jsx)(g,null)};var D=function(e){return e[e.overview=0]="overview",e[e.table=1]="table",e[e.json=2]="json",e}(D||{});const V=({indicator:e,closeFlyout:t,kqlBarIntegration:n=!1,indicatorName:a})=>{const[o,u]=Object(i.useState)(D.overview),l=Object(i.useMemo)((()=>[{id:D.overview,name:Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.overviewTabLabel",defaultMessage:"Overview"}),content:Object(x.jsx)(H,{indicator:e,onViewAllFieldsInTable:()=>u(D.table)})},{id:D.table,name:Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.tableTabLabel",defaultMessage:"Table"}),content:Object(x.jsx)(S,{indicator:e})},{id:D.json,name:Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.jsonTabLabel",defaultMessage:"JSON"}),content:Object(x.jsx)(v,{indicator:e})}]),[e]),d=l.map(((e,t)=>Object(x.jsx)(s.EuiTab,{onClick:()=>{return t=e.id,u(t);var t},isSelected:e.id===o,key:t},e.name))),b=Object(i.useMemo)((()=>{var e;return null===(e=l.find((e=>e.id===o)))||void 0===e?void 0:e.content}),[o,l]),j=Object(B.a)(e,m.b.FirstSeen),f=Object(s.useGeneratedHtmlId)({prefix:"simpleFlyoutTitle"});return Object(x.jsx)(s.EuiFlyout,{onClose:t,"aria-labelledby":f},Object(x.jsx)(s.EuiFlyoutHeader,{hasBorder:!0},Object(x.jsx)(s.EuiTitle,null,Object(x.jsx)("h2",{"data-test-subj":"tiIndicatorFlyoutTitle",id:f},Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.panelTitleWithOverviewTab",defaultMessage:"Indicator details"}))),Object(x.jsx)(s.EuiSpacer,{size:"s"}),Object(x.jsx)(s.EuiText,{size:"xs"},Object(x.jsx)("p",{"data-test-subj":"tiIndicatorFlyoutSubtitle"},Object(x.jsx)(r.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.panelSubTitle",defaultMessage:"First seen: "}),Object(x.jsx)(p.a,{date:j}))),Object(x.jsx)(s.EuiSpacer,{size:"m"}),Object(x.jsx)(s.EuiTabs,{"data-test-subj":"tiIndicatorFlyoutTabs",style:{marginBottom:"-25px"}},d)),Object(x.jsx)(s.EuiFlyoutBody,null,Object(x.jsx)(c.Provider,{value:{kqlBarIntegration:n,indicatorName:a}},b)),Object(x.jsx)(s.EuiFlyoutFooter,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(O,{indicator:e})))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n(1);var i=n(2),a=n(3),s=n(14),r=n(38),c=n(0);const o=({data:e,"data-test-subj":t,onClick:n})=>{const{blockList:{canWriteBlocklist:o}}=Object(s.a)(),{setBlockListIndicatorValue:u}=Object(r.a)(),{setUrlParams:l}=(()=>{const{blockList:e}=Object(s.a)();return{setUrlParams:e.useSetUrlParams()}})(),d=!o||null===e;return Object(c.jsx)(i.EuiContextMenuItem,{key:"addToBlocklist",onClick:()=>(n(),u(e),void l({show:"create"})),"data-test-subj":t,disabled:d},Object(c.jsx)(a.FormattedMessage,{defaultMessage:"Add blocklist entry",id:"xpack.threatIntelligence.addToBlockList"}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return p}));var i=n(1),a=n(2),s=n(3),r=n(23),c=n.n(r),o=n(42),u=n(10),l=n(8),d=n(11),b=n(4);const j=({indicator:e})=>{const t=Object(i.useContext)(u.a),{key:n,value:a}=Object(l.b)(e,b.b.Name),s=b.a[n];if(!Object(l.a)(n,a)||!s)return{};const r=[...s,n].map((e=>Object(o.a)(e,a))),j=Object(d.a)(e,b.b.TimeStamp),f=c()(j).subtract(7,"d").toISOString(),x=c()(j).add(7,"d").toISOString();return x&&f?{investigateInTimelineFn:null==t?void 0:t.getUseInvestigateInTimeline({dataProviders:r,from:f,to:x})}:{}};var f=n(51),x=n(0);const O=({data:e,onClick:t,"data-test-subj":n})=>{const{investigateInTimelineFn:i}=j({indicator:e});return i?Object(x.jsx)(a.EuiContextMenuItem,{key:"investigateInTime",onClick:()=>(t&&t(),void i()),"data-test-subj":n},Object(x.jsx)(s.FormattedMessage,{defaultMessage:"Investigate in Timeline",id:"xpack.threatIntelligence.investigateInTimelineButton"})):null},p=({data:e,"data-test-subj":t})=>{const{investigateInTimelineFn:n}=j({indicator:e});return n?Object(x.jsx)(a.EuiToolTip,{content:f.a},Object(x.jsx)(a.EuiButtonIcon,{"aria-label":f.a,iconType:"timeline",iconSize:"s",size:"xs",color:"primary",onClick:n,"data-test-subj":t})):null}},function(e,t,n){var i=n(56),a=n(67);e.exports=function(e){return a(i(e).toLowerCase())}},function(e,t,n){var i=n(68)("toUpperCase");e.exports=i},function(e,t,n){var i=n(69),a=n(57),s=n(71),r=n(56);e.exports=function(e){return function(t){t=r(t);var n=a(t)?s(t):void 0,c=n?n[0]:t.charAt(0),o=n?i(n,1).join(""):t.slice(1);return c[e]()+o}}},function(e,t,n){var i=n(70);e.exports=function(e,t,n){var a=e.length;return n=void 0===n?a:n,!t&&n>=a?e:i(e,t,n)}},function(e,t,n){e.exports=n(25)(3528)},function(e,t,n){var i=n(72),a=n(57),s=n(73);e.exports=function(e){return a(e)?s(e):i(e)}},function(e,t){e.exports=function(e){return e.split("")}},function(e,t){var n="\\ud800-\\udfff",i="["+n+"]",a="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",r="[^"+n+"]",c="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+a+"|"+s+")?",l="[\\ufe0e\\ufe0f]?",d=l+u+"(?:\\u200d(?:"+[r,c,o].join("|")+")"+l+u+")*",b="(?:"+[r+a+"?",a,c,o,i].join("|")+")",j=RegExp(s+"(?="+s+")|"+b+d,"g");e.exports=function(e){return e.match(j)||[]}}])]);