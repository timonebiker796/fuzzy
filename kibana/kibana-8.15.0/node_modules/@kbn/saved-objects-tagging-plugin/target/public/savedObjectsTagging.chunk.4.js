/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.savedObjectsTagging_bundle_jsonpfunction=window.savedObjectsTagging_bundle_jsonpfunction||[]).push([[4],{123:function(e,t,a){"use strict";a.r(t),a.d(t,"CreateTagModal",(function(){return d}));var n=a(1),s=a(7),r=a(5),i=a(13),c=a(39),o=a(52),l=a(55),u=a(0);const d=({defaultValues:e,tagClient:t,notifications:a,onClose:d,onSave:b})=>{const[g,j]=Object(n.useState)((m=e,{name:"",description:"",color:Object(c.b)(),...m}));var m;const{validation:O,setValidation:f,onNameChange:x,validation$:p,isValidating:v}=Object(l.a)({tagAttributes:g,tagClient:t,validateDuplicateNameOnMount:!0}),M=Object(n.useCallback)((e=>t=>{j((a=>({...a,[e]:t})))}),[]),E=Object(n.useCallback)((async()=>{const{hasDuplicateNameError:e}=await Object(s.lastValueFrom)(p.pipe(Object(s.first)((e=>!1===e.isValidating))));if(e)return;const n=Object(c.e)(g);if(f(n),n.valid)try{const e=await t.create(g);b(e)}catch(e){Object(i.c)(e.body)?f(e.body.attributes):a.toasts.addDanger({title:r.i18n.translate("xpack.savedObjectsTagging.saveTagErrorTitle",{defaultMessage:"An error occurred creating tag"}),text:e.body.message})}}),[p,g,f,t,b,a.toasts]);return Object(u.jsx)(o.a,{onClose:d,onSubmit:E,onNameChange:x,mode:"create",tag:g,setField:M,validation:O,isValidating:v})}},39:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return u}));var n=a(1),s=a(5),r=a(16);const i=()=>"#"+String(Math.floor(16777215*Math.random()).toString(16)).padStart(6,"0"),c=s.i18n.translate("xpack.savedObjectsTagging.validation.name.duplicateError",{defaultMessage:"Name has already been taken."}),o=s.i18n.translate("xpack.savedObjectsTagging.validation.name.managedTagDuplicateError",{defaultMessage:"This name belongs to a tag managed by Elastic."}),l=e=>{const t={valid:!0,warnings:[],errors:{}};return t.errors.name=Object(r.g)(e.name),t.errors.color=Object(r.e)(e.color),t.errors.description=Object(r.f)(e.description),Object.values(t.errors).forEach((e=>{e&&(t.valid=!1)})),t},u=()=>{const e=Object(n.useRef)(!0);return Object(n.useEffect)((()=>()=>{e.current=!1}),[]),Object(n.useCallback)((t=>{e.current&&t&&t()}),[])}},52:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(1),s=a(2),r=a(5),i=a(11),c=a(53),o=a.n(c),l=a(16),u=a(21),d=a(39),b=a(0);const g=({onClose:e,onSubmit:t,onNameChange:a,validation:c,isValidating:g,setField:j,tag:m,mode:O})=>{const f=Object(s.htmlIdGenerator)()(),x=Object(d.d)(),[p,v]=Object(n.useState)(!1),M=Object(n.useRef)(m.name),E=Object(n.useMemo)((()=>m),[]),C=Object(n.useMemo)((()=>m.name!==E.name||m.color!==E.color||m.description!==E.description),[E,m]),T=m.name!==M.current,F=Object(n.useMemo)((()=>j("name")),[j]),h=Object(n.useMemo)((()=>j("color")),[j]),w=Object(n.useMemo)((()=>j("description")),[j]),k=Object(n.useMemo)((()=>"edit"===O),[O]),y=Object(n.useMemo)((()=>({...m,name:m.name||"tag",color:Object(l.e)(m.color)?"#000000":m.color})),[m]),B=Object(n.useCallback)((async()=>{v(!0),await t(),x((()=>{v(!1)}))}),[x,t]);return o()((()=>{a(m.name,{debounced:!0,hasBeenModified:T}),M.current=m.name}),300,[m.name,T]),Object(b.jsx)(s.EuiModal,{onClose:e,initialFocus:"[name=name]",style:{minWidth:"600px"}},Object(b.jsx)(s.EuiModalHeader,null,Object(b.jsx)(s.EuiModalHeaderTitle,null,k?Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.editModal.title",defaultMessage:"Edit ''{name}'' tag",values:{name:E.name}}):Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.createModal.title",defaultMessage:"Create tag"}))),Object(b.jsx)(s.EuiModalBody,null,Object(b.jsx)(s.EuiForm,{"data-test-subj":"tagModalForm",component:"form"},Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(b.jsx)(s.EuiFlexItem,{grow:3},Object(b.jsx)(s.EuiFormRow,{"data-test-subj":"createModalRow-name",fullWidth:!0,label:r.i18n.translate("xpack.savedObjectsTagging.tagAttributeLabels.name",{defaultMessage:"Name"}),isInvalid:!!c.errors.name,error:c.errors.name},Object(b.jsx)(s.EuiFieldText,{name:"tag-name",fullWidth:!0,maxLength:l.c,value:m.name,onChange:e=>F(e.target.value),isLoading:g,"data-test-subj":"createModalField-name"}))),Object(b.jsx)(s.EuiFlexItem,{grow:2},Object(b.jsx)(s.EuiFormRow,{"data-test-subj":"createModalRow-color",fullWidth:!0,label:r.i18n.translate("xpack.savedObjectsTagging.tagAttributeLabels.color",{defaultMessage:"Color"}),isInvalid:!!c.errors.color,error:c.errors.color,labelAppend:Object(b.jsx)(s.EuiButtonEmpty,{onClick:()=>h(Object(d.b)()),size:"xs",style:{height:"18px",fontSize:"0.75rem"},"aria-label":r.i18n.translate("xpack.savedObjectsTagging.management.createModal.color.randomizeAriaLabel",{defaultMessage:"Randomize tag color"})},Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.createModal.color.randomize",defaultMessage:"Randomize"}))},Object(b.jsx)(s.EuiColorPicker,{color:m.color,fullWidth:!0,onChange:e=>h(e),format:"hex","data-test-subj":"createModalField-color"})))),Object(b.jsx)(s.EuiSpacer,{size:"s"}),Object(b.jsx)(s.EuiFormRow,{"data-test-subj":"createModalRow-description",fullWidth:!0,label:r.i18n.translate("xpack.savedObjectsTagging.tagAttributeLabels.description",{defaultMessage:"Description"}),labelAppend:Object(b.jsx)(s.EuiText,{size:"xs",color:"subdued",id:f},Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.optionalFieldText",defaultMessage:"Optional"})),isInvalid:!!c.errors.description,error:c.errors.description},Object(b.jsx)(s.EuiTextArea,{name:"description",value:m.description,maxLength:l.b,onChange:e=>w(e.target.value),"data-test-subj":"createModalField-description",resize:"none",fullWidth:!0,compressed:!0,"aria-describedby":f})))),Object(b.jsx)(s.EuiModalFooter,null,Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"baseline"},Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiText,{size:"xs",color:"subdued"},Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.tagPreviewText",defaultMessage:"Preview"}))),Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(u.a,{tag:y})))),Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiButtonEmpty,{onClick:e,"data-test-subj":"createModalCancelButton"},Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.createModal.closeButtonText",defaultMessage:"Cancel"}))),Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiButton,{iconType:k?"save":"tag",color:"primary",fill:!0,"data-test-subj":"createModalConfirmButton",onClick:B,isLoading:p,isDisabled:p||k&&!C},k?Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.createModal.updateTagButtonLabel",defaultMessage:"Save changes"}):Object(b.jsx)(i.FormattedMessage,{id:"xpack.savedObjectsTagging.management.createModal.createTagButtonLabel",defaultMessage:"Create tag"}))))))))}},53:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(29),s=a(1),r=n.__importDefault(a(54));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var n=r.default(e,t),i=n[0],c=n[1],o=n[2];return s.useEffect(o,a),[i,c]}},54:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef(!1),s=n.useRef(),r=n.useRef(e),i=n.useCallback((function(){return a.current}),[]),c=n.useCallback((function(){a.current=!1,s.current&&clearTimeout(s.current),s.current=setTimeout((function(){a.current=!0,r.current()}),t)}),[t]),o=n.useCallback((function(){a.current=null,s.current&&clearTimeout(s.current)}),[]);return n.useEffect((function(){r.current=e}),[e]),n.useEffect((function(){return c(),o}),[t]),[i,o,c]}},55:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(1),s=a(7),r=a(10),i=a.n(r),c=a(16),o=a(39);const l={valid:!0,warnings:[],errors:{}},u=({tagAttributes:e,tagClient:t,validateDuplicateNameOnMount:a=!1})=>{var r;const u=Object(n.useRef)(!1),[d,b]=Object(n.useState)(l),{errors:{name:g}}=d,j=Object(n.useMemo)((()=>new s.BehaviorSubject({isValidating:!1,hasDuplicateNameError:!1})),[]),{isValidating:m=!1}=null!==(r=i()(j))&&void 0!==r?r:{},O=Object(n.useCallback)((e=>{j.next({...j.value,isValidating:e})}),[j]),f=Object(n.useCallback)((async e=>{if(Object(c.g)(e))return;const a=await t.findByName(e,{exact:!0});a&&b((e=>({...e,valid:!1,errors:{...e.errors,name:a.managed?o.c:o.a}}))),O(!1)}),[t,O]),x=Object(n.useCallback)((async(e,{debounced:t=!1,hasBeenModified:a=!0}={})=>{O(!0),t&&(a&&await f(e),O(!1))}),[O,f]);return Object(n.useEffect)((()=>{u.current&&x(e.name)}),[x,e.name]),Object(n.useEffect)((()=>{u.current&&b(Object(o.e)(e))}),[e]),Object(n.useEffect)((()=>{a&&e.name&&!u.current&&(O(!0),f(e.name)),u.current=!0}),[a,e.name,f,j,O]),Object(n.useEffect)((()=>{j.next({...j.value,hasDuplicateNameError:[o.a,o.c].includes(g)})}),[g,j]),{validation:d,setValidation:b,isValidating:m,validation$:j,onNameChange:x}}}}]);