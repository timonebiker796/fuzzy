/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.indexLifecycleManagement_bundle_jsonpfunction=window.indexLifecycleManagement_bundle_jsonpfunction||[]).push([[1],Array(40).concat([function(e,t,a){"use strict";var i,l=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function n(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function o(e,t){for(var a={},i=[],l=0;l<e.length;l++){var o=e[l],r=t.base?o[0]+t.base:o[0],c=a[r]||0,d="".concat(r," ").concat(c);a[r]=c+1;var u=n(d),m={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(s[u].references++,s[u].updater(m)):s.push({identifier:d,updater:x(m,t),references:1}),i.push(d)}return i}function r(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=a.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var n=l(e.insert||"head");if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function u(e,t,a,i){var l=a?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=d(t,l);else{var s=document.createTextNode(l),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(s,n[t]):e.appendChild(s)}}function m(e,t,a){var i=a.css,l=a.media,s=a.sourceMap;if(l?e.setAttribute("media",l):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,h=0;function x(e,t){var a,i,l;if(t.singleton){var s=h++;a=p||(p=r(t)),i=u.bind(null,a,s,!1),l=u.bind(null,a,s,!0)}else a=r(t),i=m.bind(null,a,t),l=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else l()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var a=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<a.length;i++){var l=n(a[i]);s[l].references--}for(var r=o(e,t),c=0;c<a.length;c++){var d=n(a[c]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}a=r}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,i,l,s=e[1]||"",n=e[3];if(!n)return s;if(t&&"function"==typeof btoa){var o=(a=n,i=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(l," */")),r=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[s].concat(r).concat([o]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,i){"string"==typeof e&&(e=[[null,e,""]]);var l={};if(i)for(var s=0;s<this.length;s++){var n=this[s][0];null!=n&&(l[n]=!0)}for(var o=0;o<e.length;o++){var r=[].concat(e[o]);i&&l[r[0]]||(a&&(r[2]?r[2]="".concat(a," and ").concat(r[2]):r[2]=a),t.push(r))}},t}},function(e,t,a){e.exports=a(21)(4)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(29),l=a(7),s=i.__importDefault(a(44));t.default=function(e,t){var a=l.useState(t),i=a[0],n=a[1];return s.default((function(){var t=e.subscribe(n);return function(){return t.unsubscribe()}}),[e]),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(7),l="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var i=void 0;t.setEuiDevProviderWarning=function(e){return i=e},t.getEuiDevProviderWarning=function(){return i},t.emitEuiProviderWarning=function(e){if("function"==typeof i)return i(e);switch(i){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(47);case"v8light":return a(49)}},function(e,t,a){var i=a(40),l=a(48);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhases [class*=euiTimelineItemIcon-top]{padding-top:16px}.ilmPhases [class*=euiTimelineItemIcon-top]:before{margin-top:32px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(50);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhases [class*=euiTimelineItemIcon-top]{padding-top:16px}.ilmPhases [class*=euiTimelineItemIcon-top]:before{margin-top:32px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(52);case"v8light":return a(54)}},function(e,t,a){var i=a(40),l=a(53);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmTimeline{overflow:hidden;width:100%}.ilmTimeline__phasesContainer{display:inline-block;margin-top:8px;width:100%}.ilmTimeline__phasesContainer__phase:first-child{padding-left:0;padding-right:8px}.ilmTimeline__phasesContainer__phase:last-child{padding-left:8px;padding-right:0}.ilmTimeline__phasesContainer__phase:only-child{padding-left:0;padding-right:0}.ilmTimeline__phasesContainer__phase{display:inline-block;padding-left:8px;padding-right:8px}.ilmTimeline__deleteIconContainer{background-color:#25262e;border-radius:50%;color:#98a2b3;margin-left:12px;padding:12px}.ilmTimeline__colorBar{border-radius:4px;display:inline-block;height:8px;margin-bottom:4px;margin-top:8px;width:100%}.ilmTimeline__hotPhase{width:var(--ilm-timeline-hot-phase-width)}.ilmTimeline__hotPhase__colorBar{background-color:#e7664c}.ilmTimeline__warmPhase{width:var(--ilm-timeline-warm-phase-width)}.ilmTimeline__warmPhase__colorBar{background-color:#d6bf57}.ilmTimeline__coldPhase{width:var(--ilm-timeline-cold-phase-width)}.ilmTimeline__coldPhase__colorBar{background-color:#6092c0}.ilmTimeline__frozenPhase{width:var(--ilm-timeline-frozen-phase-width)}.ilmTimeline__frozenPhase__colorBar{background-color:#ca8eae}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(55);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmTimeline{overflow:hidden;width:100%}.ilmTimeline__phasesContainer{display:inline-block;margin-top:8px;width:100%}.ilmTimeline__phasesContainer__phase:first-child{padding-left:0;padding-right:8px}.ilmTimeline__phasesContainer__phase:last-child{padding-left:8px;padding-right:0}.ilmTimeline__phasesContainer__phase:only-child{padding-left:0;padding-right:0}.ilmTimeline__phasesContainer__phase{display:inline-block;padding-left:8px;padding-right:8px}.ilmTimeline__deleteIconContainer{background-color:#f5f7fa;border-radius:50%;color:#69707d;margin-left:12px;padding:12px}.ilmTimeline__colorBar{border-radius:4px;display:inline-block;height:8px;margin-bottom:4px;margin-top:8px;width:100%}.ilmTimeline__hotPhase{width:var(--ilm-timeline-hot-phase-width)}.ilmTimeline__hotPhase__colorBar{background-color:#e7664c}.ilmTimeline__warmPhase{width:var(--ilm-timeline-warm-phase-width)}.ilmTimeline__warmPhase__colorBar{background-color:#d6bf57}.ilmTimeline__coldPhase{width:var(--ilm-timeline-cold-phase-width)}.ilmTimeline__coldPhase__colorBar{background-color:#6092c0}.ilmTimeline__frozenPhase{width:var(--ilm-timeline-frozen-phase-width)}.ilmTimeline__frozenPhase__colorBar{background-color:#ca8eae}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(57);case"v8light":return a(59)}},function(e,t,a){var i=a(40),l=a(58);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".indexLifecycleManagement__phase__dataTierAllocation__controlSection{background-color:#25262e;padding:12px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(60);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".indexLifecycleManagement__phase__dataTierAllocation__controlSection{background-color:#f5f7fa;padding:12px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(62);case"v8light":return a(64)}},function(e,t,a){var i=a(40),l=a(63);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmDataTierAllocationField{max-width:400px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(65);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmDataTierAllocationField{max-width:400px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(67);case"v8light":return a(69)}},function(e,t,a){var i=a(40),l=a(68);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmSearchableSnapshotField{max-width:400px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(70);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmSearchableSnapshotField{max-width:400px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(72);case"v8light":return a(74)}},function(e,t,a){var i=a(40),l=a(73);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhaseIcon{align-items:center;background-color:#25262e;border-radius:50%;display:flex;height:32px;justify-content:center;width:32px}.ilmPhaseIcon--disabled{height:16px;margin:8px;width:16px}.ilmPhaseIcon--delete{background-color:#343741}.ilmPhaseIcon__inner--hot{fill:#ff7e62}.ilmPhaseIcon__inner--warm{fill:#f1d86f}.ilmPhaseIcon__inner--cold{fill:#79aad9}.ilmPhaseIcon__inner--frozen{fill:#e4a6c7}.ilmPhaseIcon__inner--delete{fill:#98a2b3}.ilmPhaseIcon__inner--disabled{fill:#535966}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(75);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhaseIcon{align-items:center;background-color:#f5f7fa;border-radius:50%;display:flex;height:32px;justify-content:center;width:32px}.ilmPhaseIcon--disabled{height:16px;margin:8px;width:16px}.ilmPhaseIcon--delete{background-color:#d3dae6}.ilmPhaseIcon__inner--hot{fill:#ff7e62}.ilmPhaseIcon__inner--warm{fill:#f1d86f}.ilmPhaseIcon__inner--cold{fill:#79aad9}.ilmPhaseIcon__inner--frozen{fill:#e4a6c7}.ilmPhaseIcon__inner--delete{fill:#69707d}.ilmPhaseIcon__inner--disabled{fill:#98a2b3}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(77);case"v8light":return a(79)}},function(e,t,a){var i=a(40),l=a(78);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmSettingsAccordion .ilmSettingsButton{color:#36a2ef;padding-bottom:8px;padding-top:8px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(80);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmSettingsAccordion .ilmSettingsButton{color:#07c;padding-bottom:8px;padding-top:8px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(82);case"v8light":return a(84)}},function(e,t,a){var i=a(40),l=a(83);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhaseRequiredBadge{max-width:150px}.ilmPhaseTitle{min-width:100px}",""]),e.exports=t},function(e,t,a){var i=a(40),l=a(85);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(41)(!1)).push([e.i,".ilmPhaseRequiredBadge{max-width:150px}.ilmPhaseTitle{min-width:100px}",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(29),l=a(87),s=i.__importDefault(a(89));t.default=function(e,t){s.default(e,t,l.isDeepEqual)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var i=a(29).__importDefault(a(88));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=i.default},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var i,l,s;if(Array.isArray(t)){if((i=t.length)!=a.length)return!1;for(l=i;0!=l--;)if(!e(t[l],a[l]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(l=i;0!=l--;)if(!Object.prototype.hasOwnProperty.call(a,s[l]))return!1;for(l=i;0!=l--;){var n=s[l];if(!("_owner"===n&&t.$$typeof||e(t[n],a[n])))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(7);t.default=function(e,t,a){var l=i.useRef(void 0);l.current&&a(t,l.current)||(l.current=t),i.useEffect(e,l.current)}},,,,function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return Mi}));var i=a(7),l=a.n(i),s=a(35),n=a(27),o=a(25),r=a(31),c=a(26),d=a(17),u=a(42),m=a.n(u),p=a(36),h=a(45),x=a(43),g=a.n(x),b=a(37),f=a.n(b),j=a(1);const y="eui-global",v="eui-utilities",O={darkMode:!1};var M=a(0);const P=[j.euiStylisPrefixer],_=f()({key:"css",stylisPlugins:P,container:document.querySelector('meta[name="emotion"]')}),T=f()({key:y,stylisPlugins:P,container:document.querySelector(`meta[name="${y}"]`)}),k=f()({key:v,stylisPlugins:P,container:document.querySelector(`meta[name="${v}"]`)});_.compat=!0,T.compat=!0,k.compat=!0;const w={default:_,global:T,utility:k},L=({theme:{theme$:e},globalStyles:t,colorMode:a,modify:l,children:s})=>{const n=g()(e,O),o=Object(i.useMemo)((()=>(e=>e.darkMode?j.COLOR_MODES_STANDARD.dark:j.COLOR_MODES_STANDARD.light)(n)),[n]),r=a||o,c=!1!==t&&void 0;return Object(M.jsx)(j.EuiProvider,{cache:w,modify:l,colorMode:r,globalStyles:c,utilityClasses:c},s)},S=({children:e,i18n:t,...a})=>Object(p.useIsNestedEuiProvider)()?(Object(h.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(M.jsx)(t.Context,null,e)):Object(M.jsx)(L,a,Object(M.jsx)(t.Context,null,e));var E=a(38);const F=({children:e,...t})=>Object(M.jsx)(S,m()({globalStyles:!1},t),Object(M.jsx)(E.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(M.jsx)(E.KibanaErrorBoundary,null,e))),C=l.a.createContext(null),z=({children:e,...t})=>{const{navigateToUrl:a,currentAppId:i}=t;return Object(M.jsx)(C.Provider,{value:{navigateToUrl:a,currentAppId:i}},e)},A=({children:e,coreStart:t})=>{const{navigateToUrl:a,currentAppId$:i}=t.application,l=g()(i,void 0);return Object(M.jsx)(C.Provider,{value:{navigateToUrl:a,currentAppId:l}},e)},D={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},I=({children:e,navigateToUrl:t,currentAppId:a,...l})=>{const s=Object(i.useRef)(null),n=Object(i.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:i})=>{if(!t||!i)return;const l=((e,t)=>{let a=e;do{var i,l;if("a"===(null===(i=a)||void 0===i?void 0:i.tagName.toLowerCase()))return a;const e=null===(l=a)||void 0===l?void 0:l.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!l)return;const s=l.href,n=""===l.target||"_self"===l.target,o=0===e.button;s&&n&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(l.href))})({event:e,currentAppId:a,navigateToUrl:t,container:s.current})),[a,t]);return Object(M.jsx)("div",m()({onClick:n,ref:s,css:D,"data-test-subj":"kbnRedirectAppLink"},l),e)},N=({children:e,...t})=>Object(M.jsx)(I,m()({},function(){const e=Object(i.useContext)(C);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e),R=({children:e,...t})=>{if(void 0!==t.coreStart){const{coreStart:a,...i}=t,l=Object(M.jsx)(N,i,e);return Object(M.jsx)(A,{coreStart:a},l)}const{navigateToUrl:a,currentAppId:i,...l}=t,s=Object(M.jsx)(N,l,e);return Object(M.jsx)(z,{currentAppId:i,navigateToUrl:a},s)};var U=a(32);const B=()=>Object(n.useKibana)();var $=a(28),q=a(34);const V=({children:e,...t})=>Object(M.jsx)($.Router,t,Object(M.jsx)(q.CompatRouter,null,e));var W=a(10);const H={services:{}},G=Object(i.createContext)(H);var K=a(86),J=a.n(K);const Y=({children:e,component:t,render:a,...s})=>{const n=Object(i.useMemo)((()=>{if(t)return e=>Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(Q,null),Object(M.jsx)(t,e))}),[t]);if(n)return Object(M.jsx)($.Route,m()({},s,{component:n}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(M.jsx)($.Route,m()({},s,{render:e=>Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(Q,null),t(e))}))}return Object(M.jsx)($.Route,s,Object(M.jsx)(Q,null),e)},Q=()=>{const{executionContext:e}=Object(i.useContext)(G).services,t=Object($.useRouteMatch)();return function(e,t){J()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null},Z=({legacySwitch:e=!0,children:t})=>{const a=Object($.useRouteMatch)();return e?Object(M.jsx)($.Switch,null,t):Object(M.jsx)(q.Routes,null,i.Children.map(t,(e=>{if(l.a.isValidElement(e)&&e.type===Y){var i;const s=Object(W.replace)(null==e?void 0:e.props.path,a.url+"/",""),n="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(M.jsx)(q.Route,{path:s,element:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(Q,null),(null==e||null===(i=e.props)||void 0===i?void 0:i.component)&&Object(M.jsx)(e.props.component,null)||n&&n()||t)})}return e})))};var X=a(14),ee=a(5),te=a(3),ae=a(12),ie=a(11);const le=e=>{let t="",a="";const i=/(\d+)(\w+)/.exec(e);return i&&(t=i[1],a=i[2]),{size:t,units:a}};var se=a(2);const ne=se.i18n.translate("unsavedChangesPrompt.defaultModalText",{defaultMessage:"The data will be lost if you leave this page without saving the changes."}),oe=se.i18n.translate("unsavedChangesPrompt.defaultModalTitle",{defaultMessage:"Discard unsaved changes?"}),re=se.i18n.translate("unsavedChangesPrompt.defaultModalCancel",{defaultMessage:"Keep editing"}),ce=se.i18n.translate("unsavedChangesPrompt.defaultModalConfirm",{defaultMessage:"Leave page"});a(46);var de=a(8),ue=a(33);const me=(e={})=>{const{allocate:t,migrate:a}=e;return!1===(null==a?void 0:a.enabled)?"none":t&&(t.require&&Object.keys(t.require).length||t.include&&Object.keys(t.include).length||t.exclude&&Object.keys(t.exclude).length)?"node_attrs":"node_roles"},pe=e=>{var t,a,i;const l=null==e||null===(t=e.phases)||void 0===t||null===(a=t.hot)||void 0===a||null===(i=a.actions)||void 0===i?void 0:i.rollover;return Boolean(l&&l.max_age===ee.p.max_age&&l.max_docs===ee.p.max_docs&&l.max_primary_shard_size===ee.p.max_primary_shard_size&&l.max_primary_shard_docs===ee.p.max_primary_shard_docs)};var he=a(30),xe=a.n(he);const ge=["hot","warm","cold","frozen","delete"],be=(e,t)=>{var a,i;return{min_age:null!==(a=t.phases)&&void 0!==a&&null!==(i=a[e])&&void 0!==i&&i.min_age?t.phases[e].min_age+t._meta[e].minAgeUnit:"0ms"}},fe=(e,t)=>{let a;return a="micros"===t?parseInt(e,10)/1e3:"nanos"===t?parseInt(e,10)/1e6:xe.a.duration(e,t).asMilliseconds(),a},je=e=>{var t;return 0===e.length?"":Boolean(null===(t=e[0])||void 0===t?void 0:t.snapshot_repository)?e[0].snapshot_repository:je(e.slice(1))},ye="_meta.hot.customRollover.enabled",ve="_meta.hot.isUsingDefaultRollover",Oe=e=>`_meta.${e}.downsample.enabled`,Me={maxDocs:"phases.hot.actions.rollover.max_docs",maxAge:"phases.hot.actions.rollover.max_age",maxSize:"phases.hot.actions.rollover.max_size",maxPrimaryShardSize:"phases.hot.actions.rollover.max_primary_shard_size",maxPrimaryShardDocs:"phases.hot.actions.rollover.max_primary_shard_docs"},Pe="found-snapshots",_e=[{value:"gb",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.gigabytesLabel",{defaultMessage:"gigabytes"})},{value:"mb",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.megabytesLabel",{defaultMessage:"megabytes"})},{value:"b",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.bytesLabel",{defaultMessage:"bytes"})},{value:"kb",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.kilobytesLabel",{defaultMessage:"kilobytes"})},{value:"tb",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.terabytesLabel",{defaultMessage:"terabytes"})},{value:"pb",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.petabytesLabel",{defaultMessage:"petabytes"})}],Te=[{value:"d",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.daysLabel",{defaultMessage:"days"})},{value:"h",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.hoursLabel",{defaultMessage:"hours"})},{value:"m",text:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.minutesLabel",{defaultMessage:"minutes"})}],ke=({dataTierAllocationType:e,allocationNodeAttribute:t},a={},i={},l)=>{var s,n;const{allocate:o,migrate:r,...c}=a,d={...c};if(o){const{include:e,exclude:t,require:a,number_of_replicas:i,...l}=o;Object(W.isEmpty)(l)||(d.allocate={...l})}switch(e){case"node_attrs":if(t){const[e,a]=t.split(":");d.allocate={...d.allocate,require:{[e]:a}}}else d.migrate=i.migrate;var u,m;Object(W.isEmpty)(null==i||null===(s=i.allocate)||void 0===s?void 0:s.include)||(d.allocate={...d.allocate,include:{...null==i||null===(u=i.allocate)||void 0===u?void 0:u.include}}),Object(W.isEmpty)(null==i||null===(n=i.allocate)||void 0===n?void 0:n.exclude)||(d.allocate={...d.allocate,exclude:{...null==i||null===(m=i.allocate)||void 0===m?void 0:m.exclude}});break;case"none":d.migrate={...null==i?void 0:i.migrate,enabled:!1}}return null!=l&&(d.allocate={...d.allocate,number_of_replicas:l}),d},we={editPolicy:{shrinkLabel:se.i18n.translate("xpack.indexLifecycleMgmt.shrink.enableShrinkLabel",{defaultMessage:"Shrink index"}),shrinkCountLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.shrink.configureShardCountLabel",{defaultMessage:"Configure shard count"}),shrinkSizeLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.shrink.configureShardSizeLabel",{defaultMessage:"Configure shard size"}),rolloverOffsetsHotPhaseTiming:se.i18n.translate("xpack.indexLifecycleMgmt.rollover.rolloverOffsetsPhaseTimingDescription",{defaultMessage:"How long it takes to reach the rollover criteria in the hot phase can vary."}),searchableSnapshotInHotPhase:{searchableSnapshotDisallowed:{calloutTitle:se.i18n.translate("xpack.indexLifecycleMgmt.searchableSnapshot.disallowedCalloutTitle",{defaultMessage:"Searchable snapshot disabled"}),calloutBody:se.i18n.translate("xpack.indexLifecycleMgmt.searchableSnapshot.disallowedCalloutBody",{defaultMessage:"To use searchable snapshot in this phase you must disable searchable snapshot in the hot phase."})}},forceMergeEnabledFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.forcemerge.enableLabel",{defaultMessage:"Force merge data"}),readonlyEnabledFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.readonlyFieldLabel",{defaultMessage:"Make index read only"}),downsampleEnabledFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.downsampleFieldLabel",{defaultMessage:"Enable downsampling"}),downsampleIntervalFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.downsampleIntervalFieldLabel",{defaultMessage:"Downsampling interval"}),downsampleIntervalFieldUnitsLabel:se.i18n.translate("xpack.indexLifecycleMgmt.downsampleIntervalFieldUnitsLabel",{defaultMessage:"Downsampling interval units"}),maxNumSegmentsFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.forceMerge.numberOfSegmentsLabel",{defaultMessage:"Number of segments"}),indexPriorityFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.indexPriorityLabel",{defaultMessage:"Index priority"}),bestCompressionFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.forcemerge.bestCompressionLabel",{defaultMessage:"Compress stored fields"}),bestCompressionFieldHelpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.forceMerge.bestCompressionText",{defaultMessage:"Use higher compression for stored fields at the cost of slower performance."}),allocationTypeOptionsFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierAllocation.allocationFieldLabel",{defaultMessage:"Data tier options"}),allocationNodeAttributeFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierAllocation.nodeAllocationFieldLabel",{defaultMessage:"Select a node attribute"}),searchableSnapshotsRepoFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotRepoFieldLabel",{defaultMessage:"Snapshot repository"}),searchableSnapshotsStorageFieldLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotStorageFieldLabel",{defaultMessage:"Searchable snapshot storage"}),maxPrimaryShardSizeLabel:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumPrimaryShardSizeLabel",{defaultMessage:"Maximum primary shard size"}),maxPrimaryShardDocsLabel:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumPrimaryShardDocsLabel",{defaultMessage:"Maximum docs in the primary shard"}),maxPrimaryShardSizeUnitsLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.maximumPrimaryShardSizeAriaLabel",{defaultMessage:"Maximum shard size units"}),errors:{numberRequired:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.numberRequiredErrorMessage",{defaultMessage:"A number is required."}),numberGreatThan0Required:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.numberAboveZeroRequiredError",{defaultMessage:"Only numbers above 0 are allowed."}),integerRequired:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.integerRequiredError",{defaultMessage:"Only integers are allowed."}),maximumAgeRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumAgeMissingError",{defaultMessage:"A maximum age is required."}),maximumSizeRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumIndexSizeMissingError",{defaultMessage:"A maximum index size is required."}),maximumDocumentsRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumDocumentsMissingError",{defaultMessage:"Maximum documents is required."}),maximumPrimaryShardSizeRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumPrimaryShardSizeMissingError",{defaultMessage:"A maximum primary shard size is required"}),maximumPrimaryShardDocsRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumPrimaryShardDocsMissingError",{defaultMessage:"Maximum documents in the primary shard is required"}),rollOverConfigurationCallout:{title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.rolloverConfigurationError.title",{defaultMessage:"Invalid rollover configuration"}),body:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.rolloverConfigurationError.body",{defaultMessage:"A value for one of maximum primary shard size, maximum documents, maximum age or maximum index size is required."})},nonNegativeNumberRequired:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.nonNegativeNumberRequiredError",{defaultMessage:"Only non-negative numbers are allowed."}),policyNameContainsInvalidChars:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.policyNameContainsInvalidCharsError",{defaultMessage:"A policy name cannot contain spaces or commas."}),policyNameAlreadyUsedErrorMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameAlreadyUsedError",{defaultMessage:"That policy name is already used."}),policyNameMustBeDifferentErrorMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.differentPolicyNameRequiredError",{defaultMessage:"The policy name must be different."}),policyNameRequiredMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameRequiredError",{defaultMessage:"A policy name is required."}),policyNameStartsWithUnderscoreErrorMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameStartsWithUnderscoreError",{defaultMessage:"A policy name cannot start with an underscore."}),policyNameTooLongErrorMessage:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameTooLongError",{defaultMessage:"A policy name cannot be longer than 255 bytes."}),searchableSnapshotRepoRequired:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotRepoRequiredError",{defaultMessage:"A snapshot repository name is required."})},titles:{hot:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.hotPhase.hotPhaseTitle",{defaultMessage:"Hot phase"}),warm:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.warmPhaseTitle",{defaultMessage:"Warm phase"}),cold:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.coldPhaseTitle",{defaultMessage:"Cold phase"}),frozen:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.frozenPhaseTitle",{defaultMessage:"Frozen phase"}),delete:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.deletePhaseTitle",{defaultMessage:"Delete phase"})},descriptions:{hot:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.hotPhase.hotPhaseDescription",{defaultMessage:"Store your most recent, most frequently-searched data in the hot tier. The hot tier provides the best indexing and search performance by using the most powerful, expensive hardware."}),warm:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.warmPhaseDescription",{defaultMessage:"Move data to the warm tier when you are still likely to search it, but infrequently need to update it. The warm tier is optimized for search performance over indexing performance."}),cold:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.coldPhaseDescription",{defaultMessage:"Move data to the cold tier when you are searching it less often and don’t need to update it. The cold tier is optimized for cost savings over search performance."}),frozen:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.frozenPhaseDescription",{defaultMessage:"Move data to the frozen tier for long term retention. The frozen tier provides the most cost-effective way store your data and still be able to search it."}),delete:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.deletePhaseDescription",{defaultMessage:"Delete data you no longer need."})}}},{numberGreaterThanField:Le,containsCharsField:Se,emptyField:Ee,startsWithField:Fe}=r.fieldValidators,Ce=({than:e,message:t})=>a=>{if(a.value)return Le({than:e,message:t})({...a,value:parseInt(a.value,10)})},ze=Ce({than:0,message:we.editPolicy.errors.numberGreatThan0Required}),Ae=Ce({than:-1,message:we.editPolicy.errors.nonNegativeNumberRequired}),De="ROLLOVER_VALUE_REQUIRED_VALIDATION_CODE",Ie=Object.values(Me),Ne=({form:e,path:t})=>{const a=e.getFields();if(!Ie.some((e=>{var t;return Boolean(null===(t=a[e])||void 0===t?void 0:t.value)}))){const e={code:De,message:""};switch(t){case Me.maxAge:e.message=we.editPolicy.errors.maximumAgeRequiredMessage;break;case Me.maxDocs:e.message=we.editPolicy.errors.maximumDocumentsRequiredMessage;break;case Me.maxPrimaryShardSize:e.message=we.editPolicy.errors.maximumPrimaryShardSizeRequiredMessage;break;case Me.maxPrimaryShardDocs:e.message=we.editPolicy.errors.maximumPrimaryShardDocsRequiredMessage;break;default:e.message=we.editPolicy.errors.maximumSizeRequiredMessage}return e}Ie.forEach((e=>{var t;null===(t=a[e])||void 0===t||t.clearErrors(De)}))},Re=e=>{var t;if(!Number.isInteger(Number(null!==(t=e.value)&&void 0!==t?t:"")))return{message:we.editPolicy.errors.integerRequired}},Ue=e=>({formData:t})=>{if("warm"===e)return;const a=e=>{const a=t[`_meta.${e}.minAgeToMilliSeconds`];return{milli:a,esFormat:a>=0?t[`phases.${e}.min_age`]+t[`_meta.${e}.minAgeUnit`]:void 0}},i={warm:a("warm"),cold:a("cold"),frozen:a("frozen"),delete:a("delete")},l={greaterThanWarmPhase:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanWarmPhaseError",{defaultMessage:"Must be greater or equal than the warm phase value ({value})",values:{value:i.warm.esFormat}}),greaterThanColdPhase:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanColdPhaseError",{defaultMessage:"Must be greater or equal than the cold phase value ({value})",values:{value:i.cold.esFormat}}),greaterThanFrozenPhase:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanFrozenPhaseError",{defaultMessage:"Must be greater or equal than the frozen phase value ({value})",values:{value:i.frozen.esFormat}})};if("cold"===e)return i.warm.milli>=0&&i.cold.milli<i.warm.milli?{message:l.greaterThanWarmPhase}:void 0;if("frozen"===e)return i.cold.milli>=0&&i.frozen.milli<i.cold.milli?{message:l.greaterThanColdPhase}:i.warm.milli>=0&&i.frozen.milli<i.warm.milli?{message:l.greaterThanWarmPhase}:void 0;if("delete"===e){if(i.frozen.milli>=0&&i.delete.milli<i.frozen.milli)return{message:l.greaterThanFrozenPhase};if(i.cold.milli>=0&&i.delete.milli<i.cold.milli)return{message:l.greaterThanColdPhase};if(i.warm.milli>=0&&i.delete.milli<i.warm.milli)return{message:l.greaterThanWarmPhase}}},Be=e=>({formData:t})=>{if("hot"===e)return;const a=e=>{const a=t[`_meta.${e}.downsample.fixedIntervalSize`],i=t[`_meta.${e}.downsample.fixedIntervalUnits`];return a&&i?{milliseconds:xe.a.duration(a,i).asMilliseconds(),esFormat:a+i}:null},i={hot:a("hot"),warm:a("warm"),cold:a("cold")},l=(e,t)=>e>t&&e%t==0;if("warm"===e&&i.warm&&i.hot&&!l(i.warm.milliseconds,i.hot.milliseconds))return{message:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalWarmPhaseError",{defaultMessage:"Must be greater than and a multiple of the hot phase value ({value})",values:{value:i.hot.esFormat}})};if("cold"===e&&i.cold)if(i.warm){if(!l(i.cold.milliseconds,i.warm.milliseconds))return{message:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalColdPhaseWarmError",{defaultMessage:"Must be greater than and a multiple of the warm phase value ({value})",values:{value:i.warm.esFormat}})}}else if(i.hot&&!l(i.cold.milliseconds,i.hot.milliseconds))return{message:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalColdPhaseHotError",{defaultMessage:"Must be greater than and a multiple of the hot phase value ({value})",values:{value:i.hot.esFormat}})}},$e=Object.values(Me),{emptyField:qe,numberGreaterThanField:Ve}=r.fieldValidators,We={stringToNumber:e=>null!=e?parseInt(e,10):void 0},He={label:we.editPolicy.maxNumSegmentsFieldLabel,validations:[{validator:qe(se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.forcemerge.numberOfSegmentsRequiredError",{defaultMessage:"A value for number of segments is required."}))},{validator:ze}],serializer:We.stringToNumber},Ge={snapshot_repository:{label:we.editPolicy.searchableSnapshotsRepoFieldLabel,validations:[{validator:qe(we.editPolicy.errors.searchableSnapshotRepoRequired)}],helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.repositoryHelpText",{defaultMessage:"Each phase uses the same snapshot repository."})},storage:{label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.storageLabel",{defaultMessage:"Storage"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.storageHelpText",{defaultMessage:"Type of snapshot mounted for the searchable snapshot. This is an advanced option. Only change it if you know what you're doing."})}},Ke={label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicasLabel",{defaultMessage:"Number of replicas"}),validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:Ae}],serializer:We.stringToNumber},Je={label:se.i18n.translate("xpack.indexLifecycleMgmt.shrink.numberOfPrimaryShardsLabel",{defaultMessage:"Number of primary shards"}),defaultValue:1,validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:Ve({message:we.editPolicy.errors.numberGreatThan0Required,than:0})}],serializer:We.stringToNumber},Ye={label:we.editPolicy.maxPrimaryShardSizeLabel,validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:Ve({message:we.editPolicy.errors.numberGreatThan0Required,than:0})}],serializer:We.stringToNumber},Qe=e=>({defaultValue:ee.n[e],label:we.editPolicy.indexPriorityFieldLabel,validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:Ae}],serializer:We.stringToNumber}),Ze=(e,t)=>({defaultValue:t,fieldsToValidateOnChange:[],validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:Ae},{validator:Re},{validator:Ue(e)}]}),Xe=(e,t=!0)=>{const a=["hot","warm","cold"];return(i=e,a.slice(a.indexOf(i)+(t?0:1))).map((e=>`_meta.${e}.downsample.fixedIntervalSize`));var i},et=e=>({enabled:{defaultValue:!1,label:we.editPolicy.downsampleEnabledFieldLabel,fieldsToValidateOnChange:Xe(e,!1)},fixedIntervalSize:{label:we.editPolicy.downsampleIntervalFieldLabel,fieldsToValidateOnChange:Xe(e),validations:[{validator:qe(we.editPolicy.errors.numberRequired)},{validator:ze},{validator:Re},{validator:Be(e)}]},fixedIntervalUnits:{defaultValue:"d",fieldsToValidateOnChange:Xe(e)}}),tt=Object(i.createContext)(null),at="phases.hot.actions.searchable_snapshot.snapshot_repository",it="phases.cold.actions.searchable_snapshot.snapshot_repository",lt=({children:e})=>{const[t]=Object(o.useFormData)({watch:[at,it,ye,ve,Oe("hot"),Oe("warm"),Oe("cold")]}),a=Object(W.get)(t,ve),i=Object(W.get)(t,ye,!0),l={isUsingRollover:!1!==a||i,isUsingSearchableSnapshotInHotPhase:null!=Object(W.get)(t,at),isUsingSearchableSnapshotInColdPhase:null!=Object(W.get)(t,it),isUsingDownsampleInHotPhase:!!Object(W.get)(t,Oe("hot")),isUsingDownsampleInWarmPhase:!!Object(W.get)(t,Oe("warm")),isUsingDownsampleInColdPhase:!!Object(W.get)(t,Oe("cold"))};return Object(M.jsx)(tt.Provider,{value:l},e)},st=()=>{const e=Object(i.useContext)(tt);if(!e)throw new Error("Cannot use configuration outside of configuration context");return e},nt=Object(i.createContext)(null),ot=()=>({hasErrors:!1,hot:{},warm:{},cold:{},frozen:{},delete:{},other:{}}),rt=({children:e})=>{const[t,a]=Object(i.useState)(ot),l=Object(o.useFormContext)(),{getErrors:s,isSubmitted:n}=l,r=Object(i.useCallback)(((e,t,i)=>{a((a=>({...a,hasErrors:!0,[e]:{...a[e],[t]:i}})))}),[a]),c=Object(i.useCallback)(((e,t)=>{s().length?a((a=>{const{[e]:{[t]:i,...l},hasErrors:s,...n}=a,o=Object.keys(l).length>0||Object.values(n).some((e=>Object.keys(e).length>0));return{...a,hasErrors:o,[e]:l}})):a(ot)}),[s,a]);return Object(M.jsx)(nt.Provider,{value:{errors:t,addError:r,clearError:c,isFormSubmitted:n}},e)},ct=()=>{const e=Object(i.useContext)(nt);if(!e)throw new Error("useFormErrorsContext can only be used inside of FormErrorsProvider");return e},dt=e=>{var t,a,i,l,s,n;const o=null==e||null===(t=e._meta)||void 0===t||null===(a=t.warm)||void 0===a?void 0:a.enabled,r=null==e||null===(i=e._meta)||void 0===i||null===(l=i.cold)||void 0===l?void 0:l.enabled,c=null==e||null===(s=e._meta)||void 0===s||null===(n=s.frozen)||void 0===n?void 0:n.enabled;return{hot:{isFinalDataPhase:!o&&!r&&!c},warm:{isFinalDataPhase:o&&!r&&!c},cold:{isFinalDataPhase:r&&!c},frozen:{isFinalDataPhase:c}}},ut=Object(i.createContext)(null),mt=({children:e})=>{const{deleteEnabled:t}=bt(),[a]=Object(o.useFormData)({watch:["_meta.warm.enabled","_meta.cold.enabled","_meta.frozen.enabled","_meta.delete.enabled"]});return Object(M.jsx)(ut.Provider,{value:{...dt(a),isDeletePhaseEnabled:t.value,setDeletePhaseEnabled:t.setValue}},e)},pt=()=>{const e=Object(i.useContext)(ut);if(!e)throw new Error("Cannot use phase timings outside of phase timings context");return e},ht=Object(i.createContext)(null),xt={deleteEnabled:{path:"_meta.delete.enabled"},searchableSnapshotRepo:{path:"_meta.searchableSnapshot.repository"},warmMinAgeMilliSeconds:{path:"_meta.warm.minAgeToMilliSeconds"},coldMinAgeMilliSeconds:{path:"_meta.cold.minAgeToMilliSeconds"},frozenMinAgeMilliSeconds:{path:"_meta.frozen.minAgeToMilliSeconds"},deleteMinAgeMilliSeconds:{path:"_meta.delete.minAgeToMilliSeconds"},hotIsUsingShardSize:{path:"_meta.hot.shrink.isUsingShardSize"},warmIsUsingShardSize:{path:"_meta.warm.shrink.isUsingShardSize"}},gt=({children:e})=>Object(M.jsx)(o.UseMultiFields,{fields:xt},(t=>Object(M.jsx)(ht.Provider,{value:t},e))),bt=()=>{const e=Object(i.useContext)(ht);if(!e)throw new Error("Cannot use global fields outside of global fields context");return e},ft=({form:e,children:t})=>Object(M.jsx)(o.Form,{form:e},Object(M.jsx)(lt,null,Object(M.jsx)(rt,null,Object(M.jsx)(gt,null,Object(M.jsx)(mt,null,t))))),jt=e=>t=>t.startsWith(`phases.${e}`)||t.startsWith(`_meta.${e}`),yt=jt("hot"),vt=jt("warm"),Ot=jt("cold"),Mt=jt("frozen"),Pt=jt("delete"),_t=e=>{const{path:t}=e,a=Object(i.useRef)(!1),l=Object(i.useMemo)((()=>{return yt(e=t)?"hot":vt(e)?"warm":Ot(e)?"cold":Mt(e)?"frozen":Pt(e)?"delete":"other";var e}),[t]),{addError:s,clearError:n}=ct(),r=Object(i.useCallback)((e=>{a.current&&(e?s(l,t,e):n(l,t))}),[l,t,s,n]);return Object(i.useEffect)((()=>(a.current=!0,()=>{a.current=!1})),[]),Object(i.useEffect)((()=>()=>{!1===a.current&&n(l,t)}),[l,t,n]),Object(M.jsx)(o.UseField,m()({},e,{onError:r}))};var Tt=a(9),kt=a(15);const wt=({docPath:e,text:t})=>{const a=t||Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.learnMore",defaultMessage:"Learn more"});return Object(M.jsx)(j.EuiLink,{href:e,target:"_blank",external:!0},a)},Lt=()=>Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.optionalMessage",defaultMessage:" (optional)"}),St=({policyName:e,close:t})=>{const[a,s]=Object(i.useState)(void 0),{validate:n,getErrors:r}=Object(o.useFormContext)(),[,c]=Object(o.useFormData)(),d=Object(i.useCallback)((async()=>{s(void 0);const e=await n(),t=r(),a=1===t.length&&t[0]===we.editPolicy.errors.policyNameRequiredMessage;var i;s(e||a?{phases:{hot:(i=c()).phases.hot,warm:i.phases.warm,cold:i.phases.cold,frozen:i.phases.frozen,delete:i.phases.delete},deprecated:null==i?void 0:i.deprecated,_meta:i._meta}:null)}),[s,c,n,r]);let u;switch(Object(i.useEffect)((()=>{d()}),[d]),a){case void 0:u=Object(M.jsx)(j.EuiLoadingSpinner,null);break;case null:u=Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"policyRequestInvalidAlert",iconType:"warning",color:"danger",title:se.i18n.translate("xpack.indexLifecycleMgmt.policyJsonFlyout.validationErrorCallout.title",{defaultMessage:"Invalid policy"})},se.i18n.translate("xpack.indexLifecycleMgmt.policyJsonFlyout.validationErrorCallout.body",{defaultMessage:"To view the JSON for this policy address all validation errors."}));break;default:const t=`PUT _ilm/policy/${e||"<policyName>"}\n${JSON.stringify({policy:{...a}},null,2)}`;u=Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiText,null,Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.descriptionText",defaultMessage:"This Elasticsearch request will create or update this index lifecycle policy."}))),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(j.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"policyRequestJson"},t))}return Object(M.jsx)(j.EuiFlyout,{maxWidth:480,onClose:t},Object(M.jsx)(j.EuiFlyoutHeader,null,Object(M.jsx)(j.EuiTitle,null,Object(M.jsx)("h2",null,e?Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.namedTitle",defaultMessage:"Request for ''{policyName}''",values:{policyName:e}}):Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.unnamedTitle",defaultMessage:"Request"})))),Object(M.jsx)(j.EuiFlyoutBody,null,u),Object(M.jsx)(j.EuiFlyoutFooter,null,Object(M.jsx)(j.EuiButtonEmpty,{iconType:"cross",onClick:t,flush:"left","data-test-subj":"policyRequestClose"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.closeButtonLabel",defaultMessage:"Close"}))))},Et=({children:e,switchProps:t,description:a,fieldNotices:s,...n})=>{var o;if(t&&"boolean"!=typeof t.checked&&"boolean"!=typeof t.initialValue)throw new Error("Must specify controlled, uncontrolled component. See SwitchProps interface!");const[r,c]=Object(i.useState)((()=>{var e;return null!==(e=null==t?void 0:t.initialValue)&&void 0!==e&&e})),d=Boolean(void 0===t||(null!==(o=null==t?void 0:t.checked)&&void 0!==o?o:r));return Object(M.jsx)(j.EuiDescribedFormGroup,m()({},n,{description:Object(M.jsx)(l.a.Fragment,null,a,Object(M.jsx)(j.EuiSpacer,{size:"m"}),(()=>{if(!t)return null;const{onChange:e,checked:a,initialValue:i,...l}=t;return Object(M.jsx)(j.EuiSwitch,m()({},l,{checked:d,onChange:t=>{const a=t.target.checked;c(a),e&&e(a)}}))})(),s)}),d?"function"==typeof e?e():e:null)},Ft=({switchProps:e,...t})=>Object(M.jsx)(_t,{path:e.path},(a=>Object(M.jsx)(Et,m()({},t,{switchProps:{...e,label:a.label,checked:a.value,onChange:a.setValue}})))),Ct=e=>{const{title:t,body:a,resendRequest:i}=e;return Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"m"}),Object(M.jsx)(j.EuiCallOut,{"data-test-subj":e["data-test-subj"],iconType:"help",color:"warning",title:Object(M.jsx)(l.a.Fragment,null,t,Object(M.jsx)(j.EuiButtonIcon,{size:"s",color:"warning",onClick:i,iconType:"refresh","aria-label":e["aria-label"]}))},a))},zt=({phaseName:e,durationInPhase:t})=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiText,{size:"s"},Object(M.jsx)("strong",null,e))),Object(M.jsx)(j.EuiFlexItem,{grow:!1},"string"==typeof t?Object(M.jsx)(j.EuiText,{size:"s"},t):t));a(51);const At=e=>null!=e,Dt=(e,t)=>e/t*100,It=(e,t)=>isFinite(e)?0===t?100:Dt(e,t):100,Nt={title:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.title",{defaultMessage:"Policy summary"}),description:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.description",{defaultMessage:"This policy moves data through the following phases."}),hotPhase:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.hotPhaseSectionTitle",{defaultMessage:"Hot phase"}),warmPhase:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.warmPhaseSectionTitle",{defaultMessage:"Warm phase"}),coldPhase:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.coldPhaseSectionTitle",{defaultMessage:"Cold phase"}),frozenPhase:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.frozenPhaseSectionTitle",{defaultMessage:"Frozen phase"}),deleteIcon:{toolTipContent:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.deleteIconToolTipContent",{defaultMessage:"Policy deletes the index after lifecycle phases complete."})},foreverIcon:{ariaLabel:se.i18n.translate("xpack.indexLifecycleMgmt.timeline.foreverIconToolTipContent",{defaultMessage:"Forever"})}},Rt=Object(i.memo)((({hasDeletePhase:e,isUsingRollover:t,...a})=>{const i={hot:{min_age:a.hotPhaseMinAge},warm:a.warmPhaseMinAge?{min_age:a.warmPhaseMinAge}:void 0,cold:a.coldPhaseMinAge?{min_age:a.coldPhaseMinAge}:void 0,frozen:a.frozenPhaseMinAge?{min_age:a.frozenPhaseMinAge}:void 0,delete:a.deletePhaseMinAge?{min_age:a.deletePhaseMinAge}:void 0},l=(s=i,ge.reduce(((e,t,a)=>{var i;if("delete"===t)return e;if(!s[t])return e;const l=ge.slice(a+1).find((e=>Boolean(s[e])));let n=1/0;if(l&&null!==(i=s[l])&&void 0!==i&&i.min_age){const{units:e,size:t}=le(s[l].min_age);n=fe(t,e)}return{total:Math.max(e.total,n),phases:{...e.phases,[t]:Math.max(n-e.total,0)}}}),{total:0,phases:{hot:0,warm:s.warm?0:void 0,cold:s.cold?0:void 0,frozen:s.frozen?0:void 0}}));var s;const n=(e=>{const t=It(e.phases.hot,e.total)+50,a=null!=e.phases.warm?It(e.phases.warm,e.total)+50:0,i=null!=e.phases.cold?It(e.phases.cold,e.total)+50:0,l=null!=e.phases.frozen?It(e.phases.frozen,e.total)+50:0,s=t+a+i+l;return{hot:`${Dt(t,s)}%`,warm:`${Dt(a,s)}%`,cold:`${Dt(i,s)}%`,frozen:`${Dt(l,s)}%`}})(l),o=e=>l.phases[e]===1/0?Object(M.jsx)(Gt,{color:"subdued","aria-label":Nt.foreverIcon.ariaLabel}):null,{docLinks:r}=B().services;return Object(M.jsx)(j.EuiFlexGroup,{gutterSize:"s",direction:"column",responsive:!1},Object(M.jsx)(j.EuiFlexItem,null,Object(M.jsx)(j.EuiTitle,{size:"s"},Object(M.jsx)("h2",null,Nt.title)),Object(M.jsx)(j.EuiText,{size:"s",color:"subdued"},Nt.description," ",Object(M.jsx)(wt,{docPath:r.links.elasticsearch.ilmPhaseTransitions,text:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutTimingText",defaultMessage:"Learn about timing"})}))),Object(M.jsx)(j.EuiFlexItem,null,Object(M.jsx)("div",{className:"ilmTimeline",ref:e=>{var t,a,i;e&&(e.style.setProperty("--ilm-timeline-hot-phase-width",n.hot),e.style.setProperty("--ilm-timeline-warm-phase-width",null!==(t=n.warm)&&void 0!==t?t:null),e.style.setProperty("--ilm-timeline-cold-phase-width",null!==(a=n.cold)&&void 0!==a?a:null),e.style.setProperty("--ilm-timeline-frozen-phase-width",null!==(i=n.frozen)&&void 0!==i?i:null))}},Object(M.jsx)(j.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",responsive:!1},Object(M.jsx)(j.EuiFlexItem,null,Object(M.jsx)("div",{className:"ilmTimeline__phasesContainer"},Object(M.jsx)("div",{"data-test-subj":"ilmTimelinePhase-hot",className:"ilmTimeline__phasesContainer__phase ilmTimeline__hotPhase"},Object(M.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__hotPhase__colorBar"}),Object(M.jsx)(zt,{phaseName:Nt.hotPhase,durationInPhase:o("hot")})),At(l.phases.warm)&&Object(M.jsx)("div",{"data-test-subj":"ilmTimelinePhase-warm",className:"ilmTimeline__phasesContainer__phase ilmTimeline__warmPhase"},Object(M.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__warmPhase__colorBar"}),Object(M.jsx)(zt,{phaseName:Nt.warmPhase,durationInPhase:o("warm")})),At(l.phases.cold)&&Object(M.jsx)("div",{"data-test-subj":"ilmTimelinePhase-cold",className:"ilmTimeline__phasesContainer__phase ilmTimeline__coldPhase"},Object(M.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__coldPhase__colorBar"}),Object(M.jsx)(zt,{phaseName:Nt.coldPhase,durationInPhase:o("cold")})),At(l.phases.frozen)&&Object(M.jsx)("div",{"data-test-subj":"ilmTimelinePhase-frozen",className:"ilmTimeline__phasesContainer__phase ilmTimeline__frozenPhase"},Object(M.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__frozenPhase__colorBar"}),Object(M.jsx)(zt,{phaseName:Nt.frozenPhase,durationInPhase:o("frozen")})))),e&&Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)("div",{"data-test-subj":"ilmTimelinePhase-delete",className:"ilmTimeline__deleteIconContainer"},Object(M.jsx)(j.EuiIconTip,{type:"trash",content:Nt.deleteIcon.toolTipContent})))))))})),Ut=()=>{var e,t,a,i,l,s;const[n]=Object(o.useFormData)(),r=(e=>{var t;const{_meta:a}=e;return a?{hot:{min_age:void 0},warm:a.warm.enabled?be("warm",e):void 0,cold:a.cold.enabled?be("cold",e):void 0,frozen:null!==(t=a.frozen)&&void 0!==t&&t.enabled?be("frozen",e):void 0,delete:a.delete.enabled?be("delete",e):void 0}:{hot:{min_age:void 0}}})(n),{isUsingRollover:c}=st();return Object(M.jsx)(Rt,{hotPhaseMinAge:r.hot.min_age,warmPhaseMinAge:null===(e=r.warm)||void 0===e?void 0:e.min_age,coldPhaseMinAge:null===(t=r.cold)||void 0===t?void 0:t.min_age,frozenPhaseMinAge:null===(a=r.frozen)||void 0===a?void 0:a.min_age,deletePhaseMinAge:null===(i=r.delete)||void 0===i?void 0:i.min_age,isUsingRollover:c,hasDeletePhase:Boolean(null===(l=n._meta)||void 0===l||null===(s=l.delete)||void 0===s?void 0:s.enabled)})},Bt={callout:{title:se.i18n.translate("xpack.indexLifecycleMgmt.policyErrorCalloutTitle",{defaultMessage:"This policy contains errors"}),body:se.i18n.translate("xpack.indexLifecycleMgmt.policyErrorCalloutDescription",{defaultMessage:"Please fix all errors before saving the policy."})}},$t=()=>{const{errors:{hasErrors:e},isFormSubmitted:t}=ct();return t&&e?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"policyFormErrorsCallout",color:"danger",title:Bt.callout.title},Bt.callout.body),Object(M.jsx)(j.EuiSpacer,null)):null},qt=e=>Object(M.jsx)("svg",m()({viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none"},e),Object(M.jsx)("defs",null),Object(M.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.44354 9.86928c-.47429.46802-1.12585.75702-1.84475.75702-1.45038 0-2.626143-1.17576-2.626143-2.62614S2.14841 5.37401 3.59879 5.37401c.71899 0 1.37049.28893 1.84473.75702l.00033-.00033.27438.27438L7.31327 8.0001l-.00001.00001.68777.68777.00001-.00002 1.86843 1.86844-.00078.0007c.65021.6442 1.54481 1.042 2.53251 1.042C14.3888 11.599 16 9.98772 16 8.00016s-1.6112-3.59879-3.5988-3.59879c-.9876 0-1.8822.39779-2.53249 1.04188l.00072.00073-.76518.76516.68777.68777.79978-.79975-.0002-.00017c.471-.44801 1.1082-.72298 1.8096-.72298 1.4504 0 2.6262 1.17577 2.6262 2.62615s-1.1758 2.62614-2.6262 2.62614c-.7012 0-1.3384-.2749-1.8094-.72282l.0002-.00024L8.68881 8.0001l.00278-.00277-.68777-.68777-.00278.00278-1.90297-1.90295-.0007.0007c-.64728-.62456-1.52806-1.00872-2.49858-1.00872C1.61124 4.40137 0 6.0126 0 8.00016 0 9.98772 1.61124 11.599 3.59879 11.599c.97055 0 1.85122-.3841 2.49844-1.0086l.00065.0006.80272-.8027-.68777-.68777-.76902.76901-.00027-.00026z"})),Vt=se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseTiming.beforeDeleteDescription",{defaultMessage:"Delete data after this phase"}),Wt=se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseTiming.foreverTimingDescription",{defaultMessage:"Keep data in this phase forever"}),Ht=({phase:e})=>{const{isDeletePhaseEnabled:t,setDeletePhaseEnabled:a,[e]:i}=pt();if(!i.isFinalDataPhase)return null;const l=t?"ilmEnableDeletePhaseButton":"ilmDisableDeletePhaseButton",s=[{id:"ilmDisableDeletePhaseButton",label:Wt,iconType:qt},{id:"ilmEnableDeletePhaseButton",label:Vt,iconType:"trash","data-test-subj":"enableDeletePhaseButton"}];return Object(M.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiText,{size:"s",color:"subdued"},t?Vt:Wt)),Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiButtonGroup,{legend:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.buttonGroupLegend",{defaultMessage:"Enable or disable delete phase"}),options:s,idSelected:l,onChange:e=>{a("ilmEnableDeletePhaseButton"===e)},isIconOnly:!0})))},Gt=e=>Object(M.jsx)(j.EuiIcon,m()({type:qt},e)),Kt=Object(i.createContext)(null),Jt=({value:e,children:t})=>Object(M.jsx)(Kt.Provider,{value:e},t),Yt=()=>{const e=Object(i.useContext)(Kt);if(!e)throw new Error("useEditPolicyContext can only be called inside of EditPolicyContext!");return e};var Qt=a(13),Zt=a(18);const Xt=({policyName:e,indexTemplates:t,close:a})=>{const{services:{getUrlForApp:i}}=B();return Object(M.jsx)(j.EuiFlyout,{onClose:a},Object(M.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},Object(M.jsx)(j.EuiTitle,{size:"m","data-test-subj":"indexTemplatesFlyoutHeader"},Object(M.jsx)("h2",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.indexTemplatesFlyout.headerText",defaultMessage:"Index templates that apply {policyName}",values:{policyName:e}})))),Object(M.jsx)(j.EuiFlyoutBody,null,Object(M.jsx)(j.EuiInMemoryTable,{pagination:!0,items:null!=t?t:[],columns:[{name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.indexTemplatesTable.nameHeader",{defaultMessage:"Index template name"}),render:e=>{return Object(M.jsx)(j.EuiLink,{"data-test-subj":"indexTemplateLink",className:"eui-textBreakAll",href:(t=e,i("management",{path:`data/index_management${Object(Zt.getTemplateDetailsLink)(t)}`}))},e);var t}}]})),Object(M.jsx)(j.EuiFlyoutFooter,null,Object(M.jsx)(j.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexTemplatesFlyout.closeButtonLabel",defaultMessage:"Close"}))))},ea=()=>{var e;const{isNewPolicy:t,indices:a,indexTemplates:s,policyName:n,policy:o}=Yt(),{services:{getUrlForApp:r}}=B(),[c,d]=Object(i.useState)(!1);if(t)return null;const u=a.length>0?Object(M.jsx)(j.EuiLink,{"data-test-subj":"linkedIndicesLink",external:!0,href:Object(Qt.b)(null!=n?n:"",r),target:"_blank"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.linkedIndices",defaultMessage:"{indicesCount, plural, one {# linked index} other {# linked indices}}",values:{indicesCount:a.length}})):null,m=s.length>0?Object(M.jsx)(j.EuiLink,{"data-test-subj":"linkedIndexTemplatesLink",onClick:()=>d(!c)},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.linkedIndexTemplates",defaultMessage:"{indexTemplatesCount, plural, one {# linked index template} other {# linked index templates}}",values:{indexTemplatesCount:s.length}})):null,p=u?Object(M.jsx)(l.a.Fragment,null,u,m?Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.andDependenciesLink",defaultMessage:" and {indexTemplatesLink}",values:{indexTemplatesLink:m}}):null):m,h=null==o||null===(e=o._meta)||void 0===e?void 0:e.managed,x=null==o?void 0:o.deprecated;return Object(M.jsx)(l.a.Fragment,null,c&&Object(M.jsx)(Xt,{policyName:null!=n?n:"",indexTemplates:s,close:()=>d(!1)}),Object(M.jsx)(j.EuiText,{"data-test-subj":"editWarning"},h&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiCallOut,{title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.proceedWithCautionCallOutTitle",defaultMessage:"Editing a managed policy can break Kibana"}),color:"danger",iconType:"warning","data-test-subj":"editManagedPolicyCallOut"},Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.proceedWithCautionCallOutDescription",defaultMessage:"Managed policies are critical for internal operations."}))),Object(M.jsx)(j.EuiSpacer,null)),x&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiCallOut,{title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.deprecatedPolicyTitle",defaultMessage:"This policy is deprecated"}),color:"warning",iconType:"warning","data-test-subj":"editPolicyWithDeprecation"},Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.deprecatedPolicyDescription",defaultMessage:"This policy is no longer supported and might be removed in a future release. Instead, use one of the other policies available or create a new one."}))),Object(M.jsx)(j.EuiSpacer,null)),Object(M.jsx)("p",null,Object(M.jsx)("strong",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.editingExistingPolicyMessage",defaultMessage:"You are editing an existing policy."})),p?Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.dependenciesMessage",defaultMessage:" Any changes you make will affect {dependenciesLinks} that {count, plural, one {is} other {are}} attached to this policy.",values:{dependenciesLinks:p,count:a.length+s.length}}):null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewMessage",defaultMessage:" Alternatively, you can save these changes in a new policy."}))))},ta=({close:e,selectedNodeAttrs:t})=>{const{data:a,isLoading:i,error:l,resendRequest:s}=Object(ie.i)(t);let n;if(i)n=Object(M.jsx)(j.EuiSkeletonText,{lines:3});else if(l){const{statusCode:e,message:t}=l;n=Object(M.jsx)(j.EuiCallOut,{title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeDetailsLoadingFailedTitle",defaultMessage:"Unable to load node attribute details"}),color:"danger"},Object(M.jsx)("p",null,t," (",e,")"),Object(M.jsx)(j.EuiButton,{onClick:s,iconType:"refresh",color:"danger"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeDetailsReloadButton",defaultMessage:"Try again"})))}else n=Object(M.jsx)(j.EuiInMemoryTable,{items:a||[],columns:[{field:"nodeId",name:se.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.idField",{defaultMessage:"ID"})},{field:"stats.name",name:se.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.nameField",{defaultMessage:"Name"})},{field:"stats.host",name:se.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.hostField",{defaultMessage:"Host"})}],pagination:!0,sorting:!0});return Object(M.jsx)(j.EuiPortal,null,Object(M.jsx)(j.EuiFlyout,{ownFocus:!0,onClose:e},Object(M.jsx)(j.EuiFlyoutBody,null,Object(M.jsx)(j.EuiTitle,null,Object(M.jsx)("h2",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.nodeAttrDetails.title",defaultMessage:"Nodes that contain the attribute {selectedNodeAttrs}",values:{selectedNodeAttrs:t}}))),Object(M.jsx)(j.EuiSpacer,{size:"s"}),n)))},aa={allocateToDataNodesOption:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.nodeAllocation.allocateToDataNodesOption",{defaultMessage:"Any data node"})},ia=({phase:e,nodes:t,isLoading:a,isCloudEnabled:s,isUsingDeprecatedDataRoleConfig:n})=>{const r=`_meta.${e}.allocationNodeAttribute`,[d]=Object(o.useFormData)({watch:[r]}),{docLinks:u}=B().services,m=u.links.elasticsearch.shardAllocationSettings,p=Object(W.get)(d,r),[h,x]=Object(i.useState)(null),g=Object.keys(t).map((e=>({text:`${e} (${t[e].length})`,value:e})));g.sort(((e,t)=>e.value.localeCompare(t.value)));let b=[];if(!s||n){const e={text:aa.allocateToDataNodesOption,value:""};b.push(e)}return b=b.concat(g),Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiText,{size:"s"},Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAllocation.customOption.description",defaultMessage:"Use node attributes to control shard allocation. {learnMoreLink}.",values:{learnMoreLink:Object(M.jsx)(wt,{text:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutShardAllocationLink",defaultMessage:"Learn about shard allocation"}),docPath:m})}}))),Object(M.jsx)(j.EuiSpacer,{size:"m"}),Object(M.jsx)(_t,{path:`_meta.${e}.allocationNodeAttribute`,component:c.SelectField,config:{defaultValue:b.length?b[0].value:""},componentProps:{helpText:p?Object(M.jsx)(j.EuiButtonEmpty,{size:"xs",style:{maxWidth:400},"data-test-subj":`${e}-viewNodeDetailsFlyoutButton`,flush:"left",onClick:()=>x(p)},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.viewNodeDetailsButton",defaultMessage:"View nodes with the selected attribute"})):void 0,euiFieldProps:{"data-test-subj":`${e}-selectedNodeAttrs`,options:b,hasNoInitialSelection:!1,isLoading:a}}}),h?Object(M.jsx)(ta,{selectedNodeAttrs:h,close:()=>x(null)}):null)};a(56);const la={inputDisplay:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.customOption.input",{defaultMessage:"Custom"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.customOption.helpText",{defaultMessage:"Move data based on node attributes."})},sa={allocationOptions:{warm:{default:{input:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.defaultOption.input",{defaultMessage:"Use warm nodes (recommended)"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.defaultOption.helpText",{defaultMessage:"Move data to nodes in the warm tier."})},none:{inputDisplay:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.noneOption.input",{defaultMessage:"Off"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.noneOption.helpText",{defaultMessage:"Do not move data in the warm phase."})},custom:la},cold:{default:{input:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.defaultOption.input",{defaultMessage:"Use cold nodes (recommended)"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.defaultOption.helpText",{defaultMessage:"Move data to nodes in the cold tier."})},none:{inputDisplay:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.noneOption.input",{defaultMessage:"Off"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.noneOption.helpText",{defaultMessage:"Do not move data in the cold phase."})},custom:la},frozen:{default:{input:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.defaultOption.input",{defaultMessage:"Use frozen nodes (recommended)"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.defaultOption.helpText",{defaultMessage:"Move data to nodes in the frozen tier."})},none:{inputDisplay:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.noneOption.input",{defaultMessage:"Off"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.noneOption.helpText",{defaultMessage:"Do not move data in the frozen phase."})},custom:la}}},na=(e,t)=>[t?void 0:{"data-test-subj":"defaultDataAllocationOption",value:"node_roles",inputDisplay:sa.allocationOptions[e].default.input,dropdownDisplay:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("strong",null,sa.allocationOptions[e].default.input),Object(M.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(M.jsx)("p",null,sa.allocationOptions[e].default.helpText)))},{"data-test-subj":"customDataAllocationOption",value:"node_attrs",inputDisplay:sa.allocationOptions[e].custom.inputDisplay,dropdownDisplay:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("strong",null,sa.allocationOptions[e].custom.inputDisplay),Object(M.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(M.jsx)("p",null,sa.allocationOptions[e].custom.helpText)))},{"data-test-subj":"noneDataAllocationOption",value:"none",inputDisplay:sa.allocationOptions[e].none.inputDisplay,dropdownDisplay:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("strong",null,sa.allocationOptions[e].none.inputDisplay),Object(M.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(M.jsx)("p",null,sa.allocationOptions[e].none.helpText)))}].filter(Boolean),oa=e=>{const{phase:t,hasNodeAttributes:a,isCloudEnabled:i,isUsingDeprecatedDataRoleConfig:s,isLoading:n}=e,r=Boolean(i&&s),d=`_meta.${t}.dataTierAllocationType`,[u]=Object(o.useFormData)({watch:d}),m=Object(W.get)(u,d);return Object(M.jsx)("div",{"data-test-subj":`${t}-dataTierAllocationControls`},Object(M.jsx)(_t,{path:d},(e=>(r&&"node_roles"===e.value&&e.setValue("node_attrs"),Object(M.jsx)(c.SuperSelectField,{field:e,euiFieldProps:{isLoading:n,hasDividers:!0,"data-test-subj":"dataTierSelect",options:na(t,r)}})))),"node_attrs"===m&&a&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)("div",{className:"indexLifecycleManagement__phase__dataTierAllocation__controlSection"},Object(M.jsx)(ia,e))))},ra={data_hot:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierHotLabel",{defaultMessage:"hot"}),data_warm:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierWarmLabel",{defaultMessage:"warm"})},ca={warm:{title:se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.willUseFallbackTierTitle",{defaultMessage:"No nodes assigned to the warm tier"}),body:e=>se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.willUseFallbackTierDescription",{defaultMessage:"If no warm nodes are available, data is stored in the {tier} tier.",values:{tier:ra[e]}})},cold:{title:se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.willUseFallbackTierTitle",{defaultMessage:"No nodes assigned to the cold tier"}),body:e=>se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.willUseFallbackTierDescription",{defaultMessage:"If no cold nodes are available, data is stored in the {tier} tier.",values:{tier:ra[e]}})}},da=({phase:e,targetNodeRole:t})=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"willUseFallbackTierNotice",title:ca[e].title},ca[e].body(t)),ua=se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noCustomAttributesTitle",{defaultMessage:"No custom attributes defined"}),ma=({docLinks:e})=>Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.defaultToDataNodesDescription",defaultMessage:"To allocate data to particular data nodes, {roleBasedGuidance} or configure custom node attributes in elasticsearch.yml.",values:{roleBasedGuidance:Object(M.jsx)(j.EuiLink,{href:e.links.elasticsearch.migrateIndexAllocationFilters,target:"_blank",external:!0},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.defaultToDataNodesDescription.migrationGuidanceMessage",{defaultMessage:"use role-based allocation"}))}}),pa=({phase:e,targetNodeRole:t})=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"willUseFallbackTierUsingNodeAttributesNotice",title:ua},Object(M.jsx)("p",null,se.i18n.translate("xpack.indexLifecycleMgmt.dataTier.willUseFallbackTierUsingNodeAttributesDescription",{defaultMessage:"No {phase} nodes available. Data will be allocated to the {fallbackTier} tier.",values:{phase:e,fallbackTier:ra[t]}})),Object(M.jsx)("p",null,ma)),ha={warm:{title:se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.noTiersAvailableTitle",{defaultMessage:"No nodes assigned to the warm tier"}),body:se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.noTiersAvailableBody",{defaultMessage:"To use role-based allocation, assign one or more nodes to the warm or hot tiers. Allocation will fail if there are no available nodes."})},cold:{title:se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.noTiersAvailableTitle",{defaultMessage:"No nodes assigned to the cold tier"}),body:se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.noTiersAvailableBody",{defaultMessage:"To use role-based allocation, assign one or more nodes to the cold, warm, or hot tiers. Allocation will fail if there are no available nodes."})}},xa=({phase:e})=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"noTiersAvailableNotice",title:ha[e].title,color:"warning"},ha[e].body),ga=()=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"noTiersAvailableUsingNodeAttributesNotice",title:ua,color:"warning"},Object(M.jsx)("p",null,se.i18n.translate("xpack.indexLifecycleMgmt.dataTier.noTiersAvailableUsingNodeAttributesDescription",{defaultMessage:"Unable to allocate data: no available data nodes."})),Object(M.jsx)("p",null,ma)),ba={body:{warm:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("p",null,se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.defaultAllocationNotAvailableDescription",{defaultMessage:"Data will be allocated to the warm tier."})),ma),cold:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("p",null,se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.defaultAllocationNotAvailableDescription",{defaultMessage:"Data will be allocated to the cold tier."})),ma)}},fa=({phase:e})=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"defaultToDataTiersNotice",style:{maxWidth:400},title:ua,color:"primary"},ba.body[e]),ja=({phase:e})=>Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"defaultToDataNodesNotice",style:{maxWidth:400},title:ua,color:"primary"},Object(M.jsx)("p",null,se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.defaultToDataNodesDescription",{defaultMessage:"Data will be allocated to any available data node."})),ma),ya={title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.title",{defaultMessage:"Migrate to data tiers"}),body:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.body",{defaultMessage:"Migrate your Elastic Cloud deployment to use data tiers."}),linkText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.linkToCloudDeploymentDescription",{defaultMessage:"View cloud deployment"})},va=({linkToCloudDeployment:e})=>Object(M.jsx)(j.EuiCallOut,{title:ya.title,"data-test-subj":"cloudDataTierCallout"},ya.body," ",Boolean(e)&&Object(M.jsx)(j.EuiLink,{href:e,external:!0},ya.linkText)),Oa=({statusCode:e,message:t,onResendRequest:a})=>Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(j.EuiCallOut,{title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAttributesLoadingFailedTitle",defaultMessage:"Unable to load node data"}),color:"danger"},Object(M.jsx)("p",null,t," (",e,")"),Object(M.jsx)(j.EuiButton,{onClick:a,iconType:"refresh",color:"danger"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAttributesReloadButton",defaultMessage:"Try again"}))),Object(M.jsx)(j.EuiSpacer,{size:"xl"}));a(61);const Ma={title:se.i18n.translate("xpack.indexLifecycleMgmt.common.dataTier.title",{defaultMessage:"Data allocation"})},Pa=({phase:e,description:t})=>{var a;const{services:{cloud:i}}=B(),s=`_meta.${e}.dataTierAllocationType`,[n]=Object(o.useFormData)({watch:s}),r=Object(W.get)(n,s),{data:c,resendRequest:d,error:u,isLoading:m}=Object(ie.j)(),{nodesByRoles:p,nodesByAttributes:h,isUsingDeprecatedDataRoleConfig:x}=c,g=Boolean(Object.keys(null!=h?h:{}).length),b=null!==(a=null==i?void 0:i.isCloudEnabled)&&void 0!==a&&a,f=null==i?void 0:i.deploymentUrl,y=((e,t)=>{var a;const i=ae.c[e];return null!==(a=t.data)&&void 0!==a&&a.length?i[0]:i.find((e=>{var a;return Boolean(null===(a=t[e])||void 0===a?void 0:a.length)}))})(e,p),v=void 0===y,O=void 0!==y&&!((e,t)=>ae.c[e][0]===t)(e,y);return Object(M.jsx)(j.EuiDescribedFormGroup,{title:Object(M.jsx)("h3",null,Ma.title),description:Object(M.jsx)(l.a.Fragment,null,t,m?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"m"}),Object(M.jsx)(j.EuiLoadingSpinner,{"data-test-subj":"allocationLoadingSpinner",size:"xl"})):u&&Object(M.jsx)(Oa,{onResendRequest:d,message:u.message,statusCode:u.statusCode})),fullWidth:!0},Object(M.jsx)("div",{className:"ilmDataTierAllocationField"},Object(M.jsx)(oa,{hasNodeAttributes:g,phase:e,nodes:h,isCloudEnabled:b,isUsingDeprecatedDataRoleConfig:x,isLoading:m}),!m&&(()=>{switch(r){case"node_roles":if(b)return null;if(v)return Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(xa,{phase:e}));if(O)return Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(da,{phase:e,targetNodeRole:y}));break;case"node_attrs":if(!g)return x?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(ja,{phase:e})):v?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(ga,null)):O?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(pa,{phase:e,targetNodeRole:y})):Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(fa,{phase:e}));if(b&&x)return Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(va,{linkToCloudDeployment:f}));break;default:return null}})()))};var _a=a(39);const Ta=({phase:e})=>{const{policy:t}=Yt(),a=Object(i.useMemo)((()=>{var a,i;return null!=(null===(a=t.phases[e])||void 0===a||null===(i=a.actions)||void 0===i?void 0:i.forcemerge)}),[t,e]),{docLinks:s}=B().services;return Object(M.jsx)(Et,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.forceMerge.enableText",defaultMessage:"Force merge"})),description:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.forceMerge.enableExplanationText",defaultMessage:"Reduce the number of segments in each index shard and clean up deleted documents."})," ",Object(M.jsx)(wt,{docPath:s.links.elasticsearch.ilmForceMerge})),titleSize:"xs",fullWidth:!0,switchProps:{label:we.editPolicy.forceMergeEnabledFieldLabel,"data-test-subj":`${e}-forceMergeSwitch`,initialValue:a}},Object(M.jsx)(_t,{path:`phases.${e}.actions.forcemerge.max_num_segments`,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-selectedForceMergeSegments`,min:1}}}),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(_t,{path:`_meta.${e}.bestCompression`},(t=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiCheckbox,{label:t.label,checked:t.value,onChange:t.onChange,"data-test-subj":`${e}-bestCompression`,id:Object(_a.v4)()})),Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiIconTip,{content:we.editPolicy.bestCompressionFieldHelpText,position:"right"}))))))};function ka(e){switch(e){case"warm":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseWarm.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of warm phase"});case"cold":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseCold.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of cold phase"});case"frozen":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseFrozen.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of frozen phase"});case"delete":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseDelete.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of delete phase"})}}function wa(e){switch(e){case"warm":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseWarm.minimumAgeLabel",{defaultMessage:"Timing for warm phase"});case"cold":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseCold.minimumAgeLabel",{defaultMessage:"Timing for cold phase"});case"frozen":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseFrozen.minimumAgeLabel",{defaultMessage:"Timing for frozen phase"});case"delete":return se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseDelete.minimumAgeLabel",{defaultMessage:"Timing for delete phase"})}}const La={rolloverToolTipDescription:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minimumAge.rolloverToolTipDescription",{defaultMessage:"Data age is calculated from rollover. Rollover is configured in the hot phase."}),minAgeUnitFieldSuffix:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minimumAge.minimumAgeFieldSuffixLabel",{defaultMessage:"old"})},Sa=({phase:e})=>{const t=`phases.${e}.min_age`,a=`_meta.${e}.minAgeUnit`,{isUsingRollover:s}=st(),n=bt(),{setValue:r}=n[`${e}MinAgeMilliSeconds`],[c]=Object(o.useFormData)({watch:[t,a]}),d=Object(W.get)(c,t),u=Object(W.get)(c,a);return Object(i.useEffect)((()=>{if(void 0===d)return;const e=""===d.trim()?-1:fe(d,u);r(e)}),[d,u,r]),Object(i.useEffect)((()=>()=>{r(-1)}),[r]),Object(M.jsx)(_t,{path:t},(t=>{const{isInvalid:i,errorMessage:n}=Object(o.getFieldValidityAndErrorMessage)(t);return Object(M.jsx)(j.EuiFormRow,{fullWidth:!0,isInvalid:i,error:n},Object(M.jsx)(j.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween",wrap:!0},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiText,{className:"eui-textNoWrap",size:"xs"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.minimumAge.minimumAgeFieldLabel",defaultMessage:"Move data into phase when:"}))),Object(M.jsx)(j.EuiFlexItem,{grow:!0},Object(M.jsx)(j.EuiFlexGroup,{gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiFieldNumber,{style:{minWidth:50},compressed:!0,"aria-label":wa(e),isInvalid:i,value:t.value,onChange:t.onChange,isLoading:t.isValidating,"data-test-subj":`${e}-selectedMinimumAge`,min:0})),Object(M.jsx)(j.EuiFlexItem,{grow:!0,style:{minWidth:165}},Object(M.jsx)(_t,{path:a},(t=>{const{isInvalid:a}=Object(o.getFieldValidityAndErrorMessage)(t),i=Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)("div",{"data-test-subj":`${e}-rolloverMinAgeInputIconTip`}),Object(M.jsx)(j.EuiIconTip,{type:"iInCircle","aria-label":La.rolloverToolTipDescription,content:La.rolloverToolTipDescription})),n=s?[La.minAgeUnitFieldSuffix,i]:[La.minAgeUnitFieldSuffix],r=t.value;let c=Te;return r&&!c.some((e=>e.value===r))&&(c=[...Te,{value:r,text:r}]),Object(M.jsx)(j.EuiSelect,{compressed:!0,value:r,onChange:e=>{t.setValue(e.target.value)},isInvalid:a,append:n,"data-test-subj":`${e}-selectedMinimumAgeUnits`,"aria-label":ka(e),options:c})})))))))}))},Ea="phases.delete.actions.wait_for_snapshot.policy",Fa=()=>{const{services:{docLinks:e,getUrlForApp:t}}=B(),{error:a,isLoading:i,data:s,resendRequest:n}=Object(ie.l)(),[r]=Object(o.useFormData)({watch:Ea}),d=Object(W.get)(r,Ea),u=s.map((e=>({label:e,value:e}))),m=()=>t("management",{path:"data/snapshot_restore/add_policy"});let p;return a?p=Object(M.jsx)(Ct,{resendRequest:n,"data-test-subj":"policiesErrorCallout","aria-label":se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.reloadPoliciesLabel",{defaultMessage:"Reload policies"}),title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesLoadedTitle",defaultMessage:"Unable to load existing policies"}),body:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesLoadedMessage",defaultMessage:"Refresh this field and enter the name of an existing snapshot policy."})}):0===s.length?p=Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"m"}),Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"noPoliciesCallout",color:"warning",title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedTitle",defaultMessage:"No snapshot policies found"})},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedMessage",defaultMessage:"{link} to automate the creation and deletion of cluster snapshots.",values:{link:Object(M.jsx)(j.EuiLink,{href:m(),target:"_blank"},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedLink",{defaultMessage:"Create a snapshot lifecycle policy"}))}}))):d&&!s.includes(d)&&(p=Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"m"}),Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"customPolicyCallout",color:"warning",title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyTitle",defaultMessage:"Policy name not found"})},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyMessage",defaultMessage:"Enter the name of an existing snapshot policy, or {link} with this name.",values:{link:Object(M.jsx)(j.EuiLink,{href:m(),target:"_blank"},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyLink",{defaultMessage:"create a new policy"}))}})))),Object(M.jsx)(j.EuiDescribedFormGroup,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotTitle",defaultMessage:"Wait for snapshot policy"})),description:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotDescription",defaultMessage:"Specify a snapshot policy to be executed before the deletion of the index. This ensures that a snapshot of the deleted index is available."})," ",Object(M.jsx)(wt,{docPath:e.links.elasticsearch.ilmWaitForSnapshot})),titleSize:"xs",fullWidth:!0},Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(_t,{path:Ea,componentProps:{label:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotLabel",defaultMessage:"Snapshot policy name"}),Object(M.jsx)(Lt,null))}},(e=>{const t=e.value?[e.value]:[];return Object(M.jsx)(c.ComboBoxField,{field:{...e,value:t},euiFieldProps:{"data-test-subj":"snapshotPolicyCombobox",fullWidth:!1,options:u,singleSelection:{asPlainText:!0},isLoading:i,noSuggestions:!(!a&&0!==s.length),onCreateOption:t=>{e.setValue(t)},onChange:t=>{t.length>0?e.setValue(t[0].label):e.setValue("")}}})})),p))},Ca=({path:e,options:t,euiFieldProps:a})=>{const[l,s]=Object(i.useState)(!1);return Object(M.jsx)(_t,{key:e,path:e},(e=>{var i,n;return Object(M.jsx)(j.EuiPopover,m()({button:Object(M.jsx)(j.EuiButtonEmpty,{size:"xs",color:"text",iconSide:"right",iconType:"arrowDown",onClick:()=>s((e=>!e)),"data-test-subj":"show-filters-button"},null!==(i=null===(n=t.find((t=>t.value===e.value)))||void 0===n?void 0:n.text)&&void 0!==i?i:`${e.value}`),ownFocus:!0,panelPaddingSize:"none",isOpen:l,closePopover:()=>s(!1)},a),t.map((t=>Object(M.jsx)(j.EuiFilterSelectItem,{key:t.value,checked:e.value===t.value?"on":void 0,onClick:()=>{return a=t.value,e.setValue(a),void s(!1);var a},"data-test-subj":`filter-option-${t.value}`},t.text))))}))},za=({phase:e})=>{var t,a;const i=bt(),{setValue:s}=i[`${e}IsUsingShardSize`],{policy:n}=Yt(),r=`_meta.${e}.shrink.isUsingShardSize`,[d]=Object(o.useFormData)({watch:[r]}),u=Object(W.get)(d,r),m=`phases.${e}.actions.shrink.${u?"max_primary_shard_size":"number_of_shards"}`,{docLinks:p}=B().services;return Object(M.jsx)(Et,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.shrinkText",defaultMessage:"Shrink"})),description:Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.shrinkIndexExplanationText",defaultMessage:"Shrink the index to a new index with fewer primary shards."})," ",Object(M.jsx)(wt,{docPath:p.links.elasticsearch.ilmShrink})),titleSize:"xs",switchProps:{"data-test-subj":`${e}-shrinkSwitch`,label:we.editPolicy.shrinkLabel,initialValue:Boolean(null===(t=n.phases[e])||void 0===t||null===(a=t.actions)||void 0===a?void 0:a.shrink)},fullWidth:!0},void 0===u?null:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiRadioGroup,{options:[{id:`${e}-configureShardCount`,label:we.editPolicy.shrinkCountLabel,"data-test-subj":`${e}-configureShardCount`},{id:`${e}-configureShardSize`,label:we.editPolicy.shrinkSizeLabel,"data-test-subj":`${e}-configureShardSize`}],idSelected:u?`${e}-configureShardSize`:`${e}-configureShardCount`,onChange:t=>s(t===`${e}-configureShardSize`)}),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(_t,{path:m,key:m,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-primaryShard${u?"Size":"Count"}`,min:1,append:u?Object(M.jsx)(Ca,{path:`_meta.${e}.shrink.maxPrimaryShardSizeUnits`,options:_e,euiFieldProps:{"data-test-subj":`${e}-shrinkMaxPrimaryShardSizeUnits`,"aria-label":we.editPolicy.maxPrimaryShardSizeUnitsLabel}}):null}}})))},Aa=({children:e})=>e(Object(ie.m)()),Da=({field:e,isLoading:t,repos:a,noSuggestions:l,globalRepository:s})=>{const n=Object(i.useRef)(!1),{setValue:o}=e,{searchableSnapshotRepo:{setValue:r}}=bt();return Object(i.useEffect)((()=>{n.current&&o(Boolean(s.trim())?[s]:[]),n.current=!0}),[o,s]),Object(M.jsx)(c.ComboBoxField,{field:e,fullWidth:!1,euiFieldProps:{"data-test-subj":"searchableSnapshotCombobox",options:a.map((e=>({label:e,value:e}))),singleSelection:{asPlainText:!0},isLoading:t,noSuggestions:l,onCreateOption:e=>{r(e)},onChange:e=>{e.length>0?r(e[0].label):r("")}}})};a(66);const Ia=({phase:e,canBeDisabled:t=!0})=>{const{services:{cloud:a,docLinks:s,getUrlForApp:n}}=B(),{policy:r,license:c,isNewPolicy:d}=Yt(),{isUsingSearchableSnapshotInHotPhase:u}=st(),m=`phases.${e}.actions.searchable_snapshot.snapshot_repository`,[p]=Object(o.useFormData)({watch:xt.searchableSnapshotRepo.path}),h=Object(W.get)(p,xt.searchableSnapshotRepo.path),x="cold"===e||"frozen"===e,g=!c.canUseSearchableSnapshot(),[b,f]=Object(i.useState)((()=>{var t,i,l;return Boolean(x&&d&&(null==a?void 0:a.isCloudEnabled)||(null===(t=r.phases[e])||void 0===t||null===(i=t.actions)||void 0===i||null===(l=i.searchable_snapshot)||void 0===l?void 0:l.snapshot_repository))})),y=s.links.elasticsearch.ilmSearchableSnapshot,v=s.links.elasticsearch.searchableSnapshotSharedCache,O=((e,t,a)=>{switch(e){case"hot":case"cold":return{title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.title",{defaultMessage:"Searchable snapshot"}),description:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.description",defaultMessage:"Convert to a fully-mounted index that contains a complete copy of your data and is backed by a snapshot. You can reduce the number of replicas and rely on the snapshot for resiliency. {learnMoreLink}",values:{learnMoreLink:Object(M.jsx)(wt,{docPath:t})}}),toggleLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.toggleLabel",{defaultMessage:"Convert to fully-mounted index"})};case"frozen":return{title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.partiallyMountedSearchableSnapshotField.title",{defaultMessage:"Searchable snapshot"}),description:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.frozenPhase.partiallyMountedSearchableSnapshotField.description",defaultMessage:"Convert to a partially-mounted index that caches the index metadata. Data is retrieved from the snapshot as needed to process search requests. This minimizes the index footprint while keeping all of your data fully searchable. {learnMoreLink}",values:{learnMoreLink:Object(M.jsx)(wt,{docPath:a})}}),toggleLabel:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.partiallyMountedSearchableSnapshotField.toggleLabel",{defaultMessage:"Convert to partially-mounted index"})}}})(e,y,v);return Object(i.useEffect)((()=>{g&&f(!1)}),[g]),Object(M.jsx)(Et,{"data-test-subj":`searchableSnapshotField-${e}`,switchProps:t?{checked:b,disabled:g,onChange:f,"data-test-subj":"searchableSnapshotToggle",label:O.toggleLabel}:void 0,title:Object(M.jsx)("h3",null,O.title),description:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiTextColor,{color:"subdued"},O.description)),fieldNotices:(()=>{let t;return"hot"===e&&u?t=Object(M.jsx)(j.EuiCallOut,{size:"s",title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotCalloutBody",{defaultMessage:"Force merge, shrink, downsample and read only actions are not allowed when converting data to a fully-mounted index in this phase."}),"data-test-subj":"searchableSnapshotFieldsDisabledCallout"}):g&&(t=Object(M.jsx)(j.EuiCallOut,{"data-test-subj":"searchableSnapshotDisabledDueToLicense",title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotLicenseCalloutTitle",{defaultMessage:"Enterprise license required"}),iconType:"questionInCircle"},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotLicenseCalloutBody",{defaultMessage:"To create a searchable snapshot an enterprise license is required."}))),t?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,null),t,Object(M.jsx)(j.EuiSpacer,null)):void 0})(),fullWidth:!0},g?Object(M.jsx)("div",null):()=>Object(M.jsx)(Aa,null,(({error:e,isLoading:t,resendRequest:a,data:i})=>{var s;const o=null!==(s=null==i?void 0:i.repositories)&&void 0!==s?s:[];let r;return t||(e?r=Object(M.jsx)(Ct,{resendRequest:a,"data-test-subj":"repositoriesErrorCallout","aria-label":se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.reloadSnapshotRepositoriesLabel",{defaultMessage:"Reload snapshot repositories"}),title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.loadSnapshotRepositoriesErrorTitle",defaultMessage:"Unable to load snapshot repositories"}),body:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.loadSnapshotRepositoriesErrorBody",defaultMessage:"Refresh this field and enter the name of an existing snapshot repository."})}):0===o.length?r=Object(M.jsx)(j.EuiCallOut,{color:"warning",title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesTitle",{defaultMessage:"No snapshot repositories found"})},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesFoundBody",defaultMessage:"{link} to use searchable snapshots.",values:{link:Object(M.jsx)(j.EuiLink,{href:n("management",{path:"data/snapshot_restore/add_repository"}),target:"_blank"},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createSearchableSnapshotLink",{defaultMessage:"Create a snapshot repository"}))}})):h&&!o.includes(h)&&(r=Object(M.jsx)(j.EuiCallOut,{title:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesWithNameTitle",{defaultMessage:"Repository name not found"}),color:"warning"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoryWithNameBody",defaultMessage:"Enter the name of an existing repository, or {link} with this name.",values:{link:Object(M.jsx)(j.EuiLink,{href:n("management",{path:"data/snapshot_restore/add_repository"}),target:"_blank"},se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createSnapshotRepositoryLink",{defaultMessage:"create a new snapshot repository"}))}})))),Object(M.jsx)("div",{className:"ilmSearchableSnapshotField"},Object(M.jsx)(_t,{path:m,defaultValue:h?[h]:[],component:Da,componentProps:{globalRepository:h,isLoading:t,repos:o,noSuggestions:!(!e&&0!==o.length)}}),r&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),r))})))},Na=({phase:e})=>{const{docLinks:t}=B().services;return Object(M.jsx)(Ft,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.readonlyTitle",defaultMessage:"Read only"})),description:Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.readonlyDescription",defaultMessage:"Enable to make the index and index metadata read only, disable to allow writes and metadata changes."})," ",Object(M.jsx)(wt,{docPath:t.links.elasticsearch.ilmReadOnly})),fullWidth:!0,titleSize:"xs",switchProps:{"data-test-subj":`${e}-readonlySwitch`,path:`_meta.${e}.readonlyEnabled`}},Object(M.jsx)("div",null))},Ra=({phase:e})=>{var t,a,i;const{policy:l}=Yt(),s=null!=(null===(t=l.phases[e])||void 0===t||null===(a=t.actions)||void 0===a||null===(i=a.allocate)||void 0===i?void 0:i.number_of_replicas);return Object(M.jsx)(Et,{title:Object(M.jsx)("h3",null,se.i18n.translate("xpack.indexLifecycleMgmt.numberOfReplicas.formRowTitle",{defaultMessage:"Replicas"})),description:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicas.formRowDescription",{defaultMessage:"Set the number of replicas. Remains the same as the previous phase by default."}),switchProps:{"data-test-subj":`${e}-setReplicasSwitch`,label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicas.switchLabel",{defaultMessage:"Set replicas"}),initialValue:s},fullWidth:!0},Object(M.jsx)(_t,{path:`phases.${e}.actions.allocate.number_of_replicas`,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-selectedReplicaCount`,min:0}}}))},Ua=({phase:e})=>{const{policy:t,isNewPolicy:a}=Yt(),l=Object(i.useMemo)((()=>{var i,l,s;return a||!(null!==(i=t.phases[e])&&void 0!==i&&i.actions)||null!=(null===(l=t.phases[e])||void 0===l||null===(s=l.actions)||void 0===s?void 0:s.set_priority)}),[a,t.phases,e]),{docLinks:s}=B().services;return Object(M.jsx)(Et,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.indexPriorityText",defaultMessage:"Index priority"})),description:Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.warmPhase.indexPriorityExplanationText",defaultMessage:"Set the priority for recovering your indices after a node restart. Indices with higher priorities are recovered before indices with lower priorities."})," ",Object(M.jsx)(wt,{docPath:s.links.elasticsearch.ilmSetPriority})),titleSize:"xs",fullWidth:!0,switchProps:{label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.indexPriority.indexPriorityEnabledFieldLabel",{defaultMessage:"Set index priority"}),"data-test-subj":`${e}-indexPrioritySwitch`,initialValue:l}},Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(_t,{path:`phases.${e}.actions.set_priority.priority`,component:c.NumericField,euiFieldProps:{fullWidth:!1,"data-test-subj":`${e}-indexPriority`,min:0}}))},Ba=({phase:e})=>{const t=`_meta.${e}.downsample.enabled`,a=`_meta.${e}.downsample.fixedIntervalSize`,i=`_meta.${e}.downsample.fixedIntervalUnits`;return Object(M.jsx)(Ft,{title:Object(M.jsx)("h3",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.downsampleTitle",defaultMessage:"Downsample"})),description:Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.downsampleDescription",defaultMessage:"Roll up documents within a fixed interval to a single summary document. Reduces the index footprint by storing time series data at reduced granularity."})," "),fullWidth:!0,titleSize:"xs",switchProps:{"data-test-subj":`${e}-downsampleSwitch`,path:t}},Object(M.jsx)(_t,{path:a,key:a,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-downsampleFixedInterval`,min:1,append:Object(M.jsx)(Ca,{path:i,options:Te,euiFieldProps:{"data-test-subj":`${e}-downsampleFixedIntervalUnits`,"aria-label":we.editPolicy.downsampleIntervalFieldUnitsLabel}})}}}))};a(71);const $a=({enabled:e,phase:t})=>Object(M.jsx)("div",{className:`ilmPhaseIcon ilmPhaseIcon--${t} ${e?"":"ilmPhaseIcon--disabled"}`},e?Object(M.jsx)(j.EuiIcon,{className:`ilmPhaseIcon__inner--${t}`,type:"delete"===t?"trash":"checkInCircleFilled",size:"delete"===t?"m":"l"}):Object(M.jsx)(j.EuiIcon,{className:"ilmPhaseIcon__inner--disabled",type:"dot",size:"s"}));a(76),a(81);const qa=({phase:e})=>{const t=`_meta.${e}.enabled`,[a]=Object(o.useFormData)({watch:[t]}),i="hot"===e,l="delete"===e,{setDeletePhaseEnabled:s}=pt(),n=Object(W.get)(a,t)||i,{errors:r}=ct(),d=Object.keys(r[e]).length>0;return Object(M.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween"},Object(M.jsx)(j.EuiFlexItem,{grow:!0},Object(M.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0},!i&&!l&&Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(_t,{path:t,component:c.ToggleField,componentProps:{euiFieldProps:{"data-test-subj":`enablePhaseSwitch-${e}`,showLabel:!1}}})),Object(M.jsx)(j.EuiFlexItem,{grow:!1,className:"ilmPhaseTitle"},Object(M.jsx)(j.EuiTitle,{size:"s"},Object(M.jsx)("h2",null,we.editPolicy.titles[e]))),i&&Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiBadge,{className:"ilmPhaseRequiredBadge"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.phaseTitle.requiredBadge",defaultMessage:"Required"}))),l&&Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiButtonEmpty,{onClick:()=>s(!1),"data-test-subj":"disableDeletePhaseButton"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.removeDeletePhaseButtonLabel",defaultMessage:"Remove"}))),d&&Object(M.jsx)(j.EuiFlexItem,{grow:!1,"data-test-subj":`phaseErrorIndicator-${e}`},Object(M.jsx)(j.EuiIconTip,{type:"warning",color:"danger",content:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.phaseErrorIcon.tooltipDescription",defaultMessage:"This phase contains errors."})})))),!i&&n&&Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(Sa,{phase:e})))},Va=({children:e,topLevelSettings:t,phase:a})=>{const i=`_meta.${a}.enabled`,[s]=Object(o.useFormData)({watch:[i]}),n="hot"===a,r="delete"===a,c=Object(W.get)(s,i)||n;return r&&!c?null:Object(M.jsx)(j.EuiTimelineItem,{icon:Object(M.jsx)($a,{enabled:c,phase:a}),verticalAlign:"top","data-test-subj":`${a}-phase`},Object(M.jsx)(j.EuiSplitPanel.Outer,{color:"transparent",hasBorder:!0,grow:!0},Object(M.jsx)(j.EuiSplitPanel.Inner,{color:c?"transparent":"subdued"},Object(M.jsx)(qa,{phase:a})),Object(M.jsx)(j.EuiHorizontalRule,{margin:"none"}),Object(M.jsx)(j.EuiSplitPanel.Inner,null,Object(M.jsx)(j.EuiText,{color:"subdued",size:"s",style:{maxWidth:"50%"}},we.editPolicy.descriptions[a]),c&&Object(M.jsx)(l.a.Fragment,null,t?Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,null),t):Object(M.jsx)(j.EuiSpacer,{size:"m"}),e?Object(M.jsx)(j.EuiAccordion,{id:`${a}-settingsSwitch`,className:"ilmSettingsAccordion",buttonContent:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.phaseSettings.buttonLabel",defaultMessage:"Advanced settings"}),buttonClassName:"ilmSettingsButton",extraAction:!r&&Object(M.jsx)(Ht,{phase:a})},Object(M.jsx)(j.EuiSpacer,null),e):!r&&Object(M.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(Ht,{phase:a})))))))},Wa=Object.values(Me),Ha=()=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(M.jsx)(_t,{path:Me.maxPrimaryShardSize,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardSize",min:1,append:Object(M.jsx)(Ca,{path:"_meta.hot.customRollover.maxPrimaryShardSizeUnit",options:_e,euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardSizeUnits","aria-label":we.editPolicy.maxPrimaryShardSizeUnitsLabel}})}}}))),Ga=()=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(M.jsx)(_t,{path:Me.maxPrimaryShardDocs,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardDocs",min:1}}}))),Ka=()=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(M.jsx)(_t,{path:Me.maxAge,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxAge",min:1,append:Object(M.jsx)(Ca,{path:"_meta.hot.customRollover.maxAgeUnit",options:Te,euiFieldProps:{"data-test-subj":"hot-selectedMaxAgeUnits","aria-label":se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumAgeUnitsAriaLabel",{defaultMessage:"Maximum age units"})}})}}}))),Ja=()=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(M.jsx)(_t,{path:Me.maxDocs,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxDocuments",min:1}}}))),Ya={deprecationMessage:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeDeprecationMessage",{defaultMessage:"Maximum index size is deprecated and will be removed in a future version. Use maximum primary shard size instead."}),maxSizeUnit:{ariaLabel:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeUnitsAriaLabel",{defaultMessage:"Maximum index size units"})}},Qa=()=>Object(M.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(M.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(M.jsx)(_t,{path:Me.maxSize,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxSizeStored",min:1,prepend:Object(M.jsx)(j.EuiIconTip,{type:"warning","aria-label":Ya.deprecationMessage,content:Ya.deprecationMessage}),append:Object(M.jsx)(Ca,{path:"_meta.hot.customRollover.maxStorageSizeUnit",options:_e,euiFieldProps:{"data-test-subj":"hot-selectedMaxSizeStoredUnits","aria-label":Ya.maxSizeUnit.ariaLabel}})}}}))),Za=Object.values(Me),Xa=()=>{const{license:e}=Yt(),[t]=Object(o.useFormData)({watch:[ve,...Za]}),{isUsingRollover:a,isUsingDownsampleInHotPhase:s}=st(),n=Object(W.get)(t,ve),r=(()=>{const[e,t]=Object(i.useState)(!1),[a]=Object(o.useFormData)({watch:Wa}),{getFields:l}=Object(o.useFormContext)();return Object(i.useEffect)((()=>{var e,a;const i=null!==(e=null===(a=Object(W.get)(l(),Me.maxPrimaryShardSize))||void 0===a?void 0:a.errors)&&void 0!==e?e:[];t(i.some((e=>e.code===De)))}),[l,a]),e})(),{docLinks:c}=B().services;return Object(M.jsx)(Va,{phase:"hot"},Object(M.jsx)(Et,{title:Object(M.jsx)("h3",null,se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.rolloverFieldTitle",{defaultMessage:"Rollover"})),description:Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.rolloverDescriptionMessage",defaultMessage:"Start writing to a new index when the current index reaches a certain size, document count, or age. Enables you to optimize performance and manage resource usage when working with time series data."}))),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(j.EuiTextColor,{color:"subdued"},Object(M.jsx)("p",null,Object(M.jsx)("strong",null,se.i18n.translate("xpack.indexLifecycleMgmt.rollover.rolloverOffsetsPhaseTimingDescriptionNote",{defaultMessage:"Note: "})),we.editPolicy.rolloverOffsetsHotPhaseTiming," ",Object(M.jsx)(wt,{text:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.learnAboutRolloverLinkText",defaultMessage:"Learn more"}),docPath:c.links.elasticsearch.ilmRollover}))),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(_t,{path:ve},(e=>Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiText,{color:"default"},Object(M.jsx)(j.EuiSwitch,{label:e.label,checked:e.value,onChange:t=>e.setValue(t.target.checked),"data-test-subj":"useDefaultRolloverSwitch"})),Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.rolloverDefaultsTipContent",defaultMessage:"Roll over when an index is 30 days old or any primary shard reaches 50 gigabytes."}))))),fullWidth:!0},!1===n?Object(M.jsx)("div",{"aria-live":"polite",role:"region"},Object(M.jsx)(_t,{path:"_meta.hot.customRollover.enabled"},(e=>Object(M.jsx)(j.EuiSwitch,{label:e.label,checked:e.value,onChange:t=>e.setValue(t.target.checked),"data-test-subj":"rolloverSwitch"}))),a&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"m"}),r&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiCallOut,{size:"s",title:we.editPolicy.errors.rollOverConfigurationCallout.title,"data-test-subj":"rolloverSettingsRequired",color:"danger"},Object(M.jsx)("div",null,we.editPolicy.errors.rollOverConfigurationCallout.body)),Object(M.jsx)(j.EuiSpacer,{size:"s"})),Object(M.jsx)(Ha,null),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(Ga,null),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(Ka,null),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(Ja,null),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(Qa,null))):Object(M.jsx)("div",null)),a&&Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(Ta,{phase:"hot"}),Object(M.jsx)(za,{phase:"hot"}),e.canUseSearchableSnapshot()&&Object(M.jsx)(Ia,{phase:"hot"}),Object(M.jsx)(Ba,{phase:"hot"}),!s&&Object(M.jsx)(Na,{phase:"hot"})),Object(M.jsx)(Ua,{phase:"hot"}))},ei={dataTierAllocation:{description:se.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.description",{defaultMessage:"Move data to nodes optimized for less-frequent, read-only access."})}},ti=()=>{const{isUsingSearchableSnapshotInHotPhase:e,isUsingDownsampleInHotPhase:t,isUsingDownsampleInWarmPhase:a}=st();return Object(M.jsx)(Va,{phase:"warm"},Object(M.jsx)(Ra,{phase:"warm"}),!e&&Object(M.jsx)(za,{phase:"warm"}),!e&&Object(M.jsx)(Ta,{phase:"warm"}),!e&&Object(M.jsx)(Ba,{phase:"warm"}),!e&&!t&&!a&&Object(M.jsx)(Na,{phase:"warm"}),Object(M.jsx)(Pa,{description:ei.dataTierAllocation.description,phase:"warm"}),Object(M.jsx)(Ua,{phase:"warm"}))},ai={dataTierAllocation:{description:se.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.description",{defaultMessage:"Move data to nodes optimized for less frequent, read-only access. Store data in the cold phase on less-expensive hardware."})}},ii=()=>{const{isUsingSearchableSnapshotInHotPhase:e,isUsingDownsampleInHotPhase:t,isUsingDownsampleInWarmPhase:a,isUsingDownsampleInColdPhase:i}=st();return Object(M.jsx)(Va,{phase:"cold",topLevelSettings:Object(M.jsx)(Ia,{phase:"cold"})},Object(M.jsx)(Ra,{phase:"cold"}),!e&&Object(M.jsx)(Ba,{phase:"cold"}),!e&&!t&&!a&&!i&&Object(M.jsx)(Na,{phase:"cold"}),Object(M.jsx)(Pa,{description:ai.dataTierAllocation.description,phase:"cold"}),Object(M.jsx)(Ua,{phase:"cold"}))},li=()=>Object(M.jsx)(Va,{phase:"frozen",topLevelSettings:Object(M.jsx)(Ia,{phase:"frozen",canBeDisabled:!1})}),si=()=>Object(M.jsx)(Va,{phase:"delete",topLevelSettings:Object(M.jsx)(Fa,null)}),ni="name",oi=()=>{Object(i.useEffect)((()=>{window.scrollTo(0,0)}),[]);const[e,t]=Object(i.useState)(!1),{isNewPolicy:a,policy:s,existingPolicies:n,policyName:r,license:d}=Yt(),{services:{cloud:u,docLinks:m,history:p,navigateToUrl:h,overlays:x,http:g}}=B(),[b,f]=Object(i.useState)(!1),[y,v]=Object(i.useState)(!1),O=a?"":r,P=d.canUseSearchableSnapshot(),_=Boolean(null==u?void 0:u.isCloudEnabled),T=Object(i.useMemo)((()=>{return e=a?void 0:s,t=>{const{_meta:a,...i}=t;return i.phases={hot:{actions:{}},...i.phases},Object(ue.produce)(null!=e?e:ee.o,(t=>{var l,s,n;Object(W.merge)(t,i);const o=Boolean((null===(l=a.hot)||void 0===l?void 0:l.isUsingDefaultRollover)||(null===(s=a.hot)||void 0===s?void 0:s.customRollover.enabled));var r,c;if(t.phases.hot&&(t.phases.hot.min_age=null!==(r=t.phases.hot.min_age)&&void 0!==r?r:"0ms",null!==(c=t.phases.hot)&&void 0!==c&&c.actions)){var d,u;const e=t.phases.hot.actions;if(o){var m,p,h,x,g,b,f,j,y,v,O,M,P,_,T,k,w,L;if(null!==(m=a.hot)&&void 0!==m&&m.isUsingDefaultRollover?e.rollover=Object(W.cloneDeep)(ee.p):(e.rollover||(e.rollover={}),null!==(O=i.phases.hot.actions.rollover)&&void 0!==O&&O.max_age?e.rollover.max_age=`${e.rollover.max_age}${null===(k=a.hot)||void 0===k?void 0:k.customRollover.maxAgeUnit}`:delete e.rollover.max_age,"number"!=typeof(null===(M=i.phases.hot.actions.rollover)||void 0===M?void 0:M.max_docs)&&delete e.rollover.max_docs,null!==(P=i.phases.hot.actions.rollover)&&void 0!==P&&P.max_primary_shard_size?e.rollover.max_primary_shard_size=`${e.rollover.max_primary_shard_size}${null===(w=a.hot)||void 0===w?void 0:w.customRollover.maxPrimaryShardSizeUnit}`:delete e.rollover.max_primary_shard_size,"number"!=typeof(null===(_=i.phases.hot.actions.rollover)||void 0===_?void 0:_.max_primary_shard_docs)&&delete e.rollover.max_primary_shard_docs,null!==(T=i.phases.hot.actions.rollover)&&void 0!==T&&T.max_size?e.rollover.max_size=`${e.rollover.max_size}${null===(L=a.hot)||void 0===L?void 0:L.customRollover.maxStorageSizeUnit}`:delete e.rollover.max_size),null!==(p=i.phases.hot.actions)&&void 0!==p&&p.forcemerge?null!==(h=a.hot)&&void 0!==h&&h.bestCompression?e.forcemerge.index_codec="best_compression":delete e.forcemerge.index_codec:delete e.forcemerge,null!==(x=a.hot)&&void 0!==x&&x.bestCompression&&e.forcemerge&&(e.forcemerge.index_codec="best_compression"),null!==(g=a.hot)&&void 0!==g&&g.readonlyEnabled?e.readonly=null!==(v=e.readonly)&&void 0!==v?v:{}:delete e.readonly,null!==(b=i.phases.hot)&&void 0!==b&&null!==(f=b.actions)&&void 0!==f&&f.shrink)if(a.hot.shrink.isUsingShardSize){var S,E;delete e.shrink.number_of_shards,e.shrink.max_primary_shard_size=`${null===(S=e.shrink)||void 0===S?void 0:S.max_primary_shard_size}${null===(E=a.hot)||void 0===E?void 0:E.shrink.maxPrimaryShardSizeUnits}`}else delete e.shrink.max_primary_shard_size;else delete e.shrink;null!==(j=a.hot)&&void 0!==j&&null!==(y=j.downsample)&&void 0!==y&&y.enabled?e.downsample={...e.downsample,fixed_interval:`${a.hot.downsample.fixedIntervalSize}${a.hot.downsample.fixedIntervalUnits}`}:delete e.downsample}else delete e.rollover,delete e.forcemerge,delete e.readonly,delete e.shrink;null!==(d=i.phases.hot.actions)&&void 0!==d&&d.set_priority||delete e.set_priority,null!==(u=i.phases.hot.actions)&&void 0!==u&&u.searchable_snapshot?e.searchable_snapshot={...e.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete e.searchable_snapshot}if(a.warm.enabled){var F,C,z,A,D,I,N,R,U,B,$,q,V,H,G;t.phases.warm.actions=null!==(F=null===(C=t.phases.warm)||void 0===C?void 0:C.actions)&&void 0!==F?F:{};const l=t.phases.warm;var K;if(null!==(z=i.phases.warm)&&void 0!==z&&z.min_age&&(l.min_age=`${i.phases.warm.min_age}${a.warm.minAgeUnit}`),l.actions=ke(a.warm,l.actions,null==e||null===(A=e.phases.warm)||void 0===A?void 0:A.actions,null===(D=i.phases.warm)||void 0===D||null===(I=D.actions)||void 0===I||null===(N=I.allocate)||void 0===N?void 0:N.number_of_replicas),null!==(R=i.phases.warm)&&void 0!==R&&null!==(U=R.actions)&&void 0!==U&&U.forcemerge?a.warm.bestCompression?l.actions.forcemerge.index_codec="best_compression":delete l.actions.forcemerge.index_codec:delete l.actions.forcemerge,a.warm.readonlyEnabled?l.actions.readonly=null!==(K=l.actions.readonly)&&void 0!==K?K:{}:delete l.actions.readonly,null!==(B=i.phases.warm)&&void 0!==B&&null!==($=B.actions)&&void 0!==$&&$.set_priority||delete l.actions.set_priority,null!==(q=i.phases.warm)&&void 0!==q&&null!==(V=q.actions)&&void 0!==V&&V.shrink)if(a.warm.shrink.isUsingShardSize){var J,Y;delete l.actions.shrink.number_of_shards,l.actions.shrink.max_primary_shard_size=`${null===(J=l.actions.shrink)||void 0===J?void 0:J.max_primary_shard_size}${null===(Y=a.warm)||void 0===Y?void 0:Y.shrink.maxPrimaryShardSizeUnits}`}else delete l.actions.shrink.max_primary_shard_size;else delete l.actions.shrink;null!==(H=a.warm)&&void 0!==H&&null!==(G=H.downsample)&&void 0!==G&&G.enabled?l.actions.downsample={...l.actions.downsample,fixed_interval:`${a.warm.downsample.fixedIntervalSize}${a.warm.downsample.fixedIntervalUnits}`}:delete l.actions.downsample}else delete t.phases.warm;if(a.cold.enabled){var Q,Z,X,te,ae,ie,le,se,ne,oe,re,ce,de;t.phases.cold.actions=null!==(Q=null===(Z=t.phases.cold)||void 0===Z?void 0:Z.actions)&&void 0!==Q?Q:{};const l=t.phases.cold;var ue;null!==(X=i.phases.cold)&&void 0!==X&&X.min_age&&(l.min_age=`${i.phases.cold.min_age}${a.cold.minAgeUnit}`),l.actions=ke(a.cold,l.actions,null==e||null===(te=e.phases.cold)||void 0===te?void 0:te.actions,null===(ae=i.phases.cold)||void 0===ae||null===(ie=ae.actions)||void 0===ie||null===(le=ie.allocate)||void 0===le?void 0:le.number_of_replicas),l.actions.freeze&&delete l.actions.freeze,a.cold.readonlyEnabled?l.actions.readonly=null!==(ue=l.actions.readonly)&&void 0!==ue?ue:{}:delete l.actions.readonly,null!==(se=i.phases.cold)&&void 0!==se&&null!==(ne=se.actions)&&void 0!==ne&&ne.set_priority||delete l.actions.set_priority,null!==(oe=i.phases.cold)&&void 0!==oe&&null!==(re=oe.actions)&&void 0!==re&&re.searchable_snapshot?l.actions.searchable_snapshot={...l.actions.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete l.actions.searchable_snapshot,null!==(ce=a.cold)&&void 0!==ce&&null!==(de=ce.downsample)&&void 0!==de&&de.enabled?l.actions.downsample={...l.actions.downsample,fixed_interval:`${a.cold.downsample.fixedIntervalSize}${a.cold.downsample.fixedIntervalUnits}`}:delete l.actions.downsample}else delete t.phases.cold;if(null!==(n=a.frozen)&&void 0!==n&&n.enabled){var me,pe,he,xe,ge;t.phases.frozen.actions=null!==(me=null===(pe=t.phases.frozen)||void 0===pe?void 0:pe.actions)&&void 0!==me?me:{};const e=t.phases.frozen;null!==(he=i.phases.frozen)&&void 0!==he&&he.min_age&&(e.min_age=`${i.phases.frozen.min_age}${a.frozen.minAgeUnit}`),null!==(xe=i.phases.frozen)&&void 0!==xe&&null!==(ge=xe.actions)&&void 0!==ge&&ge.searchable_snapshot?e.actions.searchable_snapshot={...e.actions.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete e.actions.searchable_snapshot}else delete t.phases.frozen;if(a.delete.enabled){var be,fe,je,ye,ve;const e=t.phases.delete;e.actions=null!==(be=e.actions)&&void 0!==be?be:{},e.actions.delete=null!==(fe=e.actions.delete)&&void 0!==fe?fe:{},null!==(je=i.phases.delete)&&void 0!==je&&je.min_age&&(e.min_age=`${i.phases.delete.min_age}${a.delete.minAgeUnit}`),null!==(ye=i.phases.delete)&&void 0!==ye&&null!==(ve=ye.actions)&&void 0!==ve&&ve.wait_for_snapshot||delete e.actions.wait_for_snapshot}else delete t.phases.delete}))};var e}),[a,s]),k=Object(i.useMemo)((()=>(e=>t=>{var a,i,l,s,n,o,r,c,d,u,m,p,h;const{phases:{hot:x,warm:g,cold:b,frozen:f,delete:j}}=t;let y=je([null==x?void 0:x.actions.searchable_snapshot,null==b?void 0:b.actions.searchable_snapshot,null==f?void 0:f.actions.searchable_snapshot]);!y&&e&&(y=Pe);const v={hot:{isUsingDefaultRollover:pe(t),customRollover:{enabled:Boolean(null==x||null===(a=x.actions)||void 0===a?void 0:a.rollover)},bestCompression:"best_compression"===(null==x||null===(i=x.actions)||void 0===i||null===(l=i.forcemerge)||void 0===l?void 0:l.index_codec),readonlyEnabled:Boolean(null==x||null===(s=x.actions)||void 0===s?void 0:s.readonly),shrink:{isUsingShardSize:Boolean(null==x||null===(n=x.actions.shrink)||void 0===n?void 0:n.max_primary_shard_size)},downsample:{enabled:Boolean(null==x||null===(o=x.actions)||void 0===o?void 0:o.downsample)}},warm:{enabled:Boolean(g),warmPhaseOnRollover:void 0===g||Boolean("0ms"===g.min_age),bestCompression:"best_compression"===(null==g||null===(r=g.actions)||void 0===r||null===(c=r.forcemerge)||void 0===c?void 0:c.index_codec),dataTierAllocationType:me(null==g?void 0:g.actions),readonlyEnabled:Boolean(null==g||null===(d=g.actions)||void 0===d?void 0:d.readonly),minAgeToMilliSeconds:-1,shrink:{isUsingShardSize:Boolean(null==g||null===(u=g.actions.shrink)||void 0===u?void 0:u.max_primary_shard_size)},downsample:{enabled:Boolean(null==g||null===(m=g.actions)||void 0===m?void 0:m.downsample)}},cold:{enabled:Boolean(b),dataTierAllocationType:me(null==b?void 0:b.actions),readonlyEnabled:Boolean(null==b||null===(p=b.actions)||void 0===p?void 0:p.readonly),minAgeToMilliSeconds:-1,downsample:{enabled:Boolean(null==b||null===(h=b.actions)||void 0===h?void 0:h.downsample)}},frozen:{enabled:Boolean(f),dataTierAllocationType:me(null==f?void 0:f.actions),minAgeToMilliSeconds:-1},delete:{enabled:Boolean(j),minAgeToMilliSeconds:-1},searchableSnapshot:{repository:y}};return Object(ue.produce)({...t,_meta:v},(e=>{var t,a,i,l,s,n;if(null!==(t=e.phases.hot)&&void 0!==t&&null!==(a=t.actions)&&void 0!==a&&a.rollover){if(e.phases.hot.actions.rollover.max_size){const t=le(e.phases.hot.actions.rollover.max_size);e.phases.hot.actions.rollover.max_size=t.size,e._meta.hot.customRollover.maxStorageSizeUnit=t.units}if(e.phases.hot.actions.rollover.max_primary_shard_size){const t=le(e.phases.hot.actions.rollover.max_primary_shard_size);e.phases.hot.actions.rollover.max_primary_shard_size=t.size,e._meta.hot.customRollover.maxPrimaryShardSizeUnit=t.units}if(e.phases.hot.actions.rollover.max_age){const t=le(e.phases.hot.actions.rollover.max_age);e.phases.hot.actions.rollover.max_age=t.size,e._meta.hot.customRollover.maxAgeUnit=t.units}}if(null!==(i=e.phases.hot)&&void 0!==i&&null!==(l=i.actions.shrink)&&void 0!==l&&l.max_primary_shard_size){const t=le(e.phases.hot.actions.shrink.max_primary_shard_size);e.phases.hot.actions.shrink.max_primary_shard_size=t.size,e._meta.hot.shrink.maxPrimaryShardSizeUnits=t.units}if(null!==(s=e.phases.hot)&&void 0!==s&&null!==(n=s.actions.downsample)&&void 0!==n&&n.fixed_interval){const t=le(e.phases.hot.actions.downsample.fixed_interval);e._meta.hot.downsample.fixedIntervalUnits=t.units,e._meta.hot.downsample.fixedIntervalSize=t.size}if(e.phases.warm){var o,r,c,d,u;if(null!==(o=e.phases.warm.actions)&&void 0!==o&&null!==(r=o.allocate)&&void 0!==r&&r.require&&Object.entries(e.phases.warm.actions.allocate.require).forEach((t=>{e._meta.warm.allocationNodeAttribute=t.join(":")})),e.phases.warm.min_age){const t=le(e.phases.warm.min_age);e.phases.warm.min_age=t.size,e._meta.warm.minAgeUnit=t.units}if(null!==(c=e.phases.warm.actions.shrink)&&void 0!==c&&c.max_primary_shard_size){const t=le(e.phases.warm.actions.shrink.max_primary_shard_size);e.phases.warm.actions.shrink.max_primary_shard_size=t.size,e._meta.warm.shrink.maxPrimaryShardSizeUnits=t.units}if(null!==(d=e.phases.warm)&&void 0!==d&&null!==(u=d.actions.downsample)&&void 0!==u&&u.fixed_interval){const t=le(e.phases.warm.actions.downsample.fixed_interval);e._meta.warm.downsample.fixedIntervalUnits=t.units,e._meta.warm.downsample.fixedIntervalSize=t.size}}if(e.phases.cold){var m,p,h,x;if(null!==(m=e.phases.cold.actions)&&void 0!==m&&null!==(p=m.allocate)&&void 0!==p&&p.require&&Object.entries(e.phases.cold.actions.allocate.require).forEach((t=>{e._meta.cold.allocationNodeAttribute=t.join(":")})),e.phases.cold.min_age){const t=le(e.phases.cold.min_age);e.phases.cold.min_age=t.size,e._meta.cold.minAgeUnit=t.units}if(null!==(h=e.phases.cold)&&void 0!==h&&null!==(x=h.actions.downsample)&&void 0!==x&&x.fixed_interval){const t=le(e.phases.cold.actions.downsample.fixed_interval);e._meta.cold.downsample.fixedIntervalUnits=t.units,e._meta.cold.downsample.fixedIntervalSize=t.size}}if(e.phases.frozen&&e.phases.frozen.min_age){const t=le(e.phases.frozen.min_age);e.phases.frozen.min_age=t.size,e._meta.frozen.minAgeUnit=t.units}if(e.phases.delete&&e.phases.delete.min_age){const t=le(e.phases.delete.min_age);e.phases.delete.min_age=t.size,e._meta.delete.minAgeUnit=t.units}}))})(_)),[_]),w=Object(i.useMemo)((()=>({...s,name:O})),[s,O]),L=Object(i.useMemo)((()=>(e=>({_meta:{hot:{isUsingDefaultRollover:{defaultValue:!0,label:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.isUsingDefaultRollover",{defaultMessage:"Use recommended defaults"})},customRollover:{enabled:{defaultValue:!0,label:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.enableRolloverLabel",{defaultMessage:"Enable rollover"})},maxStorageSizeUnit:{defaultValue:"gb"},maxPrimaryShardSizeUnit:{defaultValue:"gb"},maxAgeUnit:{defaultValue:"d"}},bestCompression:{label:we.editPolicy.bestCompressionFieldLabel},readonlyEnabled:{defaultValue:!1,label:we.editPolicy.readonlyEnabledFieldLabel},shrink:{isUsingShardSize:{defaultValue:!1},maxPrimaryShardSizeUnits:{defaultValue:"gb"}},downsample:et("hot")},warm:{enabled:{defaultValue:!1,label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.activateWarmPhaseSwitchLabel",{defaultMessage:"Activate warm phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.warm.min_age","phases.cold.min_age","phases.frozen.min_age","phases.delete.min_age"]},bestCompression:{label:we.editPolicy.bestCompressionFieldLabel},dataTierAllocationType:{label:we.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:we.editPolicy.allocationNodeAttributeFieldLabel},readonlyEnabled:{defaultValue:!1,label:we.editPolicy.readonlyEnabledFieldLabel},shrink:{isUsingShardSize:{defaultValue:!1},maxPrimaryShardSizeUnits:{defaultValue:"gb"}},downsample:et("warm")},cold:{enabled:{defaultValue:!1,label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.activateColdPhaseSwitchLabel",{defaultMessage:"Activate cold phase"})},readonlyEnabled:{defaultValue:!1,label:we.editPolicy.readonlyEnabledFieldLabel},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.cold.min_age","phases.frozen.min_age","phases.delete.min_age"]},dataTierAllocationType:{label:we.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:we.editPolicy.allocationNodeAttributeFieldLabel},downsample:et("cold")},frozen:{enabled:{defaultValue:!1,label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.activateFrozenPhaseSwitchLabel",{defaultMessage:"Activate frozen phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.frozen.min_age","phases.delete.min_age"]},dataTierAllocationType:{label:we.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:we.editPolicy.allocationNodeAttributeFieldLabel}},delete:{enabled:{defaultValue:!1,label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.activateWarmPhaseSwitchLabel",{defaultMessage:"Activate delete phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.delete.min_age"]}},searchableSnapshot:{repository:{defaultValue:e?Pe:""}}},phases:{hot:{actions:{rollover:{max_age:{label:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumAgeLabel",{defaultMessage:"Maximum age"}),validations:[{validator:Ne},{validator:ze},{validator:Re}],fieldsToValidateOnChange:$e},max_docs:{label:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumDocumentsLabel",{defaultMessage:"Maximum documents"}),validations:[{validator:Ne},{validator:ze},{validator:Re}],serializer:We.stringToNumber,fieldsToValidateOnChange:$e},max_primary_shard_size:{label:we.editPolicy.maxPrimaryShardSizeLabel,validations:[{validator:Ne},{validator:ze}],fieldsToValidateOnChange:$e},max_primary_shard_docs:{label:we.editPolicy.maxPrimaryShardDocsLabel,validations:[{validator:Ne},{validator:ze},{validator:Re}],serializer:We.stringToNumber,fieldsToValidateOnChange:$e},max_size:{label:se.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeLabel",{defaultMessage:"Maximum index size"}),validations:[{validator:Ne},{validator:ze}],fieldsToValidateOnChange:$e}},forcemerge:{max_num_segments:He},shrink:{number_of_shards:Je,max_primary_shard_size:Ye},set_priority:{priority:Qe("hot")},searchable_snapshot:Ge}},warm:{min_age:Ze("warm"),actions:{allocate:{number_of_replicas:Ke},shrink:{number_of_shards:Je,max_primary_shard_size:Ye},forcemerge:{max_num_segments:He},set_priority:{priority:Qe("warm")}}},cold:{min_age:Ze("cold"),actions:{allocate:{number_of_replicas:Ke},set_priority:{priority:Qe("cold")},searchable_snapshot:Ge}},frozen:{min_age:Ze("frozen"),actions:{allocate:{number_of_replicas:Ke},set_priority:{priority:Qe("frozen")},searchable_snapshot:Ge}},delete:{min_age:Ze("delete","365"),actions:{wait_for_snapshot:{policy:{label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.waitForSnapshot.snapshotPolicyFieldLabel",{defaultMessage:"Policy name (optional)"})}}}}}}))(_)),[_]),{form:S}=Object(o.useForm)({schema:L,defaultValue:w,deserializer:k,serializer:T}),[E]=Object(o.useFormData)({form:S,watch:ni}),F=Object(o.useFormIsModified)({form:S}),C=()=>a||b?Object(W.get)(E,ni):O,z=Object(i.useMemo)((()=>(({policies:e,isClonedPolicy:t,originalPolicyName:a})=>[{validator:Ee(we.editPolicy.errors.policyNameRequiredMessage)},{validator:Fe({message:we.editPolicy.errors.policyNameStartsWithUnderscoreErrorMessage,char:"_"})},{validator:Se({message:we.editPolicy.errors.policyNameContainsInvalidChars,chars:[","," "]})},{validator:e=>{const t=e.value;if(window.TextEncoder&&(new window.TextEncoder).encode(t).length>255)return{message:we.editPolicy.errors.policyNameTooLongErrorMessage}}},{validator:i=>{const l=i.value;return t&&l===a?{message:we.editPolicy.errors.policyNameMustBeDifferentErrorMessage}:l!==a&&e.map((e=>e.name)).includes(l)?{message:we.editPolicy.errors.policyNameAlreadyUsedErrorMessage}:void 0}}])({originalPolicyName:O,policies:n,isClonedPolicy:b})),[O,n,b]),A=()=>{p.push("/policies")};return(({hasUnsavedChanges:e,openConfirm:t,history:a,http:l,navigateToUrl:s,messageText:n=ne,titleText:o=oe,confirmButtonText:r=ce,cancelButtonText:c=re})=>{Object(i.useEffect)((()=>{if(e){const e=e=>{e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}}),[e]),Object(i.useEffect)((()=>{if(!e)return;const i=a.block((e=>(async function(){if(await t(n,{title:o,cancelButtonText:c,confirmButtonText:r,"data-test-subj":"navigationBlockConfirmModal"})){const t=l.basePath.prepend(e.pathname)+e.hash+e.search;i(),s(t,{state:e.state})}}(),!1)));return i}),[a,e,t,s,l.basePath,o,c,r,n])})({titleText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.unsavedPrompt.title",{defaultMessage:"Exit without saving changes?"}),messageText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.unsavedPrompt.body",{defaultMessage:"The data will be lost if you leave this page without saving the policy changes."}),hasUnsavedChanges:F&&!1===y,openConfirm:x.openConfirm,history:p,http:g,navigateToUrl:h}),Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiPageHeader,{pageTitle:Object(M.jsx)("span",{"data-test-subj":"policyTitle"},a?se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createPolicyMessage",{defaultMessage:"Create policy"}):se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.editPolicyMessage",{defaultMessage:"Edit policy {originalPolicyName}",values:{originalPolicyName:O}})),bottomBorder:!0,rightSideItems:[Object(M.jsx)(j.EuiButtonEmpty,{href:m.links.elasticsearch.ilm,target:"_blank",iconType:"help"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.documentationLinkText",defaultMessage:"Documentation"}))]}),Object(M.jsx)(j.EuiSpacer,{size:"l"}),Object(M.jsx)(ft,{form:S},a?null:Object(M.jsx)(i.Fragment,null,Object(M.jsx)(ea,null),Object(M.jsx)(j.EuiSpacer,null),Object(M.jsx)(j.EuiFormRow,null,Object(M.jsx)(j.EuiSwitch,{"data-test-subj":"saveAsNewSwitch",style:{maxWidth:"100%"},checked:b,onChange:e=>{f(e.target.checked)},label:Object(M.jsx)("span",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewPolicyMessage",defaultMessage:"Save as new policy"}))}))),b||a?Object(M.jsx)(_t,{path:ni,config:{label:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameLabel",{defaultMessage:"Policy name"}),helpText:se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.validPolicyNameMessage",{defaultMessage:"A policy name cannot start with an underscore and cannot contain a comma or a space."}),validations:z},component:c.TextField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":"policyNameField"}}}):null,Object(M.jsx)(j.EuiHorizontalRule,null),Object(M.jsx)(Ut,null),Object(M.jsx)(j.EuiSpacer,{size:"l"}),Object(M.jsx)(j.EuiTimeline,{className:"ilmPhases"},Object(M.jsx)(Xa,null),Object(M.jsx)(ti,null),Object(M.jsx)(ii,null),P&&Object(M.jsx)(li,null),Object(M.jsx)(si,null)),Object(M.jsx)(j.EuiHorizontalRule,null),Object(M.jsx)($t,null),Object(M.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiFlexGroup,null,Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiButton,{"data-test-subj":"savePolicyButton",fill:!0,iconType:"check",iconSide:"left",disabled:!1===S.isValid||S.isSubmitting,onClick:async()=>{const{data:e,isValid:t}=await S.submit();t?(v(!0),await(async(e,t)=>{try{await Object(ie.g)(e)}catch(t){const a=se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.saveErrorMessage",{defaultMessage:"Error saving lifecycle policy {lifecycleName}",values:{lifecycleName:e.name}});return Object(kt.a)(t,a),!1}const a=Object(Tt.a)(e.phases);a.push(t?ee.j:ee.m),Object(Tt.c)(X.METRIC_TYPE.COUNT,a);const i=se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.successfulSaveMessage",{defaultMessage:'{verb} lifecycle policy "{lifecycleName}"',values:{verb:t?se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createdMessage",{defaultMessage:"Created"}):se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.updatedMessage",{defaultMessage:"Updated"}),lifecycleName:e.name}});return de.c.addSuccess(i),!0})({...e,name:C()},a||b)&&A()):de.c.addDanger(se.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.formErrorsMessage",{defaultMessage:"Please fix the errors on this page."}))}},b?Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewButton",defaultMessage:"Save as new policy"}):Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveButton",defaultMessage:"Save policy"}))),Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiButtonEmpty,{"data-test-subj":"cancelTestPolicy",onClick:A},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.cancelButton",defaultMessage:"Cancel"}))))),Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiButtonEmpty,{onClick:()=>{t(!e)},"data-test-subj":"requestButton"},e?Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hidePolicyJsonButton",defaultMessage:"Hide request"}):Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.showPolicyJsonButton",defaultMessage:"Show request"})))),e?Object(M.jsx)(St,{policyName:C(),close:()=>t(!1)}):null))},ri=({match:{params:{policyName:e}}})=>{var t;const{services:{breadcrumbService:a,license:l}}=B(),{error:s,isLoading:n,data:o,resendRequest:r}=Object(ie.k)();if(Object(i.useEffect)((()=>{a.setBreadcrumbs("editPolicy")}),[a]),n)return Object(M.jsx)(j.EuiPageTemplate.EmptyPrompt,{title:Object(M.jsx)(j.EuiLoadingSpinner,{size:"xl"}),body:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.policiesLoading",defaultMessage:"Loading policies..."})});if(s||!o){const{statusCode:e,message:t}=s||{statusCode:"",message:""};return Object(M.jsx)(j.EuiPageTemplate.EmptyPrompt,{color:"danger",title:Object(M.jsx)("h2",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.lifecyclePoliciesLoadingFailedTitle",defaultMessage:"Unable to load existing lifecycle policies"})),body:Object(M.jsx)("p",null,t," (",e,")"),actions:Object(M.jsx)(j.EuiButton,{onClick:r,iconType:"refresh",color:"danger"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.lifecyclePoliciesReloadButton",defaultMessage:"Try again"}))})}const c=((e,t="")=>{if(e&&e.length>0)return e.find((e=>e.name===t))})(o,Object(d.attemptToURIDecode)(e));return Object(M.jsx)(Jt,{value:{isNewPolicy:!(null!=c&&c.policy),policyName:Object(d.attemptToURIDecode)(e),policy:null!==(t=null==c?void 0:c.policy)&&void 0!==t?t:ee.o,existingPolicies:o,license:{canUseSearchableSnapshot:()=>l.hasAtLeast(ae.a)},indices:c&&c.indices?c.indices:[],indexTemplates:c&&c.indexTemplates?c.indexTemplates:[]}},Object(M.jsx)(oi,null))};const ci=Object(i.createContext)({listAction:null,setListAction:()=>{}}),di=({children:e})=>{const[t,a]=Object(i.useState)(null);return Object(M.jsx)(ci.Provider,{value:{listAction:t,setListAction:a}},e)},ui=()=>{const e=Object(i.useContext)(ci);if(!e)throw new Error("usePolicyListContext can only be called inside of PolicyListContext!");return e},mi={deleteEnabled:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.deletePolicyButtonText",{defaultMessage:"Delete policy"}),deleteDisabled:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.deletePolicyButtonDisabledTooltip",{defaultMessage:"You cannot delete a policy that is being used by an index"}),viewIndices:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.viewIndicesButtonText",{defaultMessage:"View indices linked to policy"}),addIndexTemplate:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addPolicyToTemplateButtonText",{defaultMessage:"Add policy to index template"})},pi={badge:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.managedLabel",{defaultMessage:"Managed"}),badgeTooltip:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.managedDescription",{defaultMessage:"This policy is preconfigured and managed by Elastic; editing or deleting this policy might break Kibana."})},hi={badge:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.deprecatedLabel",{defaultMessage:"Deprecated"}),badgeTooltip:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.deprecatedDescription",{defaultMessage:"This policy is no longer supported and might be removed in a future release. Instead, use one of the other policies available or create a new one."})},xi=({policies:e})=>{const[t,a]=Object(i.useState)(""),s=Object($.useHistory)(),{services:{getUrlForApp:o}}=B(),[r,c]=function(e,t){const a=localStorage.getItem(e),[l,s]=Object(i.useState)(function(e,t){if(!e)return t;try{return JSON.parse(e)}catch(e){return t}}(a,t));return Object(i.useEffect)((()=>{localStorage.setItem(e,JSON.stringify(l))}),[e,l]),[l,s]}("ILM_SHOW_MANAGED_POLICIES_BY_DEFAULT",!1),{setListAction:d}=ui(),u=({queryText:e,error:t})=>{t||a(e)},p=Object(i.useMemo)((()=>({query:t,onChange:u,box:{incremental:!0,"data-test-subj":"ilmSearchBar"},filters:[{type:"is",field:"policy.deprecated",name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.isDeprecatedFilterLabel",{defaultMessage:"Deprecated"})}],toolsRight:Object(M.jsx)(j.EuiFlexItem,{grow:!1},Object(M.jsx)(j.EuiSwitch,{id:"checkboxShowHiddenIndices","data-test-subj":"includeHiddenPoliciesSwitch",checked:r,onChange:e=>c(e.target.checked),label:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.hiddenPoliciesSwitchLabel",defaultMessage:"Include managed system policies"})}))})),[r,c,t]),h=Object(i.useMemo)((()=>{let a=r?e:e.filter((e=>{var t,a;return!(null!==(t=e.policy)&&void 0!==t&&null!==(a=t._meta)&&void 0!==a&&a.managed)}));return a=t.includes("is:policy.deprecated")?a.filter((e=>{var t;return null===(t=e.policy)||void 0===t?void 0:t.deprecated})):a.filter((e=>{var t;return!(null!==(t=e.policy)&&void 0!==t&&t.deprecated)})),a}),[e,r,t]),x=[{"data-test-subj":"policy-name",field:"name",name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.nameHeader",{defaultMessage:"Name"}),sortable:!0,render:(e,t)=>{var a,i,o;const r=null===(a=t.policy)||void 0===a||null===(i=a._meta)||void 0===i?void 0:i.managed,c=null===(o=t.policy)||void 0===o?void 0:o.deprecated;return Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(j.EuiLink,m()({className:"eui-textBreakAll","data-test-subj":"policyTablePolicyNameLink"},Object(n.reactRouterNavigate)(s,Object(Qt.e)(e),(()=>Object(Tt.c)(X.METRIC_TYPE.CLICK,ee.f)))),e),c&&Object(M.jsx)(l.a.Fragment,null," ",Object(M.jsx)(j.EuiToolTip,{content:hi.badgeTooltip},Object(M.jsx)(j.EuiBadge,{color:"warning","data-test-subj":"deprecatedPolicyBadge"},hi.badge))),r&&Object(M.jsx)(l.a.Fragment,null," ",Object(M.jsx)(j.EuiToolTip,{content:pi.badgeTooltip},Object(M.jsx)(j.EuiBadge,{color:"hollow","data-test-subj":"managedPolicyBadge"},pi.badge))))}},{"data-test-subj":"policy-indexTemplates",field:"indexTemplates",name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.indexTemplatesHeader",{defaultMessage:"Linked index templates"}),sortable:({indexTemplates:e})=>(null!=e?e:[]).length,render:(e,t)=>e&&e.length>0?Object(M.jsx)(j.EuiToolTip,{content:mi.viewIndices,position:"left"},Object(M.jsx)(j.EuiButtonEmpty,{flush:"both","data-test-subj":"viewIndexTemplates",onClick:()=>d({selectedPolicy:t,actionType:"viewIndexTemplates"})},e.length)):"0"},{"data-test-subj":"policy-indices",field:"indices",name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.linkedIndicesHeader",{defaultMessage:"Linked indices"}),sortable:({indices:e})=>(null!=e?e:[]).length,render:(e,t)=>e&&e.length>0?Object(M.jsx)(j.EuiToolTip,{content:mi.viewIndices,position:"left"},Object(M.jsx)(j.EuiLink,{href:Object(Qt.b)(t.name,o)},e.length)):"0"},{"data-test-subj":"policy-modifiedDate",field:"modifiedDate",name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.modifiedDateHeader",{defaultMessage:"Modified date"}),sortable:!0,render:e=>e?xe()(e).format("MMM D, YYYY"):e},{actions:[{render:e=>Object(M.jsx)(j.EuiToolTip,{content:mi.addIndexTemplate},Object(M.jsx)(j.EuiButtonIcon,{"data-test-subj":"addPolicyToTemplate",onClick:()=>d({selectedPolicy:e,actionType:"addIndexTemplate"}),iconType:"plusInCircle","aria-label":mi.addIndexTemplate}))},{render:(e,t)=>Object(M.jsx)(j.EuiToolTip,{content:t?mi.deleteEnabled:mi.deleteDisabled},Object(M.jsx)(j.EuiButtonIcon,{"data-test-subj":"deletePolicy",onClick:()=>d({selectedPolicy:e,actionType:"deletePolicy"}),iconType:"trash","aria-label":mi.deleteEnabled,disabled:!t})),enabled:e=>!(e=>Boolean(e.indices&&e.indices.length))(e)}],name:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.actionsHeader",{defaultMessage:"Actions"})}];return Object(M.jsx)(j.EuiInMemoryTable,{tableCaption:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.captionText",{defaultMessage:"The table below contains {count, plural, one {# Index Lifecycle policy} other {# Index Lifecycle policies}} .",values:{count:e.length}}),pagination:!0,sorting:{sort:{field:"name",direction:"asc"}},search:p,tableLayout:"auto",items:h,columns:x,rowProps:e=>({"data-test-subj":`policyTableRow-${e.name}`})})};var gi=a(6),bi=a.n(gi);class confirm_delete_ConfirmDelete extends i.Component{constructor(...e){super(...e),bi()(this,"state",{isDeleteConfirmed:!1}),bi()(this,"setIsDeleteConfirmed",(e=>{this.setState({isDeleteConfirmed:e})})),bi()(this,"deletePolicy",(async()=>{const{policyToDelete:e,callback:t}=this.props,a=e.name;try{await Object(ie.c)(a);const e=se.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.successMessage",{defaultMessage:"Deleted policy {policyName}",values:{policyName:a}});de.c.addSuccess(e)}catch(e){const t=se.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.errorMessage",{defaultMessage:"Error deleting policy {policyName}",values:{policyName:a}});Object(kt.a)(e,t)}t&&t()})),bi()(this,"isPolicyPolicy",!0)}render(){var e,t;const{policyToDelete:a,onCancel:i}=this.props,{isDeleteConfirmed:l}=this.state,s=null===(e=a.policy)||void 0===e||null===(t=e._meta)||void 0===t?void 0:t.managed,n=se.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.title",{defaultMessage:'Delete policy "{name}"',values:{name:a.name}});return Object(M.jsx)(j.EuiConfirmModal,{"data-test-subj":"deletePolicyModal",title:n,onCancel:i,onConfirm:this.deletePolicy,cancelButtonText:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.cancelButton",defaultMessage:"Cancel"}),confirmButtonText:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.deleteButton",defaultMessage:"Delete"}),buttonColor:"danger",confirmButtonDisabled:!!s&&!l},s?Object(M.jsx)(j.EuiCallOut,{title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.proceedWithCautionCallOutTitle",defaultMessage:"Deleting a managed policy can break Kibana"}),color:"danger",iconType:"warning","data-test-subj":"deleteManagedPolicyCallOut"},Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.proceedWithCautionCallOutDescription",defaultMessage:"Managed policies are critical for internal operations. If you delete this managed policy, you can’t recover it."})),Object(M.jsx)(j.EuiCheckbox,{id:"confirmDeletePolicyCheckbox",label:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.confirmDeleteCheckboxLabel",defaultMessage:"I understand the consequences of deleting a managed policy"}),checked:l,onChange:e=>this.setIsDeleteConfirmed(e.target.checked)})):Object(M.jsx)("div",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.undoneWarning",defaultMessage:"You can't recover a deleted policy."})))}}const fi=({policy:e,onSuccess:t,onCancel:a})=>{const[s,n]=Object(i.useState)(!1),[o,r]=Object(i.useState)(""),[c,d]=Object(i.useState)(""),[u,m]=Object(i.useState)(""),{error:p,isLoading:h,data:x,resendRequest:g}=Object(ie.h)(s),b=se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.title",{defaultMessage:'Add policy "{name}" to index template',values:{name:e.name}}),{docLinks:f}=B().services;return Object(M.jsx)(j.EuiConfirmModal,{"data-test-subj":"addPolicyToTemplateModal",title:b,onCancel:a,onConfirm:async()=>{const a=e.name;if(o)try{await Object(ie.b)({policyName:a,templateName:o,aliasName:""===c?void 0:c},s);const e=se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.successMessage",{defaultMessage:"Added policy {policyName} to index template {templateName}",values:{policyName:a,templateName:o}});de.c.addSuccess(e),t(o)}catch(e){const t=se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.errorMessage",{defaultMessage:'Error adding policy "{policyName}" to index template {templateName}',values:{policyName:a,templateName:o}});Object(kt.a)(e,t)}else m(se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.noTemplateSelectedErrorMessage",{defaultMessage:"You must select an index template."}))},cancelButtonText:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.confirmButton",{defaultMessage:"Add policy"}),confirmButtonDisabled:h||!!p||!x},Object(M.jsx)(j.EuiText,null,Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.explanationText",defaultMessage:"This will apply the lifecycle policy to all indices which match the index template."})," ",Object(M.jsx)(wt,{docPath:f.links.elasticsearch.indexTemplates,text:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutIndexTemplatesLink",defaultMessage:"Learn about index templates"})}))),Object(M.jsx)(j.EuiSpacer,{size:"m"}),(()=>{let t=[];return x&&(t=x.map((({name:e})=>({label:e})))),Object(M.jsx)(j.EuiForm,null,Object(M.jsx)(j.EuiFormRow,null,Object(M.jsx)(j.EuiSwitch,{label:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.showLegacyTemplates",defaultMessage:"Show legacy index templates"}),checked:s,onChange:e=>{r(""),n(e.target.checked)}})),p?(()=>{const{statusCode:e="",message:t=""}=p;return Object(M.jsx)(i.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(j.EuiCallOut,{style:{maxWidth:400},title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.errorLoadingTemplatesTitle",defaultMessage:"Unable to load index templates"}),color:"danger"},Object(M.jsx)("p",null,t," (",e,")"),Object(M.jsx)(j.EuiButton,{isLoading:h,color:"danger",onClick:g},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyToTemplateConfirmModal.errorLoadingTemplatesButton",defaultMessage:"Try again"}))),Object(M.jsx)(j.EuiSpacer,{size:"s"}))})():Object(M.jsx)(l.a.Fragment,null,(()=>{var e,t,a;const l=null==x?void 0:x.find((e=>e.name===o)),s=null==l||null===(e=l.settings)||void 0===e||null===(t=e.index)||void 0===t||null===(a=t.lifecycle)||void 0===a?void 0:a.name;if(s)return Object(M.jsx)(i.Fragment,null,Object(M.jsx)(j.EuiSpacer,{size:"s"}),Object(M.jsx)(j.EuiCallOut,{style:{maxWidth:400},title:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.templateHasPolicyWarningTitle",defaultMessage:"Template already has policy"}),color:"warning"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyToTemplateConfirmModal.indexHasNoAliasesWarningMessage",defaultMessage:"This index template already has the policy {existingPolicyName} attached to it. Adding this policy will overwrite that configuration.",values:{existingPolicyName:s}})),Object(M.jsx)(j.EuiSpacer,{size:"s"}))})(),Object(M.jsx)(j.EuiFormRow,{isInvalid:!!u,error:u,label:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.chooseTemplateLabel",defaultMessage:"Index template"})},Object(M.jsx)(j.EuiComboBox,{isLoading:h,placeholder:se.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.chooseTemplateMessage",{defaultMessage:"Select an index template"}),options:t,selectedOptions:o?[{label:o}]:[],onChange:e=>{m(""),r(e.length>0?e[0].label:"")},singleSelection:{asPlainText:!0},isClearable:!0}))),(null===(a=e.policy.phases.hot)||void 0===a?void 0:a.actions.rollover)?Object(M.jsx)(j.EuiFormRow,{label:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.rolloverAliasLabel",defaultMessage:"Alias for rollover index"})},Object(M.jsx)(j.EuiFieldText,{value:c,onChange:e=>{d(e.target.value)}})):null);var a})())},ji=({updatePolicies:e})=>{const{listAction:t,setListAction:a}=ui();var i;return"viewIndexTemplates"===(null==t?void 0:t.actionType)?Object(M.jsx)(Xt,{policyName:t.selectedPolicy.name,indexTemplates:null!==(i=t.selectedPolicy.indexTemplates)&&void 0!==i?i:[],close:()=>{a(null)}}):"deletePolicy"===(null==t?void 0:t.actionType)?Object(M.jsx)(confirm_delete_ConfirmDelete,{policyToDelete:t.selectedPolicy,callback:()=>{e(),a(null)},onCancel:()=>{a(null)}}):"addIndexTemplate"===(null==t?void 0:t.actionType)?Object(M.jsx)(fi,{policy:t.selectedPolicy,onSuccess:e=>{t.selectedPolicy.indexTemplates=[...t.selectedPolicy.indexTemplates||[],e],a(null)},onCancel:()=>a(null)}):null},yi=({policies:e,updatePolicies:t})=>{const a=Object($.useHistory)(),s=Object(M.jsx)(j.EuiButton,m()({},Object(n.reactRouterNavigate)(a,Object(Qt.d)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"createPolicyButton"}),Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPrompt.createButtonLabel",defaultMessage:"Create policy"}));return 0===e.length?Object(M.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"managementApp",title:Object(M.jsx)("h1",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPromptTitle",defaultMessage:"Create your first index lifecycle policy"})),body:Object(M.jsx)(i.Fragment,null,Object(M.jsx)("p",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPromptDescription",defaultMessage:" An index lifecycle policy helps you manage your indices as they age."}))),actions:s}):Object(M.jsx)(l.a.Fragment,null,Object(M.jsx)(ji,{updatePolicies:t}),Object(M.jsx)(j.EuiPageHeader,{pageTitle:Object(M.jsx)("span",{"data-test-subj":"ilmPageHeader"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.sectionHeading",defaultMessage:"Index Lifecycle Policies"})),description:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.sectionDescription",defaultMessage:"Manage your indices as they age.  Attach a policy to automate when and how to transition an index through its lifecycle."}),bottomBorder:!0,rightSideItems:[s]}),Object(M.jsx)(j.EuiSpacer,{size:"l"}),Object(M.jsx)(xi,{policies:e}))},vi=()=>{const{services:{breadcrumbService:e}}=B(),{data:t,isLoading:a,error:l,resendRequest:s}=Object(ie.k)();if(Object(i.useEffect)((()=>{e.setBreadcrumbs("policies")}),[e]),a)return Object(M.jsx)(j.EuiPageTemplate.EmptyPrompt,{title:Object(M.jsx)(j.EuiLoadingSpinner,{size:"xl"}),body:Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesLoading",defaultMessage:"Loading policies..."})});if(l){const{statusCode:e,message:t}=l||{statusCode:"",message:""};return Object(M.jsx)(j.EuiPageTemplate.EmptyPrompt,{color:"danger",title:Object(M.jsx)("h2",null,Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesLoadingFailedTitle",defaultMessage:"Unable to load existing lifecycle policies"})),body:Object(M.jsx)("p",null,t," (",e,")"),actions:Object(M.jsx)(j.EuiButton,{onClick:s,iconType:"refresh",color:"danger"},Object(M.jsx)(te.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesReloadButton",defaultMessage:"Try again"}))})}return Object(M.jsx)(di,null,Object(M.jsx)(yi,{policies:t||[],updatePolicies:s}))},Oi=({history:e})=>(Object(i.useEffect)((()=>Object(Tt.c)(X.METRIC_TYPE.LOADED,ee.a)),[]),Object(M.jsx)(V,{history:e},Object(M.jsx)(Z,null,Object(M.jsx)($.Redirect,{exact:!0,from:"/",to:Qt.a.list}),Object(M.jsx)(Y,{exact:!0,path:Qt.a.list,component:vi}),Object(M.jsx)(Y,{path:Qt.a.edit,component:ri})))),Mi=(e,t,a,i,l,o,r,c,d)=>{const{navigateToUrl:u,getUrlForApp:m}=i,{overlays:p,http:h}=e;return Object(s.render)(Object(M.jsx)(F,e,Object(M.jsx)("div",{className:U.APP_WRAPPER_CLASS},Object(M.jsx)(R,{coreStart:{application:i}},Object(M.jsx)(n.KibanaContextProvider,{services:{cloud:d,breadcrumbService:l,license:o,getUrlForApp:m,docLinks:r,executionContext:c,navigateToUrl:u,overlays:p,http:h,history:a}},Object(M.jsx)(Oi,{history:a}))))),t),()=>Object(s.unmountComponentAtNode)(t)}}])]);