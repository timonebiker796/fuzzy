/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,a,c=t[0],r=t[1],o=0,s=[];o<c.length;o++)a=c[o],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&s.push(i[a][0]),i[a]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(l&&l(t);s.length;)s.shift()()}var n={},i={0:0};function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var c=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=c);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.src=function(e){return a.p+"indexLifecycleManagement.chunk."+e+".js"}(e);var l=new Error;r=function(t){o.onerror=o.onload=null,clearTimeout(s);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),c=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+c+")",l.name="ChunkLoadError",l.type=a,l.request=c,n[1](l)}i[e]=void 0}};var s=setTimeout((function(){r({type:"timeout",target:o})}),12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var c=window.indexLifecycleManagement_bundle_jsonpfunction=window.indexLifecycleManagement_bundle_jsonpfunction||[],r=c.push.bind(c);c.push=t,c=c.slice();for(var o=0;o<c.length;o++)t(c[o]);var l=r;a(a.s=22)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d}));var i=n(17);let a;function c(e){a=e}function r(e){const t="/api/index_lifecycle_management";return e?`${t}/${e}`:t}function o(e,t,n){return a.post(r(e),{body:JSON.stringify(t),query:n})}function l(e,t){return a.get(r(e),{query:t})}function s(e){return a.delete(r(e))}const d=e=>Object(i.useRequest)(a,{...e,path:r(e.path)})},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"p",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return l})),n.d(t,"m",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"f",(function(){return b}));const i={hot:"100",warm:"50",cold:"0",frozen:"0"},a={max_age:"30d",max_primary_shard_size:"50gb"},c={name:"",phases:{hot:{actions:{rollover:a}}}},r="index_lifecycle_management",o="app_load",l="policy_create",s="policy_update",d="policy_delete",u="policy_attach_index",m="policy_attach_index_template",f="policy_detach_index",p="config_cold_phase",x="config_warm_phase",g="config_set_priority",y="index_retry_step",b="edit_click"},function(e,t,n){e.exports=n(21)(2)},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";let i,a;function c(e,t){i=e,a=t}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r}));var i=n(5);let a=(e,t)=>{};function c(e){e&&(a=e.reportUiCounter.bind(e,i.b))}function r(e){return[{metric:i.c,isTracked:()=>Boolean(e.cold)},{metric:i.e,isTracked:()=>Boolean(e.warm)},{metric:i.d,isTracked:()=>{const t=e.hot&&e.hot.actions.set_priority&&e.hot.actions.set_priority.priority!==parseInt(i.n.hot,10),n=e.warm&&e.warm.actions.set_priority&&e.warm.actions.set_priority.priority!==parseInt(i.n.warm,10),a=e.cold&&e.cold.actions.set_priority&&e.cold.actions.set_priority.priority!==parseInt(i.n.cold,10);return t||n||a}}].reduce(((e,{metric:t,isTracked:n})=>(n()&&e.push(t),e)),[])}},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){"use strict";n.d(t,"j",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"k",(function(){return u})),n.d(t,"g",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return x})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return M}));var i=n(14),a=n(5),c=n(9),r=n(4);const o=()=>Object(r.e)({path:"nodes/list",method:"get",initialData:{nodesByAttributes:{},nodesByRoles:{}}}),l=e=>Object(r.e)({path:`nodes/${e}/details`,method:"get"}),s=(e=!1)=>Object(r.e)({path:"templates",query:{legacy:e},method:"get",initialData:[]});async function d(){return await Object(r.c)("policies")}const u=()=>Object(r.e)({path:"policies",method:"get"});async function m(e){return await Object(r.d)("policies",e)}async function f(e){const t=await Object(r.b)(`policies/${encodeURIComponent(e)}`);return Object(c.c)(i.METRIC_TYPE.COUNT,a.k),t}const p=async e=>{const t=await Object(r.d)("index/retry",{indexNames:e});return Object(c.c)(i.METRIC_TYPE.COUNT,a.g),t},x=async e=>{const t=await Object(r.d)("index/remove",{indexNames:e});return Object(c.c)(i.METRIC_TYPE.COUNT,a.l),t},g=async e=>{const t=await Object(r.d)("index/add",e);return Object(c.c)(i.METRIC_TYPE.COUNT,a.h),t},y=async(e,t=!1)=>{const n=await Object(r.d)("template",e,{legacy:t});return Object(c.c)(i.METRIC_TYPE.COUNT,a.i),n},b=()=>Object(r.e)({path:"snapshot_policies",method:"get",initialData:[]}),M=()=>Object(r.e)({path:"snapshot_repositories",method:"get"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var i=n(2);const a=Object.freeze({warm:["data_warm","data_hot"],cold:["data_cold","data_warm","data_hot"],frozen:["data_frozen","data_cold","data_warm","data_hot"]}),c="enterprise",r={ID:"index_lifecycle_management",minimumLicenseType:"basic",TITLE:i.i18n.translate("xpack.indexLifecycleMgmt.appTitle",{defaultMessage:"Index Lifecycle Policies"})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var i=n(18);const a={list:"/policies",edit:"/policies/edit/:policyName?",create:"/policies/edit"},c=e=>encodeURI(`/policies/edit/${encodeURIComponent(e)}`),r=()=>a.create,o=()=>a.list,l=(e,t)=>t("management",{path:`/data/index_management${Object(i.getIndexListUri)(`ilm.policy="${e}"`,!0)}`})},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(8);function a(e,t){const n=function(e,t){if(e&&e.body){var n;const{error:i,statusCode:a,message:c,attributes:r}=e.body;return{title:t,text:`${a}: ${i}. ${null!=r&&null!==(n=r.causes)&&void 0!==n&&n.length?r.causes[r.causes.length-1]:c}`}}}(e,t);if(n)return i.c.addDanger(n);i.a.add(e,t)}},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/indexManagement/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n(23),__kbnBundles__.define("plugin/indexLifecycleManagement/public",n,24)},function(e,t,n){n.p=window.__kbnPublicPath__.indexLifecycleManagement},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return F})),n.d(t,"ILM_LOCATOR_ID",(function(){return D}));var i=n(6),a=n.n(i),c=n(19),r=n(2),o=n(12),l=n(4),s=n(9),d=n(8);const u=function(){const e=[{text:r.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.homeLabel",{defaultMessage:"Index Lifecycle Management"}),href:"/policies"}];return{policies:e,editPolicy:[...e,{text:r.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.editPolicyLabel",{defaultMessage:"Edit policy"}),href:void 0}]}}();class breadcrumbs_BreadcrumbService{constructor(){a()(this,"setBreadcrumbsHandler",void 0)}setup(e){this.setBreadcrumbsHandler=e}setBreadcrumbs(e){if(!this.setBreadcrumbsHandler)throw new Error("BreadcrumbService#setup() must be called first!");const t=u[e]?[...u[e]]:[...u.policies],n=t.pop();t.push({...n,href:void 0}),this.setBreadcrumbsHandler(t)}}var m=n(7),f=n.n(m),p=n(10),x=n(1),g=n(11),y=n(20),b=n.n(y),M=n(3),_=n(0),h=n(16),j=n(13);const O={hot:{color:h.euiThemeVars.euiColorVis9,label:"Hot"},warm:{color:h.euiThemeVars.euiColorVis5,label:"Warm"},cold:{color:h.euiThemeVars.euiColorVis1,label:"Cold"},frozen:{color:h.euiThemeVars.euiColorVis4,label:"Frozen"},delete:{color:"default",label:"Delete"}};var L={name:"o84bs6",styles:"min-width:600px"},v={name:"1mhs1aw",styles:"min-width:400px"};const k={id:"ilm",name:Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Index lifecycle",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.tabHeaderLabel"}),order:50,renderTabContent:({index:e,getUrlForApp:t})=>{var n;const{ilm:i}=e,a=i,c=null!==(n=O[a.phase])&&void 0!==n?n:{color:"default",label:a.phase},o=[{title:r.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.policyNameTitle",{defaultMessage:"Policy name"}),description:a.policy},{title:r.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentPhaseTitle",{defaultMessage:"Current phase"}),description:Object(_.jsx)(x.EuiBadge,{color:c.color},c.label)}];return a.action&&o.push({title:r.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionTitle",{defaultMessage:"Current action"}),description:Object(_.jsx)(x.EuiCode,null,a.action)}),a.action_time_millis&&o.push({title:r.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionTimeTitle",{defaultMessage:"Current action time"}),description:b()(a.action_time_millis).format("YYYY-MM-DD HH:mm:ss")}),a.step&&o.push({title:r.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentStepTitle",{defaultMessage:"Current step"}),description:Object(_.jsx)(x.EuiCode,null,a.step)}),Object(_.jsx)(f.a.Fragment,null,Object(_.jsx)(x.EuiFlexGroup,{wrap:!0},Object(_.jsx)(x.EuiFlexItem,{grow:1,css:v},Object(_.jsx)(x.EuiPanel,{hasBorder:!0,grow:!1,"data-test-subj":"policyPropertiesPanel"},Object(_.jsx)(x.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(_.jsx)(x.EuiFlexItem,{grow:!1},Object(_.jsx)(x.EuiText,{size:"xs"},Object(_.jsx)("h3",null,Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Lifecycle policy",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.policyCardTitle"})))),Object(_.jsx)(x.EuiFlexItem,{grow:!1},Object(_.jsx)(x.EuiLink,{color:"primary",href:t("management",{path:`data/index_lifecycle_management/${Object(j.e)(a.policy)}`}),target:"_blank"},Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Edit policy in ILM",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.ilmLinkLabel"})))),Object(_.jsx)(x.EuiSpacer,null),Object(_.jsx)(x.EuiDescriptionList,{rowGutterSize:"m",type:"responsiveColumn",columnWidths:[1,1],listItems:o}))),Object(_.jsx)(x.EuiFlexItem,{grow:3,css:L},a.step_info&&"ERROR"===a.step&&Object(_.jsx)(f.a.Fragment,null,Object(_.jsx)(x.EuiPanel,{color:"danger",hasBorder:!0,grow:!1,"data-test-subj":"policyErrorPanel"},Object(_.jsx)(x.EuiText,{size:"xs"},Object(_.jsx)("h3",null,Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Lifecycle error",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.lifecycleErrorTitle"})),Object(_.jsx)(x.EuiSpacer,null),Object(_.jsx)(x.EuiCodeBlock,{language:"json",isCopyable:!0},JSON.stringify({failed_step:a.failed_step,step_info:a.step_info},null,2)))),Object(_.jsx)(x.EuiSpacer,null)),a.step_info&&"ERROR"!==a.step&&Object(_.jsx)(f.a.Fragment,null,Object(_.jsx)(x.EuiPanel,{hasBorder:!0,grow:!1,"data-test-subj":"policyStepPanel"},Object(_.jsx)(x.EuiText,{size:"xs"},Object(_.jsx)("h3",null,Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Current step info",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.stepInfoTitle"})),Object(_.jsx)(x.EuiSpacer,null),Object(_.jsx)(x.EuiCodeBlock,{language:"json",isCopyable:!0},JSON.stringify(a.step_info,null,2)))),Object(_.jsx)(x.EuiSpacer,null)),a.phase_execution&&Object(_.jsx)(x.EuiPanel,{hasBorder:!0,grow:!1,"data-test-subj":"phaseDefinitionPanel"},Object(_.jsx)(x.EuiText,{size:"xs"},Object(_.jsx)("h3",null,Object(_.jsx)(M.FormattedMessage,{defaultMessage:"Current phase definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.phaseDefinitionTitle"}))),Object(_.jsx)(x.EuiSpacer,null),Object(_.jsx)(x.EuiCodeBlock,{language:"json",isCopyable:!0},JSON.stringify(a.phase_execution,null,2))))))},shouldRenderTab:({index:e})=>!!e.ilm&&e.ilm.managed};var C=n(15);class add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal extends m.Component{constructor(e){super(e),a()(this,"addPolicy",(async()=>{const{indexName:e,closeModal:t,reloadIndices:n}=this.props,{selectedPolicyName:i,selectedAlias:a}=this.state;if(i)try{const c={indexName:e,policyName:i,alias:a};await Object(g.a)(c),t(),d.c.addSuccess(r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexSuccess",{defaultMessage:"Added policy {policyName} to index {indexName}.",values:{policyName:i,indexName:e}})),n()}catch(e){Object(C.a)(e,r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexError",{defaultMessage:"Error adding policy to index"}))}else this.setState({policyErrorMessage:r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPolicySelectedErrorMessage",{defaultMessage:"You must select a policy."})})})),a()(this,"renderAliasFormElement",(e=>{const{selectedAlias:t}=this.state,{index:n}=this.props;if(!e||!Object(p.get)(e,"policy.phases.hot.actions.rollover"))return null;const{aliases:i}=n;if("none"===i)return Object(_.jsx)(m.Fragment,null,Object(_.jsx)(x.EuiSpacer,{size:"m"}),Object(_.jsx)(x.EuiCallOut,{style:{maxWidth:400},title:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningTitle",defaultMessage:"Index has no aliases"}),color:"warning"},Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningMessage",defaultMessage:"Policy {policyName} is configured for rollover, but index {indexName} does not have an alias, which is required for rollover.",values:{policyName:null==e?void 0:e.name,indexName:n.name}})));const a=i.map((e=>({text:e,value:e})));return a.unshift({text:r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasMessage",{defaultMessage:"Choose an alias"}),value:""}),Object(_.jsx)(x.EuiFormRow,{label:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasLabel",defaultMessage:"Index rollover alias"})},Object(_.jsx)(x.EuiSelect,{options:a,value:t,onChange:e=>{this.setState({selectedAlias:e.target.value})}}))})),this.state={policies:[],selectedPolicyName:"",selectedAlias:""}}renderForm(){const{policies:e,selectedPolicyName:t,policyErrorMessage:n}=this.state,i=t?e.find((e=>e.name===t)):void 0,a=e.map((({name:e})=>({value:e,text:e})));return a.unshift({value:"",text:r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyMessage",{defaultMessage:"Select a lifecycle policy"})}),Object(_.jsx)(x.EuiForm,null,Object(_.jsx)(x.EuiFormRow,{isInvalid:!!n,error:n,label:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyLabel",defaultMessage:"Lifecycle policy"})},Object(_.jsx)(x.EuiSelect,{options:a,value:t,onChange:e=>{this.setState({policyErrorMessage:void 0,selectedPolicyName:e.target.value})}})),this.renderAliasFormElement(i))}async componentDidMount(){try{const e=await Object(g.d)();this.setState({policies:e})}catch(e){Object(C.a)(e,r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.loadPolicyError",{defaultMessage:"Error loading policy list"})),this.props.closeModal()}}render(){const{policies:e}=this.state,{indexName:t,closeModal:n,getUrlForApp:i}=this.props,a=Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.modalTitle",defaultMessage:'Add lifecycle policy to "{indexName}"',values:{indexName:t}});return e.length?Object(_.jsx)(x.EuiConfirmModal,{title:a,onCancel:n,onConfirm:this.addPolicy,cancelButtonText:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),confirmButtonText:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyButtonText",defaultMessage:"Add policy"})},this.renderForm()):Object(_.jsx)(x.EuiModal,{onClose:n},Object(_.jsx)(x.EuiModalHeader,null,Object(_.jsx)(x.EuiModalHeaderTitle,null,a)),Object(_.jsx)(x.EuiModalBody,null,Object(_.jsx)(x.EuiCallOut,{style:{maxWidth:400},title:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPoliciesWarningTitle",defaultMessage:"No index lifecycle policies defined"}),color:"warning"},Object(_.jsx)("p",null,Object(_.jsx)(x.EuiLink,{href:i("management",{path:"data/index_lifecycle_management/policies/edit"})},Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.defineLifecyclePolicyLinkText",defaultMessage:"Define lifecycle policy"}))))))}}class remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal extends m.Component{constructor(...e){super(...e),a()(this,"removePolicy",(async()=>{const{indexNames:e,closeModal:t,reloadIndices:n}=this.props;try{await Object(g.e)(e),t(),d.c.addSuccess(r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicySuccess",{defaultMessage:"Removed lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:e.length}})),n()}catch(e){Object(C.a)(e,r.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyToIndexError",{defaultMessage:"Error removing policy"}))}}))}render(){const{closeModal:e,indexNames:t}=this.props;return Object(_.jsx)(x.EuiConfirmModal,{title:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.modalTitle",defaultMessage:"Remove lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:t.length}}),onCancel:e,onConfirm:this.removePolicy,cancelButtonText:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyButtonText",defaultMessage:"Remove policy"})},Object(_.jsx)(m.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removeMessage",defaultMessage:"You are about to remove the index lifecycle policy from {count, plural, one {this index} other {these indices}}. This operation cannot be undone.",values:{count:t.length}})),Object(_.jsx)("ul",null,t.map((e=>Object(_.jsx)("li",{key:e},e))))))}}const T="ilm.step",P=({indices:e})=>{if(!Object(p.every)(e,(e=>{var t;return(null===(t=e.ilm)||void 0===t?void 0:t.managed)&&e.ilm.failed_step})))return null;const t=e.map((({name:e})=>e));return{requestMethod:g.f,icon:"play",indexNames:[t],buttonLabel:r.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleActionButtonLabel",{defaultMessage:"Retry lifecycle step"}),successMessage:r.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleAction.retriedLifecycleMessage",{defaultMessage:"Called retry lifecycle step for: {indexNames}",values:{indexNames:t.map((e=>`"${e}"`)).join(", ")}})}},E=({indices:e,reloadIndices:t})=>{if(!Object(p.every)(e,(e=>e.ilm&&e.ilm.managed)))return null;const n=e.map((({name:e})=>e));return{renderConfirmModal:e=>Object(_.jsx)(remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal,{indexNames:n,closeModal:e,reloadIndices:t}),icon:"stopFilled",indexNames:[n],buttonLabel:r.i18n.translate("xpack.indexLifecycleMgmt.removeIndexLifecycleActionButtonLabel",{defaultMessage:"Remove lifecycle policy"})}},w=({indices:e,reloadIndices:t,getUrlForApp:n})=>{if(1!==e.length)return null;const i=e[0];if(i.ilm&&i.ilm.managed)return null;const a=i.name;return{renderConfirmModal:e=>Object(_.jsx)(add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal,{indexName:a,closeModal:e,index:i,reloadIndices:t,getUrlForApp:n}),icon:"plusInCircle",buttonLabel:r.i18n.translate("xpack.indexLifecycleMgmt.addLifecyclePolicyActionButtonLabel",{defaultMessage:"Add lifecycle policy"})}},S=e=>{const{Query:t}=x.EuiSearchBar;if(!e.length)return null;const n=e.filter((e=>"ERROR"===Object(p.get)(e,T))).length;return n?{type:"warning",filter:t.parse(`${T}:ERROR`),filterLabel:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.filterLabel",{defaultMessage:"Show errors"}),title:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.errorMessage",{defaultMessage:"{ numIndicesWithLifecycleErrors, number}\n          {numIndicesWithLifecycleErrors, plural, one {index has} other {indices have} }\n          lifecycle errors",values:{numIndicesWithLifecycleErrors:n}})}:null},I=e=>Object(p.some)(e,(e=>e.ilm&&e.ilm.managed))?[{type:"field_value_selection",name:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecycleStatusLabel",{defaultMessage:"Lifecycle status"}),multiSelect:!1,field:"ilm.managed",options:[{value:!0,view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.managedLabel",{defaultMessage:"Managed"})},{value:!1,view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.unmanagedLabel",{defaultMessage:"Unmanaged"})}]},{type:"field_value_selection",field:"ilm.phase",name:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecyclePhaseLabel",{defaultMessage:"Lifecycle phase"}),multiSelect:"or",options:[{value:"hot",view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.hotLabel",{defaultMessage:"Hot"})},{value:"warm",view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.warmLabel",{defaultMessage:"Warm"})},{value:"frozen",view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.frozenLabel",{defaultMessage:"Frozen"})},{value:"cold",view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.coldLabel",{defaultMessage:"Cold"})},{value:"delete",view:r.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.deleteLabel",{defaultMessage:"Delete"})}]}]:[],D="ILM_LOCATOR_ID";class locator_IlmLocatorDefinition{constructor(e){a()(this,"id",D),a()(this,"getLocation",(async e=>{const t=await this.deps.managementAppLocator.getLocation({sectionId:"data",appId:o.b.ID});switch(e.page){case"policy_create":return{...t,path:t.path+Object(j.d)()};case"policy_edit":return{...t,path:t.path+Object(j.e)(e.policyName)};case"policies_list":return{...t,path:t.path+Object(j.c)()}}})),this.deps=e}}class plugin_IndexLifecycleManagementPlugin{constructor(e){a()(this,"breadcrumbService",new breadcrumbs_BreadcrumbService),this.initializerContext=e}setup(e,t){const{ui:{enabled:i}}=this.initializerContext.config.get();if(i){const{http:i,notifications:{toasts:u},fatalErrors:m,getStartServices:f}=e,{usageCollection:p,management:x,indexManagement:g,home:y,cloud:b}=t;Object(l.a)(i),Object(s.b)(p),Object(d.b)(u,m),x.sections.section.data.registerApp({id:o.b.ID,title:o.b.TITLE,order:2,mount:async({element:e,history:t,setBreadcrumbs:i})=>{const[a,{licensing:r}]=await f(),{chrome:{docTitle:l},application:s,docLinks:d,executionContext:u}=a,m=await Object(c.firstValueFrom)(r.license$);l.change(o.b.TITLE),this.breadcrumbService.setup(i);const{renderApp:p}=await n.e(1).then(n.bind(null,93)),x=p(a,e,t,s,this.breadcrumbService,m,d,u,b);return()=>{l.reset(),x()}}}),y&&y.featureCatalogue.register({id:o.b.ID,title:r.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueTitle",{defaultMessage:"Manage index lifecycles"}),description:r.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueDescription",{defaultMessage:"Define lifecycle policies to automatically perform operations as an index ages."}),icon:"indexRollupApp",path:"/app/management/data/index_lifecycle_management",showOnHomePage:!0,category:"admin",order:640}),g&&((a=g.extensionsService).addAction(P),a.addAction(E),a.addAction(w),a.addBanner(S),a.addFilter(I),a.addIndexDetailsTab(k)),t.share.url.locators.create(new locator_IlmLocatorDefinition({managementAppLocator:t.management.locator}))}var a}start(){}stop(){}}const F=e=>new plugin_IndexLifecycleManagementPlugin(e)},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Immer},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDomV5Compat},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.ElasticEuiLibComponentsUseIsNestedEuiProvider},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t){e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},function(e,t){e.exports=__kbnSharedDeps__.Uuid}]);