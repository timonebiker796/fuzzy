/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function n(n){for(var t,o,i=n[0],a=n[1],c=0,u=[];c<i.length;c++)o=i[c],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&u.push(r[o][0]),r[o]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]);for(s&&s(n);u.length;)u.shift()()}var t={},r={2:0};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var n=[],t=r[e];if(0!==t)if(t)n.push(t[2]);else{var i=new Promise((function(n,o){t=r[e]=[n,o]}));n.push(t[2]=i);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(e){return o.p+"profiling.chunk."+e+".js"}(e);var s=new Error;a=function(n){c.onerror=c.onload=null,clearTimeout(u);var t=r[e];if(0!==t){if(t){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,t[1](s)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(n)},o.m=e,o.c=t,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o.oe=function(e){throw console.error(e),e};var i=window.profiling_bundle_jsonpfunction=window.profiling_bundle_jsonpfunction||[],a=i.push.bind(i);i.push=n,i=i.slice();for(var c=0;c<i.length;c++)n(i[c]);var s=a;o(o.s=14)}([function(e,n){e.exports=__kbnSharedDeps__.EmotionReact},function(e,n){e.exports=__kbnSharedDeps__.React},function(e,n,t){e.exports=t(13)(4)},function(e,n){e.exports=__kbnSharedDeps__.KbnI18n},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/observabilityShared/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps__.Rxjs},function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"m",(function(){return i})),t.d(n,"n",(function(){return a})),t.d(n,"d",(function(){return c})),t.d(n,"g",(function(){return s})),t.d(n,"f",(function(){return u})),t.d(n,"e",(function(){return l})),t.d(n,"c",(function(){return p})),t.d(n,"i",(function(){return m})),t.d(n,"h",(function(){return b})),t.d(n,"a",(function(){return _})),t.d(n,"k",(function(){return g})),t.d(n,"l",(function(){return h})),t.d(n,"j",(function(){return y}));let r=function(e){return e[e.Unsymbolized=0]="Unsymbolized",e[e.Python=1]="Python",e[e.PHP=2]="PHP",e[e.Native=3]="Native",e[e.Kernel=4]="Kernel",e[e.JVM=5]="JVM",e[e.Ruby=6]="Ruby",e[e.Perl=7]="Perl",e[e.JavaScript=8]="JavaScript",e[e.PHPJIT=9]="PHPJIT",e[e.DotNET=10]="DotNET",e[e.ErrorFlag=128]="ErrorFlag",e[e.Error=255]="Error",e}({});const o={[r.Unsymbolized]:"<unsymbolized frame>",[r.Python]:"Python",[r.PHP]:"PHP",[r.Native]:"Native",[r.Kernel]:"Kernel",[r.JVM]:"JVM/Hotspot",[r.Ruby]:"Ruby",[r.Perl]:"Perl",[r.JavaScript]:"JavaScript",[r.PHPJIT]:"PHP JIT",[r.DotNET]:".NET",[r.ErrorFlag]:"ErrorFlag",[r.Error]:"Error"};function i(e){return!!(e&r.ErrorFlag)}function a(e){return i(e)?r.Error:e in o?e:r.Unsymbolized}function c(e){return o[a(e)]}const s={FrameIDs:[],FileIDs:[],AddressOrLines:[],Types:[],selfAnnualCO2Kgs:0,selfAnnualCostUSD:0,Count:0},u={FileName:"",FunctionName:"",FunctionOffset:0,LineNumber:0,Inline:!1},l={FileName:""};function p(e={}){var n,t,r,o,i,a,c,s,u,l;const p={};return p.FrameID=null!==(n=e.FrameID)&&void 0!==n?n:"",p.FileID=null!==(t=e.FileID)&&void 0!==t?t:"",p.FrameType=null!==(r=e.FrameType)&&void 0!==r?r:0,p.Inline=null!==(o=e.Inline)&&void 0!==o&&o,p.AddressOrLine=null!==(i=e.AddressOrLine)&&void 0!==i?i:0,p.FunctionName=null!==(a=e.FunctionName)&&void 0!==a?a:"",p.FunctionOffset=null!==(c=e.FunctionOffset)&&void 0!==c?c:0,p.SourceFilename=null!==(s=e.SourceFilename)&&void 0!==s?s:"",p.SourceLine=null!==(u=e.SourceLine)&&void 0!==u?u:0,p.ExeFileName=null!==(l=e.ExeFileName)&&void 0!==l?l:"",p}function f(e){return n=e.FunctionName,/\(|\)/.test(n)?e.FunctionName:`${e.FunctionName}()`;var n}function d(e){return void 0===(null==e?void 0:e.ExeFileName)?"":""!==e.ExeFileName?e.ExeFileName:c(e.FrameType)}function m(e){if(e.FrameType===r.Error)return`Error: unwinding error code #${e.AddressOrLine.toString()}`;const n=e.Inline?"-> ":"";if(""===e.FunctionName)return`${n}${d(e)}`;const t=e.SourceFilename,o=t?t.split("/").pop():"";return o?0===e.SourceLine?`${n}${d(e)}: ${f(e)} in ${o}`:`${n}${d(e)}: ${f(e)} in ${o}#${e.SourceLine}`:`${n}${d(e)}: ${f(e)}`}function b(e){const n=e.ExeFileName?e.ExeFileName:c(e.FrameType);return e.FunctionName?n+": "+e.FunctionName:n}let _=function(e){return e.PARTIALLY_SYMBOLYZED="PARTIALLY_SYMBOLYZED",e.NOT_SYMBOLIZED="NOT_SYMBOLIZED",e.SYMBOLIZED="SYMBOLIZED",e}({});function g(e){const{sourceFilename:n,sourceLine:t,exeFileName:r}=e;return""===n&&0===t?r?_.PARTIALLY_SYMBOLYZED:_.NOT_SYMBOLIZED:_.SYMBOLIZED}const S=[r.Native,r.Kernel];function h(e){return S.includes(e.frameType)?"NATIVE":"INTERPRETED"}function y(e){if(e.FrameType===r.Error)return`unwinding error code #${e.AddressOrLine.toString()}`;switch(g({sourceFilename:e.SourceFilename,sourceLine:e.SourceLine,exeFileName:e.ExeFileName})){case _.NOT_SYMBOLIZED:return"<unsymbolized>";case _.PARTIALLY_SYMBOLYZED:return e.ExeFileName+"+0x"+e.AddressOrLine.toString(16);case _.SYMBOLIZED:return e.SourceFilename+(0!==e.SourceLine?`#${e.SourceLine}`:"")}}},,function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));const r=e=>1e3*e},function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(10);function o(e,n,t,o,i){return""===i?`empty;${e};${n}`:""===o?`elf;${e};${i}`:`full;${t};${i};${a=o||"",Object(r.takeRight)(a.split("/"),2).join("/")}`;var a}},function(e,n){e.exports=__kbnSharedDeps__.Lodash},function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return c}));var r=t(3);const o="profiling-events-all",i="/internal/profiling";function a(){return{TopN:`${i}/topn`,TopNContainers:`${i}/topn/containers`,TopNDeployments:`${i}/topn/deployments`,TopNFunctions:`${i}/topn/functions`,TopNHosts:`${i}/topn/hosts`,TopNThreads:`${i}/topn/threads`,TopNTraces:`${i}/topn/traces`,APMTransactions:`${i}/topn/functions/apm/transactions`,Flamechart:`${i}/flamechart`,HasSetupESResources:`${i}/setup/es_resources`,SetupDataCollectionInstructions:`${i}/setup/instructions`,StorageExplorerSummary:`${i}/storage_explorer/summary`,StorageExplorerHostStorageDetails:`${i}/storage_explorer/host_storage_details`,StorageExplorerIndicesStorageDetails:`${i}/storage_explorer/indices_storage_details`}}const c=r.i18n.translate("xpack.profiling.notAvailableLabel",{defaultMessage:"N/A"})},function(e,n,t){t.r(n);var r=__kbnBundles__.get("entry/core/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps_npm__},function(e,n,t){t(15),__kbnBundles__.define("plugin/profiling/public",t,16)},function(e,n,t){t.p=window.__kbnPublicPath__.profiling},function(e,n,t){"use strict";t.r(n),t.d(n,"plugin",(function(){return y}));var r=t(12),o=t(3),i=t(5);const a="profiling";var c=t(4),s=t(2),u=t.n(s),l=t(1),p=t.n(l),f=t(0);function d(e,n={}){const t=p.a.lazy(e);return p.a.forwardRef(((e,r)=>{var o;return Object(f.jsx)(l.Suspense,{fallback:null!==(o=n.fallback)&&void 0!==o?o:null},p.a.createElement(t,{...e,ref:r}))}))}const m=d((async()=>({default:(await Promise.all([t.e(0),t.e(1),t.e(5)]).then(t.bind(null,129))).EmbeddableFlamegraph}))),b=d((async()=>({default:(await Promise.all([t.e(0),t.e(1),t.e(6)]).then(t.bind(null,135))).EmbeddableFunctions}))),_=d((async()=>({default:(await Promise.all([t.e(0),t.e(7)]).then(t.bind(null,134))).EmbeddableStackTraces}))),g=d((async()=>({default:(await t.e(4).then(t.bind(null,130))).EmbeddableSearchBar})));var S=t(39),h=t(11);class plugin_ProfilingPlugin{setup(e,n){const s=[{id:"stacktraces",title:o.i18n.translate("xpack.profiling.navigation.stacktracesLinkLabel",{defaultMessage:"Stacktraces"}),path:"/stacktraces"},{id:"flamegraphs",title:o.i18n.translate("xpack.profiling.navigation.flameGraphsLinkLabel",{defaultMessage:"Flamegraphs"}),path:"/flamegraphs"},{id:"functions",title:o.i18n.translate("xpack.profiling.navigation.functionsLinkLabel",{defaultMessage:"Functions"}),path:"/functions"}],l=new i.BehaviorSubject(""),p=Object(i.combineLatest)([Object(i.from)(e.getStartServices()),l]).pipe(Object(i.map)((([[e],n])=>e.application.capabilities.profiling.show?[{label:o.i18n.translate("xpack.profiling.navigation.sectionLabel",{defaultMessage:"Universal Profiling"}),entries:s.map((e=>({app:a,label:e.title,path:`${e.path}?kuery=${null!=n?n:""}`,matchPath:n=>n.startsWith(e.path)}))),sortKey:700}]:[])));n.observabilityShared.navigation.registerSections(p);const d=function(){const e=Object(h.c)();return{fetchTopN:async({http:n,type:t,timeFrom:r,timeTo:o,kuery:i})=>{const a={timeFrom:r,timeTo:o,kuery:i};return await n.get(`${e.TopN}/${t}`,{query:a})},fetchTopNFunctions:async({http:n,timeFrom:t,timeTo:r,startIndex:o,endIndex:i,kuery:a})=>{const c={timeFrom:t,timeTo:r,startIndex:o,endIndex:i,kuery:a};return await n.get(e.TopNFunctions,{query:c})},fetchElasticFlamechart:async({http:n,timeFrom:t,timeTo:r,kuery:o,showErrorFrames:i})=>{const a={timeFrom:t,timeTo:r,kuery:o},c=await n.get(e.Flamechart,{query:a});return Object(S.a)(c,i)},fetchHasSetup:async({http:n})=>await n.get(e.HasSetupESResources,{}),postSetupResources:async({http:n})=>{await n.post(e.HasSetupESResources,{})},setupDataCollectionInstructions:async({http:n})=>await n.get(e.SetupDataCollectionInstructions,{}),fetchStorageExplorerSummary:async({http:n,timeFrom:t,timeTo:r,kuery:o,indexLifecyclePhase:i})=>{const a={timeFrom:t,timeTo:r,kuery:o,indexLifecyclePhase:i};return await n.get(e.StorageExplorerSummary,{query:a})},fetchStorageExplorerHostStorageDetails:async({http:n,timeFrom:t,timeTo:r,kuery:o,indexLifecyclePhase:i})=>{const a={timeFrom:t,timeTo:r,kuery:o,indexLifecyclePhase:i};return await n.get(e.StorageExplorerHostStorageDetails,{query:a})},fetchStorageExplorerIndicesStorageDetails:async({http:n,indexLifecyclePhase:t})=>{const r={indexLifecyclePhase:t};return await n.get(e.StorageExplorerIndicesStorageDetails,{query:r})},fetchTopNFunctionAPMTransactions:({functionName:n,http:t,serviceNames:r,timeFrom:o,timeTo:i})=>{const a={timeFrom:o,timeTo:i,functionName:n,serviceNames:JSON.stringify(r)};return t.get(e.APMTransactions,{query:a})}}}();return e.application.register({id:a,title:"Universal Profiling",euiIconType:"logoObservability",appRoute:"/app/profiling",category:r.DEFAULT_APP_CATEGORIES.observability,deepLinks:s,async mount({element:r,history:o,theme$:i,setHeaderActionMenu:a}){const[c,s]=await e.getStartServices(),{renderApp:u}=await Promise.all([t.e(0),t.e(1),t.e(3)]).then(t.bind(null,133));function p(e){var n;const t=new URLSearchParams(e.search);l.next(null!==(n=t.get("kuery"))&&void 0!==n?n:"")}p(o.location),o.listen(p);const f=u({profilingFetchServices:d,coreStart:c,coreSetup:e,pluginsStart:s,pluginsSetup:n,history:o,theme$:i,setHeaderActionMenu:a},r);return()=>{f(),l.next("")}}}),(async()=>{const[t,r]=await e.getStartServices();return{coreStart:t,coreSetup:e,pluginsStart:r,pluginsSetup:n,profilingFetchServices:d}})().then((e=>{!function(e){const{pluginsSetup:{observabilityShared:n}}=e;var t;n.registerProfilingComponent(c.EMBEDDABLE_FLAMEGRAPH,(t=e,e=>Object(f.jsx)(m,u()({},e,t)))),n.registerProfilingComponent(c.EMBEDDABLE_FUNCTIONS,(e=>n=>Object(f.jsx)(b,u()({},n,e)))(e)),n.registerProfilingComponent(c.EMBEDDABLE_PROFILING_SEARCH_BAR,(e=>n=>Object(f.jsx)(g,u()({},n,e)))(e)),n.registerProfilingComponent(c.EMBEDDABLE_STACK_TRACES,(e=>n=>Object(f.jsx)(_,u()({},n,e)))(e))}(e)})),{}}start(e){return{}}stop(){}}function y(){return new plugin_ProfilingPlugin}},function(e,n){e.exports=__kbnSharedDeps__.ElasticEui},,function(e,n){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,n){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/observability/common");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps__.IoTs},function(e,n){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps__.TsLib},function(e,n){e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/unifiedSearch/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps__.ElasticEuiLibComponentsUseIsNestedEuiProvider},function(e,n){e.exports=__kbnSharedDeps__.EmotionCache},function(e,n){e.exports=__kbnSharedDeps__.ReactRouter},function(e,n){e.exports=__kbnSharedDeps__.ReactRouterDomV5Compat},function(e,n){e.exports=__kbnSharedDeps__.ReactDom},function(e,n,t){t.r(n);var r=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(n,Object.getOwnPropertyDescriptors(r))},function(e,n){e.exports=__kbnSharedDeps__.Moment},function(e,n){e.exports=__kbnSharedDeps__.KbnMonaco},function(e,n){e.exports=__kbnSharedDeps__.KbnCodeEditor},function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(9);const o=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function i(e){const n=e.length;let[t,r,i,a]=[8997,33826,40164,52210],[c,s,u,l]=[0,0,0,0];for(let o=0;o<n;o++)t^=e[o],c=435*t,s=435*r,u=435*i,l=435*a,s+=c>>16,u+=s>>16,u+=256*t,l+=256*r,t=65535&c,r=65535&s,i=65535&u,a=l+(u>>16)&65535;return o[a>>8]+o[255&a]+o[i>>8]+o[255&i]+o[r>>8]+o[255&r]+o[t>>8]+o[255&t]}var a=t(6),c=t(8);function s(e,n){if(!n)for(let n=0;n<e.Edges[0].length;n++){const t=e.Edges[0][n];Object(a.m)(e.FrameType[t])&&(e.Edges[0][n]=e.Edges[t][0])}const t={Size:e.Size,SamplingRate:e.SamplingRate,Edges:e.Edges,FileID:e.FileID,FrameType:e.FrameType,Inline:e.Inline,ExeFilename:e.ExeFilename,AddressOrLine:e.AddressOrLine,FunctionName:e.FunctionName,FunctionOffset:e.FunctionOffset,SourceFilename:e.SourceFilename,SourceLine:e.SourceLine,CountInclusive:e.CountInclusive,CountExclusive:e.CountExclusive,ID:new Array(e.Size),Label:new Array(e.Size),TotalSeconds:e.TotalSeconds,TotalSamples:e.TotalSamples,SelfCPU:e.SelfCPU,TotalCPU:e.TotalCPU,SelfAnnualCO2KgsItems:e.AnnualCO2TonsExclusive.map(c.a),TotalAnnualCO2KgsItems:e.AnnualCO2TonsInclusive.map(c.a),SelfAnnualCostsUSDItems:e.AnnualCostsUSDExclusive,TotalAnnualCostsUSDItems:e.AnnualCostsUSDInclusive},o=Object(r.a)(t.FileID[0],t.AddressOrLine[0],t.ExeFilename[0],t.SourceFilename[0],t.FunctionName[0]);t.ID[0]=i((new TextEncoder).encode(o));const s=[0];for(;s.length>0;){const e=s.pop();for(const n of t.Edges[e]){const o=Object(r.a)(t.FileID[n],t.AddressOrLine[n],t.ExeFilename[n],t.SourceFilename[n],t.FunctionName[n]),a=(new TextEncoder).encode(t.ID[e]+o);t.ID[n]=i(a),s.push(n)}}t.Label[0]="root: Represents 100% of CPU time.";for(let e=1;e<t.Size;e++){const n=Object(a.c)({FileID:t.FileID[e],FrameType:t.FrameType[e],Inline:t.Inline[e],ExeFileName:t.ExeFilename[e],AddressOrLine:t.AddressOrLine[e],FunctionName:t.FunctionName[e],FunctionOffset:t.FunctionOffset[e],SourceFilename:t.SourceFilename[e],SourceLine:t.SourceLine[e]});t.Label[e]=Object(a.i)(n)}return t}}]);